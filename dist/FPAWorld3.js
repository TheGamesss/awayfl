!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t,e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,i)};function i(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}function n(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),r=0;for(e=0;e<i;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)n[r]=o[s];return n}!function(t){t[t.None=0]="None",t[t.Deflate=1]="Deflate",t[t.LZMA=2]="LZMA"}(t||(t={}));var r=function(){function e(){this.compression=t.None,this.swfVersion=0,this.useAVM1=!0,this.backgroundColor=4294967295,this.bounds=null,this.frameRate=0,this.frameCount=0,this.attributes=null,this.sceneAndFrameLabelData=null,this.bytesLoaded=0,this.bytesTotal=length,this.pendingUpdateDelays=0,this.framesLoaded=0}return e.prototype.mapSWFVersionToFPVersion=function(){var t={6:"FP6",7:"FP7",8:"FP8",9:"FP9",10:"FP10",11:"FP10_2",12:"FP10_3",13:"FP11_0",14:"FP11_1",15:"FP11_2",16:"FP11_3",17:"FP11_4",18:"FP11_5",19:"FP11_6",20:"FP11_7",21:"FP11_8",22:"FP11_9",23:"FP12",24:"FP13",25:"FP14",26:"FP15",27:"FP16",28:"FP17",29:"FP18",30:"FP19",31:"FP20",32:"FP21",33:"FP22",34:"FP23",35:"FP24",36:"FP25",37:"FP26",38:"FP27",39:"FP28",40:"FP29",41:"FP30",42:"FP31"};this.fpVersion=t[this.swfVersion]?t[this.swfVersion]:"unmappedSWFVersion:"+this.swfVersion},e}(),o=function(){function t(t,e,i){void 0===t&&(t=""),void 0===e&&(e=0),void 0===i&&(i=""),this._errorID=0,this._messsage="",this._name="",this._messsage=t,this._name=i,this._errorID=e}return Object.defineProperty(t.prototype,"message",{get:function(){return this._messsage},set:function(t){this._messsage=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorID",{get:function(){return this._errorID},enumerable:!0,configurable:!0}),t}(),s=function(t){function e(e,i){return void 0===e&&(e=null),void 0===i&&(i=0),t.call(this,e||"An abstract method was called! Either an instance of an abstract export class was created,or an abstract method was not overridden by the subclass.",i)||this}return i(e,t),e}(o),a=function(){function t(t){this.type=void 0,this.target=void 0,this._iAllowedToPropagate=!0,this._iAllowedToImmediatlyPropagate=!0,this.type=t}return t.prototype.clone=function(){return new t(this.type)},t}(),l=function(t){function e(e,i,n){void 0===n&&(n=null);var r=t.call(this,e)||this;return r._asset=i,r._prevName=n||r._asset.name,r}return i(e,t),Object.defineProperty(e.prototype,"asset",{get:function(){return this._asset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"prevName",{get:function(){return this._prevName},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._asset,this._prevName)},e.INVALIDATE="invalidate",e.CLEAR="clear",e.RENAME="rename",e.ENTER_FRAME="enterFrame",e.EXIT_FRAME="exitFrame",e.ASSET_CONFLICT_RESOLVED="assetConflictResolved",e.ASSET_COMPLETE="assetComplete",e.TEXTURE_SIZE_ERROR="textureSizeError",e}(a),u=function(){function t(t){void 0===t&&(t=null),this._listenerObjects=new Array,this._t=t||this}return t.prototype.addEventListener=function(t,e){var i=this._listenerObjects[t];void 0===i&&(i=this._listenerObjects[t]=new c),i.addEventListener(e)},t.prototype.removeEventListener=function(t,e){var i=this._listenerObjects[t];i&&(i.removeEventListener(e),0==i.numListeners&&delete this._listenerObjects[t])},t.prototype.dispatchEvent=function(t){var e=this._listenerObjects[t.type];e&&(t.target=this._t,e.dispatchEvent(t))},t.prototype.hasEventListener=function(t,e){return void 0!==this._listenerObjects[t]&&(null!=e?-1!==this._listenerObjects[t].getEventListenerIndex(e):this._listenerObjects[t].numListeners>0)},t}(),c=function(){function t(){this._index=0,this._listeners=new Array,this.numListeners=0}return t.prototype.addEventListener=function(t){-1===this._listeners.indexOf(t)&&(this._listeners.push(t),this.numListeners++)},t.prototype.removeEventListener=function(t){var e=this._listeners.indexOf(t);-1!==e&&(this._listeners.splice(e,1),e<=this._index&&this._index--,this.numListeners--)},t.prototype.dispatchEvent=function(t){var e=this.numListeners;for(this._index=0;this._index<e&&this._index<this.numListeners&&(this._listeners[this._index](t),t._iAllowedToImmediatlyPropagate);this._index++);},t.prototype.getEventListenerIndex=function(t){return this._listeners.indexOf(t)},t}(),h=function(){function t(){}return Object.defineProperty(t,"Current",{get:function(){return this.id},enumerable:!0,configurable:!0}),t.Next=function(){return this.id++},t.id=0,t}(),p=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._abstractionPool={},i._id=h.Next(),null==e&&(e="null"),i._name=e,i._originalName=e,i.updateFullPath(),i}return i(e,t),Object.defineProperty(e.prototype,"adaptee",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adapter",{get:function(){return this._adapter||this},set:function(t){this._adapter=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assetType",{get:function(){throw new s},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalName",{get:function(){return this._originalName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){var e=this._name;this._name=t,null==this._name&&(this._name="null"),this.updateFullPath(),this.dispatchEvent(new l(l.RENAME,this,e))},enumerable:!0,configurable:!0}),e.prototype.invalidate=function(){this.dispatchEvent(new l(l.INVALIDATE,this))},e.prototype.dispose=function(){throw new s},e.prototype.clone=function(){throw new s},e.prototype.clear=function(){this.dispatchEvent(new l(l.CLEAR,this))},Object.defineProperty(e.prototype,"assetNamespace",{get:function(){return this._namespace},set:function(t){this._namespace=t||e.DEFAULT_NAMESPACE,this.updateFullPath()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assetFullPath",{get:function(){return this._full_path},enumerable:!0,configurable:!0}),e.prototype.assetPathEquals=function(t,e){return this._name==t&&(!e||this._namespace==e)},e.prototype.isAsset=function(t){return this.assetType==t.assetType},e.prototype.resetAssetPath=function(t,i,n){void 0===i&&(i=null),void 0===n&&(n=!0),this._name=t||"null",this._namespace=i||e.DEFAULT_NAMESPACE,n&&(this._originalName=this._name),this.updateFullPath()},e.prototype.updateFullPath=function(){this._full_path=[this._namespace,this._name]},e.prototype.getAbstraction=function(t){return this._abstractionPool[t.id]||(this._abstractionPool[t.id]=new(t.requestAbstraction(this))(this,t))},e.prototype.clearAbstraction=function(t){delete this._abstractionPool[t.id]},e.DEFAULT_NAMESPACE="default",e}(u),d=function(){function t(t,e,i){var n=this;void 0===t&&(t=0),void 0===e&&(e=1),void 0===i&&(i=1),this._isPlaying=!1,this._isLooping=!1,this._groupID=0,this._groupVolume=1,this._groupPan=0,this._startTime=0,this._groupID=t,this._groupVolume=e,this._groupPan=i,this._sourceOpenDelegate=function(t){return n._sourceOpen(t)},this._updateEndDelegate=function(t){return n._updateEnd(t)},this._audio=new Audio,this._audio.ontimeupdate=function(t){return n._onTimeUpdate(t)},this._updateSource()}return t.stopAllSounds=function(e){void 0===e&&(e=-1);var i=t._channels.length;if(e<0){for(var n=0;n<i;n++)t._channels[n].stop();t._channels.length=0}else{var r=[];for(n=0;n<i;n++)t._channels[n].groupID==e?t._channels[n].stop():r[r.length]=t._channels[n];t._channels=r}},t.setChannelGroupVolume=function(e,i){void 0===i&&(i=-1);var n=t._channels.length;if(i<0)for(var r=0;r<n;r++)t._channels[r].groupVolume=e;else for(r=0;r<n;r++)t._channels[r].groupID==i&&(t._channels[r].groupVolume=e)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this._audio.currentTime-this._startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupID",{get:function(){return this._groupID},set:function(t){this._groupID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupVolume",{get:function(){return this._groupVolume},set:function(t){this._groupVolume!=t&&(this._groupVolume=t,this._audio.volume=this._groupVolume*this._volume)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupPan",{get:function(){return this._groupPan},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume!=t&&(this._volume=t,this._audio.volume=this._volume)},enumerable:!0,configurable:!0}),t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isLooping=function(){return this._isLooping},t.prototype.isDecoding=function(){return!1},Object.defineProperty(t.prototype,"pan",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.play=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),this._isPlaying=!0,(this._isLooping||this._isLooping!=i)&&(this._isLooping=i,this._sourceDirty=!0),this._sourceDirty&&this._updateSource(),this._buffer=t,this._offset=e,this._audio.volume=this._groupVolume*this._volume,this._isQueuing||this._isOpening||this._queueBuffer()},t.prototype.stop=function(){this._audio.pause(),this._isPlaying=!1,this._isLooping=!1},t.prototype._sourceOpen=function(t){this._isOpening=!1,this._mediaSource.activeSourceBuffers.length?console.log("ERR: double sourceopen event called"):(this._sourceBuffer=this._mediaSource.addSourceBuffer("audio/mpeg"),this._sourceBuffer.addEventListener("updateend",this._updateEndDelegate),this._isPlaying&&this._queueBuffer())},t.prototype._queueBuffer=function(){this._isQueuing=!0,this._startTime=this._sourceBuffer.timestampOffset,this._sourceBuffer.appendBuffer(this._buffer)},t.prototype._updateEnd=function(t){this._isQueuing=!1,this._isLooping&&this._mediaSource.endOfStream(),this._duration=this._sourceBuffer.timestampOffset-this._startTime,this._audio.currentTime=this._startTime+this._offset,this._audio.play()},t.prototype._onTimeUpdate=function(t){!this._isLooping&&this._duration<this._audio.currentTime-this._startTime+.1&&this.stop()},t.prototype._updateSource=function(){this._mediaSource&&this._disposeSource(),this._isQueuing=!1,this._isOpening=!0,this._mediaSource=new MediaSource,this._mediaSource.addEventListener("sourceopen",this._sourceOpenDelegate),this._urlString=URL.createObjectURL(this._mediaSource),this._audio.src=this._urlString,this._audio.loop=this._isLooping,this._sourceDirty=!1},t.prototype._disposeSource=function(){this._isOpening||(this._sourceBuffer.timestampOffset&&this._sourceBuffer.remove(0,this._sourceBuffer.timestampOffset),this._sourceBuffer.removeEventListener("updateend",this._updateEndDelegate),this._mediaSource.removeSourceBuffer(this._sourceBuffer),delete this._sourceBuffer,this._sourceBuffer=null),this._mediaSource.removeEventListener("sourceopen",this._sourceOpenDelegate),URL.revokeObjectURL(this._urlString),delete this._mediaSource,this._mediaSource=null},t.maxChannels=4,t._channels=new Array,t}(),f=function(){function t(e,i,n){var r=this;void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=1),this._isPlaying=!1,this._isLooping=!1,this._isDecoding=!1,this._volume=1,this._pan=0,this._groupID=0,this._groupVolume=1,this._groupPan=0,this._startTime=0,this._groupID=e,this._groupVolume=i,this._groupPan=n,this._audioCtx=t.getAudioContext(),this._usingNativePanner="function"==typeof this._audioCtx.createStereoPanner,this._gainNode=this._audioCtx.createGain(),this._gainNode.gain.value=this._groupVolume*this._volume,this._pannerNode=this._usingNativePanner?this._audioCtx.createStereoPanner():this._audioCtx.createPanner(),this._usingNativePanner?this._pannerNode.pan.value=this._pan:this._pannerNode.setPosition(Math.sin(this._pan*(Math.PI/2)),0,Math.cos(this._pan*(Math.PI/2))),this._gainNode.connect(this._pannerNode),this._pannerNode.connect(this._audioCtx.destination),this._onEndedDelegate=function(t){return r._onEnded(t)}}return t.getAudioContext=function(){return t._audioCtx||!window.AudioContext&&!window.webkitAudioContext||(t._audioCtx=new(window.AudioContext||window.webkitAudioContext)),t._audioCtx&&"suspended"==t._audioCtx.state&&t._audioCtx.resume(),t._audioCtx},t.stopAllSounds=function(e){void 0===e&&(e=-1);var i=t._channels.length;if(e<0){for(var n=0;n<i;n++)t._channels[n].stop();t._channels.length=0}else{var r=[];for(n=0;n<i;n++)t._channels[n].groupID==e?t._channels[n].stop():r[r.length]=t._channels[n];t._channels=r}},t.setChannelGroupVolume=function(e,i){void 0===i&&(i=-1);var n=t._channels.length;if(i<0)for(var r=0;r<n;r++)t._channels[r].groupVolume=e;else for(r=0;r<n;r++)t._channels[r].groupID==i&&(t._channels[r].groupVolume=e)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this._isDecoding?this._currentTime:this._audioCtx.currentTime-this._startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupID",{get:function(){return this._groupID},set:function(t){this._groupID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupVolume",{get:function(){return this._groupVolume},set:function(t){this._groupVolume!=t&&(this._groupVolume=t,this._gainNode.gain.value=this._groupVolume*this._volume)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupPan",{get:function(){return this._groupPan},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume!=t&&(this._volume=t,this._gainNode.gain.value=this._groupVolume*this._volume)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan!=t&&(this._pan=t,this._usingNativePanner?this._pannerNode.pan.value=this._pan:this._pannerNode.setPosition(Math.sin(this._pan*(Math.PI/2)),0,Math.cos(this._pan*(Math.PI/2))))},enumerable:!0,configurable:!0}),t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isLooping=function(){return this._isLooping},t.prototype.isDecoding=function(){return this._isDecoding},t.prototype.play=function(e,i,n,r){var o=this;void 0===i&&(i=0),void 0===n&&(n=!1),void 0===r&&(r=0),this._isPlaying=!0,this._isLooping=n,this._currentTime=i,this._id=r,this._isDecoding=!0,e=e.slice(0),t._decodeCache[r]?this._onDecodeComplete(t._decodeCache[r]):t._errorCache[r]?this.stop():this._audioCtx.decodeAudioData(e,(function(t){return o._onDecodeComplete(t)}),(function(t){return o._onError(t)}))},t.prototype.stop=function(){this._isPlaying&&(this._isPlaying=!1,this._isLooping=!1,this._isDecoding=!1,this._source&&this._disposeSource())},t.prototype._onDecodeComplete=function(e){if(this._isPlaying){this._isDecoding=!1,t._decodeCache[this._id]=e,this._source&&this._disposeSource(),this._source=this._audioCtx.createBufferSource(),this._source.loop=this._isLooping,this._source.connect(this._gainNode),this._source.buffer=e,this._duration=e.duration,this._pan=0,this._startTime=this._audioCtx.currentTime-this._currentTime,this._source.onended=this._onEndedDelegate;try{this._gainNode.gain.value=this._groupVolume*this._volume,this._usingNativePanner?this._pannerNode.pan.value=this._pan:this._pannerNode.setPosition(Math.sin(this._pan*(Math.PI/2)),0,Math.cos(this._pan*(Math.PI/2))),this._source.start(this._audioCtx.currentTime,this._currentTime)}catch(t){console.log("Error starting audio: "+t),this._disposeSource()}}},t.prototype._onError=function(e){console.log("Error with decoding audio data"),t._errorCache[this._id]=!0,this.stop()},t.prototype._onEnded=function(t){this.onSoundComplete&&this.onSoundComplete(),this.stop()},t.prototype._disposeSource=function(){this._source.onended=null,this._source.stop(this._audioCtx.currentTime),this._source.disconnect(),this._source=null},t.maxChannels=64,t._channels=new Array,t._decodeCache=new Object,t._errorCache=new Object,t}(),_=f.getAudioContext();if(_&&"suspended"===_.state){var m=function(){_.resume();var t=_.createBuffer(1,1,22050),e=_.createBufferSource();e.buffer=t,e.connect(_.destination),e.start(),setTimeout((function(){"running"===_.state&&document.removeEventListener("mousedown",m,!1)}),0)};document.addEventListener("mousedown",m,!1)}var g=function(){function t(){this.position=0,this.length=0,this._mode=""}return t.prototype.writeByte=function(t){throw"Virtual method"},t.prototype.readByte=function(){throw"Virtual method"},t.prototype.writeUnsignedByte=function(t){throw"Virtual method"},t.prototype.readUnsignedByte=function(){throw"Virtual method"},t.prototype.writeUnsignedShort=function(t){throw"Virtual method"},t.prototype.readUnsignedShort=function(){throw"Virtual method"},t.prototype.writeUnsignedInt=function(t){throw"Virtual method"},t.prototype.readUnsignedInt=function(){throw"Virtual method"},t.prototype.writeFloat=function(t){throw"Virtual method"},t.prototype.toFloatBits=function(t){throw"Virtual method"},t.prototype.readFloat=function(t){throw"Virtual method"},t.prototype.fromFloatBits=function(t){throw"Virtual method"},t.prototype.getBytesAvailable=function(){throw new s("ByteArrayBase, getBytesAvailable() not implemented ")},t.prototype.toString=function(){return"[ByteArray] ( "+this._mode+" ) position="+this.position+" length="+this.length},t.prototype.compareEqual=function(t,e){(null==e||e>this.length-this.position)&&(e=this.length-this.position),e>t.length-t.position&&(e=t.length-t.position);for(var i=e,n=!0;n&&e>=4;)e-=4,this.readUnsignedInt()!=t.readUnsignedInt()&&(n=!1);for(;n&&e>=1;)e--,this.readUnsignedByte()!=t.readUnsignedByte()&&(n=!1);return this.position-=i-e,t.position-=i-e,n},t.prototype.writeBase64String=function(t){},t.prototype.dumpToConsole=function(){var t=this.position;this.position=0;function e(t,e){for(var i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<e;r++)n=i[t>>(r<<2)&15]+n;return n}for(var i=0;i<this.length;i+=8){for(var n=e(i,4)+":",r=0;r<8&&i+r<this.length;r++)n+=" "+e(this.readUnsignedByte(),2);console.log(n)}this.position=t},t.prototype.readBase64String=function(e){return(null==e||e>this.length-this.position)&&(e=this.length-this.position),e>0?t.internalGetBase64String(e,this.readUnsignedByte,this):""},t.internalGetBase64String=function(e,i,n){for(var r,o,s,a,l,u,c,h="",p=t.Base64Key;e>=3;)a=(r=i.apply(n))>>2,l=(3&r)<<4|(o=i.apply(n))>>4,u=(15&o)<<2|(s=i.apply(n))>>6,c=63&s,h+=p.charAt(a)+p.charAt(l)+p.charAt(u)+p.charAt(c),e-=3;return 2==e?(a=(r=i.apply(n))>>2,l=(3&r)<<4|(o=i.apply(n))>>4,u=(15&o)<<2,h+=p.charAt(a)+p.charAt(l)+p.charAt(u)+"="):1==e&&(a=(r=i.apply(n))>>2,l=(3&r)<<4,h+=p.charAt(a)+p.charAt(l)+"=="),h},t.Base64Key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t}(),y=function(t){function e(e){void 0===e&&(e=4);var i=t.call(this)||this;return i._mode="Typed array",i.maxlength=Math.max(e+255&-256,4),i.arraybytes=new ArrayBuffer(i.maxlength),i.unalignedarraybytestemp=new ArrayBuffer(16),i}return i(e,t),e.prototype.ensureWriteableSpace=function(t){this.ensureSpace(t+this.position)},e.prototype.setArrayBuffer=function(t){this.ensureSpace(t.byteLength),this.length=t.byteLength;var e=new Int8Array(t);new Int8Array(this.arraybytes,0,this.length).set(e),this.position=0},e.prototype.writeArrayBuffer=function(t){this.ensureWriteableSpace(t.byteLength);var e=new Int8Array(t);new Int8Array(this.arraybytes,this.length,t.byteLength).set(e),this.length+=t.byteLength,this.position=this.length},e.prototype.writeByteArray=function(t){this.ensureWriteableSpace(t.length);var e=new Int8Array(t.arraybytes,0,t.length);new Int8Array(this.arraybytes,this.length,t.length).set(e),this.length+=t.length,this.position=this.length},e.prototype.getBytesAvailable=function(){return this.length-this.position},e.prototype.ensureSpace=function(t){if(t>this.maxlength){var e=t+255&-256,i=new ArrayBuffer(e),n=new Uint8Array(this.arraybytes,0,this.length);new Uint8Array(i,0,this.length).set(n),this.arraybytes=i,this.maxlength=e}},e.prototype.writeObject=function(t){console.log("writeObject not implemented yet in core/ByteArray")},e.prototype.readObject=function(){return console.log("readObject not implemented yet in core/ByteArray"),{}},e.prototype.writeByte=function(t){this.ensureWriteableSpace(1),new Int8Array(this.arraybytes)[this.position++]=~~t,this.position>this.length&&(this.length=this.position)},e.prototype.readByte=function(){if(this.position>=this.length)throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length;return new Int8Array(this.arraybytes)[this.position++]},e.prototype.readBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),null==i&&(i=t.length),t.ensureWriteableSpace(e+i);var n=new Int8Array(t.arraybytes),r=new Int8Array(this.arraybytes);n.set(r.subarray(this.position,this.position+i),e),this.position+=i,i+e>t.length&&(t.length+=i+e-t.length)},e.prototype.writeUnsignedByte=function(t){this.ensureWriteableSpace(1),new Uint8Array(this.arraybytes)[this.position++]=255&~~t,this.position>this.length&&(this.length=this.position)},e.prototype.readUnsignedByte=function(){if(this.position>=this.length)throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length;return new Uint8Array(this.arraybytes)[this.position++]},e.prototype.writeUnsignedShort=function(t){if(this.ensureWriteableSpace(2),0==(1&this.position)){new Uint16Array(this.arraybytes)[this.position>>1]=65535&~~t}else{new Uint16Array(this.unalignedarraybytestemp,0,1)[0]=65535&~~t;var e=new Uint8Array(this.arraybytes,this.position,2),i=new Uint8Array(this.unalignedarraybytestemp,0,2);e.set(i)}this.position+=2,this.position>this.length&&(this.length=this.position)},e.prototype.readUTFBytes=function(t){for(var e="",i=this.position+t,n=new DataView(this.arraybytes);this.position<i;){var r=n.getUint8(this.position++);if(r<128){if(0==r)break;e+=String.fromCharCode(r)}else if(r<224)e+=String.fromCharCode((63&r)<<6|127&n.getUint8(this.position++));else if(r<240){var o=n.getUint8(this.position++);e+=String.fromCharCode((31&r)<<12|(127&o)<<6|127&n.getUint8(this.position++))}else{o=n.getUint8(this.position++);var s=n.getUint8(this.position++);e+=String.fromCharCode((15&r)<<18|(127&o)<<12|s<<6&127|127&n.getUint8(this.position++))}}return e},e.prototype.writeUTFBytes=function(t){var e=encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt("0x"+e))}));this.ensureWriteableSpace(4+e.length),this.writeInt(e.length);for(var i=0;i<e.length;i++)this.writeUnsignedByte(e.charCodeAt(i));if(e.length%4){var n=e.length%4;for(i=0;i<n;i++)this.writeUnsignedByte(0)}return e.length},e.prototype.readInt=function(){var t=new DataView(this.arraybytes).getInt32(this.position,!0);return this.position+=4,t},e.prototype.readShort=function(){var t=new DataView(this.arraybytes).getInt16(this.position,!0);return this.position+=2,t},e.prototype.readDouble=function(){var t=new DataView(this.arraybytes).getFloat64(this.position,!0);return this.position+=8,t},e.prototype.readUnsignedShort=function(){if(this.position>this.length+2)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;if(0==(1&this.position)){var t=new Uint16Array(this.arraybytes),e=this.position>>1;return this.position+=2,t[e]}t=new Uint16Array(this.unalignedarraybytestemp,0,1);var i=new Uint8Array(this.arraybytes,this.position,2);return new Uint8Array(this.unalignedarraybytestemp,0,2).set(i),this.position+=2,t[0]},e.prototype.writeUnsignedInt=function(t){if(this.ensureWriteableSpace(4),0==(3&this.position)){new Uint32Array(this.arraybytes)[this.position>>2]=4294967295&~~t}else{new Uint32Array(this.unalignedarraybytestemp,0,1)[0]=4294967295&~~t;var e=new Uint8Array(this.arraybytes,this.position,4),i=new Uint8Array(this.unalignedarraybytestemp,0,4);e.set(i)}this.position+=4,this.position>this.length&&(this.length=this.position)},e.prototype.writeInt=function(t){if(this.ensureWriteableSpace(4),0==(3&this.position)){new Int32Array(this.arraybytes)[this.position>>2]=~~t}else{new Int32Array(this.unalignedarraybytestemp,0,1)[0]=~~t;var e=new Uint8Array(this.arraybytes,this.position,4),i=new Uint8Array(this.unalignedarraybytestemp,0,4);e.set(i)}this.position+=4,this.position>this.length&&(this.length=this.position)},e.prototype.readUnsignedInt=function(){if(this.position>this.length+4)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;if(0==(3&this.position)){var t=new Uint32Array(this.arraybytes),e=this.position>>2;return this.position+=4,t[e]}t=new Uint32Array(this.unalignedarraybytestemp,0,1);var i=new Uint8Array(this.arraybytes,this.position,4);return new Uint8Array(this.unalignedarraybytestemp,0,4).set(i),this.position+=4,t[0]},e.prototype.writeFloat=function(t){if(this.ensureWriteableSpace(4),0==(3&this.position)){new Float32Array(this.arraybytes)[this.position>>2]=t}else{new Float32Array(this.unalignedarraybytestemp,0,1)[0]=t;var e=new Uint8Array(this.arraybytes,this.position,4),i=new Uint8Array(this.unalignedarraybytestemp,0,4);e.set(i)}this.position+=4,this.position>this.length&&(this.length=this.position)},e.prototype.readFloat=function(){if(this.position>this.length+4)throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length;if(0==(3&this.position)){var t=new Float32Array(this.arraybytes),e=this.position>>2;return this.position+=4,t[e]}t=new Float32Array(this.unalignedarraybytestemp,0,1);var i=new Uint8Array(this.arraybytes,this.position,4);return new Uint8Array(this.unalignedarraybytestemp,0,4).set(i),this.position+=4,t[0]},e}(g),A=function(){function t(){}return t.arrayBufferToBase64=function(t,e){for(var i="",n=new Uint8Array(t),r=n.byteLength,o=0;o<r;o++)i+=String.fromCharCode(n[o]);return"data:"+e+";base64,"+window.btoa(i)},t.arrayBufferToAudio=function(e,i){var n=t.arrayBufferToBase64(e,"audio/"+i),r=new Audio;return r.src=n,r},t.arrayBufferToImage=function(e){var i=t.arrayBufferToBase64(e,"image/png"),n=new Image;return n.src=i,n},t.byteArrayToImage=function(e){var i=t.arrayBufferToBase64(e.arraybytes,"image/png"),n=new Image;return n.src=i,n},t.byteArrayToAudio=function(e,i){var n=t.arrayBufferToBase64(e.arraybytes,"audio/"+i),r=new Audio;return r.src=n,r},t.blobToImage=function(t){var e=(window.URL||window.webkitURL).createObjectURL(t),i=new Image;return i.src=e,i},t.blobToAudio=function(t){var e=(window.URL||window.webkitURL).createObjectURL(t),i=new Audio;return i.src=e,i},t.toByteArray=function(t){var e=new y;return e.setArrayBuffer(t),e},t.toString=function(t,e){if(void 0===e&&(e=0),"string"==typeof t){var i=t;if(null!=i.substr)return i.substr(0,i.length)}if(t instanceof y){var n=t;return n.position=0,n.readUTFBytes(Math.min(n.getBytesAvailable(),e))}return null},t}(),v=function(){function t(t,e,i){var n=this;void 0===t&&(t=0),void 0===e&&(e=1),void 0===i&&(i=1),this._isPlaying=!1,this._isLooping=!1,this._groupID=0,this._groupVolume=1,this._groupPan=0,this._startTime=0,this._groupID=t,this._groupVolume=e,this._groupPan=i,this._audio=new Audio,this._audio.ontimeupdate=function(t){return n._onTimeUpdate(t)}}return t.stopAllSounds=function(e){void 0===e&&(e=-1);var i=t._channels.length;if(e<0){for(var n=0;n<i;n++)t._channels[n].stop();t._channels.length=0}else{var r=[];for(n=0;n<i;n++)t._channels[n].groupID==e?t._channels[n].stop():r[r.length]=t._channels[n];t._channels=r}},t.setChannelGroupVolume=function(e,i){void 0===i&&(i=-1);var n=t._channels.length;if(i<0)for(var r=0;r<n;r++)t._channels[r].groupVolume=e;else for(r=0;r<n;r++)t._channels[r].groupID==i&&(t._channels[r].groupVolume=e)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this._audio.currentTime-this._startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pan",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupID",{get:function(){return this._groupID},set:function(t){this._groupID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupVolume",{get:function(){return this._groupVolume},set:function(t){this._groupVolume!=t&&(this._groupVolume=t,this._audio.volume=this._groupVolume*this._volume)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupPan",{get:function(){return this._groupPan},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume!=t&&(this._volume=t,this._audio.volume=this._volume)},enumerable:!0,configurable:!0}),t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isLooping=function(){return this._isLooping},t.prototype.isDecoding=function(){return!1},t.prototype.play=function(e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=!1),void 0===r&&(r=0),this._isPlaying=!0,this._isLooping=n,this._audio.src=t._base64Cache[r]||(t._base64Cache[r]=A.arrayBufferToBase64(e,"audio/mp3")),this._audio.loop=this._isLooping;var o=this._audio;this._audio.addEventListener("loadedmetadata",(function(){o.currentTime=i,o.play()}),!1),this._audio.addEventListener("error",(function(t){console.log("error in audio",t)}),!1),this._audio.addEventListener("error",(function(t){console.log("error in audio",t)}),!1),this._audio.addEventListener("canplay",(function(t){console.log("canplay in audio",t)}),!1),this._audio.addEventListener("canplaythrough",(function(t){console.log("canplaythrough in audio",t)}),!1),this._audio.addEventListener("abort",(function(t){console.log("abort in audio",t)}),!1),this._audio.addEventListener("loadstart",(function(t){console.log("loadstart in audio",t)}),!1),this._audio.addEventListener("suspend",(function(t){console.log("suspend in audio",t)}),!1)},t.prototype.stop=function(){this._audio.pause(),this._isPlaying=!1,this._isLooping=!1},t.prototype._onTimeUpdate=function(t){!this._isLooping&&this._audio.duration<this._audio.currentTime-this._startTime+.1&&(this.onSoundComplete&&this.onSoundComplete(),this.stop())},t.maxChannels=4,t._channels=new Array,t._base64Cache=new Object,t}(),b=function(){function t(){}return t.setVolume=function(e,i){if(void 0===i&&(i=-1),i<0)for(var n=t._channelGroupVolumes.length,r=0;r<n;r++)t._channelGroupVolumes[r]=e;else t._channelGroupVolumes[i]=e;f.setChannelGroupVolume(e,i),d.setChannelGroupVolume(e,i),v.setChannelGroupVolume(e,i)},t.getVolume=function(e){return void 0===e&&(e=0),t._channelGroupVolumes[e]},t.setExternalSoundInterface=function(e){null!=e.startSound?null!=e.stopSound?t._externalSoundInterface=e:console.log("Could not set the externalSoundInterface, because it does not provide a 'stopSound' function"):console.log("Could not set the externalSoundInterface, because it does not provide a 'startSound' function")},t.getExternalSoundInterface=function(){return t._externalSoundInterface},t.stopAllSounds=function(){f.stopAllSounds(),d.stopAllSounds(),v.stopAllSounds()},t.getChannel=function(e,i){void 0===i&&(i=0);var n=e>5e7?d:f;t.isIE&&(n=v);for(var r=0;n._channels[r]&&n._channels[r].isPlaying();)r++;if(r==n.maxChannels){for(var o=void 0,s=n._channels.length,a=0;a<s;a++)if(!(o=n._channels[a]).isLooping()&&!o.isDecoding())return o.groupID=i,o.groupVolume=t._channelGroupVolumes[i],o.groupPan=t._channelGroupPanning[i],n._channels.push(n._channels.splice(a,1)[0]),o.stop(),o;return null}return n._channels[r]=new n(i,t._channelGroupVolumes[i],t._channelGroupPanning[i])},t.isIE=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g),t._externalSoundInterface=null,t._channelGroupVolumes=[1],t._channelGroupPanning=[.5],t}(),x=function(t){function e(e,i){void 0===i&&(i=0);var n=t.call(this)||this;return n._volume=1,n._pan=0,n._audioChannels=[],n._loopsToPlay=0,n._isPlaying=!1,n._channelsPlaying=0,n._data=e,n._channelGroup=i,n}return i(e,t),Object.defineProperty(e.prototype,"isPlaying",{get:function(){return!!this._audioChannel&&this._audioChannel.isPlaying()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopsToPlay",{get:function(){return this._loopsToPlay},set:function(t){var e=this;this._loopsToPlay!=t&&(this._loopsToPlay=t,this._audioChannel&&(this._audioChannel.onSoundComplete=function(){return e._soundCompleteInternal()}))},enumerable:!0,configurable:!0}),e.prototype._soundCompleteInternal=function(){this._loopsToPlay--,this._loopsToPlay>0?(this.stop(),this.play(0,!1)):(this._channelsPlaying>0&&this._channelsPlaying--,0==this._channelsPlaying&&(this._isPlaying=!1),this._onSoundComplete&&this._onSoundComplete())},Object.defineProperty(e.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan!=t&&(this._pan=t,this._audioChannel&&(this._audioChannel.pan=this._pan))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"channelGroup",{get:function(){return this._channelGroup},set:function(t){if(this._channelGroup!=t){this._channelGroup=t;for(var e=b.getVolume(t),i=0;i<this._audioChannels.length;i++)this._audioChannels[i].groupVolume=e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){if(this._volume!=t){this._volume=t,this._audioChannel&&(this._audioChannel.volume=this._volume);for(var e=0;e<this._audioChannels.length;e++)this._audioChannels[e].volume=this._volume}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._audioChannel?this._audioChannel.currentTime:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._audioChannel?this._audioChannel.duration:0},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._isPlaying=!1,this.stop()},e.prototype.play=function(t,e){var i=this;void 0===e&&(e=!1),this._isPlaying=!0,this._audioChannel=b.getChannel(this._data.size,this.channelGroup),this._audioChannel&&(this._channelsPlaying++,this._audioChannels.push(this._audioChannel),this._audioChannel.volume=this._volume,this._audioChannel.onSoundComplete=function(){return i._soundCompleteInternal()},this._data.play(this._audioChannel,t,e,this.id))},Object.defineProperty(e.prototype,"onSoundComplete",{set:function(t){var e=this;this._onSoundComplete=t,this._audioChannel&&(this._audioChannel.onSoundComplete=function(){return e._soundCompleteInternal()})},enumerable:!0,configurable:!0}),e.prototype.stop=function(){this._isPlaying=!1;for(var t=0;t<this._audioChannels.length;t++)this._audioChannels[t].stop(),delete this._audioChannels[t];this._channelsPlaying=0,this._audioChannels.length=0,this._audioChannel=null},e.prototype.clone=function(){var t=new e(this._data);return t.name=this.name,t},e.assetType="[asset WaveAudio]",e}(p),C=function(){function t(t){t instanceof Blob?this._blob=t:this._buffer=t instanceof y?t.arraybytes:t}return Object.defineProperty(t.prototype,"size",{get:function(){return this._buffer?this._buffer.byteLength:this._blob.size},enumerable:!0,configurable:!0}),t.prototype.play=function(t,e,i,n){var r=this;if(this._buffer)t.play(this._buffer,e,i,n);else if(!this._loading){this._loading=!0;var o=new FileReader;o.onload=function(o){return r._blobConverted(o,t,e,i,n)},o.readAsArrayBuffer(this._blob)}},t.prototype._blobConverted=function(t,e,i,n,r){this._buffer=t.target.result,e.play(this._buffer,i,n,r)},t}(),w=function(){function t(){}return t.float32ColorToARGB=function(t){return[(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},t.f32_RGBA_To_f32_ARGB=function(t){return(255&t)<<24|(4278190080&t)>>>24<<16|(16711680&t)>>>16<<8|(65280&t)>>>8},t.f32_RGB_To_f32_ARGB=function(t){return(255&t)<<24|(4278190080&t)>>>24<<16|(16711680&t)>>>16<<8|(65280&t)>>>8},t.prototype.getAlphaFromF32RGBA=function(t){return 255&t},t.ARGBtoFloat32=function(t,e,i,n){return t<<24|e<<16|i<<8|n},t.componentToHex=function(t){var e=t.toString(16);return 1==e.length?"0"+e:e},t.RGBToHexString=function(e){return"#"+t.componentToHex(e[1])+t.componentToHex(e[2])+t.componentToHex(e[3])},t.ARGBToHexString=function(e){return"#"+t.componentToHex(e[0])+t.componentToHex(e[1])+t.componentToHex(e[2])+t.componentToHex(e[3])},t.interpolateFloat32Color=function(t,e,i){var n=1-i;return((4278190080&t)>>>24)*n+((4278190080&e)>>>24)*i<<24|((16711680&t)>>>16)*n+((16711680&e)>>>16)*i<<16|((65280&t)>>>8)*n+((65280&e)>>>8)*i<<8|(255&t)*n+(255&e)*i},t}(),I=function(){function t(t,e,i,n,r,o,s,a){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),t instanceof Float32Array?this._rawData=t:(this._rawData=new Float32Array(8),this.redMultiplier=Number(t),this.greenMultiplier=e,this.blueMultiplier=i,this.alphaMultiplier=n,this.redOffset=r,this.greenOffset=o,this.blueOffset=s,this.alphaOffset=a)}return t.prototype.concat=function(t){this._rawData[0]*=t._rawData[0],this._rawData[1]*=t._rawData[1],this._rawData[2]*=t._rawData[2],this._rawData[3]*=t._rawData[3],this._rawData[4]+=t._rawData[4],this._rawData[5]+=t._rawData[5],this._rawData[6]+=t._rawData[6],this._rawData[7]+=t._rawData[7]},Object.defineProperty(t.prototype,"alphaMultiplier",{get:function(){return this._rawData[3]},set:function(t){this._rawData[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alphaOffset",{get:function(){return this._rawData[7]},set:function(t){this._rawData[7]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blueMultiplier",{get:function(){return this._rawData[2]},set:function(t){this._rawData[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blueOffset",{get:function(){return this._rawData[6]},set:function(t){this._rawData[6]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"greenMultiplier",{get:function(){return this._rawData[1]},set:function(t){this._rawData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"greenOffset",{get:function(){return this._rawData[5]},set:function(t){this._rawData[5]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"redMultiplier",{get:function(){return this._rawData[0]},set:function(t){this._rawData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"redOffset",{get:function(){return this._rawData[4]},set:function(t){this._rawData[4]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._rawData[4]<<16|this._rawData[5]<<8|this._rawData[6]},set:function(t){var e=w.float32ColorToARGB(t);this._rawData[4]=e[1],this._rawData[5]=e[2],this._rawData[6]=e[3],this._rawData[0]=0,this._rawData[1]=0,this._rawData[2]=0},enumerable:!0,configurable:!0}),t.prototype.copyRawDataFrom=function(t){var e=this._rawData;e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]},t.prototype.clear=function(){this._rawData[0]=1,this._rawData[1]=1,this._rawData[2]=1,this._rawData[3]=1,this._rawData[4]=0,this._rawData[5]=0,this._rawData[6]=0,this._rawData[7]=0},t.prototype.clone=function(){var e=new t;return e.copyFrom(this),e},t.prototype.copyFrom=function(t){var e=t._rawData,i=this._rawData;i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7]},t.prototype.copyTo=function(t){t.copyFrom(this)},t.prototype.prepend=function(t){this._rawData[4]+=t._rawData[4]*this._rawData[0],this._rawData[5]+=t._rawData[5]*this._rawData[1],this._rawData[6]+=t._rawData[6]*this._rawData[2],this._rawData[7]+=t._rawData[7]*this._rawData[3],this.redMultiplier*=t.redMultiplier,this.greenMultiplier*=t.greenMultiplier,this.blueMultiplier*=t.blueMultiplier,this.alphaMultiplier*=t.alphaMultiplier},t.prototype._isRenderable=function(){return 0!=this._rawData[3]||this._rawData[7]>0},t}(),E=function(t){function e(e,i){var n=t.call(this,e)||this;return n._transform=i,n}return i(e,t),Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._transform)},e.INVALIDATE_MATRIX3D="invalidateMatrix3D",e.INVALIDATE_CONCATENATED_MATRIX3D="invalidateConcatenatedMatrix3D",e.UPDATE_CONCATENATED_MATRIX3D="updateConcatenatedMatrix3D",e.INVALIDATE_COLOR_TRANSFORM="invalidateColorTransform",e}(a),S=function(t){function e(e,i){return void 0===e&&(e=null),void 0===i&&(i=0),t.call(this,e||"ArgumentError",i)||this}return i(e,t),e}(o),D=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._rawData=new Float32Array(2),this._rawData[0]=t,this._rawData[1]=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._rawData[0]},set:function(t){this._rawData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._rawData[1]},set:function(t){this._rawData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this._rawData[0]*this._rawData[0]+this._rawData[1]*this._rawData[1])},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this._rawData[0]+e._rawData[0],this._rawData[1]+e._rawData[1])},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){this._rawData[0]=t._rawData[0],this._rawData[1]=t._rawData[1]},t.prototype.equals=function(t){return this._rawData[0]===t._rawData[0]&&this._rawData[1]==t._rawData[1]},t.prototype.normalize=function(t){void 0===t&&(t=1);var e=this.length;if((0!==this.x||0!==this.y)&&e){var i=t/e;this._rawData[0]*=i,this._rawData[1]*=i}},t.prototype.offset=function(t,e){this._rawData[0]+=t,this._rawData[1]+=e},t.prototype.setTo=function(t,e){this._rawData[0]=t,this._rawData[1]=e},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.toString=function(){return"[Point] (x="+this.x+", y="+this.y+")"},t.distance=function(t,e){var i=e.x-t.x,n=e.y-t.y;return 0===i?Math.abs(n):0===n?Math.abs(i):Math.sqrt(i*i+n*n)},t.interpolate=function(e,i,n){var r=1-n,o=e._rawData,s=i._rawData;return new t(o[0]*n+s[0]*r,o[1]*n+s[1]*r)},t.polar=function(e,i){return new t(e*Math.cos(i),e*Math.sin(i))},t}(),T=function(){function t(t,e,i,n,r,o){if(void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===r&&(r=0),void 0===o&&(o=0),this.rawData=new Float32Array(6),t instanceof Float32Array)this.copyRawDataFrom(t);else{var s=this.rawData;s[0]=Number(t),s[1]=e,s[2]=i,s[3]=n,s[4]=r,s[5]=o}}return Object.defineProperty(t.prototype,"a",{get:function(){return this.rawData[0]},set:function(t){this.rawData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.rawData[1]},set:function(t){this.rawData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"c",{get:function(){return this.rawData[2]},set:function(t){this.rawData[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"d",{get:function(){return this.rawData[3]},set:function(t){this.rawData[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tx",{get:function(){return this.rawData[4]},set:function(t){this.rawData[4]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ty",{get:function(){return this.rawData[5]},set:function(t){this.rawData[5]=t},enumerable:!0,configurable:!0}),t.prototype.copyRawDataFrom=function(t,e){void 0===e&&(e=0);var i=this.rawData;i[0]=t[e+0],i[1]=t[e+1],i[2]=t[e+2],i[3]=t[e+3],i[4]=t[e+4],i[5]=t[e+5]},t.prototype.clone=function(){var e=this.rawData;return new t(e[0],e[1],e[2],e[3],e[4],e[5])},t.prototype.concat=function(t){var e=this.rawData,i=t.rawData,n=e[0]*i[0],r=0,o=0,s=e[3]*i[3],a=e[4]*i[0]+i[4],l=e[5]*i[3]+i[5];0===e[1]&&0===e[2]&&0===i[1]&&0===i[2]||(n+=e[1]*i[2],s+=e[2]*i[1],r+=e[0]*i[1]+e[1]*i[3],o+=e[2]*i[0]+e[3]*i[2],a+=e[5]*i[2],l+=e[4]*i[1]),e[0]=n,e[1]=r,e[2]=o,e[3]=s,e[4]=a,e[5]=l},t.prototype.copyColumnFrom=function(t,e){var i=this.rawData,n=e._rawData;if(t>2)throw"Column "+t+" out of bounds (2)";0==t?(i[0]=n[0],i[1]=n[1]):1==t?(i[2]=n[0],i[3]=n[1]):(i[4]=n[0],i[5]=n[1])},t.prototype.copyColumnTo=function(t,e){var i=this.rawData,n=e._rawData;if(t>2)throw new S("ArgumentError, Column "+t+" out of bounds [0, ..., 2]");0==t?(n[0]=i[0],n[1]=i[1],n[2]=0):1==t?(n[0]=i[2],n[1]=i[3],n[2]=0):(n[0]=i[4],n[1]=i[5],n[2]=1)},t.prototype.copyFrom=function(t){var e=this.rawData,i=t.rawData;e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5]},t.prototype.copyRowFrom=function(t,e){var i=this.rawData,n=e._rawData;if(t>2)throw new S("ArgumentError, Row "+t+" out of bounds [0, ..., 2]");0==t?(i[0]=n[0],i[2]=n[1],i[4]=n[2]):(i[1]=n[0],i[3]=n[1],i[5]=n[2])},t.prototype.copyRowTo=function(t,e){var i=this.rawData,n=e._rawData;if(t>2)throw new S("ArgumentError, Row "+t+" out of bounds [0, ..., 2]");0==t?(n[0]=i[0],n[1]=i[2],n[2]=i[4]):1==t?(n[0]=i[1],n[1]=i[3],n[2]=i[5]):(n[0]=0,n[1]=0,n[2]=1)},t.prototype.createBox=function(t,e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0);var o=this.rawData;if(0!==i){var s=Math.cos(i),a=Math.sin(i);o[0]=s*t,o[1]=a*e,o[2]=-a*t,o[3]=s*e}else o[0]=t,o[1]=0,o[2]=0,o[3]=e;o[4]=n,o[5]=r},t.prototype.createGradientBox=function(t,e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this.createBox(t/1638.4,e/1638.4,i,n+t/2,r+e/2)},t.prototype.deltaTransformPoint=function(t){var e=this.rawData;return new D(t.x*e[0]+t.y*e[2],t.x*e[1]+t.y*e[3])},t.prototype.identity=function(){var t=this.rawData;t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0},t.prototype.invert=function(){var t=this.rawData,e=t[1],i=t[2],n=t[4],r=t[5];if(0===e&&0===i){var o=t[0]=1/t[0],s=t[3]=1/t[3];return t[1]=t[2]=0,t[4]=-o*n,void(t[5]=-s*r)}var a=t[0],l=t[3],u=a*l-e*i;if(0!==u){u=1/u;var c;c=t[0]=l*u,e=t[1]=-e*u,i=t[2]=-i*u,l=t[3]=a*u,t[4]=-(c*n+i*r),t[5]=-(e*n+l*r)}else this.identity()},t.prototype.multiply=function(e){var i=new t;return i.a=this.a*e.a+this.b*e.c,i.b=this.a*e.b+this.b*e.d,i.c=this.c*e.a+this.d*e.c,i.d=this.c*e.b+this.d*e.d,i.tx=this.tx*e.a+this.ty*e.c+e.tx,i.ty=this.tx*e.b+this.ty*e.d+e.ty,i},t.prototype.rotate=function(t){if(0!==t){var e=this.rawData,i=Math.cos(t),n=Math.sin(t),r=e[0],o=e[1],s=e[2],a=e[3],l=e[4],u=e[5];e[0]=r*i-o*n,e[1]=r*n+o*i,e[2]=s*i-a*n,e[3]=s*n+a*i,e[4]=l*i-u*n,e[5]=l*n+u*i}},t.prototype.scale=function(t,e){var i=this.rawData;1!==t&&(i[0]*=t,i[1]*=t,i[4]*=t),1!==e&&(i[2]*=e,i[3]*=e,i[5]*=e)},t.prototype.setTo=function(t,e,i,n,r,o){var s=this.rawData;s[0]=t,s[2]=e,s[1]=i,s[3]=n,s[4]=r,s[5]=o},t.prototype.toString=function(){return"[Matrix] (a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},t.prototype.transformPoint=function(t){var e=this.rawData;return new D(t.x*e[0]+t.y*e[2]+e[4],t.x*e[1]+t.y*e[3]+e[5])},t.prototype.translate=function(t,e){this.rawData[4]+=t,this.rawData[5]+=e},t}(),P=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),this._rawData=new Float32Array(4);var r=this._rawData;r[0]=t,r[1]=e,r[2]=i,r[3]=n}return Object.defineProperty(t.prototype,"x",{get:function(){return this._rawData[0]},set:function(t){this._rawData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._rawData[1]},set:function(t){this._rawData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._rawData[2]},set:function(t){this._rawData[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this._rawData[3]},set:function(t){this._rawData[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.lengthSquared)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSquared",{get:function(){var t=this._rawData;return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},enumerable:!0,configurable:!0}),t.prototype.add=function(e){var i=this._rawData,n=e._rawData;return new t(i[0]+n[0],i[1]+n[1],i[2]+n[2])},t.angleBetween=function(t,e){return Math.acos(t.dotProduct(e)/(t.length*e.length))},t.prototype.clone=function(){var e=this._rawData;return new t(e[0],e[1],e[2],e[3])},t.combine=function(e,i,n,r){var o=e._rawData,s=i._rawData;return new t(o[0]*n+s[0]*r,o[1]*n+s[1]*r,o[2]*n+s[2]*r)},t.prototype.copyFrom=function(t){var e=this._rawData,i=t._rawData;e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3]},t.prototype.crossProduct=function(e,i){void 0===i&&(i=null),null==i&&(i=new t);var n=this._rawData,r=e._rawData,o=i._rawData;return o[0]=n[1]*r[2]-n[2]*r[1],o[1]=n[2]*r[0]-n[0]*r[2],o[2]=n[0]*r[1]-n[1]*r[0],i},t.prototype.decrementBy=function(t){var e=this._rawData,i=t._rawData;e[0]-=i[0],e[1]-=i[1],e[2]-=i[2]},t.distance=function(t,e){var i=t._rawData,n=e._rawData,r=i[0]-n[0],o=i[1]-n[1],s=i[2]-n[2];return Math.sqrt(r*r+o*o+s*s)},t.prototype.dotProduct=function(t){var e=this._rawData,i=t._rawData;return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]},t.prototype.equals=function(t,e){void 0===e&&(e=!1);var i=this._rawData,n=t._rawData;return i[0]==n[0]&&i[1]==n[1]&&i[2]==n[2]&&(!e||i[3]==n[3])},t.prototype.identity=function(){var t=this._rawData;t[0]=0,t[1]=0,t[2]=0,t[3]=1},t.prototype.incrementBy=function(t){var e=this._rawData,i=t._rawData;e[0]+=i[0],e[1]+=i[1],e[2]+=i[2]},t.prototype.nearEquals=function(t,e,i){void 0===i&&(i=!0);var n=this._rawData,r=t._rawData;return Math.abs(n[0]-r[0])<e&&Math.abs(n[1]-r[1])<e&&Math.abs(n[2]-r[2])<e&&(!i||Math.abs(n[3]-r[3])<e)},t.prototype.negate=function(){var t=this._rawData;t[0]=-t[0],t[1]=-t[1],t[2]=-t[2]},t.prototype.normalize=function(t){void 0===t&&(t=1);var e=this.length;if(e){var i=this._rawData,n=t/e;i[0]*=n,i[1]*=n,i[2]*=n}return e},t.prototype.project=function(){var t=this._rawData;t[0]/=t[3],t[1]/=t[3],t[2]/=t[3]},t.prototype.scaleBy=function(t){var e=this._rawData;e[0]*=t,e[1]*=t,e[2]*=t},t.prototype.setTo=function(t,e,i,n){void 0===n&&(n=1);var r=this._rawData;r[0]=t,r[1]=e,r[2]=i,r[3]=n},t.prototype.subtract=function(e){var i=this._rawData,n=e._rawData;return new t(i[0]-n[0],i[1]-n[1],i[2]-n[2])},t.prototype.toString=function(){var t=this._rawData;return"[Vector3D] (x:"+t[0]+" ,y:"+t[1]+", z"+t[2]+", w:"+t[3]+")"},t.X_AXIS=new t(1,0,0),t.Y_AXIS=new t(0,1,0),t.Z_AXIS=new t(0,0,1),t}(),B=function(){function t(t,e,i,n,r,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=0),this.x=t,this.y=e,this.z=i,this.width=n,this.height=r,this.depth=o}return Object.defineProperty(t.prototype,"back",{get:function(){return this.z+this.depth},set:function(t){this.depth=t-this.z},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRightBack",{get:function(){return null==this._bottomRightBack&&(this._bottomRightBack=new P),this._bottomRightBack.x=this.x+this.width,this._bottomRightBack.y=this.y+this.height,this._bottomRightBack.z=this.z+this.depth,this._bottomRightBack},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"front",{get:function(){return this.z},set:function(t){this.depth+=this.z-t,this.z=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return null==this._size&&(this._size=new P),this._size.x=this.width,this._size.y=this.height,this._size.z=this.depth,this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeftFront",{get:function(){return null==this._topLeftFront&&(this._topLeftFront=new P),this._topLeftFront.x=this.x,this._topLeftFront.y=this.y,this._topLeftFront.z=this.z,this._topLeftFront},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.width,this.height,this.depth)},t.prototype.contains=function(t,e,i){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e&&this.z<=i&&this.z+this.depth>=i},t.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y&&this.z<=t.z&&this.z+this.depth>=t.z},t.prototype.containsBox=function(t){return this.x<=t.x&&this.x+this.width>=t.x+t.width&&this.y<=t.y&&this.y+this.height>=t.y+t.height&&this.z<=t.z&&this.z+this.depth>=t.z+t.depth},t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.width=t.width,this.height=t.height,this.depth=t.depth},t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z&&this.width==t.width&&this.height==t.height&&this.depth==t.depth},t.prototype.inflate=function(t,e,i){this.x-=t/2,this.y-=e/2,this.z-=i/2,this.width+=t/2,this.height+=e/2,this.depth+=i/2},t.prototype.inflatePoint=function(t){this.x-=t.x/2,this.y-=t.y/2,this.z-=t.z/2,this.width+=t.x/2,this.height+=t.y/2,this.depth+=t.z/2},t.prototype.intersection=function(e){if(this.intersects(e)){var i=new t;return this.x>e.x?(i.x=this.x,i.width=e.x-this.x+e.width,i.width>this.width&&(i.width=this.width)):(i.x=e.x,i.width=this.x-e.x+this.width,i.width>e.width&&(i.width=e.width)),this.y>e.y?(i.y=this.y,i.height=e.y-this.y+e.height,i.height>this.height&&(i.height=this.height)):(i.y=e.y,i.height=this.y-e.y+this.height,i.height>e.height&&(i.height=e.height)),this.z>e.z?(i.z=this.z,i.depth=e.z-this.z+e.depth,i.depth>this.depth&&(i.depth=this.depth)):(i.z=e.z,i.depth=this.z-e.z+this.depth,i.depth>e.depth&&(i.depth=e.depth)),i}return new t},t.prototype.intersects=function(t){return this.x+this.width>=t.x&&this.x<=t.x+t.width&&this.y+this.height>=t.y&&this.y<=t.y+t.height&&this.z+this.depth>=t.z&&this.z<=t.z+t.depth},t.prototype.rayIntersection=function(t,e,i){if(void 0===i&&(i=null),this.containsPoint(t))return 0;var n,r,o,s,a,l=this.width/2,u=this.height/2,c=this.depth/2,h=this.x+l,p=this.y+u,d=this.z+c,f=t.x-h,_=t.y-p,m=t.z-d,g=e.x,y=e.y,A=e.z;return g<0&&(s=(l-f)/g)>0&&(o=m+s*A,(r=_+s*y)>-u&&r<u&&o>-c&&o<c&&(i&&(i.x=1,i.y=0,i.z=0),a=!0)),!a&&g>0&&(s=(-l-f)/g)>0&&(o=m+s*A,(r=_+s*y)>-u&&r<u&&o>-c&&o<c&&(i&&(i.x=-1,i.y=0,i.z=0),a=!0)),!a&&y<0&&(s=(u-_)/y)>0&&(o=m+s*A,(n=f+s*g)>-l&&n<l&&o>-c&&o<c&&(i&&(i.x=0,i.y=1,i.z=0),a=!0)),!a&&y>0&&(s=(-u-_)/y)>0&&(o=m+s*A,(n=f+s*g)>-l&&n<l&&o>-c&&o<c&&(i&&(i.x=0,i.y=-1,i.z=0),a=!0)),!a&&A<0&&(s=(c-m)/A)>0&&(n=f+s*g,(r=_+s*y)>-u&&r<u&&n>-l&&n<l&&(i&&(i.x=0,i.y=0,i.z=1),a=!0)),!a&&A>0&&(s=(-c-m)/A)>0&&(n=f+s*g,(r=_+s*y)>-u&&r<u&&n>-l&&n<l&&(i&&(i.x=0,i.y=0,i.z=-1),a=!0)),a?s:-1},t.prototype.closestPointToPoint=function(t,e){var i;return void 0===e&&(e=null),null==e&&(e=new P),(i=t.x)<this.x&&(i=this.x),i>this.x+this.width&&(i=this.x+this.width),e.x=i,(i=t.y)<this.y+this.height&&(i=this.y+this.height),i>this.y&&(i=this.y),e.y=i,(i=t.z)<this.z&&(i=this.z),i>this.z+this.depth&&(i=this.z+this.depth),e.z=i,e},t.prototype.offset=function(t,e,i){this.x+=t,this.y+=e,this.z+=i},t.prototype.offsetPosition=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},t.prototype.identity=function(){this.x=0,this.y=0,this.z=0,this.width=0,this.height=0,this.depth=0},t.prototype.setTo=function(t,e,i,n,r,o){this.x=t,this.y=e,this.z=i,this.width=n,this.height=r,this.depth=o},t.prototype.toString=function(){return"[Box] (x="+this.x+", y="+this.y+", z="+this.z+", width="+this.width+", height="+this.height+", depth="+this.depth+")"},t.prototype.union=function(e,i){var n,r,o;return void 0===i&&(i=null),null==i&&(i=new t),null==e?(i.copyFrom(this),i):(this.x<e.x?(n=e.x-this.x+e.width,i.x=this.x,i.width=n<this.width?this.width:n):(n=this.x-e.x+this.width,i.x=e.x,i.width=n<e.width?e.width:n),this.y<e.y?(r=e.y-this.y+e.height,i.y=this.y,i.height=r<this.height?this.height:r):(r=this.y-e.y+this.height,i.y=e.y,i.height=r<e.height?e.height:r),this.z<e.z?(o=e.z-this.z+e.depth,i.z=this.z,i.depth=o<this.depth?this.depth:o):(o=this.z-e.z+this.depth,i.z=e.z,i.depth=o<e.depth?e.depth:o),i)},t}(),M=function(){function t(){}return t.RADIANS_TO_DEGREES=180/Math.PI,t.DEGREES_TO_RADIANS=Math.PI/180,t}(),O=function(){function t(){}return t.AXIS_ANGLE="axisAngle",t.EULER_ANGLES="eulerAngles",t.QUATERNION="quaternion",t}(),L=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=i,this.radius=n}return t.prototype.rayIntersection=function(t,e,i){if(this.containsPoint(t))return 0;var n,r=t.x-this.x,o=t.y-this.y,s=t.z-this.z,a=e.x,l=e.y,u=e.z,c=a*a+l*l+u*u,h=2*(r*a+o*l+s*u),p=h*h-4*c*(r*r+o*o+s*s-this.radius*this.radius);if(p>=0&&(n=(-h-Math.sqrt(p))/(2*c))>=0)return i.x=r+n*a,i.y=o+n*l,i.z=s+n*u,i.normalize(),n;return-1},t.prototype.containsPoint=function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return Math.sqrt(e*e+i*i+n*n)<=this.radius},t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.radius=t.radius},t.prototype.union=function(e,i){if(void 0===i&&(i=null),null==i&&(i=new t),null==e)return i.copyFrom(this),i;var n=e.x-this.x,r=e.y-this.y,o=e.z-this.z;return i.radius=(Math.sqrt(n*n+r*r+o*o)+e.radius+this.radius)/2,i.x=this.x+n/2,i.y=this.y+r/2,i.z=this.z+o/2,i},t.prototype.toString=function(){return"Sphere [x:"+this.x+", y:"+this.y+", z:"+this.z+", radius:"+this.radius+"]"},t}(),R=function(){function t(t){void 0===t&&(t=null),this._position=new P,this._positionDirty=!0,null!=t?this._rawData=t:(this._rawData=new Float32Array(16),this.identity())}return t.getAxisRotationMatrix=function(e,i,n,r,o){void 0===o&&(o=null),null==o&&(o=new t);var s,a,l=o._rawData,u=r*M.DEGREES_TO_RADIANS,c=Math.cos(u),h=Math.sin(u),p=1-c;return l[0]=c+e*e*p,l[5]=c+i*i*p,l[10]=c+n*n*p,s=e*i*p,a=n*h,l[1]=s+a,l[4]=s-a,s=e*n*p,a=i*h,l[8]=s+a,l[2]=s-a,s=i*n*p,a=e*h,l[9]=s-a,l[6]=s+a,l[3]=0,l[7]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,o.invalidatePosition(),o},t.getPointAtMatrix=function(e,i,n,r){var o;void 0===r&&(r=null),null==r&&(r=new t);var s=r._rawData,a=i.clone();a.normalize(),(o=n.clone()).normalize();var l=o.crossProduct(a);return l.normalize(),l.length<.05&&(l.x=o.y,l.y=o.x,l.z=0,l.normalize()),o=a.crossProduct(l),s[0]=l.x,s[1]=l.y,s[2]=l.z,s[3]=0,s[4]=o.x,s[5]=o.y,s[6]=o.z,s[7]=0,s[8]=a.x,s[9]=a.y,s[10]=a.z,s[11]=0,s[12]=l.dotProduct(e),s[13]=o.dotProduct(e),s[14]=a.dotProduct(e),s[15]=1,r.invalidatePosition(),r},t.getQuaternionMatrix=function(e,i){void 0===i&&(i=null),null==i&&(i=new t);var n=i._rawData,r=e.x,o=e.y,s=e.z,a=e.w,l=r*r,u=r*o,c=r*s,h=r*a,p=o*o,d=o*s,f=o*a,_=s*s,m=s*a;return n[0]=1-2*(p+_),n[1]=2*(u+m),n[2]=2*(c-f),n[4]=2*(u-m),n[5]=1-2*(l+_),n[6]=2*(d+h),n[8]=2*(c+f),n[9]=2*(d-h),n[10]=1-2*(l+p),n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,i.invalidatePosition(),i},t.compare=function(t,e){for(var i=t._rawData,n=e._rawData,r=0;r<16;++r)if(i[r]!=n[r])return!1;return!0},Object.defineProperty(t.prototype,"determinant",{get:function(){var t=this._rawData;return(t[0]*t[5]-t[4]*t[1])*(t[10]*t[15]-t[14]*t[11])-(t[0]*t[9]-t[8]*t[1])*(t[6]*t[15]-t[14]*t[7])+(t[0]*t[13]-t[12]*t[1])*(t[6]*t[11]-t[10]*t[7])+(t[4]*t[9]-t[8]*t[5])*(t[2]*t[15]-t[14]*t[3])-(t[4]*t[13]-t[12]*t[5])*(t[2]*t[11]-t[10]*t[3])+(t[8]*t[13]-t[12]*t[9])*(t[2]*t[7]-t[6]*t[3])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._positionDirty&&(this._positionDirty=!1,this._position.x=this._rawData[12],this._position.y=this._rawData[13],this._position.z=this._rawData[14]),this._position},enumerable:!0,configurable:!0}),t.prototype.append=function(t){var e=this._rawData,i=t._rawData,n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],f=e[11],_=e[12],m=e[13],g=e[14],y=e[15],A=i[0],v=i[1],b=i[2],x=i[3],C=i[4],w=i[5],I=i[6],E=i[7],S=i[8],D=i[9],T=i[10],P=i[11],B=i[12],M=i[13],O=i[14],L=i[15];e[0]=n*A+r*C+o*S+s*B,e[1]=n*v+r*w+o*D+s*M,e[2]=n*b+r*I+o*T+s*O,e[3]=n*x+r*E+o*P+s*L,e[4]=a*A+l*C+u*S+c*B,e[5]=a*v+l*w+u*D+c*M,e[6]=a*b+l*I+u*T+c*O,e[7]=a*x+l*E+u*P+c*L,e[8]=h*A+p*C+d*S+f*B,e[9]=h*v+p*w+d*D+f*M,e[10]=h*b+p*I+d*T+f*O,e[11]=h*x+p*E+d*P+f*L,e[12]=_*A+m*C+g*S+y*B,e[13]=_*v+m*w+g*D+y*M,e[14]=_*b+m*I+g*T+y*O,e[15]=_*x+m*E+g*P+y*L,this._positionDirty=!0},t.prototype.appendRotation=function(e,i){this.append(t.getAxisRotationMatrix(i.x,i.y,i.z,e,t._tempMatrix))},t.prototype.appendSkew=function(e,i,n){if(0!=e||0!=i||0!=n){var r=t._tempMatrix._rawData;r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=e,r[5]=1,r[6]=0,r[7]=0,r[8]=i,r[9]=n,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this.append(t._tempMatrix)}},t.prototype.appendScale=function(e,i,n){if(1!=e||1!=i||1!=n){var r=t._tempMatrix._rawData;r[0]=e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this.append(t._tempMatrix)}},t.prototype.appendTranslation=function(t,e,i){var n=this._rawData,r=n[3],o=n[7],s=n[11],a=n[15];n[0]+=t*r,n[1]+=e*r,n[2]+=i*r,n[4]+=t*o,n[5]+=e*o,n[6]+=i*o,n[8]+=t*s,n[9]+=e*s,n[10]+=i*s,n[12]+=t*a,n[13]+=e*a,n[14]+=i*a,this._positionDirty=!0},t.prototype.clone=function(){var e=new t;return e.copyFrom(this),e},t.prototype.copyColumnFrom=function(t,e){if(t<0||t>3)throw new S("ArgumentError, Column "+t+" out of bounds [0, ..., 3]");var i=this._rawData,n=e._rawData;i[t*=4]=n[0],i[t+1]=n[1],i[t+2]=n[2],i[t+3]=n[3],this._positionDirty=!0},t.prototype.copyColumnTo=function(t,e,i){if(void 0===i&&(i=!1),t<0||t>3)throw new S("ArgumentError, Column "+t+" out of bounds [0, ..., 3]");t*=4;var n=this._rawData,r=e._rawData;i?(r[0]=-n[t],r[1]=-n[t+1],r[2]=-n[t+2],r[3]=-n[t+3]):(r[0]=n[t],r[1]=n[t+1],r[2]=n[t+2],r[3]=n[t+3])},t.prototype.copyFrom=function(t,e){void 0===e&&(e=!1);var i=t._rawData,n=this._rawData;n[0]=i[0],n[5]=i[5],n[10]=i[10],n[15]=i[15],e?(n[1]=i[4],n[2]=i[8],n[3]=i[12],n[4]=i[1],n[6]=i[9],n[7]=i[13],n[8]=i[2],n[9]=i[6],n[11]=i[14],n[12]=i[3],n[13]=i[7],n[14]=i[11]):(n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14]),this._positionDirty=!0},t.prototype.copyTo=function(t,e){void 0===e&&(e=!1),t.copyFrom(this,e)},t.prototype.copyRawDataFrom=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1);var n=this._rawData;n[0]=t[e+0],n[5]=t[e+5],n[10]=t[e+10],n[15]=t[e+15],i?(n[e+1]=t[4],n[e+2]=t[8],n[e+3]=t[12],n[e+4]=t[1],n[e+6]=t[9],n[e+7]=t[13],n[e+8]=t[2],n[e+9]=t[6],n[e+11]=t[14],n[e+12]=t[3],n[e+13]=t[7],n[e+14]=t[11]):(n[1]=t[e+1],n[2]=t[e+2],n[3]=t[e+3],n[4]=t[e+4],n[6]=t[e+6],n[7]=t[e+7],n[8]=t[e+8],n[9]=t[e+9],n[11]=t[e+11],n[12]=t[e+12],n[13]=t[e+13],n[14]=t[e+14]),this._positionDirty=!0},t.prototype.copyRawDataTo=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1);var n=this._rawData;t[e]=n[0],t[e+5]=n[5],t[e+10]=n[10],t[e+15]=n[15],i?(t[e+1]=n[4],t[e+2]=n[8],t[e+3]=n[12],t[e+4]=n[1],t[e+6]=n[9],t[e+7]=n[13],t[e+8]=n[2],t[e+9]=n[6],t[e+11]=n[14],t[e+12]=n[3],t[e+13]=n[7],t[e+14]=n[11]):(t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14])},t.prototype.copyRowFrom=function(t,e){if(t<0||t>3)throw new S("ArgumentError, Row "+t+" out of bounds [0, ..., 3]");var i=this._rawData,n=e._rawData;i[t]=n[0],i[t+4]=n[1],i[t+8]=n[2],i[t+12]=n[3],this._positionDirty=!0},t.prototype.copyRowTo=function(t,e,i){if(void 0===i&&(i=!1),t<0||t>3)throw new S("ArgumentError, Row "+t+" out of bounds [0, ..., 3]");var n=this._rawData,r=e._rawData;i?(r[0]=-n[t],r[1]=-n[t+4],r[2]=-n[t+8],r[3]=-n[t+12]):(r[0]=n[t],r[1]=n[t+4],r[2]=n[t+8],r[3]=n[t+12])},t.prototype.decompose=function(t){void 0===t&&(t="eulerAngles"),null==this._components&&(this._components=[new P,new P,new P,new P]);var e=new P(this._rawData[0],this._rawData[1],this._rawData[2]),i=new P(this._rawData[4],this._rawData[5],this._rawData[6]),n=new P(this._rawData[8],this._rawData[9],this._rawData[10]),r=this._components[3],o=this._components[2];r.x=e.length,e.scaleBy(1/r.x),o.x=e.dotProduct(i),i=P.combine(i,e,1,-o.x),r.y=i.length,i.scaleBy(1/r.y),o.x/=r.y,o.y=e.dotProduct(n),n=P.combine(n,e,1,-o.y),o.z=i.dotProduct(n),n=P.combine(n,i,1,-o.z),r.z=n.length,n.scaleBy(1/r.z),o.y/=r.z,o.z/=r.z,e.dotProduct(i.crossProduct(n))<0&&(r.z=-r.z,n.x=-n.x,n.y=-n.y,n.z=-n.z);var s=this._components[1];switch(t){case O.AXIS_ANGLE:s.w=Math.acos((e.x+i.y+n.z-1)/2);var a=Math.sqrt((i.z-n.y)*(i.z-n.y)+(n.x-e.z)*(n.x-e.z)+(e.y-i.x)*(e.y-i.x));s.x=(i.z-n.y)/a,s.y=(n.x-e.z)/a,s.z=(e.y-i.x)/a;break;case O.QUATERNION:var l=e.x+i.y+n.z;l>0?(s.w=Math.sqrt(1+l)/2,s.x=(i.z-n.y)/(4*s.w),s.y=(n.x-e.z)/(4*s.w),s.z=(e.y-i.x)/(4*s.w)):e.x>i.y&&e.x>n.z?(s.x=Math.sqrt(1+e.x-i.y-n.z)/2,s.w=(i.z-n.y)/(4*s.x),s.y=(e.y+i.x)/(4*s.x),s.z=(n.x+e.z)/(4*s.x)):i.y>n.z?(s.y=Math.sqrt(1+i.y-e.x-n.z)/2,s.x=(e.y+i.x)/(4*s.y),s.w=(n.x-e.z)/(4*s.y),s.z=(i.z+n.y)/(4*s.y)):(s.z=Math.sqrt(1+n.z-e.x-i.y)/2,s.x=(n.x+e.z)/(4*s.z),s.y=(i.z+n.y)/(4*s.z),s.w=(e.y-i.x)/(4*s.z));break;case O.EULER_ANGLES:s.y=Math.asin(-e.z),1!=e.z&&-1!=e.z?(s.x=Math.atan2(i.z,n.z),s.z=Math.atan2(e.y,e.x)):(s.z=0,s.x=Math.atan2(i.x,i.y))}return this._components[0].copyFrom(this.position),this._components},t.prototype.deltaTransformVector=function(t,e){void 0===e&&(e=null);var i=t.x,n=t.y,r=t.z;e||(e=new P);var o=this._rawData,s=e._rawData;return s[0]=i*o[0]+n*o[4]+r*o[8],s[1]=i*o[1]+n*o[5]+r*o[9],s[2]=i*o[2]+n*o[6]+r*o[10],s[3]=i*o[3]+n*o[7]+r*o[11],e},t.prototype.deltaTransformVectors=function(t,e){for(var i=this._rawData,n=i[0],r=i[1],o=i[2],s=i[4],a=i[5],l=i[6],u=i[8],c=i[9],h=i[10],p=0,d=t.length,f=0;f<d;f+=3){var _=t[f],m=t[f+1],g=t[f+2];e[p++]=n*_+s*m+u*g,e[p++]=r*_+a*m+c*g,e[p++]=o*_+l*m+h*g}},t.prototype.identity=function(){var t=this._rawData;t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this._positionDirty=!0},t.prototype.invert=function(){var t=this.determinant,e=Math.abs(t)>1e-11,i=this._rawData;if(e){t=1/t;var n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],l=i[5],u=i[6],c=i[7],h=i[8],p=i[9],d=i[10],f=i[11],_=i[12],m=i[13],g=i[14],y=i[15];i[0]=t*(l*(d*y-g*f)-p*(u*y-g*c)+m*(u*f-d*c)),i[1]=-t*(r*(d*y-g*f)-p*(o*y-g*s)+m*(o*f-d*s)),i[2]=t*(r*(u*y-g*c)-l*(o*y-g*s)+m*(o*c-u*s)),i[3]=-t*(r*(u*f-d*c)-l*(o*f-d*s)+p*(o*c-u*s)),i[4]=-t*(a*(d*y-g*f)-h*(u*y-g*c)+_*(u*f-d*c)),i[5]=t*(n*(d*y-g*f)-h*(o*y-g*s)+_*(o*f-d*s)),i[6]=-t*(n*(u*y-g*c)-a*(o*y-g*s)+_*(o*c-u*s)),i[7]=t*(n*(u*f-d*c)-a*(o*f-d*s)+h*(o*c-u*s)),i[8]=t*(a*(p*y-m*f)-h*(l*y-m*c)+_*(l*f-p*c)),i[9]=-t*(n*(p*y-m*f)-h*(r*y-m*s)+_*(r*f-p*s)),i[10]=t*(n*(l*y-m*c)-a*(r*y-m*s)+_*(r*c-l*s)),i[11]=-t*(n*(l*f-p*c)-a*(r*f-p*s)+h*(r*c-l*s)),i[12]=-t*(a*(p*g-m*d)-h*(l*g-m*u)+_*(l*d-p*u)),i[13]=t*(n*(p*g-m*d)-h*(r*g-m*o)+_*(r*d-p*o)),i[14]=-t*(n*(l*g-m*u)-a*(r*g-m*o)+_*(r*u-l*o)),i[15]=t*(n*(l*d-p*u)-a*(r*d-p*o)+h*(r*u-l*o))}return this._positionDirty=!0,e},t.prototype.isIdentity=function(){var t=this._rawData;return 1==t[0]&&0==t[1]&&0==t[2]&&0==t[3]&&0==t[4]&&1==t[5]&&0==t[6]&&0==t[7]&&0==t[8]&&0==t[9]&&1==t[10]&&0==t[11]&&0==t[12]&&0==t[13]&&0==t[14]&&1==t[15]},t.prototype.prepend=function(t){var e=this._rawData,i=t._rawData,n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],l=i[5],u=i[6],c=i[7],h=i[8],p=i[9],d=i[10],f=i[11],_=i[12],m=i[13],g=i[14],y=i[15],A=e[0],v=e[1],b=e[2],x=e[3],C=e[4],w=e[5],I=e[6],E=e[7],S=e[8],D=e[9],T=e[10],P=e[11],B=e[12],M=e[13],O=e[14],L=e[15];e[0]=n*A+r*C+o*S+s*B,e[1]=n*v+r*w+o*D+s*M,e[2]=n*b+r*I+o*T+s*O,e[3]=n*x+r*E+o*P+s*L,e[4]=a*A+l*C+u*S+c*B,e[5]=a*v+l*w+u*D+c*M,e[6]=a*b+l*I+u*T+c*O,e[7]=a*x+l*E+u*P+c*L,e[8]=h*A+p*C+d*S+f*B,e[9]=h*v+p*w+d*D+f*M,e[10]=h*b+p*I+d*T+f*O,e[11]=h*x+p*E+d*P+f*L,e[12]=_*A+m*C+g*S+y*B,e[13]=_*v+m*w+g*D+y*M,e[14]=_*b+m*I+g*T+y*O,e[15]=_*x+m*E+g*P+y*L,this._positionDirty=!0},t.prototype.prependRotation=function(e,i){this.prepend(t.getAxisRotationMatrix(i.x,i.y,i.z,e,t._tempMatrix))},t.prototype.prependScale=function(e,i,n){if(1!=e||1!=i||1!=n){var r=t._tempMatrix._rawData;r[0]=e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this.prepend(t._tempMatrix)}},t.prototype.prependTranslation=function(e,i,n){var r=t._tempMatrix._rawData;r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e,r[13]=i,r[14]=n,r[15]=1,this.prepend(t._tempMatrix)},t.prototype.recompose=function(e){var i=e[0]||this.position;this.identity();var n=e[3];!n||1==n.x&&1==n.y&&1==n.z||this.appendScale(n.x,n.y,n.z);var r,o,s=e[2];!s||0==s.x&&0==s.y&&0==s.z||this.appendSkew(s.x,s.y,s.z);var a=t._tempMatrix._rawData;a[12]=0,a[13]=0,a[14]=0,a[15]=0;var l=e[1];if(l){var u=-l.x;0!=u&&(r=Math.sin(u),o=Math.cos(u),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o,a[6]=-r,a[7]=0,a[8]=0,a[9]=r,a[10]=o,a[11]=0,this.append(t._tempMatrix)),0!=(u=-l.y)&&(r=Math.sin(u),o=Math.cos(u),a[0]=o,a[1]=0,a[2]=r,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=-r,a[9]=0,a[10]=o,a[11]=0,this.append(t._tempMatrix)),0!=(u=-l.z)&&(r=Math.sin(u),o=Math.cos(u),a[0]=o,a[1]=-r,a[2]=0,a[3]=0,a[4]=r,a[5]=o,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,this.append(t._tempMatrix))}return this._rawData[12]=i.x,this._rawData[13]=i.y,this._rawData[14]=i.z,e[0]&&(this._positionDirty=!0),this._rawData[15]=1,!0},t.prototype.reflect=function(t){var e=t.a,i=t.b,n=t.c,r=t.d,o=-2*e*i,s=-2*e*n,a=-2*i*n,l=this._rawData;l[0]=1-2*e*e,l[4]=o,l[8]=s,l[12]=-2*e*r,l[1]=o,l[5]=1-2*i*i,l[9]=a,l[13]=-2*i*r,l[2]=s,l[6]=a,l[10]=1-2*n*n,l[14]=-2*n*r,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this._positionDirty=!0},t.prototype.transformBox=function(t,e){if(void 0===e&&(e=null),null==t)throw new S("ArgumentError, box cannot be null");e||(e=new B);var i=t.width/2,n=t.height/2,r=t.depth/2,o=t.x+i,s=t.y+n,a=t.z+r,l=this._rawData[0],u=this._rawData[4],c=this._rawData[8],h=this._rawData[12],p=this._rawData[1],d=this._rawData[5],f=this._rawData[9],_=this._rawData[13],m=this._rawData[2],g=this._rawData[6],y=this._rawData[10],A=o*l+s*u+a*c+h,v=o*p+s*d+a*f+_,b=o*m+s*g+a*y+this._rawData[14],x=Math.max(Math.abs(i*l+n*u+r*c),Math.abs(-i*l+n*u+r*c),Math.abs(i*l-n*u+r*c),Math.abs(i*l+n*u-r*c)),C=Math.max(Math.abs(i*p+n*d+r*f),Math.abs(-i*p+n*d+r*f),Math.abs(i*p-n*d+r*f),Math.abs(i*p+n*d-r*f)),w=Math.max(Math.abs(i*m+n*g+r*y),Math.abs(-i*m+n*g+r*y),Math.abs(i*m-n*g+r*y),Math.abs(i*m+n*g-r*y));return e.width=2*x,e.height=2*C,e.depth=2*w,e.x=A-x,e.y=v-C,e.z=b-w,e},t.prototype.transformSphere=function(t,e){if(void 0===e&&(e=null),null==t)throw new S("ArgumentError, sphere cannot be null");var i=new B(t.x-t.radius,t.y-t.radius,t.z-t.radius,2*t.radius,2*t.radius,2*t.radius);return this.transformBox(i,i),e||(e=new L),e.x=i.x+i.width/2,e.y=i.y+i.height/2,e.z=i.z+i.depth/2,e.radius=Math.max(i.width,i.height,i.depth),e},t.prototype.transformVector=function(t,e){if(void 0===e&&(e=null),null==t)throw new S("ArgumentError, vector cannot be null");var i=t.x,n=t.y,r=t.z,o=t.w;e||(e=new P);var s=this._rawData,a=e._rawData;return a[0]=i*s[0]+n*s[4]+r*s[8]+o*s[12],a[1]=i*s[1]+n*s[5]+r*s[9]+o*s[13],a[2]=i*s[2]+n*s[6]+r*s[10]+o*s[14],a[3]=i*s[3]+n*s[7]+r*s[11]+o*s[15],e},t.prototype.transformVectors=function(t,e){for(var i=0,n=0,r=0,o=0,s=this._rawData;i+3<=t.length;)n=t[i],r=t[i+1],o=t[i+2],e[i]=n*s[0]+r*s[4]+o*s[8]+s[12],e[i+1]=n*s[1]+r*s[5]+o*s[9]+s[13],e[i+2]=n*s[2]+r*s[6]+o*s[10]+s[14],i+=3},t.prototype.transpose=function(){var e=this._rawData,i=t._tempMatrix._rawData;this.copyRawDataTo(i,0,!0),e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],this._positionDirty=!0},t.prototype.invalidatePosition=function(){this._positionDirty=!0},t.prototype.toFixed=function(t){var e=Math.pow(10,t);return"matrix3d("+Math.round(this._rawData[0]*e)/e+","+Math.round(this._rawData[1]*e)/e+","+Math.round(this._rawData[2]*e)/e+","+Math.round(this._rawData[3]*e)/e+","+Math.round(this._rawData[4]*e)/e+","+Math.round(this._rawData[5]*e)/e+","+Math.round(this._rawData[6]*e)/e+","+Math.round(this._rawData[7]*e)/e+","+Math.round(this._rawData[8]*e)/e+","+Math.round(this._rawData[9]*e)/e+","+Math.round(this._rawData[10]*e)/e+","+Math.round(this._rawData[11]*e)/e+","+Math.round(this._rawData[12]*e)/e+","+Math.round(this._rawData[13]*e)/e+","+Math.round(this._rawData[14]*e)/e+","+Math.round(this._rawData[15]*e)/e+")"},t.prototype.toString=function(){return"matrix3d("+Math.round(1e3*this._rawData[0])/1e3+","+Math.round(1e3*this._rawData[1])/1e3+","+Math.round(1e3*this._rawData[2])/1e3+","+Math.round(1e3*this._rawData[3])/1e3+","+Math.round(1e3*this._rawData[4])/1e3+","+Math.round(1e3*this._rawData[5])/1e3+","+Math.round(1e3*this._rawData[6])/1e3+","+Math.round(1e3*this._rawData[7])/1e3+","+Math.round(1e3*this._rawData[8])/1e3+","+Math.round(1e3*this._rawData[9])/1e3+","+Math.round(1e3*this._rawData[10])/1e3+","+Math.round(1e3*this._rawData[11])/1e3+","+Math.round(1e3*this._rawData[12])/1e3+","+Math.round(1e3*this._rawData[13])/1e3+","+Math.round(1e3*this._rawData[14])/1e3+","+Math.round(1e3*this._rawData[15])/1e3+")"},t.CALCULATION_MATRIX=new t,t._tempMatrix=new t,t}(),N=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this)||this;return n._inverseConcatenatedMatrix3D=new R,n._matrix=null,n._rotation=new P,n._scale=new P(1,1,1),n._skew=new P,n._tempVector3D=new P,n._rawData=e||new Float32Array(24),n._matrix3D=new R(new Float32Array(n._rawData.buffer,0,16)),n._colorTransform=new I(new Float32Array(n._rawData.buffer,64,8)),n._concatenatedMatrix3D=i||n._matrix3D,null==e&&(n._matrix3D.identity(),n._colorTransform.clear()),n._components=new Array(4),n._components[1]=n._rotation,n._components[2]=n._skew,n._components[3]=n._scale,n.invalidateComponents(),n}return i(e,t),Object.defineProperty(e.prototype,"backVector",{get:function(){return this._backVector||(this._backVector=new P),this._matrix3D.copyColumnTo(2,this._backVector,!0),this._backVector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){if(t){var e=t._rawData,i=this._colorTransform._rawData;i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7]}else this._colorTransform.clear();this.invalidateColorTransform()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"concatenatedMatrix",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"concatenatedMatrix3D",{get:function(){return this._concatenatedMatrix3DDirty&&(this._concatenatedMatrix3DDirty=!1,this._concatenatedMatrix3D==this._matrix3D&&this._matrix3DDirty&&this.updateMatrix3D(),this._updateConcatenatedMatrix3D||(this._updateConcatenatedMatrix3D=new E(E.UPDATE_CONCATENATED_MATRIX3D,this)),this.dispatchEvent(this._updateConcatenatedMatrix3D)),this._concatenatedMatrix3D},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inverseConcatenatedMatrix3D",{get:function(){return this._inverseConcatenatedMatrix3DDirty&&(this._inverseConcatenatedMatrix3DDirty=!1,this._inverseConcatenatedMatrix3D.copyFrom(this.concatenatedMatrix3D),this._inverseConcatenatedMatrix3D.invert()),this._inverseConcatenatedMatrix3D},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downVector",{get:function(){return this._downVector||(this._downVector=new P),this._matrix3D.copyColumnTo(1,this._downVector,!0),this._downVector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forwardVector",{get:function(){return this._forwardVector||(this._forwardVector=new P),this._matrix3D.copyColumnTo(2,this._forwardVector),this._forwardVector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftVector",{get:function(){return this._leftVector||(this._leftVector=new P),this._matrix3D.copyColumnTo(0,this._backVector,!0),this._leftVector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrix",{get:function(){return this._matrix||(this._matrix=new T),this._matrix3DDirty&&this.updateMatrix3D(),this._matrix.a=this._matrix3D._rawData[0],this._matrix.b=this._matrix3D._rawData[1],this._matrix.c=this._matrix3D._rawData[4],this._matrix.d=this._matrix3D._rawData[5],this._matrix.tx=this._matrix3D._rawData[12],this._matrix.ty=this._matrix3D._rawData[13],this._matrix},set:function(t){t&&(this._matrix3D.identity(),this._matrix3D._rawData[0]=t.a,this._matrix3D._rawData[1]=t.b,this._matrix3D._rawData[4]=t.c,this._matrix3D._rawData[5]=t.d,this._matrix3D._rawData[12]=t.tx,this._matrix3D._rawData[13]=t.ty,this.invalidateComponents(),this.invalidateConcatenatedMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrix3D",{get:function(){return this._matrix3DDirty&&this.updateMatrix3D(),this._matrix3D},set:function(t){if(t){var e=t._rawData,i=this._matrix3D._rawData;i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]}else this._matrix3D.identity();this.invalidateComponents(),this.invalidateConcatenatedMatrix3D()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixelBounds",{get:function(){return this._pixelBounds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._matrix3D.position},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightVector",{get:function(){return this._rightVector||(this._rightVector=new P),this._matrix3D.copyColumnTo(0,this._rightVector),this._rightVector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._componentsDirty&&this._updateComponents(),this._rotation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._componentsDirty&&this._updateComponents(),this._scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this._componentsDirty&&this._updateComponents(),this._skew},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"upVector",{get:function(){return this._upVector||(this._upVector=new P),this._matrix3D.copyColumnTo(1,this._upVector),this._upVector},enumerable:!0,configurable:!0}),e.prototype.append=function(t){console.log("append("+t+") is not implemented yet in core/Transform")},e.prototype.clearColorTransform=function(){this._colorTransform&&(this._colorTransform.clear(),this.invalidateColorTransform())},e.prototype.clearMatrix3D=function(){this._matrix3D.identity(),this.invalidateComponents()},e.prototype.clone=function(){var t=new e;return this.copyRawDataTo(t),t},e.prototype.copyRawDataTo=function(t){this._matrix3DDirty&&this.updateMatrix3D();var e=t._rawData,i=this._rawData;e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e[16]=i[16],e[17]=i[17],e[18]=i[18],e[19]=i[19],e[20]=i[20],e[21]=i[21],e[22]=i[22],e[23]=i[23],this.invalidateComponents(),this.invalidateColorTransform()},e.prototype.dispose=function(){},e.prototype.globalToLocal=function(t,e){void 0===e&&(e=null),this._tempVector3D.setTo(t.x,t.y,0);var i=this.inverseConcatenatedMatrix3D.transformVector(this._tempVector3D,this._tempVector3D);return e||(e=new D),e.x=i.x,e.y=i.y,e},e.prototype.globalToLocal3D=function(t){return this.inverseConcatenatedMatrix3D.transformVector(t)},e.prototype.invalidateColorTransform=function(){this._invalidateColorTransform||(this._invalidateColorTransform=new E(E.INVALIDATE_COLOR_TRANSFORM,this)),this.dispatchEvent(this._invalidateColorTransform)},e.prototype.invalidateComponents=function(){this.invalidatePosition(),this._componentsDirty=!0},e.prototype.invalidateConcatenatedMatrix3D=function(){this._concatenatedMatrix3DDirty||(this._concatenatedMatrix3DDirty=!0,this._inverseConcatenatedMatrix3DDirty=!0,this._invalidateConcatenatedMatrix3D||(this._invalidateConcatenatedMatrix3D=new E(E.INVALIDATE_CONCATENATED_MATRIX3D,this)),this.dispatchEvent(this._invalidateConcatenatedMatrix3D))},e.prototype.invalidateMatrix3D=function(){this._concatenatedMatrix3D==this._matrix3D&&this.invalidateConcatenatedMatrix3D(),this._matrix3DDirty||(this._matrix3DDirty=!0,this._invalidateMatrix3D||(this._invalidateMatrix3D=new E(E.INVALIDATE_MATRIX3D,this)),this.dispatchEvent(this._invalidateMatrix3D))},e.prototype.invalidatePosition=function(){this._concatenatedMatrix3D==this._matrix3D&&this.invalidateConcatenatedMatrix3D(),this._matrix3D.invalidatePosition(),this._invalidateMatrix3D||(this._invalidateMatrix3D=new E(E.INVALIDATE_MATRIX3D,this)),this.dispatchEvent(this._invalidateMatrix3D)},e.prototype.localToGlobal=function(t,e){void 0===e&&(e=null),this._tempVector3D.setTo(t.x,t.y,0);var i=this.concatenatedMatrix3D.transformVector(this._tempVector3D,this._tempVector3D);return e||(e=new D),e.x=i.x,e.y=i.y,e},e.prototype.lookAt=function(t,e){void 0===e&&(e=null),null==e&&(e=P.Y_AXIS);var i=R.getPointAtMatrix(new P,t.subtract(this._matrix3D.position),e,R.CALCULATION_MATRIX).decompose()[1];this.rotateTo(i.x,i.y,i.z)},e.prototype.moveBackward=function(t){this.translateLocal(P.Z_AXIS,-t)},e.prototype.moveDown=function(t){this.translateLocal(P.Y_AXIS,-t)},e.prototype.moveForward=function(t){this.translateLocal(P.Z_AXIS,t)},e.prototype.moveLeft=function(t){this.translateLocal(P.X_AXIS,-t)},e.prototype.moveRight=function(t){this.translateLocal(P.X_AXIS,t)},e.prototype.moveTo=function(t,e,i){this._matrix3D._rawData[12]=t,this._matrix3D._rawData[13]=e,this._matrix3D._rawData[14]=i,this.invalidatePosition()},e.prototype.moveUp=function(t){this.translateLocal(P.Y_AXIS,t)},e.prototype.pitch=function(t){this.rotate(P.X_AXIS,t)},e.prototype.roll=function(t){this.rotate(P.Z_AXIS,t)},e.prototype.rotate=function(t,e){this.matrix3D.prependRotation(e,t),this.invalidateComponents()},e.prototype.rotateTo=function(t,e,i){this._componentsDirty&&this._updateComponents(),this._rotation.x=t,this._rotation.y=e,this._rotation.z=i,this.invalidateMatrix3D()},e.prototype.scaleTo=function(t,e,i){this._componentsDirty&&this._updateComponents(),this._scale.x=t,this._scale.y=e,this._scale.z=i,this.invalidateMatrix3D()},e.prototype.skewTo=function(t,e,i){this._componentsDirty&&this._updateComponents(),this._skew.x=t,this._skew.y=e,this._skew.z=i,this.invalidateMatrix3D()},e.prototype.translate=function(t,e){var i=t.x,n=t.y,r=t.z,o=e/Math.sqrt(i*i+n*n+r*r);this.matrix3D.appendTranslation(i*o,n*o,r*o),this.invalidatePosition()},e.prototype.translateLocal=function(t,e){var i=t.x,n=t.y,r=t.z,o=e/Math.sqrt(i*i+n*n+r*r);this.matrix3D.prependTranslation(i*o,n*o,r*o),this.invalidatePosition()},e.prototype.updateMatrix3D=function(){this._matrix3D.recompose(this._components),this._matrix3DDirty=!1},e.prototype.yaw=function(t){this.rotate(P.Y_AXIS,t)},e.prototype._updateComponents=function(){var t,e=this._matrix3D.decompose();t=e[1],this._rotation.x=t.x,this._rotation.y=t.y,this._rotation.z=t.z,t=e[2],this._skew.x=t.x,this._skew.y=t.y,this._skew.z=t.z,t=e[3],this._scale.x=t.x,this._scale.y=t.y,this._scale.z=t.z,this._componentsDirty=!1},e}(u),F=(function(t){function e(e,i){return void 0===e&&(e="DocumentError"),void 0===i&&(i=0),t.call(this,e,i)||this}i(e,t),e.DOCUMENT_DOES_NOT_EXIST="documentDoesNotExist"}(o),function(t){function e(e,i){return void 0===e&&(e=""),void 0===i&&(i=0),t.call(this,"PartialImplementationError - this function is in development. Required Dependency: "+e,i)||this}return i(e,t),e}(o)),k=function(t){function e(e,i){return void 0===e&&(e=null),void 0===i&&(i=0),t.call(this,e||"RangeError",i)||this}return i(e,t),e}(o),V=function(t){function e(e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null);var o=t.call(this,e)||this;return o._url=i,o._content=n,o._assets=r,o}return i(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assets",{get:function(){return this._assets},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._url,this._content,this._assets)},e.LOADER_START="loaderStart",e.LOADER_COMPLETE="loaderComplete",e}(a),U=function(t){function e(e,i){void 0===i&&(i="");var n=t.call(this,e)||this;return n._message=i,n}return i(e,t),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._message)},e.PARSE_COMPLETE="parseComplete",e.PARSE_ERROR="parseError",e.READY_FOR_DEPENDENCIES="readyForDependencies",e}(a),j=function(t){function e(e,i){var n=t.call(this,e)||this;return n._projection=i,n}return i(e,t),Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},enumerable:!0,configurable:!0}),e.INVALIDATE_FRUSTUM_MATRIX3D="invalidateFrustumMatrix3D",e.INVALIDATE_VIEW_MATRIX3D="invalidateViewMatrix3D",e}(a),G=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.TIMER="timer",e.TIMER_COMPLETE="timerComplete",e}(a),Q=function(t){function e(e,i){var n=t.call(this,e)||this;return n._urlLoader=i,n}return i(e,t),Object.defineProperty(e.prototype,"urlLoader",{get:function(){return this._urlLoader},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._urlLoader)},e.HTTP_STATUS="httpStatus",e.LOAD_ERROR="loadError",e.LOAD_PROGRESS="loadProgress",e.LOAD_START="loadStart",e.LOAD_COMPLETE="loadComplete",e}(a),z=function(){function t(){}return t.BACK=0,t.FRONT=1,t.IN=0,t.OUT=1,t.INTERSECT=2,t}(),H=function(){function t(e,i,n,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this.a=e,this.b=i,this.c=n,this.d=r,this._iAlignment=0==e&&0==i?t.ALIGN_XY_AXIS:0==i&&0==n?t.ALIGN_YZ_AXIS:0==e&&0==n?t.ALIGN_XZ_AXIS:t.ALIGN_ANY}return t.prototype.fromPoints=function(e,i,n){var r=i.x-e.x,o=i.y-e.y,s=i.z-e.z,a=n.x-e.x,l=n.y-e.y,u=n.z-e.z;this.a=o*u-s*l,this.b=s*a-r*u,this.c=r*l-o*a,this.d=this.a*e.x+this.b*e.y+this.c*e.z,0==this.a&&0==this.b?this._iAlignment=t.ALIGN_XY_AXIS:0==this.b&&0==this.c?this._iAlignment=t.ALIGN_YZ_AXIS:0==this.a&&0==this.c?this._iAlignment=t.ALIGN_XZ_AXIS:this._iAlignment=t.ALIGN_ANY},t.prototype.fromNormalAndPoint=function(e,i){this.a=e.x,this.b=e.y,this.c=e.z,this.d=this.a*i.x+this.b*i.y+this.c*i.z,0==this.a&&0==this.b?this._iAlignment=t.ALIGN_XY_AXIS:0==this.b&&0==this.c?this._iAlignment=t.ALIGN_YZ_AXIS:0==this.a&&0==this.c?this._iAlignment=t.ALIGN_XZ_AXIS:this._iAlignment=t.ALIGN_ANY},t.prototype.normalize=function(){var t=1/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);return this.a*=t,this.b*=t,this.c*=t,this.d*=t,this},t.prototype.distance=function(e){return this._iAlignment==t.ALIGN_YZ_AXIS?this.a*e.x-this.d:this._iAlignment==t.ALIGN_XZ_AXIS?this.b*e.y-this.d:this._iAlignment==t.ALIGN_XY_AXIS?this.c*e.z-this.d:this.a*e.x+this.b*e.y+this.c*e.z-this.d},t.prototype.classifyPoint=function(e,i){return void 0===i&&(i=.01),this.d!=this.d?z.FRONT:(n=this._iAlignment==t.ALIGN_YZ_AXIS?this.a*e.x-this.d:this._iAlignment==t.ALIGN_XZ_AXIS?this.b*e.y-this.d:this._iAlignment==t.ALIGN_XY_AXIS?this.c*e.z-this.d:this.a*e.x+this.b*e.y+this.c*e.z-this.d)<-i?z.BACK:n>i?z.FRONT:z.INTERSECT;var n},t.prototype.toString=function(){return"Plane3D [a:"+this.a+", b:"+this.b+", c:"+this.c+", d:"+this.d+"]"},t.ALIGN_ANY=0,t.ALIGN_XY_AXIS=1,t.ALIGN_YZ_AXIS=2,t.ALIGN_XZ_AXIS=3,t}(),X=function(){function t(){}return t.initDistributions=function(){this._distributions=new Array,this._distributions[0]=new Array(.3082841,.4320919),this._distributions[1]=new Array(.3082841,.4320919,-.2274942,-.6640266),this._distributions[2]=new Array(.8742689,.0009265686,-.6864116,-.5536607,-.2325206,.7678371),this._distributions[3]=new Array(.3913446,-.7084417,-.7511101,-.5935929,-.2323436,.5320091,.8435315,.5035911),this._distributions[4]=new Array(.2122471,-.5771395,-.8543506,-.1763534,.5189021,.8323698,-.3616908,.5865368,.9523004,-.04948437),this._distributions[5]=new Array(.5791035,.3496495,.2959551,-.6006749,-.2419119,-.06879545,-.7403072,.6110353,-.04555973,.8059174,-.5275017,-.737129),this._distributions[6]=new Array(.06941478,.8519508,-.7441907,.2426432,.6439992,-.2405252,-.1007523,-.2327587,-.6427067,-.7248485,.8050759,.5492936,.3573822,-.8824506),this._distributions[7]=new Array(.8509863,.4452587,-.09507271,.2073005,.1706571,-.6434793,.8029777,-.2718274,-.4401725,.8196304,.2715359,.8598521,-.8121575,-.006447683,-.6486837,-.7237598),this._distributions[8]=new Array(.6951686,-.2680728,-.04933243,.3710589,.6592212,.3661054,-.01579228,-.6909603,-.3275101,-.1756866,.3811549,.9218544,-.216032,.9755028,-.7065172,.3355389,-.6579109,-.6798355),this._distributions[9]=new Array(.6181276,-.09790418,-.2537868,-.5570995,-.1964931,.3459414,.3474613,-.8885581,.5135743,.5753114,-.9549091,.1480672,-.8711916,-.4293123,-.6928071,.6190156,-.13369,.8892705,.0548224,-.1246777),this._distributions[10]=new Array(.4853027,-.5080479,-.1331675,-.506597,.139575,.01316885,.803486,-.07568797,.5240274,.4883182,-.4334005,.1207938,-.7794577,-.3985141,.1576432,-.9861221,-.3712867,.6959021,.1517378,.9847429,-.9762396,.1661073),this._distributions[11]=new Array(-.2790166,-.01252619,.3389016,.3921154,.2408341,-.313211,-.8151779,-.3898362,-.6347761,.3486495,.09471484,-.7722448,-.1385674,.6364574,.2456331,.9295807,-.3864306,-.8247881,.6111673,-.7164014,.8287669,.05466961,.837706,.5415626),this._distributions[12]=new Array(.056417,.3185693,-.8245888,.1882799,.8575996,.1136829,.1070375,.875332,.4076743,-.06000621,-.4311306,.7239349,.2677574,-.538472,-.08486642,-.2083647,-.888989,-.3906443,-.4768958,-.6664082,.09334993,-.9861541,.808736,-.455949,.5889823,.7660807),this._distributions[13]=new Array(-.2681346,-.3955857,-.1315102,-.8852947,-.5143692,.09551838,.4344836,-.546945,-.8620899,-.3813288,.1650431,.02034803,-.1543657,.3842218,-.828457,.5376903,-.6145,-.7818927,-.2639062,.8784655,.1912684,.9720125,.3135219,.5224229,.7850655,.4592297,.7465045,-.1368916),this._distributions[14]=new Array(.4241029,.695281,.150511,-.02304107,-.2482675,.9120338,.8057325,.2622084,-.2445909,.2765962,.8588713,-.1772072,.3117845,-.4385471,-.3923851,-.3298936,-.1751254,-.7405846,.6926506,-.684163,-.9304563,-.3254691,-.8533293,.1523024,.2510415,-.917345,-.6239773,-.7105472,-.6104624,.6041355),this._distributions[15]=new Array(.5844554,.06651045,.1343258,.6756578,.3799674,-.6301104,.5590436,.7940555,.09574714,.02262517,.8697868,.393301,.003945862,-.421735,.9043913,-.2432393,-.4844007,.7190998,-.3201078,.2972371,-.3852352,-.6341155,-.5413069,-.09223081,-.8468984,-.5126905,.004156174,-.8633173,-.9681889,-.03305046,-.846509,.4414353),this._distributions[16]=new Array(.4506488,.657668,.4621297,.07441051,-.2782125,.6201044,.9750003,.09110117,.1019436,.2986514,.03457398,.9631706,.542098,-.5505635,.8675668,.4938077,-.5414361,.2655292,-.7941836,.6003053,-.09847672,-.1001604,-.9316511,-.08572888,.07286467,-.611899,-.5232627,-.4082253,-.5481608,-.827938,-.1551939,-.9621193,.9220031,-.3315949),this._distributions[17]=new Array(.197908,-.4697656,-.4474689,-.3428435,.8529873,-.2228634,.6022478,-.5469642,.2545276,-.931133,-.1507547,-.7855865,-.07606658,.1011628,.3046715,.2785755,.4698432,-.1064076,.6831254,.4152522,.1374381,.8363233,-.2166121,.6682042,.5511393,.7996449,-.4278994,.28836,-.8875198,.2181732,-.8772842,-.2818254,-.7000262,.5762185,-.6062385,-.7439126),this._distributions[18]=new Array(.6645703,-.05678739,.5720971,.4533803,-.07660709,.08802763,.5163431,-.4426552,.1163455,-.3404382,-.4004807,-.5046007,.2932099,-.8201418,-.5322125,.03834766,-.1490209,-.8817304,-.8000439,-.3509448,.5260983,.8421043,.1197811,.6963812,.9498612,.3122156,-.9285746,.02120355,-.6670724,.7217396,.9155889,-.3510147,-.271941,.4727852,.318879,.1634057,-.2686755,.9253026),this._distributions[19]=new Array(.5064292,.422527,.8935515,-.06610427,.1199719,.175568,.403388,-.2003276,.1657927,.8154403,.9301245,.2929218,-.1644068,.6201534,.7113559,-.6589743,-.3364046,-.1799502,.02109996,-.392765,-.382213,.3219992,-.9201946,.1207967,-.726185,.4291916,-.7443482,-.2480059,-.5147594,.7418784,.1935272,-.7406143,-.3643523,-.5559214,-.7147766,-.6326278,-.2524151,-.9096627,.5161405,.7908453),this._distributions[20]=new Array(.7921003,-.3032096,.5992879,-.009052323,.2538549,-.1872749,.7053444,.3677175,.5417761,-.8170255,.9749611,.1210478,.1969143,-.6117041,-.1824499,-.4634196,-.1181338,-.8668742,-.3050112,-.1352596,-.4409327,-.7082354,-.03225285,.1171548,.3113096,.3250439,-.8166144,-.463995,-.01014475,.4715334,-.6868284,.05091889,-.4011163,.2717285,-.06756835,.8307694,-.7938535,.4352129,-.4663842,.7165329,.559729,.8093995),this._distributions[21]=new Array(.07832243,.426151,-.3856795,.5799953,.01970797,.06706189,.4822682,.3014512,-.1532982,.87485,-.4959527,.07888043,.260601,-.2304784,.4996209,.7167382,.585986,-.04265174,-.7679967,.5509416,-.9041753,.1802134,-.8407655,-.4442826,-.2058258,-.2636995,-.4984115,-.5928579,.2926032,-.7886473,-.06933882,-.621177,.578115,-.4813387,.8981777,-.3291056,.1942733,.9255584,.8084362,.5066984,.9920095,.03103104,-.2403206,-.9389018),this._distributions[22]=new Array(-.5691095,.1014316,-.7788262,.384012,-.8253665,-.1645582,-.1830993,.002997211,-.2555013,-.4177977,-.6640869,-.4794711,-.2351242,.5850121,.02436554,.2825883,.006061143,-.8200245,.1618791,-.3063331,-.3765897,-.7249815,.6092919,-.6769328,-.5956934,.6957655,.5383642,.4522677,-.1489165,.9125596,.4167473,.1335986,.1898309,.5874342,.2288171,.9624356,.7540846,-.07672304,.8986252,.2788797,.3555991,-.9262139,.8454325,-.4027667,.4945236,-.2935512),this._distributions[23]=new Array(-.4481403,-.3758374,-.8877251,.08739938,.05015831,-.1339983,-.4070427,-.8534173,.1019274,-.5503222,-.445998,.1997541,-.8686263,-.2788867,-.7695944,-.6033704,-.05515742,-.885711,-.7714347,.5790485,.3466263,-.8799297,.4487582,-.5321087,-.2461368,.6053771,-.05568117,.2457351,-.4668669,.8523816,.8103387,-.4255538,.4054182,-.175663,-.2802011,-.08920153,.2665959,.382935,.555679,.1621837,.105246,.8420411,.6921161,.6902903,.880946,.2483067,.9699264,-.1021767),this._distributions[24]=new Array(-.1703323,-.3119385,.2916039,-.2988263,-.008472982,-.9277695,-.7730271,-.3277904,.3440474,-.6815342,-.2910278,.03461745,-.6764899,-.657078,-.3505501,-.7311988,-.03478927,.3258755,-.6048835,.159423,.2035525,.02212214,.5116573,.2226856,.6664805,-.2500189,.7147882,-.6609634,.03030632,-.5763278,-.2516585,.6116219,-.9434413,-.0116792,.9061816,.2491155,.182867,.6076167,.286593,.9485695,-.5992439,.6970096,-.2082874,.9416641,.9880044,-.1541709,-.9122881,.331555,.7324886,.6725098),this._distributions[25]=new Array(.3869598,-.04974834,.7168844,-.0693711,-.07166742,.1725325,.4599592,.3232779,.5872094,-.4198674,.2442266,-.625667,.1254557,.4500048,-.2290154,-.1803567,.890583,.3373493,.1256081,.7853789,-.2676466,.5305805,-.7063224,.252168,-.3989835,.1189921,.09617215,-.2451447,.6302541,.6085876,.9380925,-.3234899,.5086241,-.8573482,.03576187,-.9876697,-.0876712,-.6365195,-.5276513,.823456,-.6935764,-.2240411,-.5212318,-.5383121,-.2116208,.9639363,-.9840096,.02743555,-.3991577,-.8994547,-.7830126,.614068),this._distributions[26]=new Array(-.8366601,.4464895,-.5917366,-.02073906,-.9845258,.1635625,-.3097973,.4379579,-.5478154,.7173221,-.1685888,.9261969,.01503595,.6046097,.4452421,.5449086,.0315687,.1944619,.3753404,.8688548,.4143643,.1396648,.8711032,.4304703,.7328773,.1461501,.6374492,-.3521495,.145613,-.1341466,.9040975,-.135123,-.7839059,-.5450199,-.516019,-.3320859,-.206158,-.4431106,-.9703014,-.2368356,-.2473119,-.0864351,.2130725,-.4604077,-.003726701,-.7122303,-.4072131,-.6833169,.1632999,-.9776646,.4686888,-.680495,-.2293511,-.9509777),this._distributions[27]=new Array(.107311,-.1311369,-.4194764,-.3148777,.6171439,-.2745973,.2796618,.1937153,-.09106886,.4180236,.6044006,.05577846,.02927299,-.6738263,-.2580845,.1179939,-.09023564,-.3830024,.3570953,-.5000587,.81591,-.5518309,.9300217,-.1257987,.4904627,-.8381903,-.3163182,-.8632009,.1137595,-.9875998,.8390043,.3538185,.2149114,.4993694,.5191584,.3833552,.5002763,.7061465,-.2567276,.9068756,-.5197366,.3467845,.03668867,.9734009,-.5347553,.66747,-.9028882,.1023768,-.8967977,.412834,-.5821944,.0426479,-.8032165,-.2397038,-.5597343,-.6358021),this._distributions[28]=new Array(-.6562496,-.1781036,-.9301494,.1185208,-.3861143,-.4153562,-.1560799,-.1099607,-.5587025,.395218,-.5322112,-.699701,-.5008639,.08726846,-.970524,-.1963461,-.813577,-.5185111,-.1644458,.298,-.3216791,.639982,.3315373,.3339162,.2383235,-.00105722,.1137828,.5450742,-.01899921,.8798413,.2849685,.8255596,.6974412,.2123175,.7588523,.5470437,.5102502,-.1687844,.5853448,.8033476,.2590716,-.5262504,.5607718,-.6342825,.8666443,-.1491841,.8341052,-.4935003,-.1568441,-.6634066,.2512113,-.8769391,-.2559827,-.9572457,-.01928852,-.3966542,-.750667,.6409678),this._distributions[29]=new Array(.3454786,-.04837726,.2649553,.2406852,.5599093,-.3839145,-.1111814,-.05502108,.7586042,-.05818377,.2519488,-.4665135,-.1264972,.2602723,-.08766216,-.3671907,.6428129,.3999204,-.6105871,-.1246869,-.4589451,-.7646643,-.03021116,-.7899352,-.6036922,-.4293956,-.2481938,.6534185,.102798,.6784465,-.6392644,.4821358,-.6789002,.1779133,-.9140783,-.1989647,-.9262617,.3381507,.4794891,-.8093274,.3959447,.668478,.9602883,.2272305,-.123672,.9210883,.2375148,.9523395,-.52898,.7973378,-.382433,.1228794,.695015,.6948439,.7530277,-.6458191,.8777987,-.3272956,.2318525,-.962768),this._distributions[30]=new Array(.4518921,-.1146195,.4720805,-.4238748,.3655423,.1806341,.1589939,-.23568,.7673324,-.5149941,.01163658,.09045836,.7010971,.1245747,.7518286,-.1855433,.4960719,.4601022,.2566979,-.6308268,-.0654714,-.5126389,-.1823319,-.1343282,-.1464312,.4883236,-.3858738,.203523,.1484799,.4432284,-.477109,-.116241,.2719092,.7208626,.9104174,.3578536,-.5956199,.7662588,-.6996251,.3678654,-.2514512,.9251933,.1275825,-.9478135,-.204608,-.8611552,.4264838,-.877443,.9854161,.05521112,.5912951,.7997434,.1140349,.982093,-.9324368,-.2094094,-.42436,-.6441524,-.6722705,-.3554261,-.7844236,.08587621),this._distributions[31]=new Array(-.4206714,-.5613642,-.8733016,-.3373051,-.1046226,-.2902999,-.1318562,-.8434365,.1145093,-.5962623,-.4965627,-.1873259,-.5011808,-.8546229,-.7165636,-.5743566,.1090901,.2017643,.3404809,-.220455,-.1989015,.2372122,-.4538706,.0979171,.4514146,-.572846,.2314168,-.8514503,-.4247236,.5650803,-.943347,.04514639,-.1309718,.5221877,-.7004157,.4561877,.6306441,.04448673,.4301621,.5766876,.1078042,.7245752,.3875354,.2794483,.702876,-.2924213,.7360667,-.6210318,.7486517,.6531103,.4898235,.8591025,.6549174,.3854057,-.2596106,.7916998,.9251194,-.05296265,-.5620695,.820877,-.01228026,.9937211,.9612103,.2628758)},t.getDistribution=function(t){return this._distributions||this.initDistributions(),t<1||t>32?null:this._distributions[t-1]},t}(),q=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),this.x=0,this.y=0,this.z=0,this.w=1,this.x=t,this.y=e,this.z=i,this.w=n}return Object.defineProperty(t.prototype,"magnitude",{get:function(){return Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),t.prototype.multiply=function(t,e){var i=t.w,n=t.x,r=t.y,o=t.z,s=e.w,a=e.x,l=e.y,u=e.z;this.w=i*s-n*a-r*l-o*u,this.x=i*a+n*s+r*u-o*l,this.y=i*l-n*u+r*s+o*a,this.z=i*u+n*l-r*a+o*s},t.prototype.multiplyVector=function(e,i){void 0===i&&(i=null),null===i&&(i=new t);var n=e.x,r=e.y,o=e.z;return i.w=-this.x*n-this.y*r-this.z*o,i.x=this.w*n+this.y*o-this.z*r,i.y=this.w*r-this.x*o+this.z*n,i.z=this.w*o+this.x*r-this.y*n,i},t.prototype.fromAxisAngle=function(t,e){var i=Math.sin(e/2),n=Math.cos(e/2);this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this.w=n,this.normalize()},t.prototype.slerp=function(t,e,i){var n=t.w,r=t.x,o=t.y,s=t.z,a=e.w,l=e.x,u=e.y,c=e.z,h=n*a+r*l+o*u+s*c;if(h<0&&(h=-h,a=-a,l=-l,u=-u,c=-c),h<.95){var p=Math.acos(h),d=1/Math.sin(p),f=Math.sin(p*(1-i))*d,_=Math.sin(p*i)*d;this.w=n*f+a*_,this.x=r*f+l*_,this.y=o*f+u*_,this.z=s*f+c*_}else{this.w=n+i*(a-n),this.x=r+i*(l-r),this.y=o+i*(u-o),this.z=s+i*(c-s);var m=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);this.w*=m,this.x*=m,this.y*=m,this.z*=m}},t.prototype.lerp=function(t,e,i){var n=t.w,r=t.x,o=t.y,s=t.z,a=e.w,l=e.x,u=e.y,c=e.z;n*a+r*l+o*u+s*c<0&&(a=-a,l=-l,u=-u,c=-c),this.w=n+i*(a-n),this.x=r+i*(l-r),this.y=o+i*(u-o),this.z=s+i*(c-s);var h=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);this.w*=h,this.x*=h,this.y*=h,this.z*=h},t.prototype.fromEulerAngles=function(t,e,i){var n=.5*t,r=.5*e,o=.5*i,s=Math.cos(n),a=Math.sin(n),l=Math.cos(r),u=Math.sin(r),c=Math.cos(o),h=Math.sin(o);this.w=s*l*c+a*u*h,this.x=a*l*c-s*u*h,this.y=s*u*c+a*l*h,this.z=s*l*h-a*u*c},t.prototype.toEulerAngles=function(t){return void 0===t&&(t=null),null===t&&(t=new P),t.x=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),t.y=Math.asin(2*(this.w*this.y-this.z*this.x)),t.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z)),t},t.prototype.normalize=function(t){void 0===t&&(t=1);var e=t/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);this.x*=e,this.y*=e,this.z*=e,this.w*=e},t.prototype.toString=function(){return"{x:"+this.x+" y:"+this.y+" z:"+this.z+" w:"+this.w+"}"},t.prototype.toMatrix3D=function(t){void 0===t&&(t=null);var e=2*this.x*this.y,i=2*this.x*this.z,n=2*this.x*this.w,r=2*this.y*this.z,o=2*this.y*this.w,s=2*this.z*this.w,a=this.x*this.x,l=this.y*this.y,u=this.z*this.z,c=this.w*this.w;t||(t=new R);var h=t._rawData;return h[0]=a-l-u+c,h[4]=e-s,h[8]=i+o,h[12]=0,h[1]=e+s,h[5]=-a+l-u+c,h[9]=r-n,h[13]=0,h[2]=i-o,h[6]=r+n,h[10]=-a-l+u+c,h[14]=0,h[3]=0,h[7]=0,h[11]=0,h[15]=1,t},t.prototype.fromMatrix=function(t){var e=t.decompose(O.QUATERNION)[1];this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w},t.prototype.toRawData=function(t,e){void 0===e&&(e=!1);var i=2*this.x*this.y,n=2*this.x*this.z,r=2*this.x*this.w,o=2*this.y*this.z,s=2*this.y*this.w,a=2*this.z*this.w,l=this.x*this.x,u=this.y*this.y,c=this.z*this.z,h=this.w*this.w;t[0]=l-u-c+h,t[1]=i-a,t[2]=n+s,t[4]=i+a,t[5]=-l+u-c+h,t[6]=o-r,t[8]=n-s,t[9]=o+r,t[10]=-l-u+c+h,t[3]=t[7]=t[11]=0,e||(t[12]=t[13]=t[14]=0,t[15]=1)},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.rotatePoint=function(t,e){void 0===e&&(e=null);var i=t.x,n=t.y,r=t.z;null===e&&(e=new P);var o=-this.x*i-this.y*n-this.z*r,s=this.w*i+this.y*r-this.z*n,a=this.w*n-this.x*r+this.z*i,l=this.w*r+this.x*n-this.y*i;return e.x=-o*this.x+s*this.w-a*this.z+l*this.y,e.y=-o*this.y+s*this.z+a*this.w-l*this.x,e.z=-o*this.z-s*this.y+a*this.x+l*this.w,e},t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w},t}(),Y=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this._rawData=new Float32Array(4);var r=this._rawData;r[0]=t,r[1]=e,r[2]=i,r[3]=n}return t.prototype.axCallPublicProperty=function(t,e){return null},t.prototype.axGetPublicProperty=function(t){return null},t.prototype.axSetPublicProperty=function(t){return null},Object.defineProperty(t.prototype,"height",{get:function(){return this._rawData[3]},set:function(t){this._rawData[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._rawData[2]},set:function(t){this._rawData[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._rawData[0]},set:function(t){this._rawData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._rawData[1]},set:function(t){this._rawData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this._rawData[1]+this._rawData[3]},set:function(t){this._rawData[3]=t-this._rawData[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return null==this._bottomRight&&(this._bottomRight=new D),this._bottomRight._rawData[0]=this._rawData[0]+this._rawData[2],this._bottomRight._rawData[1]=this._rawData[1]+this._rawData[3],this._bottomRight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this._rawData[0]},set:function(t){this._rawData[2]+=this._rawData[0]-t,this._rawData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this._rawData[0]+this._rawData[2]},set:function(t){this._rawData[2]=t-this._rawData[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return null==this._size&&(this._size=new D),this._size._rawData[0]=this._rawData[2],this._size._rawData[1]=this._rawData[3],this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this._rawData[1]},set:function(t){this._rawData[3]+=this._rawData[1]-t,this._rawData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return null==this._topLeft&&(this._topLeft=new D),this._topLeft._rawData[0]=this._rawData[0],this._topLeft._rawData[1]=this._rawData[1],this._topLeft},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var e=this._rawData;return new t(e[0],e[1],e[2],e[3])},t.prototype.contains=function(t,e){var i=this._rawData;return i[0]<=t&&i[0]+i[2]>=t&&i[1]<=e&&i[1]+i[3]>=e},t.prototype.containsPoint=function(t){var e=this._rawData,i=t._rawData;return e[0]<=i[0]&&e[0]+e[2]>=i[0]&&e[1]<=i[1]&&e[1]+e[3]>=i[1]},t.prototype.containsRect=function(t){var e=this._rawData,i=t._rawData;return e[0]<=i[0]&&e[0]+e[2]>=i[0]+i[2]&&e[1]<=i[1]&&e[1]+e[3]>=i[1]+i[3]},t.prototype.copyFrom=function(t){var e=this._rawData,i=t._rawData;e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3]},t.prototype.equals=function(t){var e=this._rawData,i=t._rawData;return e[0]==i[0]&&e[1]==i[1]&&e[2]==i[2]&&e[3]==i[3]},t.prototype.inflate=function(t,e){var i=this._rawData;i[0]-=t/2,i[1]-=e/2,i[2]+=t/2,i[3]+=e/2},t.prototype.inflatePoint=function(t){var e=this._rawData;e[0]-=t.x/2,e[1]-=t.y/2,e[2]+=t.x/2,e[3]+=t.y/2},t.prototype.intersection=function(e){var i=this._rawData,n=e._rawData;if(this.intersects(e)){var r=new t,o=r._rawData;return i[0]>n[0]?(o[0]=i[0],o[2]=n[0]-i[0]+n[2],o[2]>i[2]&&(o[2]=i[2])):(o[0]=n[0],o[2]=i[0]-n[0]+i[2],o[2]>n[2]&&(o[2]=n[2])),i[1]>n[1]?(o[1]=i[1],o[3]=n[1]-i[1]+n[3],o[3]>i[3]&&(o[3]=i[3])):(o[1]=n[1],o[3]=i[1]-n[1]+i[3],o[3]>n[3]&&(o[3]=n[3])),r}return new t},t.prototype.intersects=function(t){var e=this._rawData,i=t._rawData;return e[0]+e[2]>i[0]&&e[0]<i[0]+i[2]&&e[1]+e[3]>i[1]&&e[1]<i[1]+i[3]},t.prototype.isEmpty=function(){var t=this._rawData;return 0==t[0]&&0==t[1]&&0==t[2]&&0==t[3]},t.prototype.offset=function(t,e){this._rawData[0]+=t,this._rawData[1]+=e},t.prototype.offsetPoint=function(t){this._rawData[0]+=t.x,this._rawData[1]+=t.y},t.prototype.setEmpty=function(){var t=this._rawData;t[0]=0,t[1]=0,t[2]=0,t[3]=0},t.prototype.setTo=function(t,e,i,n){var r=this._rawData;r[0]=t,r[1]=e,r[2]=i,r[3]=n},t.prototype.toString=function(){return"[Rectangle] (x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},t.prototype.union=function(e){var i=this._rawData,n=e._rawData,r=new t,o=r._rawData;return i[0]<n[0]?(o[0]=i[0],o[2]=n[0]-i[0]+n[2],o[2]<i[2]&&(o[2]=i[2])):(o[0]=n[0],o[2]=i[0]-n[0]+i[2],o[2]<n[2]&&(o[2]=n[2])),i[1]<n[1]?(o[1]=i[1],o[3]=n[1]-i[1]+n[3],o[3]<i[3]&&(o[3]=i[3])):(o[1]=n[1],o[3]=i[1]-n[1]+i[3],o[3]<n[3]&&(o[3]=n[3])),r},t}(),K=function(t){function e(e,i){var n=t.call(this)||this;return n._invalid=!0,n._asset=e,n._pool=i,n._onClearDelegate=function(t){return n.onClear(t)},n._onInvalidateDelegate=function(t){return n.onInvalidate(t)},n._asset&&(n._asset.addEventListener(l.CLEAR,n._onClearDelegate),n._asset.addEventListener(l.INVALIDATE,n._onInvalidateDelegate)),n}return i(e,t),Object.defineProperty(e,"ID_COUNT",{get:function(){return h.Next()},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.onClear=function(t){this._asset&&(this._asset.removeEventListener(l.CLEAR,this._onClearDelegate),this._asset.removeEventListener(l.INVALIDATE,this._onInvalidateDelegate)),this._asset.clearAbstraction(this._pool),this._pool=null,this._asset=null},e.prototype.onInvalidate=function(t){this._invalid=!0},e}(u),W=function(){function t(t,e,i,n){this._assets=t,this.filter(e,i,n)}return Object.defineProperty(t.prototype,"currentAsset",{get:function(){return this._idx<this._filtered.length?this._filtered[this._idx]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numAssets",{get:function(){return this._filtered.length},enumerable:!0,configurable:!0}),t.prototype.next=function(){var t=null;return this._idx<this._filtered.length&&(t=this._filtered[this._idx]),this._idx++,t},t.prototype.reset=function(){this._idx=0},t.prototype.setIndex=function(t){this._idx=t},t.prototype.filter=function(t,e,i){if(t||e){var n=void 0,r=void 0;n=0,this._filtered=new Array;for(var o=this._assets.length,s=0;s<o;s++)r=this._assets[s],t&&r.adaptee.assetType!=t||e&&r.adaptee.assetNamespace!=e||(null==i||i(r))&&(this._filtered[n++]=r)}else this._filtered=this._assets},t}(),J=function(){function t(){}return t.FAVOR_OLD="favorOld",t.FAVOR_NEW="favorNew",t}(),Z=function(){function t(){}return t.prototype.resolveConflict=function(t,e,i,n){throw new s},t.prototype.create=function(){throw new s},t.prototype._pUpdateNames=function(t,e,i,n,r,o){var s=o===J.FAVOR_NEW?n:i,a=o===J.FAVOR_NEW?i:n,u=a.adaptee.name;r[s.adaptee.name]=s,r[e]=a,a.adaptee.resetAssetPath(e,t,!1),a.adaptee.dispatchEvent(new l(l.ASSET_CONFLICT_RESOLVED,a.adaptee,u))},t}(),$=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.resolveConflict=function(t,e,i,n){throw new o("Asset name collision while AssetLibrary.namingStrategy set to AssetLibrary.THROW_ERROR. Asset path: "+t.adaptee.assetFullPath)},e.prototype.create=function(){return new e},e}(Z),tt=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.resolveConflict=function(t,e,i,n){},e.prototype.create=function(){return new e},e}(Z),et=function(t){function e(e){void 0===e&&(e=".");var i=t.call(this)||this;return i._separator=e,i._next_suffix={},i}return i(e,t),e.prototype.resolveConflict=function(t,e,i,n){var r,o,s,a=t.adaptee.name;a.indexOf(this._separator)>=0?(o=a.substring(0,a.lastIndexOf(this._separator)),s=parseInt(a.substring(o.length-1)),isNaN(s)&&(o=a,s=0)):(o=a,s=0),0==s&&this._next_suffix.hasOwnProperty(o)&&(s=this._next_suffix[o]);do{s++,r=o.concat(this._separator,s.toString())}while(i.hasOwnProperty(r));this._next_suffix[o]=s,this._pUpdateNames(e.adaptee.assetNamespace,r,e,t,i,n)},e.prototype.create=function(){return new e(this._separator)},e}(Z),it=function(){function t(t){}return t.APPEND_NUM_SUFFIX=new et,t.IGNORE=new tt,t.THROW_ERROR=new $,t}(),nt=function(){function t(){}return t.TEXT="text",t.VARIABLES="variables",t.BLOB="blob",t.ARRAY_BUFFER="arraybuffer",t.BINARY="binary",t}(),rt=function(){function t(){}return t.POST="POST",t.GET="GET",t}(),ot=function(){function t(t){void 0===t&&(t=null),this._variables=new Object,null!==t&&this.decode(t)}return t.prototype.decode=function(t){t=t.split("+").join(" ");for(var e,i=/[?&]?([^=]+)=([^&]*)/g;e=i.exec(t);)this._variables[decodeURIComponent(e[1])]=decodeURIComponent(e[2])},t.prototype.toString=function(){return""},Object.defineProperty(t.prototype,"variables",{get:function(){return this._variables},set:function(t){this._variables=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formData",{get:function(){var t=new FormData;for(var e in this._variables)t.append(e,this._variables[e]);return t},enumerable:!0,configurable:!0}),t}(),st=function(t){function e(){var e=t.call(this)||this;return e._bytesLoaded=0,e._bytesTotal=0,e._dataFormat=nt.TEXT,e._loadError=!1,e}return i(e,t),Object.defineProperty(e.prototype,"url",{get:function(){return this._request?this._request.url:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataFormat",{get:function(){return this._dataFormat},set:function(t){this._dataFormat=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesLoaded",{get:function(){return this._bytesLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesTotal",{get:function(){return this._bytesTotal},enumerable:!0,configurable:!0}),e.prototype.load=function(t){this._request=t,this.initXHR(),t.method===rt.POST?this.postRequest(t):this.getRequest(t)},e.prototype.isSupported=function(){return null!=window},e.prototype.close=function(){this._XHR.abort(),this.disposeXHR()},e.prototype.dispose=function(){this._XHR&&this._XHR.abort(),this.disposeXHR()},e.prototype.setResponseType=function(t,e){switch(e){case nt.ARRAY_BUFFER:case nt.BLOB:case nt.TEXT:t.responseType=e;break;case nt.VARIABLES:t.responseType=nt.TEXT;break;case nt.BINARY:t.responseType=""}},e.prototype.getRequest=function(t){try{this._XHR.open(t.method,t.url,t.async),this.setResponseType(this._XHR,this._dataFormat),this._XHR.send()}catch(t){this.handleXmlHttpRequestException(t)}},e.prototype.postRequest=function(t){if(this._loadError=!1,this._XHR.open(t.method,t.url,t.async),null!=t.data)if(t.data instanceof ot){var e=t.data;try{this._XHR.responseType="text",this._XHR.send(e.formData)}catch(t){this.handleXmlHttpRequestException(t)}}else this.setResponseType(this._XHR,this._dataFormat),t.data?this._XHR.send(t.data):this._XHR.send();else this._XHR.send()},e.prototype.handleXmlHttpRequestException=function(t){t.code},e.prototype.initXHR=function(){var t=this;this._XHR||(this._XHR=new XMLHttpRequest,this._XHR.onloadstart=function(e){return t.onLoadStart(e)},this._XHR.onprogress=function(e){return t.onProgress(e)},this._XHR.onabort=function(e){return t.onAbort(e)},this._XHR.onerror=function(e){return t.onLoadError(e)},this._XHR.onload=function(e){return t.onLoadComplete(e)},this._XHR.ontimeout=function(e){return t.onTimeOut(e)},this._XHR.onloadend=function(e){return t.onLoadEnd(e)},this._XHR.onreadystatechange=function(e){return t.onReadyStateChange(e)})},e.prototype.disposeXHR=function(){null!==this._XHR&&(this._XHR.onloadstart=null,this._XHR.onprogress=null,this._XHR.onabort=null,this._XHR.onerror=null,this._XHR.onload=null,this._XHR.ontimeout=null,this._XHR.onloadend=null,this._XHR=null)},e.prototype.decodeURLVariables=function(t){var e=new Object;t=t.split("+").join(" ");for(var i,n=/[?&]?([^=]+)=([^&]*)/g;i=n.exec(t);)e[decodeURIComponent(i[1])]=decodeURIComponent(i[2]);return e},e.prototype.onReadyStateChange=function(t){4==this._XHR.readyState&&(this._status=this._XHR.status,404==this._status&&(this._loadError=!0,this.dispatchEvent(this._loadErrorEvent||(this._loadErrorEvent=new Q(Q.LOAD_ERROR,this)))),this.dispatchEvent(this._statusEvent||(this._statusEvent=new Q(Q.HTTP_STATUS,this))))},e.prototype.onLoadEnd=function(t){this._loadError},e.prototype.onTimeOut=function(t){},e.prototype.onAbort=function(t){},e.prototype.onProgress=function(t){this._bytesTotal=t.total,this._bytesLoaded=t.loaded,this.dispatchEvent(this._progressEvent||(this._progressEvent=new Q(Q.LOAD_PROGRESS,this)))},e.prototype.onLoadStart=function(t){this.dispatchEvent(this._loadStartEvent||(this._loadStartEvent=new Q(Q.LOAD_START,this)))},e.prototype.onLoadComplete=function(t){if(!0!==this._loadError){switch(this._dataFormat){case nt.TEXT:this._data=this._XHR.responseText;break;case nt.VARIABLES:this._data=this.decodeURLVariables(this._XHR.responseText);break;case nt.BLOB:case nt.ARRAY_BUFFER:case nt.BINARY:this._data=this._XHR.response;break;default:this._data=this._XHR.responseText}this.dispatchEvent(this._loadCompleteEvent||(this._loadCompleteEvent=new Q(Q.LOAD_COMPLETE,this)))}},e.prototype.onLoadError=function(t){this._loadError=!0,this.dispatchEvent(this._loadErrorEvent||(this._loadErrorEvent=new Q(Q.LOAD_ERROR,this)))},e}(u),at=function(){function t(t,e,i,n,r,o,s,a){void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=0),this._assets=[],this._dependencies=[],this._id=t,this._sub_id=a,this._request=e,this._data=i,this._parser=n,this._parentParser=r,this._retrieveAsRawData=o,this._suppressAssetEvents=s}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sub_id",{get:function(){return this._sub_id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"request",{get:function(){return this._request},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parser",{get:function(){return this._parser},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentParser",{get:function(){return this._parentParser},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"retrieveAsRawData",{get:function(){return this._retrieveAsRawData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"suppresAssetEvents",{get:function(){return this._suppressAssetEvents},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"assets",{get:function(){return this._assets},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dependencies",{get:function(){return this._dependencies},enumerable:!0,configurable:!0}),t.prototype.setData=function(t){this._data=t},t.prototype.setParser=function(t){this._parser=t},t.prototype.resolve=function(){this._parentParser&&this._parentParser._iResolveDependency(this)},t.prototype.resolveFailure=function(){this._parentParser&&this._parentParser._iResolveDependencyFailure(this)},t.prototype.resolveName=function(t){return this._parentParser?this._parentParser._iResolveDependencyName(this,t):t.name},t}(),lt=function(){function t(e,i){void 0===e&&(e=!0),void 0===i&&(i=null),this._includeDependencies=e,this._dependencyBaseUrl=i||"",this._embeddedDataByUrl={},this._remappedUrls={},this._materialMode=t.UNDEFINED,this._externalAssetMode=t.PRELOADED}return Object.defineProperty(t.prototype,"includeDependencies",{get:function(){return this._includeDependencies},set:function(t){this._includeDependencies=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"materialMode",{get:function(){return this._materialMode},set:function(t){this._materialMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"externalAssetMode",{get:function(){return this._externalAssetMode},set:function(t){this._externalAssetMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dependencyBaseUrl",{get:function(){return this._dependencyBaseUrl},set:function(t){this._dependencyBaseUrl=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overrideAbsolutePaths",{get:function(){return this._overrideAbsPath},set:function(t){this._overrideAbsPath=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overrideFullURLs",{get:function(){return this._overrideFullUrls},set:function(t){this._overrideFullUrls=t},enumerable:!0,configurable:!0}),t.prototype.mapUrl=function(t,e){this._remappedUrls[t]=e},t.prototype.mapUrlToData=function(t,e){this._embeddedDataByUrl[t]=e},t.prototype._iHasDataForUrl=function(t){return this._embeddedDataByUrl.hasOwnProperty(t)},t.prototype._iGetDataForUrl=function(t){return this._embeddedDataByUrl[t]},t.prototype._iHasMappingForUrl=function(t){return this._remappedUrls.hasOwnProperty(t)},t.prototype._iGetRemappedUrl=function(t){return this._remappedUrls[t]},t.UNDEFINED=0,t.SINGLEPASS_MATERIALS=1,t.MULTIPASS_MATERIALS=2,t.ON_DEMAND="onDemand",t.PRELOADED="preloaded",t}(),ut=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this)||this;return i._materialMode=e,i._stack=new Array,i._onReadyForDependenciesDelegate=function(t){return i._onReadyForDependencies(t)},i._onParseCompleteDelegate=function(t){return i._onParseComplete(t)},i._onParseErrorDelegate=function(t){return i._onParseError(t)},i._onLoadProgressDelegate=function(t){return i._onLoadProgress(t)},i._onLoadCompleteDelegate=function(t){return i._onLoadComplete(t)},i._onLoadErrorDelegate=function(t){return i._onLoadError(t)},i._onTextureSizeErrorDelegate=function(t){return i._onTextureSizeError(t)},i._onAssetCompleteDelegate=function(t){return i._onAssetComplete(t)},i}return i(e,t),e.enableParser=function(t){e._parsers.indexOf(t)<0&&e._parsers.push(t)},e.enableParsers=function(t){for(var i=0;i<t.length;i++)e.enableParser(t[i])},Object.defineProperty(e.prototype,"baseDependency",{get:function(){return this._baseDependency},enumerable:!0,configurable:!0}),e.prototype.load=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),this._uri=t.url=t.url.replace(/\\/g,"/"),this._context=e,this._namespace=i,this.dispatchEvent(new V(V.LOADER_START,this._uri,null,null)),this._baseDependency=new at("",t,null,n,null),this._retrieveDependency(this._baseDependency)},e.prototype.loadData=function(t,e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null),this._uri=n,this._context=i,this._namespace=n,this.dispatchEvent(new V(V.LOADER_START,this._uri,null,null)),this._baseDependency=new at(e,null,t,r,null),this._retrieveDependency(this._baseDependency)},e.prototype._retrieveNext=function(t){if(void 0===t&&(t=null),this._currentDependency.dependencies.length){var e=this._currentDependency.dependencies.pop();this._stack.push(this._currentDependency),this._retrieveDependency(e)}else if(this._currentDependency.parser&&this._currentDependency.parser.parsingPaused)this._currentDependency.parser._iResumeParsing();else if(this._stack&&this._stack.length){var i=this._currentDependency;this._currentDependency=this._stack.pop(),i.success&&i.resolve(),this._retrieveNext(t)}else this.dispatchEvent(new V(V.LOADER_COMPLETE,this._uri,this._baseDependency.parser.content,this._baseDependency.assets))},e.prototype._retrieveDependency=function(t){var e;this._context&&0!=this._context.materialMode&&(this._materialMode=this._context.materialMode),this._currentDependency=t,e=t.data,this._context&&t.request&&(this._context._iHasDataForUrl(t.request.url)?e=this._context._iGetDataForUrl(t.request.url):this._context.externalAssetMode!=lt.ON_DEMAND||"jpg"!=this.getSuffix(t.request.url)&&"png"!=this.getSuffix(t.request.url)||(e=t.request,t.parser||t.setParser(this.getParserFromSuffix(t.request.url)))),e?(e.constructor===Function&&(e=new e),t.setData(e),t.retrieveAsRawData?(t.resolve(),this._retrieveNext()):this._parseDependency(t)):(t.loader=new st,this._addEventListeners(t.loader),t.request.url=this._resolveDependencyUrl(t),t.retrieveAsRawData?t.loader.dataFormat=nt.BINARY:(t.parser||t.setParser(this.getParserFromSuffix(t.request.url)),t.parser?t.loader.dataFormat=t.parser.dataFormat:t.loader.dataFormat=nt.BINARY),t.loader.load(t.request))},e.prototype._joinUrl=function(t,e){return"/"!=e.charAt(0)&&"\\"!=e.charAt(0)||(e=e.substr(1)),"."==e.charAt(0)&&(e=e.substr(2)),0==t.length?e:("/"!=t.charAt(t.length-1)&&"\\"!=t.charAt(t.length-1)||(t=t.substr(0,t.length-1)),t.concat("/",e))},e.prototype._resolveDependencyUrl=function(t){var e=t.request.url;if(this._context&&this._context._iHasMappingForUrl(e))return this._context._iGetRemappedUrl(e);if(e==this._uri)return e;var i,n=new RegExp("/^[a-zA-Z]{3,4}:///");if("/"==e.charAt(0))return this._context&&this._context.overrideAbsolutePaths?this._joinUrl(this._context.dependencyBaseUrl,e):e;if(n.test(e)&&this._context&&this._context.overrideFullURLs){var r=e.replace(n,"");return this._joinUrl(this._context.dependencyBaseUrl,r)}return this._context&&this._context.dependencyBaseUrl?(i=this._context.dependencyBaseUrl,this._joinUrl(i,e)):(i=this._uri.substring(0,this._uri.lastIndexOf("/")+1),this._joinUrl(i,e))},e.prototype._retrieveParserDependencies=function(){if(this._currentDependency){for(var t=this._currentDependency.parser.dependencies,e=t.length,i=0;i<e;i++)this._currentDependency.dependencies[i]=t[i];t.length=0,this._stack.push(this._currentDependency),this._retrieveNext()}},e.prototype._resolveParserDependencies=function(){this._currentDependency.success=!0,this._currentDependency.parser&&this._currentDependency.parser.dependencies.length&&(!this._context||this._context.includeDependencies)?this._retrieveParserDependencies():this._retrieveNext()},e.prototype._onLoadError=function(t){if(!this.hasEventListener(Q.LOAD_ERROR))throw new Error;this.dispatchEvent(t),this._currentDependency!=this._baseDependency?(this._currentDependency.resolveFailure(),this._retrieveNext()):this.dispose()},e.prototype._onParseError=function(t){if(!this.hasEventListener(U.PARSE_ERROR))throw new Error(t.message);this.dispatchEvent(t),this._retrieveNext()},e.prototype._onAssetComplete=function(t){this._currentDependency&&this._currentDependency.assets.push(t.asset),t.asset.resetAssetPath(t.asset.name,this._namespace),this._currentDependency.suppresAssetEvents||this.dispatchEvent(t)},e.prototype._onReadyForDependencies=function(t){this._context&&!this._context.includeDependencies?t.target._iResumeParsing():this._retrieveParserDependencies()},e.prototype._onLoadProgress=function(t){this.dispatchEvent(t)},e.prototype._onLoadComplete=function(t){var e=t.urlLoader;this.dispatchEvent(t),this._removeEventListeners(e),this._currentDependency.setData(e.data),this._currentDependency.retrieveAsRawData?this._resolveParserDependencies():this._parseDependency(this._currentDependency)},e.prototype._onParseComplete=function(t){var e=t.target;e.removeEventListener(U.READY_FOR_DEPENDENCIES,this._onReadyForDependenciesDelegate),e.removeEventListener(U.PARSE_COMPLETE,this._onParseCompleteDelegate),e.removeEventListener(U.PARSE_ERROR,this._onParseErrorDelegate),e.removeEventListener(l.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate),e.removeEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),this._resolveParserDependencies()},e.prototype._onTextureSizeError=function(t){t.asset.name=this._currentDependency.resolveName(t.asset),this.dispatchEvent(t)},e.prototype._addEventListeners=function(t){t.addEventListener(Q.LOAD_PROGRESS,this._onLoadProgressDelegate),t.addEventListener(Q.LOAD_COMPLETE,this._onLoadCompleteDelegate),t.addEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate)},e.prototype._removeEventListeners=function(t){t.removeEventListener(Q.LOAD_PROGRESS,this._onLoadProgressDelegate),t.removeEventListener(Q.LOAD_COMPLETE,this._onLoadCompleteDelegate),t.removeEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate)},e.prototype.stop=function(){this.dispose()},e.prototype.dispose=function(){this._context=null,this._stack=null,this._currentDependency&&this._currentDependency.loader&&this._removeEventListeners(this._currentDependency.loader),this._currentDependency=null},e.prototype._getParserFromData=function(t){for(var i=e._parsers.length-1;i>=0;i--)if(e._parsers[i].supportsData(t))return new e._parsers[i];return null},e.prototype._parseDependency=function(t){var e=t.parser;if(e||t.setParser(e=this._getParserFromData(t.data)),e)e.addEventListener(U.READY_FOR_DEPENDENCIES,this._onReadyForDependenciesDelegate),e.addEventListener(U.PARSE_COMPLETE,this._onParseCompleteDelegate),e.addEventListener(U.PARSE_ERROR,this._onParseErrorDelegate),e.addEventListener(l.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate),e.addEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),t.request&&t.request.url&&(e._iFileName=t.request.url),e.materialMode=this._materialMode,e.parseAsync(t.data);else{var i="No parser defined. To enable all parsers for auto-detection, use Parsers.enableAllBundled()";if(!this.hasEventListener(U.PARSE_ERROR))throw new Error(i);this.dispatchEvent(new U(U.PARSE_ERROR,i)),this._retrieveNext()}},e.prototype.getParserFromSuffix=function(t){for(var i=this.getSuffix(t),n=e._parsers.length-1;n>=0;n--){var r=e._parsers[n];if(r.supportsType(i))return new r}return null},e.prototype.getSuffix=function(t){var e=t.indexOf("?")>0?t.split("?")[0]:t;return e.substr(e.lastIndexOf(".")+1).toLowerCase()},e._parsers=new Array,e}(u),ct=function(t){function e(){var e,i=t.call(this)||this;return i._loaderSessionsGarbage=new Array,i._assets=new Array,i._assetDictionary=new Object,i._loaderSessions=new Array,i.conflictStrategy=it.IGNORE.create(),i.conflictPrecedence=J.FAVOR_NEW,i._onAssetRenameDelegate=function(t){return i._onAssetRename(t)},i._onAssetConflictResolvedDelegate=function(t){return i._onAssetConflictResolved(t)},i._onLoaderStartDelegate=function(t){return i._onLoaderStart(t)},i._onLoaderCompleteDelegate=function(t){return i._onLoaderComplete(t)},i._onTextureSizeErrorDelegate=function(t){return i._onTextureSizeError(t)},i._onAssetCompleteDelegate=function(t){return i._onAssetComplete(t)},i._onLoadErrorDelegate=function(t){return i._onLoadError(t)},i._onParseErrorDelegate=function(t){return i._onParseError(t)},i._errorDelegateSelector=((e={})[Q.LOAD_ERROR]=i._onLoadErrorDelegate,e[U.PARSE_ERROR]=i._onParseErrorDelegate,e),i}return i(e,t),e.prototype.addEventListener=function(e,i){if(e==Q.LOAD_ERROR||e==U.PARSE_ERROR)for(var n=void 0;n<this._loaderSessions.length;n++)this._loaderSessions[n].addEventListener(e,this._errorDelegateSelector[e]);t.prototype.addEventListener.call(this,e,i)},e.prototype.removeEventListener=function(e,i){if(e==Q.LOAD_ERROR||e==U.PARSE_ERROR)for(var n=void 0;n<this._loaderSessions.length;n++)this._loaderSessions[n].removeEventListener(e,this._errorDelegateSelector[e]);t.prototype.removeEventListener.call(this,e,i)},e.getInstance=function(t){return void 0===t&&(t="default"),t||(t="default"),e._iInstances.hasOwnProperty(t)||(e._iInstances[t]=new e),e._iInstances[t]},e.prototype.enableParser=function(t){ut.enableParser(t)},e.prototype.enableParsers=function(t){ut.enableParsers(t)},Object.defineProperty(e.prototype,"conflictStrategy",{get:function(){return this._strategy},set:function(t){if(!t)throw new o("namingStrategy must not be null. To ignore naming, use AssetLibrary.IGNORE");this._strategy=t.create()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"conflictPrecedence",{get:function(){return this._strategyPreference},set:function(t){this._strategyPreference=t},enumerable:!0,configurable:!0}),e.prototype.createIterator=function(t,e,i){return void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),new W(this._assets,t,e,i)},e.prototype.load=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),this.getLoader().load(t,e,i,n)},e.prototype.loadData=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),this.getLoader().loadData(t,"",e,i,n)},e.prototype.getLoader=function(){var t=new ut;return this._loaderSessions.push(t),t.addEventListener(V.LOADER_START,this._onLoaderStartDelegate),t.addEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),t.addEventListener(l.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate),t.addEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),this.hasEventListener(Q.LOAD_ERROR)&&t.addEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate),this.hasEventListener(U.PARSE_ERROR)&&t.addEventListener(U.PARSE_ERROR,this._onParseErrorDelegate),t},e.prototype.stopLoader=function(t){var e=this._loaderSessions.indexOf(t);if(-1==e)throw new Error("loader is not an active session");this._loaderSessions.splice(e,1),this._killLoaderSession(t)},e.prototype.getAsset=function(t,e){return void 0===e&&(e=null),this._assetDictDirty&&this.rehashAssetDict(),null==e&&(e=p.DEFAULT_NAMESPACE),this._assetDictionary.hasOwnProperty(e)?this._assetDictionary[e][t.toString().toLowerCase()]:null},e.prototype.getAllAssets=function(){return this._assets},e.prototype.addAsset=function(t){if(!(this._assets.indexOf(t)>=0)){var e=this.getAsset(t.adaptee.name,t.adaptee.assetNamespace),i=t.adaptee.assetNamespace||p.DEFAULT_NAMESPACE;null!=e&&this._strategy.resolveConflict(t,e,this._assetDictionary[i],this._strategyPreference),this._assets.push(t),this._assetDictionary.hasOwnProperty(i)||(this._assetDictionary[i]=new Object),this._assetDictionary[i][t.adaptee.name.toString().toLowerCase()]=t,t.adaptee.addEventListener(l.RENAME,this._onAssetRenameDelegate),t.adaptee.addEventListener(l.ASSET_CONFLICT_RESOLVED,this._onAssetConflictResolvedDelegate)}},e.prototype.removeAsset=function(t,e){void 0===e&&(e=!0),this.removeAssetFromDict(t),t.adaptee.removeEventListener(l.RENAME,this._onAssetRenameDelegate),t.adaptee.removeEventListener(l.ASSET_CONFLICT_RESOLVED,this._onAssetConflictResolvedDelegate);var i=this._assets.indexOf(t);i>=0&&this._assets.splice(i,1),e&&t.dispose()},e.prototype.removeAssetByName=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!0);var n=this.getAsset(t,e);return n&&this.removeAsset(n,i),n},e.prototype.removeAllAssets=function(t){if(void 0===t&&(t=!0),t)for(var e=this._assets.length,i=0;i<e;i++)this._assets[i].dispose();this._assets.length=0,this.rehashAssetDict()},e.prototype.removeNamespaceAssets=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!0);var i,n=0,r=this._assets.concat();this._assets.length=0,null==t&&(t=p.DEFAULT_NAMESPACE);for(var o=r.length,s=0;s<o;s++)(i=r[s]).adaptee.assetNamespace==t?(e&&i.dispose(),this.removeAssetFromDict(i,!1)):this._assets[n++]=i;this._assetDictionary.hasOwnProperty(t)&&delete this._assetDictionary[t]},e.prototype.removeAssetFromDict=function(t,e){void 0===e&&(e=!0),this._assetDictDirty&&this.rehashAssetDict();var i=t.adaptee.assetNamespace;this._assetDictionary.hasOwnProperty(i)&&(this._assetDictionary[i].hasOwnProperty(t.adaptee.name.toString().toLowerCase())&&delete this._assetDictionary[i][t.adaptee.name.toString().toLowerCase()],e&&!Object.keys(this._assetDictionary[i]).length&&delete this._assetDictionary[i])},e.prototype.stop=function(){for(var t=this._loaderSessions.length,e=0;e<t;e++)this._killLoaderSession(this._loaderSessions[e]);this._loaderSessions=new Array},e.prototype.rehashAssetDict=function(){var t,e;this._assetDictionary={};for(var i=this._assets.length,n=0;n<i;n++)e=(t=this._assets[n]).adaptee.assetNamespace,this._assetDictionary.hasOwnProperty(e)||(this._assetDictionary[e]={}),this._assetDictionary[e][t.adaptee.name.toString().toLowerCase()]=t;this._assetDictDirty=!1},e.prototype._onLoadError=function(t){this.dispatchEvent(t)},e.prototype._onParseError=function(t){this.dispatchEvent(t)},e.prototype._onAssetComplete=function(t){this.addAsset(t.asset.adapter),this.dispatchEvent(t)},e.prototype._onTextureSizeError=function(t){this.dispatchEvent(t)},e.prototype._onLoaderStart=function(t){this.dispatchEvent(t)},e.prototype._onLoaderComplete=function(t){this.stopLoader(t.target),this.dispatchEvent(t)},e.prototype._killLoaderSession=function(t){t.removeEventListener(V.LOADER_START,this._onLoaderStartDelegate),t.removeEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),t.removeEventListener(l.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate),t.removeEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),this.hasEventListener(Q.LOAD_ERROR)&&t.removeEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate),this.hasEventListener(U.PARSE_ERROR)&&t.removeEventListener(U.PARSE_ERROR,this._onParseErrorDelegate),t.stop()},e.prototype._onAssetRename=function(t){var e=t.target.adapter,i=this.getAsset(e.adaptee.assetNamespace,e.adaptee.name);if(null!=i)this._strategy.resolveConflict(e,i,this._assetDictionary[e.adaptee.assetNamespace],this._strategyPreference);else{var n=this._assetDictionary[t.asset.assetNamespace];if(null==n)return;n[t.prevName]=null,n[t.asset.name.toString().toLowerCase()]=t.asset}},e.prototype._onAssetConflictResolved=function(t){this.dispatchEvent(t.clone())},e._iInstances=new Object,e}(u),ht=function(){function t(){}return t.getBundle=function(t){return void 0===t&&(t="default"),ct.getInstance(t)},t.enableParser=function(t){ut.enableParser(t)},t.enableParsers=function(t){ut.enableParsers(t)},Object.defineProperty(t,"conflictStrategy",{get:function(){return t.getBundle().conflictStrategy},set:function(e){t.getBundle().conflictStrategy=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"conflictPrecedence",{get:function(){return t.getBundle().conflictPrecedence},set:function(e){t.getBundle().conflictPrecedence=e},enumerable:!0,configurable:!0}),t.createIterator=function(e,i,n){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),t.getBundle().createIterator(e,i,n)},t.load=function(e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null),t.getBundle().load(e,i,n,r)},t.loadData=function(e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null),t.getBundle().loadData(e,i,n,r)},t.stop=function(){t.getBundle().stop()},t.getLoader=function(){return t.getBundle().getLoader()},t.getAsset=function(e,i){return void 0===i&&(i=null),t.getBundle().getAsset(e,i)},t.getAllAssets=function(){return t.getBundle().getAllAssets()},t.addEventListener=function(e,i){t.getBundle().addEventListener(e,i)},t.removeEventListener=function(e,i){t.getBundle().removeEventListener(e,i)},t.addAsset=function(e){t.getBundle().addAsset(e)},t.removeAsset=function(e,i){void 0===i&&(i=!0),t.getBundle().removeAsset(e,i)},t.removeAssetByName=function(e,i,n){return void 0===i&&(i=null),void 0===n&&(n=!0),t.getBundle().removeAssetByName(e,i,n)},t.removeAllAssets=function(e){void 0===e&&(e=!0),t.getBundle().removeAllAssets(e)},t.removeNamespaceAssets=function(e,i){void 0===e&&(e=null),void 0===i&&(i=!0),t.getBundle().removeNamespaceAssets(e,i)},t}(),pt=function(){function t(t){void 0===t&&(t=null),this.method=rt.GET,this.async=!0,this._url=t}return Object.defineProperty(t.prototype,"url",{get:function(){return this._url},set:function(t){this._url=t},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.data=null,this._url=null},t}(),dt=function(t){function e(e,i){void 0===i&&(i=0);var n=t.call(this)||this;if(n._repeatCount=0,n._currentCount=0,n._running=!1,n._delay=e,n._repeatCount=i,isNaN(e)||e<0)throw new o("Delay is negative or not a number");return n}return i(e,t),Object.defineProperty(e.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},set:function(t){this._delay=t,this._running&&(this.stop(),this.start())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(t){this._repeatCount=t},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._running&&this.stop(),this._currentCount=0},Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),e.prototype.start=function(){var t=this;this._running=!0,clearInterval(this._iid),this._iid=setInterval((function(){return t.tick()}),this._delay)},e.prototype.stop=function(){this._running=!1,clearInterval(this._iid)},e.prototype.tick=function(){this._currentCount++,this._repeatCount>0&&this._currentCount>=this._repeatCount?(this.stop(),this.dispatchEvent(new G(G.TIMER)),this.dispatchEvent(new G(G.TIMER_COMPLETE))):this.dispatchEvent(new G(G.TIMER))},e}(u);function ft(){return Date.now()}var _t,mt=function(t){function e(e){var i=t.call(this)||this;return i._materialMode=0,i._dataFormat=e,i._dependencies=new Array,i._pOnIntervalDelegate=function(t){return i._pOnInterval(t)},i}return i(e,t),e.supportsType=function(t){throw new s},Object.defineProperty(e.prototype,"content",{get:function(){return this._pContent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parsingFailure",{get:function(){return this._parsingFailure},set:function(t){this._parsingFailure=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parsingPaused",{get:function(){return this._parsingPaused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parsingComplete",{get:function(){return this._parsingComplete},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"materialMode",{get:function(){return this._materialMode},set:function(t){this._materialMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataFormat",{get:function(){return this._dataFormat},enumerable:!0,configurable:!0}),e.prototype.parseAsync=function(t,e){void 0===e&&(e=30),this._data=t,this._pStartParsing(e)},e.prototype.parseSync=function(t){this._data=t;for(var i=e.MORE_TO_PARSE;i==e.MORE_TO_PARSE;)i=this._pProceedParsing();return this._pContent},Object.defineProperty(e.prototype,"dependencies",{get:function(){return this._dependencies},enumerable:!0,configurable:!0}),e.prototype._iResolveDependency=function(t){throw new s},e.prototype._iResolveDependencyFailure=function(t){throw new s},e.prototype._iResolveDependencyName=function(t,e){return e.name},e.prototype._iResumeParsing=function(){this._parsingPaused=!1,this._timer&&this._timer.start(),this._isParsing||this._pOnInterval()},e.prototype._pFinalizeAsset=function(t,e){void 0===e&&(e=null),t.name=e||t.name||t.assetType,this.dispatchEvent(new l(l.ASSET_COMPLETE,t))},e.prototype._pProceedParsing=function(){throw new s},e.prototype._pDieWithError=function(t){void 0===t&&(t="Unknown parsing error"),this._timer&&(this._timer.removeEventListener(G.TIMER,this._pOnIntervalDelegate),this._timer.stop(),this._timer=null),this.dispatchEvent(new U(U.PARSE_ERROR,t))},e.prototype._pAddDependency=function(t,e,i,n,r,o,s){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s=0);var a=new at(t,e,n,i,this,r,o,s);return this._dependencies.push(a),a},e.prototype._pPauseAndRetrieveDependencies=function(){this._pPauseParsing(),this.dispatchEvent(new U(U.READY_FOR_DEPENDENCIES))},e.prototype._pPauseParsing=function(){this._timer&&this._timer.stop(),this._parsingPaused=!0},e.prototype._pHasTime=function(){return ft()-this._lastFrameTime<this._frameLimit},e.prototype._pOnInterval=function(t){this._lastFrameTime=ft(),this._isParsing=!0,this._pProceedParsing()&&!this._parsingFailure&&this._pFinishParsing(),this._isParsing=!1},e.prototype._pStartParsing=function(t){this._frameLimit=t,this._timer=new dt(this._frameLimit,0),this._timer.addEventListener(G.TIMER,this._pOnIntervalDelegate),this._timer.start(),this._pOnInterval()},e.prototype._pFinishParsing=function(){this._timer&&(this._timer.removeEventListener(G.TIMER,this._pOnIntervalDelegate),this._timer.stop()),this._timer=null,this._parsingComplete=!0,this._isParsing=!1,this.dispatchEvent(new U(U.PARSE_COMPLETE))},e.prototype._pGetTextData=function(){return A.toString(this._data)},e.prototype._pGetByteData=function(){return A.toByteArray(this._data)},e.prototype._pGetData=function(){return this._data},e.PARSING_DONE=!0,e.MORE_TO_PARSE=!1,e}(u),gt=function(t){function e(){return t.call(this,nt.BLOB)||this}return i(e,t),e.supportsType=function(t){return"wav"==(t=t.toLowerCase())||"mp3"==t||"ogg"==t},e.supportsData=function(t){if(!(t instanceof y))return!1;var i=t;return!!e.parseFileType(i)},e.prototype._pStartParsing=function(e){delete this._pContent,this._pContent=null,t.prototype._pStartParsing.call(this,e)},e.prototype._pProceedParsing=function(){return this._pContent=new x(new C(this.data)),this._pFinalizeAsset(this._pContent,this._iFileName),mt.PARSING_DONE},e.parseFileType=function(t){if(t.position=0,65504==(65504&t.readUnsignedShort()))return"mp3";t.position=0;var e=t.readUnsignedByte(),i=t.readUnsignedByte(),n=t.readUnsignedByte();return 73===e&&68===i&&51===n||255===e&&251===i||255===e&&243===i&&130===n?"mp3":(t.position=0,"RIFF"==t.readUTFBytes(4)?"wav":(t.position=0,"OggS"==t.readUTFBytes(4)?"ogg":(t.position=0,null)))},e.processFilename=function(t){return t},e}(mt);!function(t){t[t.LEFT_HANDED=0]="LEFT_HANDED",t[t.RIGHT_HANDED=1]="RIGHT_HANDED"}(_t||(_t={}));var yt=function(t){function e(e){void 0===e&&(e=_t.LEFT_HANDED);var i=t.call(this)||this;return i._viewMatrix3D=new R,i._inverseViewMatrix3D=new R,i._frustumMatrix3D=new R,i._near=20,i._far=3e3,i._scale=1,i._ratio=1,i._originX=0,i._originY=0,i._frustumRect=new Y,i._viewFrustumCorners=[],i._viewMatrix3DDirty=!0,i._inverseViewMatrix3DDirty=!0,i._frustumMatrix3DDirty=!0,i._viewFrustumCornersDirty=!0,i._viewFrustumPlanesDirty=!0,i._coordinateSystem=e,i._onInvalidateConcatenatedMatrix3DDelegate=function(t){return i._onInvalidateConcatenatedMatrix3D(t)},i}return i(e,t),Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform||(this.transform=new N),this._transform},set:function(t){this._transform!=t&&(this._transform&&this._transform.removeEventListener(E.INVALIDATE_CONCATENATED_MATRIX3D,this._onInvalidateConcatenatedMatrix3DDelegate),this._transform=t,this._transform&&this._transform.addEventListener(E.INVALIDATE_CONCATENATED_MATRIX3D,this._onInvalidateConcatenatedMatrix3DDelegate),this._invalidateViewMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coordinateSystem",{get:function(){return this._coordinateSystem},set:function(t){this._coordinateSystem!=t&&(this._coordinateSystem=t,this._invalidateFrustumMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._propertiesDirty&&this._updateProperties(),this._scale},set:function(t){this._scale!=t&&(this._scale=t,this._invalidateFrustumMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ratio",{get:function(){return this._propertiesDirty&&this._updateProperties(),this._ratio},set:function(t){this._ratio!=t&&(this._ratio=t,this._invalidateFrustumMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frustumMatrix3D",{get:function(){return this._frustumMatrix3DDirty&&this._updateFrustumMatrix3D(),this._frustumMatrix3D},set:function(t){this._frustumMatrix3D=t,this._invalidateViewMatrix3D(),this._invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewFrustumCorners",{get:function(){if(this._viewFrustumCornersDirty){this._viewFrustumCornersDirty=!1,this._frustumMatrix3DDirty&&this._updateFrustumMatrix3D();var t=this._frustumRect.left,e=this._frustumRect.right,i=this._frustumRect.top,n=this._frustumRect.bottom;this._propertiesDirty&&this._updateProperties();var r=this._near,o=this._far,s=this._viewFrustumCorners;s[0]=s[9]=r*t,s[3]=s[6]=r*e,s[1]=s[4]=r*i,s[7]=s[10]=r*n,s[12]=s[21]=o*t,s[15]=s[18]=o*e,s[13]=s[16]=o*i,s[19]=s[22]=o*n,s[2]=s[5]=s[8]=s[11]=r,s[14]=s[17]=s[20]=s[23]=o,this._transform&&this._transform.concatenatedMatrix3D.transformVectors(s,s)}return this._viewFrustumCorners},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewFrustumPlanes",{get:function(){if(this._viewFrustumPlanesDirty){if(this._viewFrustumPlanesDirty=!1,!this._viewFrustumPlanes){this._viewFrustumPlanes=[];for(var t=0;t<6;++t)this._viewFrustumPlanes[t]=new H}var e=this.viewMatrix3D._rawData,i=void 0,n=e[0],r=e[4],o=e[8],s=e[12],a=e[1],l=e[5],u=e[9],c=e[13],h=e[2],p=e[6],d=e[10],f=e[14],_=e[3],m=e[7],g=e[11],y=e[15],A=void 0,v=void 0,b=void 0,x=void 0;x=this._viewFrustumPlanes[0],A=_+n,v=m+r,b=g+o,i=1/Math.sqrt(A*A+v*v+b*b),x.a=A*i,x.b=v*i,x.c=b*i,x.d=-(y+s)*i,x=this._viewFrustumPlanes[1],A=_-n,v=m-r,b=g-o,i=1/Math.sqrt(A*A+v*v+b*b),x.a=A*i,x.b=v*i,x.c=b*i,x.d=(s-y)*i,x=this._viewFrustumPlanes[2],A=_+a,v=m+l,b=g+u,i=1/Math.sqrt(A*A+v*v+b*b),x.a=A*i,x.b=v*i,x.c=b*i,x.d=-(y+c)*i,x=this._viewFrustumPlanes[3],A=_-a,v=m-l,b=g-u,i=1/Math.sqrt(A*A+v*v+b*b),x.a=A*i,x.b=v*i,x.c=b*i,x.d=(c-y)*i,x=this._viewFrustumPlanes[4],A=h,v=p,b=d,i=1/Math.sqrt(A*A+v*v+b*b),x.a=A*i,x.b=v*i,x.c=b*i,x.d=-f*i,x=this._viewFrustumPlanes[5],A=_-h,v=m-p,b=g-d,i=1/Math.sqrt(A*A+v*v+b*b),x.a=A*i,x.b=v*i,x.c=b*i,x.d=(f-y)*i}return this._viewFrustumPlanes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._propertiesDirty&&this._updateProperties(),this._near},set:function(t){t!=this._near&&(this._near=t,this._invalidateFrustumMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originX",{get:function(){return this._propertiesDirty&&this._updateProperties(),this._originX},set:function(t){this._originX!=t&&(this._originX=t,this._invalidateFrustumMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originY",{get:function(){return this._propertiesDirty&&this._updateProperties(),this._originY},set:function(t){this._originY!=t&&(this._originY=t,this._invalidateFrustumMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._propertiesDirty&&this._updateProperties(),this._far},set:function(t){t!=this._far&&(this._far=t,this._invalidateFrustumMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frustumRect",{get:function(){return this._frustumMatrix3DDirty&&this._updateFrustumMatrix3D(),this._frustumRect},enumerable:!0,configurable:!0}),e.prototype.project=function(t,e){throw new s},e.prototype.unproject=function(t,e,i,n){throw new s},Object.defineProperty(e.prototype,"viewMatrix3D",{get:function(){return this._viewMatrix3DDirty&&(this._viewMatrix3DDirty=!1,this._transform?(this._viewMatrix3D.copyFrom(this._transform.inverseConcatenatedMatrix3D),this._viewMatrix3D.append(this.frustumMatrix3D)):this._viewMatrix3D.copyFrom(this.frustumMatrix3D)),this._viewMatrix3D},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inverseViewMatrix3D",{get:function(){return this._inverseViewMatrix3DDirty&&(this._inverseViewMatrix3DDirty=!1,this._inverseViewMatrix3D.copyFrom(this.viewMatrix3D),this._inverseViewMatrix3D.invert()),this._inverseViewMatrix3D},enumerable:!0,configurable:!0}),e.prototype.clone=function(){throw new s},e.prototype._invalidateProperties=function(){this._propertiesDirty=!0},e.prototype._invalidateViewMatrix3D=function(){this._viewMatrix3DDirty=!0,this._inverseViewMatrix3DDirty=!0,this._viewFrustumCornersDirty=!0,this._viewFrustumPlanesDirty=!0,this.dispatchEvent(new j(j.INVALIDATE_VIEW_MATRIX3D,this))},e.prototype._invalidateFrustumMatrix3D=function(){this._propertiesDirty&&this._updateProperties(),this._frustumMatrix3DDirty=!0,this.dispatchEvent(new j(j.INVALIDATE_FRUSTUM_MATRIX3D,this)),this._invalidateViewMatrix3D()},e.prototype._updateFrustumMatrix3D=function(){this._frustumMatrix3DDirty=!1},e.prototype._updateProperties=function(){this._propertiesDirty=!1},e.prototype._onInvalidateConcatenatedMatrix3D=function(t){this._invalidateViewMatrix3D()},e}(u),At=(function(t){function e(e,i){var n=t.call(this)||this;return n.baseProjection=e,n.plane=i,n._onProjectionMatrixChangedDelegate=function(t){return n.onProjectionMatrixChanged(t)},n}i(e,t),Object.defineProperty(e.prototype,"near",{get:function(){return this._baseProjection.near},set:function(t){this._baseProjection.near=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._baseProjection.far},set:function(t){this._baseProjection.far=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"plane",{get:function(){return this._plane},set:function(t){this._plane=t,this._invalidateFrustumMatrix3D()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseProjection",{set:function(t){this._baseProjection&&this._baseProjection.removeEventListener(j.INVALIDATE_FRUSTUM_MATRIX3D,this._onProjectionMatrixChangedDelegate),this._baseProjection=t,this._baseProjection&&this._baseProjection.addEventListener(j.INVALIDATE_FRUSTUM_MATRIX3D,this._onProjectionMatrixChangedDelegate),this._invalidateFrustumMatrix3D()},enumerable:!0,configurable:!0}),e.prototype.onProjectionMatrixChanged=function(t){this._invalidateFrustumMatrix3D()},e.prototype._updateFrustumMatrix3D=function(){t.prototype._updateFrustumMatrix3D.call(this),this._frustumMatrix3D.copyFrom(this._baseProjection.frustumMatrix3D);var e=this._plane.a,i=this._plane.b,n=this._plane.c,r=.05-this._plane.d,o=new P(e>=0?1:-1,i>=0?1:-1,1,1),s=this._frustumMatrix3D.clone();s.invert();var a=s.transformVector(o);this._frustumMatrix3D.copyRowTo(3,o);var l=(a.x*o.x+a.y*o.y+a.z*o.z+a.w*o.w)/(e*a.x+i*a.y+n*a.z+r*a.w);this._frustumMatrix3D.copyRowFrom(2,new P(e*l,i*l,n*l,r*l))}}(yt),function(t){function e(e,i){void 0===e&&(e=1),void 0===i&&(i=_t.LEFT_HANDED);var n=t.call(this,i)||this;return n.scale=e,n}return i(e,t),e.prototype.project=function(t,e){void 0===e&&(e=null);var i=this.viewMatrix3D.transformVector(t,e);return i.y=-i.y,i.z=(i.z*(this._far-this._near)+this._far+this._near)/2,i.w=1,i},e.prototype.unproject=function(t,e,i,n){return void 0===n&&(n=null),null==n&&(n=new P),n.x=t*i,n.y=-e*i,n.z=(2*i-this._far-this._near)/(this._far-this._near),n.w=1,this.inverseViewMatrix3D.transformVector(n,n),n.w=1,n},e.prototype.clone=function(){var t=new e(this.scale,this._coordinateSystem);return t._near=this._near,t._far=this._far,t._coordinateSystem=this._coordinateSystem,t},e.prototype._updateFrustumMatrix3D=function(){t.prototype._updateFrustumMatrix3D.call(this);var e=this._frustumMatrix3D._rawData,i=this._scale,n=this._scale/this._ratio;this._frustumRect.left=.5*(this._originX-1)/n,this._frustumRect.top=.5*(this._originY-1)/i,this._frustumRect.right=this._frustumRect.left+1/n,this._frustumRect.bottom=this._frustumRect.top+1/i,e[0]=2*n,e[5]=2*i,e[12]=this._originX,e[13]=this._originY,e[10]=2/(this._far-this._near),e[14]=-(this._far+this._near)/(this._far-this._near),e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=0,e[15]=1,this._frustumMatrix3D.invalidatePosition()},e.prototype._updateProperties=function(){t.prototype._updateProperties.call(this);var e=this._frustumMatrix3D._rawData;this._near=-(e[14]+1)/e[10],this._far=-(e[14]-1)/e[10],this._originX=e[8],this._originY=e[9],this._scale=e[5]/2,this._ratio=.5*this._scale/e[0]},e}(yt)),vt=function(t){function e(e,i){void 0===e&&(e=60),void 0===i&&(i=_t.LEFT_HANDED);var n=t.call(this,i)||this;return n.fieldOfView=e,n}return i(e,t),Object.defineProperty(e.prototype,"fieldOfView",{get:function(){return 360*Math.atan(.5/this.scale)/Math.PI},set:function(t){this.scale=.5/Math.tan(t*Math.PI/360)},enumerable:!0,configurable:!0}),e.prototype.project=function(t,e){void 0===e&&(e=null);var i=this.viewMatrix3D.transformVector(t,e);return i.x=i.x/i.w,i.y=-i.y/i.w,i.z=i.w,i.w=1,i},e.prototype.unproject=function(t,e,i,n){return void 0===n&&(n=null),null==n&&(n=new P),n.x=t*i,n.y=-e*i,n.z=(this._far+this._near)/(this._far-this._near)*i-2*this._far*this._near/(this._far-this._near),n.w=i,this.inverseViewMatrix3D.transformVector(n,n),n.w=1,n},e.prototype.clone=function(){var t=new e(this.fieldOfView,this._coordinateSystem);return t._near=this._near,t._far=this._far,t._coordinateSystem=this._coordinateSystem,t},e.prototype._updateFrustumMatrix3D=function(){t.prototype._updateFrustumMatrix3D.call(this);var e=this._frustumMatrix3D._rawData,i=this._scale,n=this._scale/this._ratio;this._frustumRect.left=.5*(this._originX-1)/n,this._frustumRect.top=.5*(this._originY-1)/i,this._frustumRect.right=this._frustumRect.left+1/n,this._frustumRect.bottom=this._frustumRect.top+1/i,e[0]=2*n,e[5]=2*i,e[8]=this._originX,e[9]=this._originY,e[10]=(this._far+this._near)/(this._far-this._near),e[11]=1,e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[12]=e[13]=e[15]=0,e[14]=-2*this._far*this._near/(this._far-this._near),this._coordinateSystem==_t.RIGHT_HANDED&&(e[5]=-e[5]),this._frustumMatrix3D.invalidatePosition()},e.prototype._updateProperties=function(){t.prototype._updateProperties.call(this);var e=this._frustumMatrix3D._rawData;this._near=e[14]/(-1-e[10]),this._far=e[14]/(1-e[10]),this._scale=e[5]/2,this._ratio=.5*this._scale/e[0],this._originX=e[8],this._originY=e[9]},e}(yt),bt=function(){function t(t){void 0===t&&(t=0),this._maxLength=-1,this.bytePosition=0,this.byteLength=-1,this._ensureSpace(t)}return Object.defineProperty(t.prototype,"arrayBuffer",{get:function(){return this._arrayBuffer},set:function(t){this.bytePosition=0,this.byteLength=-1,this._maxLength=-1,this._ensureSpace(t.byteLength),this._int32Array.set(new Int32Array(t))},enumerable:!0,configurable:!0}),t.prototype.readByte32Array=function(t,e){void 0===e&&(e=-1),-1==e&&(e=t.byteLength-t.bytePosition),t.writeInt32Array(this._int32Array.subarray(this.bytePosition/4,(this.bytePosition+e)/4)),this.bytePosition+=e},t.prototype.writeByte32Array=function(t){t.bytePosition=0,t.readByte32Array(this,t.byteLength)},t.prototype.writeFloat32Array=function(t){this._ensureSpace(this.bytePosition+4*t.length),this._float32Array.set(t,this.bytePosition/4),this.bytePosition+=4*t.length},t.prototype.writeInt32Array=function(t){this._ensureSpace(this.bytePosition+4*t.length),this._uint32Array.set(t,this.bytePosition/4),this.bytePosition+=4*t.length},t.prototype.writeUint32Array=function(t){this._ensureSpace(this.bytePosition+4*t.length),this._uint32Array.set(t,this.bytePosition/4),this.bytePosition+=4*t.length},t.prototype.readFloat32Array=function(t){t.set(this._float32Array.subarray(this.bytePosition/4,this.bytePosition/4+t.length))},t.prototype.readInt32Array=function(t){t.set(this._int32Array.subarray(this.bytePosition/4,this.bytePosition/4+t.length))},t.prototype.readUint32Array=function(t){t.set(this._uint32Array.subarray(this.bytePosition/4,this.bytePosition/4+t.length))},t.prototype.getBytesAvailable=function(){return this.byteLength-this.bytePosition},t.prototype.readUTFBytes=function(t){for(var e="",i=this.bytePosition+t,n=new DataView(this._arrayBuffer);this.bytePosition<i;){var r=n.getUint8(this.bytePosition++);if(r<128){if(0==r)break;e+=String.fromCharCode(r)}else if(r<224)e+=String.fromCharCode((63&r)<<6|127&n.getUint8(this.bytePosition++));else if(r<240){var o=n.getUint8(this.bytePosition++);e+=String.fromCharCode((31&r)<<12|(127&o)<<6|127&n.getUint8(this.bytePosition++))}else{o=n.getUint8(this.bytePosition++);var s=n.getUint8(this.bytePosition++);e+=String.fromCharCode((15&r)<<18|(127&o)<<12|s<<6&127|127&n.getUint8(this.bytePosition++))}}return e},t.prototype.writeUTFBytes=function(t){var e=encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt("0x"+e))}));if(e.length%4)for(var i=4-e.length%4,n=0;n<i;n++)e+=" ";this._ensureSpace(this.bytePosition+4+e.length),this.writeInt(e.length);for(n=0;n<e.length;n+=4)this.writeUnsignedInt(e.charCodeAt(n+3)<<24|e.charCodeAt(n+2)<<16|e.charCodeAt(n+1)<<8|e.charCodeAt(n));return e.length},t.prototype.readInt=function(){if(this.bytePosition>this.byteLength+4)throw"ByteArray out of bounds read. Position="+this.bytePosition+", Length="+this.byteLength;var t=this.bytePosition>>2;return this.bytePosition+=4,this._int32Array[t]},t.prototype.writeUnsignedInt=function(t){this._ensureSpace(this.bytePosition+4),this._uint32Array[this.bytePosition>>2]=4294967295&~~t,this.bytePosition+=4},t.prototype.writeInt=function(t){this._ensureSpace(this.bytePosition+4),this._int32Array[this.bytePosition>>2]=~~t,this.bytePosition+=4},t.prototype.readUnsignedInt=function(){if(this.bytePosition>this.byteLength+4)throw"ByteArray out of bounds read. Position="+this.bytePosition+", Length="+this.byteLength;var t=this.bytePosition>>2;return this.bytePosition+=4,this._uint32Array[t]},t.prototype.writeFloat=function(t){this._ensureSpace(this.bytePosition+4),this._float32Array[this.bytePosition>>2]=t,this.bytePosition+=4},t.prototype.readFloat=function(){if(this.bytePosition>this.byteLength+4)throw"ByteArray out of bounds read. Positon="+this.bytePosition+", Length="+this.byteLength;var t=this.bytePosition>>2;return this.bytePosition+=4,this._float32Array[t]},t.prototype._ensureSpace=function(t){if(this.byteLength<t&&(this.byteLength=t,this._maxLength<t)){this._maxLength=Math.max(t+255&-256,4);var e=new ArrayBuffer(this._maxLength),i=new Int32Array(e);this._int32Array&&i.set(this._int32Array),this._uint32Array=new Uint32Array(e),this._float32Array=new Float32Array(e),this._int32Array=i,this._arrayBuffer=e}},t}(),xt=(function(t){function e(){var e=t.call(this)||this;return e._bytes=[],e._mode="Array",e}i(e,t),e.prototype.writeByte=function(t){var e=~~t;this._bytes[this.position++]=e,this.position>this.length&&(this.length=this.position)},e.prototype.readByte=function(){if(this.position>=this.length)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;return this._bytes[this.position++]},e.prototype.writeUnsignedByte=function(t){var e=~~t;this._bytes[this.position++]=255&e,this.position>this.length&&(this.length=this.position)},e.prototype.readUnsignedByte=function(){if(this.position>=this.length)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;return this._bytes[this.position++]},e.prototype.writeUnsignedShort=function(t){var e=~~t;this._bytes[this.position++]=255&e,this._bytes[this.position++]=e>>8&255,this.position>this.length&&(this.length=this.position)},e.prototype.readUnsignedShort=function(){if(this.position+2>this.length)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;var t=this._bytes[this.position]|this._bytes[this.position+1]<<8;return this.position+=2,t},e.prototype.writeUnsignedInt=function(t){var e=~~t;this._bytes[this.position++]=255&e,this._bytes[this.position++]=e>>>8&255,this._bytes[this.position++]=e>>>16&255,this._bytes[this.position++]=e>>>24&255,this.position>this.length&&(this.length=this.position)},e.prototype.readUnsignedInt=function(){if(this.position+4>this.length)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;var t=this._bytes[this.position]|this._bytes[this.position+1]<<8|this._bytes[this.position+2]<<16|this._bytes[this.position+3]<<24;return this.position+=4,t>>>0},e.prototype.writeFloat=function(t){this.writeUnsignedInt(this.toFloatBits(Number(t)))},e.prototype.toFloatBits=function(t){if(0==t)return 0;var e=0;t<0?(t=-t,e=1):e=0;var i=Math.log(t)/Math.log(2);return i=Math.floor(i),t*=Math.pow(2,23-i),e<<31>>>0|(i+=127)<<23|Math.floor(t)-8388608},e.prototype.readFloat=function(t){return this.fromFloatBits(this.readUnsignedInt())},e.prototype.fromFloatBits=function(t){if(0==t)return 0;var e=t>>>23&255,i=8388607&t|8388608,n=Math.pow(2,e-127-23)*i;return t>>>31!=0&&(n=-n),n}}(g),function(){function t(){}return t.setElementSize=function(t,e,i){t&&(t.style.width=e+"px",t.style.height=i+"px",t.width=e,t.height=i)},t.setElementWidth=function(t,e){t&&(t.style.width=e+"px",t.width=e)},t.setElementHeight=function(t,e){t&&(t.style.height=e+"px",t.height=e)},t.setElementX=function(t,e){t&&(t.style.position="absolute",t.style.left=e+"px")},t.setElementY=function(t,e){t&&(t.style.position="absolute",t.style.top=e+"px")},t.getElementVisibility=function(t){return!!t&&"visible"==t.style.visibility},t.setElementVisibility=function(t,e){t&&(t.style.visibility=e?"visible":"hidden")},t.setElementAlpha=function(t,e){t instanceof HTMLCanvasElement&&(t.getContext("2d").globalAlpha=e)},t.setElementPosition=function(t,e,i,n){void 0===n&&(n=!1),t&&(t.style.position=n?"absolute":"relative",t.style.left=e+"px",t.style.top=i+"px")},t}()),Ct=function(){function t(t,e){var i=this;this._active=!1,this._argsArray=new Array,this._getTimer=ft,this.setCallback(t,e),this._rafUpdateFunction=function(){i._active&&i._tick()},this._argsArray.push(this._dt)}return t.prototype.setCallback=function(t,e){this._callback=t,this._callbackContext=e},t.prototype.start=function(){this._prevTime=this._getTimer(),this._active=!0,window&&(window.requestAnimationFrame?window.requestAnimationFrame(this._rafUpdateFunction):window.mozRequestAnimationFrame?window.requestAnimationFrame=window.mozRequestAnimationFrame:window.webkitRequestAnimationFrame?window.requestAnimationFrame=window.webkitRequestAnimationFrame:window.oRequestAnimationFrame&&(window.requestAnimationFrame=window.oRequestAnimationFrame))},t.prototype.stop=function(){this._active=!1},Object.defineProperty(t.prototype,"active",{get:function(){return this._active},enumerable:!0,configurable:!0}),t.prototype._tick=function(){this._currentTime=this._getTimer(),this._dt=this._currentTime-this._prevTime,this._argsArray[0]=this._dt,this._callback.apply(this._callbackContext,this._argsArray),window.requestAnimationFrame(this._rafUpdateFunction),this._prevTime=this._currentTime},t}(),wt=function(){function t(){}return t.getChildrenWithTag=function(t,e){var i=document.createDocumentFragment();if(t)for(var n=t.childNodes.length,r=0;r<n;r++){var o=t.childNodes[r];null!=o&&o.nodeName==e&&i.appendChild(o)}return i.childNodes},t.filterListByParam=function(t,e,i){var n=document.createDocumentFragment();if(t)for(var r=t.length,o=0;o<r;o++){var s=t[o];null!=s&&s.attributes.getNamedItem(e).value==i&&n.appendChild(s)}return n.childNodes},t.strToXml=function(t){return(new DOMParser).parseFromString(t,"text/xml")},t.nodeToString=function(t){return t?(new XMLSerializer).serializeToString(t):""},t.readAttributeValue=function(t,e){var i=t.attributes;if(null==i)return"";var n=i.getNamedItem(e);return n?n.value:""},t.writeAttributeValue=function(t,e,i){var n=document.createAttribute(e);n.value=i,n=t.attributes.setNamedItem(n),console.log("XmlUltils - writeAttributeValue() - name: "+n.name+", value: "+n.value)},t.hasAttribute=function(t,e){var i=t.attributes;return null!=i&&null!=i.getNamedItem(e)},t}();console.debug("AwayJS - Core - 0.9.19"),ut.enableParser(gt);var It,Et=function(t){function e(e,i){var n=t.call(this,e)||this;return n._avmVersion=i,n}return i(e,t),Object.defineProperty(e.prototype,"avmVersion",{get:function(){return this._avmVersion},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._avmVersion)},e.AVM_COMPLETE="avmComplete",e}(a),St=function(){function t(){}return t.REGISTRATION_POINT="registrationPoint",t.TRANSFORM_POINT="transformPoint",t}(),Dt=function(){function t(){}return t.MOUSE_ENABLED=1,t.VISIBLE=2,t.MASK_ID=4,t.MASKS=8,t.COLOR_TRANSFORM=16,t.SCENE_TRANSFORM=32,t.ALL=63,t}(),Tt=function(){function t(){}return t.DEFAULT="default",t.CAMERA_PLANE="cameraPlane",t.CAMERA_POSITION="cameraPosition",t}(),Pt=function(t,e){this.normal=new P,this.rayPosition=new P,this.rayDirection=new P,this.entity=t,this.pickGroup=e};!function(t){t[t.SPHERE=0]="SPHERE",t[t.SPHERE_FAST=1]="SPHERE_FAST",t[t.SPHERE_BOUNDS=2]="SPHERE_BOUNDS",t[t.SPHERE_BOUNDS_FAST=3]="SPHERE_BOUNDS_FAST",t[t.BOX=4]="BOX",t[t.BOX_FAST=5]="BOX_FAST",t[t.BOX_BOUNDS=6]="BOX_BOUNDS",t[t.BOX_BOUNDS_FAST=7]="BOX_BOUNDS_FAST",t[t.NULL=8]="NULL"}(It||(It={}));var Bt,Mt,Ot,Lt,Rt,Nt,Ft,kt,Vt,Ut,jt,Gt,Qt,zt,Ht,Xt,qt,Yt=function(t){function e(e,i){var n=t.call(this,e)||this;return n._boundsPicker=i,n}return i(e,t),Object.defineProperty(e.prototype,"boundsPicker",{get:function(){return this._boundsPicker},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._boundsPicker)},e.INVALIDATE_BOUNDS="invalidateBounds",e}(a),Kt=function(t){function e(e,i){var n=t.call(this,e,i)||this;if(n._targetCoordinateSpace=e,n._picker=i.picker,n._strokeFlag=i.strokeFlag,n._fastFlag=i.fastFlag,n._onInvalidateBoundsDelegate=function(t){return n._onInvalidateBounds(t)},n._onInvalidateMatrix3DDelegate=function(t){return n._onInvalidateMatrix3D(t)},n._picker.addEventListener(Yt.INVALIDATE_BOUNDS,n._onInvalidateBoundsDelegate),n._targetCoordinateSpace!=n._picker.entity){for(var r=n._picker.entity;r&&r!=n._targetCoordinateSpace;)r.transform.addEventListener(E.INVALIDATE_MATRIX3D,n._onInvalidateMatrix3DDelegate),r=r.parent;r||n._targetCoordinateSpace.transform.addEventListener(E.INVALIDATE_CONCATENATED_MATRIX3D,n._onInvalidateMatrix3DDelegate)}return n}return i(e,t),e.prototype._onInvalidateBounds=function(t){this._invalid=!0},e.prototype._onInvalidateMatrix3D=function(t){this._invalid=!0},e.prototype.onClear=function(e){if(t.prototype.onClear.call(this,e),this._picker.removeEventListener(Yt.INVALIDATE_BOUNDS,this._onInvalidateBoundsDelegate),this._targetCoordinateSpace!=this._picker.entity){for(var i=this._picker.entity;i&&i!=this._targetCoordinateSpace;)i.transform.removeEventListener(E.INVALIDATE_MATRIX3D,this._onInvalidateMatrix3DDelegate),i=i.parent;i||this._targetCoordinateSpace.transform.removeEventListener(E.INVALIDATE_CONCATENATED_MATRIX3D,this._onInvalidateMatrix3DDelegate)}this._targetCoordinateSpace=null,this._picker=null},e.prototype.nullify=function(){throw new s},e.prototype.isInFrustum=function(t,e){throw new s},e.prototype.clone=function(){throw new s},e.prototype.rayIntersection=function(t,e,i){return-1},e.prototype.classifyToPlane=function(t){throw new s},e.prototype._update=function(){this._invalid=!1},e}(K),Wt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._x=0,e._y=0,e._z=0,e._width=0,e._height=0,e._depth=0,e._centerX=0,e._centerY=0,e._centerZ=0,e._halfExtentsX=0,e._halfExtentsY=0,e._halfExtentsZ=0,e}return i(e,t),e.prototype.nullify=function(){this._x=this._y=this._z=0,this._width=this._height=this._depth=0,this._centerX=this._centerY=this._centerZ=0,this._halfExtentsX=this._halfExtentsY=this._halfExtentsZ=0},e.prototype.isInFrustum=function(t,e){if(this._invalid&&this._update(),null!=this._box){for(var i=0;i<e;++i){var n=t[i],r=n.a,o=n.b,s=n.c,a=r<0?-this._halfExtentsX:this._halfExtentsX,l=o<0?-this._halfExtentsY:this._halfExtentsY,u=s<0?-this._halfExtentsZ:this._halfExtentsZ;if(r*(this._centerX+a)+o*(this._centerY+l)+s*(this._centerZ+u)-n.d<0)return!1}return!0}},e.prototype.rayIntersection=function(t,e,i){return this._invalid&&this._update(),null==this._box?-1:this._box.rayIntersection(t,e,i)},e.prototype.getBox=function(){return this._invalid&&this._update(),this._box},e.prototype.classifyToPlane=function(t){var e=t.a,i=t.b,n=t.c,r=e*this._centerX+i*this._centerY+n*this._centerZ-t.d;e<0&&(e=-e),i<0&&(i=-i),n<0&&(n=-n);var o=e*this._halfExtentsX+i*this._halfExtentsY+n*this._halfExtentsZ;return r>o?z.FRONT:r<-o?z.BACK:z.INTERSECT},e.prototype._update=function(){var e;t.prototype._update.call(this),this._targetCoordinateSpace!=this._picker.entity&&(this._targetCoordinateSpace==this._picker.entity.parent?e=this._picker.entity.transform.matrix3D:(e=this._picker.entity.transform.concatenatedMatrix3D.clone()).append(this._targetCoordinateSpace.transform.inverseConcatenatedMatrix3D)),this._box=this._picker._getBoxBoundsInternal(e,this._strokeFlag,this._fastFlag,this._box),null!=this._box&&(this._halfExtentsX=this._box.width/2,this._halfExtentsY=this._box.height/2,this._halfExtentsZ=this._box.depth/2,this._centerX=this._box.x+this._halfExtentsX,this._centerY=this._box.y+this._halfExtentsY,this._centerZ=this._box.z+this._halfExtentsZ)},e}(Kt),Jt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._radius=0,e._centerX=0,e._centerY=0,e._centerZ=0,e}return i(e,t),e.prototype.nullify=function(){this._centerX=this._centerY=this._centerZ=0,this._radius=0},e.prototype.isInFrustum=function(t,e){this._invalid&&this._update();for(var i=0;i<e;++i){var n=t[i],r=n.a<0?-this._radius:this._radius,o=n.b<0?-this._radius:this._radius,s=n.c<0?-this._radius:this._radius;if(n.a*(this._centerX+r)+n.b*(this._centerY+o)+n.c*(this._centerZ+s)-n.d<0)return!1}return!0},e.prototype.rayIntersection=function(t,e,i){return this._invalid&&this._update(),this._sphere.rayIntersection(t,e,i)},e.prototype.getSphere=function(){return this._invalid&&this._update(),this._sphere},e.prototype.classifyToPlane=function(t){var e=t.a,i=t.b,n=t.c,r=e*this._centerX+i*this._centerY+n*this._centerZ-t.d;e<0&&(e=-e),i<0&&(i=-i),n<0&&(n=-n);var o=(e+i+n)*this._radius;return r>o?z.FRONT:r<-o?z.BACK:z.INTERSECT},e.prototype._update=function(){var e;t.prototype._update.call(this),this._targetCoordinateSpace&&(this._targetCoordinateSpace==this._picker.entity?e=this._picker.entity.transform.matrix3D:(e=this._picker.entity.transform.concatenatedMatrix3D.clone(),this._targetCoordinateSpace.parent&&e.append(this._targetCoordinateSpace.parent.transform.inverseConcatenatedMatrix3D))),this._sphere=this._picker._getSphereBoundsInternal(null,e,this._strokeFlag,this._fastFlag,this._sphere);var i=this._picker.entity.transform.concatenatedMatrix3D,n=this._sphere.x,r=this._sphere.y,o=this._sphere.z,s=this._sphere.radius,a=i._rawData,l=a[0],u=a[4],c=a[8],h=a[12],p=a[1],d=a[5],f=a[9],_=a[13],m=a[2],g=a[6],y=a[10],A=a[14];this._centerX=n*l+r*u+o*c+h,this._centerY=n*p+r*d+o*f+_,this._centerZ=n*m+r*g+o*y+A;var v=l+u+c,b=p+d+f,x=m+g+y;this._radius=s*Math.sqrt((v*v+b*b+x*x)/3)},e}(Kt),Zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.isInFrustum=function(t,e){return!0},e.prototype.classifyToPlane=function(t){return z.INTERSECT},e}(Kt),$t=function(){function t(e,i){this.id=K.ID_COUNT++,this._picker=e,this._strokeFlag=t._strokeDict[i],this._fastFlag=t._fastDict[i],this._boundingVolumeClass=t._boundsDict[i]}return Object.defineProperty(t.prototype,"picker",{get:function(){return this._picker},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeFlag",{get:function(){return this._strokeFlag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fastFlag",{get:function(){return this._fastFlag},enumerable:!0,configurable:!0}),t.prototype.requestAbstraction=function(t){return this._boundingVolumeClass},t.prototype.dispose=function(){},t._strokeDict=((Bt={})[It.BOX]=!1,Bt[It.BOX_FAST]=!1,Bt[It.BOX_BOUNDS]=!0,Bt[It.BOX_BOUNDS_FAST]=!0,Bt[It.SPHERE]=!1,Bt[It.SPHERE_FAST]=!1,Bt[It.SPHERE_BOUNDS]=!0,Bt[It.SPHERE_FAST]=!0,Bt[It.NULL]=!1,Bt),t._fastDict=((Mt={})[It.BOX]=!1,Mt[It.BOX_FAST]=!0,Mt[It.BOX_BOUNDS]=!1,Mt[It.BOX_BOUNDS_FAST]=!0,Mt[It.SPHERE]=!1,Mt[It.SPHERE_FAST]=!0,Mt[It.SPHERE_BOUNDS]=!1,Mt[It.SPHERE_FAST]=!0,Mt[It.NULL]=!1,Mt),t._boundsDict=((Ot={})[It.BOX]=Wt,Ot[It.BOX_FAST]=Wt,Ot[It.BOX_BOUNDS]=Wt,Ot[It.BOX_BOUNDS_FAST]=Wt,Ot[It.SPHERE]=Jt,Ot[It.SPHERE_FAST]=Jt,Ot[It.SPHERE_BOUNDS]=Jt,Ot[It.SPHERE_FAST]=Jt,Ot[It.NULL]=Zt,Ot),t}(),te=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._boundingVolumePools=new Object,n._orientedBoxBounds=[],n._orientedBoxBoundsDirty=[!0,!0],n._orientedSphereBounds=[],n._orientedSphereBoundsDirty=[!0,!0],n._pickables=[],n.shapeFlag=!1,n.id=K.ID_COUNT++,n._view=i.view,n._entity=e,n._pickGroup=i,n._pickingCollision=new Pt(e,i),n}return i(e,t),Object.defineProperty(e.prototype,"pickingCollision",{get:function(){return this._pickingCollision},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entity",{get:function(){return this._entity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pickGroup",{get:function(){return this._pickGroup},enumerable:!0,configurable:!0}),e.prototype.getBoundingVolume=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),null==t&&(t=this._entity),null==e&&(e=this._entity.defaultBoundingVolume);var i=this._boundingVolumePools[e]||(this._boundingVolumePools[e]=new $t(this,e));return t.getAbstraction(i)},e.prototype.hitTestPoint=function(t,e,i){return void 0===i&&(i=!1),this._hitTestPointInternal(this._entity,t,e,i,!1)},e.prototype._hitTestPointInternal=function(t,e,i,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!1),!(-1==this._entity.maskId||r&&n))return!1;this._invalid&&this._update();var o=new D(e,i);this._entity.transform.globalToLocal(o,o);var s=this._getBoxBoundsInternal(null,!1,!0);if(null==s||!s.contains(o.x,o.y,0))return!1;if(!n||"[asset TextField]"==this._entity.assetType||"[asset Billboard]"==this._entity.assetType)return!0;for(var a=this._pickables.length,l=!1,u=0;u<a;u++)if(this._pickables[u].hitTestPoint(o.x,o.y,0)){l=!0;break}if(!l)return!1;var c=this._entity.maskOwners;if(c){var h=c.length,p=void 0,d=void 0,f=void 0,_=void 0;for(u=0;u<h;u++)if((p=c[u]).isDescendant(t)){f=(d=p.masks).length,_=!1;for(var m=0;m<f;m++)if((p=d[m]).isDescendant(t)&&p&&this._pickGroup.getBoundsPicker(p.partition)._hitTestPointInternal(t,e,i,n,!0)){_=!0;break}if(!_)return!1}}return!0},e.prototype.isInFrustum=function(t,e){return this._isInFrustumInternal(this._entity,t,e)},e.prototype._isInFrustumInternal=function(t,e,i){return this.getBoundingVolume(t).isInFrustum(e,i)},e.prototype.isIntersectingRay=function(t,e){return this._isIntersectingRayInternal(this._entity,t,e)},e.prototype._isIntersectingRayInternal=function(t,e,i){var n=this._entity.transform.inverseConcatenatedMatrix3D;n.transformVector(e,this._pickingCollision.rayPosition),n.deltaTransformVector(i,this._pickingCollision.rayDirection);var r=this.getBoundingVolume().rayIntersection(this._pickingCollision.rayPosition,this._pickingCollision.rayDirection,this._pickingCollision.normal);return!(r<0||!this._isIntersectingMasks(t,e,i))&&(this._pickingCollision.rayEntryDistance=r,this._pickingCollision.globalRayPosition=e,this._pickingCollision.globalRayDirection=i,this._pickingCollision.rayOriginIsInsideBounds=0==r,!0)},e.prototype.isIntersectingShape=function(t){for(var e=!1,i=0;i<this._pickables.length;i++)if(this._pickables[i].testCollision(this._pickingCollision,t)){if(!t)return!0;e=!0}return e},e.prototype.getBoxBounds=function(t,e,i){return void 0===t&&(t=null),void 0===e&&(e=!1),void 0===i&&(i=!1),this._getBoxBoundsInternal(t?t.transform.matrix3D:null,e,i)},e.prototype._getBoxBoundsInternal=function(t,e,i,n,r){void 0===t&&(t=null),void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=null),void 0===r&&(r=null),this._invalid&&this._update();var o=this._pickables.length;if(o)if(i){var s=void 0,a=e?1:0;if(this._orientedBoxBoundsDirty[a]){this._orientedBoxBoundsDirty[a]=!1;for(var l=0;l<o;l++)s=this._pickables[l].getBoxBounds(null,e,this._orientedBoxBounds[a],s);this._orientedBoxBounds[a]=s}else s=this._orientedBoxBounds[a];null!=s&&(r=t?t.transformBox(s).union(r,r||n):s.union(r,r||n))}else for(l=0;l<o;l++)r=this._pickables[l].getBoxBounds(t,e,n,r);return r},e.prototype.getSphereBounds=function(t,e,i){return void 0===t&&(t=null),void 0===e&&(e=!1),void 0===i&&(i=!1),this._getSphereBoundsInternal(null,t?t.transform.matrix3D:null,e,i)},e.prototype._getSphereBoundsInternal=function(t,e,i,n,r,o){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=null),void 0===o&&(o=null),this._invalid&&this._update();var s=this._getBoxBoundsInternal(e,i);if(null!=s){t||((t=new P).x=s.x+s.width/2,t.y=s.y+s.height/2,t.z=s.z+s.depth/2);var a=this._pickables.length;if(a)if(n){var l=void 0,u=i?1:0;if(this._orientedSphereBoundsDirty[u]){this._orientedSphereBoundsDirty[u]=!1;for(var c=0;c<a;c++)l=this._pickables[c].getSphereBounds(t,null,i,this._orientedSphereBounds[u],l);this._orientedSphereBounds[u]=l}else l=this._orientedSphereBounds[u];null!=l&&(o=e?e.transformSphere(l).union(o,o||r):l.union(o,o||r))}else for(c=0;c<a;c++)o=this._pickables[c].getSphereBounds(t,e,i,r,o);return o}},e.prototype.applyTraversable=function(t){this._pickables.push(t.getAbstraction(this))},e.prototype.onInvalidate=function(e){t.prototype.onInvalidate.call(this,e),this._pickables=[],this._orientedBoxBoundsDirty[0]=!0,this._orientedBoxBoundsDirty[1]=!0,this._orientedSphereBoundsDirty[0]=!0,this._orientedSphereBoundsDirty[1]=!0,this.dispatchEvent(new Yt(Yt.INVALIDATE_BOUNDS,this))},e.prototype.onClear=function(e){for(var i in t.prototype.onClear.call(this,e),this._boundingVolumePools)this._boundingVolumePools[i].dispose(),delete this._boundingVolumePools[i]},e.prototype.requestAbstraction=function(t){return e._pickPickableClassPool[t.assetType]},e.registerPickable=function(t,i){e._pickPickableClassPool[i.assetType]=t},e.prototype._update=function(){this._invalid=!1,this._entity._acceptTraverser(this)},e.prototype._isIntersectingMasks=function(t,e,i){var n=this._entity.maskOwners;if(n)for(var r=n.length,o=void 0,s=void 0,a=void 0,l=void 0,u=0;u<r;u++)if((o=n[u]).isDescendant(t)){a=(s=o.masks).length,l=!1;for(var c=0;c<a;c++)if((o=s[c]).isDescendant(t)&&o&&this._pickGroup.getRaycastPicker(o.partition)._getCollisionInternal(e,i,!0,!0,null)){l=!0;break}if(!l)return!1}return!0},e._pickPickableClassPool=new Object,e}(K),ee=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.sourceEntity=i.entity,n._view=i.view,n._pickGroup=i.pickGroup,n}return i(e,t),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._view=null},e.prototype.hitTestPoint=function(t,e,i){throw new s},e.prototype.getBoxBounds=function(t,e,i,n){return void 0===n&&(n=null),n},e.prototype.getSphereBounds=function(t,e,i,n,r){return void 0===r&&(r=null),r},e.prototype.testCollision=function(t,e){throw new s},e}(K),ie=function(t){function e(e,i){var n=t.call(this,e)||this;return n._view=i,n}return i(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),e.INVALIDATE_VIEW_MATRIX3D="invalidateViewMatrix3D",e.INVALIDATE_SIZE="invalidateSize",e}(a),ne=function(){function t(t,e){this._childNodes=new Array,this._numChildNodes=0,this._entity=t,this._partition=e}return Object.defineProperty(t.prototype,"entity",{get:function(){return this._entity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pickObject",{get:function(){return this._entity.pickObject},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boundsVisible",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maskId",{get:function(){return this._entity.maskId},enumerable:!0,configurable:!0}),t.prototype.getBoundsPrimitive=function(t){throw new s},t.prototype.isInFrustum=function(t,e,i,n){return!!this._entity._iIsVisible()},t.prototype.isVisible=function(){return this._entity._iIsVisible()},t.prototype.isIntersectingRay=function(t,e,i,n){return!0},t.prototype.isRenderable=function(){return!0},t.prototype.isCastingShadow=function(){return!0},t.prototype.dispose=function(){this.parent=null,this._childNodes=null},t.prototype.acceptTraverser=function(t){if(this._partition.root==this._entity&&this._partition.updateEntities(),(t.partition==this._partition||t==t.getTraverser(this._partition))&&t.enterNode(this))for(var e=0;e<this._numChildNodes;e++)this._childNodes[e].acceptTraverser(t)},t.prototype.iAddNode=function(t){t.parent=this,this._childNodes[this._numChildNodes++]=t},t.prototype.iRemoveNode=function(t){var e=this._childNodes.indexOf(t);this._childNodes[e]=this._childNodes[--this._numChildNodes],this._childNodes.pop()},t}(),re=function(t){function e(e,i){void 0===i&&(i=!1);var n=t.call(this)||this;return n._children=new Array,n._updateQueue={},n.isUpdated=!1,n._root=e,n._root.addEventListener(l.CLEAR,(function(t){return n._onRootClear(t)})),i&&(n._scene=e),n}return i(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scene",{get:function(){return this._scene},enumerable:!0,configurable:!0}),e.prototype.addChild=function(t){return t&&t.parent&&t.parent.removeChildInternal(t),this._children.push(t),t._setParent(this),t},e.prototype.removeChild=function(t){return this.removeChildInternal(t),t._setParent(null),t},e.prototype.removeChildInternal=function(t){return this._children.splice(this._children.indexOf(t),1)[0]},e.prototype.getPartition=function(t){return null},e.prototype.traverse=function(t){this.isUpdated=this._invalid,this._invalid=!1,this._rootNode.acceptTraverser(t)},e.prototype.invalidateEntity=function(t){this._invalid||this.invalidate(),this._updateQueue[t.id]=t},e.prototype.updateEntity=function(t){t._iInternalUpdate(),this.updateNode(t.getAbstraction(this))},e.prototype.updateNode=function(t){var e=this.findParentForNode(t);e&&t.parent!=e&&(t.parent&&t.parent.iRemoveNode(t),e.iAddNode(t))},e.prototype.clearEntity=function(t){this._invalid||this.invalidate(),delete this._updateQueue[t.id],this.clearNode(t.getAbstraction(this))},e.prototype.clearNode=function(t){t.parent&&(t.parent.iRemoveNode(t),t.parent=null)},e.prototype.findParentForNode=function(t){return this._rootNode},e.prototype.updateEntities=function(){for(var t in this._updateQueue)this.updateEntity(this._updateQueue[t]);this._updateQueue={}},e.prototype.invalidate=function(){this._invalid=!0,t.prototype.invalidate.call(this),this._parent&&this._parent.invalidate()},e.prototype.dispose=function(){},e.prototype._setParent=function(t){this._parent&&(this._parent.clearNode(this._rootNode),this._parent.invalidate()),this._parent=t,t&&(t.updateNode(this._rootNode),t.invalidate()),this._setScene(t?t.scene:null)},e.prototype._setScene=function(t){if(this._scene!=t){this._scene=t;for(var e=this._children.length,i=0;i<e;++i)this._children[i]._setScene(t)}},e.prototype._onRootClear=function(t){this.clear()},e.prototype.requestAbstraction=function(t){return e._abstractionClassPool[t.assetType]},e.registerAbstraction=function(t,i){e._abstractionClassPool[i.assetType]=t},e._abstractionClassPool=new Object,e}(p),oe=function(t){function e(e){var i=t.call(this,e)||this;return i._rootNode=new ne(e,i),i}return i(e,t),e}(re),se=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),Object.defineProperty(e.prototype,"entity",{get:function(){return this._asset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pickObject",{get:function(){return this._asset.pickObject},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boundsVisible",{get:function(){return this._asset.boundsVisible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maskId",{get:function(){return this._asset.maskId},enumerable:!0,configurable:!0}),e.prototype.getBoundsPrimitive=function(t){return this._asset.getBoundsPrimitive(t)},e.prototype.isCastingShadow=function(){return this._asset.castsShadows},e.prototype.onClear=function(e){this._pool.clearEntity(this._asset),t.prototype.onClear.call(this,e)},e.prototype.isInFrustum=function(t,e,i,n){return!!this._asset._iIsVisible()},e.prototype.isVisible=function(){return this._asset._iIsVisible()},e.prototype.isIntersectingRay=function(t,e,i,n){return this._asset.getAbstraction(n)._isIntersectingRayInternal(t,e,i)},e.prototype.isRenderable=function(){return this._asset._iAssignedColorTransform()._isRenderable()},e.prototype.acceptTraverser=function(t){t.enterNode(this)&&t.applyEntity(this._asset)},e}(K),ae=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.shapeFlag=!1,n.findClosestCollision=!1,n._entities=[],n._pickers=[],n._collectedEntities=[],n.pickGroup=i.pickGroup,n.partition=e,n.entity=e.root,n}return i(e,t),e.prototype.traverse=function(){this._entities.length=0,this._pickers.length=0,this.partition.traverse(this)},e.prototype.getTraverser=function(t){if(t.root._iIsMouseEnabled()||t.root.isDragEntity()){var e=this.pickGroup.getRaycastPicker(t);return e._isIntersectingRayInternal(this._rootEntity,this._globalRayPosition,this._globalRayDirection,this._shapeFlag)&&this._pickers.push(e),e}return this},Object.defineProperty(e.prototype,"dragEntity",{get:function(){return this._dragEntity},set:function(t){this._dragEntity!=t&&(this._dragEntity&&this._dragEntity._stopDrag(),this._dragEntity=t,this._dragEntity&&this._dragEntity._startDrag())},enumerable:!0,configurable:!0}),e.prototype.enterNode=function(t){return!(!t.isVisible()||t.maskId!=this._rootEntity.maskId)&&(t.pickObject?(t.pickObject.partition.traverse(this),!1):t.isIntersectingRay(this._rootEntity,this._globalRayPosition,this._globalRayDirection,this.pickGroup))},e.prototype.isIntersectingRay=function(t,e,i){return void 0===i&&(i=!1),this._isIntersectingRayInternal(this.entity,t,e,i)},e.prototype._isIntersectingRayInternal=function(t,e,i,n){return this._rootEntity=t,this._globalRayPosition=e,this._globalRayDirection=i,this._shapeFlag=this.shapeFlag||n,this.traverse(),!(!this._entities.length&&!this._pickers.length)},e.prototype.getCollision=function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=null),this._getCollisionInternal(t,e,i,!1,n)},e.prototype.getViewCollision=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=null);var r=this.pickGroup.view.unproject(t,e,0),o=this.pickGroup.view.unproject(t,e,1).subtract(r);return this._getCollisionInternal(r,o,i,!1,n)},e.prototype._getCollisionInternal=function(t,e,i,n,r){if(!this._isIntersectingRayInternal(this.entity,t,e,i))return null;this._collectEntities(this._collectedEntities,this._dragEntity);var o=this._getPickingCollision(r);return this._collectedEntities.length=0,o},e.prototype.getObjectsUnderPoint=function(t,e){if(!this._isIntersectingRayInternal(this.entity,t,e,!0))return[];this._collectEntities(this._collectedEntities,this._dragEntity);var i=this._getColliders();return this._collectedEntities.length=0,i},e.prototype._collectEntities=function(t,e){for(var i,n,r=this._pickers.length,o=0;o<r;o++)(i=this._pickers[o]).entity!=e&&i._collectEntities(t,e);for(o=0;o<this._entities.length;++o)(n=this._entities[o]).pickingCollision.pickerEntity=this.entity,t.push(n)},e.prototype.setIgnoreList=function(t){this._ignoredEntities=t},e.prototype.isIgnored=function(t){if(this._ignoredEntities)for(var e=this._ignoredEntities.length,i=0;i<e;i++)if(this._ignoredEntities[i]==t)return!0;return!1},e.prototype.sortOnNearT=function(t,e){return t.pickingCollision.rayEntryDistance>e.pickingCollision.rayEntryDistance?1:t.pickingCollision.rayEntryDistance<e.pickingCollision.rayEntryDistance?-1:0},e.prototype._getPickingCollision=function(t){var e,i;void 0===t&&(t=null),this._collectedEntities=this._collectedEntities.sort(this.sortOnNearT);for(var n=this._collectedEntities.length,r=0;r<n&&(i=(e=this._collectedEntities[r]).pickingCollision,null==t||i.rayEntryDistance<t.rayEntryDistance);r++)if(this._shapeFlag||e.shapeFlag)i.rayEntryDistance=Number.MAX_VALUE,e.isIntersectingShape(this.findClosestCollision)&&(t=i);else if(!i.rayOriginIsInsideBounds){t=i;break}return t&&this.updatePosition(t),this._dragEntity&&"[asset MovieClip]"==this._dragEntity.assetType&&this._dragEntity.adapter&&this._dragEntity.adapter.setDropTarget(t?t.entity:null),t},e.prototype._getColliders=function(){for(var t,e=[],i=this._collectedEntities.length,n=0;n<i;n++)(t=this._collectedEntities[n]).pickingCollision.rayEntryDistance=Number.MAX_VALUE,t.isIntersectingShape(!1)&&e.push(t.entity);return e},e.prototype.updatePosition=function(t){var e=t.position||(t.position=new P),i=t.rayDirection,n=t.rayPosition,r=t.rayEntryDistance;e.x=n.x+r*i.x,e.y=n.y+r*i.y,e.z=n.z+r*i.z},e.prototype.dispose=function(){},e.prototype.applyEntity=function(t){if(!this.isIgnored(t)){var e=t.getAbstraction(this.pickGroup);this._entities.push(e)}},e}(K),le=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._boundingVolumePools=new Object,n._boundsPickers=[],n._pickGroup=i.pickGroup,n._partition=e,n._entity=e.root,n}return i(e,t),Object.defineProperty(e.prototype,"partition",{get:function(){return this._partition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entity",{get:function(){return this._entity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){var t=this.getBoxBounds();return null==t?0:t.width*this._entity.transform.scale.x},set:function(t){var e=this.getBoxBounds();null!=e&&0!=e.width&&this._entity.transform.scaleTo(t/e.width,this._entity.transform.scale.y,this._entity.transform.scale.z)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){var t=this.getBoxBounds();return null==t?0:t.height*this._entity.transform.scale.y},set:function(t){var e=this.getBoxBounds();if(null!=e&&0!=e.height){var i=this._entity.transform.scale;this._entity.transform.scaleTo(i.x,t/e.height,i.z)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){var t=this.getBoxBounds();return null==t?0:t.depth*this._entity.transform.scale.z},set:function(t){var e=this.getBoxBounds();null!=e&&0!=e.depth&&this._entity.transform.scaleTo(this._entity.transform.scale.x,this._entity.transform.scale.y,t/e.depth)},enumerable:!0,configurable:!0}),e.prototype.onInvalidate=function(e){t.prototype.onInvalidate.call(this,e),this.dispatchEvent(new Yt(Yt.INVALIDATE_BOUNDS,this))},e.prototype.traverse=function(){this._boundsPickers.length=0,this._partition.traverse(this),this._invalid=!1},e.prototype.getTraverser=function(t){var e=this._pickGroup.getBoundsPicker(t);return this._invalid&&this._boundsPickers.push(e),e},e.prototype.enterNode=function(t){return!0},e.prototype.getBoundingVolume=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),null==t&&(t=this._entity),null==e&&(e=this._entity.defaultBoundingVolume);var i=this._boundingVolumePools[e]||(this._boundingVolumePools[e]=new $t(this,e));return t.getAbstraction(i)},e.prototype.getBoxBounds=function(t,e,i){return void 0===t&&(t=null),void 0===e&&(e=!1),void 0===i&&(i=!1),this.getBoundingVolume(t,e?i?It.BOX_BOUNDS_FAST:It.BOX_BOUNDS:i?It.BOX_FAST:It.BOX).getBox()},e.prototype.getSphereBounds=function(t,e,i){return void 0===t&&(t=null),void 0===e&&(e=!1),void 0===i&&(i=!1),this.getBoundingVolume(t,e?i?It.SPHERE_BOUNDS_FAST:It.SPHERE_BOUNDS:i?It.SPHERE_FAST:It.SPHERE).getSphere()},e.prototype.hitTestPoint=function(t,e,i){return void 0===i&&(i=!1),this._hitTestPointInternal(this._entity,t,e,i,!1)},e.prototype._hitTestPointInternal=function(t,e,i,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!1),!(-1==this._entity.maskId||r&&n))return!1;this._invalid&&this.traverse();var o=new D(e,i);this._entity.transform.globalToLocal(o,o);var s=this.getBoxBounds(null,!1,!0);if(null==s||!s.contains(o.x,o.y,0))return!1;if(!n||"[asset TextField]"==this._entity.assetType||"[asset Billboard]"==this._entity.assetType)return!0;var a=this._boundsPickers.length;if(a)for(var l=0;l<a;++l)if(this._boundsPickers[l]._hitTestPointInternal(t,e,i,n,r))return!0},e.prototype.hitTestObject=function(t){var e=t.getBoxBounds(this._entity,!0,!0);if(null==e)return!1;var i=this.getBoxBounds(this._entity,!0,!0);return null!=i&&(!!e.intersects(i)&&!!t.getBoxBounds(this._entity,!0).intersects(this.getBoxBounds(this._entity,!0)))},e.prototype._getBoxBoundsInternal=function(t,e,i,n,r){void 0===t&&(t=null),void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=null),void 0===r&&(r=null),this._invalid&&this.traverse();var o=this._boundsPickers.length;if(o>0)for(var s=new R,a=0;a<o;++a)this._boundsPickers[a].entity!=this._entity?(t?s.copyFrom(t):s.identity(),s.prepend(this._boundsPickers[a].entity.transform.matrix3D),this._boundsPickers[a].entity._registrationMatrix3D&&s.prepend(this._boundsPickers[a].entity._registrationMatrix3D),r=this._boundsPickers[a]._getBoxBoundsInternal(s,e,i,n,r)):r=this._boundsPickers[a]._getBoxBoundsInternal(t,e,i,n,r);return r},e.prototype._getSphereBoundsInternal=function(t,e,i,n,r,o){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=null),void 0===o&&(o=null),this._invalid&&this.traverse();var s=this._getBoxBoundsInternal(e,i,n);if(null!=s){t||((t=new P).x=s.x+s.width/2,t.y=s.y+s.height/2,t.z=s.z+s.depth/2);var a=this._boundsPickers.length;if(a>0)for(var l=new R,u=0;u<a;++u)this._boundsPickers[u].entity!=this._entity?(e?l.copyFrom(e):l.identity(),l.prepend(this._boundsPickers[u].entity.transform.matrix3D),this._boundsPickers[u].entity._registrationMatrix3D&&l.prepend(this._boundsPickers[u].entity._registrationMatrix3D),o=this._boundsPickers[u]._getSphereBoundsInternal(t,l,i,n,r,o)):o=this._boundsPickers[u]._getSphereBoundsInternal(t,e,i,n,r,o);return o}},e.prototype.isInFrustum=function(t,e){return this._isInFrustumInternal(this._entity,t,e)},e.prototype._isInFrustumInternal=function(t,e,i){return this.getBoundingVolume(t).isInFrustum(e,i)},e.prototype.onClear=function(e){for(var i in t.prototype.onClear.call(this,e),this._boundingVolumePools)this._boundingVolumePools[i].dispose(),delete this._boundingVolumePools[i]},e.prototype.dispose=function(){},e.prototype.applyEntity=function(t){this._boundsPickers.push(t.getAbstraction(this._pickGroup))},e}(K),ue=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._tabEntities=[],n._customTabEntities=[],n._customTabEntitiesSorted=[],n._partition=e,n._entity=e.root,n}return i(e,t),Object.defineProperty(e.prototype,"partition",{get:function(){return this._partition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entity",{get:function(){return this._entity},enumerable:!0,configurable:!0}),e.prototype.sortTabEnabledEntities=function(){if(!(this._customTabEntities.length<=0&&this._tabEntities.length<=0)){var t,e=[],i=0,n=0;if(this._customTabEntities.length>0)for(;i<this._customTabEntities.length;)this._customTabEntities[i]&&(this._customTabEntities[i]=this._customTabEntities[i].reverse()),i++;else{for(t=this._tabEntities.length,i=0;i<t;i++){var r=this._tabEntities[i],o=r.transform.concatenatedMatrix3D.position,s=Math.floor(o.y/10);e.length<=s&&(e.length=s+1),e[s]||(e[s]=[]),e[s].push(r)}for(this._tabEntities.length=0,i=0;i<e.length;i++){var a=e[i];if(a)for(a=a.sort((function(t,e){return t.transform.concatenatedMatrix3D.position.x>e.transform.concatenatedMatrix3D.position.x?1:-1})),n=0;n<a.length;n++)this._tabEntities[this._tabEntities.length]=a[n]}}}},e.prototype.traverse=function(){this._tabEntities.length=0,this._customTabEntities.length=0,this._customTabEntitiesSorted.length=0,this._partition.traverse(this),this.sortTabEnabledEntities(),this._invalid=!1},e.prototype.getTraverser=function(t){return this},e.prototype.getNextTabEntity=function(t){if(this._invalid&&this.traverse(),this._customTabEntities.length<=0&&this._tabEntities.length<=0)return t;if(this._customTabEntities.length>0){var e=0,i=0,n=0,r=0;if(t)for(;e<this._customTabEntities.length;){if(this._customTabEntities[e])for(n=0;n<this._customTabEntities[e].length;n++)if(this._customTabEntities[e][n]==t){for(r=n+1;r<this._customTabEntities[e].length;){if(this._customTabEntities[e][r])return this._customTabEntities[e][r];r++}for(i=e+1;i<this._customTabEntities.length;){if(this._customTabEntities[i])for(r=0;r<this._customTabEntities[i].length;r++)if(this._customTabEntities[i][r])return this._customTabEntities[i][r];i++}for(i=0;i<this._customTabEntities.length;){if(this._customTabEntities[i])for(r=0;r<this._customTabEntities[i].length;r++)if(this._customTabEntities[i][r])return this._customTabEntities[i][r];i++}}e++}for(i=0;i<this._customTabEntities.length;){if(this._customTabEntities[i])for(r=0;r<this._customTabEntities[i].length;r++)if(this._customTabEntities[i][r])return this._customTabEntities[i][r];i++}return t}var o=this._tabEntities.length;for(e=0;e<o;e++)if(this._tabEntities[e]==t)return e==o-1?this._tabEntities[0]:this._tabEntities[e+1];return this._tabEntities[0]},e.prototype.getPrevTabEntity=function(t){if(this._invalid&&this.traverse(),this._customTabEntities.length<=0&&this._tabEntities.length<=0)return t;if(this._customTabEntities.length>0){var e=this._customTabEntities.length,i=0,n=0,r=0;if(t)for(;e>0;)if(e--,this._customTabEntities[e])for(n=this._customTabEntities[e].length-1;n>=0;n--)if(this._customTabEntities[e][n]==t){for(r=n-1;r>0;)if(r--,this._customTabEntities[e][r])return this._customTabEntities[e][r];for(i=e-1;i>0;)if(i--,this._customTabEntities[i])for(r=this._customTabEntities[i].length-1;r>=0;r--)if(this._customTabEntities[i][r])return this._customTabEntities[i][r];for(i=this._customTabEntities.length;i>0;)if(i--,this._customTabEntities[i])for(r=this._customTabEntities[i].length-1;r>=0;r--)if(this._customTabEntities[i][r])return this._customTabEntities[i][r]}for(i=this._customTabEntities.length-1;i>0;)if(i--,this._customTabEntities[i])for(r=this._customTabEntities[i].length-1;r>=0;r--)if(this._customTabEntities[i][r])return this._customTabEntities[i][r];return t}if(t)for(e=this._tabEntities.length-1;e>=0;e--)if(this._tabEntities[e]==t)return 0==e?this._tabEntities[this._tabEntities.length-1]:this._tabEntities[e-1];return this._tabEntities[0]},e.prototype.enterNode=function(t){return!!t.isVisible()},e.prototype.dispose=function(){},e.prototype.applyEntity=function(t){t.tabEnabled&&("[asset TextField]"==t.assetType&&"input"!=t.type||(t.tabIndex>=0?(this._customTabEntities.length<t.tabIndex&&(this._customTabEntities.length=t.tabIndex),this._customTabEntities[t.tabIndex]||(this._customTabEntities[t.tabIndex]=[]),this._customTabEntities[t.tabIndex].push(t)):this._tabEntities[this._tabEntities.length]=t))},e}(K),ce=function(t){function e(i){var n=t.call(this)||this;return n.id=K.ID_COUNT++,n.view=i,n._raycastPickerPool=new he(n),n._boundsPickerPool=new pe(n),n._tabPickerPool=e._tabPickerPool||(e._tabPickerPool=new de),n}return i(e,t),Object.defineProperty(e,"instancePool",{get:function(){return e._instancePool},enumerable:!0,configurable:!0}),e.clearAllInstances=function(){for(var t in this._instancePool)delete this._instancePool[t]},e.getInstance=function(t){return this._instancePool[t.id]||(this._instancePool[t.id]=new e(t))},e.clearInstance=function(t){delete this._instancePool[t.id]},e.prototype.requestAbstraction=function(t){return te},e.prototype.getRaycastPicker=function(t){return t.getAbstraction(this._raycastPickerPool)},e.prototype.getBoundsPicker=function(t){return t.getAbstraction(this._boundsPickerPool)},e.prototype.getTabPicker=function(t){return t.getAbstraction(this._tabPickerPool)},e._instancePool=new Object,e}(u),he=function(){function t(t){this.id=K.ID_COUNT++,this.pickGroup=t}return t.prototype.requestAbstraction=function(t){return ae},t}(),pe=function(){function t(t){this.id=K.ID_COUNT++,this.pickGroup=t}return t.prototype.requestAbstraction=function(t){return le},t}(),de=function(){function t(){this.id=K.ID_COUNT++}return t.prototype.requestAbstraction=function(t){return ue},t}(),fe=function(){},_e=function(){},me=function(t,e,i,n,r,o,s,a,l,u){this.a=new _e,this.b=new _e,this.flags=new fe,this.dest=t,this.a.format=e,this.a.size=i,this.b.format=n,this.b.size=r,this.opcode=o,this.flags.simple=s,this.flags.horizontal=a,this.flags.fragonly=l,this.flags.matrix=u},ge=function(){function t(){}return Object.defineProperty(t,"map",{get:function(){return t._map||(t._map=new Array,t._map.mov=new me("vector","vector",4,"none",0,0,!0,null,null,null),t._map.add=new me("vector","vector",4,"vector",4,1,!0,null,null,null),t._map.sub=new me("vector","vector",4,"vector",4,2,!0,null,null,null),t._map.mul=new me("vector","vector",4,"vector",4,3,!0,null,null,null),t._map.div=new me("vector","vector",4,"vector",4,4,!0,null,null,null),t._map.rcp=new me("vector","vector",4,"none",0,5,!0,null,null,null),t._map.min=new me("vector","vector",4,"vector",4,6,!0,null,null,null),t._map.max=new me("vector","vector",4,"vector",4,7,!0,null,null,null),t._map.frc=new me("vector","vector",4,"none",0,8,!0,null,null,null),t._map.sqt=new me("vector","vector",4,"none",0,9,!0,null,null,null),t._map.rsq=new me("vector","vector",4,"none",0,10,!0,null,null,null),t._map.pow=new me("vector","vector",4,"vector",4,11,!0,null,null,null),t._map.log=new me("vector","vector",4,"none",0,12,!0,null,null,null),t._map.exp=new me("vector","vector",4,"none",0,13,!0,null,null,null),t._map.nrm=new me("vector","vector",4,"none",0,14,!0,null,null,null),t._map.sin=new me("vector","vector",4,"none",0,15,!0,null,null,null),t._map.cos=new me("vector","vector",4,"none",0,16,!0,null,null,null),t._map.crs=new me("vector","vector",4,"vector",4,17,!0,!0,null,null),t._map.dp3=new me("vector","vector",4,"vector",4,18,!0,!0,null,null),t._map.dp4=new me("vector","vector",4,"vector",4,19,!0,!0,null,null),t._map.abs=new me("vector","vector",4,"none",0,20,!0,null,null,null),t._map.neg=new me("vector","vector",4,"none",0,21,!0,null,null,null),t._map.sat=new me("vector","vector",4,"none",0,22,!0,null,null,null),t._map.ted=new me("vector","vector",4,"sampler",1,38,!0,null,!0,null),t._map.kil=new me("none","scalar",1,"none",0,39,!0,null,!0,null),t._map.tex=new me("vector","vector",4,"sampler",1,40,!0,null,!0,null),t._map.m33=new me("vector","matrix",3,"vector",3,23,!0,null,null,!0),t._map.m44=new me("vector","matrix",4,"vector",4,24,!0,null,null,!0),t._map.m43=new me("vector","matrix",3,"vector",4,25,!0,null,null,!0),t._map.ddx=new me("vector","vector",4,"none",0,26,!0,null,!0,null),t._map.ddy=new me("vector","vector",4,"none",0,27,!0,null,!0,null),t._map.sge=new me("vector","vector",4,"vector",4,41,!0,null,null,null),t._map.slt=new me("vector","vector",4,"vector",4,42,!0,null,null,null),t._map.sgn=new me("vector","vector",4,"vector",4,43,!0,null,null,null),t._map.seq=new me("vector","vector",4,"vector",4,44,!0,null,null,null),t._map.sne=new me("vector","vector",4,"vector",4,45,!0,null,null,null)),t._map},enumerable:!0,configurable:!0}),t}(),ye=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.name="",this.version=0,this.name=t,this.version=e,this.data=new y},Ae=function(t,e){this.code=t,this.desc=e},ve=function(){function t(){}return Object.defineProperty(t,"map",{get:function(){return t._map||(t._map=new Array,t._map.va=new Ae(0,"vertex attribute"),t._map.fc=new Ae(1,"fragment constant"),t._map.vc=new Ae(1,"vertex constant"),t._map.ft=new Ae(2,"fragment temporary"),t._map.vt=new Ae(2,"vertex temporary"),t._map.vo=new Ae(3,"vertex output"),t._map.op=new Ae(3,"vertex output"),t._map.fd=new Ae(3,"fragment depth output"),t._map.fo=new Ae(3,"fragment output"),t._map.oc=new Ae(3,"fragment output"),t._map.v=new Ae(4,"varying"),t._map.vi=new Ae(4,"varying output"),t._map.fi=new Ae(4,"varying input"),t._map.fs=new Ae(5,"sampler")),t._map},enumerable:!0,configurable:!0}),t}(),be=function(t,e,i){this.shift=t,this.mask=e,this.value=i},xe=function(){function t(){}return Object.defineProperty(t,"map",{get:function(){return t._map||(t._map=new Array,t._map.rgba=new be(8,15,0),t._map.rg=new be(8,15,5),t._map.r=new be(8,15,4),t._map.compressed=new be(8,15,1),t._map.compressed_alpha=new be(8,15,2),t._map.dxt1=new be(8,15,1),t._map.dxt5=new be(8,15,2),t._map["2d"]=new be(12,15,0),t._map.cube=new be(12,15,1),t._map["3d"]=new be(12,15,2),t._map.centroid=new be(16,1,1),t._map.ignoresampler=new be(16,4,4),t._map.clamp=new be(20,15,0),t._map.repeat=new be(20,15,1),t._map.wrap=new be(20,15,1),t._map.nomip=new be(24,15,0),t._map.mipnone=new be(24,15,0),t._map.mipnearest=new be(24,15,1),t._map.miplinear=new be(24,15,2),t._map.nearest=new be(28,15,0),t._map.linear=new be(28,15,1)),t._map},enumerable:!0,configurable:!0}),t}(),Ce=function(){function t(){this.r={},this.cur=new ye}return t.prototype.assemble=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),i||(i=1),e&&this.addHeader(e,i);var n=t.replace(/[\f\n\r\v]+/g,"\n").split("\n");for(var r in n)this.processLine(n[r],r);return this.r},t.prototype.processLine=function(t,e){var i=t.search("//");if(-1!=i&&(t=t.slice(0,i)),(t=t.replace(/^\s+|\s+$/g,"")).length>0){var n=t.search(/<.*>/g),r=null;-1!=n&&(r=t.slice(n).match(/([\w\.\-\+]+)/gi),t=t.slice(0,n));var o=t.match(/([\w\.\+\[\]]+)/gi);if(!o||o.length<1)t.length>=3&&console.log("Warning: bad line "+e+": "+t);else switch(o[0]){case"part":this.addHeader(o[1],Number(o[2]));break;case"endpart":if(!this.cur)throw"Unexpected endpart";return this.cur.data.position=0,void(this.cur=null);default:if(!this.cur)return void console.log("Warning: bad line "+e+": "+t+" (Outside of any part definition)");if("comment"==this.cur.name)return;var s=ge.map[o[0]];if(!s)throw"Bad opcode "+o[0]+" "+e+": "+t;this.emitOpcode(this.cur,s.opcode);var a=1;if(s.dest&&"none"!=s.dest){if(!this.emitDest(this.cur,o[a++],s.dest))throw"Bad destination register "+o[a-1]+" "+e+": "+t}else this.emitZeroDword(this.cur);if(s.a&&"none"!=s.a.format){if(!this.emitSource(this.cur,o[a++],s.a))throw"Bad source register "+o[a-1]+" "+e+": "+t}else this.emitZeroQword(this.cur);if(s.b&&"none"!=s.b.format){if("sampler"==s.b.format){if(!this.emitSampler(this.cur,o[a++],s.b,r))throw"Bad sampler register "+o[a-1]+" "+e+": "+t}else if(!this.emitSource(this.cur,o[a++],s.b))throw"Bad source register "+o[a-1]+" "+e+": "+t}else this.emitZeroQword(this.cur)}}},t.prototype.emitHeader=function(t){switch(t.data.writeUnsignedByte(160),t.data.writeUnsignedInt(t.version),t.version>=16&&t.data.writeUnsignedByte(0),t.data.writeUnsignedByte(161),t.name){case"fragment":t.data.writeUnsignedByte(1);break;case"vertex":t.data.writeUnsignedByte(0);break;case"cpu":t.data.writeUnsignedByte(2);break;default:t.data.writeUnsignedByte(255)}},t.prototype.emitOpcode=function(t,e){t.data.writeUnsignedInt(e)},t.prototype.emitZeroDword=function(t){t.data.writeUnsignedInt(0)},t.prototype.emitZeroQword=function(t){t.data.writeUnsignedInt(0),t.data.writeUnsignedInt(0)},t.prototype.emitDest=function(t,e,i){var n=e.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i);if(!ve.map[n[1]])return!1;var r={num:n[2]?n[2]:0,code:ve.map[n[1]].code,mask:this.stringToMask(n[3])};return t.data.writeUnsignedShort(r.num),t.data.writeUnsignedByte(r.mask),t.data.writeUnsignedByte(r.code),!0},t.prototype.stringToMask=function(t){if(!t)return 15;var e=0;return-1!=t.indexOf("x")&&(e|=1),-1!=t.indexOf("y")&&(e|=2),-1!=t.indexOf("z")&&(e|=4),-1!=t.indexOf("w")&&(e|=8),e},t.prototype.stringToSwizzle=function(t){if(!t)return 228;var e={x:0,y:1,z:2,w:3},i=0;if("."!=t.charAt(0))throw"Missing . for swizzle";return t.length>1&&(i|=e[t.charAt(1)]),t.length>2?i|=e[t.charAt(2)]<<2:i|=(3&i)<<2,t.length>3?i|=e[t.charAt(3)]<<4:i|=(12&i)<<2,t.length>4?i|=e[t.charAt(4)]<<6:i|=(48&i)<<2,i},t.prototype.emitSampler=function(t,e,i,n){var r=e.match(/fs(\d*)/i);if(!r||!r[1])return!1;t.data.writeUnsignedShort(parseInt(r[1])),t.data.writeUnsignedByte(0),t.data.writeUnsignedByte(0);for(var o=5,s=0,a=0;a<n.length;a++){var l=xe.map[n[a].toLowerCase()];l?(0!=(s>>l.shift&l.mask)&&console.log("Warning, duplicate sampler option"),s|=l.mask<<l.shift,o&=~(l.mask<<l.shift),o|=l.value<<l.shift):console.log("Warning, unknown sampler option: ",n[a])}return t.data.writeUnsignedInt(o),!0},t.prototype.emitSource=function(t,e,i){var n,r=e.match(/vc\[(v[tcai])(\d+)\.([xyzw])([\+\-]\d+)?\](\.[xyzw]{1,4})?/i);if(r){if(!ve.map[r[1]])return!1;var o={num:0|r[2],code:ve.map[r[1]].code,swizzle:this.stringToSwizzle(r[5]),select:{x:0,y:1,z:2,w:3}[r[3]],offset:0|r[4]};t.data.writeUnsignedShort(o.num),t.data.writeByte(o.offset),t.data.writeUnsignedByte(o.swizzle),t.data.writeUnsignedByte(1),t.data.writeUnsignedByte(o.code),t.data.writeUnsignedByte(o.select),t.data.writeUnsignedByte(128)}else{if(n=e.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i),!ve.map[n[1]])return!1;o={num:0|n[2],code:ve.map[n[1]].code,swizzle:this.stringToSwizzle(n[3])};t.data.writeUnsignedShort(o.num),t.data.writeUnsignedByte(0),t.data.writeUnsignedByte(o.swizzle),t.data.writeUnsignedByte(o.code),t.data.writeUnsignedByte(0),t.data.writeUnsignedByte(0),t.data.writeUnsignedByte(0)}return!0},t.prototype.addHeader=function(t,e){if(e||(e=1),null==this.r[t])this.r[t]=new ye(t,e),this.emitHeader(this.r[t]);else if(this.r[t].version!=e)throw"Multiple versions for part "+t;this.cur=this.r[t]},t}(),we=function(){this.progid=0,this.version=0,this.type=""},Ie=function(){this.regread=[[],[],[],[],[],[],[]],this.regwrite=[[],[],[],[],[],[],[]],this.hasindirect=!1,this.writedepth=!1,this.hasmatrix=!1,this.samplers=[],this.tokens=[],this.header=new we},Ee=function(t,e,i,n,r,o,s,a,l,u,c){this.s=t,this.flags=e,this.dest=i,this.a=n,this.b=r,this.matrixwidth=o,this.matrixheight=s,this.ndwm=a,this.scalar=l,this.dm=u,this.lod=c},Se=function(){function t(t){}return t.agal2glsllut=[new Ee("%dest = %cast(%a);\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(%a + %b);\n",0,!0,!0,!0,null,null,null,null,null,null),new Ee("%dest = %cast(%a - %b);\n",0,!0,!0,!0,null,null,null,null,null,null),new Ee("%dest = %cast(%a * %b);\n",0,!0,!0,!0,null,null,null,null,null,null),new Ee("%dest = %cast(%a / %b);\n",0,!0,!0,!0,null,null,null,null,null,null),new Ee("%dest = %cast(1.0) / %a;\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(min(%a,%b));\n",0,!0,!0,!0,null,null,null,null,null,null),new Ee("%dest = %cast(max(%a,%b));\n",0,!0,!0,!0,null,null,null,null,null,null),new Ee("%dest = %cast(fract(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(sqrt(abs(%a)));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(inversesqrt(abs(%a)));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(pow(abs(%a),%b));\n",0,!0,!0,!0,null,null,null,null,null,null),new Ee("%dest = %cast(log2(abs(%a)));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(exp2(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(normalize(vec3( %a ) ));\n",0,!0,!0,!1,null,null,!0,null,null,null),new Ee("%dest = %cast(sin(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(cos(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(cross(vec3(%a),vec3(%b)));\n",0,!0,!0,!0,null,null,!0,null,null,null),new Ee("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",0,!0,!0,!0,null,null,!0,null,null,null),new Ee("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",0,!0,!0,!0,null,null,!0,null,null,null),new Ee("%dest = %cast(abs(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(%a * -1.0);\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(clamp(%a,0.0,1.0));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",null,!0,!0,!0,3,3,!0,null,null,null),new Ee("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,!0,!0,!0,4,4,!0,null,null,null),new Ee("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,!0,!0,!0,4,3,!0,null,null,null),new Ee("%dest = %cast(dFdx(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(dFdy(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("if (float(%a)==float(%b)) {;\n",0,!1,!0,!0,null,null,null,!0,null,null),new Ee("if (float(%a)!=float(%b)) {;\n",0,!1,!0,!0,null,null,null,!0,null,null),new Ee("if (float(%a)>=float(%b)) {;\n",0,!1,!0,!0,null,null,null,!0,null,null),new Ee("if (float(%a)<float(%b)) {;\n",0,!1,!0,!0,null,null,null,!0,null,null),new Ee("} else {;\n",0,!1,!1,!1,null,null,null,null,null,null),new Ee("};\n",0,!1,!1,!1,null,null,null,null,null,null),new Ee(null,null,null,null,!1,null,null,null,null,null,null),new Ee(null,null,null,null,!1,null,null,null,null,null,null),new Ee(null,null,null,null,!1,null,null,null,null,null,null),new Ee(null,null,null,null,!1,null,null,null,null,null,null),new Ee("%dest = %cast(texture%texdimLod(%b,%texsize(%a)).%dm);\n",null,!0,!0,!0,null,null,null,null,!0,null),new Ee("if ( float(%a)<0.0 ) discard;\n",null,!1,!0,!1,null,null,null,!0,null,null),new Ee("%dest = %cast(texture%texdim(%b,%texsize(%a)%lod).%dm);\n",null,!0,!0,!0,null,null,!0,null,!0,!0),new Ee("%dest = %cast(greaterThanEqual(%a,%b).%dm);\n",0,!0,!0,!0,null,null,!0,null,!0,null),new Ee("%dest = %cast(lessThan(%a,%b).%dm);\n",0,!0,!0,!0,null,null,!0,null,!0,null),new Ee("%dest = %cast(sign(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new Ee("%dest = %cast(equal(%a,%b).%dm);\n",0,!0,!0,!0,null,null,!0,null,!0,null),new Ee("%dest = %cast(notEqual(%a,%b).%dm);\n",0,!0,!0,!0,null,null,!0,null,!0,null)],t}(),De=function(){this.mask=0,this.regnum=0,this.regtype=0,this.dim=0,this.indexoffset=0,this.swizzle=0,this.lodbiad=0,this.readmode=0,this.special=0,this.wrap=0,this.filter=0,this.indexregtype=0,this.indexselect=0,this.indirectflag=0},Te=function(){this.dest=new De,this.opcode=0,this.a=new De,this.b=new De},Pe=function(){function t(){}return t.prototype.decribeAGALByteArray=function(t){var e=new we;if(160!=t.readUnsignedByte())throw"Bad AGAL: Missing 0xa0 magic byte.";if(e.version=t.readUnsignedInt(),e.version>=16&&(t.readUnsignedByte(),e.version>>=1),161!=t.readUnsignedByte())throw"Bad AGAL: Missing 0xa1 magic byte.";switch(e.progid=t.readUnsignedByte(),e.progid){case 1:e.type="fragment";break;case 0:e.type="vertex";break;case 2:e.type="cpu";break;default:e.type=""}for(var i=new Ie,n=[];t.position<t.length;){var r=new Te;r.opcode=t.readUnsignedInt();var o=Se.agal2glsllut[r.opcode];if(!o)throw"Opcode not valid or not implemented yet: "+r.opcode;o.matrixheight&&(i.hasmatrix=!0),o.dest?(r.dest.regnum=t.readUnsignedShort(),r.dest.mask=t.readUnsignedByte(),r.dest.regtype=t.readUnsignedByte(),i.regwrite[r.dest.regtype][r.dest.regnum]|=r.dest.mask):(r.dest=null,t.readUnsignedInt()),o.a?this.readReg(r.a,1,i,t):(r.a=null,t.readUnsignedInt(),t.readUnsignedInt()),o.b?this.readReg(r.b,0|o.matrixheight,i,t):(r.b=null,t.readUnsignedInt(),t.readUnsignedInt()),n.push(r)}return i.header=e,i.tokens=n,i},t.prototype.readReg=function(t,e,i,n){if(t.regnum=n.readUnsignedShort(),t.indexoffset=n.readByte(),t.swizzle=n.readUnsignedByte(),t.regtype=n.readUnsignedByte(),i.regread[t.regtype][t.regnum]=15,5==t.regtype?(t.lodbiad=t.indexoffset,t.indexoffset=void 0,t.swizzle=void 0,t.readmode=n.readUnsignedByte(),t.dim=t.readmode>>4,t.readmode&=15,t.special=n.readUnsignedByte(),t.wrap=t.special>>4,t.special&=15,t.mipmap=n.readUnsignedByte(),t.filter=t.mipmap>>4,t.mipmap&=15,i.samplers[t.regnum]=t):(t.indexregtype=n.readUnsignedByte(),t.indexselect=n.readUnsignedByte(),t.indirectflag=n.readUnsignedByte()),t.indirectflag&&(i.hasindirect=!0),!t.indirectflag&&e)for(var r=0;r<e;r++)i.regread[t.regtype][t.regnum+r]=i.regread[t.regtype][t.regnum]},t}(),Be=function(){function t(){}return t.prototype.parse=function(t,e){var i="",n="";i+="precision "+e+" float;\n";var r=t.header.type[0];"vertex"==t.header.type&&(i+="uniform float yflip;\n");var o=t.regread[1].length;o>0&&(i+="uniform vec4 "+r+"c["+o+"];\n");for(var s=0;s<t.regread[2].length||s<t.regwrite[2].length;s++)(t.regread[2][s]||t.regwrite[2][s])&&(i+="vec4 "+r+"t"+s+";\n");for(s=0;s<t.regread[0].length;s++)t.regread[0][s]&&(i+="attribute vec4 va"+s+";\n");for(s=0;s<t.regread[4].length||s<t.regwrite[4].length;s++)(t.regread[4][s]||t.regwrite[4][s])&&(i+="varying vec4 vi"+s+";\n");var a=["2D","Cube","3D",""];for(s=0;s<t.samplers.length;s++)t.samplers[s]&&(i+="uniform sampler"+a[3&t.samplers[s].dim]+" fs"+s+";\n");"vertex"==t.header.type&&(i+="vec4 outpos;\n"),t.writedepth&&(i+="vec4 tmp_FragDepth;\n");var l=!1;n+="void main() {\n";for(s=0;s<t.tokens.length;s++){var u=Se.agal2glsllut[t.tokens[s].opcode];if(-1==u.s.indexOf("dFdx")&&-1==u.s.indexOf("dFdy")||(l=!0),!u)throw"Opcode not valid or not implemented yet: ";for(var c=u.matrixheight||1,h=0;h<c;h++){var p="  "+u.s;if(t.tokens[s].dest){if(u.matrixheight){if(1!=(t.tokens[s].dest.mask>>h&1))continue;var d=this.regtostring(t.tokens[s].dest.regtype,t.tokens[s].dest.regnum,t,r),f="float";d+="."+(_=["x","y","z","w"][h])}else{var _;d=this.regtostring(t.tokens[s].dest.regtype,t.tokens[s].dest.regnum,t,r);if(15!=t.tokens[s].dest.mask){var m=0;switch(_="",1&t.tokens[s].dest.mask&&(m++,_+="x"),2&t.tokens[s].dest.mask&&(m++,_+="y"),4&t.tokens[s].dest.mask&&(m++,_+="z"),8&t.tokens[s].dest.mask&&(m++,_+="w"),d+="."+_,m){case 1:f="float";break;case 2:f="vec2";break;case 3:f="vec3";break;default:throw"Unexpected destination mask"}}else f="vec4",_="xyzw"}p=(p=(p=p.replace("%dest",d)).replace("%cast",f)).replace("%dm",_)}var g=15;if(!u.ndwm&&u.dest&&t.tokens[s].dest&&(g=t.tokens[s].dest.mask),t.tokens[s].a&&(p=p.replace("%a",this.sourcetostring(t.tokens[s].a,0,g,u.scalar,t,r))),t.tokens[s].b&&(p=p.replace("%b",this.sourcetostring(t.tokens[s].b,h,g,u.scalar,t,r)),5==t.tokens[s].b.regtype)){var y=["2D","Cube","3D"][t.tokens[s].b.dim],A=["vec2","vec3","vec3"][t.tokens[s].b.dim];p=(p=(p=p.replace("%texdim",y)).replace("%texsize",A)).replace("%lod","")}n+=p}}return"vertex"==t.header.type&&(n+="  gl_Position = vec4(outpos.x, outpos.y, outpos.z*2.0 - outpos.w, outpos.w);\n"),l&&"fragment"==t.header.type&&(i="#extension GL_OES_standard_derivatives : enable\n"+i),t.writedepth&&(n+="  gl_FragDepth = clamp(tmp_FragDepth,0.0,1.0);\n"),i+(n+="}\n")},t.prototype.regtostring=function(t,e,i,n){switch(t){case 0:return"va"+e;case 1:return i.header.type[0]+"c["+e+"]";case 2:return n+"t"+e;case 3:return"vertex"==i.header.type?"outpos":"gl_FragColor";case 4:return"vi"+e;case 5:return"fs"+e;case 6:return"tmp_FragDepth";default:throw"Unknown register type"}},t.prototype.sourcetostring=function(t,e,i,n,r,o){var s,a=["x","y","z","w"];if(t.indirectflag){s="vcarrr[int("+this.regtostring(t.indexregtype,t.regnum,r,o)+"."+a[t.indexselect]+")";var l=e+t.indexoffset;l<0&&(s+=l.toString()),l>0&&(s+="+"+l.toString()),s+="]"}else s=this.regtostring(t.regtype,t.regnum+e,r,o);return 5==t.regtype?s:n?s+"."+a[t.swizzle>>0&3]:(228==t.swizzle&&15==i||(s+=".",1&i&&(s+=a[t.swizzle>>0&3]),2&i&&(s+=a[t.swizzle>>2&3]),4&i&&(s+=a[t.swizzle>>4&3]),8&i&&(s+=a[t.swizzle>>6&3])),s)},t.maxvertexconstants=128,t.maxfragconstants=28,t.maxtemp=8,t.maxstreams=8,t.maxtextures=8,t}();!function(t){t[t.DESTINATION_ALPHA=0]="DESTINATION_ALPHA",t[t.DESTINATION_COLOR=1]="DESTINATION_COLOR",t[t.ONE=2]="ONE",t[t.ONE_MINUS_DESTINATION_ALPHA=3]="ONE_MINUS_DESTINATION_ALPHA",t[t.ONE_MINUS_DESTINATION_COLOR=4]="ONE_MINUS_DESTINATION_COLOR",t[t.ONE_MINUS_SOURCE_ALPHA=5]="ONE_MINUS_SOURCE_ALPHA",t[t.ONE_MINUS_SOURCE_COLOR=6]="ONE_MINUS_SOURCE_COLOR",t[t.SOURCE_ALPHA=7]="SOURCE_ALPHA",t[t.SOURCE_COLOR=8]="SOURCE_COLOR",t[t.ZERO=9]="ZERO"}(Lt||(Lt={})),function(t){t[t.COLOR=1]="COLOR",t[t.DEPTH=2]="DEPTH",t[t.STENCIL=4]="STENCIL",t[t.ALL=7]="ALL"}(Rt||(Rt={})),function(t){t[t.ALWAYS=0]="ALWAYS",t[t.EQUAL=1]="EQUAL",t[t.GREATER=2]="GREATER",t[t.GREATER_EQUAL=3]="GREATER_EQUAL",t[t.LESS=4]="LESS",t[t.LESS_EQUAL=5]="LESS_EQUAL",t[t.NEVER=6]="NEVER",t[t.NOT_EQUAL=7]="NOT_EQUAL"}(Nt||(Nt={})),function(t){t[t.TRIANGLES=0]="TRIANGLES",t[t.LINES=1]="LINES"}(Ft||(Ft={})),function(t){t[t.MIPLINEAR=0]="MIPLINEAR",t[t.MIPNEAREST=1]="MIPNEAREST",t[t.MIPNONE=2]="MIPNONE"}(kt||(kt={})),function(t){t[t.BASELINE=0]="BASELINE",t[t.BASELINE_CONSTRAINED=1]="BASELINE_CONSTRAINED",t[t.BASELINE_EXTENDED=2]="BASELINE_EXTENDED"}(Vt||(Vt={})),function(t){t[t.FRAGMENT=0]="FRAGMENT",t[t.SAMPLER=1]="SAMPLER",t[t.VERTEX=2]="VERTEX"}(Ut||(Ut={})),function(t){t[t.DECREMENT_SATURATE=0]="DECREMENT_SATURATE",t[t.DECREMENT_WRAP=1]="DECREMENT_WRAP",t[t.INCREMENT_SATURATE=2]="INCREMENT_SATURATE",t[t.INCREMENT_WRAP=3]="INCREMENT_WRAP",t[t.INVERT=4]="INVERT",t[t.KEEP=5]="KEEP",t[t.SET=6]="SET",t[t.ZERO=7]="ZERO"}(jt||(jt={})),function(t){t[t.LINEAR=0]="LINEAR",t[t.NEAREST=1]="NEAREST"}(Gt||(Gt={})),function(t){t[t.BGRA=0]="BGRA",t[t.BGRA_PACKED=1]="BGRA_PACKED",t[t.BGR_PACKED=2]="BGR_PACKED",t[t.COMPRESSED=3]="COMPRESSED",t[t.COMPRESSED_ALPHA=4]="COMPRESSED_ALPHA"}(Qt||(Qt={})),function(t){t[t.BACK=0]="BACK",t[t.FRONT=1]="FRONT",t[t.FRONT_AND_BACK=2]="FRONT_AND_BACK",t[t.NONE=3]="NONE"}(zt||(zt={})),function(t){t[t.FLOAT_1=0]="FLOAT_1",t[t.FLOAT_2=1]="FLOAT_2",t[t.FLOAT_3=2]="FLOAT_3",t[t.FLOAT_4=3]="FLOAT_4",t[t.BYTE_1=4]="BYTE_1",t[t.BYTE_2=5]="BYTE_2",t[t.BYTE_3=6]="BYTE_3",t[t.BYTE_4=7]="BYTE_4",t[t.UNSIGNED_BYTE_1=8]="UNSIGNED_BYTE_1",t[t.UNSIGNED_BYTE_2=9]="UNSIGNED_BYTE_2",t[t.UNSIGNED_BYTE_3=10]="UNSIGNED_BYTE_3",t[t.UNSIGNED_BYTE_4=11]="UNSIGNED_BYTE_4",t[t.SHORT_1=12]="SHORT_1",t[t.SHORT_2=13]="SHORT_2",t[t.SHORT_3=14]="SHORT_3",t[t.SHORT_4=15]="SHORT_4",t[t.UNSIGNED_SHORT_1=16]="UNSIGNED_SHORT_1",t[t.UNSIGNED_SHORT_2=17]="UNSIGNED_SHORT_2",t[t.UNSIGNED_SHORT_3=18]="UNSIGNED_SHORT_3",t[t.UNSIGNED_SHORT_4=19]="UNSIGNED_SHORT_4"}(Ht||(Ht={})),function(t){t[t.CLAMP=0]="CLAMP",t[t.REPEAT=1]="REPEAT"}(Xt||(Xt={})),function(t){t[t.AUTO=0]="AUTO",t[t.WEBGL=1]="WEBGL",t[t.FLASH=2]="FLASH",t[t.GLES=3]="GLES",t[t.NATIVE=4]="NATIVE",t[t.SOFTWARE=5]="SOFTWARE"}(qt||(qt={}));var Me=function(){function t(t,e,i,n,r){void 0===t&&(t=-1),void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this.id=t,this.type=e,this.wrap=i,this.filter=n,this.mipfilter=r,this.boundedTexture=null}return Object.defineProperty(t.prototype,"valid",{get:function(){return null!==this.type&&this.id>=0},enumerable:!0,configurable:!0}),t.prototype.equals=function(t){return this.type===t.type&&this.wrap===t.wrap&&this.filter===t.filter&&this.mipfilter===t.mipfilter},t.prototype.copyFrom=function(t){return this.type=t.type,this.wrap=t.wrap,this.filter=t.filter,this.mipfilter=t.mipfilter,this},t.prototype.dispose=function(){this.id=-1,this.type=null,this.wrap=0,this.filter=0,this.mipfilter=0},t}(),Oe=function(t,e,i){this.x=t,this.y=e,this.id=i},Le=function(t){function e(e,i){var n=t.call(this,e)||this;return n._image=i,n}return i(e,t),Object.defineProperty(e.prototype,"image",{get:function(){return this._image},enumerable:!0,configurable:!0}),e.INVALIDATE_MIPMAPS="invalidateMipmaps",e}(a),Re=function(t){function e(e,i){var n=t.call(this,e)||this;return n._stage=i,n}return i(e,t),Object.defineProperty(e.prototype,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._stage)},e.STAGE_ERROR="stageError",e.CONTEXT_CREATED="contextCreated",e.CONTEXT_DISPOSED="contextDisposed",e.CONTEXT_RECREATED="contextRecreated",e.INVALIDATE_SIZE="invalidateSize",e}(a),Ne=function(t){function e(e,i){var n=t.call(this,e)||this;return n._rttManager=i,n}return i(e,t),Object.defineProperty(e.prototype,"rttManager",{get:function(){return this._rttManager},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._rttManager)},e.RESIZE="rttManagerResize",e}(a);function Fe(t,e){return t.priority-e.priority}var ke=function(){function t(){}return t.createManager=function(t){t=Object.assign({name:Ve.name+":"+this.managers.length},t||{});var e=new Ve(t);return this.managers.push(e),this.managers.sort(Fe),e},t.executeAll=function(){for(var t=0,e=this.managers;t<e.length;t++){var i=e[t],n=i.execute();n&&console.debug("[UnloadService:"+i.name+", tick: "+this.tick+"] unloaded:",n)}this.tick++},t.clearAll=function(){for(var t=0,e=this.managers;t<e.length;t++){e[t].clear()}this.tick=0,this.managers.length=0},t.tick=0,t.managers=[],t}(),Ve=function(){function t(e){var i;this._tasks=new Set,this.name=t.name,this.priority=0,this.keepAliveTime=1e4,this.exectuionTimeout=5e3,this.unloadTaskShift=1e3,this.maxUnloadTask=100,this._lastExecutionTime=0,this._lastCorrectedTime=-1,e&&(this.name=e.name||this.name,this.priority=null!=(i=e.priority)?i:this.priority,this.keepAliveTime=e.keepAliveTime||this.keepAliveTime,this.maxUnloadTask=e.maxUnloadTasks||this.maxUnloadTask,this.exectuionTimeout=e.exectionPeriod||this.exectuionTimeout)}return Object.defineProperty(t.prototype,"correctedTime",{get:function(){var e=performance.now();return(this._lastCorrectedTime<0||this._lastCorrectedTime-e>=t.MIN_QUANT)&&(e+=t.MIN_QUANT),this._lastCorrectedTime=e},enumerable:!0,configurable:!0}),t.prototype.addTask=function(t){return!(!t||this._tasks.has(t))&&(this._tasks.add(t),!0)},t.prototype.removeTask=function(t){return this._tasks.delete(t)},t.prototype.execute=function(t){if(void 0===t&&(t=!1),this._tasks.size){var e=this.correctedTime;if(!t){if(!this._lastExecutionTime)return void(this._lastExecutionTime=e);if(e-this._lastExecutionTime<this.exectuionTimeout)return}this._lastExecutionTime=e;for(var i=[],n=this._tasks.values(),r=0,o=this._tasks.size;r<o;r++){var s=n.next().value;if(s.canUnload&&e-s.lastUsedTime>(s.keepAliveTime||this.keepAliveTime)&&(s.unload(),i[i.length]=s,i.length>=this.maxUnloadTask)){this._lastExecutionTime-=this.exectuionTimeout-this.unloadTaskShift;break}}for(var a=0,l=i;a<l.length;a++){var u=l[a];this._tasks.delete(u)}return i.length}},t.prototype.clear=function(){this._tasks.clear()},t.MIN_QUANT=32,t}(),Ue=function(t){function e(){var e=t.call(this)||this;return e._pFormat="bgra",e}return i(e,t),Object.defineProperty(e.prototype,"format",{get:function(){return this._pFormat},enumerable:!0,configurable:!0}),e.prototype.invalidateMipmaps=function(){this.dispatchEvent(new Le(Le.INVALIDATE_MIPMAPS,this))},e}(p),je=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.usages=0,n._invalidMipmaps=!0,n._invalidMapper=!0,n._stage=i,n._onInvalidateMipmapsDelegate=function(t){return n._onInvalidateMipmaps(t)},n._asset.addEventListener(Le.INVALIDATE_MIPMAPS,n._onInvalidateMipmapsDelegate),n}return i(e,t),e.prototype.getTexture=function(){return this._texture||(this._createTexture(),this._invalid=!0),this._texture},e.prototype.getType=function(){throw new s},e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._texture&&(this._texture.dispose(),this._texture=null)},e.prototype.activate=function(t,e){void 0===e&&(e=null),e||(e=on.getDefaultSampler());var i=!(!e.mipmap||this._stage.globalDisableMipmap)&&e.mipmap;this._stage.setSamplerAt(t,e),this._stage.context.setTextureAt(t,this.getTexture()),!this._mipmap&&i&&(this._mipmap=!0,this._invalidMipmaps=!0),this._invalidMipmaps&&(this._invalidMipmaps=!1,i&&this._texture.generateMipmaps())},e.prototype._createTexture=function(){throw new s},e.prototype._onInvalidateMipmaps=function(t){this._invalidMipmaps=!0},e}(K),Ge=function(){function t(){}return t.trueValue=32,t.falseValue=33,t.intMask=63,t.drawTriangles=41,t.setProgramConstant=42,t.setProgram=43,t.present=44,t.clear=45,t.initProgram=46,t.initVertexBuffer=47,t.initIndexBuffer=48,t.configureBackBuffer=49,t.uploadArrayIndexBuffer=50,t.uploadArrayVertexBuffer=51,t.uploadAGALBytesProgram=52,t.setVertexBufferAt=53,t.uploadBytesIndexBuffer=54,t.uploadBytesVertexBuffer=55,t.setColorMask=56,t.setDepthTest=57,t.disposeProgram=58,t.disposeContext=59,t.disposeVertexBuffer=61,t.disposeIndexBuffer=63,t.initTexture=64,t.setTextureAt=65,t.uploadBytesTexture=66,t.disposeTexture=67,t.setCulling=68,t.setScissorRect=69,t.clearScissorRect=70,t.setBlendFactors=71,t.setRenderToTexture=72,t.clearTextureAt=73,t.clearVertexBufferAt=74,t.setStencilActions=75,t.setStencilReferenceValue=76,t.initCubeTexture=77,t.disposeCubeTexture=78,t.uploadBytesCubeTexture=79,t.clearRenderToTexture=80,t.enableErrorChecking=81,t.drawVertices=82,t.getFrameBufferForTexture=83,t.uploadProgram=84,t.disableCulling=85,t.disableBlending=86,t.setSamplerStateAt=87,t.enableStencil=88,t.disableStencil=89,t.setStencilActionsMasks=90,t.uploadTextureFromURL=92,t.startSound=101,t.stopSound=102,t.updateSound=103,t}(),Qe=function(){function t(t,e){this._context=t,this._id=e}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t}(),ze=function(t){function e(e,i,n){var r=t.call(this,e,n)||this;return r.textureType="",r}return i(e,t),e.prototype.dispose=function(){this._context._createBytes.writeInt(Ge.disposeTexture),this._context._createBytes.writeInt(this.id)},Object.defineProperty(e.prototype,"glTexture",{get:function(){return this._glTexture},enumerable:!0,configurable:!0}),e.prototype.generateMipmaps=function(){},e}(Qe),He=function(t){function e(e,i,n,r){var o=t.call(this,e,i,r)||this;return o._textureSelectorDictionary=new Array(6),o.textureType="textureCube",o._size=n,o}return i(e,t),e.prototype.uploadFromArray=function(t,e,i,n){if(t.length!=this._size*this._size*4)throw new Error("Array is not the correct length for texture dimensions");t instanceof Array&&(t=new Uint8Array(t))},e.prototype.uploadCompressedTextureFromArray=function(t,e,i){},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),e}(ze),Xe=function(t){function e(e,i,n,r){var o=t.call(this,e,r)||this;return o._gl=i,o._numIndices=n,o}return i(e,t),e.prototype.uploadFromArray=function(t,e,i){},e.prototype.uploadFromByteArray=function(t,e,i){},e.prototype.dispose=function(){},Object.defineProperty(e.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:!0,configurable:!0}),e}(Qe),qe=function(){function t(){}return Object.defineProperty(t,"gles",{get:function(){if(!t._gles)throw"Error: Set GlesConnector.gles before calling methods on ContextGLES!";return t._gles},set:function(e){t._gles=e},enumerable:!0,configurable:!0}),t._gles=null,t}(),Ye=function(t){function e(e,i,n){var r=t.call(this,e,n)||this;return r._uniforms=[[],[],[]],r._attribs=[],r}return i(e,t),e.prototype.upload=function(t,i){var n=0!=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT).precision?"highp":"mediump",r=0!=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT).precision?"highp":"mediump",o=e._aglslParser.parse(e._tokenizer.decribeAGALByteArray(t),n),s=e._aglslParser.parse(e._tokenizer.decribeAGALByteArray(i),r),a=new bt;a.writeInt(1),a.writeInt(Ge.uploadProgram),a.writeInt(this.id),a.writeUTFBytes(o),a.writeUTFBytes(s),a.bytePosition=0;var l=new Int32Array(a.byteLength/4);a.readInt32Array(l),qe.gles.sendGLESCommands(l.buffer)},e.prototype.getUniformLocation=function(t,e){return null},e.prototype.getAttribLocation=function(t){return 0},e.prototype.dispose=function(){this._context._createBytes.writeInt(Ge.disposeProgram),this._context._createBytes.writeInt(this.id)},e.prototype.focusProgram=function(){},Object.defineProperty(e.prototype,"glProgram",{get:function(){return this._program},enumerable:!0,configurable:!0}),e._tokenizer=new Pe,e._aglslParser=new Be,e._uniformLocationNameDictionary=["fc","fs","vc"],e}(Qe),Ke=function(t){function e(e,i,n,r,o){var s=t.call(this,e,i,o)||this;return s.textureType="texture2d",s._width=n,s._height=r,s}return i(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameBuffer",{get:function(){return this._frameBuffer},enumerable:!0,configurable:!0}),e.prototype.uploadFromArray=function(t,e,i){if(void 0===e&&(e=0),t.length!=this._width*this._height*4)throw new Error("Array is not the correct length for texture dimensions");t instanceof Array&&(t=new Uint8Array(t));var n=new bt;n.writeInt(1),n.writeInt(Ge.uploadBytesTexture|e<<8),n.writeInt(this.id),n.writeFloat(this._width),n.writeFloat(this._height),n.writeInt(t.buffer.byteLength),n.writeInt32Array(new Int32Array(t.buffer)),n.bytePosition=0;var r=new Int32Array(n.byteLength/4);n.readInt32Array(r),qe.gles.sendGLESCommands(r.buffer)},e.prototype.uploadFromURL=function(t,e,i){void 0===e&&(e=0);var n=new bt;n.writeInt(1),n.writeInt(Ge.uploadTextureFromURL|e<<8),n.writeInt(this.id);var r=t.url.replace(/[^a-zA-Z0-9]/g,"");console.log("urlRequest.url "+r),n.writeUTFBytes(r),n.bytePosition=0;var o=new Int32Array(n.byteLength/4);n.readInt32Array(o),qe.gles.sendGLESCommands(o.buffer)},e.prototype.uploadCompressedTextureFromArray=function(t,e,i){},e}(ze),We=function(t){function e(e,i,n,r,o){var s=t.call(this,e,o)||this;return s._numVertices=n,s._dataPerVertex=r,s}return i(e,t),e.prototype.uploadFromArray=function(t,e,i){},e.prototype.uploadFromByteArray=function(t,e,i){var n=new bt;n.writeInt(1),n.writeInt(Ge.uploadArrayVertexBuffer),n.writeInt(this.id),n.writeInt(e),n.writeInt(t.byteLength),n.writeInt32Array(new Int32Array(t)),n.bytePosition=0;var r=new Int32Array(n.byteLength/4);n.readInt32Array(r),qe.gles.sendGLESCommands(r.buffer)},Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataPerVertex",{get:function(){return this._dataPerVertex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._context._createBytes.writeInt(Ge.disposeVertexBuffer),this._context._createBytes.writeInt(this.id)},e}(Qe),Je=function(){function t(e){this._blendFactorDictionary=new Object,this._drawModeDictionary=new Object,this._compareModeDictionary=new Object,this.stencilTriangleFace=new Object,this._stencilActionDictionary=new Object,this._textureIndexDictionary=new Array(8),this._textureTypeDictionary=new Object,this._wrapDictionary=new Object,this._filterDictionary=new Object,this._mipmapFilterDictionary=new Object,this._vertexBufferPropertiesDictionary=[],this.hasVao=!1,this._samplerStates=new Array(8),this._stencilReferenceValue=0,this._stencilReadMask=255,this._separateStencil=!1,this._textureCnt=0,this._programCnt=0,this._cubeTextureCnt=0,this._indexBufferCnt=0,this._vertexBufferCnt=0,this._container=e,this._cmdBytes=new bt,this._createBytes=new bt,t._soundBytes=new bt,t._soundBytes.writeUnsignedInt(100),this._cmdBytes.writeUnsignedInt(0),this._createBytes.writeUnsignedInt(1),this._blendFactorDictionary[Lt.ONE]=0,this._blendFactorDictionary[Lt.DESTINATION_ALPHA]=1,this._blendFactorDictionary[Lt.DESTINATION_COLOR]=2,this._blendFactorDictionary[Lt.ONE_MINUS_DESTINATION_ALPHA]=3,this._blendFactorDictionary[Lt.ONE_MINUS_DESTINATION_COLOR]=4,this._blendFactorDictionary[Lt.ONE_MINUS_SOURCE_ALPHA]=5,this._blendFactorDictionary[Lt.ONE_MINUS_SOURCE_COLOR]=6,this._blendFactorDictionary[Lt.SOURCE_ALPHA]=7,this._blendFactorDictionary[Lt.SOURCE_COLOR]=8,this._blendFactorDictionary[Lt.ZERO]=9,this._drawModeDictionary[Ft.LINES]=0,this._drawModeDictionary[Ft.TRIANGLES]=1,this._compareModeDictionary[Nt.ALWAYS]=0,this._compareModeDictionary[Nt.EQUAL]=1,this._compareModeDictionary[Nt.GREATER]=2,this._compareModeDictionary[Nt.GREATER_EQUAL]=3,this._compareModeDictionary[Nt.LESS]=4,this._compareModeDictionary[Nt.LESS_EQUAL]=5,this._compareModeDictionary[Nt.NEVER]=6,this._compareModeDictionary[Nt.NOT_EQUAL]=7,this.stencilTriangleFace[zt.BACK]=2,this.stencilTriangleFace[zt.FRONT]=1,this.stencilTriangleFace[zt.FRONT_AND_BACK]=0,this._stencilActionDictionary[jt.DECREMENT_SATURATE]=0,this._stencilActionDictionary[jt.DECREMENT_WRAP]=1,this._stencilActionDictionary[jt.INCREMENT_SATURATE]=2,this._stencilActionDictionary[jt.INCREMENT_WRAP]=3,this._stencilActionDictionary[jt.INVERT]=4,this._stencilActionDictionary[jt.KEEP]=5,this._stencilActionDictionary[jt.SET]=6,this._stencilActionDictionary[jt.ZERO]=7,this._textureTypeDictionary.texture2d=0,this._textureTypeDictionary.textureCube=1,this._wrapDictionary[Xt.REPEAT]=0,this._wrapDictionary[Xt.CLAMP]=1,this._filterDictionary[Gt.LINEAR]=0,this._filterDictionary[Gt.NEAREST]=1,this._mipmapFilterDictionary[Gt.LINEAR]=new Object,this._mipmapFilterDictionary[Gt.LINEAR][kt.MIPNEAREST]=2,this._mipmapFilterDictionary[Gt.LINEAR][kt.MIPLINEAR]=3,this._mipmapFilterDictionary[Gt.LINEAR][kt.MIPNONE]=0,this._mipmapFilterDictionary[Gt.NEAREST]=new Object,this._mipmapFilterDictionary[Gt.NEAREST][kt.MIPNEAREST]=4,this._mipmapFilterDictionary[Gt.NEAREST][kt.MIPLINEAR]=5,this._mipmapFilterDictionary[Gt.NEAREST][kt.MIPNONE]=1}return t.prototype.createVao=function(){return null},t.startSound=function(e,i,n,r){t._soundBytes.writeInt(Ge.startSound|(r?1:0)<<8),t._soundBytes.writeFloat(n),t._soundBytes.writeInt(i),t._soundBytes.writeUTFBytes(e)},t.stopSound=function(e){t._soundBytes.writeInt(Ge.stopSound),t._soundBytes.writeInt(e)},t.updateSound=function(e,i,n){t._soundBytes.writeInt(Ge.updateSound|(n?1:0)<<8),t._soundBytes.writeFloat(i),t._soundBytes.writeInt(e)},Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"standardDerivatives",{get:function(){return this._standardDerivatives},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glVersion",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelRatio",{get:function(){return 1},enumerable:!0,configurable:!0}),t.prototype.enableStencil=function(){this._cmdBytes.writeInt(Ge.enableStencil)},t.prototype.disableStencil=function(){this._cmdBytes.writeInt(Ge.disableStencil)},t.prototype.gl=function(){return this._gl},t.prototype.clear=function(t,e,i,n,r,o,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=0),void 0===s&&(s=Rt.ALL),this._cmdBytes.writeInt(Ge.clear),this._cmdBytes.writeFloat(t),this._cmdBytes.writeFloat(e),this._cmdBytes.writeFloat(i),this._cmdBytes.writeFloat(n),this._cmdBytes.writeInt(r),this._cmdBytes.writeInt(o),this._cmdBytes.writeInt(s)},t.prototype.configureBackBuffer=function(t,e,i,n){void 0===n&&(n=!0),this._width=t,this._height=e,this._cmdBytes.writeInt(Ge.configureBackBuffer|(n?1:0)<<8),this._cmdBytes.writeFloat(t),this._cmdBytes.writeFloat(e)},t.prototype.createCubeTexture=function(t,e,i,n){return new He(this,this._gl,t,this._cubeTextureCnt++)},t.prototype.createIndexBuffer=function(t){return new Xe(this,this._gl,t,this._indexBufferCnt++)},t.prototype.createProgram=function(){return new Ye(this,this._gl,this._programCnt++)},t.prototype.createTexture=function(t,e,i,n,r){return new Ke(this,this._gl,t,e,this._textureCnt++)},t.prototype.createVertexBuffer=function(t,e){return new We(this,this._gl,t,e,this._vertexBufferCnt++)},t.prototype.dispose=function(){this._cmdBytes.writeInt(Ge.disposeContext),this.execute()},t.prototype.drawToBitmapImage2D=function(t){},t.prototype.drawIndices=function(t,e,i,n){},t.prototype.drawVertices=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._cmdBytes.writeInt(Ge.drawVertices|this._drawModeDictionary[t]<<8),this._cmdBytes.writeInt(e),this._cmdBytes.writeInt(i)},t.prototype.present=function(){this.execute()},t.prototype.setBlendFactors=function(t,e){this._blendEnabled=!0,this._blendSourceFactor=this._blendFactorDictionary[t],this._blendDestinationFactor=this._blendFactorDictionary[e],this.updateBlendStatus()},t.prototype.setColorMask=function(t,e,i,n){this._cmdBytes.writeInt(Ge.setColorMask),this._cmdBytes.writeInt((t?1:0)|(e?1:0)<<8|(i?1:0)<<16|(n?1:0)<<24)},t.prototype.setCulling=function(t,e){if(void 0===e&&(e=_t.LEFT_HANDED),t!=zt.NONE){var i=this.translateTriangleFace(t,e);this._cmdBytes.writeInt(Ge.setCulling|i<<8)}else this._cmdBytes.writeInt(Ge.disableCulling)},t.prototype.setDepthTest=function(t,e){this._cmdBytes.writeInt(Ge.setDepthTest|(t?1:0)<<8|this._compareModeDictionary[e]<<16)},t.prototype.setStencilActionsMasks=function(t,e,i,n,r,o,s){void 0===n&&(n="keep"),void 0===r&&(r="keep"),void 0===o&&(o="keep");var a=this._compareModeDictionary[t],l=this._stencilActionDictionary[o],u=this._stencilActionDictionary[r],c=this._stencilActionDictionary[n];this._cmdBytes.writeInt(Ge.setStencilActionsMasks|a<<8),this._cmdBytes.writeInt(e),this._cmdBytes.writeInt(i|l<<8|u<<16|c<<24)},t.prototype.setStencilActions=function(t,e,i,n,r,o){void 0===t&&(t=zt.FRONT_AND_BACK),void 0===e&&(e=Nt.ALWAYS),void 0===i&&(i=jt.KEEP),void 0===n&&(n=jt.KEEP),void 0===r&&(r=jt.KEEP),void 0===o&&(o=_t.LEFT_HANDED);var s=this._compareModeDictionary[e],a=this.stencilTriangleFace[t],l=this._stencilActionDictionary[r],u=this._stencilActionDictionary[n],c=this._stencilActionDictionary[i];this._cmdBytes.writeInt(Ge.setStencilActions|a<<8),this._cmdBytes.writeInt(s|l<<8|u<<16|c<<24)},t.prototype.setStencilReferenceValue=function(t,e,i){void 0===e&&(e=255),void 0===i&&(i=255),this._cmdBytes.writeInt(Ge.setStencilReferenceValue),this._cmdBytes.writeInt(t),this._cmdBytes.writeInt(e),this._cmdBytes.writeInt(i)},t.prototype.setProgram=function(t){this._cmdBytes.writeInt(Ge.setProgram),this._cmdBytes.writeInt(t.id)},t.prototype.setProgramConstantsFromArray=function(t,e){this._cmdBytes.writeInt(Ge.setProgramConstant|t<<8),this._cmdBytes.writeInt(e.length),this._cmdBytes.writeFloat32Array(e)},t.prototype.setScissorRectangle=function(t){t?(this._cmdBytes.writeInt(Ge.setScissorRect),this._cmdBytes.writeFloat(t.x),this._cmdBytes.writeFloat(t.y),this._cmdBytes.writeFloat(t.width),this._cmdBytes.writeFloat(t.height)):this._cmdBytes.writeInt(Ge.clearScissorRect)},t.prototype.setTextureAt=function(t,e){e?(this._cmdBytes.writeInt(Ge.setTextureAt|t<<8),this._cmdBytes.writeInt(e.id)):this._cmdBytes.writeInt(Ge.clearTextureAt|t<<8)},t.prototype.setSamplerStateAt=function(t,e,i,n){this._cmdBytes.writeInt(Ge.setSamplerStateAt|t<<8),this._cmdBytes.writeInt(this._wrapDictionary[e]|this._filterDictionary[i]<<8|this._mipmapFilterDictionary[i][n]<<16)},t.prototype.setVertexBufferAt=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=4),e?(this._cmdBytes.writeInt(Ge.setVertexBufferAt|t<<8|n<<16|e.dataPerVertex<<24),this._cmdBytes.writeInt(e.id),this._cmdBytes.writeInt(i)):this._cmdBytes.writeInt(Ge.clearVertexBufferAt|t<<8)},t.prototype.setRenderToTexture=function(t,e,i,n,r){void 0===e&&(e=!1),null==t?this._cmdBytes.writeInt(Ge.clearRenderToTexture):(this._cmdBytes.writeInt(Ge.setRenderToTexture|(e?1:0)<<8),this._cmdBytes.writeInt(t.id))},t.prototype.setRenderToBackBuffer=function(){this._cmdBytes.writeInt(Ge.clearRenderToTexture)},t.prototype.copyToTexture=function(t,e,i){},t.prototype.updateBlendStatus=function(){this._blendEnabled?this._cmdBytes.writeInt(Ge.setBlendFactors|this._blendSourceFactor<<8|this._blendDestinationFactor<<16):this._cmdBytes.writeUnsignedInt(Ge.disableBlending)},t.prototype.translateTriangleFace=function(t,e){switch(t){case zt.BACK:return e==_t.LEFT_HANDED?2:1;case zt.FRONT:return e==_t.LEFT_HANDED?1:2;case zt.FRONT_AND_BACK:return 0;default:throw"Unknown ContextGLTriangleFace type."}},t.prototype.execute=function(){if(this._createBytes.bytePosition>4){this._createBytes.bytePosition=0;var e=new Int32Array(this._createBytes.byteLength/4);this._createBytes.readInt32Array(e),qe.gles.sendGLESCommands(e.buffer),this._createBytes.byteLength=0,this._createBytes.bytePosition=0,this._createBytes.writeUnsignedInt(1)}if(this._cmdBytes.bytePosition>4){this._cmdBytes.bytePosition=0;var i=new Int32Array(this._cmdBytes.byteLength/4);this._cmdBytes.readInt32Array(i),qe.gles.sendGLESCommands(i.buffer),this._cmdBytes.byteLength=0,this._cmdBytes.bytePosition=0,this._cmdBytes.writeUnsignedInt(0)}if(t._soundBytes.bytePosition>4){t._soundBytes.bytePosition=0;var n=new Int32Array(t._soundBytes.byteLength/4);t._soundBytes.readInt32Array(n),qe.gles.sendGLESCommands(n.buffer),t._soundBytes.byteLength=0,t._soundBytes.bytePosition=0,t._soundBytes.writeUnsignedInt(100)}},t.prototype.finish=function(){},t._uniformLocationNameDictionary=["fc","fs","vc"],t.MAX_SAMPLERS=8,t.modulo=0,t}(),Ze=function(t){function e(e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=!1);var r=t.call(this)||this;return r._repeat=e,r._smooth=i,r._mipmap=n,r}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeat",{get:function(){return this._repeat},set:function(t){this._repeat!=t&&(this._repeat=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smooth",{get:function(){return this._smooth},set:function(t){this._smooth!=t&&(this._smooth=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!=t&&(this._mipmap=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageRect",{get:function(){return this._imageRect},set:function(t){this._imageRect!=t&&(this._imageRect=t,this._updateRect())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRect",{get:function(){return this._frameRect},set:function(t){this._frameRect!=t&&(this._frameRect=t,this._updateRect())},enumerable:!0,configurable:!0}),e.prototype._updateRect=function(){},e.assetType="[asset Sampler]",e}(p),$e=function(){function t(t,e,i,n){this.usages=0,this.disposedAt=-1,this.disposed=!1,this._pool=t,this.stage=e,this.vertexString=i,this.fragmentString=n,this.stage.registerProgram(this)}return t.prototype.dispose=function(){this.usages--,this.usages||this._pool.disposeItem(this.vertexString+this.fragmentString)},t.prototype.disposeFinaly=function(){this.stage&&this.stage.unRegisterProgram(this),this.program&&this.program.dispose(),this.program=null,this.usages=0,this.vertexString=void 0,this.fragmentString=void 0,this.disposedAt=-1,this.stage=void 0,this.disposed=!0},t.PROGRAMDATA_ID_COUNT=0,t}(),ti=function(){function t(t){this._pool={},this._disposedPool={},this.keepAlive=1e3,this._stage=t}return t.prototype.collect=function(){var t=Date.now();for(var e in this._disposedPool){var i=this._disposedPool[e];(!i.usages&&i.disposedAt+this.keepAlive<t||i.disposed)&&(delete this._pool[e],delete this._disposedPool[e],i.disposeFinaly())}},t.prototype.getItem=function(t,e){var i=t+e,n=this._pool[i]||(this._pool[i]=new $e(this,this._stage,t,e));return n.disposedAt=-1,delete this._disposedPool[i],this.collect(),n},t.prototype.disposeItem=function(t){var e=this._pool[t];e&&(e.disposedAt=Date.now(),this._disposedPool[t]=e)},t}(),ei=function(){function t(t){this._numIndices=t}return t.prototype.uploadFromArray=function(t,e,i){this._startOffset=2*e,this._data=t},t.prototype.uploadFromByteArray=function(t,e,i){this._startOffset=2*e,this._data=new Uint16Array(t)},t.prototype.dispose=function(){this._data=null},Object.defineProperty(t.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startOffset",{get:function(){return this._startOffset},enumerable:!0,configurable:!0}),t}(),ii=function(){function t(t,e){this._numVertices=t,this._dataPerVertex=e}return t.prototype.uploadFromArray=function(t,e,i){this._floatData=t},t.prototype.uploadFromByteArray=function(t,e,i){this._floatData=new Float32Array(t,e*this._dataPerVertex,i*this._dataPerVertex/4),this._uintData=new Uint8Array(t)},Object.defineProperty(t.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataPerVertex",{get:function(){return this._dataPerVertex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attributesPerVertex",{get:function(){return this._dataPerVertex/4},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._floatData=null},Object.defineProperty(t.prototype,"data",{get:function(){return this._floatData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uintData",{get:function(){return this._uintData},enumerable:!0,configurable:!0}),t}(),ni=function(){function t(t,e){this._mipLevels=[],this._width=t,this._height=e}return Object.defineProperty(t.prototype,"textureType",{get:function(){return t.textureType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._mipLevels=null},t.prototype.isTexture=function(t){return this.textureType==t.textureType},t.prototype.uploadFromArray=function(t,e,i){void 0===e&&(e=0),this._mipLevels[e]=t instanceof Array?new Uint8ClampedArray(t):new Uint8ClampedArray(t.buffer)},t.prototype.uploadFromURL=function(t,e,i){},t.prototype.getData=function(t){return this._mipLevels[t]},t.prototype.getMipLevelsCount=function(){return this._mipLevels.length},t.prototype.generateMipmaps=function(){},t.textureType="texture2d",t}(),ri=function(){function t(t){this._textureSelectorDictionary=[[],[],[],[],[],[]],this._size=t}return Object.defineProperty(t.prototype,"textureType",{get:function(){return t.textureType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._textureSelectorDictionary=null},t.prototype.isTexture=function(t){return this.textureType==t.textureType},t.prototype.uploadFromArray=function(t,e,i,n){void 0===i&&(i=0),this._textureSelectorDictionary[e][i]=t instanceof Array?new Uint8ClampedArray(t):new Uint8ClampedArray(t.buffer)},t.prototype.getData=function(t,e){return void 0===e&&(e=0),this._textureSelectorDictionary[t][e]},t.prototype.getMipLevelsCount=function(){return 1},t.prototype.generateMipmaps=function(){},t.prototype.uploadCompressedTextureFromArray=function(t,e,i){},t.textureType="textureCube",t}(),oi=function(){this.outputColor=new Float32Array([0,0,0,1]),this.discard=!1},si=function(){this.wrap=Xt.REPEAT,this.filter=Gt.LINEAR,this.mipfilter=kt.MIPLINEAR},ai=function(){function t(){this._numVarying=0}return Object.defineProperty(t.prototype,"numVarying",{get:function(){return this._numVarying},enumerable:!0,configurable:!0}),t.prototype.upload=function(e,i){this._vertexDescr=t._tokenizer.decribeAGALByteArray(e),this._vertexVO=new oi,this._vertexVO.temp=new Float32Array(4*this._vertexDescr.regwrite[2].length),this._vertexVO.attributes=new Float32Array(4*this._vertexDescr.regread[0].length),this._numVarying=this._vertexDescr.regwrite[4].length,this._fragmentDescr=t._tokenizer.decribeAGALByteArray(i),this._fragmentVO=new oi,this._fragmentVO.temp=new Float32Array(4*this._fragmentDescr.regwrite[2].length),this._fragmentVO.varying=new Float32Array(4*this._fragmentDescr.regread[4].length),this._fragmentVO.derivativeX=new Float32Array(this._fragmentVO.varying.length),this._fragmentVO.derivativeY=new Float32Array(this._fragmentVO.varying.length)},t.prototype.dispose=function(){this._vertexDescr=null,this._fragmentDescr=null},t.prototype.vertex=function(e,i,n,r){var o=0,s=this._vertexDescr.regread[0].length,a=this._vertexVO.attributes;for(p=0;p<s;p++){var l=e._vertexBuffers[p];if(l){var u=e._vertexBufferOffsets[p]/4+i*l.attributesPerVertex;e._vertexBufferFormats[p]==Ht.UNSIGNED_BYTE_4?(a[o++]=l.uintData[4*u],a[o++]=l.uintData[4*u+1],a[o++]=l.uintData[4*u+2],a[o++]=l.uintData[4*u+3]):e._vertexBufferFormats[p]==Ht.FLOAT_4?(a[o++]=l.data[u],a[o++]=l.data[u+1],a[o++]=l.data[u+2],a[o++]=l.data[u+3]):e._vertexBufferFormats[p]==Ht.FLOAT_3?(a[o++]=l.data[u],a[o++]=l.data[u+1],a[o++]=l.data[u+2],a[o++]=1):e._vertexBufferFormats[p]==Ht.FLOAT_2?(a[o++]=l.data[u],a[o++]=l.data[u+1],a[o++]=0,a[o++]=1):e._vertexBufferFormats[p]==Ht.FLOAT_1&&(a[o++]=l.data[u],a[o++]=0,a[o++]=0,a[o++]=1)}}for(var c=this._vertexVO.temp,h=c.length,p=0;p<h;p+=4)c[p]=0,c[p+1]=0,c[p+2]=0,c[p+3]=1;this._vertexVO.outputPosition=n,this._vertexVO.varying=r;var d=this._vertexDescr.tokens.length;for(p=0;p<d;p++){var f=this._vertexDescr.tokens[p];t._opCodeFunc[f.opcode](this._vertexVO,this._vertexDescr,f.dest,f.a,f.b,e)}},t.prototype.fragment=function(e,i,n,r,o,s,a,l){this._fragmentVO.outputDepth=l,this._fragmentVO.discard=!1;for(var u=this._fragmentVO.temp,c=u.length,h=0;h<c;h+=4)u[h]=0,u[h+1]=0,u[h+2]=0,u[h+3]=1;var p=[],d=this._fragmentDescr.tokens.length;for(h=0;h<d;h++){40==(y=this._fragmentDescr.tokens[h]).opcode&&e._samplerStates[y.b.regnum]&&e._samplerStates[y.b.regnum].mipfilter==kt.MIPLINEAR&&e._textures[y.b.regnum].getMipLevelsCount()>1&&p.push(y.a.regnum)}var f=this._fragmentVO.derivativeX,_=this._fragmentVO.derivativeY,m=this._fragmentVO.varying,g=m.length;for(h=0;h<g;h+=4)m[h]=i.x*o[h]+i.y*s[h]+i.z*a[h],m[h+1]=i.x*o[h+1]+i.y*s[h+1]+i.z*a[h+1],m[h+2]=i.x*o[h+2]+i.y*s[h+2]+i.z*a[h+2],m[h+3]=i.x*o[h+3]+i.y*s[h+3]+i.z*a[h+3],-1!=p.indexOf(h)&&(f[h]=n.x*o[h]+n.y*s[h]+n.z*a[h],f[h+1]=n.x*o[h+1]+n.y*s[h+1]+n.z*a[h+1],f[h+2]=n.x*o[h+2]+n.y*s[h+2]+n.z*a[h+2],f[h+3]=n.x*o[h+3]+n.y*s[h+3]+n.z*a[h+3],f[h]-=m[h],f[h+1]-=m[h+1],f[h+2]-=m[h+2],f[h+3]-=m[h+3],_[h]=r.x*o[h]+r.y*s[h]+r.z*a[h],_[h+1]=r.x*o[h+1]+r.y*s[h+1]+r.z*a[h+1],_[h+2]=r.x*o[h+2]+r.y*s[h+2]+r.z*a[h+2],_[h+3]=r.x*o[h+3]+r.y*s[h+3]+r.z*a[h+3],_[h]-=m[h],_[h+1]-=m[h+1],_[h+2]-=m[h+2],_[h+3]-=m[h+3]);for(h=0;h<d;h++){var y=this._fragmentDescr.tokens[h];t._opCodeFunc[y.opcode](this._fragmentVO,this._fragmentDescr,y.dest,y.a,y.b,e)}return this._fragmentVO},t.getDestTarget=function(t,e,i){var n;return 2==i.regtype?n=t.temp:3==i.regtype?n="vertex"==e.header.type?t.outputPosition:t.outputColor:4==i.regtype&&(n=t.varying),n},t.getSourceTarget=function(t,e,i,n){var r;return 0==i.regtype?r=t.attributes:1==i.regtype?r="vertex"==e.header.type?n._vertexConstants:n._fragmentConstants:2==i.regtype?r=t.temp:4==i.regtype&&(r=t.varying),r},t.mov=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask;1&h&&(u[a]=c[l+(r.swizzle>>0&3)]),2&h&&(u[a+1]=c[l+(r.swizzle>>2&3)]),4&h&&(u[a+2]=c[l+(r.swizzle>>4&3)]),8&h&&(u[a+3]=c[l+(r.swizzle>>6&3)])},t.m44=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask;1&d&&(c[a]=h[l]*p[u]+h[l+1]*p[u+1]+h[l+2]*p[u+2]+p[u+3]),2&d&&(c[a+1]=h[l]*p[u+4]+h[l+1]*p[u+5]+h[l+2]*p[u+6]+p[u+7]),4&d&&(c[a+2]=h[l]*p[u+8]+h[l+1]*p[u+9]+h[l+2]*p[u+10]+p[u+11]),8&d&&(c[a+3]=h[l]*p[u+12]+h[l+1]*p[u+13]+h[l+2]*p[u+14]+p[u+15])},t.sample=function(e,i,n,r,o){var s=n._textures[o];if(s.isTexture(ni))return t.sampleSimpleTexture(e,i,n,r,o);if(s.isTexture(ri))return t.sampleCubeTexture(e,i,n,r,o);throw new S("Cannot sample provided texture type")},t.sampleCubeTexture=function(e,i,n,r,o){var s=4*r.regnum,a=t.getSourceTarget(e,i,r,n),l=a[s+(r.swizzle>>0&3)],u=a[s+(r.swizzle>>2&3)],c=a[s+(r.swizzle>>4&3)],h=0,p=0,d=0,f=Math.abs(l),_=Math.abs(u),m=Math.abs(c),g=Math.max(f,_,m);g==f?l>=0?(h=0,p=.5-c/l*.5,d=.5-u/l*.5):(h=1,p=.5-c/l*.5,d=.5+u/l*.5):g==_?u>=0?(h=2,p=.5+l/u*.5,d=.5+c/u*.5):(h=3,p=.5-l/u*.5,d=.5+c/u*.5):g==m&&(c>=0?(h=4,p=.5+l/c*.5,d=.5-u/c*.5):(h=5,p=.5+l/c*.5,d=.5+u/c*.5));var y=n._textures[o],A=n._samplerStates[o]||this._defaultSamplerState,v=A.wrap==Xt.REPEAT;A.mipfilter,kt.MIPLINEAR;return A.filter==Gt.LINEAR?t.sampleBilinear(p,d,y.getData(h),y.size,y.size,v,t._colorValue0):t.sampleNearest(p,d,y.getData(h),y.size,y.size,v,t._colorValue0)},t.sampleSimpleTexture=function(e,i,n,r,o){var s=4*r.regnum,a=t.getSourceTarget(e,i,r,n),l=a[s+(r.swizzle>>0&3)],u=a[s+(r.swizzle>>2&3)];if(o>=n._textures.length||null==n._textures[o])throw new S("textureIndex contains no texture");var c=n._textures[o],h=n._samplerStates[o]||this._defaultSamplerState,p=h.wrap==Xt.REPEAT;if(h.mipfilter==kt.MIPLINEAR&&c.getMipLevelsCount()>1){var d=Math.abs(e.derivativeX[s+(r.swizzle>>0&3)]),f=Math.abs(e.derivativeX[s+(r.swizzle>>2&3)]),_=Math.abs(e.derivativeY[s+(r.swizzle>>0&3)]),m=Math.abs(e.derivativeY[s+(r.swizzle>>2&3)]),g=Math.log(Math.max(c.width*Math.sqrt(d*d+f*f),c.height*Math.sqrt(_*_+m*m)))/Math.LN2;if(g>0){var y=Math.floor(g),A=Math.ceil(g),v=Math.log(Math.min(c.width,c.height))/Math.LN2;A>v&&(A=v),y>v&&(y=v);var b=g-Math.floor(g),x=c.getData(y),C=c.width/Math.pow(2,y),w=c.height/Math.pow(2,y),I=c.getData(A),E=c.width/Math.pow(2,A),D=c.height/Math.pow(2,A);return h.filter==Gt.LINEAR?(t.sampleBilinear(l,u,x,C,w,p,t._colorValue0),t.sampleBilinear(l,u,I,E,D,p,t._colorValue1)):(t.sampleNearest(l,u,x,C,w,p,t._colorValue0),t.sampleNearest(l,u,I,E,D,p,t._colorValue1)),t.interpolateColor(t._colorValue0,t._colorValue1,b,t._colorValue0)}}return h.filter==Gt.LINEAR?t.sampleBilinear(l,u,c.getData(0),c.width,c.height,p,t._colorValue0):t.sampleNearest(l,u,c.getData(0),c.width,c.height,p,t._colorValue0)},t.sampleNearest=function(t,e,i,n,r,o,s){t*=n,e*=r,o?(t=Math.abs(t%n),e=Math.abs(e%r)):(t<0?t=0:t>n-1&&(t=n-1),e<0?e=0:e>r-1&&(e=r-1));var a=4*((t=Math.floor(t))+(e=Math.floor(e))*n);return s[0]=i[a]/255,s[1]=i[a+1]/255,s[2]=i[a+2]/255,s[3]=i[a+3]/255,s},t.sampleBilinear=function(e,i,n,r,o,s,a){var l=1/r,u=1/o;i-=u/2;var c=(e-=l/2)*r;c-=Math.floor(c);var h=i*o;return h-=Math.floor(h),t.interpolateColor(t.interpolateColor(t.sampleNearest(e,i,n,r,o,s,t._colorInterpolated0),t.sampleNearest(e+l,i,n,r,o,s,t._colorValue0),c,t._colorInterpolated0),t.interpolateColor(t.sampleNearest(e,i+u,n,r,o,s,t._colorInterpolated1),t.sampleNearest(e+l,i+u,n,r,o,s,t._colorValue0),c,t._colorInterpolated1),h,a)},t.interpolateColor=function(t,e,i,n){return n[0]=t[0]+(e[0]-t[0])*i,n[1]=t[1]+(e[1]-t[1])*i,n[2]=t[2]+(e[2]-t[2])*i,n[3]=t[3]+(e[3]-t[3])*i,n},t.tex=function(e,i,n,r,o,s){var a=4*n.regnum,l=t.getDestTarget(e,i,n),u=t.sample(e,i,s,r,o.regnum),c=n.mask;1&c&&(l[a]=u[0]),2&c&&(l[a+1]=u[1]),4&c&&(l[a+2]=u[2]),8&c&&(l[a+3]=u[3])},t.add=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask,f=r.swizzle,_=o.swizzle;1&d&&(c[a]=h[l+(f>>0&3)]+p[u+(_>>0&3)]),2&d&&(c[a+1]=h[l+(f>>2&3)]+p[u+(_>>2&3)]),4&d&&(c[a+2]=h[l+(f>>4&3)]+p[u+(_>>4&3)]),8&d&&(c[a+3]=h[l+(f>>6&3)]+p[u+(_>>6&3)])},t.sub=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask,f=r.swizzle,_=o.swizzle;1&d&&(c[a]=h[l+(f>>0&3)]-p[u+(_>>0&3)]),2&d&&(c[a+1]=h[l+(f>>2&3)]-p[u+(_>>2&3)]),4&d&&(c[a+2]=h[l+(f>>4&3)]-p[u+(_>>4&3)]),8&d&&(c[a+3]=h[l+(f>>6&3)]-p[u+(_>>6&3)])},t.mul=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask,f=r.swizzle,_=o.swizzle;1&d&&(c[a]=h[l+(f>>0&3)]*p[u+(_>>0&3)]),2&d&&(c[a+1]=h[l+(f>>2&3)]*p[u+(_>>2&3)]),4&d&&(c[a+2]=h[l+(f>>4&3)]*p[u+(_>>4&3)]),8&d&&(c[a+3]=h[l+(f>>6&3)]*p[u+(_>>6&3)])},t.div=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask,f=r.swizzle,_=o.swizzle;1&d&&(c[a]=h[l+(f>>0&3)]/p[u+(_>>0&3)]),2&d&&(c[a+1]=h[l+(f>>2&3)]/p[u+(_>>2&3)]),4&d&&(c[a+2]=h[l+(f>>4&3)]/p[u+(_>>4&3)]),8&d&&(c[a+3]=h[l+(f>>6&3)]/p[u+(_>>6&3)])},t.rcp=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=1/c[l+(p>>0&3)]),2&h&&(u[a+1]=1/c[l+(p>>2&3)]),4&h&&(u[a+2]=1/c[l+(p>>4&3)]),8&h&&(u[a+3]=1/c[l+(p>>6&3)])},t.min=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask,f=r.swizzle,_=o.swizzle;1&d&&(c[a]=Math.min(h[l+(f>>0&3)],p[u+(_>>0&3)])),2&d&&(c[a+1]=Math.min(h[l+(f>>2&3)],p[u+(_>>2&3)])),4&d&&(c[a+2]=Math.min(h[l+(f>>4&3)],p[u+(_>>4&3)])),8&d&&(c[a+3]=Math.min(h[l+(f>>6&3)],p[u+(_>>6&3)]))},t.max=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask,f=r.swizzle,_=o.swizzle;1&d&&(c[a]=Math.max(h[l+(f>>0&3)],p[u+(_>>0&3)])),2&d&&(c[a+1]=Math.max(h[l+(f>>2&3)],p[u+(_>>2&3)])),4&d&&(c[a+2]=Math.max(h[l+(f>>4&3)],p[u+(_>>4&3)])),8&d&&(c[a+3]=Math.max(h[l+(f>>6&3)],p[u+(_>>6&3)]))},t.frc=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=c[l+(p>>0&3)]-Math.floor(c[l+(p>>0&3)])),2&h&&(u[a+1]=c[l+(p>>2&3)]-Math.floor(c[l+(p>>2&3)])),4&h&&(u[a+2]=c[l+(p>>4&3)]-Math.floor(c[l+(p>>4&3)])),8&h&&(u[a+3]=c[l+(p>>6&3)]-Math.floor(c[l+(p>>6&3)]))},t.sqt=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=Math.sqrt(c[l+(p>>0&3)])),2&h&&(u[a+1]=Math.sqrt(c[l+(p>>2&3)])),4&h&&(u[a+2]=Math.sqrt(c[l+(p>>4&3)])),8&h&&(u[a+3]=Math.sqrt(c[l+(p>>6&3)]))},t.rsq=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=1/Math.sqrt(c[l+(p>>0&3)])),2&h&&(u[a+1]=1/Math.sqrt(c[l+(p>>2&3)])),4&h&&(u[a+2]=1/Math.sqrt(c[l+(p>>4&3)])),8&h&&(u[a+3]=1/Math.sqrt(c[l+(p>>6&3)]))},t.pow=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask,f=r.swizzle,_=o.swizzle;1&d&&(c[a]=Math.pow(h[l+(f>>0&3)],p[u+(_>>0&3)])),2&d&&(c[a+1]=Math.pow(h[l+(f>>2&3)],p[u+(_>>2&3)])),4&d&&(c[a+2]=Math.pow(h[l+(f>>4&3)],p[u+(_>>4&3)])),8&d&&(c[a+3]=Math.pow(h[l+(f>>6&3)],p[u+(_>>6&3)]))},t.log=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=Math.log(c[l+(p>>0&3)])/Math.LN2),2&h&&(u[a+1]=Math.log(c[l+(p>>2&3)])/Math.LN2),4&h&&(u[a+2]=Math.log(c[l+(p>>4&3)])/Math.LN2),8&h&&(u[a+3]=Math.log(c[l+(p>>6&3)])/Math.LN2)},t.exp=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=Math.exp(c[l+(p>>0&3)])),2&h&&(u[a+1]=Math.exp(c[l+(p>>2&3)])),4&h&&(u[a+2]=Math.exp(c[l+(p>>4&3)])),8&h&&(u[a+3]=Math.exp(c[l+(p>>6&3)]))},t.nrm=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle,d=c[l+(p>>0&3)],f=c[l+(p>>2&3)],_=c[l+(p>>4&3)],m=Math.sqrt(d*d+f*f+_*_);d/=m,f/=m,_/=m,1&h&&(u[a]=d),2&h&&(u[a+1]=f),4&h&&(u[a+2]=_)},t.sin=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=Math.sin(c[l+(p>>0&3)])),2&h&&(u[a+1]=Math.sin(c[l+(p>>2&3)])),4&h&&(u[a+2]=Math.sin(c[l+(p>>4&3)])),8&h&&(u[a+3]=Math.sin(c[l+(p>>6&3)]))},t.cos=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=Math.cos(c[l+(p>>0&3)])),2&h&&(u[a+1]=Math.cos(c[l+(p>>2&3)])),4&h&&(u[a+2]=Math.cos(c[l+(p>>4&3)])),8&h&&(u[a+3]=Math.cos(c[l+(p>>6&3)]))},t.crs=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=n.mask,p=r.swizzle,d=o.swizzle,f=t.getSourceTarget(e,i,r,s),_=f[l+(p>>0&3)],m=f[l+(p>>2&3)],g=f[l+(p>>4&3)],y=t.getSourceTarget(e,i,o,s),A=y[u+(d>>0&3)],v=y[u+(d>>2&3)],b=y[u+(d>>4&3)];1&h&&(c[a]=m*b-g*v),2&h&&(c[a+1]=g*A-_*b),4&h&&(c[a+2]=_*v-m*A)},t.dp3=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=n.mask,p=r.swizzle,d=o.swizzle,f=t.getSourceTarget(e,i,r,s),_=f[l+(p>>0&3)],m=f[l+(p>>2&3)],g=f[l+(p>>4&3)],y=t.getSourceTarget(e,i,o,s),A=y[u+(d>>0&3)],v=y[u+(d>>2&3)],b=y[u+(d>>4&3)];1&h&&(c[a]=_*A+m*v+g*b),2&h&&(c[a+1]=_*A+m*v+g*b),4&h&&(c[a+2]=_*A+m*v+g*b),8&h&&(c[a+3]=_*A+m*v+g*b)},t.dp4=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=n.mask,p=r.swizzle,d=o.swizzle,f=t.getSourceTarget(e,i,r,s),_=f[l+(p>>0&3)],m=f[l+(p>>2&3)],g=f[l+(p>>4&3)],y=f[l+(p>>6&3)],A=t.getSourceTarget(e,i,o,s),v=A[u+(d>>0&3)],b=A[u+(d>>2&3)],x=A[u+(d>>4&3)],C=A[u+(d>>6&3)];1&h&&(c[a]=_*v+m*b+g*x+y*C),2&h&&(c[a+1]=_*v+m*b+g*x+y*C),4&h&&(c[a+2]=_*v+m*b+g*x+y*C),8&h&&(c[a+3]=_*v+m*b+g*x+y*C)},t.abs=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=Math.abs(c[l+(p>>0&3)])),2&h&&(u[a+1]=Math.abs(c[l+(p>>2&3)])),4&h&&(u[a+2]=Math.abs(c[l+(p>>4&3)])),8&h&&(u[a+3]=Math.abs(c[l+(p>>6&3)]))},t.neg=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=-c[l+(p>>0&3)]),2&h&&(u[a+1]=-c[l+(p>>2&3)]),4&h&&(u[a+2]=-c[l+(p>>4&3)]),8&h&&(u[a+3]=-c[l+(p>>6&3)])},t.sat=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=t.getSourceTarget(e,i,r,s),h=n.mask,p=r.swizzle;1&h&&(u[a]=Math.max(0,Math.min(1,c[l+(p>>0&3)]))),2&h&&(u[a+1]=Math.max(0,Math.min(1,c[l+(p>>2&3)]))),4&h&&(u[a+2]=Math.max(0,Math.min(1,c[l+(p>>4&3)]))),8&h&&(u[a+3]=Math.max(0,Math.min(1,c[l+(p>>6&3)])))},t.m33=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask;1&d&&(c[a]=h[l]*p[u]+h[l+1]*p[u+1]+h[l+2]*p[u+2]),2&d&&(c[a+1]=h[l]*p[u+4]+h[l+1]*p[u+5]+h[l+2]*p[u+6]),4&d&&(c[a+2]=h[l]*p[u+8]+h[l+1]*p[u+9]+h[l+2]*p[u+10])},t.m34=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=t.getSourceTarget(e,i,r,s),p=t.getSourceTarget(e,i,o,s),d=n.mask;1&d&&(c[a]=h[l]*p[u]+h[l+1]*p[u+1]+h[l+2]*p[u+2]+p[u+3]),2&d&&(c[a+1]=h[l]*p[u+4]+h[l+1]*p[u+5]+h[l+2]*p[u+6]+p[u+7]),4&d&&(c[a+2]=h[l]*p[u+8]+h[l+1]*p[u+9]+h[l+2]*p[u+10]+p[u+11])},t.ddx=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=e.derivativeX,h=n.mask,p=r.swizzle;1&h&&(u[a]=c[l+(p>>0&3)]),2&h&&(u[a+1]=c[l+(p>>2&3)]),4&h&&(u[a+2]=c[l+(p>>4&3)]),8&h&&(u[a+3]=c[l+(p>>6&3)])},t.ddy=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=e.derivativeY,h=n.mask,p=r.swizzle;1&h&&(u[a]=c[l+(p>>0&3)]),2&h&&(u[a+1]=c[l+(p>>2&3)]),4&h&&(u[a+2]=c[l+(p>>4&3)]),8&h&&(u[a+3]=c[l+(p>>6&3)])},t.sge=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=n.mask,p=r.swizzle,d=o.swizzle,f=t.getSourceTarget(e,i,r,s),_=f[l+(p>>0&3)],m=f[l+(p>>2&3)],g=f[l+(p>>4&3)],y=f[l+(p>>6&3)],A=t.getSourceTarget(e,i,o,s),v=A[u+(d>>0&3)],b=A[u+(d>>2&3)],x=A[u+(d>>4&3)],C=A[u+(d>>6&3)];1&h&&(c[a]=_>=v?1:0),2&h&&(c[a+1]=m>=b?1:0),4&h&&(c[a+2]=g>=x?1:0),8&h&&(c[a+3]=y>=C?1:0)},t.slt=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*o.regnum,c=t.getDestTarget(e,i,n),h=n.mask,p=r.swizzle,d=o.swizzle,f=t.getSourceTarget(e,i,r,s),_=f[l+(p>>0&3)],m=f[l+(p>>2&3)],g=f[l+(p>>4&3)],y=f[l+(p>>6&3)],A=t.getSourceTarget(e,i,o,s),v=A[u+(d>>0&3)],b=A[u+(d>>2&3)],x=A[u+(d>>4&3)],C=A[u+(d>>6&3)];1&h&&(c[a]=_<v?1:0),2&h&&(c[a+1]=m<b?1:0),4&h&&(c[a+2]=g<x?1:0),8&h&&(c[a+3]=y<C?1:0)},t.seq=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*r.regnum,c=t.getDestTarget(e,i,n),h=n.mask,p=r.swizzle,d=o.swizzle,f=t.getSourceTarget(e,i,r,s),_=f[l+(p>>0&3)],m=f[l+(p>>2&3)],g=f[l+(p>>4&3)],y=f[l+(p>>6&3)],A=t.getSourceTarget(e,i,o,s),v=A[u+(d>>0&3)],b=A[u+(d>>2&3)],x=A[u+(d>>4&3)],C=A[u+(d>>6&3)];1&h&&(c[a]=_==v?1:0),2&h&&(c[a+1]=m==b?1:0),4&h&&(c[a+2]=g==x?1:0),8&h&&(c[a+3]=y==C?1:0)},t.sne=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=4*r.regnum,c=t.getDestTarget(e,i,n),h=n.mask,p=r.swizzle,d=o.swizzle,f=t.getSourceTarget(e,i,r,s),_=f[l+(p>>0&3)],m=f[l+(p>>2&3)],g=f[l+(p>>4&3)],y=f[l+(p>>6&3)],A=t.getSourceTarget(e,i,o,s),v=A[u+(d>>0&3)],b=A[u+(d>>2&3)],x=A[u+(d>>4&3)],C=A[u+(d>>6&3)];1&h&&(c[a]=_!=v?1:0),2&h&&(c[a+1]=m!=b?1:0),4&h&&(c[a+2]=g!=x?1:0),8&h&&(c[a+3]=y!=C?1:0)},t.sgn=function(e,i,n,r,o,s){var a=4*n.regnum,l=4*r.regnum,u=t.getDestTarget(e,i,n),c=n.mask,h=r.swizzle,p=t.getSourceTarget(e,i,r,s),d=p[l+(h>>0&3)],f=p[l+(h>>2&3)],_=p[l+(h>>4&3)],m=p[l+(h>>6&3)];1&c&&(u[a]=d<0?-1:d>0?1:0),2&c&&(u[a+1]=f<0?-1:f>0?1:0),4&c&&(u[a+2]=_<0?-1:_>0?1:0),8&c&&(u[a+3]=m<0?-1:m>0?1:0)},t.kil=function(e,i,n,r,o,s){var a=4*r.regnum,l=r.swizzle;t.getSourceTarget(e,i,r,s)[a+(l>>0&3)]<0&&(e.discard=!0)},t._defaultSamplerState=new si,t._tokenizer=new Pe,t._opCodeFunc=[t.mov,t.add,t.sub,t.mul,t.div,t.rcp,t.min,t.max,t.frc,t.sqt,t.rsq,t.pow,t.log,t.exp,t.nrm,t.sin,t.cos,t.crs,t.dp3,t.dp4,t.abs,t.neg,t.sat,t.m33,t.m44,t.m34,null,null,null,null,null,null,null,null,null,null,null,null,null,t.kil,t.tex,t.sge,t.slt,t.sgn,t.seq,t.sne],t._colorValue0=new Float32Array(4),t._colorValue1=new Float32Array(4),t._colorInterpolated0=new Float32Array(4),t._colorInterpolated1=new Float32Array(4),t}(),li=function(){function t(){}return t.destinationAlpha=function(t,e,i,n){t[0]=e[0]*i[3]/255,t[1]=e[1]*i[3]/255,t[2]=e[2]*i[3]/255,t[3]=e[3]*i[3]/255},t.destinationColor=function(t,e,i,n){t[0]=e[0]*i[0]/255,t[1]=e[1]*i[1]/255,t[2]=e[2]*i[2]/255,t[3]=e[3]*i[3]/255},t.one=function(t,e,i,n){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]},t.oneMinusDestinationAlpha=function(t,e,i,n){t[0]=e[0]*(1-i[3]/255),t[1]=e[1]*(1-i[3]/255),t[2]=e[2]*(1-i[3]/255),t[3]=e[3]*(1-i[3]/255)},t.oneMinusDestinationColor=function(t,e,i,n){t[0]=e[0]*(1-i[0]/255),t[1]=e[1]*(1-i[1]/255),t[2]=e[2]*(1-i[2]/255),t[3]=e[3]*(1-i[3]/255)},t.oneMinusSourceAlpha=function(t,e,i,n){t[0]=e[0]*(1-n[3]/255),t[1]=e[1]*(1-n[3]/255),t[2]=e[2]*(1-n[3]/255),t[3]=e[3]*(1-n[3]/255)},t.oneMinusSourceColor=function(t,e,i,n){t[0]=e[0]*(1-n[0]/255),t[1]=e[1]*(1-n[1]/255),t[2]=e[2]*(1-n[2]/255),t[3]=e[3]*(1-n[3]/255)},t.sourceAlpha=function(t,e,i,n){t[0]=e[0]*n[3]/255,t[1]=e[1]*n[3]/255,t[2]=e[2]*n[3]/255,t[3]=e[3]*n[3]/255},t.sourceColor=function(t,e,i,n){t[0]=e[0]*n[0]/255,t[1]=e[1]*n[1]/255,t[2]=e[2]*n[2]/255,t[3]=e[3]*n[3]/255},t.zero=function(t,e,i,n){},t}(),ui=function(){function t(){}return t.always=function(t,e){return!0},t.equal=function(t,e){return t==e},t.greater=function(t,e){return t>e},t.greaterEqual=function(t,e){return t>=e},t.less=function(t,e){return t<e},t.lessEqual=function(t,e){return t<=e},t.never=function(t,e){return!1},t.notEqual=function(t,e){return t!=e},t}(),ci=function(){function t(t){this._backBufferRect=new Y,this._cullingMode=zt.BACK,this._blendSource=Lt.ONE,this._blendDestination=Lt.ZERO,this._colorMaskR=!0,this._colorMaskG=!0,this._colorMaskB=!0,this._colorMaskA=!0,this._writeDepth=!0,this._depthCompareMode=Nt.LESS,this._depthCompareModeSoftware=function(t,e){},this._blendModeSoftware=function(t,e,i){},this._screenMatrix=new R,this._frontBufferMatrix=new T,this._bboxMin=new D,this._bboxMax=new D,this._clamp=new D,this._samplerStates=[],this._textures=[],this.textureBuffersColor=[],this.textureBuffersZ=[],this.textureBuffersZClear=[],this._vertexBuffers=[],this._vertexBufferOffsets=[],this._vertexBufferFormats=[],this._rgba=new Uint8ClampedArray(4),this._source=new Uint8ClampedArray(4),this._dest=new Uint8ClampedArray(4),this._destComp=new Uint8ClampedArray(4),this._sourceComp=new Uint8ClampedArray(4),this._antialias=0,this.hasVao=!1,this._p0=new P,this._p1=new P,this._p2=new P,this._project=new P,this._barycentric=new P,this._barycentricRight=new P,this._barycentricBottom=new P,this._canvas=t,this._backBufferColor=new hn(100,100,!1,0,!1),this._frontBuffer=new hn(100,100,!1,0,!1),this._activeBufferColor=this._backBufferColor;var e=new ArrayBuffer(8e4);this._backBufferZ=new Float32Array(e,0,1e4),this._backBufferZClear=new Float32Array(e,4e4,1e4);for(var i=0;i<1e4;i++)this._backBufferZClear[i]=1e7;this._activeBufferZ=this._backBufferZ,document&&document.body&&(this._frontCanvas=document.createElement("canvas"),this._frontBufferContext=this._frontCanvas.getContext("2d"),this._frontBufferImageData=this._frontBufferContext.getImageData(0,0,100,100),this._frontCanvas.style.position="absolute",document.body.appendChild(this._frontCanvas)),this._depthCompareModeSoftware[Nt.ALWAYS]=ui.always,this._depthCompareModeSoftware[Nt.EQUAL]=ui.equal,this._depthCompareModeSoftware[Nt.GREATER]=ui.greaterEqual,this._depthCompareModeSoftware[Nt.GREATER_EQUAL]=ui.greater,this._depthCompareModeSoftware[Nt.LESS]=ui.less,this._depthCompareModeSoftware[Nt.LESS_EQUAL]=ui.lessEqual,this._depthCompareModeSoftware[Nt.NEVER]=ui.never,this._depthCompareModeSoftware[Nt.NOT_EQUAL]=ui.notEqual,this._blendModeSoftware[Lt.DESTINATION_ALPHA]=li.destinationAlpha,this._blendModeSoftware[Lt.DESTINATION_COLOR]=li.destinationColor,this._blendModeSoftware[Lt.ONE]=li.one,this._blendModeSoftware[Lt.ONE_MINUS_DESTINATION_ALPHA]=li.oneMinusDestinationAlpha,this._blendModeSoftware[Lt.ONE_MINUS_DESTINATION_COLOR]=li.oneMinusDestinationColor,this._blendModeSoftware[Lt.ONE_MINUS_SOURCE_ALPHA]=li.oneMinusSourceAlpha,this._blendModeSoftware[Lt.ONE_MINUS_SOURCE_COLOR]=li.oneMinusSourceColor,this._blendModeSoftware[Lt.SOURCE_ALPHA]=li.sourceAlpha,this._blendModeSoftware[Lt.SOURCE_COLOR]=li.sourceColor,this._blendModeSoftware[Lt.ZERO]=li.zero}return t.prototype.createVao=function(){return null},Object.defineProperty(t.prototype,"glVersion",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelRatio",{get:function(){return 1},enumerable:!0,configurable:!0}),t.prototype.configureBackBuffer=function(t,e,i,n){this._antialias=i,this._antialias%2!=0&&(this._antialias=Math.floor(this._antialias-.5)),0==this._antialias&&(this._antialias=1),this._frontBuffer._setSize(t,e),this._frontCanvas.width=t,this._frontCanvas.height=e,this._frontBufferImageData=this._frontBufferContext.getImageData(0,0,t,e);var r=t*this._antialias,o=e*this._antialias,s=r*o,a=new ArrayBuffer(8*s);this._backBufferZ=new Float32Array(a,0,s),this._backBufferZClear=new Float32Array(a,4*s,s);for(var l=0;l<s;l++)this._backBufferZClear[l]=1e7;this._activeBufferColor==this._backBufferColor&&(this._activeBufferZ=this._backBufferZ),this._backBufferRect.width=r,this._backBufferRect.height=o,this._backBufferColor._setSize(r,o),this.activateScreenMatrix(this._backBufferRect.width,this._backBufferRect.height,!0),this._frontBufferMatrix=new T,this._frontBufferMatrix.scale(1/this._antialias,1/this._antialias)},t.prototype.activateScreenMatrix=function(t,e,i){var n=this._screenMatrix._rawData;n[0]=t/2,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=i?-e/2:e/2,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t/2,n[13]=e/2,n[14]=0,n[15]=0,this._yflip=i},t.prototype.setRenderToTexture=function(t,e,i,n,r){var o=this.textureBuffersColor[n];null==o?(o=this.textureBuffersColor[n]=new hn(t.width,t.height,!1,16777215,!0),t.uploadFromArray(new Uint8Array(o.data.buffer))):o.fillRect(o.rect,16777215),this._activeBufferColor=o,this._activeBufferColor.lock();var s=this.textureBuffersZ[n],a=this.textureBuffersZClear[n];if(null==s){var l=t.width*t.height,u=new ArrayBuffer(8*l);s=this.textureBuffersZ[n]=new Float32Array(u,0,l),a=this.textureBuffersZClear[n]=new Float32Array(u,4*l,l);for(var c=0;c<l;c++)a[c]=1e7}s.set(a),this._activeBufferZ=s,this.activateScreenMatrix(t.width,t.height,!1),this._activeTexture=t},t.prototype.setRenderToBackBuffer=function(){this._activeBufferColor=this._backBufferColor,this._activeBufferZ=this._backBufferZ,this.activateScreenMatrix(this._backBufferColor.width,this._backBufferColor.height,!0)},t.prototype.copyToTexture=function(t,e,i){},t.prototype.drawIndices=function(t,e,i,n){if(this._program){var r=new Float32Array(4),o=new Float32Array(4),s=new Float32Array(4),a=new Float32Array(4),l=new Float32Array(4),u=new Float32Array(4*this._program.numVarying),c=new Float32Array(4*this._program.numVarying),h=new Float32Array(4*this._program.numVarying),p=new Float32Array(4*this._program.numVarying),d=new Float32Array(4*this._program.numVarying),f=new Array(5),_=new Array(4);f[0]=o,f[1]=s,f[2]=r,f[3]=a,f[4]=l;var m=new Array(5),g=new Array(4);if(m[0]=c,m[1]=h,m[2]=u,m[3]=p,m[4]=d,this._yflip&&this._cullingMode==zt.BACK||!this._yflip&&this._cullingMode==zt.FRONT)for(var y=i;y<n;y+=3)this._program.vertex(this,e.data[e.startOffset+y],r,u),this._program.vertex(this,e.data[e.startOffset+y+1],o,c),this._program.vertex(this,e.data[e.startOffset+y+2],s,h),this._triangle(f,_,m,g);else if(this._yflip&&this._cullingMode==zt.FRONT||!this._yflip&&this._cullingMode==zt.BACK)for(y=i;y<n;y+=3)this._program.vertex(this,e.data[e.startOffset+y+2],r,u),this._program.vertex(this,e.data[e.startOffset+y+1],o,c),this._program.vertex(this,e.data[e.startOffset+y],s,h),this._triangle(f,_,m,g);else if(this._cullingMode==zt.FRONT_AND_BACK||this._cullingMode==zt.NONE)for(y=i;y<n;y+=3)this._program.vertex(this,e.data[e.startOffset+y+2],r,u),this._program.vertex(this,e.data[e.startOffset+y+1],o,c),this._program.vertex(this,e.data[e.startOffset+y],s,h),this._triangle(f,_,m,g),this._program.vertex(this,e.data[e.startOffset+y],r,u),this._program.vertex(this,e.data[e.startOffset+y+1],o,c),this._program.vertex(this,e.data[e.startOffset+y+2],s,h),this._triangle(f,_,m,g);this._activeBufferColor!=this._backBufferColor&&(this._activeBufferColor.unlock(),this._activeTexture.uploadFromArray(new Uint8Array(this._activeBufferColor.data.buffer)))}},t.prototype._triangle=function(t,e,i,n){var r=0,o=0,s=0,a=t[2],l=i[2],u=a[2]>0;u&&(e[0]=a,n[0]=l,s++,r++);for(var c=0;c<3;c++){var h=t[c],p=i[c],d=h[2]>0;if(d!=u){var f=Math.abs(h[2]),_=Math.abs(a[2]),m=_/(_+f);this._interpolateVertexPair(m,h,a,t[3+o]),e[s]=t[3+o],this._interpolateVertexPair(m,p,l,i[3+o]),n[s]=i[3+o],s++,o++}d&&2!=c&&(e[s]=h,n[s]=p,s++,r++),a=h,l=p,u=d}3==r?this._projectTriangle(t[0],t[1],t[2],i[0],i[1],i[2]):2==r?(this._projectTriangle(e[0],e[1],e[2],n[0],n[1],n[2]),this._projectTriangle(e[0],e[2],e[3],n[0],n[2],n[3])):1==r&&this._projectTriangle(e[0],e[1],e[2],n[0],n[1],n[2])},t.prototype._projectTriangle=function(t,e,i,n,r,o){if(this._p0.x=t[0],this._p0.y=t[1],this._p0.z=t[2],this._p0.w=t[3],this._p1.x=e[0],this._p1.y=e[1],this._p1.z=e[2],this._p1.w=e[3],this._p2.x=i[0],this._p2.y=i[1],this._p2.z=i[2],this._p2.w=i[3],0!=this._p0.w&&0!=this._p1.w&&0!=this._p2.w&&!(isNaN(this._p0.x)||isNaN(this._p0.y)||isNaN(this._p0.z)||isNaN(this._p0.w)||isNaN(this._p1.x)||isNaN(this._p1.y)||isNaN(this._p1.z)||isNaN(this._p1.w)||isNaN(this._p2.x)||isNaN(this._p2.y)||isNaN(this._p2.z)||isNaN(this._p2.w))){this._p0.z=2*this._p0.z-this._p0.w,this._p1.z=2*this._p1.z-this._p1.w,this._p2.z=2*this._p2.z-this._p2.w,this._p0.project(),this._p1.project(),this._p2.project(),this._project.x=this._p0.w,this._project.y=this._p1.w,this._project.z=this._p2.w,this._p0.w=1,this._p1.w=1,this._p2.w=1,this._p0=this._screenMatrix.transformVector(this._p0,this._p0),this._p1=this._screenMatrix.transformVector(this._p1,this._p1),this._p2=this._screenMatrix.transformVector(this._p2,this._p2),this._bboxMin.x=1e6,this._bboxMin.y=1e6,this._bboxMax.x=-1e6,this._bboxMax.y=-1e6,this._clamp.x=this._activeBufferColor.width-1,this._clamp.y=this._activeBufferColor.height-1,this._bboxMin.x=Math.max(0,Math.min(this._bboxMin.x,this._p0.x)),this._bboxMin.y=Math.max(0,Math.min(this._bboxMin.y,this._p0.y)),this._bboxMin.x=Math.max(0,Math.min(this._bboxMin.x,this._p1.x)),this._bboxMin.y=Math.max(0,Math.min(this._bboxMin.y,this._p1.y)),this._bboxMin.x=Math.max(0,Math.min(this._bboxMin.x,this._p2.x)),this._bboxMin.y=Math.max(0,Math.min(this._bboxMin.y,this._p2.y)),this._bboxMax.x=Math.min(this._clamp.x,Math.max(this._bboxMax.x,this._p0.x)),this._bboxMax.y=Math.min(this._clamp.y,Math.max(this._bboxMax.y,this._p0.y)),this._bboxMax.x=Math.min(this._clamp.x,Math.max(this._bboxMax.x,this._p1.x)),this._bboxMax.y=Math.min(this._clamp.y,Math.max(this._bboxMax.y,this._p1.y)),this._bboxMax.x=Math.min(this._clamp.x,Math.max(this._bboxMax.x,this._p2.x)),this._bboxMax.y=Math.min(this._clamp.y,Math.max(this._bboxMax.y,this._p2.y)),this._bboxMin.x=Math.floor(this._bboxMin.x),this._bboxMin.y=Math.floor(this._bboxMin.y),this._bboxMax.x=Math.floor(this._bboxMax.x),this._bboxMax.y=Math.floor(this._bboxMax.y);var s=this._bboxMax.x-this._bboxMin.x,a=this._bboxMax.y-this._bboxMin.y;if(!(s<=0||a<=0)){var l=(this._p1.x-this._p0.x)*(this._p2.y-this._p0.y)-(this._p1.y-this._p0.y)*(this._p2.x-this._p0.x);if(!(l<0))for(var u=-(this._p2.y-this._p1.y)/l,c=-(this._p0.y-this._p2.y)/l,h=-(this._p1.y-this._p0.y)/l,p=(this._p2.x-this._p1.x)/l,d=(this._p0.x-this._p2.x)/l,f=(this._p1.x-this._p0.x)/l,_=((this._p2.x-this._p1.x)*(this._bboxMin.y-this._p1.y)-(this._p2.y-this._p1.y)*(this._bboxMin.x-this._p1.x))/l,m=((this._p0.x-this._p2.x)*(this._bboxMin.y-this._p2.y)-(this._p0.y-this._p2.y)*(this._bboxMin.x-this._p2.x))/l,g=((this._p1.x-this._p0.x)*(this._bboxMin.y-this._p0.y)-(this._p1.y-this._p0.y)*(this._bboxMin.x-this._p0.x))/l,y=0,A=0,v=this._bboxMin.x;v<=this._bboxMax.x;v++){for(var b=this._bboxMin.y;b<=this._bboxMax.y;b++)if(this._barycentric.x=_+u*y+p*A,this._barycentric.y=m+c*y+d*A,this._barycentric.z=g+h*y+f*A,A+=1,!(this._barycentric.x<0||this._barycentric.y<0||this._barycentric.z<0)){v!=this._bboxMax.x&&(this._barycentricRight.x=this._barycentric.x+u,this._barycentricRight.y=this._barycentric.y+c,this._barycentricRight.z=this._barycentric.z+h,this._barycentricRight.x/=this._project.x,this._barycentricRight.y/=this._project.y,this._barycentricRight.z/=this._project.z,this._barycentricRight.scaleBy(1/(this._barycentricRight.x+this._barycentricRight.y+this._barycentricRight.z))),b!=this._bboxMax.y&&(this._barycentricBottom.x=this._barycentric.x+p,this._barycentricBottom.y=this._barycentric.y+d,this._barycentricBottom.z=this._barycentric.z+f,this._barycentricBottom.x/=this._project.x,this._barycentricBottom.y/=this._project.y,this._barycentricBottom.z/=this._project.z,this._barycentricBottom.scaleBy(1/(this._barycentricBottom.x+this._barycentricBottom.y+this._barycentricBottom.z)));var x=v%this._activeBufferColor.width+b*this._activeBufferColor.width,C=(this._barycentric.x*this._p0.z+this._barycentric.y*this._p1.z+this._barycentric.z*this._p2.z)/(this._barycentric.x+this._barycentric.y+this._barycentric.z);if(this._barycentric.x/=this._project.x,this._barycentric.y/=this._project.y,this._barycentric.z/=this._project.z,this._barycentric.scaleBy(1/(this._barycentric.x+this._barycentric.y+this._barycentric.z)),this._depthCompareModeSoftware[this._depthCompareMode](C,this._activeBufferZ[x])){var w=this._program.fragment(this,this._barycentric,this._barycentricRight,this._barycentricBottom,n,r,o,C);w.discard||(this._writeDepth&&(this._activeBufferZ[x]=C),this._source[0]=255*w.outputColor[0],this._source[1]=255*w.outputColor[1],this._source[2]=255*w.outputColor[2],this._source[3]=255*w.outputColor[3],this._activeBufferColor.getPixelData(v,b,this._dest),this._putPixel(v,b))}}A=0,y+=1}}}},t.prototype._putPixel=function(t,e){this._blendModeSoftware[this._blendDestination](this._destComp,this._dest,this._dest,this._source),this._blendModeSoftware[this._blendSource](this._sourceComp,this._source,this._dest,this._source),this._rgba[0]=this._sourceComp[0]+this._destComp[0],this._rgba[1]=this._sourceComp[1]+this._destComp[1],this._rgba[2]=this._sourceComp[2]+this._destComp[2],this._rgba[3]=this._sourceComp[3]+this._destComp[3],this._activeBufferColor.setPixelData(t,e,this._rgba)},t.prototype.createCubeTexture=function(t,e,i,n){return new ri(t)},t.prototype.createIndexBuffer=function(t){return new ei(t)},t.prototype.createProgram=function(){return new ai},t.prototype.createTexture=function(t,e,i,n,r){return new ni(t,e)},t.prototype.createVertexBuffer=function(t,e){return new ii(t,e)},t.prototype.dispose=function(){},t.prototype.setBlendFactors=function(t,e){this._blendSource=t,this._blendDestination=e},t.prototype.setColorMask=function(t,e,i,n){this._colorMaskR=t,this._colorMaskG=e,this._colorMaskB=i,this._colorMaskA=n},t.prototype.setStencilActions=function(t,e,i,n,r,o){void 0===t&&(t=zt.FRONT_AND_BACK),void 0===e&&(e=Nt.ALWAYS),void 0===i&&(i=jt.KEEP),void 0===n&&(n=jt.KEEP),void 0===r&&(r=jt.KEEP),void 0===o&&(o=_t.LEFT_HANDED)},t.prototype.setStencilReferenceValue=function(t,e,i){},t.prototype.setCulling=function(t,e){this._cullingMode=t},t.prototype.setDepthTest=function(t,e){this._writeDepth=t,this._depthCompareMode=e},t.prototype.setProgram=function(t){this._program=t},t.prototype.setProgramConstantsFromArray=function(t,e){var i;t==Ut.VERTEX?i=this._vertexConstants=new Float32Array(e.length):t==Ut.FRAGMENT&&(i=this._fragmentConstants=new Float32Array(e.length)),i.set(e)},t.prototype.setTextureAt=function(t,e){this._textures[t]=e},t.prototype.setVertexBufferAt=function(t,e,i,n){this._vertexBuffers[t]=e,this._vertexBufferOffsets[t]=i,this._vertexBufferFormats[t]=n},t.prototype.present=function(){this._backBufferColor.unlock(),this._frontBuffer.fillRect(this._frontBuffer.rect,0),this._frontBuffer.drawBitmap(this._backBufferColor.data,0,0,this._backBufferColor.width,this._backBufferColor.height,this._frontBufferMatrix),document&&document.body&&(this._frontBufferImageData.data.set(this._frontBuffer.data),this._frontBufferContext.putImageData(this._frontBufferImageData,0,0))},t.prototype.drawToBitmapImage2D=function(t){t.setPixels(this._activeBufferColor.rect,this._activeBufferColor.data)},t.prototype._interpolateVertexPair=function(t,e,i,n){for(var r=0;r<e.length;r++){var o=e[r]-i[r];n[r]=i[r]+o*t}},t.prototype.clamp=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=1),Math.max(e,Math.min(t,i))},t.prototype.interpolate=function(t,e,i){return t+(e-t)*this.clamp(i)},t.prototype.drawVertices=function(t,e,i){},t.prototype.setScissorRectangle=function(t){},t.prototype.setSamplerStateAt=function(t,e,i,n){var r=this._samplerStates[t];r||(r=this._samplerStates[t]=new si),r.wrap=e,r.filter=i,r.mipfilter=n},t.prototype.enableStencil=function(){},t.prototype.disableStencil=function(){},Object.defineProperty(t.prototype,"frontBuffer",{get:function(){return this._frontBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"container",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),t.prototype.clear=function(t,e,i,n,r,o,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=Rt.ALL),this._backBufferColor.lock(),s&Rt.COLOR&&this._backBufferColor.fillRect(this._backBufferRect,w.ARGBtoFloat32(255*n,255*t,255*e,255*i)),s&Rt.DEPTH&&this._backBufferZ.set(this._backBufferZClear)},t.prototype.finish=function(){},t.MAX_SAMPLERS=8,t}(),hi={PREF_VERSION:2,PREF_MULTISAMPLE:!0,PREF_MIPMAP:1,PREF_REPEAT_WRAP:1},pi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Me),di=function(){function t(e){this.textureType="",this._state=new pi,this._context=e,this._gl=e._gl,this._id=t.TEXTURE_ID++}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._gl.deleteTexture(this._glTexture)},Object.defineProperty(t.prototype,"glTexture",{get:function(){return this._glTexture},enumerable:!0,configurable:!0}),t.prototype.generateMipmaps=function(){throw new s},t.TEXTURE_ID=0,t}(),fi=function(t){function e(e,i){var n=t.call(this,e)||this;n._textureSelectorDictionary=new Array(6),n.textureType="textureCube";var r=n._gl;return n._size=i,n._glTexture=n._gl.createTexture(),n._textureSelectorDictionary[0]=r.TEXTURE_CUBE_MAP_POSITIVE_X,n._textureSelectorDictionary[1]=r.TEXTURE_CUBE_MAP_NEGATIVE_X,n._textureSelectorDictionary[2]=r.TEXTURE_CUBE_MAP_POSITIVE_Y,n._textureSelectorDictionary[3]=r.TEXTURE_CUBE_MAP_NEGATIVE_Y,n._textureSelectorDictionary[4]=r.TEXTURE_CUBE_MAP_POSITIVE_Z,n._textureSelectorDictionary[5]=r.TEXTURE_CUBE_MAP_NEGATIVE_Z,n}return i(e,t),e.prototype.uploadFromArray=function(t,e,i,n){if(void 0===i&&(i=0),void 0===n&&(n=!1),t.length!=this._size*this._size*4)throw new Error("Array is not the correct length for texture dimensions");t instanceof Array&&(t=new Uint8Array(t)),this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,this._glTexture),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this._gl.texImage2D(this._textureSelectorDictionary[e],i,this._gl.RGBA,this._size,this._size,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t),this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null)},e.prototype.uploadCompressedTextureFromArray=function(t,e,i){},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),e.prototype.generateMipmaps=function(){this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,this._glTexture),this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP)},e}(di),_i=!0,mi=10,gi=50,yi=!0,Ai=300,vi=5e3,bi=function(){function t(t,e){void 0===e&&(e=Ai),this._tCtrl=t,this.maxStoreSize=e,this._store=[],this._manager=ke.createManager({name:t.name,keepAliveTime:vi})}return t.prototype.create=function(t,e,i,n){var r=this._store.pop();return r?this._manager.removeTask(r):r=new this._tCtrl(t,e,i,n),r.lastUsedTime=this._manager.correctedTime,r.apply&&r.apply(t,e,i,n),r},t.prototype.store=function(t){return this._store.length!==this.maxStoreSize&&(t.lastUsedTime=this._manager.correctedTime,this._manager.addTask(t),!!this._store.push(t))},t.prototype.remove=function(t){var e=this._store.indexOf(t);return e>-1&&(this._store.splice(e,1),!0)},t.prototype.clear=function(){this._manager&&this._manager.clear()},t}(),xi=function(){function t(t,e){this.canUnload=!0,this._gl=t,this._buffer=this._gl.createBuffer(),this._numIndices=e}return Object.defineProperty(t,"pool",{get:function(){return this._pool||(this._pool=new bi(t))},enumerable:!0,configurable:!0}),t.create=function(t,e){return this.pool.create(t,e)},t.prototype.uploadFromArray=function(t,e,i){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,this._buffer),e?this._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER,2*e,t):this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,t,this._gl.STATIC_DRAW)},t.prototype.uploadFromByteArray=function(t,e,i){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,this._buffer),e?this._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER,2*e,t):this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,t,this._gl.STATIC_DRAW)},t.prototype.dispose=function(){t.pool.store(this)||this.unload()},t.prototype.apply=function(t,e){this._numIndices=e},t.prototype.unload=function(){t.pool.remove(this),this._gl.deleteBuffer(this._buffer)},Object.defineProperty(t.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:!0,configurable:!0}),t}(),Ci=/(#define|#version|precision).*\n/gi,wi=function(){function t(e){this._id=t.ProgramID++,this._uniforms=[{},{},{}],this._nameToIndex={},this._attribs=[],this._uniformCache=new Array(16),this._gl=e,this._program=this._gl.createProgram()}return t.prototype.upload=function(e,i){var n=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT).precision,r=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT).precision,o=t._aglslParser.parse(t._tokenizer.decribeAGALByteArray(e),n?"highp":"mediump"),s=t._aglslParser.parse(t._tokenizer.decribeAGALByteArray(i),r?"highp":"mediump");this.name||(this.name="PROG_AGAL_"+this._id),this.uploadRaw(o,s)},t.prototype.uploadRaw=function(t,e){if(this.name||(this.name="PROG_GLSL_"+this._id),t=this.insertName(t),e=this.insertName(e),this._vertexShader=this._gl.createShader(this._gl.VERTEX_SHADER),this._fragmentShader=this._gl.createShader(this._gl.FRAGMENT_SHADER),this._gl.shaderSource(this._vertexShader,t),this._gl.compileShader(this._vertexShader),!this._gl.getShaderParameter(this._vertexShader,this._gl.COMPILE_STATUS))throw new Error(this._gl.getShaderInfoLog(this._vertexShader));if(this._gl.shaderSource(this._fragmentShader,e),this._gl.compileShader(this._fragmentShader),!this._gl.getShaderParameter(this._fragmentShader,this._gl.COMPILE_STATUS))throw new Error(this._gl.getShaderInfoLog(this._fragmentShader));if(this._gl.attachShader(this._program,this._vertexShader),this._gl.attachShader(this._program,this._fragmentShader),this._gl.linkProgram(this._program),!this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS))throw new Error(this._gl.getProgramInfoLog(this._program));this.reset()},t.prototype.insertName=function(t){var e=t.match(Ci)||[],i=e[e.length-1],n=i?t.lastIndexOf(i)+i.length:0;return t.substr(0,n)+"\n#define SHADER_NAME "+this.name+"\n\n"+t.substr(n)},t.prototype.reset=function(){this._uniforms[0]={},this._uniforms[1]={},this._uniforms[2]={},this._attribs.length=0,this._uniformCache.fill("")},t.prototype.getUniformLocation=function(e,i){void 0===i&&(i=-1);var n="number"==typeof i,r=n?i:this._nameToIndex[i];if(void 0!==r&&null!=this._uniforms[e][r+1])return this._uniforms[e][r+1];var o=n?t._getAGALUniformName(e,i):i;return this._nameToIndex[o]=r+1,this._uniforms[e][r+1]=this._gl.getUniformLocation(this._program,o)},t._getAGALUniformName=function(t,e){return void 0===e&&(e=-1),-1===e?this._uniformLocationNameDictionary[t]:this._uniformLocationNameDictionary[t]+e},t.prototype._needCache=function(t,e){var i=this._uniformCache[t],n=e instanceof Float32Array?new Uint32Array(e.buffer).join(""):""+e;return i&&n===i?void 0:n},t.prototype.uniform1i=function(t,e,i){var n=this.getUniformLocation(t,e),r=this._needCache(4*t+e+1,i);void 0!==r&&(this._uniformCache[4*t+e+1]=r,this._gl.uniform1i(n,i))},t.prototype.uniform4fv=function(t,e){var i=this.getUniformLocation(t),n=this._needCache(4*t,e);void 0!==n&&(this._uniformCache[4*t]=n,this._gl.uniform4fv(i,e))},t.prototype.getAttribLocation=function(t){return null!=this._attribs[t]?this._attribs[t]:this._attribs[t]=this._gl.getAttribLocation(this._program,"va"+t)},t.prototype.dispose=function(){this._gl.deleteProgram(this._program)},t.prototype.focusProgram=function(){this._uniformCache.fill(""),this._gl.useProgram(this._program)},Object.defineProperty(t.prototype,"glProgram",{get:function(){return this._program},enumerable:!0,configurable:!0}),t.ProgramID=0,t._tokenizer=new Pe,t._aglslParser=new Be,t._uniformLocationNameDictionary=["fc","fs","vc"],t}(),Ii=function(t){function e(e,i,n){var r=t.call(this,e)||this;if(r.textureType="texture2d",r._frameBuffer=[],r._frameBufferDraw=[],r._renderBuffer=[],r._renderBufferDepth=[],r._mipmapSelector=0,r._multisampled=!1,r._isFilled=!1,r._isPMA=!1,r._isRT=!1,r._skipPresent=!1,r.lastUsedTime=0,!i||!n)throw new Error("Incorrected size of texture { width: "+i+", height: "+n+"}");return r._width=i,r._height=n,r._glTexture=r._gl.createTexture(),r}return i(e,t),e.store=function(t){var i=t._width<<16|t._height,n=e._pool[i]||(e._pool[i]=[]);return n.indexOf(t)>-1?(t.lastUsedTime=this.unloadManager.correctedTime,!0):!(n.length>=this.SIZE_POOL_LIMIT)&&(n.push(t),t.lastUsedTime=this.unloadManager.correctedTime,this.unloadManager.addTask(t),!0)},e.remove=function(t){var i=t._width<<16|t._height,n=e._pool[i];if(!n||!n.length)return!1;var r=n.indexOf(t);return r>-1&&!!n.splice(r,1)},e.create=function(t,i,n){var r,o=i<<16|0|n,s=null===(r=e._pool[o])||void 0===r?void 0:r.pop();return s?(this.unloadManager.removeTask(s),s):new e(t,i,n)},Object.defineProperty(e.prototype,"canUnload",{get:function(){return this._glTexture&&!this._isRT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPOT",{get:function(){return!(this._width&this._width-1||this._height&this._height-1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multisampled",{get:function(){return this._multisampled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this._frameBuffer[this._mipmapSelector]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureFramebuffer",{get:function(){return this.multisampled?this._frameBufferDraw[this._mipmapSelector]:this._frameBuffer[this._mipmapSelector]},enumerable:!0,configurable:!0}),e.prototype.setFrameBuffer=function(t,e,i,n){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this._context._texContext.setFrameBuffer(this,t,e,i,n)},e.prototype.presentFrameBuffer=function(){console.warn("[Texture] Framebuffer present internal method of ContextWebGL")},e.prototype.dispose=function(){!this.multisampled&&yi&&e.store(this)||this.unload()},e.prototype.unload=function(){e.remove(this),this._context._texContext.disposeTexture(this),this._glTexture=null,this._renderBuffer=null,this._renderBufferDepth=null,this._frameBuffer=null,this._frameBufferDraw=null,this._mipmapSelector=0,this._width=this._height=0,this._multisampled=!1,this._state.dispose()},e.prototype.uploadFromArray=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),this._context._texContext.uploadFromArray(this,t,e,i),this._isFilled=!0,this._isPMA=i},e.prototype.uploadFromURL=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),this._context._texContext.uploadFromArray(this,null,e,i),this._isFilled=!0,this._isPMA=i},e.prototype.uploadCompressedTextureFromArray=function(t,e,i){},e.prototype.generateMipmaps=function(){this._gl.bindTexture(this._gl.TEXTURE_2D,this._glTexture),this._gl.generateMipmap(this._gl.TEXTURE_2D)},e.SIZE_POOL_LIMIT=10,e.unloadManager=ke.createManager({keepAliveTime:2e4,name:"TextureWebGL",priority:1e3}),e._pool={},e}(di),Ei=function(){function t(t,e,i){this.canUnload=!0,this._gl=t,this._buffer=this._gl.createBuffer(),this._numVertices=e,this._dataPerVertex=i}return Object.defineProperty(t,"pool",{get:function(){return this._pool||(this._pool=new bi(t))},enumerable:!0,configurable:!0}),t.create=function(t,e,i){return this.pool.create(t,e,i)},t.prototype.uploadFromArray=function(t,e,i){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._buffer),e?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,e*this._dataPerVertex,t):this._gl.bufferData(this._gl.ARRAY_BUFFER,t,this._gl.STATIC_DRAW)},t.prototype.uploadFromByteArray=function(t,e,i){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._buffer),e?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,e*this._dataPerVertex,t):this._gl.bufferData(this._gl.ARRAY_BUFFER,t,this._gl.STATIC_DRAW)},Object.defineProperty(t.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataPerVertex",{get:function(){return this._dataPerVertex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){t.pool.store(this)||this.unload()},t.prototype.apply=function(t,e,i){this._numVertices=e,this._dataPerVertex=i},t.prototype.unload=function(){t.pool.remove(this),this._gl.deleteBuffer(this._buffer)},t}(),Si={},Di=function(){function t(t){var e,i,n,r;this._context=t,this._samplerStates=[],this._textureTypeDictionary={},this._wrapDictionary={},this._filterDictionary={},this._mipmapFilterMap={},this._activeTexture=-1,this._renderTargetConfig=void 0;var o=t._gl;this._textureTypeDictionary={texture2d:o.TEXTURE_2D,textureCube:o.TEXTURE_CUBE_MAP},this._wrapDictionary=((e={})[Xt.REPEAT]=o.REPEAT,e[Xt.CLAMP]=o.CLAMP_TO_EDGE,e),this._filterDictionary=((i={})[Gt.LINEAR]=o.LINEAR,i[Gt.NEAREST]=o.NEAREST,i),this._mipmapFilterMap[Gt.LINEAR]=((n={})[kt.MIPNEAREST]=o.LINEAR_MIPMAP_NEAREST,n[kt.MIPLINEAR]=o.LINEAR_MIPMAP_LINEAR,n[kt.MIPNONE]=o.LINEAR,n),this._mipmapFilterMap[Gt.NEAREST]=((r={})[kt.MIPNEAREST]=o.NEAREST_MIPMAP_NEAREST,r[kt.MIPLINEAR]=o.NEAREST_MIPMAP_LINEAR,r[kt.MIPNONE]=o.NEAREST,r);for(var s=0;s<Ri.MAX_SAMPLERS;++s)this._samplerStates[s]=new pi(s,null,2===t.glVersion?o.REPEAT:o.CLAMP_TO_EDGE,o.LINEAR,o.LINEAR)}return t.prototype.bindTexture=function(t,e){},t.prototype.uploadFromArray=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=!1);var r=this._context._gl,o=t._width>>>i,s=t._height>>>i;if(e&&e.length!==o*s*4)throw new Error("Array is not the correct length for texture dimensions: expected: "+o*s*4+", exist: "+e.length);e instanceof Array&&(e=new Uint8Array(e)),r.bindTexture(r.TEXTURE_2D,t._glTexture),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),r.texImage2D(r.TEXTURE_2D,i,r.RGBA,o,s,0,r.RGBA,r.UNSIGNED_BYTE,e),r.bindTexture(r.TEXTURE_2D,null)},t.prototype.setTextureAt=function(t,e){var i=this._context._gl,n=this._samplerStates[t];if(this._activeTexture!==t&&(e||n.type)&&(this._activeTexture=t,i.activeTexture(i.TEXTURE0+t)),!e)return n.type&&(n.boundedTexture&&(n.boundedTexture._state.id=-1),i.bindTexture(n.type,null),n.boundedTexture=null,n.type=null),-1;var r=e.isPOT,o=(2===this._context.glVersion||r)&&0!==hi.PREF_REPEAT_WRAP,s=this._textureTypeDictionary[e.textureType];return n.type=s,i.bindTexture(s,e.glTexture),e._state.id=t,e._state.equals(n)||(e._state.copyFrom(n),n.wrap!==i.REPEAT||o?(i.texParameteri(s,i.TEXTURE_WRAP_S,n.wrap),i.texParameteri(s,i.TEXTURE_WRAP_T,n.wrap)):(Si[e.id]||1!==hi.PREF_REPEAT_WRAP||(Si[e.id]=!0,console.warn("[Texture] REPEAT wrap not allowed for nPOT textures in WebGL1,set ContextWebGLFlags.PREF_REPEAT_WRAP = (ContextWebGLPreference.POT_TEXTURES | ContextWebGLPreference.NONE)to supress warnings!",e)),i.texParameteri(s,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(s,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),i.texParameteri(s,i.TEXTURE_MAG_FILTER,n.filter),i.texParameteri(s,i.TEXTURE_MIN_FILTER,n.mipfilter)),t},t.prototype.setSamplerStateAt=function(t,e,i,n){if(!(0<=t&&t<Ri.MAX_SAMPLERS))throw"Sampler is out of bounds.";this._samplerStates[t].wrap=this._wrapDictionary[e],this._samplerStates[t].filter=this._filterDictionary[i],this._samplerStates[t].mipfilter=this._mipmapFilterMap[i][n]},t.prototype.unsafeCopyToTexture=function(t,e,i,n){void 0===n&&(n=!1);var r=this._context._gl;r.bindTexture(r.TEXTURE_2D,t.glTexture),n?r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,e.x,e.y,e.width,e.height,0):r.copyTexSubImage2D(r.TEXTURE_2D,0,i.x,i.y,e.x,e.y,e.width,e.height),r.bindTexture(r.TEXTURE_2D,null)},t.prototype.restoreRenderTarget=function(){if(this._renderTargetConfig){var t=this._renderTargetConfig,e=t.enableDepthAndStencil,i=t.antiAlias,n=t.surfaceSelector,r=t.mipmapSelector;this.setFrameBuffer(this._renderTarget,e,i,n,r)}else this.setRenderToBackBuffer()},t.prototype.setRenderToTexture=function(t,e,i,n,r){void 0===e&&(e=!1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this._renderTarget&&(this.presentFrameBuffer(this._renderTarget),this._renderTarget._isRT=!1),this._renderTarget=t,this._renderTarget._isRT=!0,this._renderTargetConfig={texture:this._renderTarget,enableDepthAndStencil:e,antiAlias:i,surfaceSelector:n,mipmapSelector:r},this._renderTarget._skipPresent=!1,this.setFrameBuffer(this._renderTarget,e,i,n,r)},t.prototype.setRenderToBackBuffer=function(){this._renderTarget&&(this.presentFrameBuffer(this._renderTarget),this._renderTarget._isRT=!1,this._renderTarget=null);var t=this._context._gl;this._renderTargetConfig=null,t.bindFramebuffer(t.FRAMEBUFFER,null)},t.prototype.setFrameBuffer=function(t,e,i,n,r){var o=this._context._gl;o instanceof WebGLRenderingContext&&(r=0);var s=t.width>>>r,a=t.height>>>r;t._mipmapSelector=r,t._frameBuffer[r]?o.bindFramebuffer(o.FRAMEBUFFER,t._frameBuffer[r]):this.initFrameBuffer(t,i,r),e?(this._context.enableDepth(),this._context.enableStencil()):(this._context.disableDepth(),this._context.disableStencil()),this._context.setViewport(0,0,s,a)},t.prototype.initFrameBuffer=function(t,e,i){var n=this._context._gl,r=t._width>>>i,o=t._height>>>i,s=t._frameBuffer[i]=n.createFramebuffer(),a=t._renderBufferDepth[i]=n.createRenderbuffer();if(t._mipmapSelector=i,n.bindTexture(n.TEXTURE_2D,t._glTexture),t._isFilled||(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r,o,0,n.RGBA,n.UNSIGNED_BYTE,null),t._isFilled=!0,t._isPMA=!0),n instanceof WebGLRenderingContext||!hi.PREF_MULTISAMPLE||e<1)n.bindFramebuffer(n.FRAMEBUFFER,s),n.bindRenderbuffer(n.RENDERBUFFER,a),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t._width,t._height),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t._glTexture,0),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,a),t._multisampled=!1;else{var l=t._frameBufferDraw[i]=n.createFramebuffer(),u=Math.log(Math.min(t._width,t._height))/Math.LN2|1;n.bindFramebuffer(n.FRAMEBUFFER,l),t._texStorageFlag||(n.texStorage2D(n.TEXTURE_2D,u,n.RGBA8,r,o),t._texStorageFlag=!0),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t._glTexture,t._mipmapSelector),n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,s),n.bindRenderbuffer(n.RENDERBUFFER,a),n.renderbufferStorageMultisample(n.RENDERBUFFER,e,n.DEPTH24_STENCIL8,r,o),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,a);var c=t._renderBuffer[i]=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,c),n.renderbufferStorageMultisample(n.RENDERBUFFER,e,n.RGBA8,r,o),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,c),t._multisampled=!0}n.bindRenderbuffer(n.RENDERBUFFER,null)},t.prototype.presentFrameBuffer=function(t){var e=this._context._gl;if(!(e instanceof WebGLRenderingContext||!t._multisampled||t._skipPresent)){var i=t._width>>>t._mipmapSelector,n=t._height>>>t._mipmapSelector;t._frameBuffer[t._mipmapSelector]!==t._frameBufferDraw[t._mipmapSelector]?(e.bindFramebuffer(e.READ_FRAMEBUFFER,t._frameBuffer[t._mipmapSelector]),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,t._frameBufferDraw[t._mipmapSelector]),e.clearBufferfv(e.COLOR,0,[0,0,0,0]),e.blitFramebuffer(0,0,i,n,0,0,i,n,e.COLOR_BUFFER_BIT,e.NEAREST)):console.error("Framebuffer loop `presentFrameBuffer`")}},t.prototype.presentFrameBufferTo=function(t,e,i,n){var r=this._context._gl,o=e.textureFramebuffer;o||(this.initFrameBuffer(e,0,0),r.bindFramebuffer(r.FRAMEBUFFER,null),o=e.textureFramebuffer),t._frameBuffer[0]!==o?(t._skipPresent=!0,!t||!t._multisampled||r instanceof WebGLRenderingContext?(r.bindFramebuffer(r.FRAMEBUFFER,t._frameBuffer[0]),this.unsafeCopyToTexture(e,i,n)):o&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,t._frameBuffer[0]),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,o),r.blitFramebuffer(0|i.x,0|i.y,i.width+i.x|0,i.height+i.y|0,0|n.x,0|n.y,n.x+i.width|0,n.y+i.height|0,r.COLOR_BUFFER_BIT,r.NEAREST)),this.blitTextureToRenderbuffer(e),this.restoreRenderTarget()):console.error("Framebuffer loop `presentFrameBufferTo`")},t.prototype.blitTextureToRenderbuffer=function(t){var e=this._context._gl;if(t._multisampled&&e instanceof WebGL2RenderingContext)if(t._frameBuffer[t._mipmapSelector]!==t._frameBufferDraw[t._mipmapSelector]){var i=t._width>>>t._mipmapSelector,n=t._height>>>t._mipmapSelector;e.bindFramebuffer(e.DRAW_FRAMEBUFFER,t._frameBuffer[t._mipmapSelector]),e.bindFramebuffer(e.READ_FRAMEBUFFER,t._frameBufferDraw[t._mipmapSelector]),e.clearBufferfv(e.COLOR,0,[0,0,0,0]),e.blitFramebuffer(0,0,i,n,0,0,i,n,e.COLOR_BUFFER_BIT,e.NEAREST)}else console.error("Framebuffer loop `blitTextureToRenderbuffer`")},t.prototype.disposeTexture=function(t){var e=this._context._gl;for(var i in this._renderTarget===t&&(console.warn("[Context] Trying to dispose a active tendertarget!"),this._context.setRenderToBackBuffer()),e.deleteTexture(t._glTexture),t._frameBuffer)e.deleteFramebuffer(t._frameBuffer[i]),e.deleteFramebuffer(t._frameBufferDraw[i]),e.deleteRenderbuffer(t._renderBuffer[i]),e.deleteRenderbuffer(t._renderBufferDepth[i])},t}(),Ti=function(){function t(e){this._isRequireUnbound=!1;var i=e._gl;if(!t.isSupported(i))throw"[VaoContextWebGL] VAO not supported!";if(window.WebGL2RenderingContext&&i instanceof window.WebGL2RenderingContext)this.createVertexArray=i.createVertexArray.bind(i),this._deleteVertexArray=i.deleteVertexArray.bind(i),this._bindVertexArray=i.bindVertexArray.bind(i);else{var n=i.getExtension("OES_vertex_array_object");this.createVertexArray=n.createVertexArrayOES.bind(n),this._deleteVertexArray=n.deleteVertexArrayOES.bind(n),this._bindVertexArray=n.bindVertexArrayOES.bind(n)}}return t.isSupported=function(t){return!!(window.WebGL2RenderingContext&&t instanceof window.WebGL2RenderingContext)||t.getSupportedExtensions().indexOf("OES_vertex_array_object")>-1},t.prototype.unbindVertexArrays=function(){this._bindVertexArray(null),this._lastBoundedVao=null,this._isRequireUnbound=!1},t.prototype.bindVertexArray=function(t){t!==this._lastBoundedVao&&(t?(this._isRequireUnbound=!1,this._lastBoundedVao=t,this._bindVertexArray(t._vao)):this._isRequireUnbound=!0)},t.prototype.deleteVertexArray=function(t){this._lastBoundedVao===t&&this._bindVertexArray(null),this._deleteVertexArray(t._vao),this._lastBoundedVao=null},t}(),Pi=function(){function t(t){this._context=t,this._vao=t._vaoContext.createVertexArray()}return t.prototype.attachIndexBuffer=function(t){this._indexBuffer||(this.bind(),this._context.bindIndexBuffer(t),this._indexBuffer=t)},t.prototype.bind=function(){this._context._vaoContext.bindVertexArray(this)},t.prototype.unbind=function(t){void 0===t&&(t=!1),t?this._context._vaoContext.unbindVertexArrays():this._context._vaoContext.bindVertexArray(null)},t.prototype.dispose=function(){this._context._vaoContext.deleteVertexArray(this),this._vao=null},t}(),Bi=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.values=[],this.fixedValues=[],this.dirty=!0,this._deltaDirty=[],this._locked=!1,this.values=Array.prototype.slice.call(arguments)}return t.prototype.lock=function(t){if(this._locked=t,t){for(var e=this.values,i=0,n=e.length;i<n;i++)this.fixedValues[i]=e[i];this.fixedValues.length=e.length,this.dirty=!1}},t.prototype.set=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this._locked?this.fixedValues:this.values,n=this.values,r=!1,o=0;o<t.length;o++)r=r||i[o]!==t[o],n[o]=t[o];return this.dirty=r},t.prototype.setAt=function(t,e){var i=(this._locked?this.fixedValues:this.values)[t]!==e;return this.values[t]=e,this.dirty=this.dirty||i,i},t.prototype.deltaDirty=function(){var t=this._deltaDirty,e=this.values,i=this.fixedValues;t.length=e.length;for(var n=0;n<e.length;n++)t[n]=e[n]!==i[n];return t},t.prototype.reset=function(){this.set()},t}(),Mi=function(){function t(t,e){void 0===e&&(e=0),this._alreadyInit=!1,this._size=0,this._gl=t,this._buffer=t.createBuffer(),this._size=e}return t.unboundAll=function(){this._lastBounded&&this._lastBounded.unbind()},t.isSuported=function(t){return window.WebGL2RenderingContext&&t instanceof window.WebGL2RenderingContext},Object.defineProperty(t.prototype,"alive",{get:function(){return!!this._buffer},enumerable:!0,configurable:!0}),t.prototype.read=function(e){var i=e.length;if(i<=0||i!==this._size)throw"Buffer length MUST be a same size as buffer on read state!";var n=this._gl;t._lastBounded!==this&&(n.bindBuffer(n.PIXEL_PACK_BUFFER,this._buffer),t._lastBounded=this),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,e)},t.prototype.bind=function(e){if(void 0===e&&(e=0),0===this._size&&0===e)throw"Buffer require size for bounding";var i=this._gl;t._lastBounded!==this&&i.bindBuffer(i.PIXEL_PACK_BUFFER,this._buffer),(!this._alreadyInit||this._size!==e&&e>0)&&(e>0&&(this._size=e),i.bufferData(i.PIXEL_PACK_BUFFER,this._size,i.DYNAMIC_READ),this._alreadyInit=!0),t._lastBounded=this},t.prototype.unbind=function(){t._lastBounded===this&&(this._gl.bindBuffer(this._gl.PIXEL_PACK_BUFFER,null),t._lastBounded=null)},t.prototype.dispose=function(){this.unbind(),this._gl.deleteBuffer(this._buffer),this._buffer=null,this._size=0,this._gl=null},t}(),Oi=function(){function t(t){this._gl=t,this.pool=[],this._tickerId=-1,this._tasks=[]}return t.prototype.readPixels=function(t,e,i,n){var r=this,o=this.pool.pop()||new Mi(this._gl);o.bind(i*n*4);var s=this._gl;s.readPixels(t,e,i,n,s.RGBA,s.UNSIGNED_BYTE,0);var a=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0),l=new Promise((function(t){r._tasks.push({task:t,pbo:o,fence:a})}));return-1===this._tickerId&&(this._tickerId=setInterval(this.tick.bind(this),10)),l},t.prototype.tick=function(){if(0!==this._tasks.length){for(var t=this._gl,e=this._tasks,i=0;i<this._tasks.length;i++){var n=e[i];t.getSyncParameter(n.fence,t.SYNC_STATUS)===t.SIGNALED&&(n.task(n.pbo),t.deleteSync(n.fence),e[i]=void 0)}this._tasks=e.filter((function(t){return!!t})),0===this._tasks.length&&(clearInterval(this._tickerId),this._tickerId=-1)}},t.prototype.release=function(t){t.alive&&this.pool.push(t)},t.prototype.unboundAll=function(){Mi.unboundAll()},t.prototype.dispose=function(){this._tasks=null,this.pool.forEach((function(t){return t.dispose()})),this._gl=null},t.isSupported=Mi.isSuported,t}(),Li="";window._AWAY_DEBUG_=Object.assign(window._AWAY_DEBUG_||{},{forceLineMode:function(t){void 0===t&&(t=!1),Li=t?"line":""}});var Ri=function(){function t(t,e){void 0===e&&(e=!1),this._blendFactorMap=new Object,this._drawModeMap=new Object,this._compareModeMap=new Object,this._stencilActionMap=new Object,this._vertexBufferMap={},this._drawing=!0,this._viewportState=new Bi(0,0,0,0),this._blendState=new Bi(0,0,0,0),this._colorMapState=new Bi(!0,!0,!0,!0),this._clearColorState=new Bi(0,0,0,0),this._clearSD=new Bi(0,-1),this._depthState=new Bi(0,0,0),this._stencilState=new Bi(0,1,0),this._cullState=new Bi(0,0,0),this._stencilReferenceValue=0,this._stencilReadMask=255,this._separateStencil=!1,this.lastBoundedIndexBuffer=null,this._hasVao=!1,this._container=t,this.initWebGL(e)}return Object.defineProperty(t.prototype,"hasFence",{get:function(){return!!this._fenceContext},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasVao",{get:function(){return this._hasVao},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glVersion",{get:function(){return this._glVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelRatio",{get:function(){return this._pixelRatio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"container",{get:function(){return this._container},set:function(t){this._container=t,this.initWebGL()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"standardDerivatives",{get:function(){return this._standardDerivatives},enumerable:!0,configurable:!0}),t.prototype.initWebGL=function(t){var e,i,n,r,o;void 0===t&&(t=!1);var s={alpha:t,stencil:!0};try{2===hi.PREF_VERSION&&(this._gl=this._container.getContext("webgl2",s),this._glVersion=2),this._gl||(this._gl=this._container.getContext("webgl",s)||this._container.getContext("experimental-webgl",s),this._glVersion=1,2===hi.PREF_VERSION&&console.warn("[CONTEXT] Preferred WebGL2 not supported on you device. WebGL1 will used!"))}catch(t){}if(this._gl){var a=this._gl;this._standardDerivatives=2===this._glVersion||!!a.getExtension("OES_standard_derivatives");var l=Lt;this._blendFactorMap=((e={})[l.ONE]=a.ONE,e[l.DESTINATION_ALPHA]=a.DST_ALPHA,e[l.DESTINATION_COLOR]=a.DST_COLOR,e[l.ONE]=a.ONE,e[l.ONE_MINUS_DESTINATION_ALPHA]=a.ONE_MINUS_DST_ALPHA,e[l.ONE_MINUS_DESTINATION_COLOR]=a.ONE_MINUS_DST_COLOR,e[l.ONE_MINUS_SOURCE_ALPHA]=a.ONE_MINUS_SRC_ALPHA,e[l.ONE_MINUS_SOURCE_COLOR]=a.ONE_MINUS_SRC_COLOR,e[l.SOURCE_ALPHA]=a.SRC_ALPHA,e[l.SOURCE_COLOR]=a.SRC_COLOR,e[l.ZERO]=a.ZERO,e),this._drawModeMap=((i={})[Ft.LINES]=a.LINES,i[Ft.TRIANGLES]=a.TRIANGLES,i);var u=Nt;this._compareModeMap=((n={})[u.ALWAYS]=a.ALWAYS,n[u.EQUAL]=a.EQUAL,n[u.GREATER]=a.GREATER,n[u.GREATER_EQUAL]=a.GEQUAL,n[u.LESS]=a.LESS,n[u.LESS_EQUAL]=a.LEQUAL,n[u.NEVER]=a.NEVER,n[u.NOT_EQUAL]=a.NOTEQUAL,n);var c=jt;this._stencilActionMap=((r={})[c.DECREMENT_SATURATE]=a.DECR,r[c.DECREMENT_WRAP]=a.DECR_WRAP,r[c.INCREMENT_SATURATE]=a.INCR,r[c.INCREMENT_WRAP]=a.INCR_WRAP,r[c.INVERT]=a.INVERT,r[c.KEEP]=a.KEEP,r[c.SET]=a.REPLACE,r[c.ZERO]=a.ZERO,r);var h=Ht;this._vertexBufferMap=((o={})[h.FLOAT_1]=new Ni(1,a.FLOAT,!1),o[h.FLOAT_2]=new Ni(2,a.FLOAT,!1),o[h.FLOAT_3]=new Ni(3,a.FLOAT,!1),o[h.FLOAT_4]=new Ni(4,a.FLOAT,!1),o[h.BYTE_1]=new Ni(1,a.BYTE,!0),o[h.BYTE_2]=new Ni(2,a.BYTE,!0),o[h.BYTE_3]=new Ni(3,a.BYTE,!0),o[h.BYTE_4]=new Ni(4,a.BYTE,!0),o[h.UNSIGNED_BYTE_1]=new Ni(1,a.UNSIGNED_BYTE,!0),o[h.UNSIGNED_BYTE_2]=new Ni(2,a.UNSIGNED_BYTE,!0),o[h.UNSIGNED_BYTE_3]=new Ni(3,a.UNSIGNED_BYTE,!0),o[h.UNSIGNED_BYTE_4]=new Ni(4,a.UNSIGNED_BYTE,!0),o[h.SHORT_1]=new Ni(1,a.SHORT,!1),o[h.SHORT_2]=new Ni(2,a.SHORT,!1),o[h.SHORT_3]=new Ni(3,a.SHORT,!1),o[h.SHORT_4]=new Ni(4,a.SHORT,!1),o[h.UNSIGNED_SHORT_1]=new Ni(1,a.UNSIGNED_SHORT,!1),o[h.UNSIGNED_SHORT_2]=new Ni(2,a.UNSIGNED_SHORT,!1),o[h.UNSIGNED_SHORT_3]=new Ni(3,a.UNSIGNED_SHORT,!1),o[h.UNSIGNED_SHORT_4]=new Ni(4,a.UNSIGNED_SHORT,!1),o),this._stencilCompareMode=a.ALWAYS,this._stencilCompareModeBack=a.ALWAYS,this._stencilCompareModeFront=a.ALWAYS;var p=window.devicePixelRatio||1;this._pixelRatio=p}else alert("WebGL is not available.");this._texContext=new Di(this),Ti.isSupported(this._gl)?(this._vaoContext=new Ti(this),this._hasVao=!0):console.warn("[ContextWebGL] VAO isn't supported"),Oi.isSupported(this._gl)?this._fenceContext=new Oi(this._gl):console.warn("[ContextWebGL] FenceSync isn't supported"),this._blendState.lock(!0)},t.prototype.gl=function(){return this._gl},t.prototype.clear=function(t,e,i,n,r,o,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=0),void 0===s&&(s=Rt.ALL),this._drawing||(this.updateBlendStatus(),this._drawing=!0);var a=0;s&Rt.COLOR&&(this._clearColorState.set(t,e,i,n)&&this._gl.clearColor(t,e,i,n),a|=this._gl.COLOR_BUFFER_BIT),s&Rt.STENCIL&&(a|=this._gl.STENCIL_BUFFER_BIT,this._clearSD.setAt(0,o)&&this._gl.clearStencil(o)),s&Rt.DEPTH&&(a|=this._gl.DEPTH_BUFFER_BIT,this._clearSD.setAt(0,r)&&this._gl.clearDepth(r)),this._gl.clear(a)},t.prototype.configureBackBuffer=function(t,e,i,n){void 0===n&&(n=!0),this._width=t*this._pixelRatio,this._height=e*this._pixelRatio,n?(this.enableStencil(),this.enableDepth()):(this.disableStencil(),this.disableDepth()),this._viewportState.set(0,0,this._width,this._height)&&this._gl.viewport(0,0,this._width,this._height)},t.prototype.createCubeTexture=function(t,e,i,n){return new fi(this,t)},t.prototype.createIndexBuffer=function(t){return xi.create(this._gl,t)},t.prototype.createProgram=function(){return new wi(this._gl)},t.prototype.createTexture=function(t,e,i,n,r){return Ii.create(this,t,e)},t.prototype.createVertexBuffer=function(t,e){return Ei.create(this._gl,t,e)},t.prototype.createVao=function(){if(!this._hasVao)throw"VAO isn'n supported";return new Pi(this)},t.prototype.dispose=function(){},t.prototype.drawToBitmapImage2D=function(t,e,i){var n,r;void 0===e&&(e=!0),void 0===i&&(i=!1);var o,s=new Uint8Array(t.getDataInternal().buffer),a=this._texContext._renderTarget,l=this._fenceContext,u=t.width,c=t.height;return i&&!l&&(o=Promise.resolve(!1)),(null===(n=a)||void 0===n?void 0:n.multisampled)&&(this._texContext.presentFrameBuffer(a),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,a.textureFramebuffer)),i&&l?o=l.readPixels(0,0,u,c).then((function(i){return i.read(s),e&&t.invalidateGPU(),l.release(i),!0})):(l&&l.unboundAll(),this._gl.readPixels(0,0,u,c,this._gl.RGBA,this._gl.UNSIGNED_BYTE,s),e&&t.invalidateGPU()),(null===(r=a)||void 0===r?void 0:r.multisampled)&&!i&&this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,a.framebuffer),o},t.prototype.drawIndices=function(t,e,i,n){if(void 0===i&&(i=0),void 0===n&&(n=-1),!this._drawing)throw"Need to clear before drawing if the buffer has not been cleared since the last present() call.";this.updateBlendStatus(),this._hasVao&&this._vaoContext._lastBoundedVao||(this.lastBoundedIndexBuffer!==e.glBuffer&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,e.glBuffer),this.lastBoundedIndexBuffer=e.glBuffer),t="line"===Li?Ft.LINES:t,this._gl.drawElements(this._drawModeMap[t],-1==n?e.numIndices:n,this._gl.UNSIGNED_SHORT,2*i)},t.prototype.bindIndexBuffer=function(t){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,t.glBuffer),this.lastBoundedIndexBuffer=t.glBuffer},t.prototype.drawVertices=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=-1),!this._drawing)throw"Need to clear before drawing if the buffer has not been cleared since the last present() call.";0!=i&&(this.updateBlendStatus(),t="line"===Li?Ft.LINES:t,this._gl.drawArrays(this._drawModeMap[t],e,i))},t.prototype.present=function(){},t.prototype.setBlendFactors=function(t,e){var i=this._blendFactorMap[t],n=this._blendFactorMap[e],r=this._gl;this._blendState.set(1,r.FUNC_ADD,i,n)},t.prototype.setColorMask=function(t,e,i,n){this._colorMapState.set(t,e,i,n)&&this._gl.colorMask(t,e,i,n)},t.prototype.setCulling=function(t,e){if(void 0===e&&(e=_t.LEFT_HANDED),t===zt.NONE)this._cullState.setAt(0,0)&&this._gl.disable(this._gl.CULL_FACE);else{this._cullState.setAt(0,1)&&this._gl.enable(this._gl.CULL_FACE);var i=this.translateTriangleFace(t,e);this._cullState.setAt(1,i)&&this._gl.cullFace(i)}},t.prototype.setDepthTest=function(t,e){var i=this._compareModeMap[e];this._depthState.setAt(1,+t)&&this._gl.depthMask(t),this._depthState.setAt(2,i)&&this._gl.depthFunc(i)},t.prototype.setViewport=function(t,e,i,n){this._viewportState.set(t,e,i,n)&&this._gl.viewport(t,e,i,n)},t.prototype.enableDepth=function(){this._depthState.setAt(0,1)&&this._gl.enable(this._gl.DEPTH_TEST)},t.prototype.disableDepth=function(){this._depthState.setAt(0,0)&&this._gl.disable(this._gl.DEPTH_TEST)},t.prototype.enableStencil=function(){this._stencilState.setAt(0,1)&&this._gl.enable(this._gl.STENCIL_TEST)},t.prototype.disableStencil=function(){this._stencilState.setAt(0,0)&&this._gl.disable(this._gl.STENCIL_TEST)},t.prototype.setStencilActions=function(t,e,i,n,r,o){void 0===t&&(t=zt.FRONT_AND_BACK),void 0===e&&(e=Nt.ALWAYS),void 0===i&&(i=jt.KEEP),void 0===n&&(n=jt.KEEP),void 0===r&&(r=jt.KEEP),void 0===o&&(o=_t.LEFT_HANDED),this._separateStencil=t!=zt.FRONT_AND_BACK;var s=this._compareModeMap[e],a=this._stencilActionMap[r],l=this._stencilActionMap[n],u=this._stencilActionMap[i];this._separateStencil?t==zt.BACK?(this._stencilCompareModeBack=s,this._gl.stencilFuncSeparate(this._gl.BACK,s,this._stencilReferenceValue,this._stencilReadMask),this._gl.stencilOpSeparate(this._gl.BACK,a,l,u)):t==zt.FRONT&&(this._stencilCompareModeFront=s,this._gl.stencilFuncSeparate(this._gl.FRONT,s,this._stencilReferenceValue,this._stencilReadMask),this._gl.stencilOpSeparate(this._gl.FRONT,a,l,u)):(this._stencilCompareMode=s,this._gl.stencilFunc(s,this._stencilReferenceValue,this._stencilReadMask),this._gl.stencilOp(a,l,u))},t.prototype.setStencilReferenceValue=function(t,e,i){void 0===e&&(e=255),void 0===i&&(i=255),this._stencilReferenceValue=t,this._stencilReadMask=e,this._separateStencil?(this._gl.stencilFuncSeparate(this._gl.FRONT,this._stencilCompareModeFront,t,e),this._gl.stencilFuncSeparate(this._gl.BACK,this._stencilCompareModeBack,t,e)):this._gl.stencilFunc(this._stencilCompareMode,t,e),this._gl.stencilMask(i)},t.prototype.setProgram=function(t){this._currentProgram!==t&&(this._currentProgram=t,t.focusProgram())},t.prototype.setProgramConstantsFromArray=function(t,e){e.length&&this._currentProgram.uniform4fv(t,e)},t.prototype.setScissorRectangle=function(t){if(t){var e=!!this._texContext._renderTarget,i=e?1:this._pixelRatio,n=e?t.y:this._height-(t.y+t.height)*i;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(t.x*i,n,t.width*i,t.height*i)}else this._gl.disable(this._gl.SCISSOR_TEST)},t.prototype.setTextureAt=function(t,e){var i=this._texContext.setTextureAt(t,e);i>=0&&this._currentProgram.uniform1i(Ut.SAMPLER,t,i)},t.prototype.setSamplerStateAt=function(t,e,i,n){this._texContext.setSamplerStateAt(t,e,i,n)},t.prototype.setVertexBufferAt=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=4);var r=this._currentProgram?this._currentProgram.getAttribLocation(t):-1;if(this.hasVao&&this._vaoContext._isRequireUnbound&&this._vaoContext.unbindVertexArrays(),e){(this._currentArrayBuffer!=e||this.hasVao&&this._vaoContext._lastBoundedVao)&&(this._currentArrayBuffer=e,this._gl.bindBuffer(this._gl.ARRAY_BUFFER,e?e.glBuffer:null));var o=this._vertexBufferMap[n];this._gl.enableVertexAttribArray(r),this._gl.vertexAttribPointer(r,o.size,o.type,o.normalized,e.dataPerVertex,i)}else r>-1&&this._gl.disableVertexAttribArray(t)},t.prototype.setRenderToTexture=function(t,e,i,n,r){void 0===e&&(e=!1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this._texContext.setRenderToTexture(t,e,i,n,r)},t.prototype.setRenderToBackBuffer=function(){this._texContext.setRenderToBackBuffer()},t.prototype.restoreRenderTarget=function(){this._texContext.restoreRenderTarget()},t.prototype.copyToTexture=function(t,e,i){this._texContext.presentFrameBufferTo(this._texContext._renderTarget,t,e,i)},t.prototype.updateBlendStatus=function(){var t=this._blendState;if(t.dirty){var e=t.values,i=t.deltaDirty();t.lock(!0),e[0]?(i[0]&&this._gl.enable(this._gl.BLEND),(i[1]||i[0])&&this._gl.blendEquation(e[1]),(i[2]||i[3]||i[0])&&this._gl.blendFunc(e[2],e[3])):i[0]&&this._gl.disable(this._gl.BLEND)}},t.prototype.finish=function(){this._gl.flush(),this._gl.finish()},t.prototype.translateTriangleFace=function(t,e){switch(t){case zt.BACK:return e==_t.LEFT_HANDED?this._gl.FRONT:this._gl.BACK;case zt.FRONT:return e==_t.LEFT_HANDED?this._gl.BACK:this._gl.FRONT;case zt.FRONT_AND_BACK:return this._gl.FRONT_AND_BACK;default:throw"Unknown ContextGLTriangleFace type."}},t.MAX_SAMPLERS=8,t.modulo=0,t}(),Ni=function(t,e,i){this.size=t,this.type=e,this.normalized=i},Fi=function(){function t(e,i,n){void 0===n&&(n=-1),this._component=n,this._regName=e,this._index=i,this._toStr=this._regName,this._index>=0&&(this._toStr+=this._index),n>-1&&(this._toStr+="."+t.COMPONENTS[n])}return t.prototype.toString=function(){return this._toStr},Object.defineProperty(t.prototype,"regName",{get:function(){return this._regName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),t.COMPONENTS=["x","y","z","w"],t}(),ki=function(){function t(t,e,i){void 0===i&&(i=!0),this._regName=t,this._regCount=e,this._persistent=i,this.initRegisters(t,e)}return t.prototype.requestFreeVectorReg=function(){for(var t=0;t<this._regCount;++t)if(!this.isRegisterUsed(t))return this._persistent&&this._usedVectorCount[t]++,this._vectorRegisters[t];throw new Error("Register overflow!")},t.prototype.requestFreeRegComponent=function(){for(var t=0;t<this._regCount;++t)if(!(this._usedVectorCount[t]>0))for(var e=0;e<4;++e)if(0==this._usedSingleCount[e][t])return this._persistent&&this._usedSingleCount[e][t]++,this._registerComponents[e][t];throw new Error("Register overflow!")},t.prototype.addUsage=function(t,e){t._component>-1?this._usedSingleCount[t._component][t.index]+=e:this._usedVectorCount[t.index]+=e},t.prototype.removeUsage=function(t){if(t._component>-1){if(--this._usedSingleCount[t._component][t.index]<0)throw new Error("More usages removed than exist!")}else if(--this._usedVectorCount[t.index]<0)throw new Error("More usages removed than exist!")},t.prototype.dispose=function(){this._vectorRegisters=null,this._registerComponents=null,this._usedSingleCount=null,this._usedVectorCount=null},t.prototype.hasRegisteredRegs=function(){for(var t=0;t<this._regCount;++t)if(this.isRegisterUsed(t))return!0;return!1},t.prototype.initRegisters=function(e,i){var n=t._initPool(e,i);this._vectorRegisters=t._regPool[n],this._registerComponents=t._regCompsPool[n],this._usedVectorCount=this._initArray(Array(i),0),this._usedSingleCount=new Array(4),this._usedSingleCount[0]=this._initArray(new Array(i),0),this._usedSingleCount[1]=this._initArray(new Array(i),0),this._usedSingleCount[2]=this._initArray(new Array(i),0),this._usedSingleCount[3]=this._initArray(new Array(i),0)},t._initPool=function(e,i){var n=e+i;if(null!=t._regPool[n])return n;var r=new Array(i);t._regPool[n]=r;var o=[[],[],[],[]];t._regCompsPool[n]=o;for(var s=0;s<i;++s){r[s]=new Fi(e,s);for(var a=0;a<4;++a)o[a][s]=new Fi(e,s,a)}return n},t.prototype.isRegisterUsed=function(t){if(this._usedVectorCount[t]>0)return!0;for(var e=0;e<4;++e)if(this._usedSingleCount[e][t]>0)return!0;return!1},t.prototype._initArray=function(t,e){for(var i=t.length,n=0;n<i;n++)t[n]=e;return t},t._regPool=new Object,t._regCompsPool=new Object,t}(),Vi=function(){function t(t){this._numUsedVertexConstants=0,this._numUsedFragmentConstants=0,this._numUsedStreams=0,this._numUsedTextures=0,this._numUsedVaryings=0,this._profile=t,this.reset()}return t.prototype.reset=function(){this._fragmentTempCache=new ki("ft",8,!1),this._vertexTempCache=new ki("vt",8,!1),this._varyingCache=new ki("v",8),this._textureCache=new ki("fs",8),this._vertexAttributesCache=new ki("va",8),this._fragmentConstantsCache=new ki("fc",28),this._vertexConstantsCache=new ki("vc",128),this._fragmentOutputRegister=new Fi("oc",-1),this._vertexOutputRegister=new Fi("op",-1),this._numUsedVertexConstants=0,this._numUsedStreams=0,this._numUsedTextures=0,this._numUsedVaryings=0,this._numUsedFragmentConstants=0},t.prototype.dispose=function(){this._fragmentTempCache.dispose(),this._vertexTempCache.dispose(),this._varyingCache.dispose(),this._fragmentConstantsCache.dispose(),this._vertexAttributesCache.dispose(),this._fragmentTempCache=null,this._vertexTempCache=null,this._varyingCache=null,this._fragmentConstantsCache=null,this._vertexAttributesCache=null,this._fragmentOutputRegister=null,this._vertexOutputRegister=null},t.prototype.addFragmentTempUsages=function(t,e){this._fragmentTempCache.addUsage(t,e)},t.prototype.removeFragmentTempUsage=function(t){this._fragmentTempCache.removeUsage(t)},t.prototype.addVertexTempUsages=function(t,e){this._vertexTempCache.addUsage(t,e)},t.prototype.removeVertexTempUsage=function(t){this._vertexTempCache.removeUsage(t)},t.prototype.getFreeFragmentVectorTemp=function(){return this._fragmentTempCache.requestFreeVectorReg()},t.prototype.getFreeFragmentSingleTemp=function(){return this._fragmentTempCache.requestFreeRegComponent()},t.prototype.getFreeVarying=function(){return++this._numUsedVaryings,this._varyingCache.requestFreeVectorReg()},t.prototype.getFreeFragmentConstant=function(){return++this._numUsedFragmentConstants,this._fragmentConstantsCache.requestFreeVectorReg()},t.prototype.getFreeVertexConstant=function(){return++this._numUsedVertexConstants,this._vertexConstantsCache.requestFreeVectorReg()},t.prototype.getFreeVertexVectorTemp=function(){return this._vertexTempCache.requestFreeVectorReg()},t.prototype.getFreeVertexSingleTemp=function(){return this._vertexTempCache.requestFreeRegComponent()},t.prototype.getFreeVertexAttribute=function(){return++this._numUsedStreams,this._vertexAttributesCache.requestFreeVectorReg()},t.prototype.getFreeTextureReg=function(){return++this._numUsedTextures,this._textureCache.requestFreeVectorReg()},Object.defineProperty(t.prototype,"fragmentOutputRegister",{get:function(){return this._fragmentOutputRegister},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numUsedVertexConstants",{get:function(){return this._numUsedVertexConstants},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numUsedFragmentConstants",{get:function(){return this._numUsedFragmentConstants},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numUsedStreams",{get:function(){return this._numUsedStreams},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numUsedTextures",{get:function(){return this._numUsedTextures},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numUsedVaryings",{get:function(){return this._numUsedVaryings},enumerable:!0,configurable:!0}),t}(),Ui=function(){function t(t){void 0===t&&(t=!1),this._scaledTextureWidth=-1,this._scaledTextureHeight=-1,this._textureWidth=-1,this._textureHeight=-1,this._textureDimensionsInvalid=!0,this._program3DInvalid=!0,this._textureScale=1,this._requireDepthRender=t,this._registerCache=new Vi(Vt.BASELINE)}return Object.defineProperty(t.prototype,"textureScale",{get:function(){return this._textureScale},set:function(t){this._textureScale!=t&&(this._textureScale=t,this._scaledTextureWidth=this._textureWidth/this._textureScale,this._scaledTextureHeight=this._textureHeight/this._textureScale,this._textureDimensionsInvalid=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rttManager",{get:function(){return this._rttManager},set:function(t){this._rttManager!=t&&(this._rttManager=t,this._textureDimensionsInvalid=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textureWidth",{get:function(){return this._textureWidth},set:function(t){this._textureWidth!=t&&(this._textureWidth=t,this._scaledTextureWidth=this._textureWidth/this._textureScale,this._textureDimensionsInvalid=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textureHeight",{get:function(){return this._textureHeight},set:function(t){this._textureHeight!=t&&(this._textureHeight=t,this._scaledTextureHeight=this._textureHeight/this._textureScale,this._textureDimensionsInvalid=!0)},enumerable:!0,configurable:!0}),t.prototype.getMainInputTexture=function(t){return this._textureDimensionsInvalid&&this.updateTextures(t),this._mainInputTexture},t.prototype.dispose=function(){this._mainInputTexture&&this._mainInputTexture.dispose(),this._program3D&&this._program3D.dispose(),this.vao&&(this.vao.dispose(),this.vao=null)},t.prototype.invalidateProgram=function(){this._program3DInvalid=!0},t.prototype.updateProgram=function(t){this._program3D&&this._program3D.dispose(),this._program3D=t.context.createProgram(),this._registerCache.reset();var e=(new Ce).assemble("part vertex 1\n"+this.getVertexCode()+"endpart").vertex.data,i=(new Ce).assemble("part fragment 1\n"+this.getFragmentCode()+"endpart").fragment.data;this._program3D.name=this.constructor.name,this._program3D.upload(e,i),this._program3DInvalid=!1},t.prototype.getVertexCode=function(){var t=this._registerCache.getFreeVertexAttribute();this._positionIndex=t.index;var e=this._registerCache.getFreeVertexAttribute();return this._uvIndex=e.index,this._uvVarying=this._registerCache.getFreeVarying(),"mov op, "+t+"\nmov "+this._uvVarying+", "+e+"\n"},t.prototype.getFragmentCode=function(){throw new s},t.prototype.updateTextures=function(t){this._mainInputTexture&&this._mainInputTexture.dispose(),this._mainInputTexture=new sn(this._scaledTextureWidth,this._scaledTextureHeight),this._textureDimensionsInvalid=!1},t.prototype.getProgram=function(t){return this._program3DInvalid&&this.updateProgram(t),this._program3D},t.prototype.activate=function(t,e,i){},t.prototype.deactivate=function(t){},Object.defineProperty(t.prototype,"requireDepthRender",{get:function(){return this._requireDepthRender},enumerable:!0,configurable:!0}),t}(),ji=new Float32Array([1,1,1,1,0,0,0,0]),Gi=function(t){function e(){var e=t.call(this)||this;return e.rect=new Y,e.destPoint=new D,e._vertexConstantData=new Float32Array([0,0,0,0,0,0,0,0]),e._fragConstantData=ji.slice(),e}return i(e,t),Object.defineProperty(e.prototype,"sourceTexture",{get:function(){return this._mainInputTexture},set:function(t){this._mainInputTexture=t},enumerable:!0,configurable:!0}),e.prototype.getVertexCode=function(){var t=this._registerCache.getFreeVertexVectorTemp(),e=this._registerCache.getFreeVertexConstant(),i=this._registerCache.getFreeVertexAttribute();this._positionIndex=i.index;var n=this._registerCache.getFreeVertexConstant(),r=this._registerCache.getFreeVertexAttribute();return this._uvIndex=r.index,this._uvVarying=this._registerCache.getFreeVarying(),"mul "+t+".xy, "+i+", "+e+".zw\nadd "+t+".xy, "+t+", "+e+".xy\nmov "+t+".w, "+i+".w\nmov op, "+t+"\nadd "+this._uvVarying+", "+r+", "+n+".xy\nmul "+this._uvVarying+", "+this._uvVarying+", "+n+".zw\n"},e.prototype.getFragmentCode=function(){var t=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(t,1);var e=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(e,1);var i=this._registerCache.getFreeFragmentConstant(),n=this._registerCache.getFreeFragmentConstant(),r=this._registerCache.getFreeTextureReg();return this._inputTextureIndex=r.index,"tex "+t+", "+this._uvVarying+", "+r+" <2d,linear,clamp>\nsat "+e+", "+i+"\nmul "+t+", "+t+", "+e+".xyzw\nmul "+e+", "+n+", "+t+".w\nadd "+t+", "+t+", "+e+".xyzw\nmov oc, "+t+"\n"},e.prototype.getMainInputTexture=function(t){return this._mainInputTexture},e.prototype.activate=function(t,e,i){var n=this._positionIndex,r=this._vertexConstantData,o=this.destPoint,s=this.rect,a=this._target,l=this._mainInputTexture;r[n+0]=(2*o.x+s.width)/a.width-1,r[n+1]=(2*o.y+s.height)/a.height-1,r[n+2]=s.width/a.width,r[n+3]=s.height/a.height,r[n+4]=s.x/s.width,r[n+5]=s.y/s.height,r[n+6]=s.width/l.width,r[n+7]=s.height/l.height;var u=ji;if(this.transform){(u=this._fragConstantData).set(this.transform._rawData);for(var c=0;c<4;c++)u[c+4]/=255;u[7]=0}var h=t.context;h.setProgramConstantsFromArray(Ut.VERTEX,r),h.setProgramConstantsFromArray(Ut.FRAGMENT,u)},e.prototype.deactivate=function(t){},e}(Ui),Qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.updateProgram=function(t){this._program3D&&this._program3D.dispose(),this._program3D=t.context.createProgram(),this._registerCache.reset(),this._program3D.name=this.constructor.name,this._program3D.uploadRaw(this.getVertexCode(),this.getFragmentCode()),this._program3DInvalid=!1},e.prototype.getVertexCode=function(){return"\nprecision highp float;\nuniform float yflip;\nattribute vec4 aPosition;\nattribute vec4 aUv;\n\nvarying vec4 vUv;\n\nvoid main() {\n\tvUv = aUv;\n\tvec4 pos = aPosition;\n\tpos.z = pos.z * 2.0 - pos.w;\n\tgl_Position = pos;\n}\n"},e.prototype.getFragmentCode=function(){return"\nprecision highp float;\nuniform vec4 fc[2];\nuniform sampler2D uSampler0;\nvarying vec4 vUv;\n\nvoid main() {\n    vec4 color = texture2D(uSampler0, vUv.xy);\n    gl_FragColor = color;\n}\n\n"},e}(Ui),zi=new Float32Array([1,1,1,1,0,0,0,0]),Hi=function(t){function e(){var e=t.call(this)||this;return e.rect=new Y,e.destPoint=new D,e._inputTextureIndex=0,e._positionIndex=0,e._uvIndex=1,e._vertexConstantData=new Float32Array([0,0,0,0,0,0,0,0]),e._fragConstantData=zi.slice(),e}return i(e,t),Object.defineProperty(e.prototype,"sourceTexture",{get:function(){return this._mainInputTexture},set:function(t){this._mainInputTexture=t},enumerable:!0,configurable:!0}),e.prototype.getVertexCode=function(){return"\nprecision highp float;\nuniform float yflip;\nuniform vec4 vc[2];\nvec4 vt0;\n\n/* AGAL legacy atrib resolver require this names */\nattribute vec4 va0; // position\nattribute vec4 va1; // uv \n\nvarying vec2 vUv;\n\nvoid main() {\n\tvec4 pos = va0;\n\n\tpos.xy = pos.xy * vc[0].zw + vc[0].xy;\n\tpos.z = pos.z * 2.0 - pos.w;\n\n\tvUv = (va1.xy + vc[1].xy) * vc[1].zw;\n\n    gl_Position = pos;\n}\n\n"},e.prototype.getFragmentCode=function(){return"\nprecision highp float;\nuniform vec4 fc[2];\nvarying vec2 vUv;\n\n/* AGAL legacy attrib resolver require this names */\nuniform sampler2D fs0;\n\nvoid main() {\n\tvec4 color = texture2D(fs0, vUv);\n\t\n\tif (color.a > 0.0) {\n\t\tcolor.rgb /= color.a;\n\t}\n\n\t// mult\n\tcolor *= clamp(fc[0], 0.0, 1.0);\t\n\tcolor += fc[1];\n\n\tcolor.rgb *= color.a;\n\n    gl_FragColor = color;\n}"},e.prototype.getMainInputTexture=function(t){return this._mainInputTexture},e.prototype.activate=function(t,e,i){var n=this._vertexConstantData,r=this.destPoint,o=this.rect,s=this._target,a=this._mainInputTexture;n[0]=(2*r.x+o.width)/s.width-1,n[1]=(2*r.y+o.height)/s.height-1,n[2]=o.width/s.width,n[3]=o.height/s.height,n[4]=o.x/o.width,n[5]=o.y/o.height,n[6]=o.width/a.width,n[7]=o.height/a.height;var l=zi;if(this.transform){(l=this._fragConstantData).set(this.transform._rawData);for(var u=0;u<4;u++)l[u+4]/=255;l[7]=0}var c=t.context;c.setProgramConstantsFromArray(Ut.VERTEX,n),c.setProgramConstantsFromArray(Ut.FRAGMENT,l)},e.prototype.deactivate=function(t){},e}(Qi),Xi=function(){function t(){this._tasks=[],this._textureScale=1}return t.prototype.init=function(t){this._context=t},Object.defineProperty(t.prototype,"requireDepthRender",{get:function(){return this._requireDepthRender},enumerable:!0,configurable:!0}),t.prototype.addTask=function(t){this._tasks.push(t),null==this._requireDepthRender&&(this._requireDepthRender=t.requireDepthRender)},Object.defineProperty(t.prototype,"tasks",{get:function(){return this._tasks},enumerable:!0,configurable:!0}),t.prototype.getMainInputTexture=function(t){return this._tasks[0].getMainInputTexture(t)},Object.defineProperty(t.prototype,"textureWidth",{get:function(){return this._textureWidth},set:function(t){this._textureWidth=t;for(var e=0;e<this._tasks.length;++e)this._tasks[e].textureWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rttManager",{get:function(){return this._rttManager},set:function(t){this._rttManager=t;for(var e=0;e<this._tasks.length;++e)this._tasks[e].rttManager=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textureHeight",{get:function(){return this._textureHeight},set:function(t){this._textureHeight=t;for(var e=0;e<this._tasks.length;++e)this._tasks[e].textureHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textureScale",{get:function(){return this._textureScale},set:function(t){this._textureScale=t;for(var e=0;e<this._tasks.length;++e)this._tasks[e].textureScale=t},enumerable:!0,configurable:!0}),t.prototype.setRenderTargets=function(t,e){this._tasks[this._tasks.length-1].target=t},t.prototype.dispose=function(){for(var t=0;t<this._tasks.length;++t)this._tasks[t].dispose()},t.prototype.update=function(t,e){},t}(),qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.init=function(e){this._context!==e&&(t.prototype.init.call(this,e),this._copyPixelTask=e instanceof Ri?new Hi:new Gi,this.addTask(this._copyPixelTask))},Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._copyPixelTask.transform},set:function(t){this._copyPixelTask.transform=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rect",{get:function(){return this._copyPixelTask.rect},set:function(t){this._copyPixelTask.rect=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destPoint",{get:function(){return this._copyPixelTask.destPoint},set:function(t){this._copyPixelTask.destPoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceTexture",{get:function(){return this._copyPixelTask.sourceTexture},set:function(t){this._copyPixelTask.sourceTexture=t},enumerable:!0,configurable:!0}),e}(Xi),Yi=function(t){function e(){var e=t.call(this)||this;return e._opDecode={"<":"slt ","<=":"sge ",">":"slt ",">=":"sge ","==":"seq ","!=":"sne "},e._thDecode={"<":!1,"<=":!0,">":!0,">=":!1,"==":!1,"!=":!1},e._operation="<",e._threshold=0,e._thresholdRGBA=new P,e._color=0,e._colorRGBA=new P,e._mask=0,e._maskRGBA=new P,e._copySource=!1,e._decodeVector=new P(65025,255,1,16581375),e.rect=new Y,e.destPoint=new D,e._vertexConstantData=new Float32Array([0,0,0,0,0,0,0,0]),e._fragmentConstantData=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,65025,255,1,16581375]),e}return i(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return this._operation},set:function(t){this._operation!=t&&(this._operation=t,this._op=this._opDecode[t],this._th=this._thDecode[t],this.invalidateProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"threshold",{get:function(){return this._threshold},set:function(t){this._threshold!=t&&(this._threshold=t,this._thresholdRGBA.x=(t>>16&255)/255,this._thresholdRGBA.y=(t>>8&255)/255,this._thresholdRGBA.z=(255&t)/255,this._thresholdRGBA.w=(t>>24&255)/255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){if(this._color!=t){this._color=t;var e=(t>>24&255)/255;this._colorRGBA.x=e*(t>>16&255)/255,this._colorRGBA.y=e*(t>>8&255)/255,this._colorRGBA.z=e*(255&t)/255,this._colorRGBA.w=e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask!=t&&(this._mask=t,this._maskRGBA.x=(t>>16&255)/255,this._maskRGBA.y=(t>>8&255)/255,this._maskRGBA.z=(255&t)/255,this._maskRGBA.w=(t>>24&255)/255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"copySource",{get:function(){return this._copySource},set:function(t){this._copySource!=t&&(this._copySource=t,this.invalidateProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceTexture",{get:function(){return this._mainInputTexture},set:function(t){this._mainInputTexture=t},enumerable:!0,configurable:!0}),e.prototype.getVertexCode=function(){var t=this._registerCache.getFreeVertexVectorTemp(),e=this._registerCache.getFreeVertexConstant(),i=this._registerCache.getFreeVertexAttribute();this._positionIndex=i.index;var n=this._registerCache.getFreeVertexConstant(),r=this._registerCache.getFreeVertexAttribute();return this._uvIndex=r.index,this._uvVarying=this._registerCache.getFreeVarying(),"mul "+t+".xy, "+i+", "+e+".zw\nadd "+t+".xy, "+t+", "+e+".xy\nmov "+t+".w, "+i+".w\nmov op, "+t+"\nadd "+this._uvVarying+", "+r+", "+n+".xy\n"},e.prototype.getFragmentCode=function(){var t=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(t,1);var e=this._registerCache.getFreeTextureReg();this._inputTextureIndex=e.index;var i=this._registerCache.getFreeFragmentConstant();this._fragmentConstantsIndex=i.index;var n,r=this._registerCache.getFreeFragmentConstant(),o=this._registerCache.getFreeFragmentConstant(),s=this._registerCache.getFreeFragmentConstant();if(this._copySource){var a=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(a,1);var l=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(l,1),n="tex "+t+", "+this._uvVarying+", "+e+" <2d,linear,clamp>\nmul "+a+", "+t+", "+o+"\ndp4 "+a+", "+a+", "+s+"\n"+this._op+a+", "+(this._th?i:a)+", "+(this._th?a:i)+"\nsub "+l+", "+s+".zzzz, "+a+"\nmul "+a+", "+a+", "+r+"\nmul "+l+", "+l+", "+t+"\nadd "+t+", "+a+", "+l+"\nmov oc, "+t+"\n",this._registerCache.removeFragmentTempUsage(l),this._registerCache.removeFragmentTempUsage(a)}else n="tex "+t+", "+this._uvVarying+", "+e+" <2d,linear,clamp>\nmul "+t+", "+t+", "+o+"\ndp4 "+t+", "+t+", "+s+"\n"+this._op+t+", "+(this._th?i:t)+", "+(this._th?t:i)+"\nmul "+t+", "+t+", "+r+"\nmov oc, "+t+"\n";return this._registerCache.removeFragmentTempUsage(t),n},e.prototype.getMainInputTexture=function(t){return this._mainInputTexture},e.prototype.activate=function(t,e,i){var n=this._positionIndex,r=this._vertexConstantData;r[n]=(2*this.destPoint.x+this.rect.width)/this._target.width-1,r[n+1]=(2*this.destPoint.y+this.rect.height)/this._target.height-1,r[n+2]=this.rect.width/this._target.width,r[n+3]=this.rect.height/this._target.height,r[n+4]=this.rect.x/this._mainInputTexture.width,r[n+5]=this.rect.y/this._mainInputTexture.height;var o=new P(this._thresholdRGBA.x*this._maskRGBA.x,this._thresholdRGBA.y*this._maskRGBA.y,this._thresholdRGBA.z*this._maskRGBA.z,this._thresholdRGBA.w*this._maskRGBA.w).dotProduct(this._decodeVector);n=this._fragmentConstantsIndex,(r=this._fragmentConstantData)[n]=o,r[n+1]=o,r[n+2]=o,r[n+3]=o,r[n+4]=this._colorRGBA.x,r[n+5]=this._colorRGBA.y,r[n+6]=this._colorRGBA.z,r[n+7]=this._colorRGBA.w,r[n+8]=this._maskRGBA.x,r[n+9]=this._maskRGBA.y,r[n+10]=this._maskRGBA.z,r[n+11]=this._maskRGBA.w;var s=t.context;s.setProgramConstantsFromArray(Ut.VERTEX,this._vertexConstantData),s.setProgramConstantsFromArray(Ut.FRAGMENT,this._fragmentConstantData)},e.prototype.deactivate=function(t){},e}(Ui),Ki=function(t){function e(){var e=t.call(this)||this;return e._thresholdTask=new Yi,e.addTask(e._thresholdTask),e}return i(e,t),Object.defineProperty(e.prototype,"rect",{get:function(){return this._thresholdTask.rect},set:function(t){this._thresholdTask.rect=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destPoint",{get:function(){return this._thresholdTask.destPoint},set:function(t){this._thresholdTask.destPoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"operation",{get:function(){return this._thresholdTask.operation},set:function(t){this._thresholdTask.operation=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"threshold",{get:function(){return this._thresholdTask.threshold},set:function(t){this._thresholdTask.threshold=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._thresholdTask.color},set:function(t){this._thresholdTask.color=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._thresholdTask.mask},set:function(t){this._thresholdTask.mask=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"copySource",{get:function(){return this._thresholdTask.copySource},set:function(t){this._thresholdTask.copySource=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceTexture",{get:function(){return this._thresholdTask.sourceTexture},set:function(t){this._thresholdTask.sourceTexture=t},enumerable:!0,configurable:!0}),e}(Xi),Wi={x:0,y:0},Ji=function(t){function e(e,i,n,r,o){void 0===o&&(o=Vt.BASELINE);var s=t.call(this)||this;return s._programData=new Array,s._x=0,s._y=0,s._touchPoints=new Array,s._stageIndex=-1,s._antiAlias=4,s._renderTarget=null,s._renderSurfaceSelector=0,s._renderMipmapSelector=0,s._initialised=!1,s._bufferFormatDictionary=new Array(5),s.globalDisableMipmap=!1,s.globalDisableSmooth=!1,s.numUsedStreams=0,s.numUsedTextures=0,s.id=K.ID_COUNT++,s._programDataPool=new ti(s),s._container=e,s._container&&(s._container.addEventListener("webglcontextlost",(function(t){return s.onContextLost(t)})),s._container.addEventListener("webglcontextrestored",(function(t){return s.onContextRestored(t)}))),s._stageIndex=i,s._stageManager=n,s._enableDepthAndStencil=!0,xt.setElementX(s._container,0),xt.setElementY(s._container,0),s._bufferFormatDictionary[1]=new Array(5),s._bufferFormatDictionary[1][1]=Ht.BYTE_1,s._bufferFormatDictionary[1][2]=Ht.BYTE_2,s._bufferFormatDictionary[1][3]=Ht.BYTE_3,s._bufferFormatDictionary[1][4]=Ht.BYTE_4,s._bufferFormatDictionary[2]=new Array(5),s._bufferFormatDictionary[2][1]=Ht.SHORT_1,s._bufferFormatDictionary[2][2]=Ht.SHORT_2,s._bufferFormatDictionary[2][3]=Ht.SHORT_3,s._bufferFormatDictionary[2][4]=Ht.SHORT_4,s._bufferFormatDictionary[4]=new Array(5),s._bufferFormatDictionary[4][1]=Ht.FLOAT_1,s._bufferFormatDictionary[4][2]=Ht.FLOAT_2,s._bufferFormatDictionary[4][3]=Ht.FLOAT_3,s._bufferFormatDictionary[4][4]=Ht.FLOAT_4,s._bufferFormatDictionary[5]=new Array(5),s._bufferFormatDictionary[5][1]=Ht.UNSIGNED_BYTE_1,s._bufferFormatDictionary[5][2]=Ht.UNSIGNED_BYTE_2,s._bufferFormatDictionary[5][3]=Ht.UNSIGNED_BYTE_3,s._bufferFormatDictionary[5][4]=Ht.UNSIGNED_BYTE_4,s._bufferFormatDictionary[6]=new Array(5),s._bufferFormatDictionary[6][1]=Ht.UNSIGNED_SHORT_1,s._bufferFormatDictionary[6][2]=Ht.UNSIGNED_SHORT_2,s._bufferFormatDictionary[6][3]=Ht.UNSIGNED_SHORT_3,s._bufferFormatDictionary[6][4]=Ht.UNSIGNED_SHORT_4,s.visible=!0,s}return i(e,t),Object.defineProperty(e.prototype,"glVersion",{get:function(){return this._context.glVersion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this._screenX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this._screenY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"touchPoints",{get:function(){return this._touchPoints},enumerable:!0,configurable:!0}),e.prototype.present=function(){this._context.present(),ke.executeAll()},e.prototype.getProgramData=function(t,e){return this._programDataPool.getItem(t,e)},e.prototype.setRenderTarget=function(t,e,i,n){if(void 0===e&&(e=!1),void 0===i&&(i=0),void 0===n&&(n=0),this._renderTarget!==t||i!==this._renderSurfaceSelector||n!==this._renderMipmapSelector||this._enableDepthAndStencil!==e)if(this._renderTarget=t,this._renderSurfaceSelector=i,this._renderMipmapSelector=n,this._enableDepthAndStencil=e,t){var r=t.getAbstraction(this),o="number"==typeof t.antialiasQuality?t.antialiasQuality:this._antiAlias;this._context.setRenderToTexture(r.getTexture(),e,o,i,n),0!=n&&1!=this._context.glVersion&&(r._invalidMipmaps=!1,r._mipmap=!0)}else this._context.setRenderToBackBuffer(),this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil)},e.prototype._initFilterElements=function(){this._filterVertexBuffer||(this._filterVertexBuffer=this._context.createVertexBuffer(4,20),this._filterVertexBuffer.uploadFromArray(new Float32Array([-1,-1,0,0,0,1,-1,1,0,1,1,1,1,1,2,-1,1,0,1,3]),0,4)),this._filterIndexBuffer||(this._filterIndexBuffer=this._context.createIndexBuffer(6),this._filterIndexBuffer.uploadFromArray(new Uint16Array([2,1,0,3,2,0]),0,6)),this._filterSampler||(this._filterSampler=new Ze(!1,!0,!1))},e.prototype.renderFilter=function(t,e){this._initFilterElements(),e.init(this._context),e.setRenderTargets(t,this);var i=this._filterIndexBuffer,n=e.tasks,r=n.length,o=this._context.hasVao,s=this._filterVertexBuffer,a=!1;(r>1||n[0].target)&&(this._context.setProgram(n[0].getProgram(this)),o&&!n[0].vao&&(n[0].vao||(n[0].vao=this._context.createVao(),a=!0)),n[0].vao&&n[0].vao.bind(),!a&&n[0].vao||(this._context.setVertexBufferAt(n[0]._positionIndex,s,0,Ht.FLOAT_2),this._context.setVertexBufferAt(n[0]._uvIndex,s,8,Ht.FLOAT_2)),a&&this._context.bindIndexBuffer(i));for(var l=0,u=n;l<u.length;l++){var c=u[l];this.setRenderTarget(c.target,!1),this.setScissor(null),this._context.setProgram(c.getProgram(this)),this._context.setDepthTest(!1,Nt.LESS_EQUAL),c.getMainInputTexture(this).getAbstraction(this).activate(c._inputTextureIndex,this._filterSampler),c.target||(o&&!c.vao&&(n[0].vao=this._context.createVao(),a=!0),c.vao&&c.vao.bind(),!a&&c.vao||(s=this._filterVertexBuffer,this._context.setVertexBufferAt(c._positionIndex,s,0,Ht.FLOAT_2),this._context.setVertexBufferAt(c._uvIndex,s,8,Ht.FLOAT_2)),a&&c.vao.attachIndexBuffer(i)),c.activate(this,null,null),this._context.drawIndices(Ft.TRIANGLES,i,0,6),c.deactivate(this)}o&&this._context._vaoContext.bindVertexArray(null),o||this._context.setVertexBufferAt(0,null),o||this._context.setVertexBufferAt(1,null)},e.prototype.copyPixels=function(t,e,i,n,r,o,s){if(void 0===s&&(s=!1),!(n.x<-i.width||n.x>e.width||n.y<-i.height||n.y>e.height))if(s)this._copyPixelFilter||(this._copyPixelFilter=new qi,this._copyPixelFilter.init(this._context)),this._copyPixelFilter.sourceTexture=t,this._copyPixelFilter.rect=i,this._copyPixelFilter.destPoint=n,this.renderFilter(e,this._copyPixelFilter);else{i=i.clone(),(n=n.clone()).x<0&&(i.x-=n.x,i.width+=n.x,n.x=0),n.y<0&&(i.y-=n.y,i.height+=n.y,n.y=0),i.width>e.width-n.x&&(i.width=e.width-n.x),i.height>e.height-n.y&&(i.height=e.height-n.y),this.setRenderTarget(t,!1),this.setScissor(null);var a=e.getAbstraction(this);this._context.copyToTexture(a.getTexture(),i,n)}},e.prototype.threshold=function(t,e,i,n,r,o,s,a,l){n.x<-i.width||n.x>e.width||n.y<-i.height||n.y>e.height||(this._thresholdFilter||(this._thresholdFilter=new Ki),this._thresholdFilter.sourceTexture=t,this._thresholdFilter.rect=i,this._thresholdFilter.destPoint=n,this._thresholdFilter.operation=r,this._thresholdFilter.threshold=o,this._thresholdFilter.color=s,this._thresholdFilter.mask=a,this._thresholdFilter.copySource=l,this.renderFilter(e,this._thresholdFilter))},e.prototype.colorTransform=function(t,e,i,n){this._copyPixelFilter||(this._copyPixelFilter=new qi,this._copyPixelFilter.init(this._context)),this._copyPixelFilter.sourceTexture=t,this._copyPixelFilter.rect=i,this._copyPixelFilter.destPoint=new D(0,0),this._copyPixelFilter.colorTransform=n,this.renderFilter(e,this._copyPixelFilter),this._copyPixelFilter.colorTransform=null},e.prototype.requestAbstraction=function(t){return e._abstractionClassPool[t.assetType]},e.registerAbstraction=function(t,i){e._abstractionClassPool[i.assetType]=t},e.prototype.requestContext=function(t,e,i,n){void 0===t&&(t=!1),void 0===e&&(e=Vt.BASELINE),void 0===i&&(i=qt.AUTO),void 0===n&&(n=!1),null!=this._usesSoftwareRendering&&(this._usesSoftwareRendering=t),this._profile=e;try{i==qt.SOFTWARE?this._context=new ci(this._container):i==qt.GLES?this._context=new Je(this._container):this._context=new Ri(this._container,n)}catch(t){this.dispatchEvent(new Re(Re.STAGE_ERROR,this))}this._context&&this._callback(this._context)},Object.defineProperty(e.prototype,"width",{get:function(){return this._sizeDirty=!1,this._width},set:function(t){this._width!=t&&(this._container.style.width=t+"px",this._container.width=t*this._context.pixelRatio,this._width=t,this._backBufferDirty=!0,this._invalidateSize())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._sizeDirty=!1,this._height},set:function(t){this._height!=t&&(this._container.style.height=t+"px",this._container.height=t*this._context.pixelRatio,this._height=t,this._backBufferDirty=!0,this._invalidateSize())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!=t&&(xt.setElementX(this._container,t),this._x=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!=t&&(xt.setElementY(this._container,t),this._y=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return xt.getElementVisibility(this._container)},set:function(t){xt.setElementVisibility(this._container,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},set:function(t){this._container=t,this._context&&(this._context.container=this._container)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),e.prototype._invalidateSize=function(){this._sizeDirty||(this._sizeDirty=!0,this.dispatchEvent(new Re(Re.INVALIDATE_SIZE,this)))},Object.defineProperty(e.prototype,"profile",{get:function(){return this._profile},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._stageManager.iRemoveStage(this),this.freeContext(),this._stageManager=null,this._stageIndex=-1,ke.clearAll()},e.prototype.configureBackBuffer=function(t,e,i,n){this.width=t,this.height=e,this._antiAlias=i,this._enableDepthAndStencil=n,this._context&&this._context.configureBackBuffer(t,e,i,n)},Object.defineProperty(e.prototype,"enableDepthAndStencil",{get:function(){return this._enableDepthAndStencil},set:function(t){this._enableDepthAndStencil!=t&&(this._enableDepthAndStencil=t,this._backBufferDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderSurfaceSelector",{get:function(){return this._renderSurfaceSelector},enumerable:!0,configurable:!0}),e.prototype.clear=function(t,e,i,n,r,o,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=0),void 0===s&&(s=Rt.ALL),this._context&&(this._backBufferDirty&&null==this._renderTarget&&(this._backBufferDirty=!1,this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil)),this._context.clear(t,e,i,n,r,o,s))},Object.defineProperty(e.prototype,"stageIndex",{get:function(){return this._stageIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usesSoftwareRendering",{get:function(){return this._usesSoftwareRendering},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antiAlias",{get:function(){return this._antiAlias},set:function(t){this._antiAlias!=t&&(this._antiAlias=t,this._backBufferDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t},enumerable:!0,configurable:!0}),e.prototype.registerProgram=function(t){for(var e=0;null!=this._programData[e];)e++;this._programData[e]=t,t.id=e},e.prototype.unRegisterProgram=function(t){this._programData[t.id]=null,t.id=-1},e.prototype.interactionHandler=function(t){var e=null!=t.clientX?t.clientX:t.changedTouches[0].clientX,i=null!=t.clientY?t.clientY:t.changedTouches[0].clientY,n=this._mapWindowToStage(e,i,Wi);if(this._screenX=n.x,this._screenY=n.y,this._touchPoints.length=0,t.touches)for(var r=void 0,o=t.touches.length,s=0;s<o;s++)r=t.touches[s],n=this._mapWindowToStage(r.clientX,r.clientY,Wi),this._touchPoints.push(new Oe(n.x,n.y,r.identifier))},e.prototype._mapWindowToStage=function(t,e,i){var n;void 0===i&&(i={x:0,y:0});var r=this.container;return n=r.parentElement?r.getBoundingClientRect():{x:0,y:0,width:0,height:0},i.x=(t-n.left)*r.clientWidth/n.width,i.y=(e-n.top)*r.clientHeight/n.height,i},e.prototype.freeContext=function(){this._context&&(this._context.dispose(),this.dispatchEvent(new Re(Re.CONTEXT_DISPOSED,this))),this._context=null,this._initialised=!1},e.prototype.onContextLost=function(t){},e.prototype.onContextRestored=function(t){},e.prototype.recoverFromDisposal=function(){return!!this._context},e.prototype._callback=function(t){var e=t._gl;on.MAX_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE),this._context=t,this._container=this._context.container,this._width&&this._height&&this._context.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil),this.dispatchEvent(new Re(this._initialised?Re.CONTEXT_RECREATED:Re.CONTEXT_CREATED,this)),this._initialised=!0},e.prototype.setVertexBuffer=function(t,e,i,n,r,o){void 0===o&&(o=!1),this._context.setVertexBufferAt(t,e,r,this._bufferFormatDictionary[o?i+4:i][n])},e.prototype.setScissor=function(t){this._backBufferDirty&&null==this._renderTarget&&(this._backBufferDirty=!1,this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil)),this._context.setScissorRectangle(t)},e.prototype.setSamplerAt=function(t,e){var i=e.repeat?Xt.REPEAT:Xt.CLAMP,n=e.smooth&&!this.globalDisableSmooth?Gt.LINEAR:Gt.NEAREST,r=e.mipmap&&!this.globalDisableMipmap?kt.MIPLINEAR:kt.MIPNONE;this._context.setSamplerStateAt(t,i,n,r)},e._abstractionClassPool={},e}(u),Zi=function(t){function e(e){var i=t.call(this)||this;return i._size=e,i._testDimensions(),i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size!=t&&this._setSize(this._size)},enumerable:!0,configurable:!0}),e.prototype._setSize=function(t){this._size!=t&&this.clear(),this._size=t,this._testDimensions()},e.prototype._testDimensions=function(){if(!on.isDimensionValid(this._size))throw new Error("Invalid dimension: Width and height must be power of 2 and cannot exceed 2048")},e.assetType="[image ImageCube]",e}(Ue),$i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getType=function(){return"cube"},e.prototype._createTexture=function(){this._texture=this._stage.context.createCubeTexture(this._asset.size,Qt.BGRA,!1)},e}(je);Ji.registerAbstraction($i,Zi);var tn=function(){function t(){}return t.drawBitmap=function(e,i,n,r,o,s,a,l,u,c,h){if(void 0===h&&(h=null),h||u!=r||c!=o){h||(h=new T).scale(u/r,c/o);var p=Math.sqrt(h.a*h.a+h.b*h.b),d=Math.sqrt(h.c*h.c+h.d*h.d),f=r*p,_=o*d;if(h.tx+=a,h.ty+=l,a=Math.floor(h.tx),l=Math.floor(h.ty),h.invert(),p>=1||d>=1)for(var m=new D,g=a;g<a+f;g++)for(var y=l;y<l+_;y++){m.x=g,m.y=y,m=h.transformPoint(m);var A=t.sampleBilinear(m.x,m.y,e,r,o);t.applyPixel32(s,u,c,g,y,A)}else{var v=new D,b=new D;for(g=a;g<a+f;g++)for(y=l;y<l+_;y++){v.x=g,v.y=y,v=h.transformPoint(v),b.x=g+1,b.y=y+1,b=h.transformPoint(b);A=t.sampleBox(v.x+i,v.y+n,b.x+i,b.y+n,e,r,o);t.applyPixel32(s,u,c,g,y,A)}}h.invert()}else for(g=a;g<a+r;g++)for(y=l;y<l+o;y++){A=t.sample(g-a+i,y-l+n,e,r,o);t.applyPixel32(s,u,c,g,y,A)}},t.applyPixel32=function(t,e,i,n,r,o){if(n=Math.floor(n),r=Math.floor(r),!(n<0||n>=e||r>=i||r<0)){var s=4*(n+r*e);t[s]=o[0],t[s+1]=o[1],t[s+2]=o[2],t[s+3]=o[3],t[s]=255&t[s],t[s+1]=255&t[s+1],t[s+2]=255&t[s+2],t[s+3]=255&t[s+3]}},t.sampleBilinear=function(e,i,n,r,o,s,a){void 0===s&&(s=1),void 0===a&&(a=1);var l=t.sample(e,i,n,r,o),u=t.sample(e+s,i,n,r,o),c=t.sample(e,i+a,n,r,o),h=t.sample(e+s,i+a,n,r,o),p=e;p-=Math.floor(p);var d=t.interpolateColor(l,u,p),f=t.interpolateColor(c,h,p),_=i;return _-=Math.floor(_),t.interpolateColor(d,f,_)},t.sample=function(t,e,i,n,r){t=Math.floor(t),e=Math.floor(e);var o=[0,0,0,0];if(t<0||t>=n||e<0||e>=r)return o;var s=4*(t+e*n);return o[0]=i[s],o[1]=i[s+1],o[2]=i[s+2],o[3]=i[s+3],o},t.sampleBox=function(e,i,n,r,o,s,a){var l,u,c,h,p=0,d=[0,0,0,0],f=Math.floor(i),_=Math.ceil(r);for(f=Math.max(Math.min(f,a-1),0),_=Math.max(Math.min(_,a-1),0),u=f;u<_;u++){h=1,u<i&&(h*=1-(i-u)),u>r&&(h*=1-(u-r));var m=Math.floor(e),g=Math.ceil(n);for(m=Math.max(Math.min(m,s-1),0),g=Math.max(Math.min(g,s-1),0),l=m;l<g;l++){c=h;var y=t.sample(l,u,o,s,a);l<e&&(c*=1-(e-l)),l>n&&(c*=1-(l-n)),d[0]+=y[0]*c,d[1]+=y[1]*c,d[2]+=y[2]*c,d[3]+=y[3]*c,p+=c}}return d[0]/=p,d[1]/=p,d[2]/=p,d[3]/=p,d[0]=255&d[0],d[1]=255&d[1],d[2]=255&d[2],d[3]=255&d[3],d},t.interpolateColor=function(t,e,i){var n=[];return n[0]=t[0]+(e[0]-t[0])*i,n[1]=t[1]+(e[1]-t[1])*i,n[2]=t[2]+(e[2]-t[2])*i,n[3]=t[3]+(e[3]-t[3])*i,n},t}(),en=function(t){function e(e,i,n){void 0===i&&(i=!0),void 0===n&&(n=null);var r=t.call(this,e)||this;r._data=new Array(6),r._locked=!1,r._transparent=i;for(var o=0;o<6;o++)r._data[o]=new Uint8ClampedArray(4*r._size*r._size),null!=n&&r.fillRect(o,new Y(0,0,e,e),n);return r}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transparent",{get:function(){return this._transparent},set:function(t){this._transparent=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){for(var t=new e(this._size,this.transparent),i=0;i<6;i++)t.setPixels(i,new Y(0,0,this._size,this._size),this.data[i]);return t},e.prototype.colorTransform=function(t,e,i){var n,r,o,s=this.data[t];for(n=0;n<e.width;++n)for(r=0;r<e.height;++r)s[o=4*(n+e.x+(r+e.y)*this._size)]=s[o]*i.redMultiplier+i.redOffset,s[o+1]=s[o+1]*i.greenMultiplier+i.greenOffset,s[o+2]=s[o+2]*i.blueMultiplier+i.blueOffset,s[o+3]=s[o+3]*i.alphaMultiplier+i.alphaOffset;this._locked||this.invalidate()},e.prototype.copyChannel=function(t,e,i,n,r,o){var s,a,l,u=e.data,c=this._data[t],h=Math.round(Math.log(r)/Math.log(2)),p=Math.round(Math.log(o)/Math.log(2)),d=Math.round(i.x),f=Math.round(i.y),_=Math.round(n.x),m=Math.round(n.y);for(s=0;s<i.width;++s)for(a=0;a<i.height;++a)l=4*(s+d+(a+f)*e.width),c[4*(s+_+(a+m)*this._size)+p]=u[l+h];this._locked||this.invalidate()},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0;e<6;e++)this._data[e]=null;this._transparent=null,this._locked=null},e.prototype.drawBitmap=function(t,e,i,n,r,o,s){void 0===s&&(s=null),tn.drawBitmap(e,i,n,r,o,this.data[t],0,0,this._size,this._size,s),this._locked||this.invalidate()},e.prototype.fillRect=function(t,e,i){var n=new Uint32Array(this._data[t].buffer),r=~~e.x,o=~~e.y,s=~~e.width,a=~~e.height,l=this._transparent?4294967295&i:4278190080+(16777215&i);if(0==r&&0==o&&s==this._size&&a==this._size)n.fill(l);else{var u=void 0,c=void 0;for(u=0;u<a;++u)c=r+(u+o)*this._size,n.fill(l,c,c+s)}this._locked||this.invalidate()},e.prototype.getPixel=function(t,e,i){var n,r,o,s,a=4*(~~e+~~i*this._size),l=this.data[t];return n=l[a+0],r=l[a+1],o=l[a+2],(s=l[a+3])?255*n/s<<16|255*r/s<<8|255*o/s:0},e.prototype.getPixel32=function(t,e,i){var n,r,o,s,a=4*(~~e+~~i*this._size),l=this.data[t];return n=l[a++],r=l[a++],o=l[a++],(s=l[a])?s<<24|255*n/s<<16|255*r/s<<8|255*o/s:0},e.prototype.lock=function(){this._locked||(this._locked=!0)},e.prototype.setArray=function(t,e,i){var n,r,o,s,a=this.data[t];for(n=0;n<e.width;++n)for(r=0;r<e.height;++r)s=w.float32ColorToARGB(i[n+r*e.width]),a[(o=4*(n+e.x+(r+e.y)*this._size))+0]=s[1],a[o+1]=s[2],a[o+2]=s[3],a[o+3]=this._transparent?s[0]:255;this._locked||this.invalidate()},e.prototype.setPixel=function(t,e,i,n){var r=4*(~~e+~~i*this._size),o=w.float32ColorToARGB(n),s=this.data[t];s[r+0]=o[1],s[r+1]=o[2],s[r+2]=o[3],s[r+3]=255,this._locked||this.invalidate()},e.prototype.setPixel32=function(t,e,i,n){var r=4*(~~e+~~i*this._size),o=w.float32ColorToARGB(n),s=this.data[t];s[r+0]=o[1],s[r+1]=o[2],s[r+2]=o[3],s[r+3]=this._transparent?o[0]:255,this._locked||this.invalidate()},e.prototype.setPixels=function(t,e,i){if(0==e.x&&0==e.y&&e.width==this._size&&e.height==this._size)this._data[t].set(i);else{var n=void 0,r=this._size,o=e.width,s=this._data[t];for(n=0;n<e.height;++n)s.set(i.subarray(n*o*4,(n+1)*o*4),4*(e.x+(n+e.y)*r))}this._locked||this.invalidate()},e.prototype.unlock=function(){this._locked&&(this._locked=!1,this.invalidate())},Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype._setSize=function(e){for(var i=0;i<6;i++){var n=this.data[i];this._data[i]=new Uint8ClampedArray(4*e*e);for(var r=this._size<e?this._size:e;0<r;++i)this._data[i].set(n.subarray(0*r*4,1*r*4),0*e*4)}t.prototype._setSize.call(this,e)},e.assetType="[image BitmapImageCube]",e.posX=0,e.negX=1,e.posY=2,e.negY=3,e.posZ=4,e.negZ=5,e}(Zi),nn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getTexture=function(){if(t.prototype.getTexture.call(this),this._invalid){this._invalid=!1;for(var e=0;e<6;++e)this._texture.uploadFromArray(new Uint8Array(this._asset.data[e].buffer),e,0,this._asset.transparent);this._invalidMipmaps=!0}return this._texture},e}($i);Ji.registerAbstraction(nn,en);var rn=function(){function t(){}return t.prototype.createImage2D=function(t,e,i,n,r){return void 0===i&&(i=!0),void 0===n&&(n=null),void 0===r&&(r=!0),new hn(t,e,i,n,r)},t}(),on=function(){function t(){}return t.getImageBuffer=function(t){var e=this.CANVAS||(this.CANVAS=document.createElement("canvas")),i=e.getContext("2d");return t instanceof HTMLImageElement?(e.width=t.naturalWidth,e.height=t.naturalHeight):(e.width=t.width,e.height=t.height),i.drawImage(t,0,0),i.getImageData(0,0,e.width,e.height).data},t.imageToBitmapImage2D=function(e,i,n){var r,o;void 0===i&&(i=!0),void 0===n&&(n=null),n||(n=new rn),e instanceof HTMLImageElement?(r=e.naturalWidth,o=e.naturalHeight):(r=e.width,o=e.height);var s=n.createImage2D(r,o,!0,null,i);return s.addLazySymbol({needParse:!0,definition:{width:r,height:o,isPMA:!0,data:null},lazyParser:function(){return this.needParse=!1,this.definition.data=t.getImageBuffer(e),this.lazyParser=null,this}}),s},t.isImage2DValid=function(t){return null==t||this.isDimensionValid(t.width,t.powerOfTwo)&&this.isDimensionValid(t.height,t.powerOfTwo)},t.isHTMLImageElementValid=function(t){return null==t||this.isDimensionValid(t.width)&&this.isDimensionValid(t.height)},t.isDimensionValid=function(t,e){return void 0===e&&(e=!0),t>=1&&t<=this.MAX_SIZE&&(!e||this.isPowerOfTwo(t))},t.isPowerOfTwo=function(t){return!!t&&(t&-t)==t},t.getBestPowerOf2=function(t){for(var e=1;e<t;)e<<=1;return e>this.MAX_SIZE&&(e=this.MAX_SIZE),e},t.getDefaultImage2D=function(){return this._defaultBitmapImage2D||this.createDefaultImage2D(),this._defaultBitmapImage2D},t.getDefaultImageCube=function(){return this._defaultBitmapImageCube||this.createDefaultImageCube(),this._defaultBitmapImageCube},t.getDefaultSampler=function(){return this._defaultSampler||this.createDefaultSampler(),this._defaultSampler},t.createDefaultImageCube=function(){this._defaultBitmapImage2D||this.createDefaultImage2D();for(var t=new en(this._defaultBitmapImage2D.width),e=0;e<6;e++)t.drawBitmap(e,this._defaultBitmapImage2D.data,0,0,this._defaultBitmapImage2D.width,this._defaultBitmapImage2D.height);this._defaultBitmapImageCube=t},t.createDefaultImage2D=function(){var t,e,i=new hn(8,8,!1,0);for(t=0;t<8;t++)for(e=0;e<8;e++)1&e^1&t&&i.setPixel(t,e,16777215);this._defaultBitmapImage2D=i},t.createDefaultSampler=function(){this._defaultSampler=new Ze},t.MAX_SIZE=8192,t}(),sn=function(t){function e(e,i,n){void 0===n&&(n=!0);var r=t.call(this)||this;return r._powerOfTwo=!0,r._rect=new Y(0,0,Math.round(e),Math.round(i)),r._powerOfTwo=n,r._testDimensions(),r}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._rect.height},set:function(t){this._setSize(this._rect.width,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphaChannel",{get:function(){return this._alphaChannel},set:function(t){this._alphaChannel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rect",{get:function(){return this._rect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._rect.width},set:function(t){this._setSize(t,this._rect.height)},enumerable:!0,configurable:!0}),e.prototype._setSize=function(t,e){t=Math.round(t),e=Math.round(e),this._rect.width==t&&this._rect.height==e||(this.clear(),this._rect.width=t,this._rect.height=e,this._testDimensions())},e.prototype._testDimensions=function(){if(this._powerOfTwo&&(!on.isDimensionValid(this._rect.width)||!on.isDimensionValid(this._rect.height)))throw new Error("Invalid dimension: Width and height must be power of 2 and cannot exceed 2048")},Object.defineProperty(e.prototype,"powerOfTwo",{get:function(){return this._powerOfTwo},set:function(t){this._powerOfTwo!=t&&(this._powerOfTwo=t,this._testDimensions())},enumerable:!0,configurable:!0}),e.assetType="[image Image2D]",e}(Ue),an=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getType=function(){return"2d"},e.prototype._createTexture=function(){this._texture=this._stage.context.createTexture(this._asset.width,this._asset.height,Qt.BGRA,!0)},e}(je);Ji.registerAbstraction(an,sn);var ln="WeakRef"in window,un=!1;function cn(t,e){return void 0===e&&(e=!0),((e?4278190080&t:4278190080)|(255&t)<<16|65280&t|(16711680&t)>>16&255)>>>0}var hn=function(t){function e(i,n,r,o,s,a){void 0===r&&(r=!0),void 0===o&&(o=null),void 0===s&&(s=!0),void 0===a&&(a=null);var l=t.call(this,i,n,s)||this;return l._isSymbolSource=!1,l._isWeakRef=!1,l._unpackPMA=!0,l._locked=!1,l._floodStack=[],l._nestedBitmap=[],l.wasUpload=!1,l._needUpload=!1,l.isUnloaded=!1,l.lastUsedTime=0,a&&e.getManager(a),l._transparent=r,l._stage=a,null!=o&&l.fillRect(l._rect,o),l}return i(e,t),e.getManager=function(t){if(!t)return null;if(this._unloadManager)return this._unloadManager;var e=t.context.hasFence;return this._unloadManager=ke.createManager({name:"BitmapImage2D"+(e?"async":""),priority:0,maxUnloadTasks:e?gi:mi,exectionPeriod:100}),this._unloadManager},e.prototype.getDataInternal=function(t,e){if(void 0===t&&(t=!0),this.applySymbol(),this._data||!t&&!this._alphaChannel||(this._data=new Uint8ClampedArray(this.width*this.height*4)),this._alphaChannel){for(var i=this._alphaChannel,n=0;n<i.length;n++)this._data[4*n+3]=i[n];this._alphaChannel=null}return this._data},Object.defineProperty(e.prototype,"sourceBitmap",{get:function(){return this._sourceBitmap},enumerable:!0,configurable:!0}),e.prototype.invalidateGPU=function(){this._needUpload=!0,this.invalidate()},e.prototype.invalidate=function(){this._needUpload&&(this._locked||(this._needUpload=!1,t.prototype.invalidate.call(this)))},Object.defineProperty(e.prototype,"canUnload",{get:function(){return!(this._sourceBitmap||this._nestedBitmap.length||this._locked||this._isSymbolSource)},enumerable:!0,configurable:!0}),e.prototype.unmarkToUnload=function(){var t;null===(t=e.getManager(this._stage))||void 0===t||t.removeTask(this)},e.prototype.markToUnload=function(){e.getManager(this._stage)&&(this._isSymbolSource||(this.lastUsedTime=e._unloadManager.correctedTime,e._unloadManager.addTask(this)))},e.prototype.unload=function(){this.lastUsedTime=-1,this.dispatchEvent(new l(e.UNLOAD_EVENT,this)),this.invalidateGPU()},e.prototype.addMipLevel=function(t){this._customMipLevels||(this._customMipLevels=[]),this._customMipLevels.push(t)},Object.defineProperty(e.prototype,"mipLevels",{get:function(){return this._customMipLevels},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transparent",{get:function(){return this._transparent},set:function(t){this._transparent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unpackPMA",{get:function(){return this._unpackPMA&&this._transparent},enumerable:!0,configurable:!0}),e.prototype.addLazySymbol=function(t){this._lazySymbol=t,this._isSymbolSource=!0,this.invalidateGPU()},e.prototype.applySymbol=function(){return!(!this._lazySymbol||!this._lazySymbol.needParse)&&(this._lazySymbol.lazyParser(),this._data=this._lazySymbol.definition.data,this._unpackPMA=!this._lazySymbol.definition.isPMA,this._lazySymbol=null,!0)},e.prototype.useWeakRef=function(){un||(un=!0,(ln=ln&&_i)&&console.debug("[ImageBitmap2D Experemental] Use WeakRef for ImageBitmap2D")),ln&&!this._isWeakRef&&(this._isWeakRef=!0,this._finalizer||(this._finalizer=new FinalizationRegistry(this.onAdapterDropped.bind(this))),this.adapter=this._adapter)},e.prototype.unuseWeakRef=function(){this._isWeakRef&&(this._isWeakRef=!1,this._finalizer.unregister(this),this._weakRefAdapter=null,this.adapter=this._adapter)},Object.defineProperty(e.prototype,"isWeakRef",{get:function(){return this._isWeakRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adapter",{get:function(){return(this._weakRefAdapter?this._weakRefAdapter.deref():this._adapter)||this},set:function(t){this._isWeakRef?(this._finalizer.unregister(this),t?(this._weakRefAdapter=new WeakRef(t),this._finalizer.register(t,this.id,this)):this._weakRefAdapter=null,this._adapter=null):this._adapter=t},enumerable:!0,configurable:!0}),e.prototype.onAdapterDropped=function(t){console.debug("[ImageBitmap2D Experemental] Disposing adaptee, GC runs for:",t),this.dispose()},e.prototype.addNestedReference=function(t){this._sourceBitmap?this._sourceBitmap.addNestedReference(t):(this._nestedBitmap.push(t),t._sourceBitmap=this)},e.prototype.dropNestedReference=function(t){var e=this._nestedBitmap.indexOf(t);return e>-1&&!!this._nestedBitmap.splice(e,1)},e.prototype.dropAllReferences=function(t){if(void 0===t&&(t=!0),this._nestedBitmap.length){for(var e=0,i=this._nestedBitmap;e<i.length;e++){i[e].dropAllReferences(!1)}this._nestedBitmap.length=0}if(this._sourceBitmap){var n=this._sourceBitmap;this._sourceBitmap=null,t&&n.dropNestedReference(this),this.deepClone(n)}},e.prototype.deepClone=function(t){this.setPixels(this._rect,t.data),this.invalidateGPU()},e.prototype.copyTo=function(t){return this.addNestedReference(t),t},e.prototype.clone=function(){var t=new e(this._rect.width,this._rect.height,this._transparent,null,this._powerOfTwo);return this.addNestedReference(t),t},e.prototype.colorTransform=function(t,e){var i,n,r;this.dropAllReferences();var o=this.data;for(i=0;i<t.width;++i)for(n=0;n<t.height;++n)o[r=4*(i+t.x+(n+t.y)*this._rect.width)]=o[r]*e.redMultiplier+e.redOffset,o[r+1]=o[r+1]*e.greenMultiplier+e.greenOffset,o[r+2]=o[r+2]*e.blueMultiplier+e.blueOffset,o[r+3]=o[r+3]*e.alphaMultiplier+e.alphaOffset;this.invalidateGPU()},e.prototype.copyChannel=function(t,e,i,n,r){this.dropAllReferences();var o,s,a,l=t.data,u=this.data,c=Math.round(Math.log(n)/Math.log(2)),h=Math.round(Math.log(r)/Math.log(2)),p=Math.round(e.x),d=Math.round(e.y),f=Math.round(i.x),_=Math.round(i.y);for(o=0;o<e.width;++o)for(s=0;s<e.height;++s)a=4*(o+p+(s+d)*t.width),u[4*(o+f+(s+_)*this._rect.width)+h]=l[a+c];this.invalidateGPU()},e.prototype.merge=function(t,e,i,n,r,o,s){this.dropAllReferences();var a,l,u,c=this.getDataInternal(!0),h=t.data;for(n=~~n,r=~~r,o=~~o,s=~~s,a=0;a<e.width;++a)for(l=0;l<e.height;++l)c[u=4*(a+e.x+(l+e.y)*this.width)]=~~((h[u]*n+c[u]*(256-n))/256),c[u+1]=~~((h[u+1]*r+c[u+1]*(256-r))/256),c[u+2]=~~((h[u+2]*o+c[u+2]*(256-o))/256),c[u+3]=~~((h[u+3]*s+c[u+3]*(256-s))/256);this.invalidateGPU()},e.prototype.dispose=function(){var t;null===(t=e.getManager(this._stage))||void 0===t||t.removeTask(this),this._isWeakRef&&this._finalizer.unregister(this),this.dropAllReferences(),this.clear(),this._data=null,this._rect=null,this._transparent=null,this._locked=null},e.prototype.getColorBoundsRect=function(t,e,i){void 0===i&&(i=!0);var n=new Uint32Array(this.getDataInternal(!0).buffer),r=this.rect;e=cn(e,this._transparent),t=cn(t,this._transparent);for(var o=r.width,s=r.height,a=0,l=0,u=!1,c=0;c<r.height;c++)for(var h=0;h<r.width;h++){var p=n[c*r.width+h];((p=(p&t)>>>0)===e&&i||p!==e&&!i)&&(u=!0,o=h<o?h:o,a=h>a?h:a,s=c<s?c:s,l=c>l?c:l)}return u?new Y(o,s,a-o+1,l-s+1):new Y(0,0,0,0)},e.prototype.floodFill=function(t,e,i){this.dropAllReferences(),t|=0,e|=0;var n=new Uint32Array(this.getDataInternal(!0).buffer),r=this._rect.width,o=this._rect.height,s=this._floodStack;s.length=r*o*2;var a,l,u=n[t+e*r],c=w.float32ColorToARGB(i),h=c[0],p=c[1],d=c[2],f=c[3],_=((h=this._transparent?h:255)<<24|(f=f*h/255|0)<<16|(d=d*h/255|0)<<8|(p=p*h/255|0))>>>0,m=0,g=0;for(s[g++]=t,s[g++]=e;g>0;){for(e=s[--g],m=t=s[--g];m>=0&&n[e*r+m]===u;)m--;for(m++,a=l=!1;m<r&&n[e*r+m]===u;)n[e*r+m]=_,!a&&e>0&&n[(e-1)*r+m]===u?(s[g++]=m,s[g++]=e-1,a=!0):a&&e>0&&n[(e-1)*r+m]!==u&&(a=!1),!l&&e<o-1&&n[(e+1)*r+m]===u?(s[g++]=m,s[g++]=e+1,l=!0):l&&e<o-1&&n[(e+1)*r+m]!==u&&(l=!1),m++}this.invalidateGPU()},e.prototype.drawBitmap=function(t,e,i,n,r,o){void 0===o&&(o=null),this.dropAllReferences(),tn.drawBitmap(t,e,i,n,r,this.data,0,0,this._rect.width,this._rect.height,o),this.invalidateGPU()},e.prototype.fillRect=function(t,e){if(this.dropAllReferences(),!this._data)try{this._data=new Uint8ClampedArray(this.width*this.height*4)}catch(t){console.error(this.width,this.height)}var i=~~t.x,n=~~t.y,r=~~t.width,o=~~t.height,s=new Uint32Array(this._data.buffer),a=0;if(this._transparent){var l=w.float32ColorToARGB(e),u=l[0],c=l[1],h=l[2],p=l[3];a=w.ARGBtoFloat32(u,p*u/255|0,h*u/255|0,c*u/255|0)>>>0,this._unpackPMA=!1}else a=cn(16777215&e,!1);if(0==i&&0==n&&r==this._rect.width&&o==this._rect.height)s.fill(a);else{var d=void 0,f=void 0;for(d=0;d<o;++d)f=i+(d+n)*this._rect.width,s.fill(a,f,f+r)}this.invalidateGPU()},e.prototype.getPixel=function(t,e){if(!this._rect.contains(t,e))return 0;var i=4*(~~t+~~e*this._rect.width),n=this._data,r=n[i+0],o=n[i+1],s=n[i+2],a=n[i+3];return a?255*r/a<<16|255*o/a<<8|255*s/a:0},e.prototype.getPixel32=function(t,e){if(!this._rect.contains(t,e))return 0;var i=4*(~~t+~~e*this._rect.width),n=this._data,r=n[i++],o=n[i++],s=n[i++],a=n[i];return a?(a<<24|255*r/a<<16|255*o/a<<8|255*s/a)>>>0:0},e.prototype.getPixels=function(t){if(t.equals(this._rect))return this.getDataInternal(!0,!1);for(var e,i=this.getDataInternal(!0,!1),n=new Uint8ClampedArray(t.width*t.height*4),r=0|t.x,o=0|t.y,s=0|t.width,a=0|t.height,l=0;l<a;++l)e=r+(l+o)*this._rect.width,n.set(i.subarray(4*e,4*(e+s)),l*s*4);return n},e.prototype.getPixelData=function(t,e,i){var n=4*(t+e*this._rect.width),r=this.getDataInternal(!0);i[0]=r[n++],i[1]=r[n++],i[2]=r[n++],i[3]=r[n]},e.prototype.setPixelData=function(t,e,i){this.dropAllReferences();var n=4*(t+e*this._rect.width),r=this.getDataInternal(!0);r[n+0]=i[0],r[n+1]=i[1],r[n+2]=i[2],r[n+3]=this._transparent?i[3]:255,this.invalidateGPU()},e.prototype.lock=function(){this._locked||(this._locked=!0)},e.prototype.setArray=function(t,e){var i,n,r,o;this.dropAllReferences();var s=this.getDataInternal(!0);for(i=0;i<t.width;++i)for(n=0;n<t.height;++n)o=w.float32ColorToARGB(e[i+n*t.width]),s[(r=4*(i+t.x+(n+t.y)*this._rect.width))+0]=o[1],s[r+1]=o[2],s[r+2]=o[3],s[r+3]=this._transparent?o[0]:255;this.invalidateGPU()},e.prototype.setPixel=function(t,e,i){if(this._rect.contains(t,e)){this.dropAllReferences();var n=4*(~~t+~~e*this._rect.width),r=w.float32ColorToARGB(i),o=this.getDataInternal(!0);o[n+0]=r[1],o[n+1]=r[2],o[n+2]=r[3],o[n+3]=255,this.invalidateGPU()}},e.prototype.setPixelFromArray=function(t,e,i){this.dropAllReferences();var n=4*(t+e*this._rect.width),r=this.getDataInternal(!0);r[n+0]=i[1]*i[0]|0,r[n+1]=i[2]*i[0]|0,r[n+2]=i[3]*i[0]|0,r[n+3]=255*i[0]|0,this._unpackPMA=!1,this.invalidateGPU()},e.prototype.setPixel32=function(t,e,i){if(this._rect.contains(t,e)){this.dropAllReferences();var n=4*(~~t+~~e*this._rect.width),r=w.float32ColorToARGB(i),o=this.getDataInternal(!0),s=this._transparent?r[0]/255:1;o[n+0]=r[1]*s|0,o[n+1]=r[2]*s|0,o[n+2]=r[3]*s|0,o[n+3]=this._transparent?r[0]:255,this.invalidateGPU()}},e.prototype.setPixels=function(t,e){this.dropAllReferences();var i=this.getDataInternal(!0);if(t.equals(this._rect))i.set(e),this._unpackPMA=!0;else{for(var n=this._rect.width,r=t.width,o=0;o<t.height;++o)i.set(e.subarray(o*r*4,(o+1)*r*4),4*(t.x+(o+t.y)*n));console.warn("[BitmapImage2D] Mixed texture mode - array should be a PMA.",this.id)}this.invalidateGPU()},e.prototype.unlock=function(){this._locked&&(this._locked=!1,this.invalidate())},Object.defineProperty(e.prototype,"alphaChannel",{set:function(t){if(this.dropAllReferences(),t){if(t.length!==this.width*this.height)throw"error when trying to merge the alpha channel into the image.the length of the alpha channel should be 1/4 of the length of the imageData";if(this._data&&this.wasUpload){for(var e=this._alphaChannel,i=0;i<e.length;i++)this._data[4*i+3]=e[i];return this._unpackPMA=!1,void this.invalidateGPU()}this._alphaChannel=t,this._unpackPMA=!1}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.getDataInternal(!0)},enumerable:!0,configurable:!0}),e.prototype._setSize=function(e,i){this.dropAllReferences();var n=this.data;this._data=new Uint8ClampedArray(4*e*i);for(var r=this._rect.width<e?this._rect.width:e,o=this._rect.height<i?this._rect.height:i,s=0;s<o;++s)this._data.set(n.subarray(s*r*4,(s+1)*r*4),s*e*4);t.prototype._setSize.call(this,e,i)},e.UNLOAD_EVENT="unload",e.assetType="[image BitmapImage2D]",e}(sn),pn=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.onUnload=function(){n._texture&&(n._texture.dispose(),n._texture=null,n._invalid=!0,n._asset.wasUpload=!1)},n._asset.addEventListener(hn.UNLOAD_EVENT,n.onUnload),n}return i(e,t),e.prototype.onClear=function(e){this._asset.removeEventListener(hn.UNLOAD_EVENT,this.onUnload),t.prototype.onClear.call(this,e)},e.prototype.getTexture=function(){var e=this._asset,i=e.sourceBitmap;if(i)return i.getAbstraction(this._stage).getTexture();e.markToUnload(),t.prototype.getTexture.call(this);var n=e.getDataInternal(!1,!0),r=this._texture;if(this._invalid&&n){r.uploadFromArray(new Uint8Array(n.buffer),0,e.unpackPMA),e.wasUpload=!0;var o=e.mipLevels;if(o&&o.length>0){for(var s=0;s<o.length;s++)r.uploadFromArray(new Uint8Array(o[s].data.buffer),s+1,e.transparent);this._mipmap=!0,this._invalidMipmaps=!1}else this._invalidMipmaps=!0}return this._invalid=!1,this._texture},e}(an);Ji.registerAbstraction(pn,hn);var dn=function(){function t(){}return t.ALPHA=8,t.BLUE=4,t.GREEN=2,t.RED=1,t}(),fn=function(){function t(){}return t.ADD="add",t.ALPHA="alpha",t.DARKEN="darken",t.DIFFERENCE="difference",t.ERASE="erase",t.HARDLIGHT="hardlight",t.INVERT="invert",t.LAYER="layer",t.LIGHTEN="lighten",t.MULTIPLY="multiply",t.NORMAL="normal",t.OVERLAY="overlay",t.SCREEN="screen",t.SHADER="shader",t.SUBTRACT="subtract",t}(),_n=function(t){function e(e){var i=t.call(this,8,8,!0)||this;return i._urlRequest=e,i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"urlRequest",{get:function(){return this._urlRequest},set:function(t){this._urlRequest=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._urlRequest)},e.assetType="[image ExternalImage2D]",e}(sn),mn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getTexture=function(){return t.prototype.getTexture.call(this),this._invalid&&(this._invalid=!1,this._texture.uploadFromURL(this._asset.urlRequest,0),this._invalidMipmaps=!0),this._texture},e}(an);Ji.registerAbstraction(mn,_n);var gn=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this,1,1)||this;return n._specularSource=e,n._glossSource=i,n._output=new hn(1,1,!1,16777215),n._testSize(),n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specularSource",{get:function(){return this._specularSource},set:function(t){this._specularSource!=t&&(this._specularSource=t,this.invalidate(),this._testSize())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glossSource",{get:function(){return this._glossSource},set:function(t){this._glossSource!=t&&(this._glossSource=t,this.invalidate(),this._testSize())},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._specularSource,this._glossSource)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._rect=null,this._output.dispose()},Object.defineProperty(e.prototype,"data",{get:function(){var t=new D;return this._output.fillRect(this._rect,16777215),this._glossSource&&this._output.copyChannel(this._glossSource,this._rect,t,dn.GREEN,dn.GREEN),this._specularSource&&this._output.copyChannel(this._specularSource,this._rect,t,dn.RED,dn.RED),this._output.data},enumerable:!0,configurable:!0}),e.prototype._setSize=function(e,i){t.prototype._setSize.call(this,e,i),this._output._setSize(e,i)},e.prototype._testSize=function(){var t,e;this._specularSource?(t=this._specularSource.width,e=this._specularSource.height):this._glossSource?(t=this._glossSource.width,e=this._glossSource.height):(t=1,e=1),t!=this._output.width&&e!=this._output.height&&(this._output.dispose(),this._output=new hn(t,e,!1,16777215)),this._setSize(t,e)},e.assetType="[asset SpecularImage2D]",e}(sn);Ji.registerAbstraction(pn,gn);var yn=function(t){function e(e,i){void 0===i&&(i=1);var n=t.call(this)||this;return n._data=new Float32Array([i,.5,2,-1,0,0,0,0]),n._blendMode=e,n}return i(e,t),Object.defineProperty(e.prototype,"overlayTexture",{get:function(){return this._overlayTexture},set:function(t){this._overlayTexture=t,this._overlayWidth=this._overlayTexture.width,this._overlayHeight=this._overlayTexture.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exposure",{get:function(){return this._data[0]},set:function(t){this._data[0]=t},enumerable:!0,configurable:!0}),e.prototype.getFragmentCode=function(){var t=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(t,1);var e=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(e,1);var i=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(i,1);var n=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(n,1);var r=this._registerCache.getFreeTextureReg();this._inputTextureIndex=r.index;var o=this._registerCache.getFreeTextureReg();this._overlayTextureIndex=o.index;var s=this._registerCache.getFreeFragmentConstant();this._exposureIndex=4*s.index;var a,l=this._registerCache.getFreeFragmentConstant();switch(this._scalingIndex=4*l.index,a="tex "+t+", "+this._uvVarying+", "+r+" <2d,linear,clamp>\nmul "+e+", "+this._uvVarying+", "+l+".zw\nadd "+e+", "+e+", "+l+".xy\ntex "+e+", "+e+", "+o+" <2d,linear,clamp>\nmul "+e+", "+e+", "+s+".xxx\nadd "+e+", "+e+", "+s+".xxx\n",this._blendMode){case"multiply":a+="mul oc, "+t+", "+e+"\n";break;case"add":a+="add oc, "+t+", "+e+"\n";break;case"subtract":a+="sub oc, "+t+", "+e+"\n";break;case"overlay":a+="sge "+i+", "+t+", "+s+".yyy\n",a+="sub "+t+", "+i+", "+t+"\n",a+="sub "+e+", "+e+", "+i+"\n",a+="mul "+e+", "+e+", "+t+"\n",a+="sub "+n+", "+i+", "+s+".yyy\n",a+="div "+e+", "+e+", "+n+"\n",a+="add oc, "+e+", "+i+"\n";break;case"normal":a+="mov oc, "+t+"\n";break;default:throw new Error("Unknown blend mode")}return a},e.prototype.activate=function(t,e,i){this._data[4]=-.5*(this._textureWidth-this._overlayWidth)/this._overlayWidth,this._data[5]=-.5*(this._textureHeight-this._overlayHeight)/this._overlayHeight,this._data[6]=this._textureWidth/this._overlayWidth,this._data[7]=this._textureHeight/this._overlayHeight,t.context.setProgramConstantsFromArray(Ut.FRAGMENT,this._data),this._overlayTexture.getAbstraction(t).activate(this._overlayTextureIndex)},e.prototype.deactivate=function(t){t.context.setTextureAt(1,null)},e}(Ui),An=function(t){function e(e,i){void 0===e&&(e=1),void 0===i&&(i=-1);var n=t.call(this)||this;return n._stepSize=1,n._data=new Float32Array(20),n._data.set([.299,.587,.114,0],0),n._data.set([.25,.5,.75,1],4),n._data.set([1/1024,1/1024,-1,1],8),n._data.set([1/128,1/8,8,0],12),n._data.set([1/3-.5,2/3-.5,-.5,.5],16),n.amount=e,n.stepSize=i,n}return i(e,t),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount},set:function(t){this._amount!=t&&(this._amount=t,this.invalidateProgram(),this.updateBlurData())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stepSize",{get:function(){return this._stepSize},set:function(t){this._stepSize!=t&&(this._stepSize=t,this.calculateStepSize(),this.invalidateProgram(),this.updateBlurData())},enumerable:!0,configurable:!0}),e.prototype.getFragmentCode=function(){var t="fc0",e="fc2.x",i="fc2.y",n="ft0.xy",r="ft0.x",o="ft0.y",s="ft2.x",a="ft2.y",l="ft2.z",u="ft2.w",c="ft3.x",h="ft3.y",p="ft3.z",d="ft1",f="ft4.x",_=new Array;return _.push("tex",d,"v0","fs0","<2d wrap linear>","\n"),_.push("dp3",c,d,t,"\n"),_.push("mov",n,"v0","\n"),_.push("sub",n,n,"fc2.xy","\n"),_.push("tex",d,n,"fs0","<2d wrap linear>","\n"),_.push("dp3",s,d,t,"\n"),_.push("mov",n,"v0","\n"),_.push("add",n,n,"fc2.xy","\n"),_.push("tex",d,n,"fs0","<2d wrap linear>","\n"),_.push("dp3",u,d,t,"\n"),_.push("mov",n,"v0","\n"),_.push("sub",o,o,i,"\n"),_.push("add",r,r,e,"\n"),_.push("tex",d,n,"fs0","<2d wrap linear>","\n"),_.push("dp3",a,d,t,"\n"),_.push("mov",n,"v0","\n"),_.push("add",o,o,i,"\n"),_.push("sub",r,r,e,"\n"),_.push("tex",d,n,"fs0","<2d wrap linear>","\n"),_.push("dp3",l,d,t,"\n"),_.push("add",h,s,a,"\n"),_.push("add",p,l,u,"\n"),_.push("sub",f,h,p,"\n"),_.push("neg",f,f,"\n"),_.push("add",h,s,l,"\n"),_.push("add",p,a,u,"\n"),_.push("sub","ft4.y",h,p,"\n"),_.push("add",h,h,p,"\n"),_.push("mul",h,h,"fc3.y","\n"),_.push("mul",h,h,"fc1.x","\n"),_.push("max","ft5.x",h,"fc3.x","\n"),_.push("abs",h,f,"\n"),_.push("abs",p,"ft4.y","\n"),_.push("min",h,h,p,"\n"),_.push("add",h,h,"ft5.x","\n"),_.push("rcp","ft5.y",h,"\n"),_.push("mul",h,f,"ft5.y","\n"),_.push("mov",p,"fc3.z","\n"),_.push("neg",p,p,"\n"),_.push("max",h,h,p,"\n"),_.push("min",h,"fc3.z",h,"\n"),_.push("mul",f,h,e,"\n"),_.push("mul",h,"ft4.y","ft5.y","\n"),_.push("mov",p,"fc3.z","\n"),_.push("neg",p,p,"\n"),_.push("max",h,h,p,"\n"),_.push("min",h,"fc3.z",h,"\n"),_.push("mul","ft4.y",h,i,"\n"),_.push("mul","ft1.xy","ft4.xy","fc4.x","\n"),_.push("add",n,"v0","ft1.xy","\n"),_.push("tex","ft6",n,"fs0","<2d wrap linear>","\n"),_.push("mul","ft1.xy","ft4.xy","fc4.y","\n"),_.push("add",n,"v0","ft1.xy","\n"),_.push("tex",d,n,"fs0","<2d wrap linear>","\n"),_.push("add","ft6","ft6",d,"\n"),_.push("mul","ft6","ft6","fc1.y","\n"),_.push("mul","ft1.xy","ft4.xy","fc4.z","\n"),_.push("add",n,"v0","ft1.xy","\n"),_.push("tex","ft7",n,"fs0","<2d wrap linear>","\n"),_.push("mul","ft1.xy","ft4.xy","fc4.w","\n"),_.push("add",n,"v0","ft1.xy","\n"),_.push("tex",d,n,"fs0","<2d wrap linear>","\n"),_.push("add","ft7","ft7",d,"\n"),_.push("mul","ft7","ft7","fc1.x","\n"),_.push("mul",d,"ft6","fc1.y","\n"),_.push("add","ft7","ft7",d,"\n"),_.push("min",h,l,u,"\n"),_.push("min",p,s,a,"\n"),_.push("min",h,h,p,"\n"),_.push("min","ft5.x",h,c,"\n"),_.push("max",h,l,u,"\n"),_.push("max",p,s,a,"\n"),_.push("max",h,h,p,"\n"),_.push("max","ft5.y",h,c,"\n"),_.push("dp3",h,t,"ft7","\n"),_.push("slt",p,h,"ft5.x","\n"),_.push("sge","ft3.w",h,"ft5.y","\n"),_.push("mul",p,p,"ft3.w","\n"),_.push("mul","ft6","ft6",p,"\n"),_.push("sub",p,"fc1.w",p,"\n"),_.push("mul","ft7","ft7",p,"\n"),_.push("add","oc","ft6","ft7","\n"),_.join(" ")},e.prototype.activate=function(t,e,i){t.context.setProgramConstantsFromArray(Ut.FRAGMENT,this._data)},e.prototype.updateTextures=function(e){t.prototype.updateTextures.call(this,e),this.updateBlurData()},e.prototype.updateBlurData=function(){this._rttManager&&(this._data[8]=1/this._textureWidth,this._data[9]=1/this._textureHeight)},e.prototype.calculateStepSize=function(){this._realStepSize=1},e.MAX_AUTO_SAMPLES=15,e}(Ui),vn=function(t){function e(e,i){void 0===i&&(i=-1);var n=t.call(this)||this;return n._stepSize=1,n._amount=e,n._data=new Float32Array([0,0,0,1]),n.stepSize=i,n}return i(e,t),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount},set:function(t){this._amount!=t&&(this._amount=t,this.invalidateProgram(),this.updateBlurData(),this.calculateStepSize())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stepSize",{get:function(){return this._stepSize},set:function(t){this._stepSize!=t&&(this._stepSize=t,this.calculateStepSize(),this.invalidateProgram(),this.updateBlurData())},enumerable:!0,configurable:!0}),e.prototype.getFragmentCode=function(){var t=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(t,1);var e=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(e,1);var i=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(i,1);var n=this._registerCache.getFreeTextureReg();this._inputTextureIndex=n.index;var r,o=this._registerCache.getFreeFragmentConstant();this._blurIndex=4*o.index;var s=1;r="mov "+t+", "+this._uvVarying+"\nsub "+t+".x, "+this._uvVarying+".x, "+o+".x\n",r+="tex "+e+", "+t+", "+n+" <2d,linear,clamp>\n";for(var a=this._realStepSize;a<=this._amount;a+=this._realStepSize)r+="add "+t+".x, "+t+".x, "+o+".y\ntex "+i+", "+t+", "+n+" <2d,linear,clamp>\nadd "+e+", "+e+", "+i+"\n",++s;return r+="mul oc, "+e+", "+o+".z\n",this._data[2]=1/s,r},e.prototype.activate=function(t,e,i){t.context.setProgramConstantsFromArray(Ut.FRAGMENT,this._data)},e.prototype.updateTextures=function(e){t.prototype.updateTextures.call(this,e),this.updateBlurData()},e.prototype.updateBlurData=function(){var t=1/this._textureWidth;this._data[0]=.5*this._amount*t,this._data[1]=this._realStepSize*t},e.prototype.calculateStepSize=function(){this._realStepSize=this._stepSize>0?this._stepSize:this._amount>e.MAX_AUTO_SAMPLES?this._amount/e.MAX_AUTO_SAMPLES:1},e.MAX_AUTO_SAMPLES=15,e}(Ui),bn=function(t){function e(e,i){void 0===i&&(i=-1);var n=t.call(this)||this;return n._stepSize=1,n._amount=e,n._data=new Float32Array([0,0,0,1]),n.stepSize=i,n}return i(e,t),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount},set:function(t){this._amount!=t&&(this._amount=t,this.invalidateProgram(),this.updateBlurData())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stepSize",{get:function(){return this._stepSize},set:function(t){this._stepSize!=t&&(this._stepSize=t,this.calculateStepSize(),this.invalidateProgram(),this.updateBlurData())},enumerable:!0,configurable:!0}),e.prototype.getFragmentCode=function(){var t=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(t,1);var e=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(e,1);var i=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(i,1);var n=this._registerCache.getFreeTextureReg();this._inputTextureIndex=n.index;var r,o=this._registerCache.getFreeFragmentConstant();this._blurIndex=4*o.index;var s=1;r="mov "+t+", "+this._uvVarying+"\nsub "+t+".y, "+this._uvVarying+".y, "+o+".x\n",r+="tex "+e+", "+t+", "+n+" <2d,linear,clamp>\n";for(var a=this._realStepSize;a<=this._amount;a+=this._realStepSize)r+="add "+t+".y, "+t+".y, "+o+".y\n",r+="tex "+i+", "+t+", "+n+" <2d,linear,clamp>\nadd "+e+", "+e+", "+i+"\n",++s;return r+="mul oc, "+e+", "+o+".z\n",this._data[2]=1/s,r},e.prototype.activate=function(t,e,i){t.context.setProgramConstantsFromArray(Ut.FRAGMENT,this._data)},e.prototype.updateTextures=function(e){t.prototype.updateTextures.call(this,e),this.updateBlurData()},e.prototype.updateBlurData=function(){var t=1/this._textureHeight;this._data[0]=.5*this._amount*t,this._data[1]=this._realStepSize*t},e.prototype.calculateStepSize=function(){this._realStepSize=this._stepSize>0?this._stepSize:this._amount>e.MAX_AUTO_SAMPLES?this._amount/e.MAX_AUTO_SAMPLES:1},e.MAX_AUTO_SAMPLES=15,e}(Ui),xn=(function(t){function e(e,i,n){void 0===e&&(e=3),void 0===i&&(i=3),void 0===n&&(n=-1);var r=t.call(this)||this;return r._hBlurTask=new vn(e,n),r._vBlurTask=new bn(i,n),r.addTask(r._hBlurTask),r.addTask(r._vBlurTask),r}i(e,t),Object.defineProperty(e.prototype,"blurX",{get:function(){return this._hBlurTask.amount},set:function(t){this._hBlurTask.amount=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this._vBlurTask.amount},set:function(t){this._vBlurTask.amount=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stepSize",{get:function(){return this._hBlurTask.stepSize},set:function(t){this._hBlurTask.stepSize=t,this._vBlurTask.stepSize=t},enumerable:!0,configurable:!0}),e.prototype.setRenderTargets=function(e,i){this._hBlurTask.target=this._vBlurTask.getMainInputTexture(i),t.prototype.setRenderTargets.call(this,e,i)}}(Xi),function(t){function e(e,i){void 0===i&&(i=1);var n=t.call(this)||this;return n._compositeTask=new yn(e,i),n.addTask(n._compositeTask),n}i(e,t),Object.defineProperty(e.prototype,"exposure",{get:function(){return this._compositeTask.exposure},set:function(t){this._compositeTask.exposure=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overlayTexture",{get:function(){return this._compositeTask.overlayTexture},set:function(t){this._compositeTask.overlayTexture=t},enumerable:!0,configurable:!0})}(Xi),function(t){function e(e,i){void 0===i&&(i=-1);var n=t.call(this)||this;return n._fxaaTask=new An(e,i),n.addTask(n._fxaaTask),n}i(e,t),Object.defineProperty(e.prototype,"amount",{get:function(){return this._fxaaTask.amount},set:function(t){this._fxaaTask.amount=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stepSize",{get:function(){return this._fxaaTask.stepSize},set:function(t){this._fxaaTask.stepSize=t},enumerable:!0,configurable:!0})}(Xi),function(t){function e(){var i=t.call(this)||this;return i._stages=new Array(e.STAGE_MAX_QUANTITY),i._onContextCreatedDelegate=function(t){return i.onContextCreated(t)},i}return i(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.getStageAt=function(t,i,n,r,o){if(void 0===i&&(i=!1),void 0===n&&(n=Vt.BASELINE),void 0===r&&(r=qt.AUTO),void 0===o&&(o=!1),t<0||t>=e.STAGE_MAX_QUANTITY)throw new S("Index is out of bounds [0.."+e.STAGE_MAX_QUANTITY+"]");if(!this._stages[t]){if(e._numStages++,document&&null==e.htmlCanvas)(s=document.createElement("canvas")).id="stage"+t,document.body.appendChild(s);else if(e.htmlCanvas)var s=e.htmlCanvas;var a=this._stages[t]=new Ji(s,t,this,i,n);a.addEventListener(Re.CONTEXT_CREATED,this._onContextCreatedDelegate),a.requestContext(i,n,r,o)}return this._stages[t]},e.prototype.iRemoveStage=function(t){e._numStages--,t.removeEventListener(Re.CONTEXT_CREATED,this._onContextCreatedDelegate),this._stages[t.stageIndex]=null},e.prototype.getFreeStage=function(t,e,i,n){void 0===t&&(t=!1),void 0===e&&(e=Vt.BASELINE),void 0===i&&(i=qt.AUTO),void 0===n&&(n=!1);for(var r=0,o=this._stages.length;r<o;){if(!this._stages[r])return this.getStageAt(r,t,e,i,n);++r}return null},Object.defineProperty(e.prototype,"hasFreeStage",{get:function(){return e._numStages<e.STAGE_MAX_QUANTITY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numSlotsFree",{get:function(){return e.STAGE_MAX_QUANTITY-e._numStages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numSlotsUsed",{get:function(){return e._numStages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numSlotsTotal",{get:function(){return this._stages.length},enumerable:!0,configurable:!0}),e.prototype.onContextCreated=function(t){},e.STAGE_MAX_QUANTITY=8,e.htmlCanvas=null,e._numStages=0,e}(u)),Cn=function(t){function e(e,i){void 0===i&&(i=!0);var n=t.call(this)||this;return n._viewOffsetX=0,n._viewOffsetY=0,n._viewWidth=-1,n._viewHeight=-1,n._textureWidth=-1,n._textureHeight=-1,n._buffersInvalid=!0,n._renderToTextureRect=new Y,n._stage=e,n._powerOfTwo=i,n}return i(e,t),e.getInstance=function(t){if(!t)throw new Error("stage key cannot be null!");null==e._instances&&(e._instances=new Array);var i=e.getRTTBufferManagerFromStage(t);if(null==i){i=new e(t);var n=new wn;n.stage3d=t,n.rttbfm=i,e._instances.push(n)}return i},e.getRTTBufferManagerFromStage=function(t){for(var i,n=e._instances.length,r=0;r<n;r++)if((i=e._instances[r]).stage3d===t)return i.rttbfm;return null},e.deleteRTTBufferManager=function(t){for(var i=e._instances.length,n=0;n<i;n++)if(e._instances[n].stage3d===t)return void e._instances.splice(n,1)},Object.defineProperty(e.prototype,"textureRatioX",{get:function(){return this._buffersInvalid&&this.updateRTTBuffers(),this._textureRatioX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureRatioY",{get:function(){return this._buffersInvalid&&this.updateRTTBuffers(),this._textureRatioY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewOffsetX",{get:function(){return this._viewOffsetX},set:function(t){this._viewOffsetX=t,this._buffersInvalid=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewOffsetY",{get:function(){return this._viewOffsetY},set:function(t){this._viewOffsetY=t,this._buffersInvalid=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewWidth",{get:function(){return this._viewWidth},set:function(t){t!=this._viewWidth&&(this._viewWidth=t,this._buffersInvalid=!0,this._textureWidth=this._powerOfTwo?on.getBestPowerOf2(this._viewWidth):this._viewWidth,this._textureWidth>this._viewWidth?(this._renderToTextureRect.x=Math.floor(.5*(this._textureWidth-this._viewWidth)),this._renderToTextureRect.width=this._viewWidth):(this._renderToTextureRect.x=0,this._renderToTextureRect.width=this._textureWidth),this.dispatchEvent(new Ne(Ne.RESIZE,this)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewHeight",{get:function(){return this._viewHeight},set:function(t){t!=this._viewHeight&&(this._viewHeight=t,this._buffersInvalid=!0,this._textureHeight=this._powerOfTwo?on.getBestPowerOf2(this._viewHeight):this._viewHeight,this._textureHeight>this._viewHeight?(this._renderToTextureRect.y=Math.floor(.5*(this._textureHeight-this._viewHeight)),this._renderToTextureRect.height=this._viewHeight):(this._renderToTextureRect.y=0,this._renderToTextureRect.height=this._textureHeight),this.dispatchEvent(new Ne(Ne.RESIZE,this)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderToTextureVertexBuffer",{get:function(){return this._buffersInvalid&&this.updateRTTBuffers(),this._renderToTextureVertexBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderToScreenVertexBuffer",{get:function(){return this._buffersInvalid&&this.updateRTTBuffers(),this._renderToScreenVertexBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexBuffer",{get:function(){return this._buffersInvalid&&this.updateRTTBuffers(),this._indexBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderToTextureRect",{get:function(){return this._buffersInvalid&&this.updateRTTBuffers(),this._renderToTextureRect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureWidth",{get:function(){return this._textureWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureHeight",{get:function(){return this._textureHeight},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){e.deleteRTTBufferManager(this._stage),this._indexBuffer&&(this._indexBuffer.dispose(),this._renderToScreenVertexBuffer.dispose(),this._renderToTextureVertexBuffer.dispose(),this._renderToScreenVertexBuffer=null,this._renderToTextureVertexBuffer=null,this._indexBuffer=null)},e.prototype.updateRTTBuffers=function(){var t,e,i,n,r=this._stage.context;null==this._renderToTextureVertexBuffer&&(this._renderToTextureVertexBuffer=r.createVertexBuffer(4,20)),null==this._renderToScreenVertexBuffer&&(this._renderToScreenVertexBuffer=r.createVertexBuffer(4,20)),this._indexBuffer||(this._indexBuffer=r.createIndexBuffer(6),this._indexBuffer.uploadFromArray(new Uint16Array([2,1,0,3,2,0]),0,6)),this._textureRatioX=i=Math.min(this._viewWidth/this._textureWidth,1),this._textureRatioY=n=Math.min(this._viewHeight/this._textureHeight,1);var o=.5*(1-i),s=.5*(i+1),a=.5*(1-n),l=.5*(n+1);t=new Float32Array([-i,-n,o,a,0,i,-n,s,a,1,i,n,s,l,2,-i,n,o,l,3]),e=new Float32Array([-1,-1,o,a,0,1,-1,s,a,1,1,1,s,l,2,-1,1,o,l,3]),this._renderToTextureVertexBuffer.uploadFromArray(t,0,4),this._renderToScreenVertexBuffer.uploadFromArray(e,0,4),this._buffersInvalid=!1},e}(u),wn=function(){};var In=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this,nt.BLOB)||this;return n._factory=e||new rn,n._alphaChannel=i,n}return i(e,t),e.supportsType=function(t){return t=t.toLowerCase().trim(),this.SUPPORTED_TYPES.includes(t)},e.supportsData=function(t){if(t instanceof HTMLImageElement)return!0;if(!(t instanceof y))return!1;var e=t;return e.position=0,55551==e.readUnsignedShort()||(e.position=0,16973==e.readShort()||(e.position=1,"PNG"==e.readUTFBytes(3)||(e.position=0,"GIF"==e.readUTFBytes(3)&&14393==e.readShort()&&97==e.readByte()||(e.position=0,"ATF"==e.readUTFBytes(3)))))},e.prototype._pFinalizeAsset=function(e,i){this._alphaChannel&&(e.alphaChannel=this._alphaChannel),t.prototype._pFinalizeAsset.call(this,e,i)},e.prototype._pProceedParsing=function(){var t,e,i=this;if(this._loadingImage)return mt.MORE_TO_PARSE;if(!this._htmlImageElement&&this.data instanceof HTMLImageElement&&(this._htmlImageElement=this.data),this._htmlImageElement){var n=on.imageToBitmapImage2D(this._htmlImageElement,!1,this._factory);return this._pFinalizeAsset(n,this._iFileName),this._pContent=n,mt.PARSING_DONE}if(this.data instanceof pt)return t=new _n(this.data),this._pFinalizeAsset(t,this._iFileName),this._pContent=t,mt.PARSING_DONE;if(this.data instanceof y)this.data.position=0,e=new Blob([this.data.arraybytes]);else if(this.data instanceof ArrayBuffer)e=new Blob([this.data]);else{if(!(this.data instanceof Blob))throw"Unknow data";e=this.data}var r=function(t,e){if("createImageBitmap"in self)return self.createImageBitmap(t).then(e),null;var i=URL.createObjectURL(t),n=new Image;return n.src=i,n.naturalWidth?n:(n.onload=function(t){e(n),URL.revokeObjectURL(i)},null)}(e,(function(t){return i._htmlImageElement=t,i.onLoadComplete(null),!0}));return r instanceof HTMLImageElement&&r.naturalWidth&&(this._htmlImageElement=r,t=on.imageToBitmapImage2D(this._htmlImageElement,!1,this._factory),this._pFinalizeAsset(t,this._iFileName),this._pContent=t),this._loadingImage=!0,mt.MORE_TO_PARSE},e.prototype.onLoadComplete=function(t){this._loadingImage=!1},e.SUPPORTED_TYPES=["jpg","jpeg","png","gif"],e}(mt),En=function(t){function e(){return t.call(this,nt.TEXT)||this}return i(e,t),e.supportsType=function(t){return"cube"==(t=t.toLowerCase())},e.supportsData=function(t){try{return!!JSON.parse(t)}catch(t){return!1}},e.prototype._iResolveDependency=function(t){},e.prototype._iResolveDependencyFailure=function(t){},e.prototype._pProceedParsing=function(){if(null!=this._imgDependencyDictionary){var t=new en(this._getBitmapImage2D(e.posX).width),i=new Y(0,0,t.size,t.size);return t.setPixels(en.posX,i,this._getBitmapImage2D(e.posX).data),t.setPixels(en.negX,i,this._getBitmapImage2D(e.negX).data),t.setPixels(en.posY,i,this._getBitmapImage2D(e.posY).data),t.setPixels(en.negY,i,this._getBitmapImage2D(e.negY).data),t.setPixels(en.posZ,i,this._getBitmapImage2D(e.posZ).data),t.setPixels(en.negZ,i,this._getBitmapImage2D(e.negZ).data),this._imgDependencyDictionary=null,t.name=this._iFileName,this._pFinalizeAsset(t,this._iFileName),mt.PARSING_DONE}try{var n=JSON.parse(this.data),r=n.data,o=void 0;if(6!=r.length&&this._pDieWithError("ImageCubeParser: Error - cube texture should have exactly 6 images"),n){this._imgDependencyDictionary=new Object;for(var s=0;s<r.length;s++)o=r[s],this._imgDependencyDictionary[o.id]=this._pAddDependency(o.id,new pt(o.image.toString()));return this._validateCubeData()?(this._pPauseAndRetrieveDependencies(),mt.MORE_TO_PARSE):(this._pDieWithError("ImageCubeParser: JSON data error - cubes require id of:   \n"+e.posX+", "+e.negX+",  \n"+e.posY+", "+e.negY+",  \n"+e.posZ+", "+e.negZ),mt.PARSING_DONE)}}catch(t){this._pDieWithError("CubeTexturePaser Error parsing JSON")}return mt.PARSING_DONE},e.prototype._validateCubeData=function(){return null!=this._imgDependencyDictionary[e.posX]&&null!=this._imgDependencyDictionary[e.negX]&&null!=this._imgDependencyDictionary[e.posY]&&null!=this._imgDependencyDictionary[e.negY]&&null!=this._imgDependencyDictionary[e.posZ]&&null!=this._imgDependencyDictionary[e.negZ]},e.prototype._getBitmapImage2D=function(t){var e=this._imgDependencyDictionary[t];return e?e.assets[0]:null},e.posX="posX",e.negX="negX",e.posY="posY",e.negY="negY",e.posZ="posZ",e.negZ="negZ",e}(mt),Sn=function(t){function e(){var e=t.call(this,nt.TEXT)||this;return e._parseState=0,e}return i(e,t),e.supportsType=function(t){return"xml"==(t=t.toLowerCase())},e.supportsData=function(t){try{var e=A.toString(t);return-1!=e.indexOf("TextureAtlas")||-1!=e.indexOf("textureatlas")}catch(t){return!1}},e.prototype._iResolveDependency=function(t){t.assets.length?(this._imageData=t.assets[0],this._pFinalizeAsset(this._imageData),this._parseState=Dn.PARSE_SUBTEXTURES):this._parseState=Dn.PARSE_COMPLETE},e.prototype._iResolveDependencyFailure=function(t){this._parseState=Dn.PARSE_COMPLETE},e.prototype._pProceedParsing=function(){switch(this._parseState){case Dn.PARSE_XML:try{this._doc=wt.getChildrenWithTag(wt.strToXml(this._pGetTextData()),"TextureAtlas")[0],this._imagePath=wt.readAttributeValue(this._doc,"imagePath"),this._subTextureNodes=wt.getChildrenWithTag(this._doc,"SubTexture"),this._parseState=Dn.PARSE_IMAGE}catch(t){return mt.PARSING_DONE}break;case Dn.PARSE_IMAGE:if(!this._imagePath)return mt.PARSING_DONE;this._pAddDependency(this._imagePath,new pt(this._imagePath)),this._pPauseAndRetrieveDependencies();break;case Dn.PARSE_SUBTEXTURES:for(var t,e,i,n,r,o,s=this._subTextureNodes.length,a=0;a<s;a++)e=this._subTextureNodes[a],t=new Ze,i=wt.readAttributeValue(e,"x"),n=wt.readAttributeValue(e,"y"),r=wt.readAttributeValue(e,"width"),o=wt.readAttributeValue(e,"height"),(i||n||r||o)&&(t.imageRect=new Y(parseInt(i)/this._imageData.width,parseInt(n)/this._imageData.height,parseInt(r)/this._imageData.width,parseInt(o)/this._imageData.height)),i=wt.readAttributeValue(e,"frameX"),n=wt.readAttributeValue(e,"frameY"),r=wt.readAttributeValue(e,"frameWidth"),o=wt.readAttributeValue(e,"frameHeight"),(i||n||r||o)&&(t.frameRect=new Y(parseInt(i),parseInt(n),parseInt(r),parseInt(o))),this._pFinalizeAsset(t,wt.readAttributeValue(e,"name"));this._parseState=Dn.PARSE_COMPLETE;break;case Dn.PARSE_COMPLETE:return mt.PARSING_DONE}return mt.MORE_TO_PARSE},e}(mt),Dn=function(){function t(){}return t.PARSE_XML=0,t.PARSE_IMAGE=1,t.PARSE_SUBTEXTURES=2,t.PARSE_COMPLETE=3,t}(),Tn=function(){this.textures=new Array,this.animatableAttributes=new Array,this.animationTargetRegisters=new Array},Pn=function(t){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.call(this)||this;return n._count=0,n._newCount=0,n._stride=0,n._newStride=0,n._viewVOs=new Array,n._stride=n._newStride=e,n._count=n._newCount=i,n._buffer=new ArrayBuffer(n._stride*n._count),n._bufferView=new Uint8Array(n._buffer,0,n._buffer.byteLength),n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stride",{get:function(){return this._lengthDirty&&this._updateLength(),this._stride},set:function(t){this._newStride!=t&&(this._newStride=t,this.resize())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this._newCount},set:function(t){this._newCount!=t&&(this._newCount=t,this.resize())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._lengthDirty&&this._updateLength(),this._contentDirty=!1,this._buffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferView",{get:function(){return this._lengthDirty&&this._updateLength(),this._contentDirty=!1,this._bufferView},set:function(t){this._bufferView=t,this._buffer=this._bufferView.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._count*this.stride},enumerable:!0,configurable:!0}),e.prototype.invalidate=function(){this._contentDirty||(t.prototype.invalidate.call(this),this._contentDirty=!0)},e.prototype.resize=function(){this._lengthDirty||(this.clear(),this._lengthDirty=!0,this._newStride||(this._buffer=null,this._bufferView=null))},e.prototype.cloneBufferView=function(){var t=new e(this._stride,this._count);return t.bufferView.set(this.bufferView),t},e.prototype.clone=function(){var t=new e(this._stride,this._count);t.bufferView.set(this.bufferView);for(var i=this._viewVOs.length,n=0;n<i;n++)this._viewVOs[n].view._internalClone(t);return t},e.prototype.getView=function(t){return t<this._viewVOs.length?this._viewVOs[t].view:null},e.prototype._setAttributes=function(t,e,i){void 0===i&&(i=0);var n=e instanceof Uint8Array?e:new Uint8Array(e.buffer),r=this._viewVOs[t],o=r.length,s=r.offset,a=n.length/o;if(this.count<a+i&&(this.count=a+i),this._lengthDirty&&this._updateLength(),1==this._viewVOs.length)this._bufferView.set(n);else for(var l=0;l<a;l++)this._bufferView.set(n.subarray(l*o,(l+1)*o),(l+i)*this._stride+s);this.invalidate()},e.prototype._addView=function(t){var e=new Bn(t),i=this._viewVOs.length;e.offset=i?this._viewVOs[i-1].offset+this._viewVOs[i-1].length:0,this._viewVOs.push(e),this._newStride<e.offset+e.length&&(this._newStride=e.offset+e.length,this.resize()),t._index=i},e.prototype._removeView=function(t){var e=t._index,i=this._viewVOs.splice(e,1)[0],n=this._viewVOs.length;i.dispose();for(var r=e;r<n;r++)(i=this._viewVOs[r]).offset=r?this._viewVOs[r-1].offset+this._viewVOs[r-1].length:0,i.view._index=r;this._newStride=n?this._viewVOs[n-1].offset+this._viewVOs[n-1].length:0,this.resize()},e.prototype._getOffset=function(t){return this._viewVOs[t].offset},e.prototype._updateLength=function(){var t,e;this._lengthDirty=!1;var i=this._viewVOs.length,n=this._newStride*this._newCount;if(!this._buffer||this._buffer.byteLength!=n){var r=new ArrayBuffer(n),o=new Uint8Array(r,0,r.byteLength),s=void 0,a=void 0,l=void 0,u=void 0;if(this._buffer)if(this._stride!=this._newStride){for(t=0;t<i;t++){for(a=(s=this._viewVOs[t]).length,l=s.offset,u=s.oldOffset,e=0;e<this._count;e++)null!=u&&o.set(new Uint8Array(this._buffer,e*this._stride+u,a),e*this._newStride+l);s.oldOffset=s.offset}this._stride=this._newStride}else o.set(new Uint8Array(this._buffer,0,Math.min(n,this._buffer.byteLength)));this._buffer=r,this._bufferView=o}this._count=this._newCount},e.assetType="[assets AttributesBuffer]",e}(p),Bn=function(){function t(t){this.view=t,this.length=t.size*t.dimensions}return t.prototype.dispose=function(){this.view=null},t.prototype.clone=function(){return new t(this.view)},t}(),Mn=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._stage=i,n._attributesBuffer=e,n}return i(e,t),Object.defineProperty(e.prototype,"vertexValid",{get:function(){return!this._invalid&&this._vertexBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexValid",{get:function(){return!this._invalid&&this._indexBuffer},enumerable:!0,configurable:!0}),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._attributesBuffer=null,this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null),this._vertexBuffer&&(this._vertexBuffer.dispose(),this._vertexBuffer=null)},e.prototype.activate=function(t,e,i,n,r){void 0===r&&(r=!1),this._stage.setVertexBuffer(t,this._getVertexBuffer(),e,i,n,r)},e.prototype.draw=function(t,e,i){this._stage.context.drawIndices(t,this._getIndexBuffer(),e,i)},e.prototype._getIndexBuffer=function(){return this._indexBuffer||(this._invalid=!0,this._indexBuffer=this._stage.context.createIndexBuffer(this._attributesBuffer.count*this._attributesBuffer.stride/2)),this._invalid&&(this._invalid=!1,this._indexBuffer.uploadFromByteArray(this._attributesBuffer.buffer,0,this._attributesBuffer.length)),this._indexBuffer},e.prototype._getVertexBuffer=function(){return this._vertexBuffer||(this._invalid=!0,this._vertexBuffer=this._stage.context.createVertexBuffer(this._attributesBuffer.count,this._attributesBuffer.stride)),this._invalid&&(this._invalid=!1,this._vertexBuffer.uploadFromByteArray(this._attributesBuffer.buffer,0,this._attributesBuffer.count)),this._vertexBuffer},e}(K);Ji.registerAbstraction(Mn,Pn);var On=function(t){function e(e,i,n,r){void 0===n&&(n=0),void 0===r&&(r=!1);var o=t.call(this)||this;return o._arrayClass=e,o._size=e.BYTES_PER_ELEMENT,o._dimensions=i,o._attributesBuffer=n instanceof Pn?n:new Pn(o._dimensions*o._size,n),o._attributesBuffer._addView(o),o._unsigned=r,o}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attributesBuffer",{get:function(){return this._attributesBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size!=t&&(this._size=t,this._attributesBuffer._removeView(this),this._attributesBuffer._addView(this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dimensions",{get:function(){return this._dimensions},set:function(t){this._dimensions!=t&&(this._dimensions=t,this._attributesBuffer._removeView(this),this._attributesBuffer._addView(this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unsigned",{get:function(){return this._unsigned},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this._attributesBuffer.count},set:function(t){this._attributesBuffer.count=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){return this._attributesBuffer._getOffset(this._index)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._attributesBuffer.count*this._dimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stride",{get:function(){return this._attributesBuffer.stride/this._size},enumerable:!0,configurable:!0}),e.prototype.set=function(t,e){void 0===e&&(e=0),this._attributesBuffer._setAttributes(this._index,t instanceof Array?new this._arrayClass(t):t,e)},e.prototype.get=function(t,e){return void 0===e&&(e=0),new this._arrayClass(this._attributesBuffer.buffer,e*this._attributesBuffer.stride+this.offset,t*this.stride-this.offset/this.size)},e.prototype._internalClone=function(t){return this._cloneCache=new e(this._arrayClass,this._dimensions,t,this._unsigned)},e.prototype.clone=function(t){void 0===t&&(t=null),t&&this._internalClone(t),this._cloneCache||this._attributesBuffer.clone();var e=this._cloneCache;return this._cloneCache=null,e},e.prototype.invalidate=function(){t.prototype.invalidate.call(this),this._attributesBuffer.invalidate()},e.prototype.dispose=function(){this._attributesBuffer&&(this._attributesBuffer._removeView(this),this._attributesBuffer=null)},e.assetType="[attributes AttributesView]",e}(p),Ln=function(t){function e(e,i){return void 0===i&&(i=!0),t.call(this,i?Uint8Array:Int8Array,4,e,i)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.set=function(e,i){void 0===i&&(i=0),t.prototype.set.call(this,e,i)},e.prototype.get=function(e,i){return void 0===i&&(i=0),t.prototype.get.call(this,e,i)},e.prototype._internalClone=function(t){return this._cloneCache=new e(t,this._arrayClass==Uint8Array)},e.prototype.clone=function(e){return void 0===e&&(e=null),t.prototype.clone.call(this,e)},e.assetType="[attributes Byte4Attributes]",e}(On),Rn=function(t){function e(e){return t.call(this,Float32Array,1,e)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.set=function(e,i){void 0===i&&(i=0),t.prototype.set.call(this,e,i)},e.prototype.get=function(e,i){return void 0===i&&(i=0),t.prototype.get.call(this,e,i)},e.prototype._internalClone=function(t){return this._cloneCache=new e(t)},e.prototype.clone=function(e){return void 0===e&&(e=null),t.prototype.clone.call(this,e)},e.assetType="[attributes Float1Attributes]",e}(On),Nn=function(t){function e(e){return t.call(this,Float32Array,2,e)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.set=function(e,i){void 0===i&&(i=0),t.prototype.set.call(this,e,i)},e.prototype.get=function(e,i){return void 0===i&&(i=0),t.prototype.get.call(this,e,i)},e.prototype._internalClone=function(t){return this._cloneCache=new e(t)},e.prototype.clone=function(e){return void 0===e&&(e=null),t.prototype.clone.call(this,e)},e.assetType="[attributes Float2Attributes]",e}(On),Fn=function(t){function e(e){return t.call(this,Float32Array,3,e)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.set=function(e,i){void 0===i&&(i=0),t.prototype.set.call(this,e,i)},e.prototype.get=function(e,i){return void 0===i&&(i=0),t.prototype.get.call(this,e,i)},e.prototype._internalClone=function(t){return this._cloneCache=new e(t)},e.prototype.clone=function(e){return void 0===e&&(e=null),t.prototype.clone.call(this,e)},e.assetType="[attributes Float3Attributes]",e}(On),kn=function(t){function e(e){return t.call(this,Float32Array,4,e)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.set=function(e,i){void 0===i&&(i=0),t.prototype.set.call(this,e,i)},e.prototype.get=function(e,i){return void 0===i&&(i=0),t.prototype.get.call(this,e,i)},e.prototype._internalClone=function(t){return this._cloneCache=new e(t)},e.prototype.clone=function(e){return void 0===e&&(e=null),t.prototype.clone.call(this,e)},e.assetType="[attributes Float4Attributes]",e}(On),Vn=(function(t){function e(e,i){return void 0===i&&(i=!0),t.call(this,i?Uint16Array:Int16Array,2,e,i)||this}i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.set=function(e,i){void 0===i&&(i=0),t.prototype.set.call(this,e,i)},e.prototype.get=function(e,i){return void 0===i&&(i=0),t.prototype.get.call(this,e,i)},e.prototype._internalClone=function(t){return this._cloneCache=new e(t,this._arrayClass==Uint16Array)},e.prototype.clone=function(e){return void 0===e&&(e=null),t.prototype.clone.call(this,e)},e.assetType="[attributes Short2Attributes]"}(On),function(t){function e(e,i){return void 0===i&&(i=!0),t.call(this,i?Uint16Array:Int16Array,3,e,i)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.set=function(e,i){void 0===i&&(i=0),t.prototype.set.call(this,e,i)},e.prototype.get=function(e,i){return void 0===i&&(i=0),t.prototype.get.call(this,e,i)},e.prototype._internalClone=function(t){return this._cloneCache=new e(t,this._arrayClass==Uint16Array)},e.prototype.clone=function(e){return void 0===e&&(e=null),t.prototype.clone.call(this,e)},e.assetType="[attributes Short3Attributes]",e}(On));console.debug("AwayJS - Stage - 0.11.69"),ut.enableParser(In),ut.enableParser(En),ut.enableParser(Sn);var Un=function(t){function e(e,i,n,r,o,s){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),void 0===r&&(r=Vt.BASELINE),void 0===o&&(o=qt.AUTO),void 0===s&&(s=!1);var a=t.call(this)||this;return a._rect=new Y,a._backgroundRed=0,a._backgroundGreen=0,a._backgroundBlue=0,a._focalLength=1e3,a._pixelRatio=1,a._frustumMatrix3D=new R,a._viewMatrix3D=new R,a._inverseViewMatrix3D=new R,a._components=new Array(4),a._offset=new P,a._scale=new P(1,1,1),a._frustumMatrix3DDirty=!0,a._viewMatrix3DDirty=!0,a._inverseViewMatrix3DDirty=!0,a.backgroundAlpha=1,a.backgroundDepth=1,a.backgroundStencil=0,a.preservePixelRatio=!0,a.preserveFocalLength=!1,a.preserveDimensions=!1,a._components[0]=a._offset,a._components[3]=a._scale,a._onInvalidateSizeDelegate=function(t){return a._onInvalidateSize(t)},a._onInvalidateViewMatrix3DDelegate=function(t){return a._onInvalidateViewMatrix3D(t)},a._projection=e||new vt,a._projection.addEventListener(j.INVALIDATE_VIEW_MATRIX3D,a._onInvalidateViewMatrix3DDelegate),i&&(a._shareContext=!0),a._stage=i||xn.getInstance().getFreeStage(n,r,o,s),a._stage.addEventListener(Re.INVALIDATE_SIZE,a._onInvalidateSizeDelegate),a._targetWidth=a._stage.width,a._targetHeight=a._stage.height,a._updateFocalLength(),a._updatePixelRatio(),a}return i(e,t),Object.defineProperty(e.prototype,"shareContext",{get:function(){return this._shareContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._shareContext||this._target?this._rect.x:this._stage.x},set:function(t){if(this._shareContext||this._target){if(this._rect.x==t)return;this._offset.x=(this._rect.x=t)/this._targetWidth,this._invalidateViewMatrix3D()}else this._stage.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._shareContext||this._target?this._rect.y:this._stage.y},set:function(t){if(this._shareContext||this._target){if(this._rect.y==t)return;this._offset.y=(this._rect.y=t)/this._targetHeight,this._invalidateViewMatrix3D()}else this._stage.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._rect.width},set:function(t){this._rect.width!=t&&(this._rect.width=t,this._shareContext||this._target?(this._scale.x=t/this._targetWidth,this._updatePixelRatio(),this._invalidateViewMatrix3D()):this._stage.width=t,this._invalidateSize())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._scale.y*this._targetHeight},set:function(t){this._rect.height!=t&&(this._rect.height=t,this._shareContext||this._target?(this._scale.y=t/this._targetHeight,this._updateFocalLength(),this._updatePixelRatio(),this._invalidateViewMatrix3D()):this._stage.height=t,this._invalidateSize())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor!=t&&(this._backgroundColor=t,this._backgroundRed=(t>>16&255)/255,this._backgroundGreen=(t>>8&255)/255,this._backgroundBlue=(255&t)/255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focalLength",{get:function(){return this._focalLength},set:function(t){this._focalLength!=t&&(this._focalLength=t,this._updateFocalLength())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return this._pixelRatio},set:function(t){this._pixelRatio!=t&&(this._pixelRatio=t,this._updatePixelRatio())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},set:function(t){if(null==t)throw new o("projection cannot be null");this._projection!=t&&(this._projection.removeEventListener(j.INVALIDATE_VIEW_MATRIX3D,this._onInvalidateViewMatrix3DDelegate),this._projection=t,this._projection.addEventListener(j.INVALIDATE_VIEW_MATRIX3D,this._onInvalidateViewMatrix3DDelegate),this._invalidateViewMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target!=t&&this._updateTarget(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frustumMatrix3D",{get:function(){return this._frustumMatrix3DDirty&&(this._frustumMatrix3DDirty=!1,this._frustumMatrix3D.recompose(this._components),this._frustumMatrix3D.prepend(this._projection.frustumMatrix3D)),this._frustumMatrix3D},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewMatrix3D",{get:function(){return this._viewMatrix3DDirty&&(this._viewMatrix3DDirty=!1,this._viewMatrix3D.recompose(this._components),this._viewMatrix3D.prepend(this._projection.viewMatrix3D)),this._viewMatrix3D},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inverseViewMatrix3D",{get:function(){return this._inverseViewMatrix3DDirty&&(this._inverseViewMatrix3DDirty=!1,this._inverseViewMatrix3D.copyFrom(this.viewMatrix3D),this._inverseViewMatrix3D.invert()),this._inverseViewMatrix3D},enumerable:!0,configurable:!0}),e.prototype.clear=function(t,e,i,n,r){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=Rt.ALL),this._stage.setRenderTarget(this._target,e,i,n),this._stage.setScissor(null==this._target?this._rect:null),t&&this._stage.clear(this._backgroundRed,this._backgroundGreen,this._backgroundBlue,this.backgroundAlpha,this.backgroundDepth,this.backgroundStencil,r)},e.prototype.present=function(){this._shareContext||null!=this._target||this._stage.present()},e.prototype.project=function(t,e){return void 0===e&&(e=null),(e=this._projection.project(t,e)).x=(e.x+1)*this.width/2,e.y=(e.y+1)*this.height/2,e},e.prototype.unproject=function(t,e,i,n){return void 0===n&&(n=null),this._projection.unproject(2*t/this.width-1,2*e/this.height-1,i,n)},e.prototype.dispose=function(){this._target?(this._target.removeEventListener(l.INVALIDATE,this._onInvalidateSizeDelegate),this._target=null):(this._stage.removeEventListener(Re.INVALIDATE_SIZE,this._onInvalidateSizeDelegate),this._shareContext||null!=this._target||this._stage.dispose(),this._stage=null),this._projection&&(this._projection.removeEventListener(j.INVALIDATE_VIEW_MATRIX3D,this._onInvalidateViewMatrix3DDelegate),this._projection=null)},e.prototype._onInvalidateSize=function(t){this._updateDimensions(),this._updateFocalLength(),this._updatePixelRatio()},e.prototype._onInvalidateViewMatrix3D=function(t){this._invalidateViewMatrix3D()},e.prototype._updateTarget=function(t){this._target?this._target.removeEventListener(l.INVALIDATE,this._onInvalidateSizeDelegate):this._stage.removeEventListener(Re.INVALIDATE_SIZE,this._onInvalidateSizeDelegate),this._target=t,this._target?this._target.addEventListener(l.INVALIDATE,this._onInvalidateSizeDelegate):this._stage.addEventListener(Re.INVALIDATE_SIZE,this._onInvalidateSizeDelegate),this._updateDimensions(),this._updateFocalLength(),this._updatePixelRatio()},e.prototype._updateDimensions=function(){this._target?this._target instanceof sn?(this._targetWidth=this._target.width,this._targetHeight=this._target.height):this._target instanceof Zi&&(this._targetWidth=this._target.size,this._targetHeight=this._target.size):(this._targetWidth=this._stage.width,this._targetHeight=this._stage.height),this.preserveDimensions&&(this._shareContext||this._target)?(this._offset.x=this._rect.x/this._targetWidth,this._offset.y=this._rect.y/this._targetHeight,this._scale.x=this._rect.width/this._targetWidth,this._scale.y=this._rect.height/this._targetHeight):(this._rect.x=this._offset.x*this._targetWidth,this._rect.y=this._offset.y*this._targetHeight,this._rect.width=this._scale.x*this._targetWidth,this._rect.height=this._scale.y*this._targetHeight,this._invalidateSize())},e.prototype._updateFocalLength=function(){this.preserveFocalLength?this.projection.scale=this._focalLength/this._rect.height:this._focalLength=this._projection.scale*this._rect.height},e.prototype._updatePixelRatio=function(){this.preservePixelRatio?this._projection.ratio=this._pixelRatio*this._rect.width/this._rect.height:this._pixelRatio=this._projection.ratio*this._rect.height/this._rect.width},e.prototype._invalidateViewMatrix3D=function(){this._frustumMatrix3DDirty=!0,this._viewMatrix3DDirty=!0,this._inverseViewMatrix3DDirty=!0,this.dispatchEvent(new ie(ie.INVALIDATE_VIEW_MATRIX3D,this))},e.prototype._invalidateSize=function(){this.dispatchEvent(new ie(ie.INVALIDATE_SIZE,this))},e}(p);console.debug("AwayJS - View - 0.6.14");var jn,Gn=function(){function t(){this._pVertexBuffer=new Array(8),this._pBufferContext=new Array(8),this._pBufferDirty=new Array(8),this.numProcessedVertices=0,this.previousTime=Number.NEGATIVE_INFINITY,this.animationParticles=new Array;for(var e=0;e<8;e++)this._pBufferDirty[e]=!0;this._iUniqueId=t.SUBGEOM_ID_COUNT++}return t.prototype.createVertexData=function(t,e){this._numVertices=t,this._totalLenOfOneVertex=e,this._pVertexData=new Float32Array(t*e)},t.prototype.activateVertexBuffer=function(t,e,i,n){var r=i.stageIndex,o=i.context,s=this._pVertexBuffer[r];s&&this._pBufferContext[r]==o||(s=this._pVertexBuffer[r]=o.createVertexBuffer(this._numVertices,4*this._totalLenOfOneVertex),this._pBufferContext[r]=o,this._pBufferDirty[r]=!0),this._pBufferDirty[r]&&(s.uploadFromArray(this._pVertexData,0,this._numVertices),this._pBufferDirty[r]=!1),o.setVertexBufferAt(t,s,4*e,n)},t.prototype.dispose=function(){for(;this._pVertexBuffer.length;){var t=this._pVertexBuffer.pop();t&&t.dispose()}},t.prototype.invalidateBuffer=function(){for(var t=0;t<8;t++)this._pBufferDirty[t]=!0},Object.defineProperty(t.prototype,"vertexData",{get:function(){return this._pVertexData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalLenOfOneVertex",{get:function(){return this._totalLenOfOneVertex},enumerable:!0,configurable:!0}),t.SUBGEOM_ID_COUNT=0,t}(),Qn=(function(){function t(t,e){if(t<=0||t>=1)throw new Error("life exceeds range (0,1)");this._life=t,this._color=e}Object.defineProperty(t.prototype,"color",{get:function(){return this._color},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"life",{get:function(){return this._life},enumerable:!0,configurable:!0})}(),function(){function t(){this.orientation=new q,this.translation=new P}return t.prototype.toMatrix3D=function(t){return void 0===t&&(t=null),null==t&&(t=new R),this.orientation.toMatrix3D(t),t.appendTranslation(this.translation.x,this.translation.y,this.translation.z),t},t.prototype.copyFrom=function(t){var e=t.orientation,i=t.translation;this.orientation.x=e.x,this.orientation.y=e.y,this.orientation.z=e.z,this.orientation.w=e.w,this.translation.x=i.x,this.translation.y=i.y,this.translation.z=i.z},t}()),zn=function(t,e,i,n,r){this.index=t,this.startTime=e,this.totalTime=i+n,this.duration=i,this.delay=n,this.startVertexIndex=r.startVertexIndex,this.numVertices=r.numVertices},Hn=function(){},Xn=function(){function t(){}return t.GLOBAL=0,t.LOCAL_STATIC=1,t.LOCAL_DYNAMIC=2,t}(),qn=(function(t){function e(){var e=t.call(this)||this;return e.joints=new Array,e}i(e,t),Object.defineProperty(e.prototype,"numJoints",{get:function(){return this.joints.length},enumerable:!0,configurable:!0}),e.prototype.jointFromName=function(t){var e=this.jointIndexFromName(t);return-1!=e?this.joints[e]:null},e.prototype.jointIndexFromName=function(t){for(var e,i;i<this.joints.length;i++){if(this.joints[i].name==t)return e;e++}return-1},e.prototype.dispose=function(){this.joints.length=0},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[asset Skeleton]"}(p),function(t){function e(){var e=t.call(this)||this;return e.jointPoses=new Array,e}return i(e,t),Object.defineProperty(e.prototype,"numJointPoses",{get:function(){return this.jointPoses.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.jointPoseFromName=function(t){var e=this.jointPoseIndexFromName(t);return-1!=e?this.jointPoses[e]:null},e.prototype.jointPoseIndexFromName=function(t){for(var e,i;i<this.jointPoses.length;i++){if(this.jointPoses[i].name==t)return e;e++}return-1},e.prototype.clone=function(){for(var t=new e,i=this.jointPoses.length,n=0;n<i;n++){var r=new Qn,o=this.jointPoses[n];r.name=o.name,r.copyFrom(o),t.jointPoses[n]=r}return t},e.prototype.dispose=function(){this.jointPoses.length=0},e.assetType="[asset SkeletonPose]",e}(p)),Yn=function(){function t(){}return t.ADDITIVE="additive",t.ABSOLUTE="absolute",t}(),Kn=function(){function t(t,e,i,n){this._blendFactorSource=Lt.ONE,this._blendFactorDest=Lt.ZERO,this._invalidProgram=!0,this._animationVertexCode="",this._animationFragmentCode="",this._vertexCode="",this._fragmentCode="",this._postAnimationFragmentCode="",this.usesBlending=!1,this.useImageRect=!1,this.usesCurves=!1,this.depthCompareMode=Nt.LESS_EQUAL,this.writeDepth=!0,this._defaultCulling=zt.BACK,this._pInverseSceneMatrix=new Float32Array(16),this.ambientR=255,this.ambientG=255,this.ambientB=255,this.usesGlobalPosFragment=!1,this.usesPositionFragment=!1,this.imageIndices=new Array,this.id=K.ID_COUNT++,this._renderElements=t,this._renderMaterial=e,this._pass=i,this._stage=n,this._view=t.renderGroup.view,this.profile=this._stage.profile}return Object.defineProperty(t.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pass",{get:function(){return this._pass},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderMaterial",{get:function(){return this._renderMaterial},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"programData",{get:function(){return this._invalidProgram&&this._updateProgram(),this._programData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"usesAnimation",{get:function(){return this._usesAnimation},set:function(t){this._usesAnimation!=t&&(this._usesAnimation=t,this.invalidateProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numUsedVertexConstants",{get:function(){return this._invalidProgram&&this._updateProgram(),this._numUsedVertexConstants},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numUsedFragmentConstants",{get:function(){return this._invalidProgram&&this._updateProgram(),this._numUsedFragmentConstants},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numUsedStreams",{get:function(){return this._invalidProgram&&this._updateProgram(),this._numUsedStreams},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numUsedTextures",{get:function(){return this._invalidProgram&&this._updateProgram(),this._numUsedTextures},enumerable:!0,configurable:!0}),t.prototype.requestAbstraction=function(e){return t._abstractionClassPool[e.assetType]},t.registerAbstraction=function(e,i){t._abstractionClassPool[i.assetType]=e},t.prototype._includeDependencies=function(){this._renderMaterial.renderElements._includeDependencies(this),this._pass._includeDependencies(this)},t.prototype.reset=function(){this.projectionDependencies=0,this.normalDependencies=0,this.colorDependencies=0,this.viewDirDependencies=0,this.uvDependencies=0,this.secondaryUVDependencies=0,this.globalPosDependencies=0,this.tangentDependencies=0,this.usesCommonData=!1,this.usesGlobalPosFragment=!1,this.usesPositionFragment=!1,this.usesFragmentAnimation=!1,this.usesTangentSpace=!1,this.outputsNormals=!1,this.outputsTangentNormals=!1},t.prototype.setBlendMode=function(t){switch(t){case fn.NORMAL:this._blendFactorSource=Lt.ONE,this._blendFactorDest=Lt.ZERO,this.usesBlending=!1,this.usesPremultipliedAlpha=!1;break;case fn.LAYER:this._blendFactorSource=Lt.ONE,this._blendFactorDest=Lt.ONE_MINUS_SOURCE_ALPHA,this.usesBlending=!0,this.usesPremultipliedAlpha=!0;break;case fn.MULTIPLY:this._blendFactorSource=Lt.ZERO,this._blendFactorDest=Lt.SOURCE_COLOR,this.usesBlending=!0,this.usesPremultipliedAlpha=!0;break;case fn.ADD:this._blendFactorSource=Lt.ONE,this._blendFactorDest=Lt.ONE,this.usesBlending=!0,this.usesPremultipliedAlpha=!0;break;case fn.ALPHA:this._blendFactorSource=Lt.ZERO,this._blendFactorDest=Lt.SOURCE_ALPHA,this.usesBlending=!0,this.usesPremultipliedAlpha=!1;break;default:throw new S("Unsupported blend mode!")}},t.prototype._activate=function(){if(!this.programData.program){this.programData.program=this._stage.context.createProgram();var t=(new Ce).assemble("part vertex 1\n"+this.programData.vertexString+"endpart").vertex.data,e=(new Ce).assemble("part fragment 1\n"+this.programData.fragmentString+"endpart").fragment.data;this.programData.program.upload(t,e)}if(this._stage.context.setProgram(this.programData.program),this._stage.context.setCulling(this.useBothSides?zt.NONE:this._defaultCulling,this._view.projection.coordinateSystem),!this.usesTangentSpace&&this.cameraPositionIndex>=0){var i=this._view.projection.transform.concatenatedMatrix3D.position;this.vertexConstantData[this.cameraPositionIndex]=i.x,this.vertexConstantData[this.cameraPositionIndex+1]=i.y,this.vertexConstantData[this.cameraPositionIndex+2]=i.z}this._stage.context.setDepthTest(this.writeDepth&&!this.usesBlending,this.depthCompareMode),this._stage.context.setBlendFactors(this._blendFactorSource,this._blendFactorDest),this.activeElements=null},t.prototype._deactivate=function(){this._stage.context.setDepthTest(!0,Nt.LESS_EQUAL),this.activeElements=null},t.prototype._setRenderState=function(t){var e;if(t.sourceEntity.animator&&t.sourceEntity.animator.setRenderState(this,t),this.usesUVTransform){var i=t.uvMatrix;i?(e=i.rawData,this.vertexConstantData[this.uvMatrixIndex]=e[0],this.vertexConstantData[this.uvMatrixIndex+1]=e[2],this.vertexConstantData[this.uvMatrixIndex+3]=e[4],this.vertexConstantData[this.uvMatrixIndex+4]=e[1],this.vertexConstantData[this.uvMatrixIndex+5]=e[3],this.vertexConstantData[this.uvMatrixIndex+7]=e[5]):(this.vertexConstantData[this.uvMatrixIndex]=1,this.vertexConstantData[this.uvMatrixIndex+1]=0,this.vertexConstantData[this.uvMatrixIndex+3]=0,this.vertexConstantData[this.uvMatrixIndex+4]=0,this.vertexConstantData[this.uvMatrixIndex+5]=1,this.vertexConstantData[this.uvMatrixIndex+7]=0)}if(this.usesColorTransform){var n=t.sourceEntity._iAssignedColorTransform();n?(e=n._rawData,this.fragmentConstantData[this.colorTransformIndex]=e[0],this.fragmentConstantData[this.colorTransformIndex+1]=e[1],this.fragmentConstantData[this.colorTransformIndex+2]=e[2],this.fragmentConstantData[this.colorTransformIndex+3]=e[3],this.fragmentConstantData[this.colorTransformIndex+4]=e[4]/255,this.fragmentConstantData[this.colorTransformIndex+5]=e[5]/255,this.fragmentConstantData[this.colorTransformIndex+6]=e[6]/255,this.fragmentConstantData[this.colorTransformIndex+7]=e[7]/255):(this.fragmentConstantData[this.colorTransformIndex]=1,this.fragmentConstantData[this.colorTransformIndex+1]=1,this.fragmentConstantData[this.colorTransformIndex+2]=1,this.fragmentConstantData[this.colorTransformIndex+3]=1,this.fragmentConstantData[this.colorTransformIndex+4]=0,this.fragmentConstantData[this.colorTransformIndex+5]=0,this.fragmentConstantData[this.colorTransformIndex+6]=0,this.fragmentConstantData[this.colorTransformIndex+7]=0)}if(this.sceneNormalMatrixIndex>=0&&this.sceneNormalMatrix.copyFrom(t.sourceEntity.transform.inverseConcatenatedMatrix3D),this.usesTangentSpace&&this.cameraPositionIndex>=0){t.sourceEntity.transform.inverseConcatenatedMatrix3D.copyRawDataTo(this._pInverseSceneMatrix);var r=this._view.projection.transform.concatenatedMatrix3D.position,o=r.x,s=r.y,a=r.z;this.vertexConstantData[this.cameraPositionIndex]=this._pInverseSceneMatrix[0]*o+this._pInverseSceneMatrix[4]*s+this._pInverseSceneMatrix[8]*a+this._pInverseSceneMatrix[12],this.vertexConstantData[this.cameraPositionIndex+1]=this._pInverseSceneMatrix[1]*o+this._pInverseSceneMatrix[5]*s+this._pInverseSceneMatrix[9]*a+this._pInverseSceneMatrix[13],this.vertexConstantData[this.cameraPositionIndex+2]=this._pInverseSceneMatrix[2]*o+this._pInverseSceneMatrix[6]*s+this._pInverseSceneMatrix[10]*a+this._pInverseSceneMatrix[14]}},t.prototype.invalidateProgram=function(){this._invalidProgram=!0},t.prototype.dispose=function(){this._programData.dispose(),this._programData=null,this._registerCache.dispose(),this._registerCache=null,this._sharedRegisters=null},t.prototype._updateProgram=function(){if(this._invalidProgram=!1,this._sharedRegisters=new Tn,this._registerCache=new Vi(this.profile),this.reset(),this._includeDependencies(),this._initRegisterIndices(),this._compileDependencies(),this._vertexCode+=this._pass._getVertexCode(this._registerCache,this._sharedRegisters),this._fragmentCode+=this._pass._getFragmentCode(this._registerCache,this._sharedRegisters),this._postAnimationFragmentCode+=this._pass._getPostAnimationFragmentCode(this._registerCache,this._sharedRegisters),this.usesPremultipliedAlpha){var t=this._sharedRegisters.shadedTarget;this._postAnimationFragmentCode+="mul "+t+".xyz, "+t+", "+t+".w\n"}this._postAnimationFragmentCode+="mov "+this._registerCache.fragmentOutputRegister+", "+this._sharedRegisters.shadedTarget+"\n",this._registerCache.removeFragmentTempUsage(this._sharedRegisters.shadedTarget),this._compileAnimationCode(),this._initConstantData();var e=this._stage.getProgramData(this._animationVertexCode+this._vertexCode,this._fragmentCode+this._animationFragmentCode+this._postAnimationFragmentCode);this._programData!=e&&(this._programData&&this._programData.dispose(),this._programData=e,e.usages++)},t.prototype._initRegisterIndices=function(){this.commonsDataIndex=-1,this.cameraPositionIndex=-1,this.curvesIndex=-1,this.uvIndex=-1,this.uvMatrixIndex=-1,this.colorTransformIndex=-1,this.secondaryUVIndex=-1,this.normalIndex=-1,this.colorBufferIndex=-1,this.tangentIndex=-1,this.sceneMatrixIndex=-1,this.sceneNormalMatrixIndex=-1,this.jointIndexIndex=-1,this.jointWeightIndex=-1,this.imageIndices.length=0,this._sharedRegisters.animatedPosition=this._registerCache.getFreeVertexVectorTemp(),this._registerCache.addVertexTempUsages(this._sharedRegisters.animatedPosition,1),this._sharedRegisters.animatableAttributes.push(this._registerCache.getFreeVertexAttribute()),this._sharedRegisters.animationTargetRegisters.push(this._sharedRegisters.animatedPosition),this._vertexCode="",this._fragmentCode="",this._postAnimationFragmentCode="",(this.usesCommonData||this.normalDependencies>0)&&(this._sharedRegisters.commons=this._registerCache.getFreeFragmentConstant(),this.commonsDataIndex=4*this._sharedRegisters.commons.index),(this.tangentDependencies>0||this.outputsNormals)&&(this._sharedRegisters.tangentInput=this._registerCache.getFreeVertexAttribute(),this.tangentIndex=this._sharedRegisters.tangentInput.index,this._sharedRegisters.animatedTangent=this._registerCache.getFreeVertexVectorTemp(),this._registerCache.addVertexTempUsages(this._sharedRegisters.animatedTangent,1),this.usesTangentSpace&&(this._sharedRegisters.bitangent=this._registerCache.getFreeVertexVectorTemp(),this._registerCache.addVertexTempUsages(this._sharedRegisters.bitangent,1)),this._sharedRegisters.animatableAttributes.push(this._sharedRegisters.tangentInput),this._sharedRegisters.animationTargetRegisters.push(this._sharedRegisters.animatedTangent)),this.normalDependencies>0&&(this._sharedRegisters.normalInput=this._registerCache.getFreeVertexAttribute(),this.normalIndex=this._sharedRegisters.normalInput.index,this._sharedRegisters.animatedNormal=this._registerCache.getFreeVertexVectorTemp(),this._registerCache.addVertexTempUsages(this._sharedRegisters.animatedNormal,1),this._sharedRegisters.animatableAttributes.push(this._sharedRegisters.normalInput),this._sharedRegisters.animationTargetRegisters.push(this._sharedRegisters.animatedNormal)),this.uvDependencies>0&&(this._sharedRegisters.uvInput=this._registerCache.getFreeVertexAttribute(),this.uvIndex=this._sharedRegisters.uvInput.index,this.usesUVTransform||(this._sharedRegisters.animatedUV=this._registerCache.getFreeVertexVectorTemp(),this._registerCache.addVertexTempUsages(this._sharedRegisters.animatedUV,1))),this._sharedRegisters.shadedTarget=this._registerCache.getFreeFragmentVectorTemp(),this._registerCache.addFragmentTempUsages(this._sharedRegisters.shadedTarget,1)},t.prototype._compileDependencies=function(){this.colorDependencies>0&&this._compileColorCode(),this.globalPosDependencies>0&&this._compileGlobalPositionCode(),this.usesPositionFragment&&this._compilePositionCode(),this.usesCurves&&this._compileCurvesCode(),this.usesColorTransform&&this._compileColorTransformCode(),this.uvDependencies>0&&this._compileUVCode(),this.secondaryUVDependencies>0&&this._compileSecondaryUVCode(),this.normalDependencies>0&&this._compileNormalCode(),this.viewDirDependencies>0&&this._compileViewDirCode(),this._vertexCode+=this._renderElements._getVertexCode(this,this._registerCache,this._sharedRegisters),this._fragmentCode+=this._renderElements._getFragmentCode(this,this._registerCache,this._sharedRegisters)},t.prototype._initConstantData=function(){var t=this._registerCache,e=this._numUsedVertexConstants=t.numUsedVertexConstants,i=this._numUsedFragmentConstants=t.numUsedFragmentConstants;if(this._numUsedStreams=t.numUsedStreams,this._numUsedTextures=t.numUsedTextures,this.vertexConstantData&&this.vertexConstantData.length===4*e||(this.vertexConstantData=new Float32Array(4*e)),this.fragmentConstantData&&this.fragmentConstantData.length===4*i||(this.fragmentConstantData=new Float32Array(4*this._registerCache.numUsedFragmentConstants)),this.viewMatrixIndex>=0){var n=new Float32Array(this.vertexConstantData.buffer,4*this.viewMatrixIndex,16);this.viewMatrix?this.viewMatrix._rawData=n:this.viewMatrix=new R(n)}else this.viewMatrix&&(this.viewMatrix=null);if(this.sceneMatrixIndex>=0){n=new Float32Array(this.vertexConstantData.buffer,4*this.sceneMatrixIndex,16);this.sceneMatrix?this.sceneMatrix._rawData=n:this.sceneMatrix=new R(n)}else this.sceneMatrix&&(this.sceneMatrix=null);if(this.commonsDataIndex>=0&&(this.fragmentConstantData[this.commonsDataIndex]=.5,this.fragmentConstantData[this.commonsDataIndex+1]=0,this.fragmentConstantData[this.commonsDataIndex+2]=1/255,this.fragmentConstantData[this.commonsDataIndex+3]=1),this.uvMatrixIndex>=0&&(this.vertexConstantData[this.uvMatrixIndex]=1,this.vertexConstantData[this.uvMatrixIndex+1]=0,this.vertexConstantData[this.uvMatrixIndex+2]=0,this.vertexConstantData[this.uvMatrixIndex+3]=0,this.vertexConstantData[this.uvMatrixIndex+4]=0,this.vertexConstantData[this.uvMatrixIndex+5]=1,this.vertexConstantData[this.uvMatrixIndex+6]=0,this.vertexConstantData[this.uvMatrixIndex+7]=0),this.colorTransformIndex>=0&&(this.fragmentConstantData[this.colorTransformIndex]=1,this.fragmentConstantData[this.colorTransformIndex+1]=1,this.fragmentConstantData[this.colorTransformIndex+2]=1,this.fragmentConstantData[this.colorTransformIndex+3]=1,this.fragmentConstantData[this.colorTransformIndex+4]=0,this.fragmentConstantData[this.colorTransformIndex+5]=0,this.fragmentConstantData[this.colorTransformIndex+6]=0,this.fragmentConstantData[this.colorTransformIndex+7]=0),this.sceneNormalMatrixIndex>=0){n=new Float32Array(this.vertexConstantData.buffer,4*this.sceneNormalMatrixIndex,16);this.sceneNormalMatrix?this.sceneNormalMatrix._rawData=n:this.sceneNormalMatrix=new R(n)}else this.sceneNormalMatrix&&(this.sceneNormalMatrix=null);this.cameraPositionIndex>=0&&(this.vertexConstantData[this.cameraPositionIndex+3]=1),this._pass._initConstantData(),this._usesAnimation&&this._renderMaterial.animationSet.doneAGALCode(this)},t.prototype._compileColorCode=function(){this._sharedRegisters.colorInput=this._registerCache.getFreeVertexAttribute(),this.colorBufferIndex=this._sharedRegisters.colorInput.index,this._sharedRegisters.colorVarying=this._registerCache.getFreeVarying(),this._vertexCode+="mov "+this._sharedRegisters.colorVarying+", "+this._sharedRegisters.colorInput+"\n"},t.prototype._compileGlobalPositionCode=function(){var t=this._sharedRegisters.globalPositionVertex=this._registerCache.getFreeVertexVectorTemp();this._registerCache.addVertexTempUsages(t,this.globalPosDependencies);var e=this._registerCache.getFreeVertexConstant();this._registerCache.getFreeVertexConstant(),this._registerCache.getFreeVertexConstant(),this._registerCache.getFreeVertexConstant(),this.sceneMatrixIndex=4*e.index;var i=this._sharedRegisters;this._vertexCode+="m44 "+i.globalPositionVertex+", "+i.animatedPosition+", "+e+"\n",this.usesGlobalPosFragment&&(i.globalPositionVarying=this._registerCache.getFreeVarying(),this._vertexCode+="mov "+i.globalPositionVarying+", "+i.globalPositionVertex+"\n")},t.prototype._compilePositionCode=function(){var t=this._sharedRegisters;t.positionVarying=this._registerCache.getFreeVarying(),this._vertexCode+="mov "+t.positionVarying+", "+t.animatedPosition+"\n"},t.prototype._compileCurvesCode=function(){var t=this._sharedRegisters;t.curvesInput=this._registerCache.getFreeVertexAttribute(),this.curvesIndex=t.curvesInput.index,t.curvesVarying=this._registerCache.getFreeVarying(),this._vertexCode+="mov "+t.curvesVarying+", "+t.curvesInput+"\n";var e=this._registerCache.getFreeFragmentSingleTemp();this._fragmentCode+="mul "+e+", "+t.curvesVarying+".y, "+t.curvesVarying+".y\nsub "+e+", "+e+", "+t.curvesVarying+".z\nmul "+e+", "+e+", "+t.curvesVarying+".x\nkil "+e+"\n"},t.prototype._compileColorTransformCode=function(){var t=this._registerCache.getFreeFragmentConstant(),e=this._registerCache.getFreeFragmentConstant(),i=this._sharedRegisters.shadedTarget;this.colorTransformIndex=4*t.index,this._postAnimationFragmentCode+="mul "+i+", "+i+", "+t+"\n",this._postAnimationFragmentCode+="add "+i+", "+i+", "+e+"\n"},t.prototype._compileUVCode=function(){var t=this._sharedRegisters;if(t.uvVarying=this._registerCache.getFreeVarying(),this.usesUVTransform){var e=this._registerCache.getFreeVertexConstant(),i=this._registerCache.getFreeVertexConstant();this.uvMatrixIndex=4*e.index,this._vertexCode+="dp4 "+t.uvVarying+".x, "+t.uvInput+", "+e+"\ndp4 "+t.uvVarying+".y, "+t.uvInput+", "+i+"\nmov "+t.uvVarying+".zw, "+t.uvInput+".zw \n"}else this._vertexCode+="mov "+t.uvVarying+", "+t.animatedUV+"\n"},t.prototype._compileSecondaryUVCode=function(){var t=this._registerCache.getFreeVertexAttribute(),e=this._sharedRegisters;this.secondaryUVIndex=t.index,e.secondaryUVVarying=this._registerCache.getFreeVarying(),this._vertexCode+="mov "+e.secondaryUVVarying+", "+t+"\n"},t.prototype._compileViewDirCode=function(){var t=this._registerCache.getFreeVertexConstant(),e=this._sharedRegisters;if(e.viewDirVarying=this._registerCache.getFreeVarying(),e.viewDirFragment=this._registerCache.getFreeFragmentVectorTemp(),this._registerCache.addFragmentTempUsages(e.viewDirFragment,this.viewDirDependencies),this.cameraPositionIndex=4*t.index,this.usesTangentSpace){var i=this._registerCache.getFreeVertexVectorTemp();this._vertexCode+="sub "+i+", "+t+", "+e.animatedPosition+"\nm33 "+e.viewDirVarying+".xyz, "+i+", "+e.animatedTangent+"\nmov "+e.viewDirVarying+".w, "+e.animatedPosition+".w\n"}else this._vertexCode+="sub "+e.viewDirVarying+", "+t+", "+e.globalPositionVertex+"\n",this._registerCache.removeVertexTempUsage(this._sharedRegisters.globalPositionVertex);this._fragmentCode+="nrm "+e.viewDirFragment+".xyz, "+e.viewDirVarying+"\nmov "+e.viewDirFragment+".w,   "+e.viewDirVarying+".w\n"},t.prototype._compileNormalCode=function(){var t,e=this._sharedRegisters;if(e.normalFragment=this._registerCache.getFreeFragmentVectorTemp(),this._registerCache.addFragmentTempUsages(e.normalFragment,this.normalDependencies),this.outputsNormals&&!this.outputsTangentNormals)return this._vertexCode+=this._pass._getNormalVertexCode(this._registerCache,e),void(this._fragmentCode+=this._pass._getNormalFragmentCode(this._registerCache,e));if(this.outputsNormals&&this.usesTangentSpace||((t=new Array(3))[0]=this._registerCache.getFreeVertexConstant(),t[1]=this._registerCache.getFreeVertexConstant(),t[2]=this._registerCache.getFreeVertexConstant(),this._registerCache.getFreeVertexConstant(),this.sceneNormalMatrixIndex=4*t[0].index,e.normalVarying=this._registerCache.getFreeVarying()),this.outputsNormals)if(this.usesTangentSpace)this._vertexCode+="nrm "+e.animatedNormal+".xyz, "+e.animatedNormal+"\nnrm "+e.animatedTangent+".xyz, "+e.animatedTangent+"\ncrs "+e.bitangent+".xyz, "+e.animatedNormal+", "+e.animatedTangent+"\n",this._fragmentCode+=this._pass._getNormalFragmentCode(this._registerCache,e);else{e.tangentVarying=this._registerCache.getFreeVarying(),e.bitangentVarying=this._registerCache.getFreeVarying();var i=this._registerCache.getFreeVertexVectorTemp();this._vertexCode+="m33 "+i+".xyz, "+e.animatedNormal+", "+t[0]+"\nnrm "+e.animatedNormal+".xyz, "+i+"\nm33 "+i+".xyz, "+e.animatedTangent+", "+t[0]+"\nnrm "+e.animatedTangent+".xyz, "+i+"\nmov "+e.tangentVarying+".x, "+e.animatedTangent+".x  \nmov "+e.tangentVarying+".z, "+e.animatedNormal+".x  \nmov "+e.tangentVarying+".w, "+e.normalInput+".w  \nmov "+e.bitangentVarying+".x, "+e.animatedTangent+".y  \nmov "+e.bitangentVarying+".z, "+e.animatedNormal+".y  \nmov "+e.bitangentVarying+".w, "+e.normalInput+".w  \nmov "+e.normalVarying+".x, "+e.animatedTangent+".z  \nmov "+e.normalVarying+".z, "+e.animatedNormal+".z  \nmov "+e.normalVarying+".w, "+e.normalInput+".w  \ncrs "+i+".xyz, "+e.animatedNormal+", "+e.animatedTangent+"\nmov "+e.tangentVarying+".y, "+i+".x    \nmov "+e.bitangentVarying+".y, "+i+".y  \nmov "+e.normalVarying+".y, "+i+".z    \n",this._registerCache.removeVertexTempUsage(e.animatedTangent);var n=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(n,1);var r=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(r,1);var o=this._registerCache.getFreeFragmentVectorTemp();this._registerCache.addFragmentTempUsages(o,1),this._fragmentCode+="nrm "+n+".xyz, "+e.tangentVarying+"\nmov "+n+".w, "+e.tangentVarying+".w\t\nnrm "+r+".xyz, "+e.bitangentVarying+"\nnrm "+o+".xyz, "+e.normalVarying+"\n",this._fragmentCode+=this._pass._getNormalFragmentCode(this._registerCache,e)+"m33 "+e.normalFragment+".xyz, "+e.normalFragment+", "+n+"\nmov "+e.normalFragment+".w, "+e.normalVarying+".w\n",this._registerCache.removeFragmentTempUsage(r),this._registerCache.removeFragmentTempUsage(n),this._registerCache.removeFragmentTempUsage(o)}else this._vertexCode+="m33 "+e.normalVarying+".xyz, "+e.animatedNormal+", "+t[0]+"\nmov "+e.normalVarying+".w, "+e.animatedNormal+".w\n",this._fragmentCode+="nrm "+e.normalFragment+".xyz, "+e.normalVarying+"\nmov "+e.normalFragment+".w, "+e.normalVarying+".w\n",this.tangentDependencies>0&&(e.tangentVarying=this._registerCache.getFreeVarying(),this._vertexCode+="m33 "+e.tangentVarying+".xyz, "+e.animatedTangent+", "+t[0]+"\nmov "+e.tangentVarying+".w, "+e.animatedTangent+".w\n");this.usesTangentSpace||this._registerCache.removeVertexTempUsage(e.animatedNormal)},t.prototype._compileAnimationCode=function(){this._animationVertexCode="",this._animationFragmentCode="";var t=this._sharedRegisters;if(this._usesAnimation){var e=this._renderMaterial.animationSet;this._animationVertexCode+=e.getAGALVertexCode(this,this._registerCache,t),this.uvDependencies>0&&!this.usesUVTransform&&(this._animationVertexCode+=e.getAGALUVCode(this,this._registerCache,t)),this.usesFragmentAnimation&&(this._animationFragmentCode+=e.getAGALFragmentCode(this,this._registerCache,t.shadedTarget))}else{for(var i=t.animatableAttributes.length,n=0;n<i;++n)this._animationVertexCode+="mov "+t.animationTargetRegisters[n]+", "+t.animatableAttributes[n]+"\n";this.uvDependencies>0&&!this.usesUVTransform&&(this._animationVertexCode+="mov "+t.animatedUV+","+t.uvInput+"\n")}},t.prototype.setVertexConst=function(t,e,i,n,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),t*=4,this.vertexConstantData[t++]=e,this.vertexConstantData[t++]=i,this.vertexConstantData[t++]=n,this.vertexConstantData[t]=r},t.prototype.setVertexConstFromArray=function(t,e){t*=4;for(var i=0;i<e.length;i++)this.vertexConstantData[t++]=e[i]},t.prototype.setVertexConstFromMatrix=function(t,e){t*=4;var i=e._rawData;this.vertexConstantData[t++]=i[0],this.vertexConstantData[t++]=i[4],this.vertexConstantData[t++]=i[8],this.vertexConstantData[t++]=i[12],this.vertexConstantData[t++]=i[1],this.vertexConstantData[t++]=i[5],this.vertexConstantData[t++]=i[9],this.vertexConstantData[t++]=i[13],this.vertexConstantData[t++]=i[2],this.vertexConstantData[t++]=i[6],this.vertexConstantData[t++]=i[10],this.vertexConstantData[t++]=i[14],this.vertexConstantData[t++]=i[3],this.vertexConstantData[t++]=i[7],this.vertexConstantData[t++]=i[11],this.vertexConstantData[t]=i[15]},t.prototype.setFragmentConst=function(t,e,i,n,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),t*=4,this.fragmentConstantData[t++]=e,this.fragmentConstantData[t++]=i,this.fragmentConstantData[t++]=n,this.fragmentConstantData[t]=r},t._abstractionClassPool=new Object,t}(),Wn=function(t){function e(e,i){var n=t.call(this,e)||this;return n._pass=i,n}return i(e,t),Object.defineProperty(e.prototype,"pass",{get:function(){return this._pass},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._pass)},e.INVALIDATE="invalidatePass",e}(a),Jn=function(t){function e(e,i){var n=t.call(this,e)||this;return n._material=i,n}return i(e,t),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._material)},e.INVALIDATE_TEXTURES="invalidateTextures",e.INVALIDATE_PASSES="invalidatePasses",e}(a),Zn=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._owners=new Array,n._passes=new Array,n._invalidAnimation=!0,n._invalidRender=!0,n._invalidImages=!0,n._imageIndices=new Object,n._usesAnimation=!1,n.images=new Array,n.samplers=new Array,n.requiresBlending=!1,n.materialID=e.id,n._material=e,n._renderElements=i,n._stage=i.stage,n._renderGroup=i.renderGroup,n._onInvalidateTexturesDelegate=function(t){return n.onInvalidateTextures(t)},n._onInvalidatePassesDelegate=function(t){return n.onInvalidatePasses(t)},n._material.addEventListener(Jn.INVALIDATE_TEXTURES,n._onInvalidateTexturesDelegate),n._material.addEventListener(Jn.INVALIDATE_PASSES,n._onInvalidatePassesDelegate),n._onPassInvalidateDelegate=function(t){return n.onPassInvalidate(t)},n}return i(e,t),Object.defineProperty(e.prototype,"animationSet",{get:function(){return this._animationSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numImages",{get:function(){return this._invalidImages&&this._updateImages(),this._numImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderOrderId",{get:function(){return this._invalidAnimation&&this._updateAnimation(),this._renderOrderId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numPasses",{get:function(){return this._invalidAnimation&&this._updateAnimation(),this._passes.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._material.style},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderGroup",{get:function(){return this._renderGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderElements",{get:function(){return this._renderElements},enumerable:!0,configurable:!0}),e.prototype.activatePass=function(t){var e;for(this._activePass=this._passes[t],e=this._activePass.shader.numUsedStreams;e<this._stage.numUsedStreams;e++)this._stage.context.setVertexBufferAt(e,null);for(e=this._activePass.shader.numUsedTextures;e<this._stage.numUsedTextures;e++)this._stage.context.setTextureAt(e,null);this._activePass._activate(this._renderGroup.view)},e.prototype.deactivatePass=function(){this._activePass._deactivate(),this._stage.numUsedStreams=this._activePass.shader.numUsedStreams,this._stage.numUsedTextures=this._activePass.shader.numUsedTextures},e.prototype.addOwner=function(t){var e;this._owners.push(t);var i=t.sourceEntity.animator;if(i&&(e=i.animationSet),t.sourceEntity.animator){if(this._animationSet&&e!=this._animationSet)throw new Error("A Material instance cannot be shared across material owners with different animation sets");this._animationSet!=e&&(this._animationSet=e,this._invalidAnimation=!0)}},e.prototype.removeOwner=function(t){this._owners.splice(this._owners.indexOf(t),1),this._owners.length||this.onClear(null)},e.prototype.getImageIndex=function(t,e){return void 0===e&&(e=0),this._invalidImages&&this._updateImages(),this._imageIndices[t.id][e]},e.prototype.onClear=function(e){t.prototype.onClear.call(this,e);for(var i=this._passes.length,n=0;n<i;n++)this._passes[n].removeEventListener(Wn.INVALIDATE,this._onPassInvalidateDelegate),this._passes[n].dispose();this._passes=null,this._material.removeEventListener(Jn.INVALIDATE_TEXTURES,this._onInvalidateTexturesDelegate),this._material.removeEventListener(Jn.INVALIDATE_PASSES,this._onInvalidatePassesDelegate),this._animationSet=null,this._material=null,this._renderElements=null,this._stage=null,this._owners=null},e.prototype.onInvalidatePasses=function(t){for(var e=this._passes.length,i=0;i<e;i++)this._passes[i].invalidate();this._invalidAnimation=!0,this._invalidImages=!0},e.prototype.onPassInvalidate=function(t){this._invalidAnimation=!0},e.prototype.onInvalidateTextures=function(t){for(var e=this._owners,i=e.length,n=0;n<i;n++)e[n]._onInvalidateStyle()},e.prototype.onInvalidate=function(e){t.prototype.onInvalidate.call(this,e),this._invalidRender=!0,this._invalidAnimation=!0},e.prototype._pClearPasses=function(){for(var t=this._passes.length,e=0;e<t;++e)this._passes[e].removeEventListener(Wn.INVALIDATE,this._onPassInvalidateDelegate);this._passes.length=0},e.prototype._pAddPass=function(t){this._passes.push(t),t.addEventListener(Wn.INVALIDATE,this._onPassInvalidateDelegate)},e.prototype._pRemovePass=function(t){t.removeEventListener(Wn.INVALIDATE,this._onPassInvalidateDelegate),this._passes.splice(this._passes.indexOf(t),1)},e.prototype._pUpdateRender=function(){this._invalidRender=!1},e.prototype._updateAnimation=function(){this._invalidRender&&this._pUpdateRender(),this._invalidAnimation=!1;for(var t,e=this._getEnabledGPUAnimation(),i=0,n=1,r=this._passes.length,o=0;o<r;o++)(t=this._passes[o].shader).usesAnimation=e,t._programData?i+=t._programData.id*n:i+=t.programData.id*n,n*=1e3;if(this._usesAnimation!=e){this._usesAnimation=e;for(var s=this._owners,a=s.length,l=0;l<a;l++)s[l]._onInvalidateElements()}this._renderOrderId=i},e.prototype._updateImages=function(){var t,e;this._invalidImages=!1;for(var i,n,r,o,s=this._material.style,a=this._material.getNumTextures(),l=0,u=0;u<a;u++){n=(i=this._material.getTextureAt(u)).getNumImages(),r=this._imageIndices[i.id]=new Array;for(var c=0;c<n;c++)o=i.getImageAt(c)||(null===(t=s)||void 0===t?void 0:t.getImageAt(i,c))||on.getDefaultImage2D(),this.images[l]=o.getAbstraction(this._stage),this.samplers[l]=i.getSamplerAt(c)||(null===(e=s)||void 0===e?void 0:e.getSamplerAt(i,c))||on.getDefaultSampler(),r[c]=l++}this._numImages=l},e.prototype._getEnabledGPUAnimation=function(){if(this._animationSet){this._animationSet.resetGPUCompatibility();for(var t=this._owners,e=t.length,i=this._passes.length,n=void 0,r=0;r<i;r++){(n=this._passes[r].shader).usesAnimation=!1;for(var o=0;o<e;o++)t[o].sourceEntity.animator&&t[o].sourceEntity.animator.testGPUCompatibility(n)}return!this._animationSet.usesCPU}return!1},e}(K),$n=function(){function t(t,e,i){this.id=K.ID_COUNT++,this.stage=t,this._materialClassPool=e,this.renderGroup=i}return t.prototype.requestAbstraction=function(t){return this._materialClassPool[t.assetType]},t.prototype._includeDependencies=function(t){},t.prototype._getVertexCode=function(t,e,i){return""},t.prototype._getFragmentCode=function(t,e,i){return""},t}(),tr=function(t){function e(e,i){var n=t.call(this,e)||this;return n._renderable=i,n}return i(e,t),Object.defineProperty(e.prototype,"renderable",{get:function(){return this._renderable},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._renderable)},e.INVALIDATE_MATERIAL="invalidateMaterial",e.INVALIDATE_ELEMENTS="invalidateElements",e.INVALIDATE_STYLE="invalidateStyle",e}(a),er=function(){function t(){}return t.getDefaultTextureMaterial=function(){return this._defaultTextureMaterial||this.createDefaultTextureMaterial(),this._defaultTextureMaterial},t.getDefaultCubeTextureMaterial=function(){return this._defaultCubeTextureMaterial||this.createDefaultCubeTextureMaterial(),this._defaultCubeTextureMaterial},t.getDefaultColorMaterial=function(){return t._defaultColorMaterial||t.createDefaultColorMaterial(),t._defaultColorMaterial},t.createDefaultTextureMaterial=function(){this._defaultTextureMaterial=new this._defaultMaterialClass(on.getDefaultImage2D()),this._defaultTextureMaterial.name="defaultTextureMaterial"},t.createDefaultCubeTextureMaterial=function(){this._defaultCubeTextureMaterial=new this._defaultMaterialClass(on.getDefaultImageCube()),this._defaultCubeTextureMaterial.name="defaultCubeTextureMaterial"},t.createDefaultColorMaterial=function(){this._defaultColorMaterial=new this._defaultMaterialClass(16777215),this._defaultColorMaterial.name="defaultColorMaterial"},t.setDefaultMaterialClass=function(t){this._defaultMaterialClass=t},t}(),ir=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._materialDirty=!0,n._elementsDirty=!0,n._styleDirty=!0,n._images=new Array,n._samplers=new Array,n._count=0,n._offset=0,n._maskId=-1,n._onInvalidateElementsDelegate=function(t){return n._onInvalidateElements(t)},n._onInvalidateMaterialDelegate=function(t){return n._onInvalidateMaterial(t)},n._onInvalidateStyleDelegate=function(t){return n._onInvalidateStyle(t)},n.sourceEntity=i.entity,n._stage=i.stage,n.renderGroup=i.renderGroup,n._asset.addEventListener(tr.INVALIDATE_ELEMENTS,n._onInvalidateElementsDelegate),n._asset.addEventListener(tr.INVALIDATE_MATERIAL,n._onInvalidateMaterialDelegate),n._asset.addEventListener(tr.INVALIDATE_STYLE,n._onInvalidateStyleDelegate),n}return i(e,t),Object.defineProperty(e.prototype,"images",{get:function(){return this._styleDirty&&this._updateStyle(),this._images},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"samplers",{get:function(){return this._styleDirty&&this._updateStyle(),this._samplers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uvMatrix",{get:function(){return this._styleDirty&&this._updateStyle(),this._uvMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maskId",{get:function(){return this._maskId},set:function(t){t!==this._maskId&&this._updateMaskHack(t>=0),this._maskId=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageElements",{get:function(){return this._elementsDirty&&this._updateElements(),this._stageElements},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderMaterial",{get:function(){return this._materialDirty&&this._updateMaterial(),this._renderMaterial},enumerable:!0,configurable:!0}),e.prototype._updateMaskHack=function(t){},e.prototype.executeRender=function(t,e,i,n){var r=this._renderMaterial._activePass;r._setRenderState(this);var o=r.shader,s=this.stageElements;o.activeElements!=s&&(o.activeElements=s,s._setRenderState(this,o)),this._stageElements.draw(this,o,this._count,this._offset)},e.prototype.onClear=function(e){this._asset.removeEventListener(tr.INVALIDATE_ELEMENTS,this._onInvalidateElementsDelegate),this._asset.removeEventListener(tr.INVALIDATE_MATERIAL,this._onInvalidateMaterialDelegate),this._asset.removeEventListener(tr.INVALIDATE_STYLE,this._onInvalidateStyleDelegate),t.prototype.onClear.call(this,e),this.renderSceneTransform=null,this._stage=null,this.next=null,this.maskOwners=null,this._renderMaterial.removeOwner(this),this._renderMaterial=null,this._stageElements=null},e.prototype._onInvalidateElements=function(t){this._elementsDirty=!0},e.prototype._onInvalidateMaterial=function(t){this._materialDirty=!0,this._styleDirty=!0},e.prototype._onInvalidateStyle=function(t){this._styleDirty=!0},e.prototype._getStageElements=function(){throw new s},e.prototype._getRenderMaterial=function(){throw new s},e.prototype._getStyle=function(){throw new s},e.prototype._updateElements=function(){this._stageElements=this._getStageElements(),this._elementsDirty=!1},e.prototype._updateMaterial=function(){var t=this._getRenderMaterial();this._renderMaterial!=t&&(this._renderMaterial&&this._renderMaterial.removeOwner(this),this._renderMaterial=t,this._renderMaterial.addOwner(this)),this._materialDirty=!1},e.prototype._updateStyle=function(){var t=this._getStyle();this._materialDirty&&this._updateMaterial();var e=this._renderMaterial.numImages,i=this._renderMaterial.material;this._images.length=e,this._samplers.length=e,this._uvMatrix=t?t.uvMatrix:i.style?i.style.uvMatrix:null;for(var n,r,o,s=this._renderMaterial.material.getNumTextures(),a=0;a<s;a++){e=(n=i.getTextureAt(a)).getNumImages();for(var l=0;l<e;l++)o=this._renderMaterial.getImageIndex(n,l),r=t?t.getImageAt(n,l):null,this._images[o]=r?r.getAbstraction(this._stage):null,this._samplers[o]=t?t.getSamplerAt(n,l):null}this._styleDirty=!1},e.prototype.getDefaultMaterial=function(){return er.getDefaultTextureMaterial()},e}(K),nr=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._abstractionPool=new Object,n.id=K.ID_COUNT++,n._stage=i.stage,n._renderGroup=i,n._onInvalidateElementsDelegate=function(t){return n._onInvalidateElements(t)},n._onInvalidateMaterialDelegate=function(t){return n._onInvalidateMaterial(t)},n._onInvalidateStyleDelegate=function(t){return n._onInvalidateStyle(t)},n._asset.addEventListener(tr.INVALIDATE_ELEMENTS,n._onInvalidateElementsDelegate),n._asset.addEventListener(tr.INVALIDATE_MATERIAL,n._onInvalidateMaterialDelegate),n._asset.addEventListener(tr.INVALIDATE_STYLE,n._onInvalidateStyleDelegate),n}return i(e,t),Object.defineProperty(e.prototype,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entity",{get:function(){return this._asset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderGroup",{get:function(){return this._renderGroup},enumerable:!0,configurable:!0}),e.prototype.onClear=function(e){this._asset.removeEventListener(tr.INVALIDATE_ELEMENTS,this._onInvalidateElementsDelegate),this._asset.removeEventListener(tr.INVALIDATE_MATERIAL,this._onInvalidateMaterialDelegate),this._asset.removeEventListener(tr.INVALIDATE_STYLE,this._onInvalidateStyleDelegate),t.prototype.onClear.call(this,e)},e.prototype._onInvalidateElements=function(t){for(var e in this._abstractionPool)this._abstractionPool[e]._onInvalidateElements()},e.prototype._onInvalidateMaterial=function(t){for(var e in this._abstractionPool)this._abstractionPool[e]._onInvalidateMaterial()},e.prototype._onInvalidateStyle=function(t){for(var e in this._abstractionPool)this._abstractionPool[e]._onInvalidateStyle()},e.prototype.requestAbstraction=function(t){return e._renderRenderableClassPool[t.assetType]},e.registerRenderable=function(t,i){e._renderRenderableClassPool[i.assetType]=t},e._renderRenderableClassPool=new Object,e}(K),rr=function(t){function e(e,i){var n=t.call(this,e)||this;return n._style=i,n}return i(e,t),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._style)},e.INVALIDATE_PROPERTIES="invalidateProperties",e}(a),or=function(t){function e(){var e=t.call(this)||this;return e._samplers=new Object,e._images=new Object,e._color=16777215,e}return i(e,t),Object.defineProperty(e.prototype,"sampler",{get:function(){return this._sampler},set:function(t){this._sampler!=t&&(this._sampler=t,this._invalidateProperties())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"image",{get:function(){return this._image},set:function(t){this._image!=t&&(this._image=t,this._invalidateProperties())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uvMatrix",{get:function(){return this._uvMatrix},set:function(t){this._uvMatrix!=t&&(this._uvMatrix=t,this._invalidateProperties())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t,this._invalidateProperties())},enumerable:!0,configurable:!0}),e.prototype.getImageAt=function(t,e){return void 0===e&&(e=0),(this._images[t.id]?this._images[t.id][e]:null)||this._image},e.prototype.getSamplerAt=function(t,e){return void 0===e&&(e=0),(this._samplers[t.id]?this._samplers[t.id][e]:null)||this._sampler},e.prototype.addImageAt=function(t,e,i){void 0===i&&(i=0),this._images[e.id]||(this._images[e.id]=new Array),this._images[e.id][i]=t},e.prototype.addSamplerAt=function(t,e,i){void 0===i&&(i=0),this._samplers[e.id]||(this._samplers[e.id]=new Array),this._samplers[e.id][i]=t,this._invalidateProperties()},e.prototype.removeImageAt=function(t,e){void 0===e&&(e=0),this._images[t.id]&&(this._images[t.id][e]=null,this._invalidateProperties())},e.prototype.removeSamplerAt=function(t,e){void 0===e&&(e=0),this._samplers[t.id]&&(this._samplers[t.id][e]=null,this._invalidateProperties())},e.prototype._invalidateProperties=function(){this.dispatchEvent(new rr(rr.INVALIDATE_PROPERTIES,this))},e}(u),sr=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._texture=e,n._shader=i,n._stage=i._stage,n}return i(e,t),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._texture=null,this._shader=null,this._stage=null},e.prototype._initVO=function(t){},e.prototype._initConstants=function(){},e.prototype._getFragmentCode=function(t,e,i,n){throw new s},e.prototype._setRenderState=function(t){},e.prototype.activate=function(){},e.prototype.getTextureReg=function(t,e,i){var n=this._shader.imageIndices.indexOf(t);if(-1==n){var r=e.getFreeTextureReg();return i.textures.push(r),this._shader.imageIndices.push(t),r}return i.textures[n]},e}(K),ar=function(){function t(){this.indexDictionary=new Object}return t.prototype.reset=function(t,e,i){this.rotationRegisters=new Array,this.positionAttribute=e.animatableAttributes[0],this.scaleAndRotateTarget=e.animationTargetRegisters[0];for(var n=1;n<e.animationTargetRegisters.length;n++)this.rotationRegisters.push(e.animationTargetRegisters[n]);if(this.vertexZeroConst=t.getFreeVertexConstant(),this.vertexZeroConst=new Fi(this.vertexZeroConst.regName,this.vertexZeroConst.index,0),this.vertexOneConst=new Fi(this.vertexZeroConst.regName,this.vertexZeroConst.index,1),this.vertexTwoConst=new Fi(this.vertexZeroConst.regName,this.vertexZeroConst.index,2),this.positionTarget=t.getFreeVertexVectorTemp(),t.addVertexTempUsages(this.positionTarget,1),this.positionTarget=new Fi(this.positionTarget.regName,this.positionTarget.index),i)this.velocityTarget=t.getFreeVertexVectorTemp(),t.addVertexTempUsages(this.velocityTarget,1),this.velocityTarget=new Fi(this.velocityTarget.regName,this.velocityTarget.index),this.vertexTime=new Fi(this.velocityTarget.regName,this.velocityTarget.index,3),this.vertexLife=new Fi(this.positionTarget.regName,this.positionTarget.index,3);else{var r=t.getFreeVertexVectorTemp();t.addVertexTempUsages(r,1),this.vertexTime=new Fi(r.regName,r.index,0),this.vertexLife=new Fi(r.regName,r.index,1)}},t.prototype.setUVSourceAndTarget=function(t){this.uvVar=t.animatedUV,this.uvAttribute=t.uvInput,this.uvTarget=new Fi(this.positionTarget.regName,this.positionTarget.index)},t.prototype.setRegisterIndex=function(t,e,i){var n=this.indexDictionary[t.id];null==n&&(n=this.indexDictionary[t.id]=new Array(8)),n[e]=i},t.prototype.getRegisterIndex=function(t,e){return this.indexDictionary[t.id][e]},t}(),lr=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e.prototype,"stateClass",{get:function(){return this._pStateClass},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[asset AnimationNodeBase]",e}(p),ur=function(t){function e(e,i){var n=t.call(this,e)||this;return n._attributesView=i,n}return i(e,t),Object.defineProperty(e.prototype,"attributesView",{get:function(){return this._attributesView},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._attributesView)},e.INVALIDATE_INDICES="invalidateIndices",e.CLEAR_INDICES="clearIndices",e.INVALIDATE_VERTICES="invalidateVertices",e.CLEAR_VERTICES="clearVertices",e}(a),cr=function(){function t(){}return t.generateFaceNormals=function(t,e,i,n,r){void 0===r&&(r=0);var o=t.get(n,r),s=e.get(e.count);null==i?i=new kn(n+r):i.count<n+r&&(i.count=n+r);var a,l,u,c,h,p,d,f,_,m,g,y,A,v,b,x,C,w,I,E=t.stride,S=e.dimensions,D=e.stride,T=i.get(n,r),P=n*E,B=0,M=0;if(3==S)for(B=0;B<P;B+=E)l=s[a=o[B]*D],h=s[a+1],f=s[a+2],u=s[a=o[B+1]*D],p=s[a+1],_=s[a+2],c=s[a=o[B+2]*D],d=s[a+1],x=(y=s[a+2]-f)*(v=p-h)-(g=d-h)*(b=_-f),C=(m=c-l)*b-y*(A=u-l),w=g*A-m*v,I=Math.sqrt(x*x+C*C+w*w),T[M++]=x,T[M++]=C,T[M++]=w,T[M++]=I;else if(2==S)for(B=0;B<P;B+=E)T[M++]=0,T[M++]=0,T[M++]=1,T[M++]=1;return i},t.generateNormals=function(t,e,i,n){var r=t.get(t.count),o=e.get(e.count);null==i&&(i=new Fn(n));var s,a,l=t.dimensions,u=i.stride,c=i.get(i.count),h=i.count*u;for(s=0;s<h;s+=u)c[s]=0,c[s+1]=0,c[s+2]=0;h=t.count*l;var p,d,f,_,m=0,g=1,y=2;for(s=0;s<h;s+=l)c[a=r[s]*u]+=o[m],c[a+1]+=o[g],c[a+2]+=o[y],c[a=r[s+1]*u]+=o[m],c[a+1]+=o[g],c[a+2]+=o[y],c[a=r[s+2]*u]+=o[m],c[a+1]+=o[g],c[a+2]+=o[y],m+=4,g+=4,y+=4;for(h=i.count*u,s=0;s<h;s+=u)p=c[s],d=c[s+1],f=c[s+2],_=1/Math.sqrt(p*p+d*d+f*f),c[s]=p*_,c[s+1]=d*_,c[s+2]=f*_;return i},t.generateFaceTangents=function(t,e,i,n,r,o,s){void 0===o&&(o=0);var a=t.get(r,o),l=e.get(e.count),u=i.get(i.count);null==n?n=new kn(r+o):n.count<r+o&&(n.count=r+o);var c,h,p,d,f,_,m,g,y,A,v,b,x,C,w,I=t.dimensions,E=e.dimensions,S=e.stride,D=i.stride,T=n.get(r,o),P=0,B=r*I;for(P=0;P<B;P+=I)c=a[P],h=a[P+1],p=a[P+2],d=u[c*D+1],m=u[h*D+1]-d,g=u[p*D+1]-d,f=h*S,_=p*S,A=l[d=c*S],x=g*(l[f]-A)-m*(l[_]-A),v=l[d+1],C=g*(l[f+1]-v)-m*(l[_+1]-v),3==E?(b=l[d+2],w=g*(l[f+2]-b)-m*(l[_+2]-b)):w=0,y=1/Math.sqrt(x*x+C*C+w*w),T[P]=y*x,T[P+1]=y*C,T[P+2]=y*w;return n},t.generateTangents=function(t,e,i,n,r){var o=t.get(t.count),s=e.get(e.count),a=i.get(i.count);null==n&&(n=new Fn(r));var l,u,c,h=t.dimensions,p=n.stride,d=n.get(n.count),f=n.count*p;for(l=0;l<f;l+=p)d[l]=0,d[l+1]=0,d[l+2]=0;var _,m,g,y,A=0,v=1,b=2,x=3;for(f=t.count*h,l=0;l<f;l+=h)u=a[x],c=o[l]*p,d[c++]+=s[A]*u,d[c++]+=s[v]*u,d[c]+=s[b]*u,c=o[l+1]*p,d[c++]+=s[A]*u,d[c++]+=s[v]*u,d[c]+=s[b]*u,c=o[l+2]*p,d[c++]+=s[A]*u,d[c++]+=s[v]*u,d[c]+=s[b]*u,A+=3,v+=3,b+=3,x+=4;for(l=0;l<f;l+=p)_=d[l],m=d[l+1],g=d[l+2],y=1/Math.sqrt(_*_+m*m+g*g),d[l]=_*y,d[l+1]=m*y,d[l+2]=g*y;return n},t.generateColors=function(t,e,i,n,r){void 0===r&&(r=0),null==e&&(e=new Ln(i)),e.count<n+r&&(e.count=n+r);for(var o=e.get(n,r),s=e.stride,a=e.count*s,l=0;l<a;l+=s)o[l]=255,o[l+1]=255,o[l+2]=255,o[l+3]=255;return e},t.scale=function(t,e,i,n,r,o){void 0===o&&(o=0),n.count<r+o&&(n.count=r+o);var s,a,l=new Float32Array([t,e,i]),u=n.get(r,o),c=n.stride,h=n.dimensions,p=r*c;for(s=0;s<p;s+=c)for(a=0;a<h;a++)u[s+a]*=l[a];n.invalidate()},t.applyTransformation=function(t,e,i,n,r,o){void 0===o&&(o=0);var s,a,l,u,c,h,p,d=e.get(r,o),f=e.stride;i&&(s=i.get(r,o),a=i.stride),n&&(l=n.get(r,o),u=n.stride);var _,m=new P;(i||n)&&((_=t.clone()).invert(),_.transpose());var g=0,y=0,A=0;for(c=0;c<r;++c)h=g+1,p=g+2,m.x=d[g],m.y=d[h],m.z=d[p],m=t.transformVector(m),d[g]=m.x,d[h]=m.y,d[p]=m.z,g+=f,s&&(h=y+1,p=y+2,m.x=s[y],m.y=s[h],m.z=s[p],(m=_.deltaTransformVector(m)).normalize(),s[y]=m.x,s[h]=m.y,s[p]=m.z,y+=a),l&&(h=A+1,p=A+2,m.x=l[A],m.y=l[h],m.z=l[p],(m=_.deltaTransformVector(m)).normalize(),l[A]=m.x,l[h]=m.y,l[p]=m.z,A+=u);e.invalidate(),i&&i.invalidate(),n&&n.invalidate()},t.getSubIndices=function(e,i,n,r){void 0===r&&(r=0);var o,s=e.attributesBuffer,a=e.length;if(n.length=0,a<t.LIMIT_INDICES&&i<t.LIMIT_VERTS)return s;var l,u,c=e.get(e.count,r),h=new Array,p=t._indexSwap;for(p.length=a,o=0;o<a;o++)p[o]=-1;var d=0,f=r*e.dimensions;for(o=0;o<a+f&&o+1<t.LIMIT_INDICES&&d+1<t.LIMIT_VERTS;)p[l=c[o]]>=0?u=p[l]:(u=d++,p[l]=u,n[u]=l),h[o++]=u;return s=new Pn(e.size*e.dimensions,h.length/e.dimensions),(e=e.clone(s)).set(h),s},t.getSubVertices=function(t,e){if(!e.length)return t;var i,n,r=t.stride,o=t.bufferView,s=new Uint8Array(e.length*r),a=0,l=0,u=e.length;for(a=0;a<u;a++)for(i=a*r,n=e[a]*r,l=0;l<r;l++)s[i+l]=o[n+l];return(t=new Pn(r,u)).bufferView=s,t},t.tempFloat32x4=new Float32Array(4),t.LIMIT_VERTS=65535,t.LIMIT_INDICES=16777215,t._indexSwap=new Array,t}(),hr=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.usages=0,n._vertices=new Object,n._verticesUpdated=new Object,n._indexMappings=Array(),n._numIndices=0,n._elements=e,n._stage=i,n._onInvalidateIndicesDelegate=function(t){return n._onInvalidateIndices(t)},n._onClearIndicesDelegate=function(t){return n._onClearIndices(t)},n._onInvalidateVerticesDelegate=function(t){return n._onInvalidateVertices(t)},n._onClearVerticesDelegate=function(t){return n._onClearVertices(t)},n._elements.addEventListener(ur.CLEAR_INDICES,n._onClearIndicesDelegate),n._elements.addEventListener(ur.INVALIDATE_INDICES,n._onInvalidateIndicesDelegate),n._elements.addEventListener(ur.CLEAR_VERTICES,n._onClearVerticesDelegate),n._elements.addEventListener(ur.INVALIDATE_VERTICES,n._onInvalidateVerticesDelegate),n}return i(e,t),Object.defineProperty(e.prototype,"elements",{get:function(){return this._elements},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:!0,configurable:!0}),e.prototype.getIndexMappings=function(){return this._indicesUpdated||this._updateIndices(),this._indexMappings},e.prototype.getIndexBufferGL=function(){return this._indicesUpdated||this._updateIndices(),this._indices},e.prototype.getVertexBufferGL=function(t){this._indicesUpdated||this._updateIndices();var e=t.attributesBuffer.id;return this._verticesUpdated[e]||this._updateVertices(t),this._vertices[e]},e.prototype.activateVertexBufferVO=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.getVertexBufferGL(e).activate(t,e.size,i||e.dimensions,e.offset+n,e.unsigned)},e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._elements.removeEventListener(ur.CLEAR_INDICES,this._onClearIndicesDelegate),this._elements.removeEventListener(ur.INVALIDATE_INDICES,this._onInvalidateIndicesDelegate),this._elements.removeEventListener(ur.CLEAR_VERTICES,this._onClearVerticesDelegate),this._elements.removeEventListener(ur.INVALIDATE_VERTICES,this._onInvalidateVerticesDelegate),this._elements=null,this._overflow&&(this._overflow.onClear(e),this._overflow=null)},e.prototype._setRenderState=function(t,e){this._verticesUpdated||this._updateIndices()},e.prototype.draw=function(t,e,i,n){throw new s},e.prototype._updateIndices=function(t){void 0===t&&(t=0);var e=this._elements.indices;if(e){var i=cr.getSubIndices(e,this._elements.numVertices,this._indexMappings,t);this._indices=i.getAbstraction(this._stage),this._numIndices=this._indices._attributesBuffer.count*e.dimensions}else this._indices=null,this._numIndices=0,this._indexMappings=Array();if(t+=this._numIndices,e&&t<e.count*this._elements.indices.dimensions?(this._overflow||(this._overflow=this._pGetOverflowElements()),this._overflow._updateIndices(t)):this._overflow&&(this._overflow.onClear(new l(l.CLEAR,this._elements)),this._overflow=null),this._indicesUpdated=!0,this._indexMappings.length)for(var n in this._verticesUpdated)this._verticesUpdated[n]=!1},e.prototype._updateVertices=function(t){this._numVertices=this._elements.numVertices;var e=t.attributesBuffer.id,i=cr.getSubVertices(t.attributesBuffer,this._indexMappings);this._vertices[e]=i.getAbstraction(this._stage),this._verticesUpdated[e]=!0},e.prototype._onInvalidateIndices=function(t){t.attributesView&&(this._indicesUpdated=!1)},e.prototype._onClearIndices=function(t){t.attributesView&&(this._indices.onClear(new l(l.CLEAR,t.attributesView)),this._indices=null)},e.prototype._onInvalidateVertices=function(t){if(t.attributesView){var e=t.attributesView.attributesBuffer.id;this._verticesUpdated[e]=!1}},e.prototype._onClearVertices=function(t){if(t.attributesView){var e=t.attributesView.attributesBuffer.id;this._vertices[e]&&(this._vertices[e].onClear(new l(l.CLEAR,t.attributesView)),delete this._vertices[e],delete this._verticesUpdated[e])}},e.prototype._pGetOverflowElements=function(){throw new s},e}(K),pr=function(){};!function(t){t[t.LINEAR=0]="LINEAR",t[t.RADIAL=1]="RADIAL"}(jn||(jn={}));var dr,fr,_r,mr=function(){function t(t){var e=this;this._filterSizesInvalid=!0,this._onRTTResizeDelegate=function(t){return e.onRTTResize(t)},this._stage=t,this._rttManager=Cn.getInstance(t),this._rttManager.addEventListener(Ne.RESIZE,this._onRTTResizeDelegate),this._sampler=new Ze(!1,!1,!1),this._renderToTextureRect=new Y}return t.prototype.onRTTResize=function(t){this._filterSizesInvalid=!0},Object.defineProperty(t.prototype,"requireDepthRender",{get:function(){return this._requireDepthRender},enumerable:!0,configurable:!0}),t.prototype.getMainInputTexture=function(t){return this._filterTasksInvalid&&this.updateFilterTasks(t),this._mainInputTexture},Object.defineProperty(t.prototype,"filters",{get:function(){return this._filters},set:function(t){if(this._filters=t,this._filterTasksInvalid=!0,this._requireDepthRender=!1,this._filters){for(var e=0;e<this._filters.length;++e)this._filters[e].requireDepthRender&&(this._requireDepthRender=!0);this._filterSizesInvalid=!0}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sampler",{get:function(){return this._sampler},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderToTextureRect",{get:function(){return this._filterSizesInvalid&&this.updateFilterSizes(),this._renderToTextureRect},enumerable:!0,configurable:!0}),t.prototype.updateFilterTasks=function(t){if(this._filterSizesInvalid&&this.updateFilterSizes(),this._filters){this._tasks=new Array;for(var e,i=this._filters.length-1,n=0;n<=i;++n)(e=this._filters[n]).setRenderTargets(n==i?null:this._filters[n+1].getMainInputTexture(t),t),this._tasks=this._tasks.concat(e.tasks);this._mainInputTexture=this._filters[0].getMainInputTexture(t)}else this._tasks=null},t.prototype.render=function(t,e,i){var n,r,o,s=t.context,a=this._rttManager.indexBuffer,l=this._rttManager.renderToTextureVertexBuffer;if(this._filters){for(this._filterSizesInvalid&&this.updateFilterSizes(),this._filterTasksInvalid&&this.updateFilterTasks(t),n=this._filters.length,r=0;r<n;++r)this._filters[r].update(t,e);for((n=this._tasks.length)>1&&(s.setProgram(this._tasks[0].getProgram(t)),s.setVertexBufferAt(this._tasks[0]._positionIndex,l,0,Ht.FLOAT_2),s.setVertexBufferAt(this._tasks[0]._uvIndex,l,8,Ht.FLOAT_2)),r=0;r<n;++r)o=this._tasks[r],t.setRenderTarget(o.target),s.setProgram(o.getProgram(t)),o.getMainInputTexture(t).getAbstraction(t).activate(o._inputTextureIndex,this._sampler),o.target||(l=this._rttManager.renderToScreenVertexBuffer,s.setVertexBufferAt(o._positionIndex,l,0,Ht.FLOAT_2),s.setVertexBufferAt(o._uvIndex,l,8,Ht.FLOAT_2)),s.clear(0,0,0,0),o.activate(t,e,i),s.setBlendFactors(Lt.ONE,Lt.ZERO),s.drawIndices(Ft.TRIANGLES,a,0,6),o.deactivate(t);s.setTextureAt(0,null),s.setVertexBufferAt(0,null),s.setVertexBufferAt(1,null)}},t.prototype.updateFilterSizes=function(){for(var t=0;t<this._filters.length;++t)this._filters[t].textureWidth=this._rttManager.textureWidth,this._filters[t].textureHeight=this._rttManager.textureHeight,this._filters[t].rttManager=this._rttManager;var e=this._filters[0].textureScale;this._renderToTextureRect.x=this._rttManager.renderToTextureRect.x/e,this._renderToTextureRect.y=this._rttManager.renderToTextureRect.y/e,this._renderToTextureRect.width=this._rttManager.renderToTextureRect.width/e,this._renderToTextureRect.height=this._rttManager.renderToTextureRect.height/e,this._filterSizesInvalid=!1},t.prototype.dispose=function(){this._rttManager.removeEventListener(Ne.RESIZE,this._onRTTResizeDelegate),this._rttManager=null,this._stage=null},t}(),gr=function(){function t(){}return t.prototype.sortBlendedRenderables=function(t){var e,i,n,r,o,s;if(!t||!t.next)return t;for(n=t,i=t.next;i;)(i=i.next)&&(n=n.next,i=i.next);if(e=n.next,n.next=null,t=this.sortBlendedRenderables(t),e=this.sortBlendedRenderables(e),!t)return e;if(!e)return t;for(;t&&e;)t.zIndex<e.zIndex?(s=t,t=t.next):(s=e,e=e.next),r?o.next=s:r=s,o=s;return t?o.next=t:e&&(o.next=e),r},t.prototype.sortOpaqueRenderables=function(t){var e,i,n,r,o,s;if(!t||!t.next)return t;for(n=t,i=t.next;i;)(i=i.next)&&(n=n.next,i=i.next);e=n.next,n.next=null,t=this.sortOpaqueRenderables(t),e=this.sortOpaqueRenderables(e);var a=0;if(!t)return e;if(!e)return t;for(;t&&e&&null!=t&&null!=e;){var l=t.renderOrderId,u=e.renderOrderId;if(l==u){var c=t.materialID,h=e.materialID;a=c==h?t.zIndex<e.zIndex?1:-1:c>h?1:-1}else a=l>u?1:-1;a<0?(s=t,t=t.next):(s=e,e=e.next),r?(o.next=s,o=s):(r=s,o=s)}return t?o.next=t:e&&(o.next=e),r},t}(),yr=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._cameraForward=new P,n._depthTextureDirty=!0,n._depthPrepass=!1,n._pNumElements=0,n._disableColor=!1,n._disableClear=!1,n._renderBlended=!0,n._numCullPlanes=0,n._partition=e,n.sourceEntity=e.root,n._maskId=e.root.maskId,n._onSizeInvalidateDelegate=function(t){return n.onSizeInvalidate(t)},n._onContextUpdateDelegate=function(t){return n.onContextUpdate(t)},n.renderableSorter=new gr,n._renderGroup=i.renderGroup,n._renderGroup.addEventListener(Re.CONTEXT_CREATED,n._onContextUpdateDelegate),n._renderGroup.addEventListener(Re.CONTEXT_RECREATED,n._onContextUpdateDelegate),n._renderGroup.addEventListener(ie.INVALIDATE_SIZE,n._onSizeInvalidateDelegate),n._view=n._renderGroup.view,n._stage=n._renderGroup.stage,n._stage.context&&(n._context=n._stage.context),n}return i(e,t),Object.defineProperty(e.prototype,"maskOwners",{get:function(){return this.sourceEntity.maskOwners},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partition",{get:function(){return this._partition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderGroup",{get:function(){return this._renderGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cullPlanes",{get:function(){return this._customCullPlanes},set:function(t){this._customCullPlanes=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderBlended",{get:function(){return this._renderBlended},set:function(t){this._renderBlended=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disableColor",{get:function(){return this._disableColor},set:function(t){this._disableColor!=t&&(this._disableColor=t,this._invalid=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disableClear",{get:function(){return this._disableClear},set:function(t){this._disableClear!=t&&(this._disableClear=t,this._invalid=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numElements",{get:function(){return this._pNumElements},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._renderGroup.removeEventListener(Re.CONTEXT_CREATED,this._onContextUpdateDelegate),this._renderGroup.removeEventListener(Re.CONTEXT_RECREATED,this._onContextUpdateDelegate),this._renderGroup.removeEventListener(ie.INVALIDATE_SIZE,this._onSizeInvalidateDelegate),this._onContextUpdateDelegate=null,this._onSizeInvalidateDelegate=null,this._view=null,this._stage=null,this._context=null,this.next=null},e.prototype.render=function(t,e,i,n){void 0===t&&(t=!0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this._enableDepthAndStencil=t,this._surfaceSelector=e,this._mipmapSelector=i,this._maskConfig=n,this._maskConfig&&(this._disableClear=!0,this._disableColor=!0),this._renderGroup.update(this._partition),this._view.target&&this._view.target.invalidateMipmaps(),this._view.clear(!this._depthPrepass&&!this._disableClear,t,e,i,!this._view.shareContext||this._view.target?Rt.ALL:Rt.DEPTH),this._context.setBlendFactors(Lt.ONE,Lt.ZERO),this._context.setDepthTest(!0,Nt.LESS_EQUAL),this.executeRender(t,e,i),this._view.shareContext&&!this._view.target||this._snapshotRequired&&this._snapshotBitmapImage2D&&(this._context.drawToBitmapImage2D(this._snapshotBitmapImage2D),this._snapshotRequired=!1)},e.prototype.traverse=function(){this._pBlendedRenderableHead=null,this._pOpaqueRenderableHead=null,this._pNumElements=0,this._activeMaskOwners=null,this._cameraTransform=this._view.projection.transform.concatenatedMatrix3D,this._cameraForward=this._view.projection.transform.forwardVector,this._cullPlanes=this._customCullPlanes?this._customCullPlanes:this._view.projection.viewFrustumPlanes,this._numCullPlanes=this._cullPlanes?this._cullPlanes.length:0,e._collectionMark++,this._partition.traverse(this),this.renderableSorter&&(this._pOpaqueRenderableHead=this.renderableSorter.sortOpaqueRenderables(this._pOpaqueRenderableHead),this._pBlendedRenderableHead=this.renderableSorter.sortBlendedRenderables(this._pBlendedRenderableHead)),this._invalid=!1},e.prototype._iRenderCascades=function(t,e,i,n){},e.prototype.executeRender=function(t,e,i){this.traverse(),this._disableColor?this._context.setColorMask(!1,!1,!1,!1):this._context.setColorMask(!0,!0,!0,!0),this._maskConfig?this._context.enableStencil():this._context.disableStencil(),this.drawRenderables(this._pOpaqueRenderableHead),this._renderBlended&&this.drawRenderables(this._pBlendedRenderableHead)},e.prototype.onInvalidate=function(e){t.prototype.onInvalidate.call(this,e),this._renderGroup.invalidate()},e.prototype.queueSnapshot=function(t){this._snapshotRequired=!0,this._snapshotBitmapImage2D=t},e.prototype.drawRenderables=function(t){for(var e,i,n,r;t;){for(r=(n=t.renderMaterial)?n.numPasses:1,(this._activeMasksDirty||this._checkMaskOwners(t.maskOwners))&&((this._activeMaskOwners=t.maskOwners)?this._renderMasks(this._activeMaskOwners):this._maskConfig||this._context.disableStencil(),this._activeMasksDirty=!1),e=0;e<r;e++){n&&n.activatePass(e),i=t;do{i.executeRender(this._enableDepthAndStencil,this._surfaceSelector,this._mipmapSelector,this._maskConfig),i=i.next}while(i&&i.renderMaterial==n&&!(this._activeMasksDirty=this._checkMaskOwners(i.maskOwners)));n&&n.deactivatePass()}t=i}},e.prototype.onContextUpdate=function(t){this._context=this._stage.context},e.prototype.onSizeInvalidate=function(t){this._pRttBufferManager&&(this._pRttBufferManager.viewWidth=this._view.width,this._pRttBufferManager.viewHeight=this._view.height),this._depthTextureDirty=!0},e.prototype.enterNode=function(t){var i=this._maskConfig||t.isInFrustum(this._partition.root,this._cullPlanes,this._numCullPlanes,this._renderGroup.pickGroup),n=t._collectionMark!=e._collectionMark&&t.isRenderable()&&i&&t.maskId==this._maskId;return t._collectionMark=e._collectionMark,n},e.prototype.getTraverser=function(t){return this},e.prototype.applyEntity=function(t){this._sourceEntity=t,this._renderEntity=t.getAbstraction(this._renderGroup),this._zIndex=this._cameraTransform.position.subtract(t.scenePosition).dotProduct(this._cameraForward),this._zIndex+=t.zOffset,this._renderSceneTransform=t.getRenderSceneTransform(this._cameraTransform),t._acceptTraverser(this)},e.prototype.applyTraversable=function(t){var e=t.getAbstraction(this._renderEntity);e.cascaded=!1,e.zIndex=this._zIndex,e.maskId=this._sourceEntity.maskId,e.maskOwners=this._sourceEntity.maskOwners;var i=e.renderMaterial;e.materialID=i.materialID,e.renderOrderId=i.renderOrderId,e.renderSceneTransform=this._renderSceneTransform,i.requiresBlending?(e.next=this._pBlendedRenderableHead,this._pBlendedRenderableHead=e):(e.next=this._pOpaqueRenderableHead,this._pOpaqueRenderableHead=e),this._pNumElements+=e.stageElements.elements.numElements},e.prototype._renderMasks=function(t){var e=Math.log2(this._maskConfig)>>1,i=this._maskConfig?Math.pow(2,e+1<<1):1,n=i;this._context.enableStencil();for(var r,o,s,a=t.length,l=!0,u=0;u<a;++u)if(o=(r=t[u].masks).length){this._context.setStencilActions(zt.FRONT_AND_BACK,l?Nt.ALWAYS:Nt.EQUAL,jt.SET,jt.SET,jt.KEEP),l=!1,this._context.setStencilReferenceValue(255,n,n=(n&i)+i),this._context.clear(0,0,0,0,0,0,Rt.STENCIL);for(var c=0;c<o;++c)(s=r[c])&&this._renderGroup.getRenderer(s.partition).render(!0,0,0,n)}l||this._context.setStencilActions(zt.FRONT_AND_BACK,Nt.EQUAL,jt.SET,jt.SET,jt.KEEP),this._context.setStencilReferenceValue(255,n,this._maskConfig),this._disableColor||this._context.setColorMask(!0,!0,!0,!0)},e.prototype._checkMaskOwners=function(t){if(null==this._activeMaskOwners||null==t)return Boolean(this._activeMaskOwners!=t);if(this._activeMaskOwners.length!=t.length)return!0;for(var e,i,n,r=t.length,o=0;o<r;o++){if(e=(i=t[o].masks).length,(n=this._activeMaskOwners[o].masks).length!=e)return!0;for(var s=0;s<e;s++)if(n[s]!=i[s])return!0}return!1},e._collectionMark=0,e}(K),Ar=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._pRttBufferManager=Cn.getInstance(n._stage),n._depthRenderer=i.renderGroup.depthRenderGroup.getRenderer(e),n._distanceRenderer=i.renderGroup.distanceRenderGroup.getRenderer(e),n}return i(e,t),Object.defineProperty(e.prototype,"antiAlias",{get:function(){return this._stage.antiAlias},set:function(t){this._stage.antiAlias=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthPrepass",{get:function(){return this._depthPrepass},set:function(t){this._depthPrepass=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters3d",{get:function(){return this._filter3DRenderer?this._filter3DRenderer.filters:null},set:function(t){t&&0==t.length&&(t=null),this._filter3DRenderer&&!t?(this._filter3DRenderer.dispose(),this._filter3DRenderer=null):!this._filter3DRenderer&&t&&(this._filter3DRenderer=new mr(this._stage),this._filter3DRenderer.filters=t),this._filter3DRenderer?(this._filter3DRenderer.filters=t,this._requireDepthRender=this._filter3DRenderer.requireDepthRender):(this._requireDepthRender=!1,this._depthRender&&(this._depthRender.dispose(),this._depthRender=null))},enumerable:!0,configurable:!0}),e.prototype.enterNode=function(e){var i=t.prototype.enterNode.call(this,e);return i&&e.boundsVisible&&this.applyEntity(e.getBoundsPrimitive(this._renderGroup.pickGroup)),i},e.prototype.render=function(e,i,n,r){void 0===e&&(e=!0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this._stage.recoverFromDisposal()&&(this._requireDepthRender&&this._renderSceneDepthToTexture(),this._depthPrepass&&this._renderDepthPrepass(),this._filter3DRenderer?(this._view.target=this._filter3DRenderer.getMainInputTexture(this._stage),t.prototype.render.call(this,e,i,n),this._filter3DRenderer.render(this._stage,this._view.projection,this._depthRender)):t.prototype.render.call(this,e,i,n,r),r||this._view.present())},e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._pRttBufferManager.dispose(),this._pRttBufferManager=null,this._depthRenderer.onClear(e),this._distanceRenderer.onClear(e),this._depthRenderer=null,this._distanceRenderer=null,this._depthRender=null},e.prototype._renderDepthPrepass=function(){this._depthRenderer.disableColor=!0,this._depthRenderer.view.projection=this._view.projection,this._filter3DRenderer?(this._depthRenderer.view.target=this._filter3DRenderer.getMainInputTexture(this._stage),this._depthRenderer.render()):(this._depthRenderer.view.target=null,this._depthRenderer.render()),this._depthRenderer.disableColor=!1},e.prototype._renderSceneDepthToTexture=function(){!this._depthTextureDirty&&this._depthRender||this.initDepthTexture(this._stage.context),this._depthRenderer.render()},e.prototype.initDepthTexture=function(t){this._depthTextureDirty=!1,this._depthRender&&this._depthRender.dispose(),this._depthRender=new hn(this._pRttBufferManager.textureWidth,this._pRttBufferManager.textureHeight),this._depthRenderer.view.target=this._depthRender,this._depthRenderer.view.projection=this._view.projection},e}(yr),vr=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype.enterNode=function(e){return e._collectionMark!=yr._collectionMark&&e.isCastingShadow()?t.prototype.enterNode.call(this,e):(e._collectionMark=yr._collectionMark,!1)},e}(yr),br=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype.enterNode=function(e){return e._collectionMark!=yr._collectionMark&&e.isCastingShadow()?t.prototype.enterNode.call(this,e):(e._collectionMark=yr._collectionMark,!1)},e}(yr),xr=function(){function t(t){this.id=K.ID_COUNT++,this.renderGroup=t}return Object.defineProperty(t.prototype,"materialClassPool",{get:function(){return t._materialClassPool},enumerable:!0,configurable:!0}),t.prototype.requestAbstraction=function(t){return Ar},t.registerMaterial=function(e,i){t._materialClassPool[i.assetType]=e},t._materialClassPool=new Object,t}(),Cr=function(){function t(t){this.id=K.ID_COUNT++,this.renderGroup=t}return Object.defineProperty(t.prototype,"materialClassPool",{get:function(){return t._materialClassPool},enumerable:!0,configurable:!0}),t.prototype.requestAbstraction=function(t){return vr},t.registerMaterial=function(e,i){t._materialClassPool[i.assetType]=e},t._materialClassPool=new Object,t}(),wr=function(){function t(t){this.id=K.ID_COUNT++,this.renderGroup=t}return Object.defineProperty(t.prototype,"materialClassPool",{get:function(){return t._materialClassPool},enumerable:!0,configurable:!0}),t.prototype.requestAbstraction=function(t){return br},t.registerMaterial=function(e,i){t._materialClassPool[i.assetType]=e},t._materialClassPool=new Object,t}();!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DEPTH=1]="DEPTH",t[t.DISTANCE=2]="DISTANCE"}(_r||(_r={}));var Ir=function(t){function e(i,n){var r=t.call(this)||this;return r._mappers=new Array,r._materialPools=new Object,r.id=K.ID_COUNT++,r.view=i,r.stage=i.stage,r.pickGroup=ce.getInstance(i),r._rendererPool=new e._rendererPool[n](r),r._materialClassPool=r._rendererPool.materialClassPool,n!=_r.DEFAULT&&(r.view.backgroundColor=16777215),r._onSizeInvalidateDelegate=function(t){return r.onSizeInvalidate(t)},r._onContextUpdateDelegate=function(t){return r.onContextUpdate(t)},r.stage.addEventListener(Re.CONTEXT_CREATED,r._onContextUpdateDelegate),r.stage.addEventListener(Re.CONTEXT_RECREATED,r._onContextUpdateDelegate),r.view.addEventListener(ie.INVALIDATE_SIZE,r._onSizeInvalidateDelegate),r}return i(e,t),e.clearAllInstances=function(){for(var t in this._instancePool)this._instancePool[t].clearAll(),delete this._instancePool[t]},e.getInstance=function(t,i){this._instancePool[i][t.id];return this._instancePool[i][t.id]||(this._instancePool[i][t.id]=new e(t,i))},e.clearInstance=function(t,e){var i=this._instancePool[e][t.id];i&&(i.clearAll(),delete this._instancePool[e][t.id])},Object.defineProperty(e.prototype,"depthRenderGroup",{get:function(){return null==this._depthRenderGroup&&(this._depthRenderGroup=e.getInstance(new Un(null,this.stage),_r.DEPTH)),this._depthRenderGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceRenderGroup",{get:function(){return null==this._distanceRenderGroup&&(this._distanceRenderGroup=e.getInstance(new Un(null,this.stage),_r.DISTANCE)),this._distanceRenderGroup},enumerable:!0,configurable:!0}),e.prototype.clearAll=function(){this.stage.removeEventListener(Re.CONTEXT_CREATED,this._onContextUpdateDelegate),this.stage.removeEventListener(Re.CONTEXT_RECREATED,this._onContextUpdateDelegate),this.view.removeEventListener(ie.INVALIDATE_SIZE,this._onSizeInvalidateDelegate)},e.prototype.update=function(t){for(var e=this._mappers.length,i=0;i<e;i++)this._mappers[i].update(t,this)},e.prototype.invalidate=function(){this._invalid=!0},e.prototype._addMapper=function(t){-1==this._mappers.indexOf(t)&&this._mappers.push(t)},e.prototype._removeMapper=function(t){var e=this._mappers.indexOf(t);-1!=e&&this._mappers.splice(e,1)},e.prototype.onSizeInvalidate=function(t){this.dispatchEvent(t)},e.prototype.onContextUpdate=function(t){this.dispatchEvent(t)},e.prototype.getRenderElements=function(t){var i=this._materialPools[t.assetType];return i||(i=this._materialPools[t.assetType]=new e._renderElementsClassPool[t.assetType](this.stage,this._materialClassPool,this)),i},e.prototype.requestAbstraction=function(t){return nr},e.prototype.getRenderer=function(t){return t.getAbstraction(this._rendererPool)},e.registerElements=function(t,i){e._renderElementsClassPool[i.assetType]=t},e.registerDefaultMaterial=function(t,e){xr.registerMaterial(t,e)},e.registerDepthMaterial=function(t,e){Cr.registerMaterial(t,e)},e.registerDistanceMaterial=function(t,e){wr.registerMaterial(t,e)},e._rendererPool=((dr={})[_r.DEFAULT]=xr,dr[_r.DEPTH]=Cr,dr[_r.DISTANCE]=wr,dr),e._defaultInstancePool=new Object,e._depthInstancePool=new Object,e._distanceInstancePool=new Object,e._instancePool=((fr={})[_r.DEFAULT]=e._defaultInstancePool,fr[_r.DEPTH]=e._depthInstancePool,fr[_r.DISTANCE]=e._distanceInstancePool,fr),e._renderElementsClassPool=new Object,e}(u);console.debug("AwayJS - Renderer - 0.11.11");var Er=function(t){function e(){var e=t.call(this)||this;return e._pLooping=!0,e._pTotalDuration=0,e._pStitchDirty=!0,e._pStitchFinalFrame=!1,e._pNumFrames=0,e._pDurations=new Array,e._pTotalDelta=new P,e.fixedFrameRate=!0,e}return i(e,t),Object.defineProperty(e.prototype,"looping",{get:function(){return this._pLooping},set:function(t){this._pLooping!=t&&(this._pLooping=t,this._pStitchDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stitchFinalFrame",{get:function(){return this._pStitchFinalFrame},set:function(t){this._pStitchFinalFrame!=t&&(this._pStitchFinalFrame=t,this._pStitchDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalDuration",{get:function(){return this._pStitchDirty&&this._pUpdateStitch(),this._pTotalDuration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalDelta",{get:function(){return this._pStitchDirty&&this._pUpdateStitch(),this._pTotalDelta},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastFrame",{get:function(){return this._pStitchDirty&&this._pUpdateStitch(),this._pLastFrame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"durations",{get:function(){return this._pDurations},enumerable:!0,configurable:!0}),e.prototype._pUpdateStitch=function(){this._pStitchDirty=!1,this._pLastFrame=this._pStitchFinalFrame?this._pNumFrames:this._pNumFrames-1,this._pTotalDuration=0,this._pTotalDelta.x=0,this._pTotalDelta.y=0,this._pTotalDelta.z=0},e}(lr),Sr=function(){function t(t,e){this._pRootDelta=new P,this._pPositionDeltaDirty=!0,this._pStartTime=0,this._pAnimator=t,this._pAnimationNode=e}return Object.defineProperty(t.prototype,"positionDelta",{get:function(){return this._pPositionDeltaDirty&&this._pUpdatePositionDelta(),this._pRootDelta},enumerable:!0,configurable:!0}),t.prototype.offset=function(t){this._pStartTime=t,this._pPositionDeltaDirty=!0},t.prototype.update=function(t){this._pTime!=t-this._pStartTime&&this._pUpdateTime(t)},t.prototype.phase=function(t){},t.prototype._pUpdateTime=function(t){this._pTime=t-this._pStartTime,this._pPositionDeltaDirty=!0},t.prototype._pUpdatePositionDelta=function(){},t}(),Dr=function(t){function e(e,i,n){void 0===n&&(n=!1);var r=t.call(this,e,i)||this;return r._pDynamicProperties=new Array,r._pDynamicPropertiesDirty=new Object,r._pParticleAnimator=e,r._particleNode=i,r._pNeedUpdateTime=n,r}return i(e,t),Object.defineProperty(e.prototype,"needUpdateTime",{get:function(){return this._pNeedUpdateTime},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,e,i,n){},e.prototype._pUpdateDynamicProperties=function(t){this._pDynamicPropertiesDirty[t._iUniqueId]=!0;for(var e,i,n,r,o,s=t.animationParticles,a=t.vertexData,l=t.totalLenOfOneVertex,u=this._particleNode.dataLength,c=this._particleNode._iDataOffset,h=this._pDynamicProperties.length,p=0,d=0,f=0;p<h;){for(;d<h&&(o=s[d]).index==p;){for(r=this._pDynamicProperties[p],e=o.numVertices*l,i=o.startVertexIndex*l+c,f=0;f<e;f+=l)for(n=i+f,f=0;f<e;f+=l)n=i+f,a[n++]=r.x,a[n++]=r.y,a[n++]=r.z,4==u&&(a[n++]=r.w);d++}p++}t.invalidateBuffer()},e}(Sr),Tr=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleAccelerationNode=i,n._acceleration=n._particleAccelerationNode._acceleration,n.updateAccelerationData(),n}return i(e,t),Object.defineProperty(e.prototype,"acceleration",{get:function(){return this._acceleration},set:function(t){this._acceleration.x=t.x,this._acceleration.y=t.y,this._acceleration.z=t.z,this.updateAccelerationData()},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){var o=r.getRegisterIndex(this._pAnimationNode,e.ACCELERATION_INDEX);this._particleAccelerationNode.mode==Xn.LOCAL_STATIC?n.activateVertexBuffer(o,this._particleAccelerationNode._iDataOffset,t.stage,Ht.FLOAT_3):t.setVertexConst(o,this._halfAcceleration.x,this._halfAcceleration.y,this._halfAcceleration.z)},e.prototype.updateAccelerationData=function(){this._particleAccelerationNode.mode==Xn.GLOBAL&&(this._halfAcceleration=new P(this._acceleration.x/2,this._acceleration.y/2,this._acceleration.z/2))},e.ACCELERATION_INDEX=0,e}(Dr),Pr=function(t){function e(i,n,r,o){void 0===o&&(o=1);var s=t.call(this)||this;return s._pDataLength=3,i+=e.MODES[n],s.name=i,s._pMode=n,s._priority=o,s._pDataLength=r,s._pOneData=new Array(s._pDataLength),s}return i(e,t),Object.defineProperty(e.prototype,"mode",{get:function(){return this._pMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"priority",{get:function(){return this._priority},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataLength",{get:function(){return this._pDataLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oneData",{get:function(){return this._pOneData},enumerable:!0,configurable:!0}),e.prototype.getAGALVertexCode=function(t,e,i,n){return""},e.prototype.getAGALFragmentCode=function(t,e,i,n){return""},e.prototype.getAGALUVCode=function(t,e,i,n){return""},e.prototype._iGeneratePropertyOfOneParticle=function(t){},e.prototype._iProcessAnimationSetting=function(t){},e.GLOBAL="Global",e.LOCAL_STATIC="LocalStatic",e.LOCAL_DYNAMIC="LocalDynamic",e.MODES={0:e.GLOBAL,1:e.LOCAL_STATIC,2:e.LOCAL_DYNAMIC},e}(lr),Br=(function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,"ParticleAcceleration",e,3)||this;return n._pStateClass=Tr,n._acceleration=i||new P,n}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Tr.ACCELERATION_INDEX,r.index);var o=i.getFreeVertexVectorTemp();i.addVertexTempUsages(o,1);var s="mul "+o+","+n.vertexTime+","+r+"\n";if(e.needVelocity){var a=i.getFreeVertexVectorTemp();s+="mul "+a+","+o+","+n.vertexTwoConst+"\n",s+="add "+n.velocityTarget+".xyz,"+a+".xyz,"+n.velocityTarget+".xyz\n"}return i.removeVertexTempUsage(o),s+="mul "+o+","+o+","+n.vertexTime+"\n",s+="add "+n.positionTarget+".xyz,"+o+","+n.positionTarget+".xyz\n"},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.ACCELERATION_VECTOR3D];if(!i)throw new Error("there is no "+e.ACCELERATION_VECTOR3D+" in param!");this._pOneData[0]=i.x/2,this._pOneData[1]=i.y/2,this._pOneData[2]=i.z/2},e.ACCELERATION_VECTOR3D="AccelerationVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleBezierCurveNode=i,n._controlPoint=n._particleBezierCurveNode._iControlPoint,n._endPoint=n._particleBezierCurveNode._iEndPoint,n}return i(e,t),Object.defineProperty(e.prototype,"controlPoint",{get:function(){return this._controlPoint},set:function(t){this._controlPoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endPoint",{get:function(){return this._endPoint},set:function(t){this._endPoint=t},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){var o=r.getRegisterIndex(this._pAnimationNode,e.BEZIER_CONTROL_INDEX),s=r.getRegisterIndex(this._pAnimationNode,e.BEZIER_END_INDEX);this._particleBezierCurveNode.mode==Xn.LOCAL_STATIC?(n.activateVertexBuffer(o,this._particleBezierCurveNode._iDataOffset,t.stage,Ht.FLOAT_3),n.activateVertexBuffer(s,this._particleBezierCurveNode._iDataOffset+3,t.stage,Ht.FLOAT_3)):(t.setVertexConst(o,this._controlPoint.x,this._controlPoint.y,this._controlPoint.z),t.setVertexConst(s,this._endPoint.x,this._endPoint.y,this._endPoint.z))},e.BEZIER_CONTROL_INDEX=0,e.BEZIER_END_INDEX=1,e}(Dr)),Mr=(function(t){function e(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null);var r=t.call(this,"ParticleBezierCurve",e,6)||this;return r._pStateClass=Br,r._iControlPoint=i||new P,r._iEndPoint=n||new P,r}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Br.BEZIER_CONTROL_INDEX,r.index);var o=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Br.BEZIER_END_INDEX,o.index);var s=i.getFreeVertexVectorTemp(),a=new Fi(s.regName,s.index,0),l=new Fi(s.regName,s.index,1),u=new Fi(s.regName,s.index,2);i.addVertexTempUsages(s,1);var c=i.getFreeVertexVectorTemp(),h=new Fi(c.regName,c.index);i.removeVertexTempUsage(s);var p="";return p+="sub "+a+","+n.vertexOneConst+","+n.vertexLife+"\n",p+="mul "+l+","+n.vertexLife+","+n.vertexLife+"\n",p+="mul "+u+","+n.vertexLife+","+a+"\n",p+="mul "+u+","+u+","+n.vertexTwoConst+"\n",p+="mul "+h+".xyz,"+u+","+r+"\n",p+="add "+n.positionTarget+".xyz,"+h+".xyz,"+n.positionTarget+".xyz\n",p+="mul "+h+".xyz,"+l+","+o+"\n",p+="add "+n.positionTarget+".xyz,"+h+".xyz,"+n.positionTarget+".xyz\n",e.needVelocity&&(p+="mul "+l+","+n.vertexLife+","+n.vertexTwoConst+"\n",p+="sub "+u+","+n.vertexOneConst+","+l+"\n",p+="mul "+u+","+n.vertexTwoConst+","+u+"\n",p+="mul "+h+".xyz,"+r+","+u+"\n",p+="add "+n.velocityTarget+".xyz,"+h+".xyz,"+n.velocityTarget+".xyz\n",p+="mul "+h+".xyz,"+o+","+l+"\n",p+="add "+n.velocityTarget+".xyz,"+h+".xyz,"+n.velocityTarget+".xyz\n"),p},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.BEZIER_CONTROL_VECTOR3D];if(!i)throw new Error("there is no "+e.BEZIER_CONTROL_VECTOR3D+" in param!");var n=t[e.BEZIER_END_VECTOR3D];if(!n)throw new Error("there is no "+e.BEZIER_END_VECTOR3D+" in param!");this._pOneData[0]=i.x,this._pOneData[1]=i.y,this._pOneData[2]=i.z,this._pOneData[3]=n.x,this._pOneData[4]=n.y,this._pOneData[5]=n.z},e.BEZIER_CONTROL_VECTOR3D="BezierControlVector3D",e.BEZIER_END_VECTOR3D="BezierEndVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._matrix=new R,n._billboardAxis=i._iBillboardAxis,n}return i(e,t),e.prototype.setRenderState=function(t,i,n,r){var o;if(this._billboardAxis){var s=i.sourceEntity.transform.concatenatedMatrix3D.position,a=t.view.projection.transform.concatenatedMatrix3D.position.subtract(s),l=a.crossProduct(this._billboardAxis);l.normalize(),(a=this.billboardAxis.crossProduct(l)).normalize(),this._matrix.copyFrom(i.sourceEntity.transform.concatenatedMatrix3D),o=this._matrix.decompose(O.AXIS_ANGLE),this._matrix.copyColumnFrom(0,l),this._matrix.copyColumnFrom(1,this.billboardAxis),this._matrix.copyColumnFrom(2,a),this._matrix.copyColumnFrom(3,s),this._matrix.appendRotation(-o[1].w*M.RADIANS_TO_DEGREES,o[1])}else this._matrix.copyFrom(i.sourceEntity.transform.concatenatedMatrix3D),this._matrix.append(t.view.projection.transform.inverseConcatenatedMatrix3D),o=this._matrix.decompose(O.AXIS_ANGLE),this._matrix.identity(),this._matrix.appendRotation(-o[1].w*M.RADIANS_TO_DEGREES,o[1]);t.setVertexConstFromMatrix(r.getRegisterIndex(this._pAnimationNode,e.MATRIX_INDEX),this._matrix)},Object.defineProperty(e.prototype,"billboardAxis",{get:function(){return this.billboardAxis},set:function(t){this.billboardAxis=t?t.clone():null,this.billboardAxis&&this.billboardAxis.normalize()},enumerable:!0,configurable:!0}),e.MATRIX_INDEX=0,e}(Dr)),Or=(function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,"ParticleBillboard",Xn.GLOBAL,0,4)||this;return i._pStateClass=Mr,i._iBillboardAxis=e,i}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=i.getFreeVertexConstant();n.setRegisterIndex(this,Mr.MATRIX_INDEX,r.index),i.getFreeVertexConstant(),i.getFreeVertexConstant(),i.getFreeVertexConstant();for(var o,s=i.getFreeVertexVectorTemp(),a="m33 "+s+".xyz,"+n.scaleAndRotateTarget+","+r+"\nmov "+n.scaleAndRotateTarget+".xyz,"+s+"\n",l=0;l<n.rotationRegisters.length;l++)a+="m33 "+s+".xyz,"+(o=n.rotationRegisters[l])+","+r+"\nmov "+o+".xyz,"+o+"\n";return a},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iProcessAnimationSetting=function(t){t.hasBillboard=!0}}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleColorNode=i,n._usesMultiplier=n._particleColorNode._iUsesMultiplier,n._usesOffset=n._particleColorNode._iUsesOffset,n._usesCycle=n._particleColorNode._iUsesCycle,n._usesPhase=n._particleColorNode._iUsesPhase,n._startColor=n._particleColorNode._iStartColor,n._endColor=n._particleColorNode._iEndColor,n._cycleDuration=n._particleColorNode._iCycleDuration,n._cyclePhase=n._particleColorNode._iCyclePhase,n.updateColorData(),n}return i(e,t),Object.defineProperty(e.prototype,"startColor",{get:function(){return this._startColor},set:function(t){this._startColor=t,this.updateColorData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endColor",{get:function(){return this._endColor},set:function(t){this._endColor=t,this.updateColorData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(t){this._cycleDuration=t,this.updateColorData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(t){this._cyclePhase=t,this.updateColorData()},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){if(t.usesFragmentAnimation){var o=this._particleColorNode._iDataOffset;this._usesCycle&&t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.CYCLE_INDEX),this._cycleData.x,this._cycleData.y,this._cycleData.z,this._cycleData.w),this._usesMultiplier&&(this._particleColorNode.mode==Xn.LOCAL_STATIC?(n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.START_MULTIPLIER_INDEX),o,t.stage,Ht.FLOAT_4),o+=4,n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.DELTA_MULTIPLIER_INDEX),o,t.stage,Ht.FLOAT_4),o+=4):(t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.START_MULTIPLIER_INDEX),this._startMultiplierData.x,this._startMultiplierData.y,this._startMultiplierData.z,this._startMultiplierData.w),t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.DELTA_MULTIPLIER_INDEX),this._deltaMultiplierData.x,this._deltaMultiplierData.y,this._deltaMultiplierData.z,this._deltaMultiplierData.w))),this._usesOffset&&(this._particleColorNode.mode==Xn.LOCAL_STATIC?(n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.START_OFFSET_INDEX),o,t.stage,Ht.FLOAT_4),o+=4,n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.DELTA_OFFSET_INDEX),o,t.stage,Ht.FLOAT_4)):(t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.START_OFFSET_INDEX),this._startOffsetData.x,this._startOffsetData.y,this._startOffsetData.z,this._startOffsetData.w),t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.DELTA_OFFSET_INDEX),this._deltaOffsetData.x,this._deltaOffsetData.y,this._deltaOffsetData.z,this._deltaOffsetData.w)))}},e.prototype.updateColorData=function(){if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._cycleData=new P(2*Math.PI/this._cycleDuration,this._cyclePhase*Math.PI/180,0,0)}this._particleColorNode.mode==Xn.GLOBAL&&(this._usesCycle?(this._usesMultiplier&&(this._startMultiplierData=new P((this._startColor.redMultiplier+this._endColor.redMultiplier)/2,(this._startColor.greenMultiplier+this._endColor.greenMultiplier)/2,(this._startColor.blueMultiplier+this._endColor.blueMultiplier)/2,(this._startColor.alphaMultiplier+this._endColor.alphaMultiplier)/2),this._deltaMultiplierData=new P((this._endColor.redMultiplier-this._startColor.redMultiplier)/2,(this._endColor.greenMultiplier-this._startColor.greenMultiplier)/2,(this._endColor.blueMultiplier-this._startColor.blueMultiplier)/2,(this._endColor.alphaMultiplier-this._startColor.alphaMultiplier)/2)),this._usesOffset&&(this._startOffsetData=new P((this._startColor.redOffset+this._endColor.redOffset)/510,(this._startColor.greenOffset+this._endColor.greenOffset)/510,(this._startColor.blueOffset+this._endColor.blueOffset)/510,(this._startColor.alphaOffset+this._endColor.alphaOffset)/510),this._deltaOffsetData=new P((this._endColor.redOffset-this._startColor.redOffset)/510,(this._endColor.greenOffset-this._startColor.greenOffset)/510,(this._endColor.blueOffset-this._startColor.blueOffset)/510,(this._endColor.alphaOffset-this._startColor.alphaOffset)/510))):(this._usesMultiplier&&(this._startMultiplierData=new P(this._startColor.redMultiplier,this._startColor.greenMultiplier,this._startColor.blueMultiplier,this._startColor.alphaMultiplier),this._deltaMultiplierData=new P(this._endColor.redMultiplier-this._startColor.redMultiplier,this._endColor.greenMultiplier-this._startColor.greenMultiplier,this._endColor.blueMultiplier-this._startColor.blueMultiplier,this._endColor.alphaMultiplier-this._startColor.alphaMultiplier)),this._usesOffset&&(this._startOffsetData=new P(this._startColor.redOffset/255,this._startColor.greenOffset/255,this._startColor.blueOffset/255,this._startColor.alphaOffset/255),this._deltaOffsetData=new P((this._endColor.redOffset-this._startColor.redOffset)/255,(this._endColor.greenOffset-this._startColor.greenOffset)/255,(this._endColor.blueOffset-this._startColor.blueOffset)/255,(this._endColor.alphaOffset-this._startColor.alphaOffset)/255))))},e.START_MULTIPLIER_INDEX=0,e.DELTA_MULTIPLIER_INDEX=1,e.START_OFFSET_INDEX=2,e.DELTA_OFFSET_INDEX=3,e.CYCLE_INDEX=4,e}(Dr)),Lr=function(t){function e(e,i){var n=t.call(this,e,i,!0)||this;return n._particleTimeNode=i,n}return i(e,t),e.prototype.setRenderState=function(t,i,n,r){n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.TIME_STREAM_INDEX),this._particleTimeNode._iDataOffset,t.stage,Ht.FLOAT_4);var o=this._pTime/1e3;t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.TIME_CONSTANT_INDEX),o,o,o,o)},e.TIME_STREAM_INDEX=0,e.TIME_CONSTANT_INDEX=1,e}(Dr),Rr=function(t){function e(e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=!1);var r=t.call(this,"ParticleTime",Xn.LOCAL_STATIC,4,0)||this;return r._pStateClass=Lr,r._iUsesDuration=e,r._iUsesLooping=i,r._iUsesDelay=n,r}return i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=i.getFreeVertexAttribute();n.setRegisterIndex(this,Lr.TIME_STREAM_INDEX,r.index);var o=i.getFreeVertexConstant();n.setRegisterIndex(this,Lr.TIME_CONSTANT_INDEX,o.index);var s="";s+="sub "+n.vertexTime+","+o+","+r+".x\n";var a=i.getFreeVertexSingleTemp();if(s+="sge "+a+","+n.vertexTime+","+n.vertexZeroConst+"\n",s+="mul "+n.scaleAndRotateTarget+".xyz,"+n.scaleAndRotateTarget+".xyz,"+a+"\n",this._iUsesDuration)if(this._iUsesLooping){var l=i.getFreeVertexSingleTemp();this._iUsesDelay?(s+="div "+l+","+n.vertexTime+","+r+".z\n",s+="frc "+l+","+l+"\n",s+="mul "+n.vertexTime+","+l+","+r+".z\n",s+="slt "+l+","+n.vertexTime+","+r+".y\n",s+="mul "+n.scaleAndRotateTarget+".xyz,"+n.scaleAndRotateTarget+".xyz,"+l+"\n"):(s+="mul "+l+","+n.vertexTime+","+r+".w\n",s+="frc "+l+","+l+"\n",s+="mul "+n.vertexTime+","+l+","+r+".y\n")}else{var u=i.getFreeVertexSingleTemp();s+="sge "+u+","+r+".y,"+n.vertexTime+"\n",s+="mul "+n.scaleAndRotateTarget+".xyz,"+n.scaleAndRotateTarget+".xyz,"+u+"\n"}return s+="mul "+n.vertexLife+","+n.vertexTime+","+r+".w\n"},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){this._pOneData[0]=t.startTime,this._pOneData[1]=t.duration,this._pOneData[2]=t.delay+t.duration,this._pOneData[3]=1/t.duration},e}(Pr),Nr=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e}(o),Fr=function(t){function e(){var e=t.call(this)||this;return e._animations=new Array,e._animationNames=new Array,e._animationDictionary=new Object,e}return i(e,t),e.prototype._pFindTempReg=function(t,e){void 0===e&&(e=null);for(var i,n=0;;){if(i="vt"+n,-1==t.indexOf(i)&&e!=i)return i;++n}},Object.defineProperty(e.prototype,"usesCPU",{get:function(){return this._usesCPU},enumerable:!0,configurable:!0}),e.prototype.resetGPUCompatibility=function(){this._usesCPU=!1},e.prototype.cancelGPUCompatibility=function(){this._usesCPU=!0},e.prototype.getAGALVertexCode=function(t,e,i){throw new s},e.prototype.getAGALFragmentCode=function(t,e,i){throw new s},e.prototype.getAGALUVCode=function(t,e,i){throw new s},e.prototype.doneAGALCode=function(t){throw new s},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animations",{get:function(){return this._animations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),e.prototype.hasAnimation=function(t){return null!=this._animationDictionary[t]},e.prototype.getAnimation=function(t){return this._animationDictionary[t]},e.prototype.addAnimation=function(t){if(this._animationDictionary[t.name])throw new Nr("root node name '"+t.name+"' already exists in the set");this._animationDictionary[t.name]=t,this._animations.push(t),this._animationNames.push(t.name)},e.prototype.dispose=function(){},e.assetType="[asset AnimationSet]",e}(p),kr=function(t){function e(e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=!1);var r=t.call(this)||this;return r._animationElements=new Object,r._particleNodes=new Array,r._localDynamicNodes=new Array,r._localStaticNodes=new Array,r._totalLenOfOneVertex=0,r.addAnimation(r._timeNode=new Rr(e,i,n)),r}return i(e,t),Object.defineProperty(e.prototype,"particleNodes",{get:function(){return this._particleNodes},enumerable:!0,configurable:!0}),e.prototype.addAnimation=function(e){var i,n=e;for(n._iProcessAnimationSetting(this),n.mode==Xn.LOCAL_STATIC?(n._iDataOffset=this._totalLenOfOneVertex,this._totalLenOfOneVertex+=n.dataLength,this._localStaticNodes.push(n)):n.mode==Xn.LOCAL_DYNAMIC&&this._localDynamicNodes.push(n),i=this._particleNodes.length-1;i>=0&&!(this._particleNodes[i].priority<=n.priority);i--);this._particleNodes.splice(i+1,0,n),t.prototype.addAnimation.call(this,e)},e.prototype.getAGALVertexCode=function(t,i,n){this._iAnimationRegisterData=t.animationRegisterData,null==this._iAnimationRegisterData&&(this._iAnimationRegisterData=t.animationRegisterData=new ar),this._iAnimationRegisterData.reset(i,n,this.needVelocity);for(var r,o="",s=n.animatableAttributes.length,a=0;a<s;a++)o+="mov "+n.animationTargetRegisters[a]+","+n.animatableAttributes[a]+"\n";for(o+="mov "+this._iAnimationRegisterData.positionTarget+".xyz,"+this._iAnimationRegisterData.vertexZeroConst+"\n",this.needVelocity&&(o+="mov "+this._iAnimationRegisterData.velocityTarget+".xyz,"+this._iAnimationRegisterData.vertexZeroConst+"\n"),a=0;a<this._particleNodes.length;a++)(r=this._particleNodes[a]).priority<e.POST_PRIORITY&&(o+=r.getAGALVertexCode(t,this,i,this._iAnimationRegisterData));for(o+="add "+this._iAnimationRegisterData.scaleAndRotateTarget+".xyz,"+this._iAnimationRegisterData.scaleAndRotateTarget+".xyz,"+this._iAnimationRegisterData.positionTarget+".xyz\n",a=0;a<this._particleNodes.length;a++)(r=this._particleNodes[a]).priority>=e.POST_PRIORITY&&r.priority<e.COLOR_PRIORITY&&(o+=r.getAGALVertexCode(t,this,i,this._iAnimationRegisterData));for(this.hasColorMulNode&&(this._iAnimationRegisterData.colorMulTarget=i.getFreeVertexVectorTemp(),i.addVertexTempUsages(this._iAnimationRegisterData.colorMulTarget,1),this._iAnimationRegisterData.colorMulVary=i.getFreeVarying(),o+="mov "+this._iAnimationRegisterData.colorMulTarget+","+this._iAnimationRegisterData.vertexOneConst+"\n"),this.hasColorAddNode&&(this._iAnimationRegisterData.colorAddTarget=i.getFreeVertexVectorTemp(),i.addVertexTempUsages(this._iAnimationRegisterData.colorAddTarget,1),this._iAnimationRegisterData.colorAddVary=i.getFreeVarying(),o+="mov "+this._iAnimationRegisterData.colorAddTarget+","+this._iAnimationRegisterData.vertexZeroConst+"\n"),a=0;a<this._particleNodes.length;a++)(r=this._particleNodes[a]).priority>=e.COLOR_PRIORITY&&(o+=r.getAGALVertexCode(t,this,i,this._iAnimationRegisterData));return t.usesFragmentAnimation&&(this.hasColorAddNode||this.hasColorMulNode)&&(this.hasColorMulNode&&(o+="mov "+this._iAnimationRegisterData.colorMulVary+","+this._iAnimationRegisterData.colorMulTarget+"\n"),this.hasColorAddNode&&(o+="mov "+this._iAnimationRegisterData.colorAddVary+","+this._iAnimationRegisterData.colorAddTarget+"\n")),o},e.prototype.getAGALUVCode=function(t,e,i){var n="";if(this.hasUVNode){this._iAnimationRegisterData.setUVSourceAndTarget(i),n+="mov "+this._iAnimationRegisterData.uvTarget+".xy,"+this._iAnimationRegisterData.uvAttribute.toString()+"\n";for(var r=void 0,o=0;o<this._particleNodes.length;o++)r=this._particleNodes[o];n+=r.getAGALUVCode(t,this,e,this._iAnimationRegisterData),n+="mov "+this._iAnimationRegisterData.uvVar+","+this._iAnimationRegisterData.uvTarget+".xy\n"}else n+="mov "+i.animatedUV+","+i.uvInput+"\n";return n},e.prototype.getAGALFragmentCode=function(t,e,i){var n="";return t.usesFragmentAnimation&&(this.hasColorAddNode||this.hasColorMulNode)&&(this.hasColorMulNode&&(n+="mul "+i+","+i+","+this._iAnimationRegisterData.colorMulVary+"\n"),this.hasColorAddNode&&(n+="add "+i+","+i+","+this._iAnimationRegisterData.colorAddVary+"\n")),n},e.prototype.doneAGALCode=function(t){t.setVertexConst(this._iAnimationRegisterData.vertexZeroConst.index,0,1,2,0)},Object.defineProperty(e.prototype,"usesCPU",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.cancelGPUCompatibility=function(){},e.prototype.dispose=function(){for(var e in this._animationElements)this._animationElements[e].dispose();t.prototype.dispose.call(this)},e.prototype.getAnimationElements=function(t,e){var i=this._animationElements[e.id];return i||(this._iGenerateAnimationElements(t),this._animationElements[e.id])},e.prototype._iGenerateAnimationElements=function(t){if(null==this.initParticleFunc)throw new Error("no initParticleFunc set");var e,i,n,r,o,s,a=!1;for(e=0;e<t.numElements;e++)o=t.elements[e],this._animationElements[o.id]||((r=this._animationElements[o.id]=new Gn).createVertexData(o.numVertices,this._totalLenOfOneVertex),a=!0);if(a){var l,u,c,h,p,d,f,_,m,g,y,A=t.particles,v=A.length,b=t.numParticles,x=new Hn;for(x.total=b,x.startTime=0,x.duration=1e3,x.delay=.1,e=0,i=0;e<b;){for(x.index=e,this.initParticleFunc.call(this.initParticleScope,x),n=0;n<this._localStaticNodes.length;n++)this._localStaticNodes[n]._iGeneratePropertyOfOneParticle(x);for(;i<v&&(l=A[i]).particleIndex==e;){for(n=0;n<t.numElements;n++)if((o=t.elements[n])==l.elements){r=this._animationElements[o.id];break}for(f=l.numVertices,_=r.vertexData,m=f*this._totalLenOfOneVertex,g=r.numProcessedVertices*this._totalLenOfOneVertex,n=0;n<this._localStaticNodes.length;n++)for(d=(s=this._localStaticNodes[n]).oneData,u=s.dataLength,c=g+s._iDataOffset,h=0;h<m;h+=this._totalLenOfOneVertex)for(y=c+h,p=0;p<u;p++)_[y+p]=d[p];this._localDynamicNodes.length&&r.animationParticles.push(new zn(e,x.startTime,x.duration,x.delay,l)),r.numProcessedVertices+=f,i++}e++}}},e.POST_PRIORITY=9,e.COLOR_PRIORITY=18,e}(Fr),Vr=(function(t){function e(e,i,n,r,o,s,a,l,u){void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s=null),void 0===a&&(a=null),void 0===l&&(l=1),void 0===u&&(u=0);var c=t.call(this,"ParticleColor",e,i&&n?16:8,kr.COLOR_PRIORITY)||this;return c._pStateClass=Or,c._iUsesMultiplier=i,c._iUsesOffset=n,c._iUsesCycle=r,c._iUsesPhase=o,c._iStartColor=s||new I,c._iEndColor=a||new I,c._iCycleDuration=l,c._iCyclePhase=u,c}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r="";if(t.usesFragmentAnimation){var o=i.getFreeVertexVectorTemp();if(this._iUsesCycle){var s=i.getFreeVertexConstant();n.setRegisterIndex(this,Or.CYCLE_INDEX,s.index),i.addVertexTempUsages(o,1);var a=i.getFreeVertexSingleTemp();i.removeVertexTempUsage(o),r+="mul "+a+","+n.vertexTime+","+s+".x\n",this._iUsesPhase&&(r+="add "+a+","+a+","+s+".y\n"),r+="sin "+a+","+a+"\n"}if(this._iUsesMultiplier){var l=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute(),u=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Or.START_MULTIPLIER_INDEX,l.index),n.setRegisterIndex(this,Or.DELTA_MULTIPLIER_INDEX,u.index),r+="mul "+o+","+u+","+(this._iUsesCycle?a:n.vertexLife)+"\n",r+="add "+o+","+o+","+l+"\n",r+="mul "+n.colorMulTarget+","+o+","+n.colorMulTarget+"\n"}if(this._iUsesOffset){var c=this._pMode==Xn.LOCAL_STATIC?i.getFreeVertexAttribute():i.getFreeVertexConstant(),h=this._pMode==Xn.LOCAL_STATIC?i.getFreeVertexAttribute():i.getFreeVertexConstant();n.setRegisterIndex(this,Or.START_OFFSET_INDEX,c.index),n.setRegisterIndex(this,Or.DELTA_OFFSET_INDEX,h.index),r+="mul "+o+","+h+","+(this._iUsesCycle?a:n.vertexLife)+"\n",r+="add "+o+","+o+","+c+"\n",r+="add "+n.colorAddTarget+","+o+","+n.colorAddTarget+"\n"}}return r},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iProcessAnimationSetting=function(t){this._iUsesMultiplier&&(t.hasColorMulNode=!0),this._iUsesOffset&&(t.hasColorAddNode=!0)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.COLOR_START_COLORTRANSFORM];if(!i)throw new Error("there is no "+e.COLOR_START_COLORTRANSFORM+" in param!");var n=t[e.COLOR_END_COLORTRANSFORM];if(!n)throw new Error("there is no "+e.COLOR_END_COLORTRANSFORM+" in param!");var r=0;this._iUsesCycle?(this._iUsesMultiplier&&(this._pOneData[r++]=(i.redMultiplier+n.redMultiplier)/2,this._pOneData[r++]=(i.greenMultiplier+n.greenMultiplier)/2,this._pOneData[r++]=(i.blueMultiplier+n.blueMultiplier)/2,this._pOneData[r++]=(i.alphaMultiplier+n.alphaMultiplier)/2,this._pOneData[r++]=(i.redMultiplier-n.redMultiplier)/2,this._pOneData[r++]=(i.greenMultiplier-n.greenMultiplier)/2,this._pOneData[r++]=(i.blueMultiplier-n.blueMultiplier)/2,this._pOneData[r++]=(i.alphaMultiplier-n.alphaMultiplier)/2),this._iUsesOffset&&(this._pOneData[r++]=(i.redOffset+n.redOffset)/510,this._pOneData[r++]=(i.greenOffset+n.greenOffset)/510,this._pOneData[r++]=(i.blueOffset+n.blueOffset)/510,this._pOneData[r++]=(i.alphaOffset+n.alphaOffset)/510,this._pOneData[r++]=(i.redOffset-n.redOffset)/510,this._pOneData[r++]=(i.greenOffset-n.greenOffset)/510,this._pOneData[r++]=(i.blueOffset-n.blueOffset)/510,this._pOneData[r++]=(i.alphaOffset-n.alphaOffset)/510)):(this._iUsesMultiplier&&(this._pOneData[r++]=i.redMultiplier,this._pOneData[r++]=i.greenMultiplier,this._pOneData[r++]=i.blueMultiplier,this._pOneData[r++]=i.alphaMultiplier,this._pOneData[r++]=n.redMultiplier-i.redMultiplier,this._pOneData[r++]=n.greenMultiplier-i.greenMultiplier,this._pOneData[r++]=n.blueMultiplier-i.blueMultiplier,this._pOneData[r++]=n.alphaMultiplier-i.alphaMultiplier),this._iUsesOffset&&(this._pOneData[r++]=i.redOffset/255,this._pOneData[r++]=i.greenOffset/255,this._pOneData[r++]=i.blueOffset/255,this._pOneData[r++]=i.alphaOffset/255,this._pOneData[r++]=(n.redOffset-i.redOffset)/255,this._pOneData[r++]=(n.greenOffset-i.greenOffset)/255,this._pOneData[r++]=(n.blueOffset-i.blueOffset)/255,this._pOneData[r++]=(n.alphaOffset-i.alphaOffset)/255))},e.COLOR_START_COLORTRANSFORM="ColorStartColorTransform",e.COLOR_END_COLORTRANSFORM="ColorEndColorTransform"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i,!0)||this;return n._targetPos=new P,n._targetEuler=new P,n._temp=new P,n._particleFollowNode=i,n._smooth=i._iSmooth,n}return i(e,t),Object.defineProperty(e.prototype,"followTarget",{get:function(){return this._followTarget},set:function(t){this._followTarget=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smooth",{get:function(){return this._smooth},set:function(t){this._smooth=t},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){this._followTarget&&(this._particleFollowNode._iUsesPosition&&(this._targetPos.x=this._followTarget.transform.position.x/i.sourceEntity.transform.scale.x,this._targetPos.y=this._followTarget.transform.position.y/i.sourceEntity.transform.scale.y,this._targetPos.z=this._followTarget.transform.position.z/i.sourceEntity.transform.scale.z),this._particleFollowNode._iUsesRotation&&(this._targetEuler.x=this._followTarget.transform.rotation.x,this._targetEuler.y=this._followTarget.transform.rotation.y,this._targetEuler.z=this._followTarget.transform.rotation.z)),this._prePos||(this._prePos=this._targetPos.clone()),this._preEuler||(this._preEuler=this._targetEuler.clone());var o=this._pTime/1e3,s=n.previousTime,a=o-s,l=s!=o;this._particleFollowNode._iUsesPosition&&this._particleFollowNode._iUsesRotation?(l&&this.processPositionAndRotation(o,a,n),n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.FOLLOW_POSITION_INDEX),this._particleFollowNode._iDataOffset,t.stage,Ht.FLOAT_3),n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.FOLLOW_ROTATION_INDEX),this._particleFollowNode._iDataOffset+3,t.stage,Ht.FLOAT_3)):this._particleFollowNode._iUsesPosition?(l&&this.processPosition(o,a,n),n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.FOLLOW_POSITION_INDEX),this._particleFollowNode._iDataOffset,t.stage,Ht.FLOAT_3)):this._particleFollowNode._iUsesRotation&&(l&&this.precessRotation(o,a,n),n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.FOLLOW_ROTATION_INDEX),this._particleFollowNode._iDataOffset,t.stage,Ht.FLOAT_3)),this._prePos.copyFrom(this._targetPos),this._targetEuler.copyFrom(this._targetEuler),n.previousTime=o},e.prototype.processPosition=function(t,e,i){var n,r,o=i.animationParticles,s=i.vertexData,a=!1,l=o.length;this._smooth?(r=this._prePos.subtract(this._targetPos)).scaleBy(1/e):n=this._targetPos;for(var u=0;u<l;u++){var c=(t-o[u].startTime)/o[u].totalTime,h=(c-Math.floor(c))*o[u].totalTime;if(h-e<=0){var p=o[u].startVertexIndex*i.totalLenOfOneVertex+this._particleFollowNode._iDataOffset;if(this._smooth&&(this._temp.copyFrom(r),this._temp.scaleBy(h),n=this._targetPos.add(this._temp)),s[p]!=n.x||s[p+1]!=n.y||s[p+2]!=n.z){a=!0;for(var d=0;d<o[u].numVertices;d++)s[p++]=n.x,s[p++]=n.y,s[p++]=n.z}}}a&&i.invalidateBuffer()},e.prototype.precessRotation=function(t,e,i){var n,r,o=i.animationParticles,s=i.vertexData,a=!1,l=o.length;this._smooth?(r=this._preEuler.subtract(this._targetEuler)).scaleBy(1/e):n=this._targetEuler;for(var u=0;u<l;u++){var c=(t-o[u].startTime)/o[u].totalTime,h=(c-Math.floor(c))*o[u].totalTime;if(h-e<=0){var p=o[u].startVertexIndex*i.totalLenOfOneVertex+this._particleFollowNode._iDataOffset;if(this._smooth&&(this._temp.copyFrom(r),this._temp.scaleBy(h),n=this._targetEuler.add(this._temp)),s[p]!=n.x||s[p+1]!=n.y||s[p+2]!=n.z){a=!0;for(var d=0;d<o[u].numVertices;d++)s[p++]=n.x,s[p++]=n.y,s[p++]=n.z}}}a&&i.invalidateBuffer()},e.prototype.processPositionAndRotation=function(t,e,i){var n,r,o,s,a=i.animationParticles,l=i.vertexData,u=!1,c=a.length;this._smooth?((o=this._prePos.subtract(this._targetPos)).scaleBy(1/e),(s=this._preEuler.subtract(this._targetEuler)).scaleBy(1/e)):(n=this._targetPos,r=this._targetEuler);for(var h=0;h<c;h++){var p=(t-a[h].startTime)/a[h].totalTime,d=(p-Math.floor(p))*a[h].totalTime;if(d-e<=0){var f=a[h].startVertexIndex*i.totalLenOfOneVertex+this._particleFollowNode._iDataOffset;if(this._smooth&&(this._temp.copyFrom(o),this._temp.scaleBy(d),n=this._targetPos.add(this._temp),this._temp.copyFrom(s),this._temp.scaleBy(d),r=this._targetEuler.add(this._temp)),l[f]!=n.x||l[f+1]!=n.y||l[f+2]!=n.z||l[f+3]!=r.x||l[f+4]!=r.y||l[f+5]!=r.z){u=!0;for(var _=0;_<a[h].numVertices;_++)l[f++]=n.x,l[f++]=n.y,l[f++]=n.z,l[f++]=r.x,l[f++]=r.y,l[f++]=r.z}}}u&&i.invalidateBuffer()},e.FOLLOW_POSITION_INDEX=0,e.FOLLOW_ROTATION_INDEX=1,e}(Dr)),Ur=(function(t){function e(e,i,n){void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!1);var r=t.call(this,"ParticleFollow",Xn.LOCAL_DYNAMIC,e&&i?6:3,kr.POST_PRIORITY)||this;return r._pStateClass=Vr,r._iUsesPosition=e,r._iUsesRotation=i,r._iSmooth=n,r}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r="";if(this._iUsesRotation){var o=i.getFreeVertexAttribute();n.setRegisterIndex(this,Vr.FOLLOW_ROTATION_INDEX,o.index);var s=i.getFreeVertexVectorTemp();i.addVertexTempUsages(s,1);var a=i.getFreeVertexVectorTemp();i.addVertexTempUsages(a,1);var l=i.getFreeVertexVectorTemp(),u=void 0;e.hasBillboard&&(i.addVertexTempUsages(l,1),u=i.getFreeVertexVectorTemp()),i.removeVertexTempUsage(s),i.removeVertexTempUsage(a),e.hasBillboard&&i.removeVertexTempUsage(l);var c=n.rotationRegisters.length,h=void 0;if(r+="mov "+s+","+n.vertexZeroConst+"\n",r+="mov "+s+".x,"+n.vertexOneConst+"\n",r+="mov "+l+","+n.vertexZeroConst+"\n",r+="sin "+l+".y,"+o+".x\n",r+="cos "+l+".z,"+o+".x\n",r+="mov "+a+".x,"+n.vertexZeroConst+"\n",r+="mov "+a+".y,"+l+".z\n",r+="neg "+a+".z,"+l+".y\n",e.hasBillboard)r+="m33 "+u+".xyz,"+n.positionTarget+".xyz,"+s+"\n";else for(r+="m33 "+n.scaleAndRotateTarget+".xyz,"+n.scaleAndRotateTarget+".xyz,"+s+"\n",h=0;h<c;h++)r+="m33 "+n.rotationRegisters[h]+".xyz,"+n.rotationRegisters[h]+","+s+"\n";if(r+="mov "+s+","+n.vertexZeroConst+"\n",r+="cos "+s+".x,"+o+".y\n",r+="sin "+s+".z,"+o+".y\n",r+="mov "+a+","+n.vertexZeroConst+"\n",r+="mov "+a+".y,"+n.vertexOneConst+"\n",r+="mov "+l+","+n.vertexZeroConst+"\n",r+="neg "+l+".x,"+s+".z\n",r+="mov "+l+".z,"+s+".x\n",e.hasBillboard)r+="m33 "+u+".xyz,"+u+".xyz,"+s+"\n";else for(r+="m33 "+n.scaleAndRotateTarget+".xyz,"+n.scaleAndRotateTarget+".xyz,"+s+"\n",h=0;h<c;h++)r+="m33 "+n.rotationRegisters[h]+".xyz,"+n.rotationRegisters[h]+","+s+"\n";if(r+="mov "+a+","+n.vertexZeroConst+"\n",r+="sin "+a+".x,"+o+".z\n",r+="cos "+a+".y,"+o+".z\n",r+="mov "+s+","+n.vertexZeroConst+"\n",r+="mov "+s+".x,"+a+".y\n",r+="neg "+s+".y,"+a+".x\n",r+="mov "+l+","+n.vertexZeroConst+"\n",r+="mov "+l+".z,"+n.vertexOneConst+"\n",e.hasBillboard)r+="m33 "+u+".xyz,"+u+".xyz,"+s+"\n",r+="sub "+u+".xyz,"+u+".xyz,"+n.positionTarget+".xyz\n",r+="add "+n.scaleAndRotateTarget+".xyz,"+u+".xyz,"+n.scaleAndRotateTarget+".xyz\n";else for(r+="m33 "+n.scaleAndRotateTarget+".xyz,"+n.scaleAndRotateTarget+".xyz,"+s+"\n",h=0;h<c;h++)r+="m33 "+n.rotationRegisters[h]+".xyz,"+n.rotationRegisters[h]+","+s+"\n"}if(this._iUsesPosition){var p=i.getFreeVertexAttribute();n.setRegisterIndex(this,Vr.FOLLOW_POSITION_INDEX,p.index),r+="add "+n.scaleAndRotateTarget+".xyz,"+p+","+n.scaleAndRotateTarget+".xyz\n"}return r},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)}}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleInitialColorNode=i,n._usesMultiplier=i._iUsesMultiplier,n._usesOffset=i._iUsesOffset,n._initialColor=i._iInitialColor,n.updateColorData(),n}return i(e,t),Object.defineProperty(e.prototype,"initialColor",{get:function(){return this._initialColor},set:function(t){this._initialColor=t},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){if(t.usesFragmentAnimation)if(this._particleInitialColorNode.mode==Xn.LOCAL_STATIC){var o=this._particleInitialColorNode._iDataOffset;this._usesMultiplier&&(n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.MULTIPLIER_INDEX),o,t.stage,Ht.FLOAT_4),o+=4),this._usesOffset&&n.activateVertexBuffer(r.getRegisterIndex(this._pAnimationNode,e.OFFSET_INDEX),o,t.stage,Ht.FLOAT_4)}else this._usesMultiplier&&t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.MULTIPLIER_INDEX),this._multiplierData.x,this._multiplierData.y,this._multiplierData.z,this._multiplierData.w),this._usesOffset&&t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.OFFSET_INDEX),this._offsetData.x,this._offsetData.y,this._offsetData.z,this._offsetData.w)},e.prototype.updateColorData=function(){this._particleInitialColorNode.mode==Xn.GLOBAL&&(this._usesMultiplier&&(this._multiplierData=new P(this._initialColor.redMultiplier,this._initialColor.greenMultiplier,this._initialColor.blueMultiplier,this._initialColor.alphaMultiplier)),this._usesOffset&&(this._offsetData=new P(this._initialColor.redOffset/255,this._initialColor.greenOffset/255,this._initialColor.blueOffset/255,this._initialColor.alphaOffset/255)))},e.MULTIPLIER_INDEX=0,e.OFFSET_INDEX=1,e}(Dr)),jr=(function(t){function e(e,i,n,r){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===r&&(r=null);var o=t.call(this,"ParticleInitialColor",e,i&&n?8:4,kr.COLOR_PRIORITY)||this;return o._pStateClass=Ur,o._iUsesMultiplier=i,o._iUsesOffset=n,o._iInitialColor=r||new I,o}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r="";if(t.usesFragmentAnimation){if(this._iUsesMultiplier){var o=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Ur.MULTIPLIER_INDEX,o.index),r+="mul "+n.colorMulTarget+","+o+","+n.colorMulTarget+"\n"}if(this._iUsesOffset){var s=this._pMode==Xn.LOCAL_STATIC?i.getFreeVertexAttribute():i.getFreeVertexConstant();n.setRegisterIndex(this,Ur.OFFSET_INDEX,s.index),r+="add "+n.colorAddTarget+","+s+","+n.colorAddTarget+"\n"}}return r},e.prototype._iProcessAnimationSetting=function(t){this._iUsesMultiplier&&(t.hasColorMulNode=!0),this._iUsesOffset&&(t.hasColorAddNode=!0)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.COLOR_INITIAL_COLORTRANSFORM];if(!i)throw new Error("there is no "+e.COLOR_INITIAL_COLORTRANSFORM+" in param!");var n=0;this._iUsesMultiplier&&(this._pOneData[n++]=i.redMultiplier,this._pOneData[n++]=i.greenMultiplier,this._pOneData[n++]=i.blueMultiplier,this._pOneData[n++]=i.alphaMultiplier),this._iUsesOffset&&(this._pOneData[n++]=i.redOffset/255,this._pOneData[n++]=i.greenOffset/255,this._pOneData[n++]=i.blueOffset/255,this._pOneData[n++]=i.alphaOffset/255)},e.COLOR_INITIAL_COLORTRANSFORM="ColorInitialColorTransform"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleOrbitNode=i,n._usesEulers=n._particleOrbitNode._iUsesEulers,n._usesCycle=n._particleOrbitNode._iUsesCycle,n._usesPhase=n._particleOrbitNode._iUsesPhase,n._eulers=n._particleOrbitNode._iEulers,n._radius=n._particleOrbitNode._iRadius,n._cycleDuration=n._particleOrbitNode._iCycleDuration,n._cyclePhase=n._particleOrbitNode._iCyclePhase,n.updateOrbitData(),n}return i(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this.updateOrbitData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(t){this._cycleDuration=t,this.updateOrbitData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(t){this._cyclePhase=t,this.updateOrbitData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eulers",{get:function(){return this._eulers},set:function(t){this._eulers=t,this.updateOrbitData()},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){var o=r.getRegisterIndex(this._pAnimationNode,e.ORBIT_INDEX);this._particleOrbitNode.mode==Xn.LOCAL_STATIC?this._usesPhase?n.activateVertexBuffer(o,this._particleOrbitNode._iDataOffset,t.stage,Ht.FLOAT_4):n.activateVertexBuffer(o,this._particleOrbitNode._iDataOffset,t.stage,Ht.FLOAT_3):t.setVertexConst(o,this._orbitData.x,this._orbitData.y,this._orbitData.z,this._orbitData.w),this._usesEulers&&t.setVertexConstFromMatrix(r.getRegisterIndex(this._pAnimationNode,e.EULERS_INDEX),this._eulersMatrix)},e.prototype.updateOrbitData=function(){if(this._usesEulers&&(this._eulersMatrix=new R,this._eulersMatrix.appendRotation(this._eulers.x,P.X_AXIS),this._eulersMatrix.appendRotation(this._eulers.y,P.Y_AXIS),this._eulersMatrix.appendRotation(this._eulers.z,P.Z_AXIS)),this._particleOrbitNode.mode==Xn.GLOBAL)if(this._orbitData=new P(this._radius,0,this._radius*Math.PI*2,this._cyclePhase*Math.PI/180),this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._orbitData.y=2*Math.PI/this._cycleDuration}else this._orbitData.y=2*Math.PI},e.ORBIT_INDEX=0,e.EULERS_INDEX=1,e}(Dr)),Gr=(function(t){function e(e,i,n,r,o,s,a,l){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=100),void 0===s&&(s=1),void 0===a&&(a=0),void 0===l&&(l=null);var u=this,c=3;return r&&c++,(u=t.call(this,"ParticleOrbit",e,c)||this)._pStateClass=jr,u._iUsesEulers=i,u._iUsesCycle=n,u._iUsesPhase=r,u._iRadius=o,u._iCycleDuration=s,u._iCyclePhase=a,u._iEulers=l||new P,u}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,jr.ORBIT_INDEX,r.index);var o=i.getFreeVertexConstant();n.setRegisterIndex(this,jr.EULERS_INDEX,o.index),i.getFreeVertexConstant(),i.getFreeVertexConstant(),i.getFreeVertexConstant();var s=i.getFreeVertexVectorTemp();i.addVertexTempUsages(s,1);var a=new Fi(s.regName,s.index),l=i.getFreeVertexVectorTemp(),u=new Fi(l.regName,l.index,0),c=new Fi(l.regName,l.index,1),h=new Fi(l.regName,l.index,2);i.removeVertexTempUsage(s);var p="";return this._iUsesCycle?(p+="mul "+h+","+n.vertexTime+","+r+".y\n",this._iUsesPhase&&(p+="add "+h+","+h+","+r+".w\n")):p+="mul "+h+","+n.vertexLife+","+r+".y\n",p+="cos "+u+","+h+"\n",p+="sin "+c+","+h+"\n",p+="mul "+a+".x,"+u+","+r+".x\n",p+="mul "+a+".y,"+c+","+r+".x\n",p+="mov "+a+".wz"+n.vertexZeroConst+"\n",this._iUsesEulers&&(p+="m44 "+a+","+a+","+o+"\n"),p+="add "+n.positionTarget+".xyz,"+a+".xyz,"+n.positionTarget+".xyz\n",e.needVelocity&&(p+="neg "+a+".x,"+c+"\n",p+="mov "+a+".y,"+u+"\n",p+="mov "+a+".zw,"+n.vertexZeroConst+"\n",this._iUsesEulers&&(p+="m44 "+a+","+a+","+o+"\n"),p+="mul "+a+","+a+","+r+".z\n",p+="div "+a+","+a+","+r+".y\n",this._iUsesCycle||(p+="div "+a+","+a+","+n.vertexLife+"\n"),p+="add "+n.velocityTarget+".xyz,"+n.velocityTarget+".xyz,"+a+".xyz\n"),p},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.ORBIT_VECTOR3D];if(!i)throw new Error("there is no "+e.ORBIT_VECTOR3D+" in param!");if(this._pOneData[0]=i.x,this._iUsesCycle&&i.y<=0)throw new Error("the cycle duration must be greater than zero");this._pOneData[1]=2*Math.PI/(this._iUsesCycle?i.y:1),this._pOneData[2]=i.x*Math.PI*2,this._iUsesPhase&&(this._pOneData[3]=i.z*Math.PI/180)},e.ORBIT_VECTOR3D="OrbitVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleOscillatorNode=i,n._oscillator=n._particleOscillatorNode._iOscillator,n.updateOscillatorData(),n}return i(e,t),Object.defineProperty(e.prototype,"oscillator",{get:function(){return this._oscillator},set:function(t){this._oscillator=t,this.updateOscillatorData()},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){var o=r.getRegisterIndex(this._pAnimationNode,e.OSCILLATOR_INDEX);this._particleOscillatorNode.mode==Xn.LOCAL_STATIC?n.activateVertexBuffer(o,this._particleOscillatorNode._iDataOffset,t.stage,Ht.FLOAT_4):t.setVertexConst(o,this._oscillatorData.x,this._oscillatorData.y,this._oscillatorData.z,this._oscillatorData.w)},e.prototype.updateOscillatorData=function(){if(this._particleOscillatorNode.mode==Xn.GLOBAL){if(this._oscillator.w<=0)throw new Error("the cycle duration must greater than zero");null==this._oscillatorData&&(this._oscillatorData=new P),this._oscillatorData.x=this._oscillator.x,this._oscillatorData.y=this._oscillator.y,this._oscillatorData.z=this._oscillator.z,this._oscillatorData.w=2*Math.PI/this._oscillator.w}},e.OSCILLATOR_INDEX=0,e}(Dr)),Qr=(function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,"ParticleOscillator",e,4)||this;return n._pStateClass=Gr,n._iOscillator=i||new P,n}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Gr.OSCILLATOR_INDEX,r.index);var o=i.getFreeVertexVectorTemp(),s=new Fi(o.regName,o.index,0),a=new Fi(o.regName,o.index,1),l=new Fi(o.regName,o.index,2);i.addVertexTempUsages(o,1);var u=i.getFreeVertexVectorTemp(),c=new Fi(u.regName,u.index);i.removeVertexTempUsage(o);var h="";return h+="mul "+s+","+n.vertexTime+","+r+".w\n",h+="sin "+a+","+s+"\n",h+="mul "+c+".xyz,"+a+","+r+".xyz\n",h+="add "+n.positionTarget+".xyz,"+c+".xyz,"+n.positionTarget+".xyz\n",e.needVelocity&&(h+="cos "+l+","+s+"\n",h+="mul "+c+".xyz,"+l+","+r+".xyz\n",h+="add "+n.velocityTarget+".xyz,"+c+".xyz,"+n.velocityTarget+".xyz\n"),h},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.OSCILLATOR_VECTOR3D];if(!i)throw new Error("there is no "+e.OSCILLATOR_VECTOR3D+" in param!");if(this._pOneData[0]=i.x,this._pOneData[1]=i.y,this._pOneData[2]=i.z,i.w<=0)throw new Error("the cycle duration must greater than zero");this._pOneData[3]=2*Math.PI/i.w},e.OSCILLATOR_VECTOR3D="OscillatorVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particlePositionNode=i,n._position=n._particlePositionNode._iPosition,n}return i(e,t),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!0,configurable:!0}),e.prototype.getPositions=function(){return this._pDynamicProperties},e.prototype.setPositions=function(t){this._pDynamicProperties=t,this._pDynamicPropertiesDirty=new Object},e.prototype.setRenderState=function(t,i,n,r){this._particlePositionNode.mode!=Xn.LOCAL_DYNAMIC||this._pDynamicPropertiesDirty[n._iUniqueId]||this._pUpdateDynamicProperties(n);var o=r.getRegisterIndex(this._pAnimationNode,e.POSITION_INDEX);this._particlePositionNode.mode==Xn.GLOBAL?t.setVertexConst(o,this._position.x,this._position.y,this._position.z):n.activateVertexBuffer(o,this._particlePositionNode._iDataOffset,t.stage,Ht.FLOAT_3)},e.POSITION_INDEX=0,e}(Dr)),zr=(function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,"ParticlePosition",e,3)||this;return n._pStateClass=Qr,n._iPosition=i||new P,n}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();return n.setRegisterIndex(this,Qr.POSITION_INDEX,r.index),"add "+n.positionTarget+".xyz,"+r+".xyz,"+n.positionTarget+".xyz\n"},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.POSITION_VECTOR3D];if(!i)throw new Error("there is no "+e.POSITION_VECTOR3D+" in param!");this._pOneData[0]=i.x,this._pOneData[1]=i.y,this._pOneData[2]=i.z},e.POSITION_VECTOR3D="PositionVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._matrix=new R,n}return i(e,t),e.prototype.setRenderState=function(t,i,n,r){this._pParticleAnimator.animationSet.hasBillboard&&(this._matrix.copyFrom(i.sourceEntity.transform.concatenatedMatrix3D),this._matrix.append(t.view.projection.transform.inverseConcatenatedMatrix3D),t.setVertexConstFromMatrix(r.getRegisterIndex(this._pAnimationNode,e.MATRIX_INDEX),this._matrix))},e.MATRIX_INDEX=0,e}(Dr)),Hr=(function(t){function e(){var e=t.call(this,"ParticleRotateToHeading",Xn.GLOBAL,0,3)||this;return e._pStateClass=zr,e}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r,o="",s=n.rotationRegisters.length;if(e.hasBillboard){var a=i.getFreeVertexVectorTemp();i.addVertexTempUsages(a,1);var l=i.getFreeVertexVectorTemp();i.addVertexTempUsages(l,1);var u=i.getFreeVertexVectorTemp(),c=i.getFreeVertexConstant();for(n.setRegisterIndex(this,zr.MATRIX_INDEX,c.index),i.getFreeVertexConstant(),i.getFreeVertexConstant(),i.getFreeVertexConstant(),i.removeVertexTempUsage(a),i.removeVertexTempUsage(l),o+="m33 "+a+".xyz,"+n.velocityTarget+".xyz,"+c+"\n",o+="mov "+u+","+n.vertexZeroConst+"\n",o+="mov "+u+".xy,"+a+".xy\n",o+="nrm "+u+".xyz,"+u+".xyz\n",o+="mov "+l+","+n.vertexZeroConst+"\n",o+="mov "+l+".x,"+u+".y\n",o+="mov "+l+".y,"+u+".x\n",o+="mov "+a+","+n.vertexZeroConst+"\n",o+="mov "+a+".x,"+u+".x\n",o+="neg "+a+".y,"+u+".y\n",o+="mov "+u+","+n.vertexZeroConst+"\n",o+="mov "+u+".z,"+n.vertexOneConst+"\n",o+="m33 "+n.scaleAndRotateTarget+".xyz,"+n.scaleAndRotateTarget+".xyz,"+a+"\n",r=0;r<s;r++)o+="m33 "+n.rotationRegisters[r]+".xyz,"+n.rotationRegisters[r]+","+a+"\n"}else{var h=i.getFreeVertexVectorTemp();i.addVertexTempUsages(h,1);var p=i.getFreeVertexVectorTemp();i.addVertexTempUsages(p,1);var d=i.getFreeVertexVectorTemp();i.addVertexTempUsages(d,1);var f=i.getFreeVertexVectorTemp(),_=new Fi(d.regName,d.index,3),m=new Fi(f.regName,f.index,3),g=new Fi(h.regName,h.index,3),y=m;for(i.removeVertexTempUsage(h),i.removeVertexTempUsage(p),i.removeVertexTempUsage(d),o+="mov "+p+".x,"+n.vertexOneConst+"\n",o+="mov "+p+".yz,"+n.vertexZeroConst+"\n",o+="nrm "+h+".xyz,"+n.velocityTarget+".xyz\n",o+="dp3 "+g+","+h+".xyz,"+p+".xyz\n",o+="crs "+h+".xyz,"+p+".xyz,"+h+".xyz\n",o+="nrm "+h+".xyz,"+h+".xyz\n",o+="dp3 "+d+".x,"+h+".xyz,"+h+".xyz\n",o+="sge "+d+".x,"+n.vertexZeroConst+","+d+".x\n",o+="add "+h+".z,"+d+".x,"+h+".z\n",o+="add "+y+","+g+","+n.vertexOneConst+"\n",o+="div "+y+","+y+","+n.vertexTwoConst+"\n",o+="sqt "+_+","+y+"\n",o+="sub "+y+","+n.vertexOneConst+","+g+"\n",o+="div "+y+","+y+","+n.vertexTwoConst+"\n",o+="sqt "+m+","+y+"\n",o+="mul "+d+".xyz,"+m+","+h+".xyz\n",o+="mul "+f+".xyz,"+m+","+h+".xyz\n",o+="neg "+f+".xyz,"+f+".xyz\n",o+="crs "+h+".xyz,"+d+".xyz,"+n.scaleAndRotateTarget+".xyz\n",o+="mul "+p+".xyz,"+_+","+n.scaleAndRotateTarget+".xyz\n",o+="add "+h+".xyz,"+h+".xyz,"+p+".xyz\n",o+="dp3 "+p+".w,"+d+".xyz,"+n.scaleAndRotateTarget+".xyz\n",o+="neg "+h+".w,"+p+".w\n",o+="crs "+d+".xyz,"+h+".xyz,"+f+".xyz\n",o+="mul "+p+".xyzw,"+h+".xyzw,"+_+"\n",o+="add "+d+".xyz,"+d+".xyz,"+p+".xyz\n",o+="mul "+p+".xyz,"+h+".w,"+f+".xyz\n",o+="add "+n.scaleAndRotateTarget+".xyz,"+d+".xyz,"+p+".xyz\n",r=0;r<s;r++)o+="mov "+p+".x,"+n.vertexOneConst+"\n",o+="mov "+p+".yz,"+n.vertexZeroConst+"\n",o+="nrm "+h+".xyz,"+n.velocityTarget+".xyz\n",o+="dp3 "+g+","+h+".xyz,"+p+".xyz\n",o+="crs "+h+".xyz,"+p+".xyz,"+h+".xyz\n",o+="nrm "+h+".xyz,"+h+".xyz\n",o+="dp3 "+d+".x,"+h+".xyz,"+h+".xyz\n",o+="sge "+d+".x,"+n.vertexZeroConst+","+d+".x\n",o+="add "+h+".z,"+d+".x,"+h+".z\n",o+="add "+y+","+g+","+n.vertexOneConst+"\n",o+="div "+y+","+y+","+n.vertexTwoConst+"\n",o+="sqt "+_+","+y+"\n",o+="sub "+y+","+n.vertexOneConst+","+g+"\n",o+="div "+y+","+y+","+n.vertexTwoConst+"\n",o+="sqt "+m+","+y+"\n",o+="mul "+d+".xyz,"+m+","+h+".xyz\n",o+="mul "+f+".xyz,"+m+","+h+".xyz\n",o+="neg "+f+".xyz,"+f+".xyz\n",o+="crs "+h+".xyz,"+d+".xyz,"+n.rotationRegisters[r]+".xyz\n",o+="mul "+p+".xyz,"+_+","+n.rotationRegisters[r]+".xyz\n",o+="add "+h+".xyz,"+h+".xyz,"+p+".xyz\n",o+="dp3 "+p+".w,"+d+".xyz,"+n.rotationRegisters[r]+".xyz\n",o+="neg "+h+".w,"+p+".w\n",o+="crs "+d+".xyz,"+h+".xyz,"+f+".xyz\n",o+="mul "+p+".xyzw,"+h+".xyzw,"+_+"\n",o+="add "+d+".xyz,"+d+".xyz,"+p+".xyz\n",o+="mul "+p+".xyz,"+h+".w,"+f+".xyz\n",o+="add "+n.rotationRegisters[r]+".xyz,"+d+".xyz,"+p+".xyz\n"}return o},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iProcessAnimationSetting=function(t){t.needVelocity=!0}}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._matrix=new R,n._particleRotateToPositionNode=i,n._position=n._particleRotateToPositionNode._iPosition,n}return i(e,t),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){var o=r.getRegisterIndex(this._pAnimationNode,e.POSITION_INDEX);this._pParticleAnimator.animationSet.hasBillboard&&(this._matrix.copyFrom(i.sourceEntity.transform.concatenatedMatrix3D),this._matrix.append(t.view.projection.transform.inverseConcatenatedMatrix3D),t.setVertexConstFromMatrix(r.getRegisterIndex(this._pAnimationNode,e.MATRIX_INDEX),this._matrix)),this._particleRotateToPositionNode.mode==Xn.GLOBAL?(this._offset=i.sourceEntity.transform.inverseConcatenatedMatrix3D.transformVector(this._position),t.setVertexConst(o,this._offset.x,this._offset.y,this._offset.z)):n.activateVertexBuffer(o,this._particleRotateToPositionNode._iDataOffset,t.stage,Ht.FLOAT_3)},e.MATRIX_INDEX=0,e.POSITION_INDEX=1,e}(Dr)),Xr=(function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,"ParticleRotateToPosition",e,3,3)||this;return n._pStateClass=Hr,n._iPosition=i||new P,n}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Hr.POSITION_INDEX,r.index);var o,s="",a=n.rotationRegisters.length;if(e.hasBillboard){var l=i.getFreeVertexVectorTemp();i.addVertexTempUsages(l,1);var u=i.getFreeVertexVectorTemp();i.addVertexTempUsages(u,1);var c=i.getFreeVertexVectorTemp(),h=i.getFreeVertexConstant();for(n.setRegisterIndex(this,Hr.MATRIX_INDEX,h.index),i.getFreeVertexConstant(),i.getFreeVertexConstant(),i.getFreeVertexConstant(),i.removeVertexTempUsage(l),i.removeVertexTempUsage(u),s+="sub "+l+".xyz,"+r+".xyz,"+n.positionTarget+".xyz\n",s+="m33 "+l+".xyz,"+l+".xyz,"+h+"\n",s+="mov "+c+","+n.vertexZeroConst+"\n",s+="mov "+c+".xy,"+l+".xy\n",s+="nrm "+c+".xyz,"+c+".xyz\n",s+="mov "+u+","+n.vertexZeroConst+"\n",s+="mov "+u+".x,"+c+".y\n",s+="mov "+u+".y,"+c+".x\n",s+="mov "+l+","+n.vertexZeroConst+"\n",s+="mov "+l+".x,"+c+".x\n",s+="neg "+l+".y,"+c+".y\n",s+="mov "+c+","+n.vertexZeroConst+"\n",s+="mov "+c+".z,"+n.vertexOneConst+"\n",s+="m33 "+n.scaleAndRotateTarget+".xyz,"+n.scaleAndRotateTarget+".xyz,"+l+"\n",o=0;o<a;o++)s+="m33 "+n.rotationRegisters[o]+".xyz,"+n.rotationRegisters[o]+","+l+"\n"}else{var p=i.getFreeVertexVectorTemp();i.addVertexTempUsages(p,1);var d=i.getFreeVertexVectorTemp();i.addVertexTempUsages(d,1);var f=new Fi(d.regName,d.index,0),_=new Fi(d.regName,d.index,1),m=new Fi(d.regName,d.index,2),g=new Fi(d.regName,d.index,3),y=i.getFreeVertexVectorTemp();for(i.addVertexTempUsages(y,1),i.removeVertexTempUsage(p),i.removeVertexTempUsage(d),i.removeVertexTempUsage(y),s+="sub "+p+".xyz,"+r+".xyz,"+n.positionTarget+".xyz\n",s+="nrm "+p+".xyz,"+p+".xyz\n",s+="mov "+_+","+p+".y\n",s+="mul "+f+","+_+","+_+"\n",s+="sub "+f+","+n.vertexOneConst+","+f+"\n",s+="sqt "+f+","+f+"\n",s+="mul "+y+".x,"+f+","+n.scaleAndRotateTarget+".y\n",s+="mul "+y+".y,"+_+","+n.scaleAndRotateTarget+".z\n",s+="mul "+y+".z,"+_+","+n.scaleAndRotateTarget+".y\n",s+="mul "+y+".w,"+f+","+n.scaleAndRotateTarget+".z\n",s+="sub "+n.scaleAndRotateTarget+".y,"+y+".x,"+y+".y\n",s+="add "+n.scaleAndRotateTarget+".z,"+y+".z,"+y+".w\n",s+="abs "+y+".y,"+p+".y\n",s+="sge "+y+".z,"+y+".y,"+n.vertexOneConst+"\n",s+="mul "+y+".x,"+y+".y,"+p+".y\n",s+="mov "+p+".y,"+n.vertexZeroConst+"\n",s+="dp3 "+_+","+p+".xyz,"+p+".xyz\n",s+="sge "+g+","+n.vertexZeroConst+","+_+"\n",s+="mov "+p+".y,"+n.vertexZeroConst+"\n",s+="nrm "+p+".xyz,"+p+".xyz\n",s+="sub "+_+","+n.vertexOneConst+","+g+"\n",s+="mul "+_+","+_+","+p+".x\n",s+="mov "+f+","+p+".z\n",s+="neg "+f+","+f+"\n",s+="sub "+m+","+n.vertexOneConst+","+f+"\n",s+="mul "+m+","+y+".x,"+g+"\n",s+="add "+f+","+f+","+m+"\n",s+="mul "+y+".x,"+f+","+n.scaleAndRotateTarget+".x\n",s+="mul "+y+".y,"+_+","+n.scaleAndRotateTarget+".z\n",s+="mul "+y+".z,"+_+","+n.scaleAndRotateTarget+".x\n",s+="mul "+y+".w,"+f+","+n.scaleAndRotateTarget+".z\n",s+="sub "+n.scaleAndRotateTarget+".x,"+y+".x,"+y+".y\n",s+="add "+n.scaleAndRotateTarget+".z,"+y+".z,"+y+".w\n",o=0;o<a;o++)s+="sub "+p+".xyz,"+r+".xyz,"+n.positionTarget+".xyz\n",s+="nrm "+p+".xyz,"+p+".xyz\n",s+="mov "+_+","+p+".y\n",s+="mul "+f+","+_+","+_+"\n",s+="sub "+f+","+n.vertexOneConst+","+f+"\n",s+="sqt "+f+","+f+"\n",s+="mul "+y+".x,"+f+","+n.rotationRegisters[o]+".y\n",s+="mul "+y+".y,"+_+","+n.rotationRegisters[o]+".z\n",s+="mul "+y+".z,"+_+","+n.rotationRegisters[o]+".y\n",s+="mul "+y+".w,"+f+","+n.rotationRegisters[o]+".z\n",s+="sub "+n.rotationRegisters[o]+".y,"+y+".x,"+y+".y\n",s+="add "+n.rotationRegisters[o]+".z,"+y+".z,"+y+".w\n",s+="abs "+y+".y,"+p+".y\n",s+="sge "+y+".z,"+y+".y,"+n.vertexOneConst+"\n",s+="mul "+y+".x,"+y+".y,"+p+".y\n",s+="mov "+p+".y,"+n.vertexZeroConst+"\n",s+="dp3 "+_+","+p+".xyz,"+p+".xyz\n",s+="sge "+g+","+n.vertexZeroConst+","+_+"\n",s+="mov "+p+".y,"+n.vertexZeroConst+"\n",s+="nrm "+p+".xyz,"+p+".xyz\n",s+="sub "+_+","+n.vertexOneConst+","+g+"\n",s+="mul "+_+","+_+","+p+".x\n",s+="mov "+f+","+p+".z\n",s+="neg "+f+","+f+"\n",s+="sub "+m+","+n.vertexOneConst+","+f+"\n",s+="mul "+m+","+y+".x,"+g+"\n",s+="add "+f+","+f+","+m+"\n",s+="mul "+y+".x,"+f+","+n.rotationRegisters[o]+".x\n",s+="mul "+y+".y,"+_+","+n.rotationRegisters[o]+".z\n",s+="mul "+y+".z,"+_+","+n.rotationRegisters[o]+".x\n",s+="mul "+y+".w,"+f+","+n.rotationRegisters[o]+".z\n",s+="sub "+n.rotationRegisters[o]+".x,"+y+".x,"+y+".y\n",s+="add "+n.rotationRegisters[o]+".z,"+y+".z,"+y+".w\n"}return s},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.POSITION_VECTOR3D];if(!i)throw new Error("there is no "+e.POSITION_VECTOR3D+" in param!");this._pOneData[0]=i.x,this._pOneData[1]=i.y,this._pOneData[2]=i.z},e.POSITION_VECTOR3D="RotateToPositionVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleRotationalVelocityNode=i,n._rotationalVelocity=n._particleRotationalVelocityNode._iRotationalVelocity,n.updateRotationalVelocityData(),n}return i(e,t),Object.defineProperty(e.prototype,"rotationalVelocity",{get:function(){return this._rotationalVelocity},set:function(t){this._rotationalVelocity=t,this.updateRotationalVelocityData()},enumerable:!0,configurable:!0}),e.prototype.getRotationalVelocities=function(){return this._pDynamicProperties},e.prototype.setRotationalVelocities=function(t){this._pDynamicProperties=t,this._pDynamicPropertiesDirty=new Object},e.prototype.setRenderState=function(t,i,n,r){this._particleRotationalVelocityNode.mode!=Xn.LOCAL_DYNAMIC||this._pDynamicPropertiesDirty[n._iUniqueId]||this._pUpdateDynamicProperties(n);var o=r.getRegisterIndex(this._pAnimationNode,e.ROTATIONALVELOCITY_INDEX);this._particleRotationalVelocityNode.mode==Xn.GLOBAL?t.setVertexConst(o,this._rotationalVelocityData.x,this._rotationalVelocityData.y,this._rotationalVelocityData.z,this._rotationalVelocityData.w):n.activateVertexBuffer(o,this._particleRotationalVelocityNode._iDataOffset,t.stage,Ht.FLOAT_4)},e.prototype.updateRotationalVelocityData=function(){if(this._particleRotationalVelocityNode.mode==Xn.GLOBAL){if(this._rotationalVelocity.w<=0)throw new Error("the cycle duration must greater than zero");var t=this._rotationalVelocity.clone();t.length<=0?t.z=1:t.normalize(),this._rotationalVelocityData=new P(t.x,t.y,t.z,Math.PI/t.w)}},e.ROTATIONALVELOCITY_INDEX=0,e}(Dr)),qr=(function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,"ParticleRotationalVelocity",e,4)||this;return n._pStateClass=Xr,n._iRotationalVelocity=i||new P,n}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Xr.ROTATIONALVELOCITY_INDEX,r.index);var o=i.getFreeVertexVectorTemp();i.addVertexTempUsages(o,1);var s=i.getFreeVertexVectorTemp();i.addVertexTempUsages(s,1);var a=i.getFreeVertexVectorTemp();i.addVertexTempUsages(a,1);var l=new Fi(a.regName,a.index),u=i.getFreeVertexVectorTemp();u=new Fi(u.regName,u.index);var c=new Fi(l.regName,l.index,3),h=new Fi(u.regName,u.index,3);i.removeVertexTempUsage(o),i.removeVertexTempUsage(s),i.removeVertexTempUsage(a);var p="";p+="mov "+o+".xyz,"+r+".xyz\n",p+="mov "+o+".w,"+n.vertexZeroConst+"\n",p+="mul "+c+","+n.vertexTime+","+r+".w\n",p+="sin "+h+","+c+"\n",p+="cos "+c+","+c+"\n",p+="mul "+l+".xyz,"+h+","+o+".xyz\n",p+="mul "+u+".xyz,"+h+","+o+".xyz\n",p+="neg "+u+".xyz,"+u+".xyz\n",p+="crs "+o+".xyz,"+l+".xyz,"+n.scaleAndRotateTarget+".xyz\n",p+="mul "+s+".xyz,"+c+","+n.scaleAndRotateTarget+".xyz\n",p+="add "+o+".xyz,"+o+".xyz,"+s+".xyz\n",p+="dp3 "+s+".w,"+l+".xyz,"+n.scaleAndRotateTarget+".xyz\n",p+="neg "+o+".w,"+s+".w\n",p+="crs "+l+".xyz,"+o+".xyz,"+u+".xyz\n",p+="mul "+s+".xyzw,"+o+".xyzw,"+c+"\n",p+="add "+l+".xyz,"+l+".xyz,"+s+".xyz\n",p+="mul "+s+".xyz,"+o+".w,"+u+".xyz\n",p+="add "+n.scaleAndRotateTarget+".xyz,"+l+".xyz,"+s+".xyz\n";for(var d=n.rotationRegisters.length,f=0;f<d;f++)p+="mov "+o+".xyz,"+r+".xyz\n",p+="mov "+o+".w,"+n.vertexZeroConst+"\n",p+="mul "+c+","+n.vertexTime+","+r+".w\n",p+="sin "+h+","+c+"\n",p+="cos "+c+","+c+"\n",p+="mul "+l+".xyz,"+h+","+o+".xyz\n",p+="mul "+u+".xyz,"+h+","+o+".xyz\n",p+="neg "+u+".xyz,"+u+".xyz\n",p+="crs "+o+".xyz,"+l+".xyz,"+n.rotationRegisters[f]+".xyz\n",p+="mul "+s+".xyz,"+c+","+n.rotationRegisters[f]+"\n",p+="add "+o+".xyz,"+o+".xyz,"+s+".xyz\n",p+="dp3 "+s+".w,"+l+".xyz,"+n.rotationRegisters[f]+"\n",p+="neg "+o+".w,"+s+".w\n",p+="crs "+l+".xyz,"+o+".xyz,"+u+".xyz\n",p+="mul "+s+".xyzw,"+o+".xyzw,"+c+"\n",p+="add "+l+".xyz,"+l+".xyz,"+s+".xyz\n",p+="mul "+s+".xyz,"+o+".w,"+u+".xyz\n",p+="add "+n.rotationRegisters[f]+","+l+".xyz,"+s+".xyz\n";return p},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.ROTATIONALVELOCITY_VECTOR3D];if(!i)throw new Error("there is no "+e.ROTATIONALVELOCITY_VECTOR3D+" in param!");if(i.length<=0?i.z=1:i.normalize(),this._pOneData[0]=i.x,this._pOneData[1]=i.y,this._pOneData[2]=i.z,i.w<=0)throw new Error("the cycle duration must greater than zero");this._pOneData[3]=Math.PI/i.w},e.ROTATIONALVELOCITY_VECTOR3D="RotationalVelocityVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleScaleNode=i,n._usesCycle=n._particleScaleNode._iUsesCycle,n._usesPhase=n._particleScaleNode._iUsesPhase,n._minScale=n._particleScaleNode._iMinScale,n._maxScale=n._particleScaleNode._iMaxScale,n._cycleDuration=n._particleScaleNode._iCycleDuration,n._cyclePhase=n._particleScaleNode._iCyclePhase,n.updateScaleData(),n}return i(e,t),Object.defineProperty(e.prototype,"minScale",{get:function(){return this._minScale},set:function(t){this._minScale=t,this.updateScaleData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxScale",{get:function(){return this._maxScale},set:function(t){this._maxScale=t,this.updateScaleData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(t){this._cycleDuration=t,this.updateScaleData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(t){this._cyclePhase=t,this.updateScaleData()},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){var o=r.getRegisterIndex(this._pAnimationNode,e.SCALE_INDEX);this._particleScaleNode.mode==Xn.LOCAL_STATIC?this._usesCycle?this._usesPhase?n.activateVertexBuffer(o,this._particleScaleNode._iDataOffset,t.stage,Ht.FLOAT_4):n.activateVertexBuffer(o,this._particleScaleNode._iDataOffset,t.stage,Ht.FLOAT_3):n.activateVertexBuffer(o,this._particleScaleNode._iDataOffset,t.stage,Ht.FLOAT_2):t.setVertexConst(o,this._scaleData.x,this._scaleData.y,this._scaleData.z,this._scaleData.w)},e.prototype.updateScaleData=function(){if(this._particleScaleNode.mode==Xn.GLOBAL)if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._scaleData=new P((this._minScale+this._maxScale)/2,Math.abs(this._minScale-this._maxScale)/2,2*Math.PI/this._cycleDuration,this._cyclePhase*Math.PI/180)}else this._scaleData=new P(this._minScale,this._maxScale-this._minScale,0,0)},e.SCALE_INDEX=0,e}(Dr)),Yr=(function(t){function e(e,i,n,r,o,s,a){void 0===r&&(r=1),void 0===o&&(o=1),void 0===s&&(s=1),void 0===a&&(a=0);var l=t.call(this,"ParticleScale",e,i&&n?4:i||n?3:2,3)||this;return l._pStateClass=qr,l._iUsesCycle=i,l._iUsesPhase=n,l._iMinScale=r,l._iMaxScale=o,l._iCycleDuration=s,l._iCyclePhase=a,l}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r="",o=i.getFreeVertexSingleTemp(),s=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();return n.setRegisterIndex(this,qr.SCALE_INDEX,s.index),this._iUsesCycle&&(r+="mul "+o+","+n.vertexTime+","+s+".z\n",this._iUsesPhase&&(r+="add "+o+","+o+","+s+".w\n"),r+="sin "+o+","+o+"\n"),r+="mul "+o+","+s+".y,"+(this._iUsesCycle?o:n.vertexLife)+"\n",r+="add "+o+","+s+".x,"+o+"\n",r+="mul "+n.scaleAndRotateTarget+".xyz,"+n.scaleAndRotateTarget+".xyz,"+o+"\n"},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.SCALE_VECTOR3D];if(!i)throw new Error("there is no "+e.SCALE_VECTOR3D+" in param!");if(this._iUsesCycle){if(this._pOneData[0]=(i.x+i.y)/2,this._pOneData[1]=Math.abs(i.x-i.y)/2,i.z<=0)throw new Error("the cycle duration must be greater than zero");this._pOneData[2]=2*Math.PI/i.z,this._iUsesPhase&&(this._pOneData[3]=i.w*Math.PI/180)}else this._pOneData[0]=i.x,this._pOneData[1]=i.y-i.x},e.SCALE_VECTOR3D="ScaleVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._usesMultiplier=i._iUsesMultiplier,n._usesOffset=i._iUsesOffset,n._startColor=i._iStartColor,n._endColor=i._iEndColor,n._segmentPoints=i._iSegmentPoints,n._numSegmentPoint=i._iNumSegmentPoint,n.updateColorData(),n}return i(e,t),Object.defineProperty(e.prototype,"startColor",{get:function(){return this._startColor},set:function(t){this._startColor=t,this.updateColorData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endColor",{get:function(){return this._endColor},set:function(t){this._endColor=t,this.updateColorData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numSegmentPoint",{get:function(){return this._numSegmentPoint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentPoints",{get:function(){return this._segmentPoints},set:function(t){this._segmentPoints=t,this.updateColorData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usesMultiplier",{get:function(){return this._usesMultiplier},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usesOffset",{get:function(){return this._usesOffset},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){t.usesFragmentAnimation&&(this._numSegmentPoint>0&&t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.TIME_DATA_INDEX),this._timeLifeData[0],this._timeLifeData[1],this._timeLifeData[2],this._timeLifeData[3]),this._usesMultiplier&&t.setVertexConstFromArray(r.getRegisterIndex(this._pAnimationNode,e.START_MULTIPLIER_INDEX),this._multiplierData),this._usesOffset&&t.setVertexConstFromArray(r.getRegisterIndex(this._pAnimationNode,e.START_OFFSET_INDEX),this._offsetData))},e.prototype.updateColorData=function(){var t;this._timeLifeData=new Float32Array(4),this._multiplierData=new Float32Array(4*(this._numSegmentPoint+1)),this._offsetData=new Float32Array(4*(this._numSegmentPoint+1));var e=0,i=this._numSegmentPoint>3?3:this._numSegmentPoint;for(t=0;t<i;t++)this._timeLifeData[e++]=0==t?this._segmentPoints[t].life:this._segmentPoints[t].life-this._segmentPoints[t-1].life;if(t=i,0==this._numSegmentPoint?this._timeLifeData[e++]=1:this._timeLifeData[e++]=1-this._segmentPoints[t-1].life,this._usesMultiplier){for(e=0,this._multiplierData[e++]=this._startColor.redMultiplier,this._multiplierData[e++]=this._startColor.greenMultiplier,this._multiplierData[e++]=this._startColor.blueMultiplier,this._multiplierData[e++]=this._startColor.alphaMultiplier,t=0;t<this._numSegmentPoint;t++)0==t?(this._multiplierData[e++]=(this._segmentPoints[t].color.redMultiplier-this._startColor.redMultiplier)/this._timeLifeData[t],this._multiplierData[e++]=(this._segmentPoints[t].color.greenMultiplier-this._startColor.greenMultiplier)/this._timeLifeData[t],this._multiplierData[e++]=(this._segmentPoints[t].color.blueMultiplier-this._startColor.blueMultiplier)/this._timeLifeData[t],this._multiplierData[e++]=(this._segmentPoints[t].color.alphaMultiplier-this._startColor.alphaMultiplier)/this._timeLifeData[t]):(this._multiplierData[e++]=(this._segmentPoints[t].color.redMultiplier-this._segmentPoints[t-1].color.redMultiplier)/this._timeLifeData[t],this._multiplierData[e++]=(this._segmentPoints[t].color.greenMultiplier-this._segmentPoints[t-1].color.greenMultiplier)/this._timeLifeData[t],this._multiplierData[e++]=(this._segmentPoints[t].color.blueMultiplier-this._segmentPoints[t-1].color.blueMultiplier)/this._timeLifeData[t],this._multiplierData[e++]=(this._segmentPoints[t].color.alphaMultiplier-this._segmentPoints[t-1].color.alphaMultiplier)/this._timeLifeData[t]);t=this._numSegmentPoint,0==this._numSegmentPoint?(this._multiplierData[e++]=this._endColor.redMultiplier-this._startColor.redMultiplier,this._multiplierData[e++]=this._endColor.greenMultiplier-this._startColor.greenMultiplier,this._multiplierData[e++]=this._endColor.blueMultiplier-this._startColor.blueMultiplier,this._multiplierData[e++]=this._endColor.alphaMultiplier-this._startColor.alphaMultiplier):(this._multiplierData[e++]=(this._endColor.redMultiplier-this._segmentPoints[t-1].color.redMultiplier)/this._timeLifeData[t],this._multiplierData[e++]=(this._endColor.greenMultiplier-this._segmentPoints[t-1].color.greenMultiplier)/this._timeLifeData[t],this._multiplierData[e++]=(this._endColor.blueMultiplier-this._segmentPoints[t-1].color.blueMultiplier)/this._timeLifeData[t],this._multiplierData[e++]=(this._endColor.alphaMultiplier-this._segmentPoints[t-1].color.alphaMultiplier)/this._timeLifeData[t])}if(this._usesOffset){for(e=0,this._offsetData[e++]=this._startColor.redOffset/255,this._offsetData[e++]=this._startColor.greenOffset/255,this._offsetData[e++]=this._startColor.blueOffset/255,this._offsetData[e++]=this._startColor.alphaOffset/255,t=0;t<this._numSegmentPoint;t++)0==t?(this._offsetData[e++]=(this._segmentPoints[t].color.redOffset-this._startColor.redOffset)/this._timeLifeData[t]/255,this._offsetData[e++]=(this._segmentPoints[t].color.greenOffset-this._startColor.greenOffset)/this._timeLifeData[t]/255,this._offsetData[e++]=(this._segmentPoints[t].color.blueOffset-this._startColor.blueOffset)/this._timeLifeData[t]/255,this._offsetData[e++]=(this._segmentPoints[t].color.alphaOffset-this._startColor.alphaOffset)/this._timeLifeData[t]/255):(this._offsetData[e++]=(this._segmentPoints[t].color.redOffset-this._segmentPoints[t-1].color.redOffset)/this._timeLifeData[t]/255,this._offsetData[e++]=(this._segmentPoints[t].color.greenOffset-this._segmentPoints[t-1].color.greenOffset)/this._timeLifeData[t]/255,this._offsetData[e++]=(this._segmentPoints[t].color.blueOffset-this._segmentPoints[t-1].color.blueOffset)/this._timeLifeData[t]/255,this._offsetData[e++]=(this._segmentPoints[t].color.alphaOffset-this._segmentPoints[t-1].color.alphaOffset)/this._timeLifeData[t]/255);t=this._numSegmentPoint,0==this._numSegmentPoint?(this._offsetData[e++]=(this._endColor.redOffset-this._startColor.redOffset)/255,this._offsetData[e++]=(this._endColor.greenOffset-this._startColor.greenOffset)/255,this._offsetData[e++]=(this._endColor.blueOffset-this._startColor.blueOffset)/255,this._offsetData[e++]=(this._endColor.alphaOffset-this._startColor.alphaOffset)/255):(this._offsetData[t]=(this._endColor.redOffset-this._segmentPoints[t-1].color.redOffset)/this._timeLifeData[t]/255,this._offsetData[e++]=(this._endColor.greenOffset-this._segmentPoints[t-1].color.greenOffset)/this._timeLifeData[t]/255,this._offsetData[e++]=(this._endColor.blueOffset-this._segmentPoints[t-1].color.blueOffset)/this._timeLifeData[t]/255,this._offsetData[e++]=(this._endColor.alphaOffset-this._segmentPoints[t-1].color.alphaOffset)/this._timeLifeData[t]/255)}},e.START_MULTIPLIER_INDEX=0,e.START_OFFSET_INDEX=1,e.TIME_DATA_INDEX=2,e}(Dr)),Kr=(function(t){function e(e,i,n,r,o,s){var a=t.call(this,"ParticleSegmentedColor",Xn.GLOBAL,0,kr.COLOR_PRIORITY)||this;if(a._pStateClass=Yr,n>4)throw new Error("the numSegmentPoint must be less or equal 4");return a._iUsesMultiplier=e,a._iUsesOffset=i,a._iNumSegmentPoint=n,a._iStartColor=r,a._iEndColor=o,a._iSegmentPoints=s,a}i(e,t),e.prototype._iProcessAnimationSetting=function(t){this._iUsesMultiplier&&(t.hasColorMulNode=!0),this._iUsesOffset&&(t.hasColorAddNode=!0)},e.prototype.getAGALVertexCode=function(t,e,i,n){var r="";if(t.usesFragmentAnimation){var o=void 0;this._iUsesMultiplier&&(o=i.getFreeVertexVectorTemp(),i.addVertexTempUsages(o,1));var s=i.getFreeVertexVectorTemp();i.addVertexTempUsages(s,1);var a=i.getFreeVertexVectorTemp(),l=new Fi(a.regName,a.index,0),u=new Fi(a.regName,a.index,1);this._iUsesMultiplier&&i.removeVertexTempUsage(o),i.removeVertexTempUsage(s);var c=i.getFreeVertexConstant();n.setRegisterIndex(this,Yr.TIME_DATA_INDEX,c.index);var h=void 0,p=void 0,d=void 0;if(this._iUsesMultiplier)for(p=i.getFreeVertexConstant(),n.setRegisterIndex(this,Yr.START_MULTIPLIER_INDEX,p.index),d=new Array,h=0;h<this._iNumSegmentPoint+1;h++)d.push(i.getFreeVertexConstant());var f=void 0,_=void 0;if(this._iUsesOffset)for(f=i.getFreeVertexConstant(),n.setRegisterIndex(this,Yr.START_OFFSET_INDEX,f.index),_=new Array,h=0;h<this._iNumSegmentPoint+1;h++)_.push(i.getFreeVertexConstant());for(this._iUsesMultiplier&&(r+="mov "+o+","+p+"\n"),this._iUsesOffset&&(r+="add "+n.colorAddTarget+","+n.colorAddTarget+","+f+"\n"),h=0;h<this._iNumSegmentPoint;h++){switch(h){case 0:r+="min "+u+","+n.vertexLife+","+c+".x\n";break;case 1:r+="sub "+l+","+n.vertexLife+","+c+".x\n",r+="max "+u+","+l+","+n.vertexZeroConst+"\n",r+="min "+u+","+u+","+c+".y\n";break;case 2:r+="sub "+l+","+l+","+c+".y\n",r+="max "+u+","+l+","+n.vertexZeroConst+"\n",r+="min "+u+","+u+","+c+".z\n";break;case 3:r+="sub "+l+","+l+","+c+".z\n",r+="max "+u+","+l+","+n.vertexZeroConst+"\n",r+="min "+u+","+u+","+c+".w\n"}this._iUsesMultiplier&&(r+="mul "+s+","+u+","+d[h]+"\n",r+="add "+o+","+o+","+s+"\n"),this._iUsesOffset&&(r+="mul "+s+","+u+","+_[h]+"\n",r+="add "+n.colorAddTarget+","+n.colorAddTarget+","+s+"\n")}if(0==this._iNumSegmentPoint)u=n.vertexLife;else{switch(this._iNumSegmentPoint){case 1:r+="sub "+l+","+n.vertexLife+","+c+".x\n";break;case 2:r+="sub "+l+","+l+","+c+".y\n";break;case 3:r+="sub "+l+","+l+","+c+".z\n";break;case 4:r+="sub "+l+","+l+","+c+".w\n"}r+="max "+u+","+l+","+n.vertexZeroConst+"\n"}this._iUsesMultiplier&&(r+="mul "+s+","+u+","+d[this._iNumSegmentPoint]+"\n",r+="add "+o+","+o+","+s+"\n",r+="mul "+n.colorMulTarget+","+n.colorMulTarget+","+o+"\n"),this._iUsesOffset&&(r+="mul "+s+","+u+","+_[this._iNumSegmentPoint]+"\n",r+="add "+n.colorAddTarget+","+n.colorAddTarget+","+s+"\n")}return r}}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleSpriteSheetNode=i,n._usesCycle=n._particleSpriteSheetNode._iUsesCycle,n._usesPhase=n._particleSpriteSheetNode._iUsesCycle,n._totalFrames=n._particleSpriteSheetNode._iTotalFrames,n._numColumns=n._particleSpriteSheetNode._iNumColumns,n._numRows=n._particleSpriteSheetNode._iNumRows,n._cycleDuration=n._particleSpriteSheetNode._iCycleDuration,n._cyclePhase=n._particleSpriteSheetNode._iCyclePhase,n.updateSpriteSheetData(),n}return i(e,t),Object.defineProperty(e.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(t){this._cyclePhase=t,this.updateSpriteSheetData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(t){this._cycleDuration=t,this.updateSpriteSheetData()},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,i,n,r){if(!t.usesUVTransform&&(t.setVertexConst(r.getRegisterIndex(this._pAnimationNode,e.UV_INDEX_0),this._spriteSheetData[0],this._spriteSheetData[1],this._spriteSheetData[2],this._spriteSheetData[3]),this._usesCycle)){var o=r.getRegisterIndex(this._pAnimationNode,e.UV_INDEX_1);this._particleSpriteSheetNode.mode==Xn.LOCAL_STATIC?this._usesPhase?n.activateVertexBuffer(o,this._particleSpriteSheetNode._iDataOffset,t.stage,Ht.FLOAT_3):n.activateVertexBuffer(o,this._particleSpriteSheetNode._iDataOffset,t.stage,Ht.FLOAT_2):t.setVertexConst(o,this._spriteSheetData[4],this._spriteSheetData[5])}},e.prototype.updateSpriteSheetData=function(){this._spriteSheetData=new Array(8);var t=this._totalFrames/this._numColumns;if(this._spriteSheetData[0]=t,this._spriteSheetData[1]=1/this._numColumns,this._spriteSheetData[2]=1/this._numRows,this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._spriteSheetData[4]=t/this._cycleDuration,this._spriteSheetData[5]=this._cycleDuration,this._usesPhase&&(this._spriteSheetData[6]=this._cyclePhase)}},e.UV_INDEX_0=0,e.UV_INDEX_1=1,e}(Dr)),Wr=(function(t){function e(e,i,n,r,o,s,a,l){void 0===r&&(r=1),void 0===o&&(o=1),void 0===s&&(s=1),void 0===a&&(a=0),void 0===l&&(l=Number.MAX_VALUE);var u=t.call(this,"ParticleSpriteSheet",e,i?n?3:2:1,kr.POST_PRIORITY+1)||this;return u._pStateClass=Kr,u._iUsesCycle=i,u._iUsesPhase=n,u._iNumColumns=r,u._iNumRows=o,u._iCyclePhase=a,u._iCycleDuration=s,u._iTotalFrames=Math.min(l,r*o),u}i(e,t),Object.defineProperty(e.prototype,"numColumns",{get:function(){return this._iNumColumns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numRows",{get:function(){return this._iNumRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._iTotalFrames},enumerable:!0,configurable:!0}),e.prototype.getAGALUVCode=function(t,e,i,n){var r=i.getFreeVertexConstant(),o=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Kr.UV_INDEX_0,r.index),n.setRegisterIndex(this,Kr.UV_INDEX_1,o.index);var s=new Fi(r.regName,r.index,0),a=new Fi(r.regName,r.index,1),l=new Fi(r.regName,r.index,2),u=new Fi(o.regName,o.index,0),c=new Fi(o.regName,o.index,1),h=new Fi(o.regName,o.index,2),p=i.getFreeVertexVectorTemp(),d=new Fi(p.regName,p.index,0),f=new Fi(p.regName,p.index,1);p=new Fi(p.regName,p.index,2);var _=new Fi(p.regName,p.index,3),m=new Fi(n.uvTarget.regName,n.uvTarget.index,0),g=new Fi(n.uvTarget.regName,n.uvTarget.index,1),y="";return y+="mul "+m+","+m+","+a+"\n",this._iNumRows>1&&(y+="mul "+g+","+g+","+l+"\n"),this._iUsesCycle?(this._iUsesPhase?y+="add "+d+","+n.vertexTime+","+h+"\n":y+="mov "+d+","+n.vertexTime+"\n",y+="div "+d+","+d+","+c+"\n",y+="frc "+d+","+d+"\n",y+="mul "+d+","+d+","+c+"\n",y+="mul "+p+","+d+","+u+"\n"):y+="mul "+p.toString()+","+n.vertexLife+","+s+"\n",this._iNumRows>1&&(y+="frc "+_+","+p+"\n",y+="sub "+f+","+p+","+_+"\n",y+="mul "+f+","+f+","+l+"\n",y+="add "+g+","+g+","+f+"\n"),y+="div "+_+","+p+","+a+"\n",y+="frc "+p+","+_+"\n",y+="sub "+_+","+_+","+p+"\n",y+="mul "+p+","+_+","+a+"\n",this._iNumRows>1&&(y+="frc "+p+","+p+"\n"),y+="add "+m+","+m+","+p+"\n"},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iProcessAnimationSetting=function(t){t.hasUVNode=!0},e.prototype._iGeneratePropertyOfOneParticle=function(t){if(this._iUsesCycle){var i=t[e.UV_VECTOR3D];if(!i)throw new Error("there is no "+e.UV_VECTOR3D+" in param!");if(i.x<=0)throw new Error("the cycle duration must be greater than zero");var n=this._iTotalFrames/this._iNumColumns;this._pOneData[0]=n/i.x,this._pOneData[1]=i.x,this._iUsesPhase&&(this._pOneData[2]=i.y)}},e.UV_VECTOR3D="UVVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleUVNode=i,n}return i(e,t),e.prototype.setRenderState=function(t,i,n,r){if(!t.usesUVTransform){var o=r.getRegisterIndex(this._pAnimationNode,e.UV_INDEX),s=this._particleUVNode._iUvData;t.setVertexConst(o,s.x,s.y)}},e.UV_INDEX=0,e}(Dr)),Jr=(function(t){function e(e,i,n,r){void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r="x");var o=t.call(this,"ParticleUV",Xn.GLOBAL,4,kr.POST_PRIORITY+1)||this;return o._pStateClass=Wr,o._cycle=i,o._scale=n,o._axis=r,o.updateUVData(),o}i(e,t),Object.defineProperty(e.prototype,"cycle",{get:function(){return this._cycle},set:function(t){this._cycle=t,this.updateUVData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale=t,this.updateUVData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axis",{get:function(){return this._axis},set:function(t){this._axis=t},enumerable:!0,configurable:!0}),e.prototype.getAGALUVCode=function(t,e,i,n){var r="",o=i.getFreeVertexConstant();n.setRegisterIndex(this,Wr.UV_INDEX,o.index);var s="x"==this._axis?0:"y"==this._axis?1:2,a=new Fi(n.uvTarget.regName,n.uvTarget.index,s),l=i.getFreeVertexSingleTemp();return 1!=this._scale&&(r+="mul "+a+","+a+","+o+".y\n"),r+="mul "+l+","+n.vertexTime+","+o+".x\n",r+="sin "+l+","+l+"\n",r+="add "+a+","+a+","+l+"\n"},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype.updateUVData=function(){this._iUvData=new P(2*Math.PI/this._cycle,this._scale,0,0)},e.prototype._iProcessAnimationSetting=function(t){t.hasUVNode=!0},e.U_AXIS="x",e.V_AXIS="y"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._particleVelocityNode=i,n._velocity=n._particleVelocityNode._iVelocity,n}return i(e,t),Object.defineProperty(e.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this._velocity=t},enumerable:!0,configurable:!0}),e.prototype.getVelocities=function(){return this._pDynamicProperties},e.prototype.setVelocities=function(t){this._pDynamicProperties=t,this._pDynamicPropertiesDirty=new Object},e.prototype.setRenderState=function(t,i,n,r){this._particleVelocityNode.mode!=Xn.LOCAL_DYNAMIC||this._pDynamicPropertiesDirty[n._iUniqueId]||this._pUpdateDynamicProperties(n);var o=r.getRegisterIndex(this._pAnimationNode,e.VELOCITY_INDEX);this._particleVelocityNode.mode==Xn.GLOBAL?t.setVertexConst(o,this._velocity.x,this._velocity.y,this._velocity.z):n.activateVertexBuffer(o,this._particleVelocityNode._iDataOffset,t.stage,Ht.FLOAT_3)},e.VELOCITY_INDEX=0,e}(Dr)),Zr=(function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,"ParticleVelocity",e,3)||this;return n._pStateClass=Jr,n._iVelocity=i||new P,n}i(e,t),e.prototype.getAGALVertexCode=function(t,e,i,n){var r=this._pMode==Xn.GLOBAL?i.getFreeVertexConstant():i.getFreeVertexAttribute();n.setRegisterIndex(this,Jr.VELOCITY_INDEX,r.index);var o=i.getFreeVertexVectorTemp(),s="";return s+="mul "+o+","+n.vertexTime+","+r+"\n",s+="add "+n.positionTarget+".xyz,"+o+","+n.positionTarget+".xyz\n",e.needVelocity&&(s+="add "+n.velocityTarget+".xyz,"+r+".xyz,"+n.velocityTarget+".xyz\n"),s},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._iGeneratePropertyOfOneParticle=function(t){var i=t[e.VELOCITY_VECTOR3D];if(!i)throw new Error("there is no "+e.VELOCITY_VECTOR3D+" in param!");this._pOneData[0]=i.x,this._pOneData[1]=i.y,this._pOneData[2]=i.z},e.VELOCITY_VECTOR3D="VelocityVector3D"}(Pr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._blendWeight=0,n._skeletonPose=new qn,n._skeletonPoseDirty=!0,n._skeletonAnimationNode=i,n._inputA=e.getAnimationState(n._skeletonAnimationNode.inputA),n._inputB=e.getAnimationState(n._skeletonAnimationNode.inputB),n}return i(e,t),Object.defineProperty(e.prototype,"blendWeight",{get:function(){return this._blendWeight},set:function(t){this._blendWeight=t,this._pPositionDeltaDirty=!0,this._skeletonPoseDirty=!0},enumerable:!0,configurable:!0}),e.prototype.phase=function(t){this._skeletonPoseDirty=!0,this._pPositionDeltaDirty=!0,this._inputA.phase(t),this._inputB.phase(t)},e.prototype._pUpdateTime=function(e){this._skeletonPoseDirty=!0,this._inputA.update(e),this._inputB.update(e),t.prototype._pUpdateTime.call(this,e)},e.prototype.getSkeletonPose=function(t){return this._skeletonPoseDirty&&this.updateSkeletonPose(t),this._skeletonPose},e.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=!1;var t=this._inputA.positionDelta,e=this._inputB.positionDelta;this._pRootDelta.x=t.x+this._blendWeight*(e.x-t.x),this._pRootDelta.y=t.y+this._blendWeight*(e.y-t.y),this._pRootDelta.z=t.z+this._blendWeight*(e.z-t.z)},e.prototype.updateSkeletonPose=function(t){var e;this._skeletonPoseDirty=!1;var i,n,r,o,s,a=this._skeletonPose.jointPoses,l=this._inputA.getSkeletonPose(t).jointPoses,u=this._inputB.getSkeletonPose(t).jointPoses,c=t.numJoints;a.length!=c&&(a.length=c);for(var h=0;h<c;++h)null==(e=a[h])&&(e=a[h]=new Qn),i=l[h],n=u[h],r=i.translation,o=n.translation,e.orientation.lerp(i.orientation,n.orientation,this._blendWeight),(s=e.translation).x=r.x+this._blendWeight*(o.x-r.x),s.y=r.y+this._blendWeight*(o.y-r.y),s.z=r.z+this._blendWeight*(o.z-r.z)},e}(Sr)),$r=function(t){function e(){var e=t.call(this)||this;return e._pStateClass=Zr,e}return i(e,t),e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e}(lr),to=function(t){function e(e,i,n,r){var o=t.call(this,e)||this;return o._animator=i,o._animationState=n,o._animationNode=r,o}return i(e,t),Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationState",{get:function(){return this._animationState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationNode",{get:function(){return this._animationNode},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._animator,this._animationState,this._animationNode)},e.PLAYBACK_COMPLETE="playbackComplete",e.TRANSITION_COMPLETE="transitionComplete",e}(a),eo=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._pFramesDirty=!0,n._animationClipNode=i,n}return i(e,t),Object.defineProperty(e.prototype,"blendWeight",{get:function(){return this._pFramesDirty&&this._pUpdateFrames(),this._pBlendWeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this._pFramesDirty&&this._pUpdateFrames(),this._pCurrentFrame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextFrame",{get:function(){return this._pFramesDirty&&this._pUpdateFrames(),this._pNextFrame},enumerable:!0,configurable:!0}),e.prototype.update=function(t){this._animationClipNode.looping||(t>this._pStartTime+this._animationClipNode.totalDuration?t=this._pStartTime+this._animationClipNode.totalDuration:t<this._pStartTime&&(t=this._pStartTime)),this._pTime!=t-this._pStartTime&&this._pUpdateTime(t)},e.prototype.phase=function(t){var e=t*this._animationClipNode.totalDuration+this._pStartTime;this._pTime!=e-this._pStartTime&&this._pUpdateTime(e)},e.prototype._pUpdateTime=function(e){this._pFramesDirty=!0,this._pTimeDir=e-this._pStartTime>this._pTime?1:-1,t.prototype._pUpdateTime.call(this,e)},e.prototype._pUpdateFrames=function(){this._pFramesDirty=!1;var t=this._animationClipNode.looping,e=this._animationClipNode.totalDuration,i=this._animationClipNode.lastFrame,n=this._pTime;if(t&&(n>=e||n<0)&&(n%=e)<0&&(n+=e),!t&&n>=e)this.notifyPlaybackComplete(),this._pCurrentFrame=i,this._pNextFrame=i,this._pBlendWeight=0;else if(!t&&n<=0)this._pCurrentFrame=0,this._pNextFrame=0,this._pBlendWeight=0;else if(this._animationClipNode.fixedFrameRate){var r=n/e*i;this._pCurrentFrame=Math.floor(r),this._pBlendWeight=r-this._pCurrentFrame,this._pNextFrame=this._pCurrentFrame+1}else{this._pCurrentFrame=0,this._pNextFrame=0;var o=0,s=void 0,a=this._animationClipNode.durations;do{s=o,o+=a[this._pNextFrame],this._pCurrentFrame=this._pNextFrame++}while(n>o);this._pCurrentFrame==i&&(this._pCurrentFrame=0,this._pNextFrame=1),this._pBlendWeight=(n-s)/a[this._pCurrentFrame]}},e.prototype.notifyPlaybackComplete=function(){null==this._animationStatePlaybackComplete&&(this._animationStatePlaybackComplete=new to(to.PLAYBACK_COMPLETE,this._pAnimator,this,this._animationClipNode)),this._animationClipNode.dispatchEvent(this._animationStatePlaybackComplete)},e}(Sr),io=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._rootPos=new P,n._skeletonPose=new qn,n._skeletonPoseDirty=!0,n._skeletonClipNode=i,n._frames=n._skeletonClipNode.frames,n}return i(e,t),Object.defineProperty(e.prototype,"currentPose",{get:function(){return this._pFramesDirty&&this._pUpdateFrames(),this._currentPose},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextPose",{get:function(){return this._pFramesDirty&&this._pUpdateFrames(),this._nextPose},enumerable:!0,configurable:!0}),e.prototype.getSkeletonPose=function(t){return this._skeletonPoseDirty&&this.updateSkeletonPose(t),this._skeletonPose},e.prototype._pUpdateTime=function(e){this._skeletonPoseDirty=!0,t.prototype._pUpdateTime.call(this,e)},e.prototype._pUpdateFrames=function(){t.prototype._pUpdateFrames.call(this),this._currentPose=this._frames[this._pCurrentFrame],this._skeletonClipNode.looping&&this._pNextFrame>=this._skeletonClipNode.lastFrame?(this._nextPose=this._frames[0],this._pAnimator.dispatchCycleEvent()):this._nextPose=this._frames[this._pNextFrame]},e.prototype.updateSkeletonPose=function(t){if(this._skeletonPoseDirty=!1,this._skeletonClipNode.totalDuration){this._pFramesDirty&&this._pUpdateFrames();var e,i,n,r,o,s,a=this._currentPose.jointPoses,l=this._nextPose.jointPoses,u=t.numJoints,c=this._skeletonPose.jointPoses;if(c.length!=u&&(c.length=u),u!=a.length||u!=l.length)throw new Error("joint counts don't match!");for(var h=0;h<u;++h)null==(o=c[h])&&(o=c[h]=new Qn),n=a[h],r=l[h],e=n.translation,i=r.translation,this._skeletonClipNode.highQuality?o.orientation.slerp(n.orientation,r.orientation,this._pBlendWeight):o.orientation.lerp(n.orientation,r.orientation,this._pBlendWeight),h>0&&((s=o.translation).x=e.x+this._pBlendWeight*(i.x-e.x),s.y=e.y+this._pBlendWeight*(i.y-e.y),s.z=e.z+this._pBlendWeight*(i.z-e.z))}},e.prototype._pUpdatePositionDelta=function(){var t,e,i;this._pPositionDeltaDirty=!1,this._pFramesDirty&&this._pUpdateFrames();var n=this._skeletonClipNode.totalDelta;(this._pTimeDir>0&&this._pNextFrame<this._pOldFrame||this._pTimeDir<0&&this._pNextFrame>this._pOldFrame)&&(this._rootPos.x-=n.x*this._pTimeDir,this._rootPos.y-=n.y*this._pTimeDir,this._rootPos.z-=n.z*this._pTimeDir);var r=this._rootPos.x,o=this._rootPos.y,s=this._rootPos.z;this._skeletonClipNode.stitchFinalFrame&&this._pNextFrame==this._skeletonClipNode.lastFrame?(t=this._frames[0].jointPoses[0].translation,e=this._frames[1].jointPoses[0].translation,i=this._currentPose.jointPoses[0].translation,this._rootPos.x=i.x+t.x+this._pBlendWeight*(e.x-t.x),this._rootPos.y=i.y+t.y+this._pBlendWeight*(e.y-t.y),this._rootPos.z=i.z+t.z+this._pBlendWeight*(e.z-t.z)):(t=this._currentPose.jointPoses[0].translation,e=this._frames[this._pNextFrame].jointPoses[0].translation,this._rootPos.x=t.x+this._pBlendWeight*(e.x-t.x),this._rootPos.y=t.y+this._pBlendWeight*(e.y-t.y),this._rootPos.z=t.z+this._pBlendWeight*(e.z-t.z)),this._pRootDelta.x=this._rootPos.x-r,this._pRootDelta.y=this._rootPos.y-o,this._pRootDelta.z=this._rootPos.z-s,this._pOldFrame=this._pNextFrame},e}(eo),no=(function(t){function e(){var e=t.call(this)||this;return e._frames=new Array,e.highQuality=!1,e._pStateClass=io,e}i(e,t),Object.defineProperty(e.prototype,"frames",{get:function(){return this._frames},enumerable:!0,configurable:!0}),e.prototype.addFrame=function(t,e){this._frames.push(t),this._pDurations.push(e),this._pNumFrames=this._pDurations.length,this._pStitchDirty=!0},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)},e.prototype._pUpdateStitch=function(){t.prototype._pUpdateStitch.call(this);for(var e,i,n=this._pNumFrames-1;n--;)this._pTotalDuration+=this._pDurations[n],e=this._frames[n].jointPoses[0].translation,i=this._frames[n+1].jointPoses[0].translation.subtract(e),this._pTotalDelta.x+=i.x,this._pTotalDelta.y+=i.y,this._pTotalDelta.z+=i.z;!this._pStitchFinalFrame&&this._pLooping||(this._pTotalDuration+=this._pDurations[this._pNumFrames-1],e=this._frames[0].jointPoses[0].translation,i=this._frames[1].jointPoses[0].translation.subtract(e),this._pTotalDelta.x+=i.x,this._pTotalDelta.y+=i.y,this._pTotalDelta.z+=i.z)}}(Er),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._blendWeight=0,n._skeletonPose=new qn,n._skeletonPoseDirty=!0,n._skeletonAnimationNode=i,n._baseInput=e.getAnimationState(n._skeletonAnimationNode.baseInput),n._differenceInput=e.getAnimationState(n._skeletonAnimationNode.differenceInput),n}return i(e,t),Object.defineProperty(e.prototype,"blendWeight",{get:function(){return this._blendWeight},set:function(t){this._blendWeight=t,this._pPositionDeltaDirty=!0,this._skeletonPoseDirty=!0},enumerable:!0,configurable:!0}),e.prototype.phase=function(t){this._skeletonPoseDirty=!0,this._pPositionDeltaDirty=!0,this._baseInput.phase(t),this._baseInput.phase(t)},e.prototype._pUpdateTime=function(e){this._skeletonPoseDirty=!0,this._baseInput.update(e),this._differenceInput.update(e),t.prototype._pUpdateTime.call(this,e)},e.prototype.getSkeletonPose=function(t){return this._skeletonPoseDirty&&this.updateSkeletonPose(t),this._skeletonPose},e.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=!1;var t=this._baseInput.positionDelta,e=this._differenceInput.positionDelta;this.positionDelta.x=t.x+this._blendWeight*e.x,this.positionDelta.y=t.y+this._blendWeight*e.y,this.positionDelta.z=t.z+this._blendWeight*e.z},e.prototype.updateSkeletonPose=function(t){var i;this._skeletonPoseDirty=!1;var n,r,o,s,a,l=this._skeletonPose.jointPoses,u=this._baseInput.getSkeletonPose(t).jointPoses,c=this._differenceInput.getSkeletonPose(t).jointPoses,h=t.numJoints;l.length!=h&&(l.length=h);for(var p=0;p<h;++p)null==(i=l[p])&&(i=l[p]=new Qn),n=u[p],r=c[p],o=n.translation,s=r.translation,e._tempQuat.multiply(r.orientation,n.orientation),i.orientation.lerp(n.orientation,e._tempQuat,this._blendWeight),(a=i.translation).x=o.x+this._blendWeight*s.x,a.y=o.y+this._blendWeight*s.y,a.z=o.z+this._blendWeight*s.z},e._tempQuat=new q,e}(Sr)),ro=(function(t){function e(){var e=t.call(this)||this;return e._pStateClass=no,e}i(e,t),e.prototype.getAnimationState=function(t){return t.getAnimationState(this)}}(lr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._skeletonPose=new qn,n._skeletonPoseDirty=!0,n._blendWeight=0,n._direction=0,n._blendDirty=!0,n._skeletonAnimationNode=i,n._forward=e.getAnimationState(n._skeletonAnimationNode.forward),n._backward=e.getAnimationState(n._skeletonAnimationNode.backward),n._left=e.getAnimationState(n._skeletonAnimationNode.left),n._right=e.getAnimationState(n._skeletonAnimationNode.right),n}return i(e,t),Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction!=t&&(this._direction=t,this._blendDirty=!0,this._skeletonPoseDirty=!0,this._pPositionDeltaDirty=!0)},enumerable:!0,configurable:!0}),e.prototype.phase=function(t){this._blendDirty&&this.updateBlend(),this._skeletonPoseDirty=!0,this._pPositionDeltaDirty=!0,this._inputA.phase(t),this._inputB.phase(t)},e.prototype._pUdateTime=function(e){this._blendDirty&&this.updateBlend(),this._skeletonPoseDirty=!0,this._inputA.update(e),this._inputB.update(e),t.prototype._pUpdateTime.call(this,e)},e.prototype.getSkeletonPose=function(t){return this._skeletonPoseDirty&&this.updateSkeletonPose(t),this._skeletonPose},e.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=!1,this._blendDirty&&this.updateBlend();var t=this._inputA.positionDelta,e=this._inputB.positionDelta;this.positionDelta.x=t.x+this._blendWeight*(e.x-t.x),this.positionDelta.y=t.y+this._blendWeight*(e.y-t.y),this.positionDelta.z=t.z+this._blendWeight*(e.z-t.z)},e.prototype.updateSkeletonPose=function(t){var e;this._skeletonPoseDirty=!1,this._blendDirty&&this.updateBlend();var i,n,r,o,s,a=this._skeletonPose.jointPoses,l=this._inputA.getSkeletonPose(t).jointPoses,u=this._inputB.getSkeletonPose(t).jointPoses,c=t.numJoints;a.length!=c&&(a.length=c);for(var h=0;h<c;++h)null==(e=a[h])&&(e=a[h]=new Qn),i=l[h],n=u[h],r=i.translation,o=n.translation,e.orientation.lerp(i.orientation,n.orientation,this._blendWeight),(s=e.translation).x=r.x+this._blendWeight*(o.x-r.x),s.y=r.y+this._blendWeight*(o.y-r.y),s.z=r.z+this._blendWeight*(o.z-r.z)},e.prototype.updateBlend=function(){this._blendDirty=!1,(this._direction<0||this._direction>360)&&(this._direction%=360,this._direction<0&&(this._direction+=360)),this._direction<90?(this._inputA=this._forward,this._inputB=this._right,this._blendWeight=this._direction/90):this._direction<180?(this._inputA=this._right,this._inputB=this._backward,this._blendWeight=(this._direction-90)/90):this._direction<270?(this._inputA=this._backward,this._inputB=this._left,this._blendWeight=(this._direction-180)/90):(this._inputA=this._left,this._inputB=this._forward,this._blendWeight=(this._direction-270)/90)},e}(Sr)),oo=(function(t){function e(){var e=t.call(this)||this;return e._pStateClass=ro,e}i(e,t),e.prototype.getAnimationState=function(t){return t.getAnimationState(this)}}(lr),function(t){function e(e,i){var n=t.call(this,e,i)||this;n._skeletonPose=new qn,n._skeletonPoseDirty=!0,n._blendWeights=new Array,n._inputs=new Array,n._skeletonAnimationNode=i;for(var r=n._skeletonAnimationNode.numInputs;r--;)n._inputs[r]=e.getAnimationState(n._skeletonAnimationNode._iInputs[r]);return n}return i(e,t),e.prototype.phase=function(t){this._skeletonPoseDirty=!0,this._pPositionDeltaDirty=!0;for(var e=0;e<this._skeletonAnimationNode.numInputs;++e)this._blendWeights[e]&&this._inputs[e].update(t)},e.prototype._pUdateTime=function(e){for(var i=0;i<this._skeletonAnimationNode.numInputs;++i)this._blendWeights[i]&&this._inputs[i].update(e);t.prototype._pUpdateTime.call(this,e)},e.prototype.getSkeletonPose=function(t){return this._skeletonPoseDirty&&this.updateSkeletonPose(t),this._skeletonPose},e.prototype.getBlendWeightAt=function(t){return this._blendWeights[t]},e.prototype.setBlendWeightAt=function(t,e){this._blendWeights[t]=e,this._pPositionDeltaDirty=!0,this._skeletonPoseDirty=!0},e.prototype._pUpdatePositionDelta=function(){var t,e;this._pPositionDeltaDirty=!1,this.positionDelta.x=0,this.positionDelta.y=0,this.positionDelta.z=0;for(var i=0;i<this._skeletonAnimationNode.numInputs;++i)(e=this._blendWeights[i])&&(t=this._inputs[i].positionDelta,this.positionDelta.x+=e*t.x,this.positionDelta.y+=e*t.y,this.positionDelta.z+=e*t.z)},e.prototype.updateSkeletonPose=function(t){var e;this._skeletonPoseDirty=!1;var i,n,r,o,s,a,l,u,c,h,p,d,f,_,m,g,y,A=this._skeletonPose.jointPoses,v=t.numJoints;A.length!=v&&(A.length=v);for(var b=0;b<this._skeletonAnimationNode.numInputs;++b)if(e=this._blendWeights[b])if(i=this._inputs[b].getSkeletonPose(t).jointPoses,u)for(c=0;c<t.numJoints;++c)n=A[c],r=i[c],p=(l=u[c].orientation).x,d=l.y,f=l.z,h=l.w,l=r.orientation,s=r.translation,p*(m=l.x)+d*(g=l.y)+f*(y=l.z)+h*(_=l.w)<0&&(m=-m,g=-g,y=-y,_=-_),(a=n.orientation).x+=e*m,a.y+=e*g,a.z+=e*y,a.w+=e*_,(o=n.translation).x+=e*s.x,o.y+=e*s.y,o.z+=e*s.z;else for(u=i,c=0;c<v;++c)null==(n=A[c])&&(n=A[c]=new Qn),l=(r=i[c]).orientation,s=r.translation,(a=n.orientation).x=e*l.x,a.y=e*l.y,a.z=e*l.z,a.w=e*l.w,(o=n.translation).x=e*s.x,o.y=e*s.y,o.z=e*s.z;for(c=0;c<t.numJoints;++c)A[c].orientation.normalize()},e}(Sr)),so=(function(t){function e(){var e=t.call(this)||this;return e._iInputs=new Array,e._pStateClass=oo,e}i(e,t),Object.defineProperty(e.prototype,"numInputs",{get:function(){return this._numInputs},enumerable:!0,configurable:!0}),e.prototype.getInputIndex=function(t){return this._iInputs.indexOf(t)},e.prototype.getInputAt=function(t){return this._iInputs[t]},e.prototype.addInput=function(t){this._iInputs[this._numInputs++]=t},e.prototype.getAnimationState=function(t){return t.getAnimationState(this)}}(lr),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._vertexClipNode=i,n._frames=n._vertexClipNode.frames,n}return i(e,t),Object.defineProperty(e.prototype,"currentElements",{get:function(){return this._pFramesDirty&&this._pUpdateFrames(),this._currentGraphics},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextElements",{get:function(){return this._pFramesDirty&&this._pUpdateFrames(),this._nextGraphics},enumerable:!0,configurable:!0}),e.prototype._pUpdateFrames=function(){t.prototype._pUpdateFrames.call(this),this._currentGraphics=this._frames[this._pCurrentFrame],this._vertexClipNode.looping&&this._pNextFrame>=this._vertexClipNode.lastFrame?(this._nextGraphics=this._frames[0],this._pAnimator.dispatchCycleEvent()):this._nextGraphics=this._frames[this._pNextFrame]},e.prototype._pUpdatePositionDelta=function(){},e}(eo)),ao=(function(t){function e(){var e=t.call(this)||this;return e._frames=new Array,e._translations=new Array,e._pStateClass=so,e}i(e,t),Object.defineProperty(e.prototype,"frames",{get:function(){return this._frames},enumerable:!0,configurable:!0}),e.prototype.addFrame=function(t,e,i){void 0===i&&(i=null),this._frames.push(t),this._pDurations.push(e),this._translations.push(i||new P),this._pNumFrames=this._pDurations.length,this._pStitchDirty=!0},e.prototype._pUpdateStitch=function(){t.prototype._pUpdateStitch.call(this);for(var e,i,n=this._pNumFrames-1;n--;)this._pTotalDuration+=this._pDurations[n],e=this._translations[n],i=this._translations[n+1].subtract(e),this._pTotalDelta.x+=i.x,this._pTotalDelta.y+=i.y,this._pTotalDelta.z+=i.z;this._pNumFrames>1&&(this._pStitchFinalFrame||!this._pLooping)&&(this._pTotalDuration+=this._pDurations[this._pNumFrames-1],e=this._translations[0],i=this._translations[1].subtract(e),this._pTotalDelta.x+=i.x,this._pTotalDelta.y+=i.y,this._pTotalDelta.z+=i.z)}}(Er),function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._crossfadeTransitionNode=i,n}return i(e,t),e.prototype._pUpdateTime=function(e){this.blendWeight=Math.abs(e-this._crossfadeTransitionNode.startBlend)/(1e3*this._crossfadeTransitionNode.blendSpeed),this.blendWeight>=1&&(this.blendWeight=1,null==this._animationStateTransitionComplete&&(this._animationStateTransitionComplete=new to(to.TRANSITION_COMPLETE,this._pAnimator,this,this._crossfadeTransitionNode)),this._crossfadeTransitionNode.dispatchEvent(this._animationStateTransitionComplete)),t.prototype._pUpdateTime.call(this,e)},e}(Zr)),lo=(function(t){function e(){var e=t.call(this)||this;return e._pStateClass=ao,e}i(e,t)}($r),function(t){function e(e,i){var n=t.call(this,e)||this;return n._animator=i,n}return i(e,t),Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._animator)},e.START="animatorStart",e.STOP="animatorStop",e.CYCLE_COMPLETE="animatorCycleComplete",e}(a)),uo=function(t){function e(e){var i=t.call(this)||this;return i._autoUpdate=!0,i._time=0,i._playbackSpeed=1,i._pOwners=new Array,i._pAbsoluteTime=0,i._animationStates=new Object,i.updatePosition=!0,i._pAnimationSet=e,i._broadcaster=new Ct(i.onEnterFrame,i),i}return i(e,t),e.prototype.getAnimationState=function(t){var e=t.stateClass,i=t.id;return null==this._animationStates[i]&&(this._animationStates[i]=new e(this,t)),this._animationStates[i]},e.prototype.getAnimationStateByName=function(t){return this.getAnimationState(this._pAnimationSet.getAnimation(t))},Object.defineProperty(e.prototype,"absoluteTime",{get:function(){return this._pAbsoluteTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationSet",{get:function(){return this._pAnimationSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeState",{get:function(){return this._pActiveState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeAnimation",{get:function(){return this._pAnimationSet.getAnimation(this._pActiveAnimationName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeAnimationName",{get:function(){return this._pActiveAnimationName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){this._autoUpdate!=t&&(this._autoUpdate=t,this._autoUpdate?this.start():this.stop())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return this._time},set:function(t){this._time!=t&&this.update(t)},enumerable:!0,configurable:!0}),e.prototype.phase=function(t){this._pActiveState.phase(t)},Object.defineProperty(e.prototype,"playbackSpeed",{get:function(){return this._playbackSpeed},set:function(t){this._playbackSpeed=t},enumerable:!0,configurable:!0}),e.prototype.setRenderState=function(t,e){throw new s},e.prototype.start=function(){!this._isPlaying&&this._autoUpdate&&(this._time=this._pAbsoluteTime=ft(),this._isPlaying=!0,this._broadcaster.start(),this.hasEventListener(lo.START)&&(null==this._startEvent&&(this._startEvent=new lo(lo.START,this)),this.dispatchEvent(this._startEvent)))},e.prototype.stop=function(){this._isPlaying&&(this._isPlaying=!1,this._broadcaster.stop(),this.hasEventListener(lo.STOP)&&(null==this._stopEvent&&(this._stopEvent=new lo(lo.STOP,this)),this.dispatchEvent(this._stopEvent)))},e.prototype.update=function(t){var e=(t-this._time)*this.playbackSpeed;this._pUpdateDeltaTime(e),this._time=t},e.prototype.reset=function(t,e){void 0===e&&(e=0),this.getAnimationState(this._pAnimationSet.getAnimation(t)).offset(e+this._pAbsoluteTime)},e.prototype.addOwner=function(t){this._pOwners.push(t)},e.prototype.removeOwner=function(t){this._pOwners.splice(this._pOwners.indexOf(t),1)},e.prototype._pUpdateDeltaTime=function(t){this._pAbsoluteTime+=t,this._pActiveState.update(this._pAbsoluteTime),this.updatePosition&&this.applyPositionDelta()},e.prototype.onEnterFrame=function(t){this.update(ft())},e.prototype.applyPositionDelta=function(){var t,e=this._pActiveState.positionDelta,i=e.length;if(i>0){t=this._pOwners.length;for(var n=0;n<t;++n)this._pOwners[n].transform.translateLocal(e,i)}},e.prototype.dispatchCycleEvent=function(){this.hasEventListener(lo.CYCLE_COMPLETE)&&(null==this._cycleEvent&&(this._cycleEvent=new lo(lo.CYCLE_COMPLETE,this)),this.dispatchEvent(this._cycleEvent))},e.prototype.clone=function(){throw new s},e.prototype.dispose=function(){},e.prototype.invalidateElements=function(){for(var t=this._pOwners.length,e=0;e<t;e++)this._pOwners[e].invalidateElements()},e.prototype.testGPUCompatibility=function(t){throw new s},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.getRenderableElements=function(t,e){return e},e.assetType="[asset Animator]",e}(p);(function(t){function e(e){var i,n,r=t.call(this,e)||this;r._animationParticleStates=new Array,r._animatorParticleStates=new Array,r._timeParticleStates=new Array,r._totalLenOfOneVertex=0,r._animatorSubGeometries=new Object,r._particleAnimationSet=e;for(var o=0;o<r._particleAnimationSet.particleNodes.length;o++)n=r._particleAnimationSet.particleNodes[o],i=r.getAnimationState(n),n.mode==Xn.LOCAL_DYNAMIC?(r._animatorParticleStates.push(i),n._iDataOffset=r._totalLenOfOneVertex,r._totalLenOfOneVertex+=n.dataLength):r._animationParticleStates.push(i),i.needUpdateTime&&r._timeParticleStates.push(i);return r}i(e,t),e.prototype.clone=function(){return new e(this._particleAnimationSet)},e.prototype.setRenderState=function(t,e){var i,n=this._particleAnimationSet._iAnimationRegisterData,r=e.shape.particleCollection,o=e.shape.elements,s=this._particleAnimationSet.getAnimationElements(r,o);for(i=0;i<this._animationParticleStates.length;i++)this._animationParticleStates[i].setRenderState(t,e,s,n);var a=this.getAnimatorElements(r,o);for(i=0;i<this._animatorParticleStates.length;i++)this._animatorParticleStates[i].setRenderState(t,e,a,n)},e.prototype.testGPUCompatibility=function(t){},e.prototype.start=function(){t.prototype.start.call(this);for(var e=0;e<this._timeParticleStates.length;e++)this._timeParticleStates[e].offset(this._pAbsoluteTime)},e.prototype._pUpdateDeltaTime=function(t){this._pAbsoluteTime+=t;for(var e=0;e<this._timeParticleStates.length;e++)this._timeParticleStates[e].update(this._pAbsoluteTime)},e.prototype.resetTime=function(t){void 0===t&&(t=0);for(var e=0;e<this._timeParticleStates.length;e++)this._timeParticleStates[e].offset(this._pAbsoluteTime+t);this.update(this.time)},e.prototype.dispose=function(){for(var t in this._animatorSubGeometries)this._animatorSubGeometries[t].dispose()},e.prototype.getAnimatorElements=function(t,e){if(this._animatorParticleStates.length){var i=this._animatorSubGeometries[e.id]=new Gn;i.createVertexData(e.numVertices,this._totalLenOfOneVertex),i.animationParticles=this._particleAnimationSet.getAnimationElements(t,e).animationParticles}}})(uo),function(t){function e(e){void 0===e&&(e=4);var i=t.call(this)||this;return i._jointsPerVertex=e,i}i(e,t),Object.defineProperty(e.prototype,"jointsPerVertex",{get:function(){return this._jointsPerVertex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matricesIndex",{get:function(){return this._matricesIndex},enumerable:!0,configurable:!0}),e.prototype.getAGALVertexCode=function(t,e,i){this._matricesIndex=e.numUsedVertexConstants;var n=this._matricesIndex,r=this._matricesIndex+1,o=this._matricesIndex+2,s=e.getFreeVertexAttribute();t.jointIndexIndex=s.index;var a=e.getFreeVertexAttribute();t.jointWeightIndex=a.index;for(var l=[s+".x",s+".y",s+".z",s+".w"],u=[a+".x",a+".y",a+".z",a+".w"],c=e.getFreeVertexVectorTemp(),h="dp4",p="",d=i.animatableAttributes.length,f=0;f<d;++f){for(var _=i.animatableAttributes[f],m=i.animationTargetRegisters[f],g=0;g<this._jointsPerVertex;++g)e.getFreeVertexConstant(),e.getFreeVertexConstant(),e.getFreeVertexConstant(),p+=h+" "+c+".x, "+_+", vc["+l[g]+"+"+n+"]\n"+h+" "+c+".y, "+_+", vc["+l[g]+"+"+r+"]\n"+h+" "+c+".z, "+_+", vc["+l[g]+"+"+o+"]\nmov "+c+".w, "+_+".w\nmul "+c+", "+c+", "+u[g]+"\n",p+=0==g?"mov "+m+", "+c+"\n":"add "+m+", "+m+", "+c+"\n";h="dp3"}return p},e.prototype.getAGALFragmentCode=function(t,e,i){return""},e.prototype.getAGALUVCode=function(t,e,i){return"mov "+i.animatedUV+","+i.uvInput+"\n"},e.prototype.doneAGALCode=function(t){}}(Fr),function(t){function e(e,i,n){void 0===n&&(n=!1);var r=t.call(this,e)||this;r._globalPose=new qn,r._morphedElements=new Object,r._morphedElementsDirty=new Object,r._skeletonAnimationSet=e,r._skeleton=i,r._forceCPU=n,r._jointsPerVertex=e.jointsPerVertex,r._numJoints=r._skeleton.numJoints,r._globalMatrices=new Float32Array(12*r._numJoints);for(var o=0,s=0;s<r._numJoints;++s)r._globalMatrices[o++]=1,r._globalMatrices[o++]=0,r._globalMatrices[o++]=0,r._globalMatrices[o++]=0,r._globalMatrices[o++]=0,r._globalMatrices[o++]=1,r._globalMatrices[o++]=0,r._globalMatrices[o++]=0,r._globalMatrices[o++]=0,r._globalMatrices[o++]=0,r._globalMatrices[o++]=1,r._globalMatrices[o++]=0;return r._onTransitionCompleteDelegate=function(t){return r.onTransitionComplete(t)},r._onIndicesUpdateDelegate=function(t){return r.onIndicesUpdate(t)},r._onVerticesUpdateDelegate=function(t){return r.onVerticesUpdate(t)},r}i(e,t),Object.defineProperty(e.prototype,"globalMatrices",{get:function(){return this._globalPropertiesDirty&&this.updateGlobalProperties(),this._globalMatrices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalPose",{get:function(){return this._globalPropertiesDirty&&this.updateGlobalProperties(),this._globalPose},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skeleton",{get:function(){return this._skeleton},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forceCPU",{get:function(){return this._forceCPU},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useCondensedIndices",{get:function(){return this._useCondensedIndices},set:function(t){this._useCondensedIndices=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._skeletonAnimationSet,this._skeleton,this._forceCPU)},e.prototype.play=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=NaN),this._pActiveAnimationName!=t){if(this._pActiveAnimationName=t,!this._pAnimationSet.hasAnimation(t))throw new Error("Animation root node "+t+" not found!");e&&this._pActiveNode?(this._pActiveNode=e.getAnimationNode(this,this._pActiveNode,this._pAnimationSet.getAnimation(t),this._pAbsoluteTime),this._pActiveNode.addEventListener(to.TRANSITION_COMPLETE,this._onTransitionCompleteDelegate)):this._pActiveNode=this._pAnimationSet.getAnimation(t),this._pActiveState=this.getAnimationState(this._pActiveNode),this.updatePosition&&(this._pActiveState.update(this._pAbsoluteTime),this._pActiveState.positionDelta),this._activeSkeletonState=this._pActiveState,this.start(),isNaN(i)||this.reset(t,i)}},e.prototype.setRenderState=function(t,e){this._globalPropertiesDirty&&this.updateGlobalProperties();var i=e.shape.elements;if(i.useCondensedIndices=this._useCondensedIndices,this._useCondensedIndices)this.updateCondensedMatrices(i.condensedIndexLookUp),t.setVertexConstFromArray(this._skeletonAnimationSet.matricesIndex,this._condensedMatrices);else{if(this._pAnimationSet.usesCPU)return void(this._morphedElementsDirty[i.id]&&this.morphElements(e,i));t.setVertexConstFromArray(this._skeletonAnimationSet.matricesIndex,this._globalMatrices)}},e.prototype.testGPUCompatibility=function(t){!this._useCondensedIndices&&(this._forceCPU||this._jointsPerVertex>4||t.numUsedVertexConstants+3*this._numJoints>128)&&this._pAnimationSet.cancelGPUCompatibility()},e.prototype._pUpdateDeltaTime=function(e){t.prototype._pUpdateDeltaTime.call(this,e),this._globalPropertiesDirty=!0,this._pAnimationSet.usesCPU&&this.invalidateElements()},e.prototype.updateCondensedMatrices=function(t){var e,i=0,n=0,r=t.length;this._condensedMatrices=new Float32Array(12*r);for(var o=0;o<r;o++)for(e=12*t[o],n=12;n--;)this._condensedMatrices[i++]=this._globalMatrices[e++]},e.prototype.updateGlobalProperties=function(){this._globalPropertiesDirty=!1,this.localToGlobalPose(this._activeSkeletonState.getSkeletonPose(this._skeleton),this._globalPose,this._skeleton);for(var t,e,i,n,r,o,s,a,l,u,c,h,p,d,f,_,m,g,y,A,v,b,x,C,w,I,E,S,D,T,P,B,M,O,L,R,N=0,F=this._globalPose.jointPoses,k=this._skeleton.joints,V=0;V<this._numJoints;++V)O=(M=F[V]).orientation,L=M.translation,o=(R=2*(e=O.x))*(i=O.y),s=R*(n=O.z),a=R*(r=O.w),(R=2*i)*n,R*r,2*n*r,l=2*i*n,u=2*i*r,c=2*n*r,h=(R=(e*=e)-(i*=i))-(n*=n)+(r*=r),p=o-c,d=s+u,f=o+c,_=-R-n+r,m=l-a,g=s-u,y=l+a,A=-e-i+n+r,v=(t=k[V].inverseBindPose)[0],b=t[4],x=t[8],C=t[12],w=t[1],I=t[5],E=t[9],S=t[13],D=t[2],T=t[6],P=t[10],B=t[14],this._globalMatrices[N]=h*v+p*w+d*D,this._globalMatrices[N+1]=h*b+p*I+d*T,this._globalMatrices[N+2]=h*x+p*E+d*P,this._globalMatrices[N+3]=h*C+p*S+d*B+L.x,this._globalMatrices[N+4]=f*v+_*w+m*D,this._globalMatrices[N+5]=f*b+_*I+m*T,this._globalMatrices[N+6]=f*x+_*E+m*P,this._globalMatrices[N+7]=f*C+_*S+m*B+L.y,this._globalMatrices[N+8]=g*v+y*w+A*D,this._globalMatrices[N+9]=g*b+y*I+A*T,this._globalMatrices[N+10]=g*x+y*E+A*P,this._globalMatrices[N+11]=g*C+y*S+A*B+L.z,N+=12},e.prototype.getRenderableElements=function(t,e){return this._morphedElementsDirty[e.id]=!0,this._pAnimationSet.usesCPU?((i=this._morphedElements[e.id])||(e.normals,e.tangents,(i=this._morphedElements[e.id]=e.clone()).autoDeriveNormals=!1,i.autoDeriveTangents=!1,e.addEventListener(ur.INVALIDATE_INDICES,this._onIndicesUpdateDelegate),e.addEventListener(ur.INVALIDATE_VERTICES,this._onVerticesUpdateDelegate)),i):e;var i},e.prototype.morphElements=function(t,e){this._morphedElementsDirty[e.id]=!1;var i=e.numVertices,n=e.positions.get(i),r=e.normals.get(i),o=e.tangents.get(i),s=e.positions.dimensions,a=e.positions.stride,l=e.normals.stride,u=e.tangents.stride,c=e.jointIndices.get(i),h=e.jointWeights.get(i),p=e.jointIndices.stride,d=this._morphedElements[e.id],f=d.positions.get(i),_=d.normals.get(i),m=d.tangents.get(i);d.positions.attributesBuffer.invalidate(),d.normals.attributesBuffer.invalidate(),d.tangents.attributesBuffer.invalidate();for(var g,y,A,v,b,x,C,w,I,E,S,D,T,P,B,M,O,L,R,N,F,k,V,U,j,G,Q,z,H,X=0,q=0,Y=0,K=0,W=0;X<i;){for(D=n[q=X*a],T=n[q+1],P=3==s?n[q+2]:0,B=r[Y=X*l],M=r[Y+1],O=r[Y+2],L=o[K=X*u],R=o[K+1],N=o[K+2],y=0,A=0,v=0,b=0,x=0,C=0,w=0,I=0,E=0,g=0,W=X*p;g<this._jointsPerVertex;)if((S=h[W+g])>0){var J=c[W+g]<<2;y+=S*((F=this._globalMatrices[J])*D+(k=this._globalMatrices[J+1])*T+(V=this._globalMatrices[J+2])*P+this._globalMatrices[J+3]),A+=S*((U=this._globalMatrices[J+4])*D+(j=this._globalMatrices[J+5])*T+(G=this._globalMatrices[J+6])*P+this._globalMatrices[J+7]),v+=S*((Q=this._globalMatrices[J+8])*D+(z=this._globalMatrices[J+9])*T+(H=this._globalMatrices[J+10])*P+this._globalMatrices[J+11]),b+=S*(F*B+k*M+V*O),x+=S*(U*B+j*M+G*O),C+=S*(Q*B+z*M+H*O),w+=S*(F*L+k*R+V*N),I+=S*(U*L+j*R+G*N),E+=S*(Q*L+z*R+H*N),g++}else g=this._jointsPerVertex;f[q]=y,f[q+1]=A,3==s&&(f[q+2]=v),_[Y]=b,_[Y+1]=x,_[Y+2]=C,m[K]=w,m[K+1]=I,m[K+2]=E,X++}},e.prototype.localToGlobalPose=function(t,e,i){var n,r,o,s,a,l,u,c,h,p,d,f,_,m,g,y,A,v,b,x=e.jointPoses,C=i.joints,w=t.numJointPoses,I=t.jointPoses;x.length!=w&&(x.length=w);for(var E=0;E<w;++E)null==(n=x[E])&&(n=x[E]=new Qn),r=C[E].parentIndex,s=I[E],c=n.orientation,u=n.translation,r<0?(l=s.translation,a=s.orientation,c.x=a.x,c.y=a.y,c.z=a.z,c.w=a.w,u.x=l.x,u.y=l.y,u.z=l.z):(a=(o=x[r]).orientation,l=s.translation,_=a.x,m=a.y,g=a.z,y=a.w,f=-_*(A=l.x)-m*(v=l.y)-g*(b=l.z),h=y*A+m*b-g*v,p=y*v-_*b+g*A,d=y*b+_*v-m*A,l=o.translation,u.x=-f*_+h*y-p*g+d*m+l.x,u.y=-f*m+h*g+p*y-d*_+l.y,u.z=-f*g-h*m+p*_+d*y+l.z,h=a.x,p=a.y,d=a.z,f=a.w,_=(a=s.orientation).x,m=a.y,g=a.z,y=a.w,c.w=f*y-h*_-p*m-d*g,c.x=f*_+h*y+p*g-d*m,c.y=f*m-h*g+p*y+d*_,c.z=f*g+h*m-p*_+d*y)},e.prototype.onTransitionComplete=function(t){t.type==to.TRANSITION_COMPLETE&&(t.animationNode.removeEventListener(to.TRANSITION_COMPLETE,this._onTransitionCompleteDelegate),this._pActiveState==t.animationState&&(this._pActiveNode=this._pAnimationSet.getAnimation(this._pActiveAnimationName),this._pActiveState=this.getAnimationState(this._pActiveNode),this._activeSkeletonState=this._pActiveState))},e.prototype.onIndicesUpdate=function(t){var e=t.target;this._morphedElements[e.id].setIndices(e.indices)},e.prototype.onVerticesUpdate=function(t){var e=t.target;if(t.attributesView==e.uvs||t.attributesView==e.getCustomAtributes("secondaryUVs")){var i=this._morphedElements[e.id],n=i.uvs.get(e.numVertices);i.invalidateVertices(i.uvs);for(var r=i.uvs.stride,o=t.attributesView.get(e.numVertices),s=e.numVertices*r,a=0;a<s;a+=r)n[a]=o[a],n[a+1]=o[a+1]}}}(uo),function(t){function e(e,i){void 0===e&&(e=2),void 0===i&&(i="absolute");var n=t.call(this)||this;return n._numPoses=e,n._blendMode=i,n}i(e,t),Object.defineProperty(e.prototype,"numPoses",{get:function(){return this._numPoses},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},enumerable:!0,configurable:!0}),e.prototype.getAGALVertexCode=function(t,e,i){return this._iAnimationRegisterData=t.animationRegisterData,null==this._iAnimationRegisterData&&(this._iAnimationRegisterData=t.animationRegisterData=new ar),this._blendMode==Yn.ABSOLUTE?this.getAbsoluteAGALCode(t,e,i):this.getAdditiveAGALCode(t,e,i)},e.prototype.getAGALFragmentCode=function(t,e,i){return""},e.prototype.getAGALUVCode=function(t,e,i){return"mov "+i.animatedUV+","+i.uvInput+"\n"},e.prototype.doneAGALCode=function(t){},e.prototype.getAbsoluteAGALCode=function(t,e,i){var n="",r=e.getFreeVertexVectorTemp();e.addVertexTempUsages(r,1);var o,s=e.getFreeVertexVectorTemp(),a=new Array(".x",".y",".z",".w"),l=i.animatableAttributes.length,u=e.getFreeVertexConstant();this._iAnimationRegisterData.weightsIndex=u.index,this._iAnimationRegisterData.poseIndices=new Array(this._numPoses);var c=0;l>2&&(l=2);for(var h=0;h<l;++h){n+="mul "+r+", "+i.animatableAttributes[h]+", "+u+a[0]+"\n";for(var p=1;p<this._numPoses;++p)o=e.getFreeVertexAttribute(),this._iAnimationRegisterData.poseIndices[c++]=o.index,n+="mul "+s+", "+o+", "+u+a[p]+"\n",p<this._numPoses-1&&(n+="add "+r+", "+r+", "+s+"\n");n+="add "+i.animationTargetRegisters[h]+", "+r+", "+s+"\n"}return(t.tangentDependencies>0||t.outputsNormals)&&(n+="dp3 "+r+".x, "+i.animatableAttributes[2]+", "+i.animationTargetRegisters[1]+"\nmul "+r+", "+i.animationTargetRegisters[1]+", "+r+".x\nsub "+i.animationTargetRegisters[2]+", "+i.animationTargetRegisters[2]+", "+r+"\n"),n},e.prototype.getAdditiveAGALCode=function(t,e,i){var n,r="",o=i.animatableAttributes.length,s=[".x",".y",".z",".w"],a=e.getFreeVertexVectorTemp(),l=e.getFreeVertexConstant();this._iAnimationRegisterData.weightsIndex=l.index,this._iAnimationRegisterData.poseIndices=new Array(this._numPoses);var u=0;o>2&&(o=2),r+="mov  "+i.animationTargetRegisters[0]+", "+i.animatableAttributes[0]+"\n",t.normalDependencies>0&&(r+="mov "+i.animationTargetRegisters[1]+", "+i.animatableAttributes[1]+"\n");for(var c=0;c<o;++c)for(var h=0;h<this._numPoses;++h)n=e.getFreeVertexAttribute(),this._iAnimationRegisterData.poseIndices[u++]=n.index,r+="mul "+a+", "+n+", "+l+s[h]+"\nadd "+i.animationTargetRegisters[c]+", "+i.animationTargetRegisters[c]+", "+a+"\n";return(t.tangentDependencies>0||t.outputsNormals)&&(r+="dp3 "+a+".x, "+i.animatableAttributes[2]+", "+i.animationTargetRegisters[1]+"\nmul "+a+", "+i.animationTargetRegisters[1]+", "+a+".x\nsub "+i.animationTargetRegisters[2]+", "+i.animatableAttributes[2]+", "+a+"\n"),r}}(Fr),function(t){function e(e){var i=t.call(this,e)||this;return i._poses=new Array,i._weights=new Float32Array([1,0,0,0]),i._vertexAnimationSet=e,i}i(e,t),e.prototype.clone=function(){return new e(this._vertexAnimationSet)},e.prototype.play=function(t,e,i){if(void 0===i&&(i=NaN),this._pActiveAnimationName!=t){if(this._pActiveAnimationName=t,!this._pAnimationSet.hasAnimation(t))throw new Error("Animation root node "+t+" not found!");this._pActiveNode=this._pAnimationSet.getAnimation(t),this._pActiveState=this.getAnimationState(this._pActiveNode),this.updatePosition&&(this._pActiveState.update(this._pAbsoluteTime),this._pActiveState.positionDelta),this._activeVertexState=this._pActiveState,this.start(),isNaN(i)||this.reset(t,i)}},e.prototype._pUpdateDeltaTime=function(e){t.prototype._pUpdateDeltaTime.call(this,e);var i=!1;this._poses[0]!=this._activeVertexState.currentElements&&(this._poses[0]=this._activeVertexState.currentElements,i=!0),this._poses[1]!=this._activeVertexState.nextElements&&(this._poses[1]=this._activeVertexState.nextElements),this._weights[0]=1-(this._weights[1]=this._activeVertexState.blendWeight),i&&this.invalidateElements()},e.prototype.setRenderState=function(t,e){var i=e.shape,n=e.stageElements.elements;if(this._poses.length){var r,o,s=t.animationRegisterData,a=this._vertexAnimationSet.numPoses;t.setVertexConstFromArray(s.weightsIndex,this._weights),r=this._vertexAnimationSet.blendMode==Yn.ABSOLUTE?1:0;for(var l=0;r<a;++r)(o=(n=this._poses[r]||i.elements).getAbstraction(t.stage))._indexMappings=i.elements.getAbstraction(t.stage).getIndexMappings(),o.activateVertexBufferVO(s.poseIndices[l++],n.positions),t.normalDependencies>0&&o.activateVertexBufferVO(s.poseIndices[l++],n.normals)}else this.setNullPose(t,n)},e.prototype.setNullPose=function(t,e){var i=t.animationRegisterData;t.setVertexConstFromArray(i.weightsIndex,this._weights);var n=e.getAbstraction(t.stage),r=0;if(this._vertexAnimationSet.blendMode==Yn.ABSOLUTE)for(var o=this._vertexAnimationSet.numPoses,s=1;s<o;++s)n.activateVertexBufferVO(i.poseIndices[r++],e.positions),t.normalDependencies>0&&n.activateVertexBufferVO(i.poseIndices[r++],e.normals)},e.prototype.testGPUCompatibility=function(t){},e.prototype.getRenderableElements=function(t,e){return this._vertexAnimationSet.blendMode==Yn.ABSOLUTE&&this._poses.length&&this._poses[0]||e}}(uo);function co(t,e){if(void 0===e&&(e="assertion failed"),""===t&&(t=!0),!t)throw"undefined"!=typeof console&&"assert"in console?(console.assert(!1,e),new Error(e)):new Error(e)}function ho(t,e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),n>0||r>0&&r<e.length?(r<=0&&(r=e.length-n),t.set(e.subarray(n,n+r),i)):t.set(e,i)}var po,fo=function(){function t(t,e,i,n){this.xMin=0|t,this.yMin=0|e,this.xMax=0|i,this.yMax=0|n}return t.FromUntyped=function(e){return new t(e.xMin,e.yMin,e.xMax,e.yMax)},t.FromRectangle=function(e){return new t(20*e.x|0,20*e.y|0,20*(e.x+e.width)|0,20*(e.y+e.height)|0)},t.prototype.setElements=function(t,e,i,n){this.xMin=t,this.yMin=e,this.xMax=i,this.yMax=n},t.prototype.copyFrom=function(t){this.setElements(t.xMin,t.yMin,t.xMax,t.yMax)},t.prototype.contains=function(t,e){return t<this.xMin!=t<this.xMax&&e<this.yMin!=e<this.yMax},t.prototype.unionInPlace=function(t){t.isEmpty()||(this.extendByPoint(t.xMin,t.yMin),this.extendByPoint(t.xMax,t.yMax))},t.prototype.extendByPoint=function(t,e){this.extendByX(t),this.extendByY(e)},t.prototype.extendByX=function(t){134217728!==this.xMin?(this.xMin=Math.min(this.xMin,t),this.xMax=Math.max(this.xMax,t)):this.xMin=this.xMax=t},t.prototype.extendByY=function(t){134217728!==this.yMin?(this.yMin=Math.min(this.yMin,t),this.yMax=Math.max(this.yMax,t)):this.yMin=this.yMax=t},t.prototype.intersects=function(t){return this.contains(t.xMin,t.yMin)||this.contains(t.xMax,t.yMax)},t.prototype.isEmpty=function(){return this.xMax<=this.xMin||this.yMax<=this.yMin},Object.defineProperty(t.prototype,"width",{get:function(){return this.xMax-this.xMin},set:function(t){this.xMax=this.xMin+t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.yMax-this.yMin},set:function(t){this.yMax=this.yMin+t},enumerable:!0,configurable:!0}),t.prototype.getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return e*(this.xMax-this.xMin)+i*(this.yMax-this.yMin)},t.prototype.getBaseHeight=function(t){var e=Math.abs(Math.cos(t));return Math.abs(Math.sin(t))*(this.xMax-this.xMin)+e*(this.yMax-this.yMin)},t.prototype.setEmpty=function(){this.xMin=this.yMin=this.xMax=this.yMax=0},t.prototype.setToSentinels=function(){this.xMin=this.yMin=this.xMax=this.yMax=134217728},t.prototype.clone=function(){return new t(this.xMin,this.yMin,this.xMax,this.yMax)},t.prototype.toString=function(){return"{ xMin: "+this.xMin+", xMin: "+this.yMin+", xMax: "+this.xMax+", xMax: "+this.yMax+" }"},t}();function _o(t,e,i){return Math.max(e,Math.min(i,t))}function mo(t){return null==t}function go(t){for(var e=new Uint8Array(4*t.length),i=0,n=0,r=t.length;n<r;n++){var o=t.charCodeAt(n);if(o<=127)e[i++]=o;else{if(55296<=o&&o<=56319){var s=t.charCodeAt(n+1);56320<=s&&s<=57343&&(o=((1023&o)<<10)+(1023&s)+65536,++n)}0!=(4292870144&o)?(e[i++]=248|o>>>24&3,e[i++]=128|o>>>18&63,e[i++]=128|o>>>12&63,e[i++]=128|o>>>6&63,e[i++]=128|63&o):0!=(4294901760&o)?(e[i++]=240|o>>>18&7,e[i++]=128|o>>>12&63,e[i++]=128|o>>>6&63,e[i++]=128|63&o):0!=(4294965248&o)?(e[i++]=224|o>>>12&15,e[i++]=128|o>>>6&63,e[i++]=128|63&o):(e[i++]=192|o>>>6&31,e[i++]=128|63&o)}}return e.subarray(0,i)}function yo(t){for(var e=0,i="";e<t.length;){var n=255&t[e++];if(n<=127)i+=String.fromCharCode(n);else{var r=192,o=5;do{if((n&(r>>1|128))===r)break;r=r>>1|128,--o}while(o>=0);if(o<=0){i+=String.fromCharCode(n);continue}for(var s=n&(1<<o)-1,a=!1,l=5;l>=o;--l){var u=t[e++];if(128!=(192&u)){a=!0;break}s=s<<6|63&u}if(a){for(var c=e-(7-l);c<e;++c)i+=String.fromCharCode(255&t[c]);continue}i+=s>=65536?String.fromCharCode(s-65536>>10&1023|55296,1023&s|56320):String.fromCharCode(s)}}return i}!function(t){t[t.None=0]="None",t[t.PremultipliedAlphaARGB=1]="PremultipliedAlphaARGB",t[t.StraightAlphaARGB=2]="StraightAlphaARGB",t[t.StraightAlphaRGBA=3]="StraightAlphaRGBA",t[t.JPEG=4]="JPEG",t[t.PNG=5]="PNG",t[t.GIF=6]="GIF"}(po||(po={}));var Ao,vo=function(){function t(t){void 0===t&&(t=32),this._list=[],this._maxSize=t}return t.prototype.acquire=function(e){if(t._enabled)for(var i=this._list,n=0;n<i.length;n++){var r=i[n];if(r.byteLength>=e)return i.splice(n,1),r}return new ArrayBuffer(e)},t.prototype.release=function(e){if(t._enabled){var i=this._list;i.length===this._maxSize&&i.shift(),i.push(e)}},t.prototype.ensureUint8ArrayLength=function(t,e){if(t.length>=e)return t;var i=Math.max(t.length+e,1+(3*t.length>>1)),n=new Uint8Array(this.acquire(i),0,i);return n.set(t),this.release(t.buffer),n},t.prototype.ensureFloat64ArrayLength=function(t,e){if(t.length>=e)return t;var i=Math.max(t.length+e,1+(3*t.length>>1)),n=new Float64Array(this.acquire(i*Float64Array.BYTES_PER_ELEMENT),0,i);return n.set(t),this.release(t.buffer),n},t._enabled=!0,t}();function bo(t,e){if(t.length<e){var i=t;(t=new t.constructor(Ao.nearestPowerOfTwo(e))).set(i,0)}return t}!function(t){var e=new ArrayBuffer(8);function i(t){return 256*t<<16>>16}function n(t){return t/256}t.i8=new Int8Array(e),t.u8=new Uint8Array(e),t.i32=new Int32Array(e),t.f32=new Float32Array(e),t.f64=new Float64Array(e),t.nativeLittleEndian=1===new Int8Array(new Int32Array([1]).buffer)[0],t.floatToInt32=function(e){return t.f32[0]=e,t.i32[0]},t.int32ToFloat=function(e){return t.i32[0]=e,t.f32[0]},t.swap16=function(t){return(255&t)<<8|t>>8&255},t.swap32=function(t){return(255&t)<<24|(65280&t)<<8|t>>8&65280|t>>24&255},t.toS8U8=i,t.fromS8U8=n,t.clampS8U8=function(t){return n(i(t))},t.toS16=function(t){return t<<16>>16},t.bitCount=function(t){return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>24},t.ones=function(t){return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>24},t.trailingZeros=function(e){return t.ones((e&-e)-1)},t.getFlags=function(t,e){var i="";for(t=0;t<e.length;t++)t&1<<t&&(i+=e[t]+" ");return 0===i.length?"":i.trim()},t.isPowerOfTwo=function(t){return t&&0==(t&t-1)},t.roundToMultipleOfFour=function(t){return t+3&-4},t.nearestPowerOfTwo=function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},t.roundToMultipleOfPowerOfTwo=function(t,e){var i=(1<<e)-1;return t+i&~i},t.toHEX=function(t){return"0x"+("00000000"+(t=t<0?4294967295+t+1:t).toString(16)).substr(-8)}}(Ao||(Ao={}));var xo=function(){},Co=function(t,e){this.symbolId=t,this.className=e},wo=function(t,e,i){this.tagCode=t,this.byteOffset=e,this.byteLength=i},Io=function(t){function e(e,i,n,r){var o=t.call(this,i,n,r)||this;return o.id=e,o}return i(e,t),e}(wo),Eo=function(t){function e(e,i,n,r){var o=t.call(this,e,i.tagCode,i.byteOffset,i.byteLength)||this;return o.type=n,o.definition=r,o.ready=!1,o}return i(e,t),e}(Io);function So(t){return"string"==typeof t?t:null==t?null:t+""}var Do,To={code:2006,message:"The supplied index is out of bounds."},Po={code:2007,message:"Parameter %1 must be non-null."},Bo={code:2030,message:"End of file was encountered.",fqn:"flash.errors.EOFError"},Mo={code:2058,message:"There was an error decompressing the data.",fqn:"flash.errors.IOError"};!function(t){t[t.INIT=0]="INIT",t[t.BLOCK_0=1]="BLOCK_0",t[t.BLOCK_1=2]="BLOCK_1",t[t.BLOCK_2_PRE=3]="BLOCK_2_PRE",t[t.BLOCK_2=4]="BLOCK_2",t[t.DONE=5]="DONE",t[t.ERROR=6]="ERROR",t[t.VERIFY_HEADER=7]="VERIFY_HEADER"}(Do||(Do={}));var Oo,Lo,Ro,No,Fo,ko,Vo,Uo=function(){function t(t){}return t.prototype.push=function(t){},t.prototype.close=function(){},t.create=function(t){return new jo(t)},t.prototype._processZLibHeader=function(t,e,i){if(e+2>i)return 0;var n=t[e]<<8|t[e+1],r=null;return 2048!=(3840&n)?r="inflate: unknown compression method":n%31!=0?r="inflate: bad FCHECK":0!=(32&n)&&(r="inflate: FDICT bit set"),r?(this.onError&&this.onError(r),-1):2},t.inflate=function(e,i,n){var r=new Uint8Array(i),o=0,s=t.create(n);return s.onData=function(t){var e=Math.min(t.length,r.length-o);e&&ho(r,t,o,0,e),o+=e},s.onError=function(t){throw new Error(t)},s.push(e),s.close(),r},t}(),jo=function(t){function e(e){var i=t.call(this,e)||this;return i._buffer=null,i._bufferSize=0,i._bufferPosition=0,i._bitBuffer=0,i._bitLength=0,i._window=new Uint8Array(65794),i._windowPosition=0,i._state=e?Do.VERIFY_HEADER:Do.INIT,i._isFinalBlock=!1,i._literalTable=null,i._distanceTable=null,i._block0Read=0,i._block2State=null,i._copyState={state:0,len:0,lenBits:0,dist:0,distBits:0},Go||(!function(){Oo=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Lo=new Uint16Array(30),Ro=new Uint8Array(30);for(var t=0,e=0,i=1;t<30;++t)Lo[t]=i,i+=1<<(Ro[t]=~~((e+=t>2?1:0)/2));var n=new Uint8Array(288);for(t=0;t<32;++t)n[t]=5;No=Qo(n.subarray(0,32)),Fo=new Uint16Array(29),ko=new Uint8Array(29);for(t=0,e=0,i=3;t<29;++t)Fo[t]=i-(28==t?1:0),i+=1<<(ko[t]=~~((e+=t>4?1:0)/4%6));for(t=0;t<288;++t)n[t]=t<144||t>279?8:t<256?9:7;Vo=Qo(n)}(),Go=!0),i}return i(e,t),e.prototype.push=function(t){if(!this._buffer||this._buffer.length<this._bufferSize+t.length){var e=new Uint8Array(this._bufferSize+t.length);this._buffer&&e.set(this._buffer),this._buffer=e}this._buffer.set(t,this._bufferSize),this._bufferSize+=t.length,this._bufferPosition=0;var i=!1;do{var n=this._windowPosition;if(this._state===Do.INIT&&(i=this._decodeInitState()))break;switch(this._state){case Do.BLOCK_0:i=this._decodeBlock0();break;case Do.BLOCK_2_PRE:if(i=this._decodeBlock2Pre())break;case Do.BLOCK_1:case Do.BLOCK_2:i=this._decodeBlock();break;case Do.ERROR:case Do.DONE:this._bufferPosition=this._bufferSize;break;case Do.VERIFY_HEADER:var r=this._processZLibHeader(this._buffer,this._bufferPosition,this._bufferSize);r>0?(this._bufferPosition+=r,this._state=Do.INIT):0===r?i=!0:this._state=Do.ERROR}this._windowPosition-n>0&&this.onData(this._window.subarray(n,this._windowPosition)),this._windowPosition>=65536&&("copyWithin"in this._buffer?this._window.copyWithin(0,this._windowPosition-32768,this._windowPosition):this._window.set(this._window.subarray(this._windowPosition-32768,this._windowPosition)),this._windowPosition=32768)}while(!i&&this._bufferPosition<this._bufferSize);this._bufferPosition<this._bufferSize?("copyWithin"in this._buffer?this._buffer.copyWithin(0,this._bufferPosition,this._bufferSize):this._buffer.set(this._buffer.subarray(this._bufferPosition,this._bufferSize)),this._bufferSize-=this._bufferPosition):this._bufferSize=0},e.prototype._decodeInitState=function(){if(this._isFinalBlock)return this._state=Do.DONE,!1;var t,e=this._buffer,i=this._bufferSize,n=this._bitBuffer,r=this._bitLength,o=this._bufferPosition;if((i-o<<3)+r<3)return!0;r<3&&(n|=e[o++]<<r,r+=8);var s=7&n;switch(n>>=3,r-=3,s>>1){case 0:if(n=0,r=0,i-o<4)return!0;var a=e[o]|e[o+1]<<8,l=e[o+2]|e[o+3]<<8;if(o+=4,65535!=(a^l)){this._error("inflate: invalid block 0 length"),t=Do.ERROR;break}0===a?t=Do.INIT:(this._block0Read=a,t=Do.BLOCK_0);break;case 1:t=Do.BLOCK_1,this._literalTable=Vo,this._distanceTable=No;break;case 2:if((i-o<<3)+r<26)return!0;for(;r<14;)n|=e[o++]<<r,r+=8;var u=4+(n>>10&15);if((i-o<<3)+r<14+3*u)return!0;var c={numLiteralCodes:257+(31&n),numDistanceCodes:1+(n>>5&31),codeLengthTable:void 0,bitLengths:void 0,codesRead:0,dupBits:0};n>>=14,r-=14;for(var h=new Uint8Array(19),p=0;p<u;++p)r<3&&(n|=e[o++]<<r,r+=8),h[Oo[p]]=7&n,n>>=3,r-=3;for(;p<19;p++)h[Oo[p]]=0;c.bitLengths=new Uint8Array(c.numLiteralCodes+c.numDistanceCodes),c.codeLengthTable=Qo(h),this._block2State=c,t=Do.BLOCK_2_PRE;break;default:return this._error("inflate: unsupported block type"),t=Do.ERROR,!1}return this._isFinalBlock=!!(1&s),this._state=t,this._bufferPosition=o,this._bitBuffer=n,this._bitLength=r,!1},e.prototype._error=function(t){this.onError&&this.onError(t)},e.prototype._decodeBlock0=function(){var t=this._bufferPosition,e=this._windowPosition,i=this._block0Read,n=65794-e,r=this._bufferSize-t,o=r<i,s=Math.min(n,r,i);return this._window.set(this._buffer.subarray(t,t+s),e),this._windowPosition=e+s,this._bufferPosition=t+s,this._block0Read=i-s,i===s?(this._state=Do.INIT,!1):o&&n<r},e.prototype._readBits=function(t){var e=this._bitBuffer,i=this._bitLength;if(t>i){var n=this._bufferPosition,r=this._bufferSize;do{if(n>=r)return this._bufferPosition=n,this._bitBuffer=e,this._bitLength=i,-1;e|=this._buffer[n++]<<i,i+=8}while(t>i);this._bufferPosition=n}return this._bitBuffer=e>>t,this._bitLength=i-t,e&(1<<t)-1},e.prototype._readCode=function(t){var e=this._bitBuffer,i=this._bitLength,n=t.maxBits;if(n>i){var r=this._bufferPosition,o=this._bufferSize;do{if(r>=o)return this._bufferPosition=r,this._bitBuffer=e,this._bitLength=i,-1;e|=this._buffer[r++]<<i,i+=8}while(n>i);this._bufferPosition=r}var s=t.codes[e&(1<<n)-1],a=s>>16;return 32768&s?(this._error("inflate: invalid encoding"),this._state=Do.ERROR,-1):(this._bitBuffer=e>>a,this._bitLength=i-a,65535&s)},e.prototype._decodeBlock2Pre=function(){var t=this._block2State,e=t.numLiteralCodes+t.numDistanceCodes,i=t.bitLengths,n=t.codesRead,r=n>0?i[n-1]:0,o=t.codeLengthTable;if(t.dupBits>0){if((a=this._readBits(t.dupBits))<0)return!0;for(;a--;)i[n++]=r;t.dupBits=0}for(;n<e;){var s=this._readCode(o);if(s<0)return t.codesRead=n,!0;if(s<16)i[n++]=r=s;else{var a,l;switch(s){case 16:l=2,a=3,s=r;break;case 17:l=3,a=3,s=0;break;case 18:l=7,a=11,s=0}for(;a--;)i[n++]=s;if((a=this._readBits(l))<0)return t.codesRead=n,t.dupBits=l,!0;for(;a--;)i[n++]=s;r=s}}return this._literalTable=Qo(i.subarray(0,t.numLiteralCodes)),this._distanceTable=Qo(i.subarray(t.numLiteralCodes)),this._state=Do.BLOCK_2,this._block2State=null,!1},e.prototype._decodeBlock=function(){var t,e,i,n,r,o,s,a=this._literalTable,l=this._distanceTable,u=this._window,c=this._windowPosition,h=this._copyState;if(0!==h.state)switch(h.state){case 1:if(e=0,(e=this._readBits(h.lenBits))<0)return!0;h.len+=e,h.state=2;case 2:if((i=this._readCode(l))<0)return!0;h.distBits=Ro[i],h.dist=Lo[i],h.state=3;case 3:if(e=0,h.distBits>0&&(e=this._readBits(h.distBits))<0)return!0;for(o=h.dist+e,n=h.len,t=c-o;n--;)u[c++]=u[t++];if(h.state=0,c>=65536)return this._windowPosition=c,!1}do{if((i=this._readCode(a))<0)return this._windowPosition=c,!0;if(i<256)u[c++]=i;else{if(!(i>256)){this._state=Do.INIT;break}if(this._windowPosition=c,r=ko[i-=257],n=Fo[i],(e=0===r?0:this._readBits(r))<0)return h.state=1,h.len=n,h.lenBits=r,!0;if(n+=e,(i=this._readCode(l))<0)return h.state=2,h.len=n,!0;if(s=Ro[i],o=Lo[i],(e=0===s?0:this._readBits(s))<0)return h.state=3,h.len=n,h.dist=o,h.distBits=s,!0;for(t=c-(o+=e);n--;)u[c++]=u[t++]}}while(c<65536);return this._windowPosition=c,!1},e}(Uo),Go=!1;function Qo(t){for(var e=Math.max.apply(null,t),i=t.length,n=1<<e,r=new Uint32Array(n),o=e<<16|65535,s=0;s<n;s++)r[s]=o;for(var a=0,l=1,u=2;l<=e;a<<=1,++l,u<<=1)for(var c=0;c<i;++c)if(t[c]===l){for(var h=0,p=0;p<l;++p)h=2*h+(a>>p&1);for(p=h;p<n;p+=u)r[p]=l<<16|c;++a}return{codes:r,maxBits:e}}var zo;!function(t){function e(e,i){var n=t.call(this,e)||this;return n._verifyHeader=e,n._specialInflate=i(),n._specialInflate.setDataCallback(function(t){this.onData(t)}.bind(n)),n}i(e,t),e.prototype.push=function(t){if(this._verifyHeader){var e=void 0;this._buffer?((e=new Uint8Array(this._buffer.length+t.length)).set(this._buffer),e.set(t,this._buffer.length),this._buffer=null):e=new Uint8Array(t);var i=this._processZLibHeader(e,0,e.length);if(0===i)return void(this._buffer=e);this._verifyHeader=!0,i>0&&(t=e.subarray(i))}this._specialInflate.push(t)},e.prototype.close=function(){this._specialInflate&&(this._specialInflate.close(),this._specialInflate=null)}}(Uo);!function(t){t[t.WRITE=0]="WRITE",t[t.DONE=1]="DONE",t[t.ZLIB_HEADER=2]="ZLIB_HEADER"}(zo||(zo={}));var Ho=function(){function t(){this.a=1,this.b=0}return t.prototype.update=function(t,e,i){for(var n=this.a,r=this.b,o=e;o<i;++o)r=(r+(n=(n+(255&t[o]))%65521))%65521;this.a=n,this.b=r},t.prototype.getChecksum=function(){return this.b<<16|this.a},t}(),Xo=function(){function t(t){this._writeZlibHeader=t,this._state=t?zo.ZLIB_HEADER:zo.WRITE,this._adler32=t?new Ho:null}return t.prototype.push=function(t){this._state===zo.ZLIB_HEADER&&(this.onData(new Uint8Array([120,156])),this._state=zo.WRITE);for(var e=t.length,i=e+5*Math.ceil(e/65535),n=new Uint8Array(i),r=0,o=0;e>65535;)n.set(new Uint8Array([0,255,255,0,0]),r),r+=5,n.set(t.subarray(o,o+65535),r),o+=65535,r+=65535,e-=65535;n.set(new Uint8Array([0,255&e,e>>8&255,255&~e,~e>>8&255]),r),r+=5,n.set(t.subarray(o,e),r),this.onData(n),this._adler32&&this._adler32.update(t,0,e)},t.prototype.close=function(){if(this._state=zo.DONE,this.onData(new Uint8Array([1,0,0,255,255])),this._adler32){var t=this._adler32.getChecksum();this.onData(new Uint8Array([255&t,t>>8&255,t>>16&255,t>>>24&255]))}},t}(),qo=function(){function t(){this.available=0,this.pos=0,this.buffer=new Uint8Array(2e3)}return t.prototype.append=function(t){var e=this.pos+this.available,i=e+t.length;if(i>this.buffer.length){for(var n=2*this.buffer.length;n<i;)n*=2;var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}this.buffer.set(t,e),this.available+=t.length},t.prototype.compact=function(){0!==this.available&&(this.buffer.set(this.buffer.subarray(this.pos,this.pos+this.available),0),this.pos=0)},t.prototype.readByte=function(){if(this.available<=0)throw new Error("Unexpected end of file");return this.available--,this.buffer[this.pos++]},t}(),Yo=function(){function t(t){this.onData=t,this.processed=0}return t.prototype.writeBytes=function(t){this.onData.call(null,t),this.processed+=t.length},t}(),Ko=function(){function t(t){this.outStream=t,this.buf=null,this.pos=0,this.size=0,this.isFull=!1,this.writePos=0,this.totalPos=0}return t.prototype.create=function(t){this.buf=new Uint8Array(t),this.pos=0,this.size=t,this.isFull=!1,this.writePos=0,this.totalPos=0},t.prototype.putByte=function(t){this.totalPos++,this.buf[this.pos++]=t,this.pos===this.size&&(this.flush(),this.pos=0,this.isFull=!0)},t.prototype.getByte=function(t){return this.buf[t<=this.pos?this.pos-t:this.size-t+this.pos]},t.prototype.flush=function(){this.writePos<this.pos&&(this.outStream.writeBytes(this.buf.subarray(this.writePos,this.pos)),this.writePos=this.pos===this.size?0:this.pos)},t.prototype.copyMatch=function(t,e){for(var i=this.pos,n=this.size,r=this.buf,o=t<=i?i-t:n-t+i,s=e;s>0;){for(var a=Math.min(Math.min(s,n-i),n-o),l=0;l<a;l++){var u=r[o++];r[i++]=u}i===n&&(this.pos=i,this.flush(),i=0,this.isFull=!0),o===n&&(o=0),s-=a}this.pos=i,this.totalPos+=e},t.prototype.checkDistance=function(t){return t<=this.pos||this.isFull},t.prototype.isEmpty=function(){return 0===this.pos&&!this.isFull},t}();function Wo(t){for(var e=new Uint16Array(t),i=0;i<t;i++)e[i]=1024;return e}var Jo=function(){function t(t){this.inStream=t,this.range=0,this.code=0,this.corrupted=!1}return t.prototype.init=function(){0!==this.inStream.readByte()&&(this.corrupted=!0),this.range=-1;for(var t=0,e=0;e<4;e++)t=t<<8|this.inStream.readByte();t===this.range&&(this.corrupted=!0),this.code=t},t.prototype.isFinishedOK=function(){return 0===this.code},t.prototype.decodeDirectBits=function(t){var e=0,i=this.range,n=this.code;do{var r=(n=n-(i=i>>>1|0)|0)>>31;(n=n+(i&r)|0)===i&&(this.corrupted=!0),i>=0&&i<1<<24&&(i<<=8,n=n<<8|this.inStream.readByte()),e=(e<<1)+r+1|0}while(--t);return this.range=i,this.code=n,e},t.prototype.decodeBit=function(t,e){var i,n=this.range,r=this.code,o=t[e],s=(n>>>11)*o;return r>>>0<s?(o=o+(2048-o>>5)|0,n=0|s,i=0):(o=o-(o>>5)|0,r=r-s|0,n=n-s|0,i=1),t[e]=65535&o,n>=0&&n<1<<24&&(n<<=8,r=r<<8|this.inStream.readByte()),this.range=n,this.code=r,i},t}();function Zo(t,e,i,n){for(var r=1,o=0,s=0;s<i;s++){var a=n.decodeBit(t,r+e);r=(r<<1)+a,o|=a<<s}return o}var $o=function(){function t(t){this.numBits=t,this.probs=Wo(1<<t)}return t.prototype.decode=function(t){for(var e=1,i=0;i<this.numBits;i++)e=(e<<1)+t.decodeBit(this.probs,e);return e-(1<<this.numBits)},t.prototype.reverseDecode=function(t){return Zo(this.probs,0,this.numBits,t)},t}();function ts(t,e){var i=[];i.length=e;for(var n=0;n<e;n++)i[n]=new $o(t);return i}var es=function(){function t(){this.choice=Wo(2),this.lowCoder=ts(3,16),this.midCoder=ts(3,16),this.highCoder=new $o(8)}return t.prototype.decode=function(t,e){return 0===t.decodeBit(this.choice,0)?this.lowCoder[e].decode(t):0===t.decodeBit(this.choice,1)?8+this.midCoder[e].decode(t):16+this.highCoder.decode(t)},t}();function is(t){return t<4?0:t<10?t-3:t-6}function ns(t){return t<7?7:10}function rs(t){return t<7?8:11}function os(t){return t<7?9:11}var ss,as=function(){function t(t,e){this.rangeDec=new Jo(t),this.outWindow=new Ko(e),this.markerIsMandatory=!1,this.lc=0,this.pb=0,this.lp=0,this.dictSize=0,this.dictSizeInProperties=0,this.unpackSize=void 0,this.leftToUnpack=void 0,this.reps=new Int32Array(4),this.state=0}return t.prototype.decodeProperties=function(t){var e=t[0];if(e>=225)throw new Error("Incorrect LZMA properties");this.lc=e%9,e=e/9|0,this.pb=e/5|0,this.lp=e%5,this.dictSizeInProperties=0;for(var i=0;i<4;i++)this.dictSizeInProperties|=t[i+1]<<8*i;this.dictSize=this.dictSizeInProperties,this.dictSize<4096&&(this.dictSize=4096)},t.prototype.create=function(){this.outWindow.create(this.dictSize),this.init(),this.rangeDec.init(),this.reps[0]=0,this.reps[1]=0,this.reps[2]=0,this.reps[3]=0,this.state=0,this.leftToUnpack=this.unpackSize},t.prototype.decodeLiteral=function(t,e){var i=this.outWindow,n=this.rangeDec,r=0;i.isEmpty()||(r=i.getByte(1));var o=1,s=768*(((i.totalPos&(1<<this.lp)-1)<<this.lc)+(r>>8-this.lc));if(t>=7){var a=i.getByte(e+1);do{var l=a>>7&1;a<<=1;var u=n.decodeBit(this.litProbs,s+((1+l<<8)+o));if(o=o<<1|u,l!==u)break}while(o<256)}for(;o<256;)o=o<<1|n.decodeBit(this.litProbs,s+o);return o-256&255},t.prototype.decodeDistance=function(t){var e=t;e>3&&(e=3);var i=this.rangeDec,n=this.posSlotDecoder[e].decode(i);if(n<4)return n;var r=(n>>1)-1,o=(2|1&n)<<r;return o=n<14?o+Zo(this.posDecoders,o-n,r,i)|0:(o=o+(i.decodeDirectBits(r-4)<<4)|0)+this.alignDecoder.reverseDecode(i)|0},t.prototype.init=function(){this.litProbs=Wo(768<<this.lc+this.lp),this.posSlotDecoder=ts(6,4),this.alignDecoder=new $o(4),this.posDecoders=Wo(115),this.isMatch=Wo(192),this.isRep=Wo(12),this.isRepG0=Wo(12),this.isRepG1=Wo(12),this.isRepG2=Wo(12),this.isRep0Long=Wo(192),this.lenDecoder=new es,this.repLenDecoder=new es},t.prototype.decode=function(t){for(var e=this.rangeDec,i=this.outWindow,n=this.pb,r=this.dictSize,o=this.markerIsMandatory,s=this.leftToUnpack,a=this.isMatch,l=this.isRep,u=this.isRepG0,c=this.isRepG1,h=this.isRepG2,p=this.isRep0Long,d=this.lenDecoder,f=this.repLenDecoder,_=this.reps[0],m=this.reps[1],g=this.reps[2],y=this.reps[3],A=this.state;;){if(t&&e.inStream.available<48){this.outWindow.flush();break}if(0===s&&!o&&(this.outWindow.flush(),e.isFinishedOK()))return cs;var v=i.totalPos&(1<<n)-1;if(0!==e.decodeBit(a,(A<<4)+v)){var b;if(0!==e.decodeBit(l,A)){if(0===s)return ls;if(i.isEmpty())return ls;var x;if(0===e.decodeBit(u,A)){if(0===e.decodeBit(p,(A<<4)+v)){A=os(A),i.putByte(i.getByte(_+1)),s--;continue}}else 0===e.decodeBit(c,A)?x=m:(0===e.decodeBit(h,A)?x=g:(x=y,y=g),g=m),m=_,_=x;b=f.decode(e,v),A=rs(A)}else{if(y=g,g=m,m=_,b=d.decode(e,v),A=ns(A),-1===(_=this.decodeDistance(b)))return this.outWindow.flush(),e.isFinishedOK()?us:ls;if(0===s)return ls;if(_>=r||!i.checkDistance(_))return ls}b+=2;var C=!1;if(void 0!==s&&s<b&&(b=s,C=!0),i.copyMatch(_+1,b),s-=b,C)return ls}else{if(0===s)return ls;i.putByte(this.decodeLiteral(A,_)),A=is(A),s--}}return this.state=A,this.reps[0]=_,this.reps[1]=m,this.reps[2]=g,this.reps[3]=y,this.leftToUnpack=s,hs},t.prototype.flushOutput=function(){this.outWindow.flush()},t}(),ls=0,us=1,cs=2,hs=3;!function(t){t[t.WAIT_FOR_LZMA_HEADER=0]="WAIT_FOR_LZMA_HEADER",t[t.WAIT_FOR_SWF_HEADER=1]="WAIT_FOR_SWF_HEADER",t[t.PROCESS_DATA=2]="PROCESS_DATA",t[t.CLOSED=3]="CLOSED",t[t.ERROR=4]="ERROR"}(ss||(ss={}));var ps=function(){function t(t){void 0===t&&(t=!1),this._state=t?ss.WAIT_FOR_SWF_HEADER:ss.WAIT_FOR_LZMA_HEADER,this.buffer=null}return t.prototype.push=function(t){if(this._state<ss.PROCESS_DATA){var e=this.buffer?this.buffer.length:0,i=5+(this._state===ss.WAIT_FOR_SWF_HEADER?17:13);if(e+t.length<i){var n=new Uint8Array(e+t.length);return e>0&&n.set(this.buffer),n.set(t,e),void(this.buffer=n)}var r=new Uint8Array(i);if(e>0&&r.set(this.buffer),r.set(t.subarray(0,i-e),e),this._inStream=new qo,this._inStream.append(r.subarray(i-5)),this._outStream=new Yo(function(t){this.onData.call(null,t)}.bind(this)),this._decoder=new as(this._inStream,this._outStream),this._state===ss.WAIT_FOR_SWF_HEADER)this._decoder.decodeProperties(r.subarray(12,17)),this._decoder.markerIsMandatory=!1,this._decoder.unpackSize=((r[4]|r[5]<<8|r[6]<<16|r[7]<<24)>>>0)-8;else{this._decoder.decodeProperties(r.subarray(0,5));for(var o=0,s=!1,a=0;a<8;a++){var l=r[5+a];255!==l&&(s=!0),o|=l<<8*a}this._decoder.markerIsMandatory=!s,this._decoder.unpackSize=s?o:void 0}this._decoder.create(),t=t.subarray(i),this._state=ss.PROCESS_DATA}else if(this._state!==ss.PROCESS_DATA)return;try{this._inStream.append(t);var u=this._decoder.decode(!0);this._inStream.compact(),u!==hs&&this._checkError(u)}catch(t){this._decoder.flushOutput(),this._decoder=null,this._error(t)}},t.prototype.close=function(){if(this._state===ss.PROCESS_DATA){this._state=ss.CLOSED;try{var t=this._decoder.decode(!1);this._checkError(t)}catch(t){this._decoder.flushOutput(),this._error(t)}this._decoder=null}},t.prototype._error=function(t){this._state=ss.ERROR,this.onError&&this.onError(t)},t.prototype._checkError=function(t){var e;t===ls?e="LZMA decoding error":t===hs?e="Decoding is not complete":t===us?void 0!==this._decoder.unpackSize&&this._decoder.unpackSize!==this._outStream.processed&&(e="Finished with end marker before than specified size"):e="Internal LZMA Error",e&&this._error(e)},t}();function ds(t){return"string"==typeof t?t:null==t?null:t+""}for(var fs,_s=function(t,e,i){this.buffer=t,this.length=e,this.littleEndian=i},ms=new Uint32Array(33),gs=1,ys=0;gs<=32;gs++)ms[gs]=ys=ys<<1|1;!function(t){t[t.U8=1]="U8",t[t.I32=2]="I32",t[t.F32=4]="F32"}(fs||(fs={}));var As,vs=function(){function t(e){void 0===e&&(e=t.INITIAL_SIZE),this._buffer||(this._buffer=new ArrayBuffer(e),this._length=0,this._position=0,this._resetViews(),this._littleEndian=t._nativeLittleEndian,this._bitBuffer=0,this._bitLength=0)}return t.FromArrayBuffer=function(e,i){void 0===i&&(i=-1);var n=Object.create(t.prototype);return n._buffer=e,n._length=-1===i?e.byteLength:i,n._position=0,n._resetViews(),n._littleEndian=t._nativeLittleEndian,n._bitBuffer=0,n._bitLength=0,n},t.FromPlainObject=function(e){var i=t.FromArrayBuffer(e.buffer,e.length);return i._littleEndian=e.littleEndian,i},t.prototype.toPlainObject=function(){return new _s(this._buffer,this._length,this._littleEndian)},t.prototype.clone=function(){var e=t.FromArrayBuffer(new Uint8Array(this._u8).buffer,this._length);return e._position=this._position,e._littleEndian=this._littleEndian,e._bitBuffer=this._bitBuffer,e._bitLength=this._bitLength,e},t.prototype._resetViews=function(){this._u8=new Uint8Array(this._buffer),this._i32=null,this._f32=null},t.prototype._requestViews=function(t){0==(3&this._buffer.byteLength)&&(null===this._i32&&t&fs.I32&&(this._i32=new Int32Array(this._buffer)),null===this._f32&&t&fs.F32&&(this._f32=new Float32Array(this._buffer)))},t.prototype.getBytes=function(){return new Uint8Array(this._buffer,0,this._length)},t.prototype._ensureCapacity=function(e){var i=this._buffer;if(!(i.byteLength>=e)){for(var n=Math.max(i.byteLength,1);n<e;)n*=2;n>4294967295&&(co(this.sec),this.sec.throwError("RangeError",To));var r=t._arrayBufferPool.acquire(n),o=this._u8;this._buffer=r,this._resetViews(),this._u8.set(o);for(var s=this._u8,a=o.length;a<s.length;a++)s[a]=0;t._arrayBufferPool.release(i)}},t.prototype.clear=function(){this._length=0,this._position=0},t.prototype.readBoolean=function(){return 0!==this.readUnsignedByte()},t.prototype.readByte=function(){return this.readUnsignedByte()<<24>>24},t.prototype.readUnsignedByte=function(){return this._position+1>this._length&&(co(this.sec),this.sec.throwError("flash.errors.EOFError",Bo)),this._u8[this._position++]},t.prototype.readBytes=function(t,e,i){var n=this._position;e>>>=0,0===(i>>>=0)&&(i=this._length-n),n+i>this._length&&(co(this.sec),this.sec.throwError("flash.errors.EOFError",Bo)),t.length<e+i&&(t._ensureCapacity(e+i),t.length=e+i),t._u8.set(new Uint8Array(this._buffer,n,i),e),this._position+=i},t.prototype.readShort=function(){return this.readUnsignedShort()<<16>>16},t.prototype.readUnsignedShort=function(){var t=this._u8,e=this._position;e+2>this._length&&(co(this.sec),this.sec.throwError("flash.errors.EOFError",Bo));var i=t[e+0],n=t[e+1];return this._position=e+2,this._littleEndian?n<<8|i:i<<8|n},t.prototype.readInt=function(){var t=this._u8,e=this._position;e+4>this._length&&(co(this.sec),this.sec.throwError("flash.errors.EOFError",Bo));var i=t[e+0],n=t[e+1],r=t[e+2],o=t[e+3];return this._position=e+4,this._littleEndian?o<<24|r<<16|n<<8|i:i<<24|n<<16|r<<8|o},t.prototype.readUnsignedInt=function(){return this.readInt()>>>0},t.prototype.readFloat=function(){var t=this._position;if(t+4>this._length&&(co(this.sec),this.sec.throwError("flash.errors.EOFError",Bo)),this._position=t+4,this._requestViews(fs.F32),this._littleEndian&&0==(3&t)&&this._f32)return this._f32[t>>2];var e=this._u8,i=Ao.u8;return this._littleEndian?(i[0]=e[t+0],i[1]=e[t+1],i[2]=e[t+2],i[3]=e[t+3]):(i[3]=e[t+0],i[2]=e[t+1],i[1]=e[t+2],i[0]=e[t+3]),Ao.f32[0]},t.prototype.readDouble=function(){var t=this._u8,e=this._position;e+8>this._length&&(co(this.sec),this.sec.throwError("flash.errors.EOFError",Bo));var i=Ao.u8;return this._littleEndian?(i[0]=t[e+0],i[1]=t[e+1],i[2]=t[e+2],i[3]=t[e+3],i[4]=t[e+4],i[5]=t[e+5],i[6]=t[e+6],i[7]=t[e+7]):(i[0]=t[e+7],i[1]=t[e+6],i[2]=t[e+5],i[3]=t[e+4],i[4]=t[e+3],i[5]=t[e+2],i[6]=t[e+1],i[7]=t[e+0]),this._position=e+8,Ao.f64[0]},t.prototype.writeBoolean=function(t){this.writeByte(t?1:0)},t.prototype.writeByte=function(t){var e=this._position+1;this._ensureCapacity(e),this._u8[this._position++]=t,e>this._length&&(this._length=e)},t.prototype.writeUnsignedByte=function(t){var e=this._position+1;this._ensureCapacity(e),this._u8[this._position++]=t,e>this._length&&(this._length=e)},t.prototype.writeRawBytes=function(t){var e=this._position+t.length;this._ensureCapacity(e),this._u8.set(t,this._position),this._position=e,e>this._length&&(this._length=e)},t.prototype.writeBytes=function(t,e,i){mo(t)&&(co(this.sec),this.sec.throwError("TypeError",Po,"bytes")),e>>>=0,i>>>=0,arguments.length<2&&(e=0),arguments.length<3&&(i=0),e===_o(e,0,t.length)&&e+i===_o(e+i,0,t.length)||(co(this.sec),this.sec.throwError("RangeError",To)),0===i&&(i=t.length-e),this.writeRawBytes(new Uint8Array(t._buffer,e,i))},t.prototype.writeShort=function(t){this.writeUnsignedShort(t)},t.prototype.writeUnsignedShort=function(t){var e=this._position;this._ensureCapacity(e+2);var i=this._u8;this._littleEndian?(i[e+0]=t,i[e+1]=t>>8):(i[e+0]=t>>8,i[e+1]=t),e+=2,this._position=e,e>this._length&&(this._length=e)},t.prototype.writeInt=function(t){this.writeUnsignedInt(t)},t.prototype.write2Ints=function(t,e){this.write2UnsignedInts(t,e)},t.prototype.write4Ints=function(t,e,i,n){this.write4UnsignedInts(t,e,i,n)},t.prototype.writeUnsignedInt=function(e){var i=this._position;if(this._ensureCapacity(i+4),this._requestViews(fs.I32),this._littleEndian===t._nativeLittleEndian&&0==(3&i)&&this._i32)this._i32[i>>2]=e;else{var n=this._u8;this._littleEndian?(n[i+0]=e,n[i+1]=e>>8,n[i+2]=e>>16,n[i+3]=e>>24):(n[i+0]=e>>24,n[i+1]=e>>16,n[i+2]=e>>8,n[i+3]=e)}i+=4,this._position=i,i>this._length&&(this._length=i)},t.prototype.write2UnsignedInts=function(e,i){var n=this._position;this._ensureCapacity(n+8),this._requestViews(fs.I32),this._littleEndian===t._nativeLittleEndian&&0==(3&n)&&this._i32?(this._i32[0+(n>>2)]=e,this._i32[1+(n>>2)]=i,n+=8,this._position=n,n>this._length&&(this._length=n)):(this.writeUnsignedInt(e),this.writeUnsignedInt(i))},t.prototype.write4UnsignedInts=function(e,i,n,r){var o=this._position;this._ensureCapacity(o+16),this._requestViews(fs.I32),this._littleEndian===t._nativeLittleEndian&&0==(3&o)&&this._i32?(this._i32[0+(o>>2)]=e,this._i32[1+(o>>2)]=i,this._i32[2+(o>>2)]=n,this._i32[3+(o>>2)]=r,o+=16,this._position=o,o>this._length&&(this._length=o)):(this.writeUnsignedInt(e),this.writeUnsignedInt(i),this.writeUnsignedInt(n),this.writeUnsignedInt(r))},t.prototype.writeFloat=function(e){var i=this._position;if(this._ensureCapacity(i+4),this._requestViews(fs.F32),this._littleEndian===t._nativeLittleEndian&&0==(3&i)&&this._f32)this._f32[i>>2]=e;else{var n=this._u8;Ao.f32[0]=e;var r=Ao.u8;this._littleEndian?(n[i+0]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]):(n[i+0]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0])}i+=4,this._position=i,i>this._length&&(this._length=i)},t.prototype.write2Floats=function(e,i){var n=this._position;this._ensureCapacity(n+8),this._requestViews(fs.F32),this._littleEndian===t._nativeLittleEndian&&0==(3&n)&&this._f32?(this._f32[0+(n>>2)]=e,this._f32[1+(n>>2)]=i,n+=8,this._position=n,n>this._length&&(this._length=n)):(this.writeFloat(e),this.writeFloat(i))},t.prototype.write6Floats=function(e,i,n,r,o,s){var a=this._position;this._ensureCapacity(a+24),this._requestViews(fs.F32),this._littleEndian===t._nativeLittleEndian&&0==(3&a)&&this._f32?(this._f32[0+(a>>2)]=e,this._f32[1+(a>>2)]=i,this._f32[2+(a>>2)]=n,this._f32[3+(a>>2)]=r,this._f32[4+(a>>2)]=o,this._f32[5+(a>>2)]=s,a+=24,this._position=a,a>this._length&&(this._length=a)):(this.writeFloat(e),this.writeFloat(i),this.writeFloat(n),this.writeFloat(r),this.writeFloat(o),this.writeFloat(s))},t.prototype.writeDouble=function(t){var e=this._position;this._ensureCapacity(e+8);var i=this._u8;Ao.f64[0]=t;var n=Ao.u8;this._littleEndian?(i[e+0]=n[0],i[e+1]=n[1],i[e+2]=n[2],i[e+3]=n[3],i[e+4]=n[4],i[e+5]=n[5],i[e+6]=n[6],i[e+7]=n[7]):(i[e+0]=n[7],i[e+1]=n[6],i[e+2]=n[5],i[e+3]=n[4],i[e+4]=n[3],i[e+5]=n[2],i[e+6]=n[1],i[e+7]=n[0]),e+=8,this._position=e,e>this._length&&(this._length=e)},t.prototype.readRawBytes=function(){return new Int8Array(this._buffer,0,this._length)},t.prototype.writeUTF=function(t){var e=go(t=ds(t));this.writeShort(e.length),this.writeRawBytes(e)},t.prototype.writeUTFBytes=function(t){var e=go(t=ds(t));this.writeRawBytes(e)},t.prototype.readUTF=function(){return this.readUTFBytes(this.readShort())},t.prototype.readUTFBytes=function(t){t>>>=0;var e=this._position;return e+t>this._length&&(co(this.sec),this.sec.throwError("flash.errors.EOFError",Bo)),this._position+=t,yo(new Uint8Array(this._buffer,e,t))},Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(t){(t>>>=0)>this._buffer.byteLength&&this._ensureCapacity(t),this._length=t,this._position=_o(this._position,0,this._length)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bytesAvailable",{get:function(){return this._length-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this._buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bytes",{get:function(){return this._u8},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ints",{get:function(){return this._requestViews(fs.I32),this._i32},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectEncoding",{get:function(){return this._objectEncoding},set:function(t){t>>>=0,this._objectEncoding=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endian",{get:function(){return this._littleEndian?"littleEndian":"bigEndian"},set:function(e){e=ds(e),this._littleEndian="auto"===e?t._nativeLittleEndian:"littleEndian"===e},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return yo(new Uint8Array(this._buffer,0,this._length))},t.prototype.toBlob=function(t){return new Blob([new Uint8Array(this._buffer,this._position,this._length)],{type:t})},t.prototype.writeMultiByte=function(t,e){if(t=ds(t),"UTF-8"==(e=ds(e))){var i=go(t);this.writeRawBytes(i)}else console.log("packageInternal flash.utils.ObjectOutput::writeMultiByte only encoding supported is UTF-8")},t.prototype.readMultiByte=function(t,e){console.log("packageInternal flash.utils.ObjectInput::readMultiByte")},t.prototype.getValue=function(t){if(!((t|=0)>=this._length))return this._u8[t]},t.prototype.setValue=function(t,e){var i=(t|=0)+1;this._ensureCapacity(i),this._u8[t]=e,i>this._length&&(this._length=i)},t.prototype.readFixed=function(){return this.readInt()/65536},t.prototype.readFixed8=function(){return this.readShort()/256},t.prototype.readFloat16=function(){var t=this.readUnsignedShort(),e=t>>15?-1:1,i=(31744&t)>>10,n=1023&t;return i?31===i?n?NaN:e*(1/0):e*Math.pow(2,i-15)*(1+n/1024):e*Math.pow(2,-14)*(n/1024)},t.prototype.readEncodedU32=function(){var t=this.readUnsignedByte();return 128&t&&16384&(t=127&t|this.readUnsignedByte()<<7)&&2097152&(t=16383&t|this.readUnsignedByte()<<14)&&268435456&(t=2097151&t|this.readUnsignedByte()<<21)?268435455&t|this.readUnsignedByte()<<28:t},t.prototype.readBits=function(t){return this.readUnsignedBits(t)<<32-t>>32-t},t.prototype.readUnsignedBits=function(t){for(var e=this._bitBuffer,i=this._bitLength;t>i;)e=e<<8|this.readUnsignedByte(),i+=8;var n=e>>>(i-=t)&ms[t];return this._bitBuffer=e,this._bitLength=i,n},t.prototype.readFixedBits=function(t){return this.readBits(t)/65536},t.prototype.readString=function(t){var e=this._position;if(t)e+t>this._length&&(co(this.sec),this.sec.throwError("flash.errors.EOFError",Bo)),this._position+=t;else{t=0;for(var i=e;i<this._length&&this._u8[i];i++)t++;this._position+=t+1}return yo(new Uint8Array(this._buffer,e,t))},t.prototype.align=function(){this._bitBuffer=0,this._bitLength=0},t.prototype.deflate=function(){this.compress("deflate")},t.prototype.inflate=function(){this.uncompress("deflate")},t.prototype.compress=function(e){var i;switch(e=0===arguments.length?"zlib":ds(e)){case"zlib":i=new Xo(!0);break;case"deflate":i=new Xo(!1);break;default:return}var n=new t;i.onData=n.writeRawBytes.bind(n),i.push(this._u8.subarray(0,this._length)),i.close(),this._ensureCapacity(n._u8.length),this._u8.set(n._u8),this.length=n.length,this._position=0},t.prototype.uncompress=function(e){var i;switch(e=0===arguments.length?"zlib":ds(e)){case"zlib":i=Uo.create(!0);break;case"deflate":i=Uo.create(!1);break;case"lzma":i=new ps(!1);break;default:return}var n,r=new t;i.onData=r.writeRawBytes.bind(r),i.onError=function(t){return n=t},i.push(this._u8.subarray(0,this._length)),n&&(co(this.sec),this.sec.throwError("IOError",Mo)),i.close(),this._ensureCapacity(r._u8.length),this._u8.set(r._u8),this.length=r.length,this._position=0},t._nativeLittleEndian=1===new Int8Array(new Int32Array([1]).buffer)[0],t.INITIAL_SIZE=128,t._arrayBufferPool=new vo,t}();!function(t){t[t.Solid=0]="Solid",t[t.LinearGradient=16]="LinearGradient",t[t.RadialGradient=18]="RadialGradient",t[t.FocalRadialGradient=19]="FocalRadialGradient",t[t.RepeatingBitmap=64]="RepeatingBitmap",t[t.ClippedBitmap=65]="ClippedBitmap",t[t.NonsmoothedRepeatingBitmap=66]="NonsmoothedRepeatingBitmap",t[t.NonsmoothedClippedBitmap=67]="NonsmoothedClippedBitmap"}(As||(As={}));var bs,xs=function(){function t(e,i,n,r,o,s){this.commands=e,this.data=i,this.morphData=n,this.prev=r,this.next=o,this.isReversed=s,this.isValidFill=!0,this.id=t._counter++}return t.FromDefaults=function(e){var i=new vs,n=new vs;i.endian=n.endian="auto";var r=null;return e&&((r=new vs).endian="auto"),new t(i,n,r,null,null,!1)},t.prototype.moveTo=function(t,e){this.commands.writeUnsignedByte(9),this.data.write2Ints(t,e)},t.prototype.morphMoveTo=function(t,e,i,n){this.moveTo(t,e),this.morphData.write2Ints(i,n)},t.prototype.lineTo=function(t,e){this.commands.writeUnsignedByte(10),this.data.write2Ints(t,e)},t.prototype.morphLineTo=function(t,e,i,n){this.lineTo(t,e),this.morphData.write2Ints(i,n)},t.prototype.curveTo=function(t,e,i,n){this.commands.writeUnsignedByte(11),this.data.write4Ints(t,e,i,n)},t.prototype.morphCurveTo=function(t,e,i,n,r,o,s,a){this.curveTo(t,e,i,n),this.morphData.write4Ints(r,o,s,a)},t.prototype.toReversed=function(){return co(!this.isReversed),new t(this.commands,this.data,this.morphData,null,null,!0)},t.prototype.clone=function(){return new t(this.commands,this.data,this.morphData,null,null,this.isReversed)},t.prototype.storeStartAndEnd=function(){var t=this.data.ints,e=t[0]+","+t[1],i=(this.data.length>>2)-2,n=t[i]+","+t[i+1];this.isReversed?(this.startPoint=n,this.endPoint=e):(this.startPoint=e,this.endPoint=n)},t.prototype.connectsTo=function(t){return t!==this&&(co(this.endPoint),co(t.startPoint),this.endPoint===t.startPoint)},t.prototype.startConnectsTo=function(t){return t!==this&&this.startPoint===t.startPoint},t.prototype.flipDirection=function(){var t;t=this.startPoint,this.startPoint=this.endPoint,this.endPoint=t,this.isReversed=!this.isReversed},t.prototype.serializeAJS=function(t,e,i){if(this.isReversed)this._serializeReversedAJS(t,e,i);else{var n=this.commands.bytes,r=this.data.length>>2,o=this.morphData?this.morphData.ints:null,s=this.data.ints;co(9===n[0]);var a=0;s[0]===i.x&&s[1]===i.y&&a++;for(var l=this.commands.length,u=2*a,c=a;c<l;c++){switch(n[c]){case 9:t.moveTo(s[u]/20,s[u+1]/20),e&&e.moveTo(o[u]/20,o[u+1]/20);break;case 10:t.lineTo(s[u]/20,s[u+1]/20),e&&e.lineTo(o[u]/20,o[u+1]/20);break;case 11:t.curveTo(s[u]/20,s[u+1]/20,s[u+2]/20,s[u+3]/20),e&&e.curveTo(o[u]/20,o[u+1]/20,o[u+2]/20,o[u+3]/20),u+=2}u+=2}i.x=s[r-2],i.y=s[r-1]}},t.prototype._serializeReversedAJS=function(t,e,i){var n=this.commands.length,r=(this.data.length>>2)-2,o=this.commands.bytes;co(9===o[0]);var s=this.data.ints,a=this.morphData?this.morphData.ints:null;if(s[r]===i.x&&s[r+1]===i.y||(t.moveTo(s[r]/20,s[r+1]/20),e&&e.moveTo(a[r]/20,a[r+1]/20)),1===n)return i.x=s[0],void(i.y=s[1]);for(var l=n;l-- >1;){r-=2;o[l];switch(o[l]){case 9:t.moveTo(s[r]/20,s[r+1]/20),e&&e.moveTo(a[r]/20,a[r+1]/20);break;case 10:t.lineTo(s[r]/20,s[r+1]/20),e&&e.lineTo(a[r]/20,a[r+1]/20);break;case 11:r-=2,t.curveTo(s[r+2]/20,s[r+3]/20,s[r]/20,s[r+1]/20),e&&e.curveTo(a[r+2]/20,a[r+3]/20,a[r]/20,a[r+1]/20)}}i.x=s[0],i.y=s[1]},t._counter=0,t}();!function(t){t.LINEAR="linear",t.RADIAL="radial"}(bs||(bs={}));var Cs,ws=function(){function t(t,e){void 0===t&&(t=16777215),void 0===e&&(e=1),this.color=t,this.alpha=e}return Object.defineProperty(t.prototype,"data_type",{get:function(){return t.data_type},enumerable:!0,configurable:!0}),t.data_type="[graphicsdata FillStyle]",t}(),Is=function(t){function e(e,i,n,r,o,s,a,l){var u=t.call(this)||this;if(i.length!=n.length||i.length!=r.length)throw"GradientFillStyle: Error - colors, alphas and ratios must be of same length";u.colors=i,u.colors_r=[],u.colors_g=[],u.colors_b=[],u.colors_r.length=u.colors_g.length=u.colors_g.length=u.colors.length,u.alphas=n,u.ratios=r,u.matrix=o,u.type=e,u.uvRectangle=new Y,u.ratios.sort((function(t,e){return t-e})),u.ratio_min=u.ratios[0],u.ratio_max=u.ratios[u.ratios.length-1];for(var c,h=i.length;h>0;)h--,c=w.float32ColorToARGB(i[h]),u.colors_r[h]=c[1],u.colors_g[h]=c[2],u.colors_b[h]=c[3];return u}return i(e,t),e.prototype.getUVMatrix=function(){if(this._uvMatrix)return this._uvMatrix;this.matrix||(this.matrix=new T);var t,e=this.matrix.a,i=this.matrix.b,n=this.matrix.c,r=this.matrix.d,o=this.matrix.tx,s=this.matrix.ty,a=r/(e*r-i*n),l=-i/(e*r-i*n),u=-n/(e*r-i*n),c=e/(e*r-i*n),h=(n*s-r*o)/(e*r-i*n),p=-(e*s-i*o)/(e*r-i*n);return this.type==bs.LINEAR?t=new T(a/1638.4*(1-1/256),0,u/1638.4*(1-1/256),0,this.uvRectangle.x+(h+819.2)/1638.4*(1-1/256),this.uvRectangle.y):this.type==bs.RADIAL?t=new T(a/819.2,l/819.2,u/819.2,c/819.2,(h+819.2)/819.2-1,(p+819.2)/819.2-1):this._uvMatrix=this.matrix,this._uvMatrix=t},e.prototype.getColorAtPosition=function(t){var e=-1,i=-1;if(t<=this.ratio_min)e=0,i=0;else if(t>=this.ratio_max)e=this.ratios.length-1,i=this.ratios.length-1;else for(var n=0;n<this.ratios.length-1;n++){if(t==this.ratios[n]){e=n,i=n;break}if(t==this.ratios[n+1]){e=n+1,i=n+1;break}if(t>=this.ratios[n]&&t<=this.ratios[n+1]){e=n,i=n+1;break}}if(e==i)return[this.alphas[e],this.colors_r[e],this.colors_g[e],this.colors_b[e]];var r=(t-this.ratios[e])/(this.ratios[i]-this.ratios[e]),o=1-r;return[this.alphas[i]*r+this.alphas[e]*o,this.colors_r[i]*r+this.colors_r[e]*o,this.colors_g[i]*r+this.colors_g[e]*o,this.colors_b[i]*r+this.colors_b[e]*o]},e.prototype.toString=function(){for(var t="",e=this.colors.length;e>0;)e--,t+=this.colors[e]+"#"+this.alphas[e]+"#"+this.ratios[e]+"#";return t},Object.defineProperty(e.prototype,"data_type",{get:function(){return e.data_type},enumerable:!0,configurable:!0}),e.data_type="[graphicsdata GradientFillStyle]",e}(ws),Es=function(){function t(t,e,i,n){this.material=t,this.matrix=e,this.repeat=i,this.smooth=n}return Object.defineProperty(t.prototype,"data_type",{get:function(){return t.data_type},enumerable:!0,configurable:!0}),t.prototype.getUVMatrix=function(){this.matrix||(this.matrix=new T);var t=this.material.ambientMethod.texture._images[0];if(!t)throw"BitmapFillStyle.getUVMatrix - no texture found";var e=t.width,i=t.height,n=this.matrix.a,r=this.matrix.b,o=this.matrix.c,s=this.matrix.d,a=this.matrix.tx,l=this.matrix.ty,u=s/(n*s-r*o),c=-r/(n*s-r*o),h=-o/(n*s-r*o),p=n/(n*s-r*o),d=(o*l-s*a)/(n*s-r*o),f=-(n*l-r*a)/(n*s-r*o);return this.matrix.a=u/e,this.matrix.b=c/i,this.matrix.c=h/e,this.matrix.d=p/i,this.matrix.tx=d/e,this.matrix.ty=f/i,this.matrix},t.data_type="[graphicsdata BitmapFillStyle]",t}();!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.NONE=1]="NONE",t[t.NORMAL=2]="NORMAL",t[t.VERTICAL=3]="VERTICAL",t[t.HAIRLINE=4]="HAIRLINE"}(Cs||(Cs={}));var Ss,Ds=function(){function t(){}return t.ROUND=1,t.NONE=0,t.SQUARE=2,t}(),Ts=function(){function t(){}return t.BEVEL=1,t.MITER=2,t.ROUND=0,t}(),Ps=function(){function t(t,e,i,n,r,o,s){void 0===t&&(t=16777215),void 0===e&&(e=1),void 0===i&&(i=10),void 0===n&&(n=Ts.ROUND),void 0===r&&(r=Ds.SQUARE),void 0===o&&(o=10),void 0===s&&(s=Cs.NORMAL),this._color=t,this._alpha=e,this._thickness=i,this._jointstyle=n,this._capstyle=r,this._miter_limit=o,this.scaleMode=s}return Object.defineProperty(t.prototype,"data_type",{get:function(){return t.data_type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"half_thickness",{get:function(){return this._thickness/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jointstyle",{get:function(){return this._jointstyle},set:function(t){this._jointstyle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"miter_limit",{get:function(){return this._miter_limit},set:function(t){this._miter_limit=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"capstyle",{get:function(){return this._capstyle},set:function(t){this._capstyle=t},enumerable:!0,configurable:!0}),t.data_type="[graphicsdata StrokeStyle]",t}(),Bs=function(){function t(t,e){this.fillStyle=t,this.lineStyle=e,this._head=null}return t.prototype.addSegment=function(t){co(t),co(null===t.next),co(null===t.prev);var e=this._head;e&&(co(t!==e),e.next=t,t.prev=e),this._head=t},t.prototype.removeSegment=function(t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev)},t.prototype.insertSegment=function(t,e){var i=e.prev;t.prev=i,t.next=e,i&&(i.next=t),e.prev=t},t.prototype.head=function(){return this._head},t.prototype.rgbaToArgb=function(t){return(255&t)<<24|(4278190080&t)>>>24<<16|(16711680&t)>>>16<<8|(65280&t)>>>8},t.prototype.getAlpha=function(t){return 255&t},t.prototype.rgbToArgb=function(t){return(4278190080&t)>>>24<<24|(255&t)<<16|(65280&t)>>>8<<8|(16711680&t)>>>16},t.prototype.serializeAJS=function(t,e){var i=this.head();if(i){if(this.fillStyle){var n=(p=this.fillStyle).morph;switch(p.type){case As.Solid:p.alpha=(255&p.color)/255,p.color=this.rgbaToArgb(p.color),t.style=new ws(p.color,p.alpha),n&&(n.alpha=(255&n.color)/255,n.color=this.rgbaToArgb(n.color),e.style=new ws(n.color,n.alpha));break;case As.LinearGradient:case As.RadialGradient:case As.FocalRadialGradient:for(var r=p.type===As.LinearGradient?bs.LINEAR:bs.RADIAL,o=[],s=0;s<p.colors.length;s++)o[s]=(255&p.colors[s])/255,p.colors[s]=this.rgbaToArgb(p.colors[s]);var a=new T(p.transform.a,p.transform.b,p.transform.c,p.transform.d,p.transform.tx,p.transform.ty);if(t.style=new Is(r,p.colors,o,p.ratios,a,p.spreadMethod,p.interpolationMode,p.focalPoint/2|0),n){var l=n.type===As.LinearGradient?bs.LINEAR:bs.RADIAL,u=[];for(s=0;s<n.colors.length;s++)u[s]=(255&n.colors[s])/255,n.colors[s]=this.rgbaToArgb(n.colors[s]);var c=new T(n.transform.a,n.transform.b,n.transform.c,n.transform.d,n.transform.tx,n.transform.ty);e.style=new Is(l,n.colors,u,n.ratios,c,n.spreadMethod,n.interpolationMode,n.focalPoint/2|0)}break;case As.ClippedBitmap:case As.RepeatingBitmap:case As.NonsmoothedClippedBitmap:case As.NonsmoothedRepeatingBitmap:a=new T(p.transform.a,p.transform.b,p.transform.c,p.transform.d,p.transform.tx,p.transform.ty);if(t.style=new Es(p.material,a,p.repeat,p.smooth),n){var h=new T(n.transform.a,n.transform.b,n.transform.c,n.transform.d,n.transform.tx,n.transform.ty);e.style=new Es(p.material,h,p.repeat,p.smooth)}break;default:console.log("Invalid fill style type: "+p.type)}}else{var p;n=(p=this.lineStyle).morph;switch(co(p),p.type){case As.Solid:var d=(0|_o(p.width,0,5100))/20;p.alpha=(255&p.color)/255,p.color=this.rgbaToArgb(p.color);var f=d<=.05?Cs.HAIRLINE:Cs.NORMAL;if(p.startCapsStyle!=p.endCapsStyle&&console.log("Warning: different end vs start capstyöe"),p.startCapsStyle=Ds.ROUND,p.jointStyle=0,t.style=new Ps(p.color,p.alpha,d,p.jointStyle,p.startCapsStyle,p.miterLimit,f),n){var _=(0|_o(n.width,0,5100))/20;n.alpha=this.getAlpha(n.color)/255,n.color=this.rgbaToArgb(n.color),e.style=new Ps(n.color,n.alpha,_,p.jointStyle,p.startCapsStyle,p.miterLimit,f)}break;case As.LinearGradient:case As.RadialGradient:case As.FocalRadialGradient:d=(0|_o(p.width,0,5100))/20;p.alpha=(255&p.color)/255,p.color=this.rgbaToArgb(p.color),t.style=new Ps(p.color,p.alpha,d,p.jointStyle,p.endCapsStyle,p.miterLimit);for(r=p.type===As.LinearGradient?bs.LINEAR:bs.RADIAL,o=[],s=0;s<p.colors.length;s++)p.colors[s]=this.rgbaToArgb(p.colors[s]),o[s]=1;t.style=new Is(r,p.colors,o,p.ratios,p.transform,p.spreadMethod,p.interpolationMode,p.focalPoint/2|0);break;case As.ClippedBitmap:case As.RepeatingBitmap:case As.NonsmoothedClippedBitmap:case As.NonsmoothedRepeatingBitmap:d=0|_o(p.width,0,5100);t.style=new Ps(p.color,1,d,p.jointStyle,p.endCapsStyle,p.miterLimit)}}for(;i;)i.storeStartAndEnd(),i=i.prev;for(var m=this.head(),g=m,y=null,A=null,v=m.prev;m;){for(;v;)v.startConnectsTo(m)&&v.flipDirection(),v.connectsTo(m)?(v.next!==m&&(this.removeSegment(v),this.insertSegment(v,m)),v=(m=v).prev):(v.startConnectsTo(g)&&v.flipDirection(),g.connectsTo(v)?(this.removeSegment(v),g.next=v,v=v.prev,g.next.prev=g,g.next.next=null,g=g.next):v=v.prev);if(v=m.prev,y?(A.next=m,m.prev=A,(A=g).next=null):(y=m,A=g),!v)break;v=(m=g=v).prev}var b={x:0,y:0};for(v=y;v;)v.isValidFill&&v.serializeAJS(t,e,b),v=v.next;return t}},t}(),Ms=function(t,e,i,n,r,o,s,a,l,u,c){this.commands=t,this.commandsPosition=e,this.coordinates=i,this.morphCoordinates=n,this.coordinatesPosition=r,this.styles=o,this.stylesLength=s,this.morphStyles=a,this.morphStylesLength=l,this.hasFills=u,this.hasLines=c};!function(t){t[t.Commands=32]="Commands",t[t.Coordinates=128]="Coordinates",t[t.Styles=16]="Styles"}(Ss||(Ss={}));!function(){function t(t){void 0===t&&(t=!0),t&&this.clear()}t.FromPlainObject=function(e){var i=new t(!1);return i.commands=e.commands,i.coordinates=e.coordinates,i.morphCoordinates=e.morphCoordinates,i.commandsPosition=e.commandsPosition,i.coordinatesPosition=e.coordinatesPosition,i.styles=vs.FromArrayBuffer(e.styles,e.stylesLength),i.styles.endian="auto",e.morphStyles&&(i.morphStyles=vs.FromArrayBuffer(e.morphStyles,e.morphStylesLength),i.morphStyles.endian="auto"),i.hasFills=e.hasFills,i.hasLines=e.hasLines,i},t.prototype.moveTo=function(t,e){this.ensurePathCapacities(1,2),this.commands[this.commandsPosition++]=9,this.coordinates[this.coordinatesPosition++]=t,this.coordinates[this.coordinatesPosition++]=e},t.prototype.lineTo=function(t,e){this.ensurePathCapacities(1,2),this.commands[this.commandsPosition++]=10,this.coordinates[this.coordinatesPosition++]=t,this.coordinates[this.coordinatesPosition++]=e},t.prototype.curveTo=function(t,e,i,n){this.ensurePathCapacities(1,4),this.commands[this.commandsPosition++]=11,this.coordinates[this.coordinatesPosition++]=t,this.coordinates[this.coordinatesPosition++]=e,this.coordinates[this.coordinatesPosition++]=i,this.coordinates[this.coordinatesPosition++]=n},t.prototype.cubicCurveTo=function(t,e,i,n,r,o){this.ensurePathCapacities(1,6),this.commands[this.commandsPosition++]=12,this.coordinates[this.coordinatesPosition++]=t,this.coordinates[this.coordinatesPosition++]=e,this.coordinates[this.coordinatesPosition++]=i,this.coordinates[this.coordinatesPosition++]=n,this.coordinates[this.coordinatesPosition++]=r,this.coordinates[this.coordinatesPosition++]=o},t.prototype.beginFill=function(t){this.ensurePathCapacities(1,0),this.commands[this.commandsPosition++]=1,this.styles.writeUnsignedInt(t),this.hasFills=!0},t.prototype.writeMorphFill=function(t){this.morphStyles.writeUnsignedInt(t)},t.prototype.endFill=function(){this.ensurePathCapacities(1,0),this.commands[this.commandsPosition++]=4},t.prototype.endLine=function(){this.ensurePathCapacities(1,0),this.commands[this.commandsPosition++]=8},t.prototype.lineStyle=function(t,e,i,n,r,o,s){co(t===(0|t),t>=0&&t<=5100),this.ensurePathCapacities(2,0),this.commands[this.commandsPosition++]=5,this.coordinates[this.coordinatesPosition++]=t;var a=this.styles;a.writeUnsignedInt(e),a.writeBoolean(i),a.writeUnsignedByte(n),a.writeUnsignedByte(r),a.writeUnsignedByte(o),a.writeUnsignedByte(s),this.hasLines=!0},t.prototype.writeMorphLineStyle=function(t,e){this.morphCoordinates[this.coordinatesPosition-1]=t,this.morphStyles.writeUnsignedInt(e)},t.prototype.beginBitmap=function(t,e,i,n,r){co(3===t||7===t),this.ensurePathCapacities(1,0),this.commands[this.commandsPosition++]=t;var o=this.styles;o.writeUnsignedInt(e),this._writeStyleMatrix(i,!1),o.writeBoolean(n),o.writeBoolean(r),this.hasFills=!0},t.prototype.writeMorphBitmap=function(t){this._writeStyleMatrix(t,!0)},t.prototype.beginGradient=function(t,e,i,n,r,o,s,a){co(2===t||6===t),this.ensurePathCapacities(1,0),this.commands[this.commandsPosition++]=t;var l=this.styles;l.writeUnsignedByte(n),co(a===(0|a)),l.writeShort(a),this._writeStyleMatrix(r,!1);var u=e.length;l.writeByte(u);for(var c=0;c<u;c++)l.writeUnsignedByte(i[c]),l.writeUnsignedInt(e[c]);l.writeUnsignedByte(o),l.writeUnsignedByte(s),this.hasFills=!0},t.prototype.writeMorphGradient=function(t,e,i){this._writeStyleMatrix(i,!0);for(var n=this.morphStyles,r=0;r<t.length;r++)n.writeUnsignedByte(e[r]),n.writeUnsignedInt(t[r])},t.prototype.writeCommandAndCoordinates=function(t,e,i){this.ensurePathCapacities(1,2),this.commands[this.commandsPosition++]=t,this.coordinates[this.coordinatesPosition++]=e,this.coordinates[this.coordinatesPosition++]=i},t.prototype.writeCoordinates=function(t,e){this.ensurePathCapacities(0,2),this.coordinates[this.coordinatesPosition++]=t,this.coordinates[this.coordinatesPosition++]=e},t.prototype.writeMorphCoordinates=function(t,e){this.morphCoordinates=bo(this.morphCoordinates,this.coordinatesPosition),this.morphCoordinates[this.coordinatesPosition-2]=t,this.morphCoordinates[this.coordinatesPosition-1]=e},t.prototype.clear=function(){this.commandsPosition=this.coordinatesPosition=0,this.commands=new Uint8Array(Ss.Commands),this.coordinates=new Int32Array(Ss.Coordinates),this.styles=new vs(Ss.Styles),this.styles.endian="auto",this.hasFills=this.hasLines=!1},t.prototype.isEmpty=function(){return 0===this.commandsPosition},t.prototype.clone=function(){var e=new t(!1);return e.commands=new Uint8Array(this.commands),e.commandsPosition=this.commandsPosition,e.coordinates=new Int32Array(this.coordinates),e.coordinatesPosition=this.coordinatesPosition,e.styles=new vs(this.styles.length),e.styles.writeRawBytes(this.styles.bytes.subarray(0,this.styles.length)),this.morphStyles&&(e.morphStyles=new vs(this.morphStyles.length),e.morphStyles.writeRawBytes(this.morphStyles.bytes.subarray(0,this.morphStyles.length))),e.hasFills=this.hasFills,e.hasLines=this.hasLines,e},t.prototype.toPlainObject=function(){return new Ms(this.commands,this.commandsPosition,this.coordinates,this.morphCoordinates,this.coordinatesPosition,this.styles.buffer,this.styles.length,this.morphStyles&&this.morphStyles.buffer,this.morphStyles?this.morphStyles.length:0,this.hasFills,this.hasLines)},Object.defineProperty(t.prototype,"buffers",{get:function(){var t=[this.commands.buffer,this.coordinates.buffer,this.styles.buffer];return this.morphCoordinates&&t.push(this.morphCoordinates.buffer),this.morphStyles&&t.push(this.morphStyles.buffer),t},enumerable:!0,configurable:!0}),t.prototype._writeStyleMatrix=function(t,e){(e?this.morphStyles:this.styles).write6Floats(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.prototype.ensurePathCapacities=function(t,e){this.commands=bo(this.commands,this.commandsPosition+t),this.coordinates=bo(this.coordinates,this.coordinatesPosition+e)}}();var Os=function(){function t(){}return t.BOTH=1,t.STROKE=0,t.FILL=2,t}(),Ls=function(){this.cells=new Array,this.lastCollisionIndex=-1},Rs=function(){function t(){}return t.hitTest=function(t,e,i,n,r,o,s){void 0===s&&(s=0);var a,l,u,c,h,p,d,f,_,m,g,y=r.positions,A=r.getCustomAtributes("curves"),v=y.stride,b=A?A.stride:null,x=y.get(o,s),C=A?A.get(o,s):null;r.indices?(a=r.indices.get(o,s),x=y.get(y.count),C=A?A.get(A.count):null,l=o*r.indices.dimensions):(x=y.get(o,s),C=A?A.get(o,s):null,l=o);var w=r.hitTestCache[s]||(r.hitTestCache[s]=new Ls),I=w.lastCollisionIndex;if(-1!=I&&I<l)t:{if(a?(u=a[I+2],c=a[I+1],h=a[I]):(u=I+2,c=I+1,h=I),p=x[u*v],d=x[u*v+1],f=x[c*v],_=x[c*v+1],m=x[h*v],g=x[h*v+1],!((p-t)*(_-d)+(d-e)*-(f-p)>0||(f-t)*(g-_)+(_-e)*-(m-f)>0||(m-t)*(d-g)+(g-e)*-(p-m)>0)){if(C&&-128!=C[u*b+2]){var E=($=.5*(((K=t-p)*(Y=g-d)-(q=m-p)*(W=e-d))/(J=(H=f-p)*Y-q*(X=_-d)))+(Z=(H*W-K*X)/J))*$-Z,S=C[u*b];if(E>0&&-128==S)break t;if(E<0&&127==S)break t}return!0}}if(l>150){var D=w.cells,T=D.length?w.divisions:w.divisions=Math.min(Math.ceil(Math.sqrt(l)),32),P=T/n.width,B=T/n.height,M=n.x,O=n.y;if(!D.length){D.length=T*T;for(var L=0;L<l;L+=3){a?(u=a[L+2],c=a[L+1],h=a[L]):(u=L+2,c=L+1,h=L),p=x[u*v],d=x[u*v+1],f=x[c*v],_=x[c*v+1],m=x[h*v],g=x[h*v+1];for(var R=Math.floor((Math.min(p,f,m)-M)*P),N=Math.floor((Math.min(d,_,g)-O)*B),F=Math.floor((Math.max(p,f,m)-M)*P),k=Math.floor((Math.max(d,_,g)-O)*B),V=R;V<=F;V++)for(var U=N;U<=k;U++){var j,G=V+U*T;(j=D[G]||(D[G]=new Array)).push(L)}}}if(null==(j=D[Math.floor((t-M)*P)+Math.floor((e-O)*B)*T]))return w.lastCollisionIndex=-1,!1;for(var Q=j.length,z=0;z<Q;z++){L=j[z];if((h=a?a[L]:L)!=I)if(a?(u=a[L+2],c=a[L+1]):(u=L+2,c=L+1),p=x[u*v],d=x[u*v+1],f=x[c*v],_=x[c*v+1],m=x[h*v],g=x[h*v+1],!((p-t)*(_-d)+(d-e)*-(f-p)>0||(f-t)*(g-_)+(_-e)*-(m-f)>0||(m-t)*(d-g)+(g-e)*-(p-m)>0)){if(C&&-128!=C[u*b+2]){E=($=.5*(((K=t-p)*(Y=g-d)-(q=m-p)*(W=e-d))/(J=(H=f-p)*Y-q*(X=_-d)))+(Z=(H*W-K*X)/J))*$-Z,S=C[u*b];if(E>0&&-128==S)continue;if(E<0&&127==S)continue}return w.lastCollisionIndex=L,!0}}return w.lastCollisionIndex=-1,!1}for(L=0;L<l;L+=3){if((h=a?a[L]:L)!=I)if(a?(u=a[L+2],c=a[L+1]):(u=L+2,c=L+1),p=x[u*v],d=x[u*v+1],f=x[c*v],_=x[c*v+1],m=x[h*v],g=x[h*v+1],!((p-t)*(_-d)+(d-e)*-(f-p)>0||(f-t)*(g-_)+(_-e)*-(m-f)>0||(m-t)*(d-g)+(g-e)*-(p-m)>0)){if(C&&-128!=C[u*b+2]){var H,X,q,Y,K,W,J,Z,$;E=($=.5*(((K=t-p)*(Y=g-d)-(q=m-p)*(W=e-d))/(J=(H=f-p)*Y-q*(X=_-d)))+(Z=(H*W-K*X)/J))*$-Z,S=C[u*b];if(E>0&&-128==S)continue;if(E<0&&127==S)continue}return w.lastCollisionIndex=L,!0}}return w.lastCollisionIndex=-1,!1},t.getBoxBounds=function(t,e,i,n,r,o,s){var a;void 0===s&&(s=0);var l,u,c=t.dimensions,h=t.stride,p=0,d=0,f=0,_=0,m=0,g=0;if(e?(u=o*e.dimensions,l=e.get(o,s),a=t.get(t.count)):(u=o,a=t.get(o,s)),0==u)return r;var y,A,v,b,x,C=0;for(i&&(x=i._rawData),null==r?(r=n||new B,y=l?l[C]*h:C*h,i?3==c?(A=a[y]*x[0]+a[y+1]*x[4]+a[y+2]*x[8]+x[12],v=a[y]*x[1]+a[y+1]*x[5]+a[y+2]*x[9]+x[13],b=a[y]*x[2]+a[y+1]*x[6]+a[y+2]*x[10]+x[14]):(A=a[y]*x[0]+a[y+1]*x[4]+x[12],v=a[y]*x[1]+a[y+1]*x[5]+x[13]):(A=a[y],v=a[y+1],b=3==c?a[y+2]:0),_=p=A,m=d=v,g=f=3==c?b:0,C++):(_=(p=r.x)+r.width,m=(d=r.y)+r.height,g=(f=r.z)+r.depth);C<u;C++)y=l?l[C]*h:C*h,i?3==c?(A=a[y]*x[0]+a[y+1]*x[4]+a[y+2]*x[8]+x[12],v=a[y]*x[1]+a[y+1]*x[5]+a[y+2]*x[9]+x[13],b=a[y]*x[2]+a[y+1]*x[6]+a[y+2]*x[10]+x[14]):(A=a[y]*x[0]+a[y+1]*x[4]+x[12],v=a[y]*x[1]+a[y+1]*x[5]+x[13]):(A=a[y],v=a[y+1],b=3==c?a[y+2]:0),A<p?p=A:A>_&&(_=A),v<d?d=v:v>m&&(m=v),3==c&&(b<f?f=b:b>g&&(g=b));return r.width=_-(r.x=p),r.height=m-(r.y=d),r.depth=g-(r.z=f),r},t.getSphereBounds=function(t,e,i,n,r,o,s){void 0===s&&(s=0);for(var a,l,u,c,h=t.get(o,s),p=t.dimensions,d=t.stride,f=0,_=o*d,m=0;m<_;m+=d)f<(a=(l=h[m]-e.x)*l+(u=h[m+1]-e.y)*u+(c=3==p?h[m+2]-e.z:-e.z)*c)&&(f=a);return null==r&&(r=new L),r.x=e.x,r.y=e.y,r.z=e.z,r.radius=Math.sqrt(f),r},t.updateTriangleGraphicsSlice9=function(t,e,i,n,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=!1),9!=t.slice9Indices.length)throw"ElementUtils: Error - triangleElement does not provide valid slice9Indices!";var s,a=t.slice9Indices.length,l=e.width-(t.slice9offsets.x+t.slice9offsets.width)/i,u=e.height-(t.slice9offsets.y+t.slice9offsets.height)/n;if(l<0&&(l=0,i=(t.slice9offsets.x+t.slice9offsets.width)/e.width),u<0&&(u=0,n=(t.slice9offsets.y+t.slice9offsets.height)/e.height),o){for(var c=new Uint8Array(8*t.positions.count);f<2*t.positions.count;)c[f]=s[f++],c[f]=s[f++];var h,p=new Pn(8,t.positions.count);p.bufferView=c,(h=new Us(p)).setPositions(new Nn(p)),h.slice9offsets=t.slice9offsets,h.initialSlice9Positions=t.initialSlice9Positions,h.slice9Indices=t.slice9Indices,s=h.positions.get(h.positions.count),f=0}else s=t.positions.get(t.positions.count);var d,f=0;if(r){for((d=[]).length=2*t.positions.count;f<2*t.positions.count;)d[f]=s[f++],d[f]=s[f++];t.initialSlice9Positions=d}else d=t.initialSlice9Positions;var _=t.slice9Indices,m=0;f=0;var g=[];g.length=3;var y=[];y.length=3,g[0]=e.x,g[1]=e.x+t.slice9offsets.x/i,g[2]=e.x+t.slice9offsets.x/i+l,y[0]=e.y,y[1]=e.y+t.slice9offsets.y/n,y[2]=e.y+t.slice9offsets.y/n+u;var A=-1,v=0,b=0,x=0,C=0,w=0;for(m=0;m<a;m++)for(2==A&&(v++,A=-1),b=1==v?l:1/i,x=1==++A?u:1/n,C=g[v],w=y[A];f<_[m];)s[f]=C+d[f++]*b,s[f]=w+d[f++]*x;return o?(h.positions.invalidate(),h):(t.positions.invalidate(),t)},t}(),Ns=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.isDynamic=!1,i._customAttributesNames=new Array,i._customAttributes=new Object,i._autoDeriveNormals=!0,i._autoDeriveTangents=!0,i._boundsRequests=0,i._numElements=0,i._numVertices=0,i._verticesDirty=new Object,i._invalidateVertices=new Object,i.usages=0,i._concatenatedBuffer=e,i}return i(e,t),Object.defineProperty(e.prototype,"concatenatedBuffer",{get:function(){return this._concatenatedBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indices",{get:function(){return this._indices},enumerable:!0,configurable:!0}),e.prototype.getCustomAtributesNames=function(){return this._customAttributesNames},e.prototype.getCustomAtributes=function(t){return this._customAttributes[t]},Object.defineProperty(e.prototype,"numElements",{get:function(){return this._numElements},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"condensedIndexLookUp",{get:function(){return this._condensedIndexLookUp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoDeriveNormals",{get:function(){return this._autoDeriveNormals},set:function(t){this._autoDeriveNormals!=t&&(this._autoDeriveNormals=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoDeriveTangents",{get:function(){return this._autoDeriveTangents},set:function(t){this._autoDeriveTangents!=t&&(this._autoDeriveTangents=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useCondensedIndices",{get:function(){return this._useCondensedIndices},set:function(t){this._useCondensedIndices!=t&&(this._useCondensedIndices=t)},enumerable:!0,configurable:!0}),e.prototype.copyTo=function(t){for(var e in this.indices&&t.setIndices(this.indices.clone()),this._customAttributes)t.setCustomAttributes(e,this.getCustomAtributes(e).clone())},e.prototype.dispose=function(){for(var t in this.clear(),this._boundsRequests=0,this._convexHull&&(this._convexHull.dispose(),this._convexHull=null),this._indices&&(this._indices.dispose(),this._indices=null),this._customAttributes)this._customAttributes[t].dispose(),delete this._customAttributes},e.prototype.setIndices=function(t,e){void 0===e&&(e=0),t instanceof Vn?(this._indices&&this.clearIndices(),this._indices=t):t?(this._indices||(this._indices=new Vn),this._indices.set(t,e)):this._indices&&(this._indices.dispose(),this._indices=null,this.clearIndices()),this._indices?(this._numElements=this._indices.count,this.invalidateIndices()):this._numElements=0},e.prototype.setCustomAttributes=function(t,e,i){if(void 0===i&&(i=0),e!=this._customAttributes[t]){if(e instanceof On)this.clearVertices(this._customAttributes[t]),this._customAttributes[t]=e;else if(e)this._customAttributes[t]||(this._customAttributes[t]=new Fn(this._concatenatedBuffer)),this._customAttributes[t].set(e,i);else if(this._customAttributes[t])return this.clearVertices(this._customAttributes[t]),this._customAttributesNames.splice(this._customAttributesNames.indexOf(t),1),void delete this._customAttributes[t];this.invalidateVertices(this._customAttributes[t]),this._verticesDirty[this._customAttributes[t].id]=!1,-1==this._customAttributesNames.indexOf(t)&&this._customAttributesNames.push(t)}},e.prototype.clone=function(){throw new s},e.prototype.applyTransformation=function(t,e,i){throw new s},e.prototype.scale=function(t,e,i){throw new s},e.prototype.scaleUV=function(t,e,i,n){throw new s},e.prototype.getBoxBounds=function(t,e,i,n,r,o,a,l){throw new s},e.prototype.getSphereBounds=function(t,e,i,n,r,o,a,l){throw new s},e.prototype.hitTestPoint=function(t,e,i,n,r,o,a,l){throw new s},e.prototype.invalidateIndices=function(){this._invalidateIndices||(this._invalidateIndices=new ur(ur.INVALIDATE_INDICES,this._indices)),this.dispatchEvent(this._invalidateIndices)},e.prototype.clearIndices=function(){this.dispatchEvent(new ur(ur.CLEAR_INDICES,this._indices))},e.prototype.invalidateVertices=function(t){t&&!this._verticesDirty[t.id]&&(this._verticesDirty[t.id]=!0,this._invalidateVertices[t.id]||(this._invalidateVertices[t.id]=new ur(ur.INVALIDATE_VERTICES,t)),this.dispatchEvent(this._invalidateVertices[t.id]))},e.prototype.clearVertices=function(t){t&&(t.dispose(),this.dispatchEvent(new ur(ur.CLEAR_VERTICES,t)),this._verticesDirty[t.id]=null,this._invalidateVertices[t.id]=null)},e.prototype.testCollision=function(t,e,i,n,r,o,a){throw new s},e}(p),Fs={FILLS:!1,STROKES:!1},ks=10,Vs=!0,Us=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._faceNormalsDirty=!0,e._faceTangentsDirty=!0,e.hitTestCache=new Object,e}return i(e,t),e.prototype.updateSlice9=function(t,e){},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jointsPerVertex",{get:function(){return this._jointsPerVertex},set:function(t){this._jointsPerVertex!=t&&(this._jointsPerVertex=t,this._jointIndices&&(this._jointIndices.dimensions=this._jointsPerVertex),this._jointWeights&&(this._jointWeights.dimensions=this._jointsPerVertex))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions||this.setPositions(new Fn(this._concatenatedBuffer)),this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normals",{get:function(){return this._normals&&!this._verticesDirty[this._normals.id]||this.setNormals(this._normals),this._normals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tangents",{get:function(){return this._tangents&&!this._verticesDirty[this._tangents.id]||this.setTangents(this._tangents),this._tangents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"faceNormals",{get:function(){return this._faceNormalsDirty&&this.updateFaceNormals(),this._faceNormals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"faceTangents",{get:function(){return this._faceTangentsDirty&&this.updateFaceTangents(),this._faceTangents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uvs",{get:function(){if(!this._uvs&&e.isIE){var t=new On(Float32Array,2);t.set(this._positions.get(this._positions.count));var i=t.attributesBuffer;this._uvs=new Nn(i),t.dispose()}return this._uvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jointIndices",{get:function(){return this._jointIndices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jointWeights",{get:function(){return this._jointWeights},enumerable:!0,configurable:!0}),e.prototype.getBoxBounds=function(t,e,i,n,r,o,s,a){return void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=0),void 0===a&&(a=0),s=s||this._numElements||this._numVertices,this._boundsRequests++,Rs.getBoxBounds(this.positions,this.indices,n,r,o,s,a)},e.prototype.getSphereBounds=function(t,e,i,n,r,o,s,a){return void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=0),void 0===a&&(a=0),Rs.getSphereBounds(this.positions,e,i,r,o,s||this._numVertices,a)},e.prototype.hitTestPoint=function(t,e,i,n,r,o,s,a,l,u){return void 0===s&&(s=0),void 0===a&&(a=0),Rs.hitTest(i,n,0,o,this,s||this._numElements||this._numVertices,a)},e.prototype.setPositions=function(t,e){void 0===e&&(e=0),t!=this._positions&&(t instanceof On?(this.clearVertices(this._positions),this._positions=t):t?(this._positions||(this._positions=new Fn(this._concatenatedBuffer)),this._positions.set(t,e)):(this.clearVertices(this._positions),this._positions=new Fn(this._concatenatedBuffer)),this._numVertices=this._positions.count,this._autoDeriveNormals&&this.invalidateVertices(this._normals),this._autoDeriveTangents&&this.invalidateVertices(this._tangents),this.invalidateVertices(this._positions),this._verticesDirty[this._positions.id]=!1,this._convexHull=null)},e.prototype.setNormals=function(t,e){if(void 0===e&&(e=0),this._autoDeriveNormals)this._normals=cr.generateNormals(this.indices,this.faceNormals,this._normals,this._concatenatedBuffer);else{if(t==this._normals)return;if(t instanceof Fn)this.clearVertices(this._normals),this._normals=t;else if(t)this._normals||(this._normals=new Fn(this._concatenatedBuffer)),this._normals.set(t,e);else if(this._normals)return this.clearVertices(this._normals),void(this._normals=null)}this.invalidateVertices(this._normals),this._verticesDirty[this._normals.id]=!1},e.prototype.setTangents=function(t,e){if(void 0===e&&(e=0),this._autoDeriveTangents)this._tangents=cr.generateTangents(this.indices,this.faceTangents,this.faceNormals,this._tangents,this._concatenatedBuffer);else{if(t==this._tangents)return;if(t instanceof Fn)this.clearVertices(this._tangents),this._tangents=t;else if(t)this._tangents||(this._tangents=new Fn(this._concatenatedBuffer)),this._tangents.set(t,e);else if(this._tangents)return this.clearVertices(this._tangents),void(this._tangents=null)}this.invalidateVertices(this._tangents),this._verticesDirty[this._tangents.id]=!1},e.prototype.setUVs=function(t,e){if(void 0===e&&(e=0),t!=this._uvs){if(t instanceof On)this.clearVertices(this._uvs),this._uvs=t;else if(t)this._uvs||(this._uvs=new Nn(this._concatenatedBuffer)),this._uvs.set(t,e);else if(this._uvs)return this.clearVertices(this._uvs),void(this._uvs=null);this.invalidateVertices(this._uvs),this._verticesDirty[this._uvs.id]=!1}},e.prototype.setJointIndices=function(t,e){if(void 0===e&&(e=0),t!=this._jointIndices){if(t instanceof On)this.clearVertices(this._jointIndices),this._jointIndices=t;else if(t){if(this._jointIndices||(this._jointIndices=new On(Float32Array,this._jointsPerVertex,this._concatenatedBuffer)),this._useCondensedIndices){var i=0,n=void 0,r=0,o=new Object;for(this._condensedIndexLookUp=new Array;i<t.length;)null==o[n=t[i]]&&(o[n]=r,this._condensedIndexLookUp[r++]=n),t[i++]=o[n]}this._jointIndices.set(t,e)}else if(this._jointIndices)return this.clearVertices(this._jointIndices),void(this._jointIndices=null);this.invalidateVertices(this._jointIndices),this._verticesDirty[this._jointIndices.id]=!1}},e.prototype.setJointWeights=function(t,e){if(void 0===e&&(e=0),t!=this._jointWeights){if(t instanceof On)this.clearVertices(this._jointWeights),this._jointWeights=t;else if(t)this._jointWeights||(this._jointWeights=new On(Float32Array,this._jointsPerVertex,this._concatenatedBuffer)),this._jointWeights.set(t,e);else if(this._jointWeights)return this.clearVertices(this._jointWeights),void(this._jointWeights=null);this.invalidateVertices(this._jointWeights),this._verticesDirty[this._jointWeights.id]=!1}},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._positions&&(this._positions.dispose(),this._positions=null),this._normals&&(this._normals.dispose(),this._normals=null),this._tangents&&(this._tangents.dispose(),this._tangents=null),this._uvs&&(this._uvs.dispose(),this._uvs=null),this._jointIndices&&(this._jointIndices.dispose(),this._jointIndices=null),this._jointWeights&&(this._jointWeights.dispose(),this._jointWeights=null),this._faceNormals&&(this._faceNormals.dispose(),this._faceNormals=null),this._faceTangents&&(this._faceTangents.dispose(),this._faceTangents=null)},e.prototype.setIndices=function(e,i){void 0===i&&(i=0),t.prototype.setIndices.call(this,e,i),this._faceNormalsDirty=!0,this._faceTangentsDirty=!0,this._autoDeriveNormals&&this.invalidateVertices(this._normals),this._autoDeriveTangents&&this.invalidateVertices(this._tangents)},e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e);var i=this._autoDeriveNormals,n=this._autoDeriveTangents;e.autoDeriveNormals=this._autoDeriveNormals=!1,e.autoDeriveTangents=this._autoDeriveTangents=!1,e.setPositions(this.positions.clone()),this.normals&&e.setNormals(this.normals.clone()),this.tangents&&e.setTangents(this.tangents.clone()),this.uvs&&e.setUVs(this.uvs.clone()),e.jointsPerVertex=this._jointsPerVertex,this.jointIndices&&e.setJointIndices(this.jointIndices.clone()),this.jointWeights&&e.setJointWeights(this.jointWeights.clone()),e.autoDeriveNormals=this._autoDeriveNormals=i,e.autoDeriveTangents=this._autoDeriveTangents=n,this.slice9Indices&&(e.originalSlice9Size=this.originalSlice9Size,e.slice9offsets=this.slice9offsets,e.slice9Indices=this.slice9Indices,e.initialSlice9Positions=this.initialSlice9Positions)},e.prototype.clone=function(){var t=new e(this._concatenatedBuffer?this._concatenatedBuffer.clone():null);return this.copyTo(t),t},e.prototype.scaleUV=function(t,e,i,n){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),this.uvs&&cr.scale(t,e,0,this.uvs,i||this._numVertices,n)},e.prototype.scale=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),cr.scale(t,t,t,this.positions,e||this._numVertices,i)},e.prototype.applyTransformation=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),cr.applyTransformation(t,this.positions,this.normals,this.tangents,e||this._numVertices,i)},e.prototype.updateFaceTangents=function(){this._faceTangents=cr.generateFaceTangents(this.indices,this.positions,this.uvs||this.positions,this._faceTangents,this.numElements),this._faceTangentsDirty=!1},e.prototype.updateFaceNormals=function(){this._faceNormals=cr.generateFaceNormals(this.indices,this.positions,this._faceNormals,this.numElements),this._faceNormalsDirty=!1},e.prototype.testCollision=function(t,e,i,n,r,o,s){void 0===s&&(s=0);var a,l,u,c,h,p,d,f,_,m,g,y,A,v,b,x,C,w,I,E,S,T,B,M,O,L,R,N,F,k,V,U,j,G,Q,z,H=e.rayPosition,X=e.rayDirection,q=-1,Y=r.bothSides,K=this.positions.get(o,s),W=this.positions.dimensions,J=this.positions.stride;this.indices&&(o=(z=this.indices.get(this.numElements)).length);for(var Z=0;Z<o;Z+=3)if(z?(l=z[Z]*J,u=z[Z+1]*J,c=z[Z+2]*J):(l=Z*J,u=(Z+1)*J,c=(Z+2)*J),w=K[l],T=K[u]-w,O=K[c]-w,I=K[l+1],B=K[u+1]-I,L=K[c+1]-I,3==W?(E=K[l+2],S=K[u+2],f=B*(R=K[c+2]-E)-(M=S-E)*L,_=M*O-T*R,m=T*L-B*O,f*=N=1/Math.sqrt(f*f+_*_+m*m),_*=N,m*=N):(E=0,S=0,M=0,R=0,f=0,_=0,m=T*L-B*O>0?1:-1),F=f*X.x+_*+X.y+m*X.z,!Y&&F<0||Y&&0!=F){if(k=-(f*w+_*I+m*E),a=-(f*H.x+_*H.y+m*H.z+k)/F,G=(h=(g=H.x+a*X.x)-w)*T+(p=(y=H.y+a*X.y)-I)*B+(d=(A=H.z+a*X.z)-E)*M,Q=h*O+p*L+d*R,v=1/((U=T*T+B*B+M*M)*(j=O*O+L*L+R*R)-(V=T*O+B*L+M*R)*V),!isFinite(v))continue;if(C=v*(-V*G+U*Q),(x=v*(j*G-V*Q))<0)continue;if(C<0)continue;if(!((b=1-x-C)<0)&&a>0&&a<e.rayEntryDistance){if(q=Z/3,e.rayEntryDistance=a,e.position=new P(g,y,A),e.normal=new P(f,_,m),this.uvs){var $=this.uvs.get(this.numVertices),tt=this.uvs.stride,et=z?z[Z]*tt:Z*tt,it=new P($[et],$[et+1]);et=z?z[Z+1]*tt:(Z+1)*tt;var nt=new P($[et],$[et+1]);et=z?z[Z+2]*tt:(Z+2)*tt;var rt=new P($[et],$[et+1]);e.uv=new D(b*it.x+x*nt.x+C*rt.x,b*it.y+x*nt.y+C*rt.y)}if(e.elementIndex=q,!n)return!0}}return q>=0},e.isIE=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g),e.assetType="[asset TriangleElements]",e}(Ns),js=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._vaoIsInvalid=!0,n._triangleElements=e,!n._triangleElements.isDynamic&&Vs&&i.context.hasVao&&(n._vao=i.context.createVao()),n}return i(e,t),e.prototype._onInvalidateIndices=function(e){t.prototype._onInvalidateIndices.call(this,e),this._vaoIsInvalid=!0},e.prototype._onInvalidateVertices=function(e){t.prototype._onInvalidateVertices.call(this,e),this._vaoIsInvalid=!0},e.prototype.onInvalidate=function(e){t.prototype.onInvalidate.call(this,e),this._vaoIsInvalid=!0},e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._triangleElements=null,this._vaoIsInvalid=!0,this._vao&&(this._vao.dispose(),this._vao=null)},e.prototype._setRenderState=function(e,i){this._vao&&this._vao.bind(),t.prototype._setRenderState.call(this,e,i),this._vao&&!this._vaoIsInvalid||(i.normalIndex>=0&&this._triangleElements.autoDeriveNormals&&this._triangleElements.normals,i.tangentIndex>=0&&this._triangleElements.autoDeriveTangents&&this._triangleElements.tangents,i.curvesIndex>=0&&this.activateVertexBufferVO(i.curvesIndex,this._triangleElements.getCustomAtributes("curves")),i.uvIndex>=0&&this.activateVertexBufferVO(i.uvIndex,this._triangleElements.uvs||this._triangleElements.positions),i.secondaryUVIndex>=0&&this.activateVertexBufferVO(i.secondaryUVIndex,this._triangleElements.getCustomAtributes("secondaryUVs")||this._triangleElements.uvs||this._triangleElements.positions),i.normalIndex>=0&&this.activateVertexBufferVO(i.normalIndex,this._triangleElements.normals),i.tangentIndex>=0&&this.activateVertexBufferVO(i.tangentIndex,this._triangleElements.tangents),i.jointIndexIndex>=0&&this.activateVertexBufferVO(i.jointIndexIndex,this._triangleElements.jointIndices),i.jointWeightIndex>=0&&this.activateVertexBufferVO(i.jointIndexIndex,this._triangleElements.jointWeights),this.activateVertexBufferVO(0,this._triangleElements.positions),this._vaoIsInvalid=!1)},e.prototype.draw=function(t,e,i,n){if(e.sceneMatrixIndex>=0)e.sceneMatrix.copyFrom(t.renderSceneTransform,!0),e.viewMatrix.copyFrom(e.view.viewMatrix3D,!0);else{var r=R.CALCULATION_MATRIX;r.copyFrom(t.renderSceneTransform),r.append(e.view.viewMatrix3D),e.viewMatrix.copyFrom(r,!0)}var o=this._stage.context;o.setProgramConstantsFromArray(Ut.VERTEX,e.vertexConstantData),o.setProgramConstantsFromArray(Ut.FRAGMENT,e.fragmentConstantData),this._indices?this.getIndexBufferGL().draw(Ft.TRIANGLES,3*n,3*i||this.numIndices):this._stage.context.drawVertices(Ft.TRIANGLES,n,i||this.numVertices),this._vao&&this._vao.unbind()},e.prototype._pGetOverflowElements=function(){return new e(this._triangleElements,this._stage)},e}(hr),Gs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._includeDependencies=function(t){},e.prototype._getVertexCode=function(t,e,i){var n="",r=t.globalPosDependencies>0?i.globalPositionVertex:i.animatedPosition,o=e.getFreeVertexConstant();if(e.getFreeVertexConstant(),e.getFreeVertexConstant(),e.getFreeVertexConstant(),t.viewMatrixIndex=4*o.index,t.projectionDependencies>0){i.projectionFragment=e.getFreeVarying();var s=e.getFreeVertexVectorTemp();n+="m44 "+s+", "+r+", "+o+"\nmov "+i.projectionFragment+", "+s+"\nmov op, "+s+"\n"}else n+="m44 op, "+r+", "+o+"\n";return n},e.prototype._getFragmentCode=function(t,e,i){return""},e}($n);Ir.registerElements(Gs,Us),Ji.registerAbstraction(js,Us);var Qs=function(){function t(){}return t.hitTest=function(t,e,i,n,r,o,s,a){void 0===a&&(a=0);var l,u,c,h,p,d,f,_,m=o.positions,g=m.stride,y=m.get(s,a);o.indices?(l=o.indices.get(s,a),y=m.get(m.count),u=s*o.indices.dimensions):(y=m.get(s,a),u=s);var A=o.hitTestCache[a]||(o.hitTestCache[a]=new Ls),v=A.lastCollisionIndex;if(-1!=v&&v<u){l?(c=l[v]*g,h=l[v+1]*g):(c=v*g,h=(v+1)*g),p=y[c],d=y[c+1],f=y[h];var b=p-t,x=d-e,C=(_=y[h+1])-d,w=-(f-p),I=Math.sqrt(C*C+w*w);if(!(Math.abs(b*C+x*w)>n*I))if(!((Q=b*w-x*C)>I*I||Q<0))return!0}if(u>150){var E=A.cells,S=E.length?A.divisions:A.divisions=Math.min(Math.ceil(Math.sqrt(u)),32),D=S/r.width,T=S/r.height,P=r.x,B=r.y;if(!E.length){E.length=S*S;for(var M=0;M<u;M+=3){l?(c=l[M]*g,h=l[M+1]*g):(c=M*g,h=(M+1)*g),p=y[c],d=y[c+1],f=y[h],_=y[h+1];for(var O=Math.floor((Math.min(p,f)-P)*D),L=Math.floor((Math.min(d,_)-B)*T),R=Math.floor((Math.max(p,f)-P)*D),N=Math.floor((Math.max(d,_)-B)*T),F=O;F<=R;F++)for(var k=L;k<=N;k++){var V,U=F+k*S;(V=E[U]||(E[U]=new Array)).push(M)}}}if(null==(V=E[Math.floor((t-P)*D)+Math.floor((e-B)*T)*S]))return A.lastCollisionIndex=-1,!1;for(var j=V.length,G=0;G<j;G++){M=V[G];l?(c=l[M]*g,h=l[M+1]*g):(c=M*g,h=(M+1)*g),p=y[c],d=y[c+1],f=y[h];b=p-t,x=d-e,C=(_=y[h+1])-d,w=-(f-p),I=Math.sqrt(C*C+w*w);if(!(Math.abs(b*C+x*w)>n*I))if(!((Q=b*w-x*C)>I*I||Q<0))return A.lastCollisionIndex=M,!0}return A.lastCollisionIndex=-1,!1}for(M=0;M<u;M+=6){l?(c=l[M]*g,h=l[M+1]*g):(c=M*g,h=(M+1)*g),p=y[c],d=y[c+1],f=y[h];var Q;b=p-t,x=d-e,C=(_=y[h+1])-d,w=-(f-p),I=Math.sqrt(C*C+w*w);if(!(Math.abs(b*C+x*w)>n*I))if(!((Q=b*w-x*C)>I*I||Q<0))return A.lastCollisionIndex=M,!0}return A.lastCollisionIndex=-1,!1},t.getBoxBounds=function(t,e,i,n,r,o,s,a){var l;void 0===a&&(a=0);var u,c,h=t.dimensions,p=t.stride,d=0,f=0,_=0,m=0;if(e?(c=s*e.dimensions,u=e.get(s,a),l=t.get(t.count)):(c=s,l=t.get(s,a)),0==c)return o;var g,y,A,v,b=0;i&&(v=i._rawData);for(b=0;b<c;b+=3)g=u?u[b]*p:b*p,i?6==h?(y=l[g]*v[0]+l[g+1]*v[4]+l[g+2]*v[8]+v[12],A=l[g]*v[1]+l[g+1]*v[5]+l[g+2]*v[9]+v[13],l[g]*v[2]+l[g+1]*v[6]+l[g+2]*v[10]+v[14]):(y=l[g]*v[0]+l[g+1]*v[4]+v[12],A=l[g]*v[1]+l[g+1]*v[5]+v[13]):(y=l[g],A=l[g+1],6==h?l[g+2]:0),0==b?(_=d=y,m=f=A):(y<d?d=y:y>_&&(_=y),A<f?f=A:A>m&&(m=A));var x=new B(d,f);return x.right=_,x.bottom=m,this.mergeThinkness(x,n,i),x.union(o,o||r)},t.mergeThinkness=function(t,e,i){var n,r=null===(n=i)||void 0===n?void 0:n._rawData,o=i?e.x*r[0]+e.y*r[4]:e.x,s=i?e.x*r[1]+e.y*r[5]:e.y;return t.x-=o,t.y-=s,t.right+=o,t.bottom+=s,t},t.getSphereBounds=function(t,e,i,n,r,o,s){void 0===s&&(s=0);for(var a,l,u,c,h=t.get(o,s),p=t.dimensions,d=t.stride,f=0,_=o*d,m=0;m<_;m+=d)f<(a=(l=h[m]-e.x)*l+(u=h[m+1]-e.y)*u+(c=6==p?h[m+2]-e.z:-e.z)*c)&&(f=a);return null==r&&(r=new L),r.x=e.x,r.y=e.y,r.z=e.z,r.radius=Math.sqrt(f),r},t}(),zs=(new B,function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i._thicknessScale=new P,i.hitTestCache=new Object,i._positions=new On(Float32Array,6,e),i}return i(e,t),e.prototype.getThicknessScale=function(t,e,i){return i||this.stroke.scaleMode!=Cs.HAIRLINE?(e?this._thicknessScale.copyFrom(e.transform.concatenatedMatrix3D.decompose()[3]):this._thicknessScale.identity(),this._thicknessScale.x*=t.focalLength*t.pixelRatio/1e3,this._thicknessScale.y*=t.focalLength/1e3,this.stroke&&this.stroke.scaleMode==Cs.NORMAL?(this._thicknessScale.x=!i||this.stroke.half_thickness*this._thicknessScale.x>.5?this.stroke.half_thickness:.5/this._thicknessScale.x,this._thicknessScale.y=!i||this.stroke.half_thickness*this._thicknessScale.y>.5?this.stroke.half_thickness:.5/this._thicknessScale.y):this.stroke&&this.stroke.scaleMode!=Cs.HAIRLINE||(this._thicknessScale.x=.5/this._thicknessScale.x,this._thicknessScale.y=.5/this._thicknessScale.y)):this._thicknessScale.identity(),this._thicknessScale},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colors",{get:function(){return this._colors||this.setColors(this._colors),this._colors},enumerable:!0,configurable:!0}),e.prototype.getBoxBounds=function(t,e,i,n,r,o,s,a){return void 0===e&&(e=null),void 0===i&&(i=!1),void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=0),void 0===a&&(a=0),s=s||this._numElements||this._numVertices,this._boundsRequests++,Qs.getBoxBounds(this.positions,this.indices,n,this.getThicknessScale(t,e,i),r,o,s,a)},e.prototype.getSphereBounds=function(t,e,i,n,r,o,s,a){return void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=0),void 0===a&&(a=0),Qs.getSphereBounds(this.positions,e,i,r,o,s||this._numVertices,a)},e.prototype.hitTestPoint=function(t,e,i,n,r,o,s,a,l,u){void 0===s&&(s=0),void 0===a&&(a=0);var c=this.getThicknessScale(t,e,!0),h=(c.x+c.y)/2;return Qs.hitTest(i,n,0,h,o,this,s||this._numElements||this._numVertices,a)},e.prototype.setPositions=function(t,e){if(void 0===e&&(e=0),t instanceof On)this.clearVertices(this._positions),this._positions=t;else if(t){for(var i=0,n=0,r=0,o=new Float32Array(4*t.length),s=new Uint16Array(t.length);i<t.length;)if(r/6&1?(o[r]=t[i+3],o[r+1]=t[i+4],o[r+2]=t[i+5],o[r+3]=t[i],o[r+4]=t[i+1],o[r+5]=t[i+2]):(o[r]=t[i],o[r+1]=t[i+1],o[r+2]=t[i+2],o[r+3]=t[i+3],o[r+4]=t[i+4],o[r+5]=t[i+5]),r+=6,4==++n){var a=r/6-4;s.set([a,a+1,a+2,a+3,a+2,a+1],i),n=0,i+=6}this._positions.set(o,4*e),this.setIndices(s,e)}else this.clearVertices(this._positions),this._positions=new On(Float32Array,6,this._concatenatedBuffer);this._numVertices=this._positions.count,this.invalidateVertices(this._positions),this._verticesDirty[this._positions.id]=!1},e.prototype.setThickness=function(t,e){if(void 0===e&&(e=0),t instanceof Rn)this._thickness=t;else if(t){this._thickness||(this._thickness=new Rn(this._concatenatedBuffer));for(var i=0,n=0,r=0,o=new Float32Array(4*t.length);i<t.length;)o[r]=1&Math.floor(.5*r+.5)?-t[i]:t[i],4==++n&&(n=0,i++),r++;this._thickness.set(o,4*e)}else this._thickness&&(this._thickness.dispose(),this._thickness=null);this.invalidateVertices(this._thickness),this._verticesDirty[this._thickness.id]=!1},e.prototype.setColors=function(t,e){if(void 0===e&&(e=0),t){if(t==this._colors)return;if(t instanceof Ln)this.clearVertices(this._colors),this._colors=t;else{this._colors||(this._colors=new Ln(this._concatenatedBuffer));for(var i=0,n=0,r=0,o=new Uint8Array(4*t.length);i<t.length;)r/4&1?(o[r]=t[i+4],o[r+1]=t[i+5],o[r+2]=t[i+6],o[r+3]=t[i+7]):(o[r]=t[i],o[r+1]=t[i+1],o[r+2]=t[i+2],o[r+3]=t[i+3]),4==++n&&(n=0,i+=8),r+=4;this._colors.set(o,4*e)}}else this._colors=cr.generateColors(this.indices,this._colors,this._concatenatedBuffer,this._numVertices);this.invalidateVertices(this._colors),this._verticesDirty[this._colors.id]=!1},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._positions.dispose(),this._positions=null,this._thickness&&(this._thickness.dispose(),this._thickness=null),this._colors&&(this._colors.dispose(),this._colors=null)},e.prototype.clone=function(){var t=new e(this._concatenatedBuffer?this._concatenatedBuffer.clone():null);return t.setIndices(this.indices.clone()),t.setPositions(this._positions.clone()),t.setThickness(this._thickness.clone()),t.setColors(this._colors.clone()),t},e.prototype.testCollision=function(t,e,i,n,r,o,s){void 0===s&&(s=0);var a=this.getThicknessScale(t,e.entity,!0),l=(a.x+a.y)/2,u=-e.rayPosition.z/e.rayDirection.z,c=new P(e.rayPosition.x+u*e.rayDirection.x,e.rayPosition.y+u*e.rayDirection.y);return!!Qs.hitTest(c.x,c.y,0,l,i,this,this._numElements,s)&&(e.rayEntryDistance=u,e.position=c,e.normal=new P(0,0,1),!0)},e.assetType="[asset LineElements]",e}(Ns)),Hs=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._scale=new P,n._thickness=1,n._lineElements=e,n}return i(e,t),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._lineElements=null},e.prototype._setRenderState=function(e,i){t.prototype._setRenderState.call(this,e,i);var n=i.view,r=e.renderGroup.getRenderElements(e.stageElements.elements);i.colorBufferIndex>=0&&this.activateVertexBufferVO(i.colorBufferIndex,this._lineElements.colors),this.activateVertexBufferVO(0,this._lineElements.positions,3),this.activateVertexBufferVO(r.secondaryPositionIndex,this._lineElements.positions,3,12),this.activateVertexBufferVO(r.thicknessIndex,this._lineElements.thickness),i.uvIndex>=0&&this.activateVertexBufferVO(i.uvIndex,this._lineElements.positions,2);var o=r.uOffsets,s=o.oConst01n1,a=o.oMisc,l=i.vertexConstantData;l[s+0]=0,l[s+1]=1,l[s+2]=-1,l[s+3]=-1,this._scale.copyFrom(e.sourceEntity.transform.concatenatedMatrix3D.decompose()[3]);var u=this._lineElements.stroke;u&&u.scaleMode==Cs.NORMAL?(l[a+0]=u.half_thickness*this._scale.x*this._thickness/1e3>.5/(n.focalLength*n.pixelRatio)?this._scale.x*this._thickness/1e3:.5/(u.half_thickness*n.focalLength*n.pixelRatio),l[a+1]=u.half_thickness*this._scale.y*this._thickness/1e3>.5/n.focalLength?this._scale.y*this._thickness/1e3:.5/(u.half_thickness*n.focalLength)):u&&u.scaleMode!=Cs.HAIRLINE?(l[a+0]=this._thickness/Math.min(n.width,n.height),l[a+1]=this._thickness/Math.min(n.width,n.height)):(l[a+0]=this._thickness/(n.focalLength*n.pixelRatio),l[a+1]=this._thickness/n.focalLength),l[a+2]=n.projection.near},e.prototype.draw=function(t,e,i,n){var r=this._stage.context;e.viewMatrix.copyFrom(e.view.frustumMatrix3D,!0);var o=R.CALCULATION_MATRIX;o.copyFrom(t.sourceEntity.transform.concatenatedMatrix3D),o.append(e.view.projection.transform.inverseConcatenatedMatrix3D),e.sceneMatrix.copyFrom(o,!0),r.setProgramConstantsFromArray(Ut.VERTEX,e.vertexConstantData),r.setProgramConstantsFromArray(Ut.FRAGMENT,e.fragmentConstantData),this._indices?this.getIndexBufferGL().draw(Ft.TRIANGLES,3*n,3*i||this.numIndices):this._stage.context.drawVertices(Ft.TRIANGLES,n,i||this.numVertices)},e.prototype._pGetOverflowElements=function(){return new e(this._lineElements,this._stage)},e}(hr),Xs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.secondaryPositionIndex=-1,e.thicknessIndex=-1,e.uOffsets={oConst01n1:0,oMisc:0},e}return i(e,t),e.prototype._includeDependencies=function(t){},e.prototype._getVertexCode=function(t,e,i){var n=t.globalPosDependencies>0?i.globalPositionVertex:i.animatedPosition,r=e.getFreeVertexAttribute();this.secondaryPositionIndex=r.index;var o=e.getFreeVertexAttribute();this.thicknessIndex=o.index;var s=e.getFreeVertexConstant();e.getFreeVertexConstant(),e.getFreeVertexConstant(),e.getFreeVertexConstant(),t.viewMatrixIndex=4*s.index;var a=e.getFreeVertexConstant();this.uOffsets.oConst01n1=4*a.index;var l=e.getFreeVertexConstant();this.uOffsets.oMisc=4*l.index;var u=e.getFreeVertexConstant();e.getFreeVertexConstant(),e.getFreeVertexConstant(),e.getFreeVertexConstant(),t.sceneMatrixIndex=4*u.index;var c=e.getFreeVertexVectorTemp();e.addVertexTempUsages(c,1);var h=e.getFreeVertexVectorTemp();e.addVertexTempUsages(h,1);var p=e.getFreeVertexVectorTemp();e.addVertexTempUsages(p,1);var d=e.getFreeVertexVectorTemp();e.addVertexTempUsages(d,1);var f=e.getFreeVertexVectorTemp();e.addVertexTempUsages(f,1);var _=e.getFreeVertexVectorTemp();e.addVertexTempUsages(_,1);var m="m44 "+c+", "+n+", "+u+"\nm44 "+h+", "+r+", "+u+"\nsub "+p+", "+h+", "+c+" \t\t\t\nslt "+d+".x, "+c+".z, "+l+".z\nsub "+d+".y, "+a+".y, "+d+".x\t\t\t\nadd "+_+".x, "+c+".z, "+l+".z\t\t\t\nsub "+_+".y, "+c+".z, "+h+".z\t\t\t\nseq "+_+".z, "+_+".y "+a+".x\nadd "+_+".y, "+_+".y, "+_+".z\ndiv "+_+".z, "+_+".x, "+_+".y\nmul "+_+".xyz, "+_+".zzz, "+p+".xyz\t\nadd "+f+".xyz, "+c+".xyz, "+_+".xyz\t\nmov "+f+".w, "+a+".y\t\t\t\nmul "+c+", "+c+", "+d+".yyyy\t\t\t\nmul "+f+", "+f+", "+d+".xxxx\t\t\t\nadd "+c+", "+c+", "+f+"\t\t\t\t\nnrm "+p+".xyz, "+p+".xyz\t\t\t\nnrm "+d+".xyz, "+c+".xyz\t\t\t\nmov "+d+".w, "+a+".y\t\t\t\t\ncrs "+f+".xyz, "+p+", "+d+"\t\t\t\nnrm "+f+".xyz, "+f+".xyz\t\t\t\nmul "+f+".xyz, "+f+".xyz, "+o+".xxx\t\nmov "+f+".w, "+a+".y\t\t\t\nmul "+_+".x, "+c+".z, "+a+".z\t\t\t\nmul "+f+".xyz, "+f+".xyz, "+_+".xxx\t\nmul "+f+".xyz, "+f+".xyz, "+l+".xy\t\nadd "+c+".xyz, "+c+".xyz, "+f+".xyz\t\nm44 op, "+c+", "+s+"\t\t\t\n";return e.removeVertexTempUsage(c),e.removeVertexTempUsage(h),e.removeVertexTempUsage(p),e.removeVertexTempUsage(d),e.removeVertexTempUsage(f),e.removeVertexTempUsage(_),m},e.prototype._getFragmentCode=function(t,e,i){return""},e}($n);Ir.registerElements(Xs,zs),Ji.registerAbstraction(Hs,zs);var qs=function(t){function e(e,i,n,r,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=0),void 0===o&&(o=0);var s=t.call(this)||this;return s.usages=0,s._onInvalidatePropertiesDelegate=function(t){return s._onInvalidateProperties(t)},s._onInvalidateVerticesDelegate=function(t){return s._onInvalidateVertices(t)},s._elements=e,s._elements.addEventListener(ur.INVALIDATE_VERTICES,s._onInvalidateVerticesDelegate),s._elements.usages++,s._material=i,s._style=n,s._style&&s._style.addEventListener(rr.INVALIDATE_PROPERTIES,s._onInvalidatePropertiesDelegate),s.count=r,s.offset=o,s}return i(e,t),e.getShape=function(t,i,n,r,o){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=0),void 0===o&&(o=0),e._pool.length){var s=e._pool.pop();return s.elements=t,s.material=i,s.style=n,s.count=r,s.offset=o,s}return new e(t,i,n,r,o)},e.clearPool=function(){e._pool=[]},Object.defineProperty(e.prototype,"elements",{get:function(){return this._elements},set:function(t){this._elements!=t&&(this._elements&&(this._elements.removeEventListener(ur.INVALIDATE_VERTICES,this._onInvalidateVerticesDelegate),this._elements.usages--,this._elements.usages||this._elements.dispose()),this._elements=t,this._elements&&(this._elements.addEventListener(ur.INVALIDATE_VERTICES,this._onInvalidateVerticesDelegate),this._elements.usages++),this.invalidateElements())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){this._material!=t&&(this._material=t,this.invalidateMaterial())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){this._style!=t&&(this._style&&this._style.removeEventListener(rr.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate),this._style=t,this._style&&this._style.addEventListener(rr.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate),this.invalidateStyle())},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){t.prototype.clear.call(this),this.usages=0,this.elements=null,this.material=null,this.style=null,this.particleCollection=null,e._pool.push(this)},e.prototype.invalidateElements=function(){this.dispatchEvent(new tr(tr.INVALIDATE_ELEMENTS,this))},e.prototype.invalidateMaterial=function(){this.dispatchEvent(new tr(tr.INVALIDATE_MATERIAL,this))},e.prototype.invalidateStyle=function(){this.dispatchEvent(new tr(tr.INVALIDATE_STYLE,this))},e.prototype._onInvalidateProperties=function(t){this.invalidateStyle()},e.prototype._onInvalidateVertices=function(t){t.attributesView==t.target.positions&&this.invalidate()},e.prototype.applyTransformation=function(t){this._elements.applyTransformation(t,this.count,this.offset)},e.prototype.scale=function(t){this._elements.scale(t,this.count,this.offset)},e.prototype.scaleUV=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1),this._elements.scaleUV(t,e,this.count,this.offset)},e._pool=new Array,e.assetType="[asset Shape]",e}(p),Ys=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.shape=e,n}return i(e,t),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this.shape=null},e.prototype._getStageElements=function(){return this._offset=this.shape.offset,this._count=this.shape.count,(this.sourceEntity.animator?this.sourceEntity.animator.getRenderableElements(this,this.shape.elements):this.shape.elements).getAbstraction(this._stage)},e.prototype._getRenderMaterial=function(){return(this._asset.material||this.sourceEntity.material||this.getDefaultMaterial()).getAbstraction(this.renderGroup.getRenderElements(this.shape.elements))},e.prototype._getStyle=function(){return this._asset.style||this.sourceEntity.style},e.prototype.getDefaultMaterial=function(){return this.stageElements.elements instanceof zs?er.getDefaultColorMaterial():er.getDefaultTextureMaterial()},e}(ir),Ks=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._orientedBoxBoundsDirty=!0,n._orientedSphereBoundsDirty=!0,n._onInvalidateElementsDelegate=function(t){return n._onInvalidateElements(t)},n._asset.addEventListener(tr.INVALIDATE_ELEMENTS,n._onInvalidateElementsDelegate),n}return i(e,t),e.prototype.onInvalidate=function(e){t.prototype.onInvalidate.call(this,e),this._orientedBoxBoundsDirty=!0,this._orientedSphereBoundsDirty=!0},e.prototype._onInvalidateElements=function(t){this._orientedBoxBoundsDirty=!0,this._orientedSphereBoundsDirty=!0},e.prototype.onClear=function(e){this._asset.removeEventListener(tr.INVALIDATE_ELEMENTS,this._onInvalidateElementsDelegate),t.prototype.onClear.call(this,e)},e.prototype.hitTestPoint=function(t,e,i){var n=this.getBoxBounds();return!(null==n||!n.contains(t,e,i))&&this._asset.elements.hitTestPoint(this._view,this.sourceEntity,t,e,i,n,this._asset.count,this._asset.offset)},e.prototype.getBoxBounds=function(t,e,i,n){return void 0===t&&(t=null),void 0===e&&(e=!0),void 0===i&&(i=null),void 0===n&&(n=null),t?this._asset.elements.getBoxBounds(this._view,this.sourceEntity,e,t,i,n,this._asset.count,this._asset.offset):(this._orientedBoxBoundsDirty&&(this._orientedBoxBoundsDirty=!1,this._orientedBoxBounds=this._asset.elements.getBoxBounds(this._view,this.sourceEntity,e,null,this._orientedBoxBounds,null,this._asset.count,this._asset.offset)),null!=this._orientedBoxBounds&&(n=this._orientedBoxBounds.union(n,n||i)),n)},e.prototype.getSphereBounds=function(t,e,i,n,r){return void 0===e&&(e=null),void 0===i&&(i=!0),void 0===n&&(n=null),void 0===r&&(r=null),e?this._asset.elements.getSphereBounds(this._view,t,e,i,n,r,this._asset.count,this._asset.offset):(this._orientedSphereBoundsDirty&&(this._orientedSphereBoundsDirty=!1,this._orientedSphereBounds=this._asset.elements.getSphereBounds(this._view,t,null,i,this._orientedSphereBounds,null,this._asset.count,this._asset.offset)),null!=this._orientedSphereBounds&&(r=this._orientedSphereBounds.union(r,r||n)),r)},e.prototype.testCollision=function(t,e){var i=this.getBoxBounds();return!(null==i||!i.rayIntersection(t.rayPosition,t.rayDirection))&&this._asset.elements.testCollision(this._view,t,i,e,this._asset.material||t.entity.material,this._asset.count||this._asset.elements.numVertices,this._asset.offset)},e}(ee);nr.registerRenderable(Ys,qs),te.registerPickable(Ks,qs);var Ws,Js,Zs=function(){function t(){this.availableRows=256,this.gradient_row=-1,this.color_row=255,this.color_position=256,this.availableGradients=256,this.availableColors=0,this.bitmap=new hn(256,256,!0,16711680),this.availableRows=256,this.availableColors=0}return t.clearAllMaterials=function(){for(var e in t._allColors)t._allColors[e].material=null;for(var e in t._allGradients)t._allGradients[e].material=null},t.getTextureForColor=function(e,i){var n=e.toString()+"#"+i.toString();if(t._allColors.hasOwnProperty(n))return t._allColors[n];var r,o=t._allTextureAtlas.length,s=0;for(s=0;s<o;s++)if(t._allTextureAtlas[s].fit_color()){r=t._allTextureAtlas[s];break}r||(r=new t,t._allTextureAtlas.push(r));var a={colorPos:r.draw_color(e,i),bitmap:r.bitmap,material:null,uvRectangle:null};return t._allColors[n]=a,a},t.getTextureForGradient=function(e){var i=e.toString();if(t._allGradients.hasOwnProperty(i))return e.uvRectangle=t._allGradients[i].uvRectangle,t._allGradients[i];var n,r=t._allTextureAtlas.length,o=0;for(o=0;o<r;o++)if(t._allTextureAtlas[o].fit_gradient()){n=t._allTextureAtlas[o];break}n||(n=new t,t._allTextureAtlas.push(n)),n.draw_gradient(e);var s={colorPos:null,bitmap:n.bitmap,material:null,uvRectangle:new Y};return s.uvRectangle.copyFrom(e.uvRectangle),t._allGradients[i]=s,s},t.prototype.fit_gradient=function(){return this.availableRows>0},t.prototype.fit_color=function(){return this.availableColors>0||this.availableRows>0},t.prototype.draw_gradient=function(t){if(!(this.availableRows<0)){var e;for(this.gradient_row++,this.availableRows--,e=0;e<256;e++)this.bitmap.setPixelFromArray(e,this.gradient_row,t.getColorAtPosition(e));return this.bitmap.invalidate(),t.uvRectangle.x=1/512,t.uvRectangle.y=1/512+this.gradient_row/256,t.uvRectangle.width=1-1/512,t.uvRectangle.height=t.uvRectangle.y,this.availableRows}console.log("error in TextureAtlasManager.draw_color")},t.prototype.draw_color=function(t,e){void 0===e&&(e=1),this.color_position--,this.color_position<0&&(this.availableRows>0?(this.color_row--,this.availableRows--,this.color_position=255):console.log("error in TextureAtlasManager.draw_color"));var i=w.float32ColorToARGB(t);return i[0]=e,this.bitmap.setPixelFromArray(this.color_position,this.color_row,i),this.bitmap.invalidate(),new D(1/512+this.color_position/256,1/512+this.color_row/256)},t._allTextureAtlas=[],t._allGradients={},t._allColors={},t}(),$s=function(){function t(){}return t._colorMaterials={},t._textureMaterials={},t._useTextureAtlasForColors=!0,t.get_material_for_color=function(e,i){var n;if(void 0===i&&(i=1),0==e&&(e=1),16744704==e&&(i=1),!t.materialClass)throw"no materialClass registered on MaterialManager!";if(t._useTextureAtlasForColors)return n=Zs.getTextureForColor(e,i),t._colorMaterials[n.bitmap.id]?(n.material=t._colorMaterials[n.bitmap.id],n):((r=new t.materialClass(n.bitmap)).alphaBlending=!0,r.useColorTransform=!0,r.bothSides=!0,t._colorMaterials[n.bitmap.id]=r,n.material=r,n);n={};var r,o=e+"_"+Math.round(100*i).toString();return t._colorMaterials[o]?(n.material=t._colorMaterials[o],n):((r=new t.materialClass(e,i)).alphaBlending=!0,r.useColorTransform=!0,r.bothSides=!0,n.material=r,t._colorMaterials[o]=r,n)},t.get_material_for_gradient=function(e){if(!t.materialClass)throw"no materialClass registered on MaterialManager!";var i=Zs.getTextureForGradient(e),n=i.bitmap.id.toString()+e.type.toString();if(t._textureMaterials[n])return i.material=t._textureMaterials[n],i;var r=new t.materialClass(i.bitmap);return r.useColorTransform=!0,r.alphaBlending=!0,r.bothSides=!0,t._textureMaterials[n]=r,i.material=r,i},t.get_material_for_BitmapImage2D=function(e){var i=new t.materialClass(e);return i.ambientMethod.texture=new t.textureClass(e),i.alphaBlending=!0,i.useColorTransform=!0,i.bothSides=!0,i},t}(),ta=function(){function t(){}return t.drawRectangles=function(t,e,i){if(!(t.length%4>0)){var n=[];n.length=t.length/4*12;var r=0,o=0,s=t.length,a=0,l=0,u=0,c=0;for(r=0;r<s;r+=4)a=t[r],l=t[r+1],u=t[r+2],c=t[r+3],n[o++]=a,n[o++]=l,n[o++]=a+u,n[o++]=l,n[o++]=a+u,n[o++]=l+c,n[o++]=a,n[o++]=l,n[o++]=a,n[o++]=l+c,n[o++]=a+u,n[o++]=l+c;var h=$s.get_material_for_color(e,i),p=h.material,d=new On(Float32Array,p.curves?3:2);d.set(n);var f=d.attributesBuffer.cloneBufferView();d.dispose();var _=new Us(f);_.setPositions(new Nn(f));var m=qs.getShape(_,p);if(h.colorPos){m.style=new or;var g=new Ze;p.animateUVs=!0,m.style.color=e,m.style.addSamplerAt(g,p.getTextureAt(0)),m.style.uvMatrix=new T(0,0,0,0,h.colorPos.x,h.colorPos.y)}return m}console.log("GraphicsFactoryHelper.drawRectangles: inputRectangles.length is not a multiple of 4",t)},t.updateRectanglesShape=function(t,e){var i=[];i.length=e.length/4*12;var n=0,r=0,o=e.length,s=0,a=0,l=0,u=0;for(n=0;n<o;n+=4)s=e[n],a=e[n+1],l=e[n+2],u=e[n+3],i[r++]=s,i[r++]=a,i[r++]=s+l,i[r++]=a,i[r++]=s+l,i[r++]=a+u,i[r++]=s,i[r++]=a,i[r++]=s,i[r++]=a+u,i[r++]=s+l,i[r++]=a+u;var c=t.elements;c.concatenatedBuffer.count=i.length/2,c.setPositions(i),c.invalidate()},t.isClockWiseXY=function(t,e,i,n,r,o){return!((t-i)*(o-n)-(e-n)*(r-i)<0)},t.getSign=function(t,e,i,n,r,o){return(t-r)*(n-o)-(e-o)*(i-r)},t.pointInTri=function(e,i,n,r,o,s,a,l){var u=t.getSign(e,i,a,l,n,r)>0,c=t.getSign(n,r,a,l,o,s)>0,h=t.getSign(o,s,a,l,e,i)>0;return u==c&&c==h},t.getControlXForCurveX=function(t,e,i){return e},t.getControlYForCurveY=function(t,e,i){return e},t.drawPoint=function(e,i,n,r){t.addTriangle(e-2,i-2,e+2,i-2,e+2,i+2,0,n,r),t.addTriangle(e-2,i-2,e-2,i+2,e+2,i+2,0,n,r)},t.drawElipse=function(e,i,n,r,o,s,a,l,u){for(var c=(a-s)/l,h=e+n*Math.cos(s*(Math.PI/180)),p=i+r*Math.sin(s*(Math.PI/180)),d=1;d<=c;d++){var f=e+n*Math.cos((s+d*l)*(Math.PI/180)),_=i+r*Math.sin((s+d*l)*(Math.PI/180));t.addTriangle(e,i,f,_,h,p,0,o,u),h=f,p=_}},t.drawElipseStrokes=function(e,i,n,r,o,s,a,l,u,c){for(var h=(a-s)/l,p=e+(n+u)*Math.cos(s*(Math.PI/180)),d=i+(r+u)*Math.sin(s*(Math.PI/180)),f=e+(n-u)*Math.cos(s*(Math.PI/180)),_=i+(r-u)*Math.sin(s*(Math.PI/180)),m=1;m<=h;m++){var g=e+(n+u)*Math.cos((s+m*l)*(Math.PI/180)),y=i+(r+u)*Math.sin((s+m*l)*(Math.PI/180)),A=e+(n-u)*Math.cos((s+m*l)*(Math.PI/180)),v=i+(r-u)*Math.sin((s+m*l)*(Math.PI/180));t.addTriangle(g,y,A,v,p,d,0,o,c),t.addTriangle(f,_,A,v,p,d,0,o,c),p=g,d=y,f=A,_=v}},t.addTriangle=function(e,i,n,r,o,s,a,l,u){var c=e,h=i,p=n,d=r,f=o,_=s;t.isClockWiseXY(c,h,p,d,f,_)&&(e=f,i=_,n=p,r=d,o=c,s=h);var m=l.length;0==a?(l[m++]=e,l[m++]=i,u&&(l[m++]=45736980577097704e-57),l[m++]=n,l[m++]=r,u&&(l[m++]=45736980577097704e-57),l[m++]=o,l[m++]=s,u&&(l[m++]=45736980577097704e-57)):a<0?(l[m++]=e,l[m++]=i,u&&(l[m++]=11708844992641982e-54),l[m++]=n,l[m++]=r,u&&(l[m++]=22778106537599901e-57),l[m++]=o,l[m++]=s,u&&(l[m++]=17796490496925177e-59)):a>0&&(l[m++]=e,l[m++]=i,u&&(l[m++]=11708846393940446e-54),l[m++]=n,l[m++]=r,u&&(l[m++]=22779507836064226e-57),l[m++]=o,l[m++]=s,u&&(l[m++]=1793662034335766e-58))},t.createCap=function(e,i,n,r,o,s,a,l,u,c,h,p,d,f){if(a*=c,l*=c,u==Ds.ROUND){var _=e+a*h,m=i+l*p,g=n+a*h,y=r+l*p,A=o+a*h,v=s+l*p;t.tesselateCurve(n,r,g,y,_,m,d,!0),t.tesselateCurve(_,m,A,v,o,s,d,!0),t.addTriangle(n,r,_,m,o,s,-1,d,f)}else if(u==Ds.SQUARE){g=n+a*h,y=r+l*p,A=o+a*h,v=s+l*p;t.addTriangle(A,v,g,y,n,r,0,d,f),t.addTriangle(A,v,n,r,o,s,0,d,f)}},t.getLineFormularData=function(t,e){var i=e.x-t.x,n=e.y-t.y,r=new D;return 0!=i&&0!=n&&(r.x=n/i),r.y=-(r.x*t.x-t.y),r},t.getQuadricBezierPosition=function(t,e,i,n){var r=1-t;return r*r*e+2*r*t*i+t*t*n},t.subdivideCurve=function(e,i,n,r,o,s,a,l,u,c,h,p,d,f){var _=Math.atan2(r-i,n-e)*M.RADIANS_TO_DEGREES,m=Math.atan2(s-r,o-n)*M.RADIANS_TO_DEGREES-_;if(m>180&&(m-=360),m<-180&&(m+=360),Math.abs(m)>=175)return d.push(e,i,n,r,o,s),void f.push(a,l,u,c,h,p);var g=!1;if(m<0?(g=t.getSign(e,i,u,c,o,s)>0,t.getSign(e,i,n,r,o,s)>0,g=((i-s)*(n-e)+(o-e)*(r-i))*((i-s)*(u-e)+(o-e)*(c-i))<0):(g=t.getSign(a,l,u,c,h,p)>0,t.getSign(a,l,n,r,h,p)>0,g=((l-s)*(n-a)+(h-a)*(r-l))*((l-p)*(u-a)+(h-a)*(c-l))<0),g)return d.push(e,i,n,r,o,s),void f.push(a,l,u,c,h,p);var y=e+.5*(n-e),A=i+.5*(r-i),v=n+.5*(o-n),b=r+.5*(s-r),x=y+.5*(v-y),C=A+.5*(b-A),w=a+.5*(u-a),I=l+.5*(c-l),E=u+.5*(h-u),S=c+.5*(p-c),D=w+.5*(E-w),T=I+.5*(S-I);t.subdivideCurve(e,i,y,A,x,C,a,l,w,I,D,T,d,f),t.subdivideCurve(x,C,v,b,o,s,D,T,E,S,h,p,d,f)},t.tesselateCurve=function(e,i,n,r,o,s,a,l,u){void 0===l&&(l=!1),void 0===u&&(u=0);if(u>=6)return l?void a.push(e,i,n,r,o,s):void a.push(n,r,o,s);for(var c=Math.atan2(r-i,n-e)*M.RADIANS_TO_DEGREES,h=Math.atan2(s-r,o-n)*M.RADIANS_TO_DEGREES-c;h>180;)h-=360;for(;h<-180;)h+=360;var p=o-e,d=s-i,f=Math.sqrt(p*p+d*d),_=e+.5*(n-e),m=i+.5*(r-i),g=n+.5*(o-n),y=r+.5*(s-r),A=_+.5*(g-_),v=m+.5*(y-m);Math.abs(h)<=1||f<1?l?a.push(e,i,A,v,o,s):a.push(o,s):(l&&a.push(e,i,A,v,o,s),u++,t.tesselateCurve(e,i,_,m,A,v,a,l,u),t.tesselateCurve(A,v,g,y,o,s,a,l,u))},t}();function ea(t,e){if(!t)throw e||"Assertion Failed!"}!function(t){t[t.ODD=0]="ODD",t[t.NONZERO=1]="NONZERO",t[t.POSITIVE=2]="POSITIVE",t[t.NEGATIVE=3]="NEGATIVE",t[t.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"}(Ws||(Ws={})),function(t){t[t.POLYGONS=0]="POLYGONS",t[t.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",t[t.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"}(Js||(Js={}));var ia=function(){function t(){}return t.vertEq=function(t,e){return t.s===e.s&&t.t===e.t},t.vertLeq=function(t,e){return t.s<e.s||t.s===e.s&&t.t<=e.t},t.transLeq=function(t,e){return t.t<e.t||t.t===e.t&&t.s<=e.s},t.edgeGoesLeft=function(e){return t.vertLeq(e.Dst,e.Org)},t.edgeGoesRight=function(e){return t.vertLeq(e.Org,e.Dst)},t.vertL1dist=function(t,e){return Math.abs(t.s-e.s)+Math.abs(t.t-e.t)},t.edgeEval=function(e,i,n){ea(t.vertLeq(e,i)&&t.vertLeq(i,n));var r=i.s-e.s,o=n.s-i.s;return r+o>0?r<o?i.t-e.t+(e.t-n.t)*(r/(r+o)):i.t-n.t+(n.t-e.t)*(o/(r+o)):0},t.edgeSign=function(e,i,n){ea(t.vertLeq(e,i)&&t.vertLeq(i,n));var r=i.s-e.s,o=n.s-i.s;return r+o>0?(i.t-n.t)*r+(i.t-e.t)*o:0},t.transEval=function(e,i,n){ea(t.transLeq(e,i)&&t.transLeq(i,n));var r=i.t-e.t,o=n.t-i.t;return r+o>0?r<o?i.s-e.s+(e.s-n.s)*(r/(r+o)):i.s-n.s+(n.s-e.s)*(o/(r+o)):0},t.transSign=function(e,i,n){ea(t.transLeq(e,i)&&t.transLeq(i,n));var r=i.t-e.t,o=n.t-i.t;return r+o>0?(i.s-n.s)*r+(i.s-e.s)*o:0},t.vertCCW=function(t,e,i){return t.s*(e.t-i.t)+e.s*(i.t-t.t)+i.s*(t.t-e.t)>=0},t.interpolate=function(t,e,i,n){return(t=t<0?0:t)<=(i=i<0?0:i)?0===i?(e+n)/2:e+t/(t+i)*(n-e):n+i/(t+i)*(e-n)},t.intersect=function(e,i,n,r,o){var s,a,l;t.vertLeq(e,i)||(l=e,e=i,i=l),t.vertLeq(n,r)||(l=n,n=r,r=l),t.vertLeq(e,n)||(l=e,e=n,n=l,l=i,i=r,r=l),t.vertLeq(n,i)?t.vertLeq(i,r)?((s=t.edgeEval(e,n,i))+(a=t.edgeEval(n,i,r))<0&&(s=-s,a=-a),o.s=t.interpolate(s,n.s,a,i.s)):((s=t.edgeSign(e,n,i))+(a=-t.edgeSign(e,r,i))<0&&(s=-s,a=-a),o.s=t.interpolate(s,n.s,a,r.s)):o.s=(n.s+i.s)/2,t.transLeq(e,i)||(l=e,e=i,i=l),t.transLeq(n,r)||(l=n,n=r,r=l),t.transLeq(e,n)||(l=e,e=n,n=l,l=i,i=r,r=l),t.transLeq(n,i)?t.transLeq(i,r)?((s=t.transEval(e,n,i))+(a=t.transEval(n,i,r))<0&&(s=-s,a=-a),o.t=t.interpolate(s,n.t,a,i.t)):((s=t.transSign(e,n,i))+(a=-t.transSign(e,r,i))<0&&(s=-s,a=-a),o.t=t.interpolate(s,n.t,a,r.t)):o.t=(n.t+i.t)/2},t}(),na=function(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1},ra=function(){function t(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(t.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),t}(),oa=function(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0},sa=function(){function t(){var t=new oa,e=new na,i=new ra(0),n=new ra(1);t.next=t.prev=t,t.anEdge=null,e.next=e.prev=e,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=t,this.fHead=e,this.eHead=i,this.eHeadSym=n}return t.prototype.makeEdge_=function(t){var e=new ra(0),i=new ra(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return i.next=n,n.Sym.next=e,e.next=t,t.Sym.next=i,e.Sym=i,e.Onext=e,e.Lnext=i,e.Org=null,e.Lface=null,e.winding=0,e.activeRegion=null,i.Sym=e,i.Onext=i,i.Lnext=e,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,e},t.prototype.splice_=function(t,e){var i=t.Onext,n=e.Onext;i.Sym.Lnext=e,n.Sym.Lnext=t,t.Onext=n,e.Onext=i},t.prototype.makeVertex_=function(t,e,i){var n=t;ea(n,"Vertex can't be null!");var r=i.prev;n.prev=r,r.next=n,n.next=i,i.prev=n,n.anEdge=e;var o=e;do{o.Org=n,o=o.Onext}while(o!==e)},t.prototype.makeFace_=function(t,e,i){var n=t;ea(n,"Face can't be null");var r=i.prev;n.prev=r,r.next=n,n.next=i,i.prev=n,n.anEdge=e,n.trail=null,n.marked=!1,n.inside=i.inside;var o=e;do{o.Lface=n,o=o.Lnext}while(o!==e)},t.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var e=t.next,i=t.Sym.next;e.Sym.next=i,i.Sym.next=e},t.prototype.killVertex_=function(t,e){var i=t.anEdge,n=i;do{n.Org=e,n=n.Onext}while(n!==i);var r=t.prev,o=t.next;o.prev=r,r.next=o},t.prototype.killFace_=function(t,e){var i=t.anEdge,n=i;do{n.Lface=e,n=n.Lnext}while(n!==i);var r=t.prev,o=t.next;o.prev=r,r.next=o},t.prototype.makeEdge=function(){var t=new oa,e=new oa,i=new na,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(e,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},t.prototype.splice=function(t,e){var i=!1,n=!1;if(t!==e){if(e.Org!==t.Org&&(n=!0,this.killVertex_(e.Org,t.Org)),e.Lface!==t.Lface&&(i=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(e,t),!n){var r=new oa;this.makeVertex_(r,e,t.Org),t.Org.anEdge=t}if(!i){var o=new na;this.makeFace_(o,e,t.Lface),t.Lface.anEdge=t}}},t.prototype.delete=function(t){var e=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var n=new na;this.makeFace_(n,t,t.Lface)}e.Onext===e?(this.killVertex_(e.Org,null),this.killFace_(e.Lface,null)):(t.Lface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev)),this.killEdge_(t)},t.prototype.addEdgeVertex=function(t){var e=this.makeEdge_(t),i=e.Sym;this.splice_(e,t.Lnext),e.Org=t.Dst;var n=new oa;return this.makeVertex_(n,i,e.Org),e.Lface=i.Lface=t.Lface,e},t.prototype.splitEdge=function(t){var e=this.addEdgeVertex(t).Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,e),t.Dst=e.Org,e.Dst.anEdge=e.Sym,e.Rface=t.Rface,e.winding=t.winding,e.Sym.winding=t.Sym.winding,e},t.prototype.connect=function(t,e){var i=!1,n=this.makeEdge_(t),r=n.Sym;if(e.Lface!==t.Lface&&(i=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(r,e),n.Org=t.Dst,r.Org=e.Org,n.Lface=r.Lface=t.Lface,t.Lface.anEdge=r,!i){var o=new na;this.makeFace_(o,n,t.Lface)}return n},t.prototype.zapFace=function(t){var e,i,n,r,o,s=t.anEdge;i=s.Lnext;do{i=(e=i).Lnext,e.Lface=null,null===e.Rface&&(e.Onext===e?this.killVertex_(e.Org,null):(e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev)),(n=e.Sym).Onext===n?this.killVertex_(n.Org,null):(n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(e))}while(e!=s);r=t.prev,(o=t.next).prev=r,r.next=o},t.prototype.countFaceVerts_=function(t){var e=t.anEdge,i=0;do{i++,e=e.Lnext}while(e!==t.anEdge);return i},t.prototype.mergeConvexFaces=function(t){var e,i,n,r,o;for(e=this.fHead.next;e!==this.fHead;e=e.next)if(e.inside)for(o=(i=e.anEdge).Org;n=i.Lnext,(r=i.Sym)&&r.Lface&&r.Lface.inside&&this.countFaceVerts_(e)+this.countFaceVerts_(r.Lface)-2<=t&&ia.vertCCW(i.Lprev.Org,i.Org,r.Lnext.Lnext.Org)&&ia.vertCCW(r.Lprev.Org,r.Org,i.Lnext.Lnext.Org)&&(n=r.Lnext,this.delete(r),i=null,r=null),!i||i.Lnext.Org!==o;)i=n;return!0},t.prototype.check=function(){var t,e,i,n,r,o,s=this.fHead,a=this.vHead,l=this.eHead;for(e=s,e=s;(t=e.next)!==s;e=t){ea(t.prev===e),r=t.anEdge;do{ea(r.Sym!==r),ea(r.Sym.Sym===r),ea(r.Lnext.Onext.Sym===r),ea(r.Onext.Sym.Lnext===r),ea(r.Lface===t),r=r.Lnext}while(r!==t.anEdge)}for(ea(t.prev===e&&null===t.anEdge),n=a,n=a;(i=n.next)!==a;n=i){ea(i.prev===n),r=i.anEdge;do{ea(r.Sym!==r),ea(r.Sym.Sym===r),ea(r.Lnext.Onext.Sym===r),ea(r.Onext.Sym.Lnext===r),ea(r.Org===i),r=r.Onext}while(r!==i.anEdge)}for(ea(i.prev===n&&null===i.anEdge),o=l,o=l;(r=o.next)!==l;o=r)ea(r.Sym.next===o.Sym),ea(r.Sym!==r),ea(r.Sym.Sym===r),ea(null!==r.Org),ea(null!==r.Dst),ea(r.Lnext.Onext.Sym===r),ea(r.Onext.Sym.Lnext===r);ea(r.Sym.next===o.Sym&&r.Sym===this.eHeadSym&&r.Sym.Sym===r&&null===r.Org&&null===r.Dst&&null===r.Lface&&null===r.Rface)},t}(),aa=function(){this.handle=null},la=function(){this.key=null,this.node=0},ua=function(){function t(t,e){this.leq=e,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var i=0;i<t+1;i++)this.nodes[i]=new aa,this.handles[i]=new la;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return t.prototype.floatDown_=function(t){var e,i,n,r=this.nodes,o=this.handles;for(e=r[t].handle;;){if((n=t<<1)<this.size&&this.leq(o[r[n+1].handle].key,o[r[n].handle].key)&&++n,ea(n<=this.max),i=r[n].handle,n>this.size||this.leq(o[e].key,o[i].key)){r[t].handle=e,o[e].node=t;break}r[t].handle=i,o[i].node=t,t=n}},t.prototype.floatUp_=function(t){var e,i,n,r=this.nodes,o=this.handles;for(e=r[t].handle;;){if(i=r[n=t>>1].handle,0===n||this.leq(o[i].key,o[e].key)){r[t].handle=e,o[e].node=t;break}r[t].handle=i,o[i].node=t,t=n}},t.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},t.prototype.min=function(){return this.handles[this.nodes[1].handle].key},t.prototype.insert=function(t){var e,i;if(2*(e=++this.size)>this.max){var n,r;for(this.max*=2,r=this.nodes.length,this.nodes.length=this.max+1,n=r;n<this.nodes.length;n++)this.nodes[n]=new aa;for(r=this.handles.length,this.handles.length=this.max+1,n=r;n<this.handles.length;n++)this.handles[n]=new la}return 0===this.freeList?i=e:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[e].handle=i,this.handles[i].node=e,this.handles[i].key=t,this.initialized&&this.floatUp_(e),i},t.prototype.extractMin=function(){var t=this.nodes,e=this.handles,i=t[1].handle,n=e[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,e[t[1].handle].node=1,e[i].key=null,e[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},t.prototype.delete=function(t){var e,i=this.nodes,n=this.handles;ea(t>=1&&t<=this.max&&null!==n[t].key),i[e=n[t].node].handle=i[this.size].handle,n[i[e].handle].node=e,--this.size,e<=this.size&&(e<=1||this.leq(n[i[e>>1].handle].key,n[i[e].handle].key)?this.floatDown_(e):this.floatUp_(e)),n[t].key=null,n[t].node=this.freeList,this.freeList=t},t}(),ca=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},ha=function(){this.key=null,this.next=null,this.prev=null},pa=function(){function t(t,e){this.frame=t,this.leq=e,this.head=new ha,this.head.next=this.head,this.head.prev=this.head}return t.prototype.min=function(){return this.head.next},t.prototype.max=function(){return this.head.prev},t.prototype.insert=function(t){return this.insertBefore(this.head,t)},t.prototype.search=function(t){var e=this.head;do{e=e.next}while(null!==e.key&&!this.leq(this.frame,t,e.key));return e},t.prototype.insertBefore=function(t,e){do{t=t.prev}while(null!==t.key&&!this.leq(this.frame,t.key,e));var i=new ha;return i.key=e,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},t.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},t}(),da=function(){function t(){}return t.regionBelow=function(t){return t.nodeUp.prev.key},t.regionAbove=function(t){return t.nodeUp.next.key},t.debugEvent=function(t){},t.addWinding=function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},t.edgeLeq=function(t,e,i){var n=t.event,r=e.eUp,o=i.eUp;return r.Dst===n?o.Dst===n?ia.vertLeq(r.Org,o.Org)?ia.edgeSign(o.Dst,r.Org,o.Org)<=0:ia.edgeSign(r.Dst,o.Org,r.Org)>=0:ia.edgeSign(o.Dst,n,o.Org)<=0:o.Dst===n?ia.edgeSign(r.Dst,n,r.Org)>=0:ia.edgeEval(r.Dst,n,r.Org)>=ia.edgeEval(o.Dst,n,o.Org)},t.deleteRegion=function(t,e){e.fixUpperEdge&&ea(0===e.eUp.winding),e.eUp.activeRegion=null,t.dict.delete(e.nodeUp)},t.fixUpperEdge=function(t,e,i){ea(e.fixUpperEdge),t.mesh.delete(e.eUp),e.fixUpperEdge=!1,e.eUp=i,i.activeRegion=e},t.topLeftRegion=function(e,i){var n,r=i.eUp.Org;do{i=t.regionAbove(i)}while(i.eUp.Org===r);if(i.fixUpperEdge){if(null===(n=e.mesh.connect(t.regionBelow(i).eUp.Sym,i.eUp.Lnext)))return null;t.fixUpperEdge(e,i,n),i=t.regionAbove(i)}return i},t.topRightRegion=function(e){var i=e.eUp.Dst;do{e=t.regionAbove(e)}while(e.eUp.Dst===i);return e},t.addRegionBelow=function(t,e,i){var n=new ca;return n.eUp=i,n.nodeUp=t.dict.insertBefore(e.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},t.isWindingInside=function(t,e){switch(t.windingRule){case Ws.ODD:return 0!=(1&e);case Ws.NONZERO:return 0!==e;case Ws.POSITIVE:return e>0;case Ws.NEGATIVE:return e<0;case Ws.ABS_GEQ_TWO:return e>=2||e<=-2}throw new Error("Invalid winding rulle")},t.computeWinding=function(e,i){i.windingNumber=t.regionAbove(i).windingNumber+i.eUp.winding,i.inside=t.isWindingInside(e,i.windingNumber)},t.finishRegion=function(e,i){var n=i.eUp,r=n.Lface;r.inside=i.inside,r.anEdge=n,t.deleteRegion(e,i)},t.finishLeftRegions=function(e,i,n){for(var r,o=null,s=i,a=i.eUp;s!==n;){if(s.fixUpperEdge=!1,(r=(o=t.regionBelow(s)).eUp).Org!=a.Org){if(!o.fixUpperEdge){t.finishRegion(e,s);break}r=e.mesh.connect(a.Lprev,r.Sym),t.fixUpperEdge(e,o,r)}a.Onext!==r&&(e.mesh.splice(r.Oprev,r),e.mesh.splice(a,r)),t.finishRegion(e,s),a=o.eUp,s=o}return a},t.addRightEdges=function(e,i,n,r,o,s){var a,l,u,c,h=!0;u=n;do{ea(ia.vertLeq(u.Org,u.Dst)),t.addRegionBelow(e,i,u.Sym),u=u.Onext}while(u!==r);for(null===o&&(o=t.regionBelow(i).eUp.Rprev),l=i,c=o;(u=(a=t.regionBelow(l)).eUp.Sym).Org===c.Org;)u.Onext!==c&&(e.mesh.splice(u.Oprev,u),e.mesh.splice(c.Oprev,u)),a.windingNumber=l.windingNumber-u.winding,a.inside=t.isWindingInside(e,a.windingNumber),l.dirty=!0,!h&&t.checkForRightSplice(e,l)&&(t.addWinding(u,c),t.deleteRegion(e,l),e.mesh.delete(c)),h=!1,l=a,c=u;l.dirty=!0,ea(l.windingNumber-u.winding===a.windingNumber),s&&t.walkDirtyRegions(e,l)},t.spliceMergeVertices=function(t,e,i){t.mesh.splice(e,i)},t.vertexWeights=function(t,e,i){var n=ia.vertL1dist(e,t),r=ia.vertL1dist(i,t),o=.5*r/(n+r),s=.5*n/(n+r);t.coords[0]+=o*e.coords[0]+s*i.coords[0],t.coords[1]+=o*e.coords[1]+s*i.coords[1],t.coords[2]+=o*e.coords[2]+s*i.coords[2]},t.getIntersectData=function(e,i,n,r,o,s){i.coords[0]=i.coords[1]=i.coords[2]=0,i.idx=-1,t.vertexWeights(i,n,r),t.vertexWeights(i,o,s)},t.checkForRightSplice=function(e,i){var n=t.regionBelow(i),r=i.eUp,o=n.eUp;if(ia.vertLeq(r.Org,o.Org)){if(ia.edgeSign(o.Dst,r.Org,o.Org)>0)return!1;ia.vertEq(r.Org,o.Org)?r.Org!==o.Org&&(e.pq.delete(r.Org.pqHandle),t.spliceMergeVertices(e,o.Oprev,r)):(e.mesh.splitEdge(o.Sym),e.mesh.splice(r,o.Oprev),i.dirty=n.dirty=!0)}else{if(ia.edgeSign(r.Dst,o.Org,r.Org)<0)return!1;t.regionAbove(i).dirty=i.dirty=!0,e.mesh.splitEdge(r.Sym),e.mesh.splice(o.Oprev,r)}return!0},t.checkForLeftSplice=function(e,i){var n,r=t.regionBelow(i),o=i.eUp,s=r.eUp;if(ea(!ia.vertEq(o.Dst,s.Dst)),ia.vertLeq(o.Dst,s.Dst)){if(ia.edgeSign(o.Dst,s.Dst,o.Org)<0)return!1;t.regionAbove(i).dirty=i.dirty=!0,n=e.mesh.splitEdge(o),e.mesh.splice(s.Sym,n),n.Lface.inside=i.inside}else{if(ia.edgeSign(s.Dst,o.Dst,s.Org)>0)return!1;i.dirty=r.dirty=!0,n=e.mesh.splitEdge(s),e.mesh.splice(o.Lnext,s.Sym),n.Rface.inside=i.inside}return!0},t.checkForIntersect=function(e,i){var n,r,o=t.regionBelow(i),s=i.eUp,a=o.eUp,l=s.Org,u=a.Org,c=s.Dst,h=a.Dst,p=new oa;if(ea(!ia.vertEq(h,c)),ea(ia.edgeSign(c,e.event,l)<=0),ea(ia.edgeSign(h,e.event,u)>=0),ea(l!==e.event&&u!==e.event),ea(!i.fixUpperEdge&&!o.fixUpperEdge),l===u)return!1;if(Math.min(l.t,c.t)>Math.max(u.t,h.t))return!1;if(ia.vertLeq(l,u)){if(ia.edgeSign(h,l,u)>0)return!1}else if(ia.edgeSign(c,u,l)<0)return!1;return t.debugEvent(e),ia.intersect(c,l,h,u,p),ea(Math.min(l.t,c.t)<=p.t),ea(p.t<=Math.max(u.t,h.t)),ea(Math.min(h.s,c.s)<=p.s),ea(p.s<=Math.max(u.s,l.s)),ia.vertLeq(p,e.event)&&(p.s=e.event.s,p.t=e.event.t),n=ia.vertLeq(l,u)?l:u,ia.vertLeq(n,p)&&(p.s=n.s,p.t=n.t),ia.vertEq(p,l)||ia.vertEq(p,u)?(t.checkForRightSplice(e,i),!1):!ia.vertEq(c,e.event)&&ia.edgeSign(c,e.event,p)>=0||!ia.vertEq(h,e.event)&&ia.edgeSign(h,e.event,p)<=0?h===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(a.Sym,s),i=t.topLeftRegion(e,i),s=t.regionBelow(i).eUp,t.finishLeftRegions(e,t.regionBelow(i),o),t.addRightEdges(e,i,s.Oprev,s,s,!0),!0):c===e.event?(e.mesh.splitEdge(a.Sym),e.mesh.splice(s.Lnext,a.Oprev),o=i,i=t.topRightRegion(i),r=t.regionBelow(i).eUp.Rprev,o.eUp=a.Oprev,a=t.finishLeftRegions(e,o,null),t.addRightEdges(e,i,a.Onext,s.Rprev,r,!0),!0):(ia.edgeSign(c,e.event,p)>=0&&(t.regionAbove(i).dirty=i.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),ia.edgeSign(h,e.event,p)<=0&&(i.dirty=o.dirty=!0,e.mesh.splitEdge(a.Sym),a.Org.s=e.event.s,a.Org.t=e.event.t),!1):(e.mesh.splitEdge(s.Sym),e.mesh.splitEdge(a.Sym),e.mesh.splice(a.Oprev,s),s.Org.s=p.s,s.Org.t=p.t,s.Org.pqHandle=e.pq.insert(s.Org),t.getIntersectData(e,s.Org,l,c,u,h),t.regionAbove(i).dirty=i.dirty=o.dirty=!0,!1)},t.walkDirtyRegions=function(e,i){for(var n,r,o=t.regionBelow(i);;){for(;o.dirty;)i=o,o=t.regionBelow(o);if(!i.dirty&&(o=i,null===(i=t.regionAbove(i))||!i.dirty))return;if(i.dirty=!1,n=i.eUp,r=o.eUp,n.Dst!==r.Dst&&t.checkForLeftSplice(e,i)&&(o.fixUpperEdge?(t.deleteRegion(e,o),e.mesh.delete(r),r=(o=t.regionBelow(i)).eUp):i.fixUpperEdge&&(t.deleteRegion(e,i),e.mesh.delete(n),n=(i=t.regionAbove(o)).eUp)),n.Org!==r.Org)if(n.Dst===r.Dst||i.fixUpperEdge||o.fixUpperEdge||n.Dst!==e.event&&r.Dst!==e.event)t.checkForRightSplice(e,i);else if(t.checkForIntersect(e,i))return;n.Org===r.Org&&n.Dst===r.Dst&&(t.addWinding(r,n),t.deleteRegion(e,i),e.mesh.delete(n),i=t.regionAbove(o))}},t.connectRightVertex=function(e,i,n){var r,o=n.Onext,s=t.regionBelow(i),a=i.eUp,l=s.eUp,u=!1;a.Dst!==l.Dst&&t.checkForIntersect(e,i),ia.vertEq(a.Org,e.event)&&(e.mesh.splice(o.Oprev,a),i=t.topLeftRegion(e,i),o=t.regionBelow(i).eUp,t.finishLeftRegions(e,t.regionBelow(i),s),u=!0),ia.vertEq(l.Org,e.event)&&(e.mesh.splice(n,l.Oprev),n=t.finishLeftRegions(e,s,null),u=!0),u?t.addRightEdges(e,i,n.Onext,o,o,!0):(r=ia.vertLeq(l.Org,a.Org)?l.Oprev:a,r=e.mesh.connect(n.Lprev,r),t.addRightEdges(e,i,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,t.walkDirtyRegions(e,i))},t.connectLeftDegenerate=function(e,i,n){var r,o,s,a,l;return r=i.eUp,ia.vertEq(r.Org,n)?(ea(!1),void t.spliceMergeVertices(e,r,n.anEdge)):ia.vertEq(r.Dst,n)?(ea(!1),i=t.topRightRegion(i),o=a=(s=(l=t.regionBelow(i)).eUp.Sym).Onext,l.fixUpperEdge&&(ea(o!==s),t.deleteRegion(e,l),e.mesh.delete(s),s=o.Oprev),e.mesh.splice(n.anEdge,s),ia.edgeGoesLeft(o)||(o=null),void t.addRightEdges(e,i,s.Onext,a,o,!0)):(e.mesh.splitEdge(r.Sym),i.fixUpperEdge&&(e.mesh.delete(r.Onext),i.fixUpperEdge=!1),e.mesh.splice(n.anEdge,r),void t.sweepEvent(e,n))},t.connectLeftVertex=function(e,i){var n,r,o,s,a,l,u=new ca;if(u.eUp=i.anEdge.Sym,n=e.dict.search(u).key,r=t.regionBelow(n))if(s=n.eUp,a=r.eUp,0!==ia.edgeSign(s.Dst,i,s.Org))if(o=ia.vertLeq(a.Dst,s.Dst)?n:r,n.inside||o.fixUpperEdge){if(o===n)l=e.mesh.connect(i.anEdge.Sym,s.Lnext);else l=e.mesh.connect(a.Dnext,i.anEdge).Sym;o.fixUpperEdge?t.fixUpperEdge(e,o,l):t.computeWinding(e,t.addRegionBelow(e,n,l)),t.sweepEvent(e,i)}else t.addRightEdges(e,n,i.anEdge,i.anEdge,null,!0);else t.connectLeftDegenerate(e,n,i)},t.sweepEvent=function(e,i){e.event=i,t.debugEvent(e);for(var n=i.anEdge;null===n.activeRegion;)if((n=n.Onext)===i.anEdge)return void t.connectLeftVertex(e,i);var r=t.topLeftRegion(e,n.activeRegion);ea(null!==r);var o=t.regionBelow(r),s=o.eUp,a=t.finishLeftRegions(e,o,null);a.Onext===s?t.connectRightVertex(e,r,a):t.addRightEdges(e,r,a.Onext,s,s,!0)},t.addSentinel=function(t,e,i,n){var r=new ca,o=t.mesh.makeEdge();o.Org.s=i,o.Org.t=n,o.Dst.s=e,o.Dst.t=n,t.event=o.Dst,r.eUp=o,r.windingNumber=0,r.inside=!1,r.fixUpperEdge=!1,r.sentinel=!0,r.dirty=!1,r.nodeUp=t.dict.insert(r)},t.initEdgeDict=function(e){e.dict=new pa(e,t.edgeLeq);var i=e.bmax[0]-e.bmin[0],n=e.bmax[1]-e.bmin[1],r=e.bmin[0]-i,o=e.bmax[0]+i,s=e.bmin[1]-n,a=e.bmax[1]+n;t.addSentinel(e,r,o,s),t.addSentinel(e,r,o,a)},t.doneEdgeDict=function(e){for(var i,n=0;null!==(i=e.dict.min().key);)i.sentinel||(ea(i.fixUpperEdge),ea(1==++n)),ea(0===i.windingNumber),t.deleteRegion(e,i)},t.removeDegenerateEdges=function(e){var i,n,r,o=e.mesh.eHead;for(i=o.next;i!==o;i=n)n=i.next,r=i.Lnext,ia.vertEq(i.Org,i.Dst)&&i.Lnext.Lnext!==i&&(t.spliceMergeVertices(e,r,i),e.mesh.delete(i),r=(i=r).Lnext),r.Lnext===i&&(r!==i&&(r!==n&&r!==n.Sym||(n=n.next),e.mesh.delete(r)),i!==n&&i!==n.Sym||(n=n.next),e.mesh.delete(i))},t.initPriorityQ=function(t){var e,i,n,r=0;for(i=(n=t.mesh.vHead).next;i!==n;i=i.next)r++;for(r+=8,e=t.pq=new ua(r,ia.vertLeq),i=(n=t.mesh.vHead).next;i!==n;i=i.next)i.pqHandle=e.insert(i);return i===n&&(e.init(),!0)},t.donePriorityQ=function(t){t.pq=null},t.removeDegenerateFaces=function(e,i){var n,r,o;for(n=i.fHead.next;n!==i.fHead;n=r)r=n.next,ea((o=n.anEdge).Lnext!==o),o.Lnext.Lnext===o&&(t.addWinding(o.Onext,o),e.mesh.delete(o));return!0},t.computeInterior=function(e,i){var n,r;if(void 0===i&&(i=!0),t.removeDegenerateEdges(e),!t.initPriorityQ(e))return!1;for(t.initEdgeDict(e);null!==(n=e.pq.extractMin());){for(;null!==(r=e.pq.min())&&ia.vertEq(r,n);)r=e.pq.extractMin(),t.spliceMergeVertices(e,n.anEdge,r.anEdge);t.sweepEvent(e,n)}return e.event=e.dict.min().key.eUp.Org,t.debugEvent(e),t.doneEdgeDict(e),t.donePriorityQ(e),!!t.removeDegenerateFaces(e,e.mesh)&&(i&&e.mesh.check(),!0)},t}(),fa=function(){function t(){this.mesh=new sa,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Ws.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return t.prototype.dot_=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.prototype.normalize_=function(t){var e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!e)throw"Zero-size vector!";e=Math.sqrt(e),t[0]/=e,t[1]/=e,t[2]/=e},t.prototype.longAxis_=function(t){var e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e},t.prototype.computeNormal_=function(t){var e,i,n,r,o,s,a=[0,0,0],l=[0,0,0],u=[0,0,0],c=[0,0,0],h=[0,0,0],p=[null,null,null],d=[null,null,null],f=this.mesh.vHead;e=f.next;for(var _=0;_<3;++_)r=e.coords[_],l[_]=r,d[_]=e,a[_]=r,p[_]=e;for(e=f.next;e!==f;e=e.next)for(var m=0;m<3;++m)(r=e.coords[m])<l[m]&&(l[m]=r,d[m]=e),r>a[m]&&(a[m]=r,p[m]=e);var g=0;if(a[1]-l[1]>a[0]-l[0]&&(g=1),a[2]-l[2]>a[g]-l[g]&&(g=2),l[g]>=a[g])return t[0]=0,t[1]=0,void(t[2]=1);for(s=0,i=d[g],n=p[g],u[0]=i.coords[0]-n.coords[0],u[1]=i.coords[1]-n.coords[1],u[2]=i.coords[2]-n.coords[2],e=f.next;e!==f;e=e.next)c[0]=e.coords[0]-n.coords[0],c[1]=e.coords[1]-n.coords[1],c[2]=e.coords[2]-n.coords[2],h[0]=u[1]*c[2]-u[2]*c[1],h[1]=u[2]*c[0]-u[0]*c[2],h[2]=u[0]*c[1]-u[1]*c[0],(o=h[0]*h[0]+h[1]*h[1]+h[2]*h[2])>s&&(s=o,t[0]=h[0],t[1]=h[1],t[2]=h[2]);s<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(u)]=1)},t.prototype.checkOrientation_=function(){for(var t,e,i=this.mesh.fHead,n=this.mesh.vHead,r=0,o=i.next;o!==i;o=o.next)if(!((e=o.anEdge).winding<=0))do{r+=(e.Org.s-e.Dst.s)*(e.Org.t+e.Dst.t),e=e.Lnext}while(e!==o.anEdge);if(r<0){for(t=n.next;t!==n;t=t.next)t.t=-t.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},t.prototype.projectPolygon_=function(){var t,e,i=this.mesh.vHead,n=[0,0,0],r=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],n[0]||n[1]||n[2]||(this.computeNormal_(n),r=!0),t=this.sUnit,e=this.tUnit;var o=this.longAxis_(n);t[o]=0,t[(o+1)%3]=1,t[(o+2)%3]=0,e[o]=0,e[(o+1)%3]=0,e[(o+2)%3]=n[o]>0?1:-1;for(var s=i.next;s!==i;s=s.next)s.s=this.dot_(s.coords,t),s.t=this.dot_(s.coords,e);r&&this.checkOrientation_();for(var a=!0,l=i.next;l!==i;l=l.next)a?(this.bmin[0]=this.bmax[0]=l.s,this.bmin[1]=this.bmax[1]=l.t,a=!1):(l.s<this.bmin[0]&&(this.bmin[0]=l.s),l.s>this.bmax[0]&&(this.bmax[0]=l.s),l.t<this.bmin[1]&&(this.bmin[1]=l.t),l.t>this.bmax[1]&&(this.bmax[1]=l.t))},t.prototype.addWinding_=function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},t.prototype.tessellateMonoRegion_=function(t,e){var i,n;if((i=e.anEdge).Lnext===i||i.Lnext.Lnext===i)throw"Mono region invalid";for(;ia.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;ia.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(;i.Lnext!==n;)if(ia.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(ia.edgeGoesLeft(n.Lnext)||ia.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)n=t.connect(n.Lnext,n).Sym;n=n.Lprev}else{for(;n.Lnext!==i&&(ia.edgeGoesRight(i.Lprev)||ia.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)i=t.connect(i,i.Lprev).Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)n=t.connect(n.Lnext,n).Sym;return!0},t.prototype.tessellateInterior_=function(t){for(var e,i=t.fHead.next;i!==t.fHead;i=e)if(e=i.next,i.inside&&!this.tessellateMonoRegion_(t,i))return!1;return!0},t.prototype.discardExterior_=function(t){for(var e,i=t.fHead.next;i!==t.fHead;i=e)e=i.next,i.inside||t.zapFace(i)},t.prototype.setWindingNumber_=function(t,e,i){for(var n,r=t.eHead.next;r!==t.eHead;r=n)n=r.next,r.Rface.inside!==r.Lface.inside?r.winding=r.Lface.inside?e:-e:i?t.delete(r):r.winding=0},t.prototype.getNeighbourFace_=function(t){return t.Rface&&t.Rface.inside?t.Rface.n:-1},t.prototype.outputPolymesh_=function(t,e,i,n){var r,o,s=0,a=0;i>3&&t.mergeConvexFaces(i);for(var l=t.vHead.next;l!==t.vHead;l=l.next)l.n=-1;for(var u=t.fHead.next;u!==t.fHead;u=u.next)if(u.n=-1,u.inside){r=u.anEdge,o=0;do{-1===(l=r.Org).n&&(l.n=a,a++),o++,r=r.Lnext}while(r!==u.anEdge);if(o>i)throw"Face vertex greater that support polygon";u.n=s,++s}this.elementCount=s,e===Js.CONNECTED_POLYGONS&&(s*=2),this.elements=[],this.elements.length=s*i,this.vertexCount=a,this.vertices=[],this.vertices.length=a*n,this.vertexIndices=[],this.vertexIndices.length=a;for(l=t.vHead.next;l!==t.vHead;l=l.next)if(-1!==l.n){var c=l.n*n;this.vertices[c+0]=l.coords[0],this.vertices[c+1]=l.coords[1],n>2&&(this.vertices[c+2]=l.coords[2]),this.vertexIndices[l.n]=l.idx}var h=0;for(u=t.fHead.next;u!==t.fHead;u=u.next)if(u.inside){r=u.anEdge,o=0;do{l=r.Org;this.elements[h++]=l.n,o++,r=r.Lnext}while(r!==u.anEdge);for(var p=o;p<i;++p)this.elements[h++]=-1;if(e===Js.CONNECTED_POLYGONS){r=u.anEdge;do{this.elements[h++]=this.getNeighbourFace_(r),r=r.Lnext}while(r!==u.anEdge);for(var d=o;d<i;++d)this.elements[h++]=-1}}},t.prototype.outputContours_=function(t,e){var i,n,r=0,o=0;this.vertexCount=0,this.elementCount=0;for(var s=t.fHead.next;s!==t.fHead;s=s.next)if(s.inside){n=i=s.anEdge;do{this.vertexCount++,i=i.Lnext}while(i!==n);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*e,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var a=0,l=0,u=0;r=0;for(s=t.fHead.next;s!==t.fHead;s=s.next)if(s.inside){o=0,n=i=s.anEdge;do{this.vertices[a++]=i.Org.coords[0],this.vertices[a++]=i.Org.coords[1],e>2&&(this.vertices[a++]=i.Org.coords[2]),this.vertexIndices[l++]=i.Org.idx,o++,i=i.Lnext}while(i!==n);this.elements[u++]=r,this.elements[u++]=o,r+=o}},t.prototype.addContour=function(t,e){null===this.mesh&&(this.mesh=new sa),t<2&&(t=2),t>3&&(t=3);for(var i=null,n=0;n<e.length;n+=t)null===i?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=e[n+0],i.Org.coords[1]=e[n+1],i.Org.coords[2]=t>2?e[n+2]:0,i.Org.idx=this.vertexIndexCounter++,i.winding=1,i.Sym.winding=-1},t.prototype.tesselate=function(t,e,i,n,r,o){if(void 0===t&&(t=Ws.ODD),void 0===e&&(e=Js.POLYGONS),void 0===o&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,r&&(this.normal[0]=r[0],this.normal[1]=r[1],this.normal[2]=r[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),da.computeInterior(this,o);var s=this.mesh;return e===Js.BOUNDARY_CONTOURS?this.setWindingNumber_(s,1,!0):this.tessellateInterior_(s),o&&s.check(),e===Js.BOUNDARY_CONTOURS?this.outputContours_(s,n):this.outputPolymesh_(s,e,i,n),!0},t}();var _a,ma=Ws.ODD,ga=(Ws.NONZERO,Ws.POSITIVE,Ws.NEGATIVE,Ws.ABS_GEQ_TWO,Js.POLYGONS),ya=(Js.CONNECTED_POLYGONS,Js.BOUNDARY_CONTOURS,_a="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(t){var e,i,n;t=t||{},e||(e=void 0!==t?t:{}),e.ready=new Promise((function(t,e){i=t,n=e}));var r,o,s,a,l,u,c,h,p,d=e;function f(t,e,i){if(!e||0>e)throw"Size should be a greater 0";if(!t)throw"Invalid pointer!";return(e=new(i=i||Uint8Array)(d.HEAP8.buffer,t,e)).F=t,e.I=function(){d._free(t)},e}var _=d.Tess=function(){if(!r){var t=d.cwrap;r=t("tessNewTess","number",["number"]),o=t("tessDeleteTess",null,["number"]),s=t("tessAddContour","number",["number","number","number","number","number"]),a=t("tessTesselate","number","number number number number number number".split(" ")),l=t("tessGetVertexCount","number",["number"]),u=t("tessGetVertices","number",["number"]),c=t("tessGetElementCount","number",["number"]),h=t("tessGetElements","number",["number"]),p=t("tessGetVertexIndices","number",["number"])}if(this.F=r(0),this.G=[],!this.F)throw"Unknown error, tesselator wasn't init!"};Object.assign(_.prototype,{dispose:function(){this.F&&(o(this.F),this.G.forEach((function(t){t.I&&t.I()})),this.G=[],this.F=0)},addContours:function(t,e){if(!this.F)throw"Tessealtor wasn't be inited!";e=e||2;var i=this.G=[];"number"==typeof t[0]&&(t=[t]);for(var n=0;n<t.length;n++){var r=t[n],o=r.length,a=Float32Array,l=d._malloc(o*a.BYTES_PER_ELEMENT);if(!l)throw"Can't allocate a "+o;(o=f(l,o,a)).set(r,0),i.push(o),s(this.F,e,o.F,e*Float32Array.BYTES_PER_ELEMENT,r.length/e)}},tesselate:function(t){if(0===this.G.length)throw"Contours data is required!";if(t=Object.assign({windingRule:0,elementType:0,polySize:3,vertexSize:2,fillVertexIndices:!1},t||{}),!a(this.F,0|t.windingRule||0,0|t.elementType||0,0|t.polySize||3,0|t.vertexSize||2,0))return null;var e=l(this.F),i=c(this.F),n={elementCount:i,vertexCount:e};return n.vertices=f(u(this.F),e*t.vertexSize,Float32Array),n.elements=f(h(this.F),i*t.polySize,Uint32Array),t.fillVertexIndices&&(n.vertexIndices=f(p(this.F),e,Uint32Array)),n}});var m,g={};for(m in e)e.hasOwnProperty(m)&&(g[m]=e[m]);var y="";"undefined"!=typeof document&&document.currentScript&&(y=document.currentScript.src),_a&&(y=_a),y=0!==y.indexOf("blob:")?y.substr(0,y.lastIndexOf("/")+1):"";var A=e.printErr||console.warn.bind(console);for(m in g)g.hasOwnProperty(m)&&(e[m]=g[m]);g=null;var v,b=0;e.wasmBinary&&(v=e.wasmBinary),e.noExitRuntime&&e.noExitRuntime,"object"!=typeof WebAssembly&&U("no native wasm support detected");var x,C=!1;function w(t){var i=e["_"+t];return i||U("Assertion failed: Cannot call unknown function "+t+", make sure it is exported"),i}function I(t,e,i,n){var r,o={string:function(t){var e=0;if(null!=t&&0!==t){var i=1+(t.length<<2),n=e=Z(i),r=D;if(0<i){i=n+i-1;for(var o=0;o<t.length;++o){var s=t.charCodeAt(o);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&t.charCodeAt(++o)),127>=s){if(n>=i)break;r[n++]=s}else{if(2047>=s){if(n+1>=i)break;r[n++]=192|s>>6}else{if(65535>=s){if(n+2>=i)break;r[n++]=224|s>>12}else{if(n+3>=i)break;r[n++]=240|s>>18,r[n++]=128|s>>12&63}r[n++]=128|s>>6&63}r[n++]=128|63&s}}r[n]=0}}return e},array:function(t){var e=Z(t.length);return S.set(t,e),e}},s=w(t),a=[];if(t=0,n)for(var l=0;l<n.length;l++){var u=o[i[l]];u?(0===t&&(t=W()),a[l]=u(n[l])):a[l]=n[l]}return i=s.apply(null,a),r=i,i="string"===e?P(r):"boolean"===e?!!r:r,0!==t&&J(t),i}var E,S,D,T="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function P(t){if(t){for(var e=D,i=t+NaN,n=t;e[n]&&!(n>=i);)++n;if(16<n-t&&e.subarray&&T)t=T.decode(e.subarray(t,n));else{for(i="";t<n;){var r=e[t++];if(128&r){var o=63&e[t++];if(192==(224&r))i+=String.fromCharCode((31&r)<<6|o);else{var s=63&e[t++];65536>(r=224==(240&r)?(15&r)<<12|o<<6|s:(7&r)<<18|o<<12|s<<6|63&e[t++])?i+=String.fromCharCode(r):(r-=65536,i+=String.fromCharCode(55296|r>>10,56320|1023&r))}}else i+=String.fromCharCode(r)}t=i}}else t="";return t}function B(){var t=x.buffer;E=t,e.HEAP8=S=new Int8Array(t),e.HEAP16=new Int16Array(t),e.HEAP32=new Int32Array(t),e.HEAPU8=D=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAPU32=new Uint32Array(t),e.HEAPF32=new Float32Array(t),e.HEAPF64=new Float64Array(t)}var M,O=[],L=[],R=[],N=[];function F(){var t=e.preRun.shift();O.unshift(t)}var k=0,V=null;function U(t){throw e.onAbort&&e.onAbort(t),A(t),C=!0,t=new WebAssembly.RuntimeError("abort("+t+"). Build with -s ASSERTIONS=1 for more info."),n(t),t}function j(t){return String.prototype.startsWith?t.startsWith("data:application/octet-stream;base64,"):0===t.indexOf("data:application/octet-stream;base64,")}e.preloadedImages={},e.preloadedAudios={};var G="data:application/octet-stream;base64,AGFzbQEAAAABYQ9gAn9/AX9gAn9/AGADf39/AX9gAX8Bf2ABfwBgA39/fwBgBX9/f39/AGAEf39/fwBgBn9/f39/fwBgAAF/YAR/f39/AX9gA39/fwF9YAAAYAR/fX19AGAGf39/f39/AX8CSQwBYQFhAAcBYQFiAAQBYQFjAAkBYQFkAAEBYQFlAAUBYQFmAAEBYQFnAAIBYQFoAAcBYQFpAAgBYQFqAAABYQFrAAIBYQFsAAMDSUgLAgADAgACAwgEAwIECgEBAAIAAwEDDAsBAAoEAQANAgQBAgMECQAFAAEAAwMDAwMOBgUGBAMBAgAAAAUCAwEDAAABAgADAAYEBQFwAQ8PBQcBAYACgIACBgkBfwFBwJrAAgsHSRIBbQIAAW4BAAFvACIBcAAWAXEAFQFyAEEBcwBAAXQAPQF1ADwBdgA7AXcAOgF4ADkBeQA4AXoANwFBADEBQgAwAUMALwFEADUJFAEAQQELDjJIJ0kDDkUsPz4tRENCCsqjAkihAQEEfQJAIAAqAhgiBCABKgIYIgNdRQRAIAMgBFwNASAAKgIcIAEqAhxfQQFzDQELIAMgAioCGCIFXUUEQCADIAVcDQEgASoCHCACKgIcX0UNAQsgAyAEkyIEIAUgA5MiA5JDAAAAAF5BAXMEfUMAAAAABSAEIAEqAhwiBCACKgIck5QgAyAEIAAqAhyTlJILDwtBhQhBqAhB0gBBvwgQAAAL6QMBBn8CQCABIAJGDQAgAigCECIEIAEoAhAiB0cEQCAEKAIIIgUhAwNAIAMgBzYCECADKAIIIgMgBUcNAAsgBCgCACIDIAQoAgQiBTYCBCAFIAM2AgAgBCAAKAKIASIDKAIANgIAIAMgBDYCAAsgAigCFCIFIAEoAhQiCEcEQCAFKAIIIgYhAwNAIAMgCDYCFCADKAIMIgMgBkcNAAsgBSgCACIDIAUoAgQiBjYCBCAGIAM2AgAgBSAAKAKMASIDKAIANgIAIAMgBTYCAAsgASgCCCEDIAIoAggiBigCBCABNgIMIAMoAgQgAjYCDCACIAM2AgggASAGNgIIIAQgB0YEQCAAKAKIARAPIgRFBEBBAA8LIAQgASgCECIDKAIEIgc2AgQgByAENgIAIAQgAzYCACADIAQ2AgQgBCACNgIIIAIhAwNAIAMgBDYCECADKAIIIgMgAkcNAAsgASgCECABNgIICyAFIAhHDQAgACgCjAEQDyIARQRAQQAPCyAAIAEoAhQiAygCBCIENgIEIAQgADYCACAAIAM2AgAgAyAANgIEIABBADoAFCAAQQA2AgwgACACNgIIIAAgAy0AFToAFSACIQMDQCADIAA2AhQgAygCDCIDIAJHDQALIAEoAhQgATYCCAtBAQvUBQEGfyABKAIUIgMgASgCBCIFKAIUIgZHBEAgAygCCCIEIQIDQCACIAY2AhQgAigCDCICIARHDQALIAMoAgAiAiADKAIEIgQ2AgQgBCACNgIAIAMgACgCjAEiAigCADYCACACIAM2AgALAkAgASABKAIIIgJGBEAgASgCECIDKAIIIgQhAgNAIAJBADYCECACKAIIIgIgBEcNAAsgAygCACICIAMoAgQiBDYCBCAEIAI2AgAgAyAAKAKIASICKAIANgIAIAIgAzYCAAwBCyABKAIEIgQoAhQgBCgCDCIENgIIIAEoAhAgAjYCCCAEKAIIIQcgAigCBCAENgIMIAcoAgQgATYCDCABIAc2AgggBCACNgIIIAMgBkcNACAAKAKMARAPIgNFBEBBAA8LIAMgASgCFCICKAIEIgQ2AgQgBCADNgIAIAMgAjYCACACIAM2AgQgA0EAOgAUIANBADYCDCADIAE2AgggAyACLQAVOgAVIAEhAgNAIAIgAzYCFCACKAIMIgIgAUcNAAsLAkAgBSAFKAIIIgJGBEAgBSgCECIDKAIIIgQhAgNAIAJBADYCECACKAIIIgIgBEcNAAsgAygCACICIAMoAgQiBDYCBCAEIAI2AgAgAyAAKAKIASICKAIANgIAIAIgAzYCACAFKAIUIgMoAggiBSECA0AgAkEANgIUIAIoAgwiAiAFRw0ACyADKAIAIgIgAygCBCIFNgIEIAUgAjYCACADIAAoAowBIgIoAgA2AgAgAiADNgIADAELIAEoAhQgBSgCBCgCDCIDNgIIIAUoAhAgAjYCCCADKAIIIQQgAigCBCADNgIMIAQoAgQgBTYCDCAFIAQ2AgggAyACNgIICyAAKAKEASECIAEoAgQiACABIAAgAUkbIgAoAgAiASgCBCAAKAIEKAIAIgM2AgAgAygCBCABNgIAIAAgAigCADYCACACIAA2AgBBAQujAQEFfwJAIAAoAgAiAQRAIAEoAgAiAg0BCyAAKAIUIgMoAgwgACgCDCAAKAIIbEEEaiADKAIAEQAAIgRFBEBBAA8LIAQgACgCBDYCACAAIAQ2AgQgACgCCCIFIAAoAgxsQQRqIQIgACgCACEDA0AgBCACIAVrIgJqIgEgAzYCACABIQMgAkEERw0ACyAAIAE2AgAgASgCACECCyAAIAI2AgAgAQtBAQJ/AkAgAkUNAANAIAEgA0EDdGooAgAiBEUNASAAIARGBEAgASADQQN0aigCBA8LIANBAWoiAyACRw0ACwtBAAu8AQEEfyAAIAEQUiIARQRAQQAPCyAAKAIEIQMgASgCBCIAKAIEKAIMIgIoAgghBCAAKAIIIgUoAgQgAjYCDCAEKAIEIAA2AgwgACAENgIIIAIgBTYCCCADKAIIIQIgACgCCCIEKAIEIAM2AgwgAigCBCAANgIMIAAgAjYCCCADIAQ2AgggACADKAIQNgIQIAMoAgQiAigCECACNgIIIAIgACgCFDYCFCADIAEoAhw2AhwgAiAAKAIcNgIcIAMLlwQBB38Cf0EAIAAoAoQBEA8iA0UNABogAyABKAIEIgQgASABIARLGyIJKAIEIgUoAgAiBDYCICAEKAIEIAM2AgAgAyAJNgIAIAUgA0EgaiIHNgIAIANCADcCECADIAc2AgwgAyAHNgIEIANCADcCGCADQgA3AjAgAyAHNgIoIANCADcCOCADIAM2AgggAyADNgIsIAMgAzYCJAJ/IAMgAigCFCIGIAEoAhQiCEciCUUNABogBigCCCIFIQQDQCAEIAg2AhQgBCgCDCIEIAVHDQALIAYoAgAiBSAGKAIEIgQ2AgQgBCAFNgIAIAYgACgCjAEiBCgCADYCACAEIAY2AgAgASgCFCEGIAMoAggLIQggASgCDCIFKAIIIQQgCCgCBCAFNgIMIAQoAgQgAzYCDCADIAQ2AgggBSAINgIIIAIoAgghBSADKAIoIgQoAgQgAjYCDCAFKAIEIAc2AgwgAyAFNgIoIAIgBDYCCCADIAEoAgQoAhA2AhAgAigCECECIAMgBjYCNCADIAI2AjAgAyAGNgIUIAEoAhQgBzYCCCADIAkNABpBACAAKAKMARAPIgJFDQAaIAIgASgCFCIBKAIEIgA2AgQgACACNgIAIAIgATYCACABIAI2AgQgAkEAOgAUIAJBADYCDCACIAM2AgggAiABLQAVOgAVIAMhBANAIAQgAjYCFCAEKAIMIgQgA0cNAAsgAwsLUgECf0GwFigCACIBIABBA2pBfHEiAmohAAJAIAJBAU5BACAAIAFNGw0APwBBEHQgAEkEQCAAEAtFDQELQbAWIAA2AgAgAQ8LQcAWQTA2AgBBfwvHBQIEfwJ9IAFBBGohCAJAAkACQAJAA0AgAigCECIGKgIYIgogAigCBCIHKAIQIgkqAhgiC11FBEAgCiALXA0CIAYqAhwgCSoCHF9FDQILIAAoAkwQDyIGRQ0EIAYgBzYCACAGIAAoAkAgASgCBCAGEB0iCTYCBCAJRQ0EIAZCADcCECAGQQA2AhggByAGNgIYIAIoAggiAiADRw0ACyABKAIEKAIIKAIAIgIoAgAoAgQiAygCEAJ/IARFBEAgAygCCCEECyAEKAIQC0YEQEEAIQcDQCABIQYgAiEBIAQiAiADIgQoAghHBEAgACgCACAEKAIEKAIMIAQQDUUNBiAAKAIAIAIoAgQoAgwgBBANRQ0GCyABIAYoAgggBCgCHGsiAzYCCCABAn8CQAJAAkACQAJAAkAgACgCPA4FBQABAgMECyADQQBHDAULIANBAEoMBAsgA0EfdgwDCyADQQFqQQJLDAILQd0PQZwPQfABQeMPEAAACyADQQFxCzYCDCAGQQE2AhQCQCAHRQ0AIAAgBhAeRQ0AIAQgBCgCHCACKAIcajYCHCAEKAIEIgMgAygCHCACKAIEKAIcajYCHCAGKAIAIQMgBigCGARAIAMoAhwNBQsgA0EANgIYIAAoAkAhByAIKAIAIgMoAgQiCCADKAIINgIIIAMoAgggCDYCBCADIAcoAhAiCCgCADYCACAIIAM2AgAgBiAAKAJMIgMoAgA2AgAgAyAGNgIAIAAoAgAgAhAORQ0GCyABQQRqIQhBASEHIAEoAgQoAggoAgAiAigCACgCBCIDKAIQIAQoAhBGDQALCyABQQE2AhQgAigCCCABKAIIIAMoAhxrRw0CIAUEQCAAIAEQKAsPC0G6E0GcD0HdAkHUExAAAAtB8w9BnA9BkgFBihAQAAALQeITQZwPQYcDQdQTEAAACyAAQZABakEBEAMAC/oMAQd/AkAgAEUNACAAQQhrIgMgAEEEaygCACIBQXhxIgBqIQUCQCABQQFxDQAgAUEDcUUNASADIAMoAgAiAmsiA0HUFigCACIESQ0BIAAgAmohACADQdgWKAIARwRAIAJB/wFNBEAgAygCCCIEIAJBA3YiAkEDdEHsFmpHGiAEIAMoAgwiAUYEQEHEFkHEFigCAEF+IAJ3cTYCAAwDCyAEIAE2AgwgASAENgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiAETwRAIAIoAgwaCyACIAE2AgwgASACNgIIDAELAkAgA0EUaiICKAIAIgQNACADQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQECQCADIAMoAhwiAkECdEH0GGoiBCgCAEYEQCAEIAE2AgAgAQ0BQcgWQcgWKAIAQX4gAndxNgIADAMLIAZBEEEUIAYoAhAgA0YbaiABNgIAIAFFDQILIAEgBjYCGCADKAIQIgIEQCABIAI2AhAgAiABNgIYCyADKAIUIgJFDQEgASACNgIUIAIgATYCGAwBCyAFKAIEIgFBA3FBA0cNAEHMFiAANgIAIAUgAUF+cTYCBCADIABBAXI2AgQgACADaiAANgIADwsgAyAFTw0AIAUoAgQiAUEBcUUNAAJAIAFBAnFFBEAgBUHcFigCAEYEQEHcFiADNgIAQdAWQdAWKAIAIABqIgA2AgAgAyAAQQFyNgIEIANB2BYoAgBHDQNBzBZBADYCAEHYFkEANgIADwsgBUHYFigCAEYEQEHYFiADNgIAQcwWQcwWKAIAIABqIgA2AgAgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAFBeHEgAGohAAJAIAFB/wFNBEAgBSgCDCECIAUoAggiBCABQQN2IgFBA3RB7BZqIgdHBEBB1BYoAgAaCyACIARGBEBBxBZBxBYoAgBBfiABd3E2AgAMAgsgAiAHRwRAQdQWKAIAGgsgBCACNgIMIAIgBDYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJB1BYoAgBPBEAgAigCDBoLIAIgATYCDCABIAI2AggMAQsCQCAFQRRqIgIoAgAiBA0AIAVBEGoiAigCACIEDQBBACEBDAELA0AgAiEHIAQiAUEUaiICKAIAIgQNACABQRBqIQIgASgCECIEDQALIAdBADYCAAsgBkUNAAJAIAUgBSgCHCICQQJ0QfQYaiIEKAIARgRAIAQgATYCACABDQFByBZByBYoAgBBfiACd3E2AgAMAgsgBkEQQRQgBigCECAFRhtqIAE2AgAgAUUNAQsgASAGNgIYIAUoAhAiAgRAIAEgAjYCECACIAE2AhgLIAUoAhQiAkUNACABIAI2AhQgAiABNgIYCyADIABBAXI2AgQgACADaiAANgIAIANB2BYoAgBHDQFBzBYgADYCAA8LIAUgAUF+cTYCBCADIABBAXI2AgQgACADaiAANgIACyAAQf8BTQRAIABBA3YiAUEDdEHsFmohAAJ/QcQWKAIAIgJBASABdCIBcUUEQEHEFiABIAJyNgIAIAAMAQsgACgCCAshAiAAIAM2AgggAiADNgIMIAMgADYCDCADIAI2AggPC0EfIQIgA0IANwIQIABB////B00EQCAAQQh2IgEgAUGA/j9qQRB2QQhxIgF0IgIgAkGA4B9qQRB2QQRxIgJ0IgQgBEGAgA9qQRB2QQJxIgR0QQ92IAEgAnIgBHJrIgFBAXQgACABQRVqdkEBcXJBHGohAgsgAyACNgIcIAJBAnRB9BhqIQECQAJAAkBByBYoAgAiBEEBIAJ0IgdxRQRAQcgWIAQgB3I2AgAgASADNgIAIAMgATYCGAwBCyAAQQBBGSACQQF2ayACQR9GG3QhAiABKAIAIQEDQCABIgQoAgRBeHEgAEYNAiACQR12IQEgAkEBdCECIAQgAUEEcWoiB0EQaigCACIBDQALIAcgAzYCECADIAQ2AhgLIAMgAzYCDCADIAM2AggMAQsgBCgCCCIAIAM2AgwgBCADNgIIIANBADYCGCADIAQ2AgwgAyAANgIIC0HkFkHkFigCAEEBayIANgIAIAANAEGMGiEDA0AgAygCACIAQQhqIQMgAA0AC0HkFkF/NgIACwvCLQEMfyMAQRBrIgwkAAJAAkACQAJAAkACQAJAAkACQAJAAkACQCAAQfQBTQRAQcQWKAIAIgdBECAAQQtqQXhxIABBC0kbIgVBA3YiAHYiAUEDcQRAIAFBf3NBAXEgAGoiAkEDdCIFQfQWaigCACIBQQhqIQACQCABKAIIIgMgBUHsFmoiBUYEQEHEFiAHQX4gAndxNgIADAELQdQWKAIAGiADIAU2AgwgBSADNgIICyABIAJBA3QiAkEDcjYCBCABIAJqIgEgASgCBEEBcjYCBAwNCyAFQcwWKAIAIghNDQEgAQRAAkBBAiAAdCICQQAgAmtyIAEgAHRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2aiICQQN0IgNB9BZqKAIAIgEoAggiACADQewWaiIDRgRAQcQWIAdBfiACd3EiBzYCAAwBC0HUFigCABogACADNgIMIAMgADYCCAsgAUEIaiEAIAEgBUEDcjYCBCABIAVqIgQgAkEDdCICIAVrIgNBAXI2AgQgASACaiADNgIAIAgEQCAIQQN2IgVBA3RB7BZqIQFB2BYoAgAhAgJ/IAdBASAFdCIFcUUEQEHEFiAFIAdyNgIAIAEMAQsgASgCCAshBSABIAI2AgggBSACNgIMIAIgATYCDCACIAU2AggLQdgWIAQ2AgBBzBYgAzYCAAwNC0HIFigCACIKRQ0BIApBACAKa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2akECdEH0GGooAgAiASgCBEF4cSAFayEEIAEhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAFayICIAQgAiAESSICGyEEIAAgASACGyEBIAAhAgwBCwsgASAFaiILIAFNDQIgASgCGCEJIAEgASgCDCIDRwRAIAEoAggiAEHUFigCAE8EQCAAKAIMGgsgACADNgIMIAMgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhBiAAIgNBFGoiAigCACIADQAgA0EQaiECIAMoAhAiAA0ACyAGQQA2AgAMCwtBfyEFIABBv39LDQAgAEELaiIAQXhxIQVByBYoAgAiCEUNAEEfIQZBACAFayEEAkACQAJAAn8gBUH///8HTQRAIABBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAFIABBFWp2QQFxckEcaiEGCyAGQQJ0QfQYaigCACICRQsEQEEAIQAMAQtBACEAIAVBAEEZIAZBAXZrIAZBH0YbdCEBA0ACQCACKAIEQXhxIAVrIgcgBE8NACACIQMgByIEDQBBACEEIAIhAAwDCyAAIAIoAhQiByAHIAIgAUEddkEEcWooAhAiAkYbIAAgBxshACABQQF0IQEgAg0ACwsgACADckUEQEECIAZ0IgBBACAAa3IgCHEiAEUNAyAAQQAgAGtxQQFrIgAgAEEMdkEQcSIAdiIBQQV2QQhxIgIgAHIgASACdiIAQQJ2QQRxIgFyIAAgAXYiAEEBdkECcSIBciAAIAF2IgBBAXZBAXEiAXIgACABdmpBAnRB9BhqKAIAIQALIABFDQELA0AgACgCBEF4cSAFayICIARJIQEgAiAEIAEbIQQgACADIAEbIQMgACgCECIBBH8gAQUgACgCFAsiAA0ACwsgA0UNACAEQcwWKAIAIAVrTw0AIAMgBWoiBiADTQ0BIAMoAhghCSADIAMoAgwiAUcEQCADKAIIIgBB1BYoAgBPBEAgACgCDBoLIAAgATYCDCABIAA2AggMCgsgA0EUaiICKAIAIgBFBEAgAygCECIARQ0EIANBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAVBzBYoAgAiAU0EQEHYFigCACEAAkAgASAFayICQRBPBEBBzBYgAjYCAEHYFiAAIAVqIgM2AgAgAyACQQFyNgIEIAAgAWogAjYCACAAIAVBA3I2AgQMAQtB2BZBADYCAEHMFkEANgIAIAAgAUEDcjYCBCAAIAFqIgEgASgCBEEBcjYCBAsgAEEIaiEADAsLIAVB0BYoAgAiAUkEQEHQFiABIAVrIgE2AgBB3BZB3BYoAgAiACAFaiICNgIAIAIgAUEBcjYCBCAAIAVBA3I2AgQgAEEIaiEADAsLQQAhACAFQS9qIgQCf0GcGigCAARAQaQaKAIADAELQagaQn83AgBBoBpCgKCAgICABDcCAEGcGiAMQQxqQXBxQdiq1aoFczYCAEGwGkEANgIAQYAaQQA2AgBBgCALIgJqIgdBACACayIGcSICIAVNDQpB/BkoAgAiAwRAQfQZKAIAIgggAmoiCSAITQ0LIAMgCUkNCwtBgBotAABBBHENBQJAAkBB3BYoAgAiAwRAQYQaIQADQCADIAAoAgAiCE8EQCAIIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABATIgFBf0YNBiACIQdBoBooAgAiAEEBayIDIAFxBEAgAiABayABIANqQQAgAGtxaiEHCyAFIAdPDQYgB0H+////B0sNBkH8GSgCACIABEBB9BkoAgAiAyAHaiIGIANNDQcgACAGSQ0HCyAHEBMiACABRw0BDAgLIAcgAWsgBnEiB0H+////B0sNBSAHEBMiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAFQTBqIAdNDQAgAEF/Rg0AQaQaKAIAIgEgBCAHa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARATQX9HBEAgASAHaiEHIAAhAQwIC0EAIAdrEBMaDAULIAAiAUF/Rw0GDAQLAAtBACEDDAcLQQAhAQwFCyABQX9HDQILQYAaQYAaKAIAQQRyNgIACyACQf7///8HSw0BIAIQEyIBQQAQEyIATw0BIAFBf0YNASAAQX9GDQEgACABayIHIAVBKGpNDQELQfQZQfQZKAIAIAdqIgA2AgBB+BkoAgAgAEkEQEH4GSAANgIACwJAAkACQEHcFigCACIEBEBBhBohAANAIAEgACgCACICIAAoAgQiA2pGDQIgACgCCCIADQALDAILQdQWKAIAIgBBACAAIAFNG0UEQEHUFiABNgIAC0EAIQBBiBogBzYCAEGEGiABNgIAQeQWQX82AgBB6BZBnBooAgA2AgBBkBpBADYCAANAIABBA3QiAkH0FmogAkHsFmoiAzYCACACQfgWaiADNgIAIABBAWoiAEEgRw0AC0HQFiAHQShrIgBBeCABa0EHcUEAIAFBCGpBB3EbIgJrIgM2AgBB3BYgASACaiICNgIAIAIgA0EBcjYCBCAAIAFqQSg2AgRB4BZBrBooAgA2AgAMAgsgASAETQ0AIAIgBEsNACAAKAIMQQhxDQAgACADIAdqNgIEQdwWIARBeCAEa0EHcUEAIARBCGpBB3EbIgBqIgE2AgBB0BZB0BYoAgAgB2oiAiAAayIANgIAIAEgAEEBcjYCBCACIARqQSg2AgRB4BZBrBooAgA2AgAMAQtB1BYoAgAiAyABSwRAQdQWIAE2AgAgASEDCyABIAdqIQJBhBohAAJAAkACQAJAAkACQANAIAIgACgCAEcEQCAAKAIIIgANAQwCCwsgAC0ADEEIcUUNAQtBhBohAANAIAQgACgCACICTwRAIAIgACgCBGoiAyAESw0DCyAAKAIIIQAMAAsACyAAIAE2AgAgACAAKAIEIAdqNgIEIAFBeCABa0EHcUEAIAFBCGpBB3EbaiIJIAVBA3I2AgQgAkF4IAJrQQdxQQAgAkEIakEHcRtqIgEgCWsgBWshACAFIAlqIQYgASAERgRAQdwWIAY2AgBB0BZB0BYoAgAgAGoiADYCACAGIABBAXI2AgQMAwsgAUHYFigCAEYEQEHYFiAGNgIAQcwWQcwWKAIAIABqIgA2AgAgBiAAQQFyNgIEIAAgBmogADYCAAwDCyABKAIEIgJBA3FBAUYEQCACQXhxIQoCQCACQf8BTQRAIAEoAggiAyACQQN2IgVBA3RB7BZqRxogAyABKAIMIgJGBEBBxBZBxBYoAgBBfiAFd3E2AgAMAgsgAyACNgIMIAIgAzYCCAwBCyABKAIYIQgCQCABIAEoAgwiB0cEQCABKAIIIgIgA08EQCACKAIMGgsgAiAHNgIMIAcgAjYCCAwBCwJAIAFBFGoiBCgCACIFDQAgAUEQaiIEKAIAIgUNAEEAIQcMAQsDQCAEIQIgBSIHQRRqIgQoAgAiBQ0AIAdBEGohBCAHKAIQIgUNAAsgAkEANgIACyAIRQ0AAkAgASABKAIcIgJBAnRB9BhqIgMoAgBGBEAgAyAHNgIAIAcNAUHIFkHIFigCAEF+IAJ3cTYCAAwCCyAIQRBBFCAIKAIQIAFGG2ogBzYCACAHRQ0BCyAHIAg2AhggASgCECICBEAgByACNgIQIAIgBzYCGAsgASgCFCICRQ0AIAcgAjYCFCACIAc2AhgLIAEgCmohASAAIApqIQALIAEgASgCBEF+cTYCBCAGIABBAXI2AgQgACAGaiAANgIAIABB/wFNBEAgAEEDdiIBQQN0QewWaiEAAn9BxBYoAgAiAkEBIAF0IgFxRQRAQcQWIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBjYCCCABIAY2AgwgBiAANgIMIAYgATYCCAwDC0EfIQQgAEH///8HTQRAIABBCHYiASABQYD+P2pBEHZBCHEiAXQiAiACQYDgH2pBEHZBBHEiAnQiAyADQYCAD2pBEHZBAnEiA3RBD3YgASACciADcmsiAUEBdCAAIAFBFWp2QQFxckEcaiEECyAGIAQ2AhwgBkIANwIQIARBAnRB9BhqIQECQEHIFigCACICQQEgBHQiA3FFBEBByBYgAiADcjYCACABIAY2AgAgBiABNgIYDAELIABBAEEZIARBAXZrIARBH0YbdCEEIAEoAgAhAQNAIAEiAigCBEF4cSAARg0DIARBHXYhASAEQQF0IQQgAiABQQRxaiIDKAIQIgENAAsgAyAGNgIQIAYgAjYCGAsgBiAGNgIMIAYgBjYCCAwCC0HQFiAHQShrIgBBeCABa0EHcUEAIAFBCGpBB3EbIgJrIgY2AgBB3BYgASACaiICNgIAIAIgBkEBcjYCBCAAIAFqQSg2AgRB4BZBrBooAgA2AgAgBCADQScgA2tBB3FBACADQSdrQQdxG2pBL2siACAAIARBEGpJGyICQRs2AgQgAkGMGikCADcCECACQYQaKQIANwIIQYwaIAJBCGo2AgBBiBogBzYCAEGEGiABNgIAQZAaQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASADSQ0ACyACIARGDQMgAiACKAIEQX5xNgIEIAQgAiAEayIDQQFyNgIEIAIgAzYCACADQf8BTQRAIANBA3YiAUEDdEHsFmohAAJ/QcQWKAIAIgJBASABdCIBcUUEQEHEFiABIAJyNgIAIAAMAQsgACgCCAshASAAIAQ2AgggASAENgIMIAQgADYCDCAEIAE2AggMBAtBHyEAIARCADcCECADQf///wdNBEAgA0EIdiIAIABBgP4/akEQdkEIcSIAdCIBIAFBgOAfakEQdkEEcSIBdCICIAJBgIAPakEQdkECcSICdEEPdiAAIAFyIAJyayIAQQF0IAMgAEEVanZBAXFyQRxqIQALIAQgADYCHCAAQQJ0QfQYaiEBAkBByBYoAgAiAkEBIAB0IgdxRQRAQcgWIAIgB3I2AgAgASAENgIAIAQgATYCGAwBCyADQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQEDQCABIgIoAgRBeHEgA0YNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiBygCECIBDQALIAcgBDYCECAEIAI2AhgLIAQgBDYCDCAEIAQ2AggMAwsgAigCCCIAIAY2AgwgAiAGNgIIIAZBADYCGCAGIAI2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAQ2AgwgAiAENgIIIARBADYCGCAEIAI2AgwgBCAANgIIC0HQFigCACIAIAVNDQBB0BYgACAFayIBNgIAQdwWQdwWKAIAIgAgBWoiAjYCACACIAFBAXI2AgQgACAFQQNyNgIEIABBCGohAAwDC0HAFkEwNgIAQQAhAAwCCwJAIAlFDQACQCADKAIcIgBBAnRB9BhqIgIoAgAgA0YEQCACIAE2AgAgAQ0BQcgWIAhBfiAAd3EiCDYCAAwCCyAJQRBBFCAJKAIQIANGG2ogATYCACABRQ0BCyABIAk2AhggAygCECIABEAgASAANgIQIAAgATYCGAsgAygCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgBEEPTQRAIAMgBCAFaiIAQQNyNgIEIAAgA2oiACAAKAIEQQFyNgIEDAELIAMgBUEDcjYCBCAGIARBAXI2AgQgBCAGaiAENgIAIARB/wFNBEAgBEEDdiIBQQN0QewWaiEAAn9BxBYoAgAiAkEBIAF0IgFxRQRAQcQWIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBjYCCCABIAY2AgwgBiAANgIMIAYgATYCCAwBC0EfIQAgBEH///8HTQRAIARBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAEIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRB9BhqIQECQAJAIAhBASAAdCICcUUEQEHIFiACIAhyNgIAIAEgBjYCAAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQUDQCAFIgEoAgRBeHEgBEYNAiAAQR12IQIgAEEBdCEAIAEgAkEEcWoiAigCECIFDQALIAIgBjYCEAsgBiABNgIYIAYgBjYCDCAGIAY2AggMAQsgASgCCCIAIAY2AgwgASAGNgIIIAZBADYCGCAGIAE2AgwgBiAANgIICyADQQhqIQAMAQsCQCAJRQ0AAkAgASgCHCIAQQJ0QfQYaiICKAIAIAFGBEAgAiADNgIAIAMNAUHIFiAKQX4gAHdxNgIADAILIAlBEEEUIAkoAhAgAUYbaiADNgIAIANFDQELIAMgCTYCGCABKAIQIgAEQCADIAA2AhAgACADNgIYCyABKAIUIgBFDQAgAyAANgIUIAAgAzYCGAsCQCAEQQ9NBEAgASAEIAVqIgBBA3I2AgQgACABaiIAIAAoAgRBAXI2AgQMAQsgASAFQQNyNgIEIAsgBEEBcjYCBCAEIAtqIAQ2AgAgCARAIAhBA3YiA0EDdEHsFmohAEHYFigCACECAn9BASADdCIDIAdxRQRAQcQWIAMgB3I2AgAgAAwBCyAAKAIICyEDIAAgAjYCCCADIAI2AgwgAiAANgIMIAIgAzYCCAtB2BYgCzYCAEHMFiAENgIACyABQQhqIQALIAxBEGokACAAC/MDAQR/IAEoAgAhAwJAAkACQCABIAJHBEADQCABQQA2AhggASgCBCIEKAIIKAIAIgUoAgAiBigCECADKAIQRwRAIAUoAhhFBEAgASgCDCEFIAMoAhQiAiADNgIIIAIgBToAFSADQQA2AhggACgCQCEFIAQoAgQiAiAEKAIINgIIIAQoAgggAjYCBCAEIAUoAhAiAigCADYCACACIAQ2AgAgASAAKAJMIgAoAgA2AgAgACABNgIAIAMPCyAAKAIAIAMoAggoAgQgBigCBBASIgZFDQUgBSgCGEUNAyAAKAIAIAUoAgAQDkUNBSAFIAY2AgAgBUEANgIYIAYgBTYCGAsgBiADKAIIRwRAIAAoAgAgBigCBCgCDCAGEA1FDQUgACgCACADIAYQDUUNBQsgASgCDCEGIAEoAgAiAygCFCIEIAM2AgggBCAGOgAVIAEoAhgEQCADKAIcDQQLIANBADYCGCAAKAJAIQYgASgCBCIDKAIEIgQgAygCCDYCCCADKAIIIAQ2AgQgAyAGKAIQIgQoAgA2AgAgBCADNgIAIAEgACgCTCIEKAIANgIAIAQgATYCACAFKAIAIQMgBSIBIAJHDQALCyADDwtBvg9BnA9BnwFB0A8QAAALQfMPQZwPQZIBQYoQEAAACyAAQZABakEBEAMAC0oBA38gACgCFCEBIAAoAgQiAgRAA0AgAigCACEDIAEoAgwgAiABKAIIEQEAIAMiAg0ACwsgAEIANwIAIAEoAgwgACABKAIIEQEAC74BAQJ/IAAoAgxBGCAAKAIAEQAAIgQgATYCECAEIAA2AhQgBCADNgIMIAQgAkEEIAJBBEsbIgE2AgggBEIANwIAIAAoAgwgASADbEEEaiAAKAIAEQAAIgMEQCADIAQoAgQ2AgAgBCADNgIEIAQoAggiBSAEKAIMbEEEaiEAIAQoAgAhAgNAIAMgACAFayIAaiIBIAI2AgAgASECIABBBEcNAAsgBCACNgIAIAQPCyAAKAIMIAQgACgCCBEBAEEAC6gKAgl/An0jAEEgayIKJAAgACABNgJIIAEoAggiAyEEAkACQAJAAkACQANAIAQoAhgiAg0BIAQoAggiBCADRw0ACyAKIAMoAgQ2AgAgACgCQCAKEDYoAgAiAigCBCgCCCgCACIERQ0BIAQoAgAhBiACKAIAIgUoAgQoAhAgASAFKAIQEAxDAAAAAFsEQCAAIAIgARBHDAILAn8gAiAGKAIEIgYoAhAiByoCGCILIAUoAgQoAhAiCCoCGCIMXQ0AGiALIAxbBEAgAiAHKgIcIAgqAhxfDQEaCyAECyEDAkAgAigCDEUEQCADKAIYRQ0BCyAAKAIAIQQCQCACIANGBEAgBCABKAIIKAIEIAUoAgwQEiIFDQEMBgsgBCAGKAIIKAIEIAEoAggQEiIERQ0FIAQoAgQhBQsgAygCGARAIAAoAgAgAygCABAOBEAgAyAFNgIAIANBADYCGCAFIAM2AhggACABEBoMBAsMBQsgACgCTBAPIgNFDQQgAyAFNgIAIAMgACgCQCACKAIEIAMQHSICNgIEIAJFDQQgA0IANwIQIANBADYCGCAFIAM2AhggACgCPCEEIAMgAygCACgCHCACKAIEKAIAKAIIaiICNgIIIAMCfwJAAkACQAJAAkACQCAEDgUFAAECAwQLIAJBAEcMBQsgAkEASgwECyACQR92DAMLIAJBAWpBAksMAgtB3Q9BnA9B8AFB4w8QAAALIAJBAXELNgIMIAAgARAaDAILIAAgAiABKAIIIgAgAEEAQQEQFAwBCyACKAIAKAIQIQEDQCACKAIEKAIEKAIAIgIoAgAiAygCECABRg0ACyACKAIYBEAgACgCACACKAIEKAIIKAIAKAIAKAIEIAMoAgwQEiIBRQ0DIAIoAhhFDQQgACgCACACKAIAEA5FDQMgAiABNgIAIAJBADYCGCABIAI2AhggAigCBCgCBCgCACICRQ0DCyACKAIEKAIIKAIAIgEoAgAiBCAAIAFBABAXIgEoAggiA0YEQCACKAIAIgMoAgQoAhAgAigCBCgCCCgCACIHKAIAIgYoAgQoAhBHBEAgACACECkaC0EBIQgCQCAAKAJIIgUqAhgiCyADKAIQIgkqAhhcDQAgCSoCHCAFKgIcXA0AIAAoAgAgBCgCBCgCDCADEA1FDQQgAigCACgCECEEA0AgAigCBCgCBCgCACICKAIAIgUoAhAgBEYNAAsgAigCGARAIAAoAgAgAigCBCgCCCgCACgCACgCBCAFKAIMEBIiBEUNBSACKAIYRQ0GIAAoAgAgAigCABAORQ0FIAIgBDYCACACQQA2AhggBCACNgIYIAIoAgQoAgQoAgAiAkUNBQsgAigCBCgCCCgCACIFKAIAIQQgACAFIAcQFxogACgCSCIFKgIYIQtBACEICwJAAkACQCALIAYoAhAiCSoCGCILXA0AIAkqAhwgBSoCHFwNACAAKAIAIAEgBigCBCgCDBANRQ0GIAAgB0EAEBchAQwBCyAIDQELIAAgAiABKAIIIAQgBEEBEBQMAgsCQCALIAMoAhAiBCoCGCIMXUUEQCALIAxcDQEgCSoCHCAEKgIcX0EBcw0BCyAGKAIEKAIMIQMLIAAoAgAgASgCCCgCBCADEBIiAUUNAyAAIAIgASABKAIIIgMgA0EAEBQgASgCBCgCGEEBNgIYIAAgAhAoDAELIAAgAiADIAQgBEEBEBQLIApBIGokAA8LAAsgAEGQAWpBARADAAtBvg9BnA9BnwFB0A8QAAALvAICCn8CfSAAKAIEIgMgACgCACICIAFBAnRqKAIAIgdBA3RqIQkgACgCDCEKIAAoAgghCAJAA0ACQCABQQF0IgAgCE4NACADIAIgAEEBciIEQQJ0aigCAEEDdGooAgAiBSoCGCIMIAMgAiAAQQJ0aigCAEEDdGooAgAiBioCGCINXUUEQCAMIA1cDQEgBSoCHCAGKgIcX0EBcw0BCyAEIQALIAAgCkwEQCAAIAhKDQIgCSgCACIEKgIYIgwgAyACIABBAnRqKAIAIgVBA3RqIgYoAgAiCyoCGCINXQ0CIAwgDVsEQCAEKgIcIAsqAhxfQQFzRQ0DCyACIAFBAnRqIAU2AgAgBiABNgIEIAAhAQwBCwtB7w5BiA1BjQFBgA8QAAALIAIgAUECdGogBzYCACADIAdBA3RqIAE2AgQL4AIBAn8CQCABRQ0AIAAgAWoiAkEBa0H/AToAACAAQf8BOgAAIAFBA0kNACACQQJrQf8BOgAAIABB/wE6AAEgAkEDa0H/AToAACAAQf8BOgACIAFBB0kNACACQQRrQf8BOgAAIABB/wE6AAMgAUEJSQ0AIABBACAAa0EDcSIDaiICQX82AgAgAiABIANrQXxxIgNqIgFBBGtBfzYCACADQQlJDQAgAkF/NgIIIAJBfzYCBCABQQhrQX82AgAgAUEMa0F/NgIAIANBGUkNACACQX82AhggAkF/NgIUIAJBfzYCECACQX82AgwgAUEQa0F/NgIAIAFBFGtBfzYCACABQRhrQX82AgAgAUEca0F/NgIAIAMgAkEEcUEYciIDayIBQSBJDQAgAiADaiECA0AgAkJ/NwMYIAJCfzcDECACQn83AwggAkJ/NwMAIAJBIGohAiABQSBrIgFBH0sNAAsLIAALZQEBfwNAIAEoAggiASgCACIDBEAgACgCDCADIAIgACgCFBECAEUNAQsLIAAoAhAQDyIARQRAQQAPCyAAIAI2AgAgACABKAIENgIEIAEoAgQgADYCCCAAIAE2AgggASAANgIEIAAL2AICBn8CfQJAAkACQCABKAIAIgMoAhAiAioCGCIIIAEoAgQoAggoAgAiBygCACIEKAIQIgUqAhgiCV1FBEAgCCAJXA0BIAIqAhwgBSoCHF9BAXMNAQsgBCgCBCgCECACIAUQDEMAAAAAXg0BAkAgAygCECICKgIYIAQoAhAiBSoCGFsEQCACKgIcIAUqAhxbDQELIAAoAgAgBCgCBBARRQ0DIAAoAgAgAyAEKAIEKAIMEA1FDQMgB0EBNgIUIAFBATYCFEEBDwtBASEGIAIgBUYNASAAKAJEIAIoAiAQSiAAKAIAIAQoAgQoAgwgAxANDQEMAgsgAygCBCgCECAFIAIQDEMAAAAAXQ0AQQEhBiABQQE2AhQgASgCBCgCBCgCAEEBNgIUIAAoAgAgAygCBBARRQ0BIAAoAgAgBCgCBCgCDCADEA1FDQELIAYPCyAAQZABakEBEAMAC7MDAgp/An0CQCAAKAIMIgNFBEAgACgCACIBKAIEIgcgASgCACIAKAIEIgVBA3RqIgQoAgAhAiABKAIIIghBAUgNASAAIAAgCEECdGooAgAiADYCBCAHIABBA3RqQQE2AgQgBEEANgIAIAQgASgCEDYCBCABIAhBAWs2AgggASAFNgIQIAhBAUYNASABQQEQGyACDwsgACgCCCIIIANBAnRqQQRrKAIAKAIAIQcCQCAAKAIAIgYoAggiCUUNACAGKAIEIgogBigCACIBKAIEIgRBA3RqIgUoAgAiAioCGCILIAcqAhgiDF1FBEAgCyAMXA0BIAIqAhwgByoCHF9BAXMNAQsgCUEBSA0BIAEgASAJQQJ0aigCACIANgIEIAogAEEDdGpBATYCBCAFQQA2AgAgCiAEQQN0aiAGKAIQNgIEIAYgCUEBazYCCCAGIAQ2AhAgCUEBRg0BIAZBARAbIAIPCyADQQEgA0EBSBtBAWshAgNAAkAgA0ECSARAIAIhBQwBCyADQQJ0IQQgA0EBayIFIQMgBCAIakEIaygCACgCAEUNAQsLIAAgBTYCDCAHIQILIAILlwEBAX8gAQRAIAEoAgAiAgRAIAAoAgwgAigCBCAAKAIIEQEAIAAoAgwgAigCACAAKAIIEQEAIAAoAgwgAiAAKAIIEQEACyABKAIIIgIEQCAAKAIMIAIgACgCCBEBAAsgASgCBCICBEAgACgCDCACIAAoAggRAQALIAAoAgwgASAAKAIIEQEADwtB6Q1BiA1BxwJB9A0QAAALgQQBB38gACgCiAEQDyEEIAAoAogBEA8hBSAAKAKMARAPIQMCQAJAAkAgBEUNACAFRQ0AIAMNAQsgBARAIAQgACgCiAEiAigCADYCACACIAQ2AgALIAUEQCAFIAAoAogBIgIoAgA2AgAgAiAFNgIACyADRQ0BIAMgACgCjAEiACgCADYCACAAIAM2AgBBAA8LIAAoAoQBEA8iAUUEQEEADwsgASAAKAJIIgIgAEHEAGoiBiACIAZJGyICKAIEIgYoAgAiBzYCICAHKAIEIAE2AgAgASACNgIAIAYgAUEgaiIGNgIAIAFCADcCECABIAY2AgwgASAGNgIEIAFCADcCGCABQgA3AjAgASAGNgIoIAFCADcCOCABIAE2AgggASABNgIsIAEgATYCJCAEIAAoAgQiAjYCBCACIAQ2AgAgBCABNgIIIAQgADYCACABIQIDQCACIAQ2AhAgAigCCCICIAFHDQALIAUgBDYCBCAEIAU2AgAgBSAANgIAIAAgBTYCBCAFIAY2AgggBiECA0AgAiAFNgIQIAIoAggiAiAGRw0ACyADIAAoAjAiAjYCBCACIAM2AgAgAyAAQSxqNgIAIAAgAzYCMCADQQA6ABQgA0EANgIMIAMgATYCCCADIAAtAEE6ABUgASECA0AgAiADNgIUIAIoAgwiAiABRw0ACwsgAQsDAAELtgEBBH0CQCAAKgIYIgQgASoCGCIDXUUEQCADIARcDQEgACoCHCABKgIcX0EBcw0BCyADIAIqAhgiBV1FBEAgAyAFXA0BIAEqAhwgAioCHF9FDQELIAMgBJMiBCAFIAOTIgOSIgVDAAAAAF5BAXMEfUMAAAAABSABKgIcIAAgAiADIAReIgEbKgIcIgaTIAQgAyABGyAFlSAGIAIgACABGyoCHJOUkgsPC0GFCEGoCEE6QbMIEAAAC4AMAQZ/IAAgAWohBQJAAkAgACgCBCICQQFxDQAgAkEDcUUNASAAKAIAIgMgAWohASAAIANrIgBB2BYoAgBHBEBB1BYoAgAhBCADQf8BTQRAIAAoAggiBCADQQN2IgNBA3RB7BZqRxogBCAAKAIMIgJGBEBBxBZBxBYoAgBBfiADd3E2AgAMAwsgBCACNgIMIAIgBDYCCAwCCyAAKAIYIQYCQCAAIAAoAgwiAkcEQCAAKAIIIgMgBE8EQCADKAIMGgsgAyACNgIMIAIgAzYCCAwBCwJAIABBFGoiAygCACIEDQAgAEEQaiIDKAIAIgQNAEEAIQIMAQsDQCADIQcgBCICQRRqIgMoAgAiBA0AIAJBEGohAyACKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgACAAKAIcIgNBAnRB9BhqIgQoAgBGBEAgBCACNgIAIAINAUHIFkHIFigCAEF+IAN3cTYCAAwDCyAGQRBBFCAGKAIQIABGG2ogAjYCACACRQ0CCyACIAY2AhggACgCECIDBEAgAiADNgIQIAMgAjYCGAsgACgCFCIDRQ0BIAIgAzYCFCADIAI2AhgMAQsgBSgCBCICQQNxQQNHDQBBzBYgATYCACAFIAJBfnE2AgQgACABQQFyNgIEIAUgATYCAA8LAkAgBSgCBCICQQJxRQRAIAVB3BYoAgBGBEBB3BYgADYCAEHQFkHQFigCACABaiIBNgIAIAAgAUEBcjYCBCAAQdgWKAIARw0DQcwWQQA2AgBB2BZBADYCAA8LIAVB2BYoAgBGBEBB2BYgADYCAEHMFkHMFigCACABaiIBNgIAIAAgAUEBcjYCBCAAIAFqIAE2AgAPC0HUFigCACEDIAJBeHEgAWohAQJAIAJB/wFNBEAgBSgCCCIEIAJBA3YiAkEDdEHsFmpHGiAEIAUoAgwiA0YEQEHEFkHEFigCAEF+IAJ3cTYCAAwCCyAEIAM2AgwgAyAENgIIDAELIAUoAhghBgJAIAUgBSgCDCICRwRAIAMgBSgCCCIDTQRAIAMoAgwaCyADIAI2AgwgAiADNgIIDAELAkAgBUEUaiIDKAIAIgQNACAFQRBqIgMoAgAiBA0AQQAhAgwBCwNAIAMhByAEIgJBFGoiAygCACIEDQAgAkEQaiEDIAIoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiA0ECdEH0GGoiBCgCAEYEQCAEIAI2AgAgAg0BQcgWQcgWKAIAQX4gA3dxNgIADAILIAZBEEEUIAYoAhAgBUYbaiACNgIAIAJFDQELIAIgBjYCGCAFKAIQIgMEQCACIAM2AhAgAyACNgIYCyAFKAIUIgNFDQAgAiADNgIUIAMgAjYCGAsgACABQQFyNgIEIAAgAWogATYCACAAQdgWKAIARw0BQcwWIAE2AgAPCyAFIAJBfnE2AgQgACABQQFyNgIEIAAgAWogATYCAAsgAUH/AU0EQCABQQN2IgJBA3RB7BZqIQECf0HEFigCACIDQQEgAnQiAnFFBEBBxBYgAiADcjYCACABDAELIAEoAggLIQMgASAANgIIIAMgADYCDCAAIAE2AgwgACADNgIIDwtBHyEDIABCADcCECABQf///wdNBEAgAUEIdiICIAJBgP4/akEQdkEIcSICdCIDIANBgOAfakEQdkEEcSIDdCIEIARBgIAPakEQdkECcSIEdEEPdiACIANyIARyayICQQF0IAEgAkEVanZBAXFyQRxqIQMLIAAgAzYCHCADQQJ0QfQYaiECAkACQEHIFigCACIEQQEgA3QiB3FFBEBByBYgBCAHcjYCACACIAA2AgAgACACNgIYDAELIAFBAEEZIANBAXZrIANBH0YbdCEDIAIoAgAhAgNAIAIiBCgCBEF4cSABRg0CIANBHXYhAiADQQF0IQMgBCACQQRxaiIHQRBqKAIAIgINAAsgByAANgIQIAAgBDYCGAsgACAANgIMIAAgADYCCA8LIAQoAggiASAANgIMIAQgADYCCCAAQQA2AhggACAENgIMIAAgATYCCAsLfwECfyAARQRAIAEQFg8LIAFBQE8EQEHAFkEwNgIAQQAPCyAAQQhrQRAgAUELakF4cSABQQtJGxA0IgIEQCACQQhqDwsgARAWIgJFBEBBAA8LIAIgAEF8QXggAEEEaygCACIDQQNxGyADQXhxaiIDIAEgASADSxsQMyAAEBUgAguIAQEDf0G0FkG0FigCAEEBaiIFNgIAIAAgBTYCAAJAIAMEQANAIAIgBEEDdGoiBigCAEUNAiAEQQFqIgQgA0cNAAsLIAAgASACIANBBHRBCHIQJSADQQF0IgAQJiEBIAAQASABDwsgBiAFNgIAIAIgBEEDdGoiACABNgIEIABBADYCCCADEAEgAgv0DQIQfw59IAAoAgAhBSMAQdAAayICIAAqAggiETgCACACIAAqAgwiFzgCBCACIAAqAhAiGDgCCAJAIBFDAAAAAFsgF0MAAAAAW3EgGEMAAAAAW3EiDEUEQCAFKAIAIQMMAQsgAiAFKAIAIgMiAUEUaigCADYCOCACIANBDGopAgA3AzAgAiABKAIUNgJIIAIgAykCDDcDQCACIAM2AgwgAiADNgIYIAIgAzYCECACIAM2AhwgAiADNgIUIAIgAzYCIAJAIAMgBUYEQCACKgI4IRogAioCSCEUIAIqAjAhFSACKgJAIRYgAioCNCEZIAIqAkQhEwwBCyACKgJIIRQgAioCOCEaIAIqAkQhEyACKgI0IRkgAioCQCEWIAIqAjAiGyEVIAMiBiIEIgciCCIJIgohAQNAIAEqAhQiEiAUIBIgFF4iDRshFCASIBogEiAaXSIOGyEaIAEqAhAiEiATIBIgE14iDxshEyASIBkgEiAZXSIQGyEZIAEqAgwiEiAWIBIgFl4iCxshFiABIAkgCxshCSASIBUgEiAVXSILGyEVIBIgGyALGyEbIAEgCiALGyEKIAEgBiANGyEGIAEgBCAOGyEEIAEgByAPGyEHIAEgCCAQGyEIIAEoAgAiASAFRw0ACyACIAo2AgwgAiAbOAIwIAIgFjgCQCACIAk2AhggAiAZOAI0IAIgCDYCECACIBM4AkQgAiAHNgIcIAIgGjgCOCACIAQ2AhQgAiAUOAJIIAIgBjYCIAtBAiATIBmTIBYgFZNeIgEgFCAakyABQQJ0IgEgAkFAa3IqAgAgAkEwaiABcioCAJNeG0ECdCIBIAJBMGpqKgIAIAJBQGsgAWoqAgBgQQFzRQRAIAJBgICA/AM2AgggAkIANwIAQwAAAAAhEUMAAIA/IRhDAAAAACEXDAELIAIgAkEMaiABaigCACIEKgIMIAJBGGogAWooAgAiASoCDCIckyITOAIkIAIgBCoCECABKgIQIh2TIhU4AiggAiAEKgIUIAEqAhQiHpMiEjgCLCADIAVHBEBDAAAAACEbIAMhAQNAIBMgASoCECAdkyIUlCAVIAEqAgwgHJMiFpSTIhogGpQgFSABKgIUIB6TIhmUIBIgFJSTIhQgFJQgEiAWlCATIBmUkyIWIBaUkpIiGSAbXkEBc0UEQCAaIRggFiEXIBkhGyAUIRELIAEoAgAiASAFRw0ACyACIBg4AgggAiAXOAIEIAIgETgCACAbQwAAAABfQQFzDQELIAJBADYCCCACQgA3AgAgAkECIBWMIBUgFUMAAAAAXRsgE4wgEyATQwAAAABdG14iASASjCASIBJDAAAAAF0bIAJBJGogAUECdGoqAgAiEYwgESARQwAAAABdG14bQQJ0akGAgID8AzYCACACKgIIIRggAioCACERIAIqAgQhFwsgAEEUaiIBQQIgF4wgFyAXQwAAAABdGyARjCARIBFDAAAAAF0bXiIEIBiMIBggGEMAAAAAXRsgAiAEQQJ0aioCACIRjCARIBFDAAAAAF0bXhsiBEECdCIGakEANgIAIAEgBEEBakEDcEECdCIHakGAgID8AzYCACABIARBAmpBA3BBAnQiBGpBADYCACAAQSBqIgEgBmpBADYCACABIAdqQwAAAIBDAAAAACACIAZqKgIAQwAAAABeIgYbOAIAIAEgBGpDAACAP0MAAIC/IAYbOAIAIAMgBUYiBkUEQCADIQEDQCABIAEqAgwiESAAKgIUlCABKgIQIhcgACoCGJSSIAEqAhQiGCAAKgIclJI4AhggASARIAAqAiCUIBcgACoCJJSSIBggACoCKJSSOAIcIAEoAgAiASAFRw0ACwsCQCAMRQ0AIAUoAiwiBCAFQSxqIghGDQBDAAAAACERA0AgBCgCCCIHIQEgBygCHEEBTgRAA0AgESABKAIQIgkqAhggASgCBCgCECIKKgIYkyAJKgIcIAoqAhySlJIhESABKAIMIgEgB0cNAAsLIAQoAgAiBCAIRw0ACyARQwAAAABdQQFzDQAgBkUEQCADIQEDQCABIAEqAhyMOAIcIAEoAgAiASAFRw0ACwsgACAAKgIgjDgCICAAIAAqAiSMOAIkIAAgACoCKIw4AigLAkAgBg0AIAAgAyoCGCIROAIsIAAgETgCNCAAIAMqAhwiETgCMCAAIBE4AjggAygCACIBIAVGDQADQCABKgIYIhEgACoCLF1BAXNFBEAgACAROAIsIAEqAhghEQsgESAAKgI0XkEBc0UEQCAAIBE4AjQLIAEqAhwiESAAKgIwXUEBc0UEQCAAIBE4AjAgASoCHCERCyARIAAqAjheQQFzRQRAIAAgETgCOAsgASgCACIBIAVHDQALCwumCAIHfwR9IAEoAgQoAggoAgAhBAJAA0ACQCAEKAIUBEADQCAEIgEoAgQoAggoAgAiBCgCFA0ACwsCQAJAAkACQAJAIAEoAhQEQCABIQIMAQsgASgCBCgCBCgCACICRQ0BIAEhBCACKAIURQ0BCyACQQA2AhQCQCACKAIAIgYoAgQoAhAiASAEKAIAIgUoAgQoAhBGBEAgAiEBDAELAkACQAJAAkAgASoCGCIJIAIoAgQoAggoAgAiCCgCACIDKAIEKAIQIgcqAhgiClsEQCABKgIcIgsgByoCHCIMWw0CIAkgCl0NASALIAxfQQFzRQ0BDAMLIAkgCl1BAXMNAgsgASAHIAYoAhAQDEMAAAAAXQRAIAIhAQwECyACQQE2AhQgAigCBCgCBCgCAEEBNgIUIAAoAgAgBhARIgFFDQggACgCACADKAIEIAEQDQ0CDAgLQYgTQZwPQZIEQacTEAAACyAHIAEgAygCEBAMQwAAAABeBEAgAiEBDAILIAhBATYCFCACQQE2AhQgACgCACADEBEiAUUNBSAAKAIAIAYoAgwgAygCBBANRQ0GIAEoAgQhAQsgASgCFCACKAIMOgAVIAQoAhgEQCAEKAIAIgEoAhwNCCABQQA2AhggACgCQCEDIAQoAgQiASgCBCIHIAEoAgg2AgggASgCCCAHNgIEIAEgAygCECIDKAIANgIAIAMgATYCACAEIAAoAkwiASgCADYCACABIAQ2AgAgACgCACAFEA5FDQYgAigCBCgCCCgCACIEKAIAIQUgAiEBDAELIAIoAhhFBEAgAiEBDAELIAIoAgAiASgCHA0HIAFBADYCGCAAKAJAIQMgAigCBCIBKAIEIgcgASgCCDYCCCABKAIIIAc2AgQgASADKAIQIgMoAgA2AgAgAyABNgIAIAIgACgCTCIBKAIANgIAIAEgAjYCACAAKAIAIAYQDkUNBSAEKAIEKAIEKAIAIgEoAgAhBgsgBigCECAFKAIQRg0CIAYoAgQoAhAiAiAFKAIEKAIQIgNGDQEgASgCGA0BIAQoAhgNASACIAAoAkgiB0dBACADIAdHGw0BIAAgARApRQ0CCw8LIAAgARAeGgsgBigCECAFKAIQRw0CIAYoAgQiAygCECAFKAIEIgIoAhBHDQIgBSAFKAIcIAYoAhxqNgIcIAIgAigCHCADKAIcajYCHCABKAIAIQIgASgCGARAIAIoAhwNBAsgAkEANgIYIAAoAkAhBSABKAIEIgIoAgQiAyACKAIINgIIIAIoAgggAzYCBCACIAUoAhAiBSgCADYCACAFIAI2AgAgASAAKAJMIgIoAgA2AgAgAiABNgIAIAAoAgAgBhAORQ0BIAQoAgQoAgQoAgAhAQwCCwsLIABBkAFqQQEQAwALQfMPQZwPQZIBQYoQEAAAC5IRAgt/Bn0jAEEwayIHJAAgASgCACIJKAIQIQMgASgCBCgCCCgCACILKAIAIggoAhAhBAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgCCgCBCgCECIFKgIYIAkoAgQoAhAiBioCGFsEQCAFKgIcIAYqAhxbDQELIAYgACgCSCADEAxDAAAAAF9FDQEgBSAAKAJIIAQQDEMAAAAAYEUNAiADIAAoAkgiAkYNAyACIARGDQMgASgCGA0EIAsoAhgNBAJAIAMgBEYNACADKgIcIg8gBioCHCIOIA4gD2AbIAQqAhwiDiAFKgIcIg0gDSAOXxteDQACQAJAIAMqAhgiDSAEKgIYIhBdRQRAIA4gD2BBAXMNASANIBBcDQELIAUgAyAEEAxDAAAAAF5FDQEMAgsgBiAEIAMQDEMAAAAAXQ0BCyAGIAMgBSAEIAcQUyAHKgIcIhEgAyoCHCIPIAYqAhwiDiAOIA9gG2BFDQYgESAEKgIcIg8gBSoCHCIOIA4gD18bX0UNByAHKgIYIg4gBSoCGCIPIAYqAhgiDSANIA9gG2BFDQggDiAEKgIYIg0gAyoCGCIQIA0gEGAbX0UNCQJAAkAgDiAAKAJIIgoqAhgiD11BAXNFBEAgCioCHCESDAELIA4gD1wNASARIAoqAhwiEl9BAXMNAQsgByASOAIcIAcgDzgCGCAEKgIYIQ0gAyoCGCEQIBIhESAPIQ4LIAMhAgJAAkACfSAQIg8gDSAPXg0AGiANIBBbBEAgECADKgIcIAQqAhxfDQEaCyAEIQIgDQsiDyAOXUEBc0UEQCACKgIcIQ0MAQsgDiAPXA0BIAIqAhwiDSARX0EBcw0BCyAHIA04AhwgByAPOAIYIAMqAhghECANIREgDyEOCwJAAkAgDiAQWwRAIBEgAyoCHFsNAQsgDiAEKgIYXA0BIBEgBCoCHFwNAQsgACABEB4aDAELAkACQAJAIAoqAhgiDiAGKgIYWwRAIAYqAhwgCioCHFsNAQsgBiAKIAcQDEMAAAAAYA0BIAAoAkgiCioCGCEOCyAOIAUqAhhbBEAgBSoCHCAKKgIcWw0CCyAFIAogBxAMQwAAAABfQQFzDQELIAAoAkgiAiAFRgRAIAAoAgAgCSgCBBARRQ0QIAAoAgAgCCgCBCAJEA1FDRAgASgCACgCECECA0AgASgCBCgCBCgCACIBKAIAIgMoAhAgAkYNAAsgASgCGARAIAAoAgAgASgCBCgCCCgCACgCACgCBCADKAIMEBIiAkUNESABKAIYRQ0OIAAoAgAgASgCABAORQ0RIAEgAjYCACABQQA2AhggAiABNgIYIAEoAgQoAgQoAgAiAUUNEQsgASgCBCgCCCgCACIDKAIAIQIgACADIAsQFxpBASEMIAAgASACKAIEKAIMIAIgAkEBEBQMAgsgAiAGRgRAIAAoAgAgCCgCBBARRQ0QIAAoAgAgCSgCDCAIKAIEKAIMEA1FDRAgASgCACgCBCgCECEDIAEhAgNAIAIoAgQoAgQoAgAiAigCACgCBCgCECADRg0ACyACKAIEKAIIKAIAKAIAKAIEKAIIIQMgASAIKAIEKAIMNgIAQQEhDCAAIAIgACABQQAQFygCCCAJKAIEKAIIIANBARAUDAILAkAgBiACIAcQDEMAAAAAYEUEQCAAKAJIIQIMAQsgAUEBNgIUIAEoAgQoAgQoAgBBATYCFCAAKAIAIAkoAgQQEUUNECAJKAIQIgMgACgCSCICKgIYOAIYIAMgAioCHDgCHAsgBSACIAcQDEMAAAAAX0EBcw0BIAtBATYCFCABQQE2AhQgACgCACAIKAIEEBFFDQ8gCCgCECIBIAAoAkgiACoCGDgCGCABIAAqAhw4AhwMAQsgACgCACAJKAIEEBFFDQ4gACgCACAIKAIEEBFFDQ4gACgCACAIKAIEKAIMIAkQDUUNDiAJKAIQIgIgByoCGDgCGCACIAcqAhw4AhwgAEHoAGoiCiAAKAJEIAIQKyEIIAkoAhAiAiAINgIgIAhB/////wBGDQ0gAkF/NgIoIAJCADcCDCACQQA2AhQgAiADKgIMIAYqAhggAioCGCIPkyIOjCAOIA5DAAAAAF0bIAYqAhwgAioCHCIOkyINjCANIA1DAAAAAF0bkiIQQwAAAD+UIAMqAhggD5MiDYwgDSANQwAAAABdGyADKgIcIA6TIg2MIA0gDUMAAAAAXRuSIhEgEJIiEJUiDZQgBioCDCARQwAAAD+UIBCVIhCUkkMAAAAAkiIROAIMIAIgAyoCECANlCAGKgIQIBCUkkMAAAAAkiISOAIQIAIgDSADKgIUlCAQIAYqAhSUkkMAAAAAkiIQOAIUIAIgESAEKgIMIAUqAhggD5MiDYwgDSANQwAAAABdGyAFKgIcIA6TIg2MIA0gDUMAAAAAXRuSIg1DAAAAP5QgBCoCGCAPkyIPjCAPIA9DAAAAAF0bIAQqAhwgDpMiD4wgDyAPQwAAAABdG5IiDiANkiINlSIPlCAFKgIMIA5DAAAAP5QgDZUiDpSSkjgCDCACIBIgBCoCECAPlCAFKgIQIA6UkpI4AhAgAiAQIA8gBCoCFJQgDiAFKgIUlJKSOAIUIAtBATYCFCABQQE2AhQgASgCBCgCBCgCAEEBNgIUCyAHQTBqJAAgDA8LQZcQQZwPQcEEQbAQEAAAC0HCEEGcD0HCBEGwEBAAAAtB7RBBnA9BwwRBsBAQAAALQZgRQZwPQcQEQbAQEAAAC0HFEUGcD0HFBEGwEBAAAAtB9BFBnA9B2ARBsBAQAAALQZkSQZwPQdkEQbAQEAAAC0G+EkGcD0HaBEGwEBAAAAtB4xJBnA9B2wRBsBAQAAALAAtBvg9BnA9BnwFB0A8QAAALAAsgCiAAKAJEECAgAEEANgJECyAAQZABakEBEAMAC5ABAQN/IAAoAkwQDyIEBEACQCAAKAIAECEiBUUNACAFKAIQIgYgAzgCHCAGIAI4AhggBSgCBCgCECIGIAM4AhwgBiABOAIYIAAgBjYCSCAEQQA2AhggBEIANwIIIAQgBTYCACAEQgE3AhAgBCAAKAJAIgUgBSAEEB0iBDYCBCAERQ0ADwsLIABBkAFqQQEQAwALuAEBA38gASgCFARAIAAgASgCACACEE8PCyABIAEoAgwiBEEBaiIFNgIMAkACfwJAIAUgASgCECIDSA0AQf////8AIAAoAgQiBUUNARogASADQQF0NgIQIAEgACgCDCABKAIEIgAgA0EDdCAFEQIAIgM2AgQgAw0AIAEgADYCBEH/////AA8LIARB/////wBGDQEgASgCBCAEQQJ0aiACNgIAIARBf3MLDwtBoQ5BiA1BwANBtA4QAAALmAcBBX8CQCAAKAIsIgEgAEEsaiIERgRAIAQhAgwBCyAEIQMDQAJAAkACQAJAAkACQCADIAEiAigCBEYEQCACKAIIIgUhAQNAIAEoAgQiAyABRg0CIAMoAgQgAUcNAyABKAIMIgMoAggoAgQgAUcNBCABKAIIKAIEKAIMIAFHDQUgASgCFCACRw0GIAMiASAFRw0ACwwGC0GuCUG/CUGeBkHKCRAAAAtB3AlBvwlBoQZBygkQAAALQegJQb8JQaIGQcoJEAAAC0H5CUG/CUGjBkHKCRAAAAtBkwpBvwlBpAZBygkQAAALQa0KQb8JQaUGQcoJEAAACyACIQMgAigCACIBIARHDQALCwJAAkACQCAAKAIwIAJHDQAgACgCNA0AIAAgACgCACIBRgRAIAAhAgwDCyAAIQMMAQtBuwpBvwlBqQZBygkQAAALA0ACQAJAAkACQAJAAkAgAyABIgIoAgRGBEAgAigCCCIFKAIEIQMgBSEBA0AgASADRg0CIAMoAgQgAUcNAyABKAIMKAIIKAIEIAFHDQQgASgCCCIEKAIEIgMoAgwgAUcNBSABKAIQIAJHDQYgBCIBIAVHDQALDAYLQeEKQb8JQa0GQcoJEAAAC0HcCUG/CUGwBkHKCRAAAAtB6AlBvwlBsQZBygkQAAALQfkJQb8JQbIGQcoJEAAAC0GTCkG/CUGzBkHKCRAAAAtB8gpBvwlBtAZBygkQAAALIAIhAyACKAIAIgEgAEcNAAsLAkACQAJAAkACQAJAAkACQAJAIAAoAgQgAkcNACAAKAIIDQAgAEHEAGoiAyECA0AgAigCACIBIANGDQIgASgCBCIEKAIAIAIoAgRHDQMgASAERg0EIAQoAgQgAUcNBSABKAIQRQ0GIAQoAhBFDQcgASgCDCgCCCgCBCABRw0IIAEiAiABKAIIKAIEKAIMRg0AC0GTCkG/CUHCBkHKCRAAAAtB/gpBvwlBuAZBygkQAAALIAAoAkgiASAAQeQAakcNBiABKAIAIAIoAgRHDQYgASgCBCADRw0GIAAoAlQNBiABKAIQDQYgACgCWA0GIAEoAhQNBg8LQaQLQb8JQbwGQcoJEAAAC0HcCUG/CUG9BkHKCRAAAAtB6AlBvwlBvgZBygkQAAALQb8LQb8JQb8GQcoJEAAAC0HOC0G/CUHABkHKCRAAAAtB+QlBvwlBwQZBygkQAAALQd0LQb8JQcgGQcoJEAAACykAIAEoAoQBEBggASgCiAEQGCABKAKMARAYIAAoAgwgASAAKAIIEQEACzwBAn0gAioCGCAAKgIcIgQgASoCHCIDk5QgACoCGCADIAIqAhwiA5OUIAEqAhggAyAEk5SSkkMAAAAAYAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMACzUCAX8CfUEBIQIgACoCGCIDIAEqAhgiBF0Ef0EBBSADIARcBEBBAA8LIAAqAhwgASoCHF8LC/4DAQJ/IAJBgARPBEAgACABIAIQChoPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIAQcAASQ0AIAIgAEFAaiIESw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBE0NAAsLIAAgAk0NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIABJDQALDAELIANBBEkEQCAAIQIMAQsgACADQQRrIgRLBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsLqwcBCX8gACgCBCIHQQNxIQIgACAHQXhxIgZqIQQCQEHUFigCACIFIABLDQAgAkEBRg0ACwJAIAJFBEBBACECIAFBgAJJDQEgAUEEaiAGTQRAIAAhAiAGIAFrQaQaKAIAQQF0TQ0CC0EADwsCQCABIAZNBEAgBiABayICQRBJDQEgACAHQQFxIAFyQQJyNgIEIAAgAWoiASACQQNyNgIEIAQgBCgCBEEBcjYCBCABIAIQJAwBC0EAIQIgBEHcFigCAEYEQEHQFigCACAGaiIFIAFNDQIgACAHQQFxIAFyQQJyNgIEIAAgAWoiAiAFIAFrIgFBAXI2AgRB0BYgATYCAEHcFiACNgIADAELIARB2BYoAgBGBEBBzBYoAgAgBmoiBSABSQ0CAkAgBSABayICQRBPBEAgACAHQQFxIAFyQQJyNgIEIAAgAWoiASACQQFyNgIEIAAgBWoiBSACNgIAIAUgBSgCBEF+cTYCBAwBCyAAIAdBAXEgBXJBAnI2AgQgACAFaiIBIAEoAgRBAXI2AgRBACECQQAhAQtB2BYgATYCAEHMFiACNgIADAELIAQoAgQiA0ECcQ0BIANBeHEgBmoiCSABSQ0BIAkgAWshCgJAIANB/wFNBEAgBCgCCCIGIANBA3YiBUEDdEHsFmpHGiAGIAQoAgwiCEYEQEHEFkHEFigCAEF+IAV3cTYCAAwCCyAGIAg2AgwgCCAGNgIIDAELIAQoAhghCAJAIAQgBCgCDCIDRwRAIAQoAggiAiAFTwRAIAIoAgwaCyACIAM2AgwgAyACNgIIDAELAkAgBEEUaiICKAIAIgYNACAEQRBqIgIoAgAiBg0AQQAhAwwBCwNAIAIhBSAGIgNBFGoiAigCACIGDQAgA0EQaiECIAMoAhAiBg0ACyAFQQA2AgALIAhFDQACQCAEIAQoAhwiBUECdEH0GGoiAigCAEYEQCACIAM2AgAgAw0BQcgWQcgWKAIAQX4gBXdxNgIADAILIAhBEEEUIAgoAhAgBEYbaiADNgIAIANFDQELIAMgCDYCGCAEKAIQIgIEQCADIAI2AhAgAiADNgIYCyAEKAIUIgJFDQAgAyACNgIUIAIgAzYCGAsgCkEPTQRAIAAgB0EBcSAJckECcjYCBCAAIAlqIgEgASgCBEEBcjYCBAwBCyAAIAdBAXEgAXJBAnI2AgQgACABaiICIApBA3I2AgQgACAJaiIBIAEoAgRBAXI2AgQgAiAKECQLIAAhAgsgAgscAEG4FigCAEUEQEG8FiABNgIAQbgWIAA2AgALCzABAn8gACECA0AgAigCBCICKAIAIgMEQCAAKAIMIAEgAyAAKAIUEQIARQ0BCwsgAgsHACAAKAJgCwcAIAAoAmQLBwAgACgCWAsHACAAKAJUCwcAIAAoAlwLzQ0BCH9BKBAWIghBADYCAEEEIQoCQAJAAkACQCAAKAJUIgYEQCAAKAJ0IQcgACgCcCEJQbgWQQA2AgAgCSAHIAYQBEG4FigCACEGQbgWQQA2AgBBfyEHAkAgBkUNAEG8FigCACIJRQ0AIAYoAgAgCEEEEBAiB0UEQAwECyAJEAELEAIhBiAHQQFGDQEgAEEANgJUCyAAKAJgIgYEQCAAKAJ0IQcgACgCcCEJQbgWQQA2AgAgCSAHIAYQBEG4FigCACEGQbgWQQA2AgBBfyEHAkAgBkUNAEG8FigCACIJRQ0AIAYoAgAgCEEEEBAiB0UEQAwECyAJEAELEAIhBiAHQQFGDQEgAEEANgJgCyAAKAJYIgYEQCAAKAJ0IQcgACgCcCEJQbgWQQA2AgAgCSAHIAYQBEG4FigCACEGQbgWQQA2AgBBfyEHAkAgBkUNAEG8FigCACIJRQ0AIAYoAgAgCEEEEBAiB0UEQAwECyAJEAELEAIhBiAHQQFGBEAMAgsgAEEANgJYC0EAIQYgAEEANgJQIAUEQCAAIAUqAgA4AgggACAFKgIEOAIMIAAgBSoCCDgCEAsgACABNgI8IARBAiAEQQJKGyIBQQMgAUEDSBshDCAAQZABaiINQQEgCEEEECYhCBACIQoLA0ACQAJAAkAgBg0AIAAoAgBFDQBBuBZBADYCACAAECdBuBYoAgAhAUG4FkEANgIAQX8hBSABRQ0CQbwWKAIAIgRFDQIgASgCACAIIAoQECIFDQEMBQsgCBAVQQAPCyAEEAELEAIhBiAFQQFGDQBBuBZBADYCAEEEIAAQCSEHQbgWKAIAIQFBuBZBADYCAEF/IQUCQCABRQ0AQbwWKAIAIgRFDQAgASgCACAIIAoQECIFRQRADAQLIAQQAQsQAiEGIAVBAUYNAAJAAkACQAJAAkACQAJAAkACQAJAAkACQCAHRQRAQbgWQQA2AgBBBSANQQEQBEG4FigCACEBQbgWQQA2AgAgAUUNAkG8FigCACIERQ0CIAEoAgAgCCAKEBANAQwPCyAAKAIAIQQgAkECRw0CIAQoAkQiBiAEQcQAaiIJRg0JA0AgBigCACEBAkAgBigCFC0AFSIFIAYoAgQoAhQtABVHBEAgBkEBQX8gBRs2AhwMAQtBuBZBADYCAEEGIAQgBhAGIQtBuBYoAgAhBUG4FkEANgIAQX8hBwJAIAVFDQBBvBYoAgAiBkUNACAFKAIAIAggChAQIgdFBEAgBSAGEAMACyAGEAELEAIhBiAHQQFGDQ4gC0UNBgsgASIGIAlHDQALDAMLIAQQAQsQAiEGDAoLIAQoAiwiBiAEQSxqIglGDQQDQCAGKAIAIQEgBi0AFQRAQbgWQQA2AgBBByAEIAYQBiELQbgWKAIAIQVBuBZBADYCAEF/IQcCQCAFRQ0AQbwWKAIAIgZFDQAgBSgCACAIIAoQECIHRQRAIAUgBhADAAsgBhABCxACIQYgB0EBRg0LIAtFDQMLIAEiBiAJRw0ACwtBuBZBADYCAEEIIAQQBUG4FigCACEBQbgWQQA2AgBBfyEFIAFFDQJBvBYoAgAiBkUNAiABKAIAIAggChAQIgUNAQwLC0G4FkEANgIAQQUgDUEBEARBuBYoAgAhAUG4FkEANgIAAkAgAUUNAEG8FigCACIERQ0AIAEoAgAgCCAKEBBFBEAMCwsgBBABCxACIQYMBwsgBhABCxACIQYgBUEBRg0FIAJBAkcNAQwDC0G4FkEANgIAQQggBBAFQbgWKAIAIQFBuBZBADYCAEF/IQUCQCABRQ0AQbwWKAIAIgZFDQAgASgCACAIIAoQECIFRQRADAkLIAYQAQsQAiEGIAVBAUYNBAtBuBZBADYCAEEJIAAgBCACIAMgDBAIDAILQbgWQQA2AgBBCCAEEAVBuBYoAgAhAUG4FkEANgIAQX8hBQJAIAFFDQBBvBYoAgAiBkUNACABKAIAIAggChAQIgVFBEAMBwsgBhABCxACIQYgBUEBRg0CC0G4FkEANgIAQQogACAEIAwQBwtBuBYoAgAhAUG4FkEANgIAQX8hBQJAIAFFDQBBvBYoAgAiBkUNACABKAIAIAggChAQIgVFBEAMBQsgBhABCxACIQYgBUEBRg0AQbgWQQA2AgBBCyAAQegAaiAEEARBuBYoAgAhAUG4FkEANgIAQX8hBQJAIAFFDQBBvBYoAgAiBEUNACABKAIAIAggChAQIgVFBEAMBAsgBBABCxACIQYgBUEBRg0ACyAAQQA2AgAgACgCBCEAIAgQFSAARQ8LIAYgCRADAAsgASAEEAMACyABIAYQAwALlgMCA38BfQJAAkAgACgCAA0AIAAgAEHoAGoQUSIGNgIAIAYNAAwBCwJAAkACQCAEQQFIDQBBACEGIAFBA04EQEEAIQEDQCAAKAIAIQUCQCABBEAgBSABEBFFDQcgASgCDCEBDAELIAUQISIBRQ0FIAAoAgAgASABKAIEEA1FDQYLIAEoAhAiBSACKgIAOAIMIAUgAioCBDgCECAFIAIqAgg4AhQgACAAKAJQIgdBAWo2AlAgBSAHNgIoIAFBATYCHCABKAIEQX82AhwgAiADaiECIAZBAWoiBiAERw0ACwwBC0EAIQEDQCAAKAIAIQUCQCABRQRAIAUQISIBRQ0FIAAoAgAgASABKAIEEA0NAQwGCyAFIAEQEUUNBSABKAIMIQELIAEoAhAiBSACKgIAOAIMIAIqAgQhCCAFQQA2AhQgBSAIOAIQIAAgACgCUCIHQQFqNgJQIAUgBzYCKCABQQE2AhwgASgCBEF/NgIcIAIgA2ohAiAGQQFqIgYgBEcNAAsLDwsACyAAQQE2AgQPCyAAQQE2AgQLqAQBB38gAEEANgJkIABBADYCXCABKAIsIgUgAUEsaiIIRwRAQQAhAQNAIAUtABUEQCAFKAIIIgQhBgNAIAFBAWohASAGKAIMIgYgBEcNAAsgACABNgJcIAAgA0EBaiIDNgJkCyAFKAIAIgUgCEcNAAsLIAAgACgCdCADQQN0IAAoAmgRAAAiATYCYAJAIAFFBEAMAQsgACAAKAJ0IAIgACgCXGxBAnQgACgCaBEAACIBNgJUIAFFBEAMAQsgACAAKAJ0IAAoAlxBAnQgACgCaBEAACIGNgJYIAZFBEAMAQsCQCAIKAIAIgMgCEYNACAAKAJgIQQgACgCVCEBIAJBA04EQANAIAMtABUEQEEAIQAgAygCCCIJIQUDQCABIAUoAhAiAioCDDgCACABIAIqAhA4AgQgASACKgIUOAIIIAYgAigCKDYCACAAQQFqIQAgBkEEaiEGIAFBDGohASAFKAIMIgUgCUcNAAsgBCAANgIEIAQgBzYCACAAIAdqIQcgBEEIaiEECyADKAIAIgMgCEcNAAwCCwALA0AgAy0AFQRAQQAhACADKAIIIgkhAgNAIAEgAigCECIFKgIMOAIAIAEgBSoCEDgCBCAGIAUoAig2AgAgAEEBaiEAIAZBBGohBiABQQhqIQEgAigCDCICIAlHDQALIAQgADYCBCAEIAc2AgAgACAHaiEHIARBCGohBAsgAygCACIDIAhHDQALCw8LIABBATYCBAufBwEIfwJAAkAgA0EESA0AIAEgAxBQDQAMAQsgASABKAIAIgVHBEADQCAFQX82AiQgBSgCACIFIAFHDQALCwJAAkAgASgCLCIKIAFBLGoiC0YEQAwBCwNAIApBfzYCECAKLQAVBEBBACEGIAooAggiDCEFA0AgBiEIIAUoAhAiBigCJEF/RgRAIAYgBzYCJCAHQQFqIQcLIAhBAWohBiAFKAIMIgUgDEcNAAsgAyAITA0DIAogCTYCECAJQQFqIQkLIAooAgAiCiALRw0ACwsgACAJNgJkIAAgACgCdCADIAkgAkEBRnRsQQJ0IAAoAmgRAAAiBjYCYCAGRQRADAILIAAgBzYCXCAAIAAoAnQgBCAHbEECdCAAKAJoEQAAIgY2AlQgBkUEQAwCCyAAIAAoAnQgACgCXEECdCAAKAJoEQAAIgc2AlgCQAJAIAcEQCABKAIAIgUgAUYNAiAEQQNIDQEDQCAFKAIkIghBf0cEQCAAKAJUIAQgCGxBAnRqIgYgBSoCDDgCACAGIAUqAhA4AgQgBiAFKgIUOAIIIAcgCEECdGogBSgCKDYCAAsgBSgCACIFIAFHDQALDAILDAMLA0AgBSgCJCIIQX9HBEAgACgCVCAEIAhsQQJ0aiIGIAUqAgw4AgAgBiAFKgIQOAIEIAcgCEECdGogBSgCKDYCAAsgBSgCACIFIAFHDQALCwJAIAsoAgAiASALRg0AIAAoAmAhBSACQQFGBEADQAJAIAEtABVFDQBBACEHIAEoAggiAiEGA0AgBSAGKAIQKAIkNgIAIAciAEEBaiEHIAVBBGohBSAGKAIMIgYgAkcNAAsgAyAHSgRAIAUgAyAHa0ECdBAcIANBAnRqIABBf3NBAnRqIQULIAIhBgNAQX8hBAJAIAYoAgQoAhQiCEUNACAILQAVRQ0AIAgoAhAhBAsgBSAENgIAIAVBBGohBSAGKAIMIgYgAkcNAAsgAyAHTA0AIAUgAyAHa0ECdBAcIANBAnRqIABBf3NBAnRqIQULIAEoAgAiASALRw0ADAILAAsDQAJAIAEtABVFDQBBACEEIAEoAggiAiEGA0AgBSAGKAIQKAIkNgIAIAQiAEEBaiEEIAVBBGohBSAGKAIMIgYgAkcNAAsgAyAETA0AIAUgAyAEa0ECdBAcIANBAnRqIABBf3NBAnRqIQULIAEoAgAiASALRw0ACwsPC0HhFUGhFUHyBEH3FRAAAAsgAEEBNgIEC9gBAQJ/IwBBMGsiASQAIAEgACkCiAE3AyggASAAKQKAATcDICABIAApAng3AxggASAAKQJwNwMQIAEgACkCaDcDCCAAKAJMEBggACgCACICBEAgAUEIaiACEC0gAEEANgIACyAAKAJUIgIEQCABKAIUIAIgASgCEBEBACAAQQA2AlQLIAAoAlgiAgRAIAEoAhQgAiABKAIQEQEAIABBADYCWAsgACgCYCICBEAgASgCFCACIAEoAhARAQAgAEEANgJgCyABKAIUIAAgASgCEBEBACABQTBqJAAL/wICA38BfiAAQYgWIAAbIgIoAgAiAEUEQCACQYgWKAIAIgA2AgALIAIoAgRFBEAgAkGMFigCADYCBAsgAigCCEUEQCACQZAWKAIANgIICyACKAIMQawCIAARAAAiAUUEQEEADwsgASACKQIANwJoIAEgAikCIDcCiAEgASACKQIYNwKAASABIAIpAhAiBDcCeCABIAIpAgg3AnAgBKdFBEAgAUGABDYCeAsgASgCfEUEQCABQYAENgJ8CyABKAKAAUUEQCABQYACNgKAAQsgASgChAFFBEAgAUGABDYChAELIAEoAogBIgBFBEAgAUGAAjYCiAFBgAIhAAsgAUHoAGohAyABQgA3AiwgAUEANgIQIAFCADcCCCABQgA3AjQgAUEANgI8QRAhAgJAIABBEE4EQEGAICECIABBgSBIDQELIAEgAjYCiAEgAiEACyADQdkVQRwgABAZIQAgAUIANwJQIAFCADcCACABIAA2AkwgAUIANwJYIAFCADcCYCABCwYAIAEQFQsIACABIAIQJQsGACABEBYLvAUCBX8CfQJAAkAgASgCCCIBKAIMIgIgAUYNACACKAIMIAFGDQADQAJAIAEoAgQoAhAiAyoCGCIHIAEoAhAiAioCGCIIXUUEQCAHIAhcDQEgAyoCHCACKgIcX0UNAQsgASgCCCgCBCEBDAELCwNAAkAgByAIXkUEQCAHIAhcDQEgAioCHCADKgIcX0EBcw0BCyABKAIMIgEoAhAiAioCGCEIIAEoAgQoAhAiAyoCGCEHDAELCwJAIAEoAggoAgQiAiABKAIMRg0AA0ACQAJAIAcgAigCECIEKgIYIghdRQRAIAcgCFwNASADKgIcIAQqAhxfQQFzDQELAkAgAigCDCIDIAFGDQAgAkEMaiEEA0ACQCADKAIEKAIQIgUqAhgiByADKAIQIgYqAhgiCF0NACAHIAhbBEAgBSoCHCAGKgIcXw0BCyACKAIQIAIoAgQoAhAgBRAMQwAAAABfQQFzDQIgBCgCACEDCyAAIAMgAhASIgJFBEBBAA8LIAIoAgQiAkEMaiEEIAIoAgwiAyABRw0ACwsgAigCCCgCBCECDAELAkAgAigCDCABRg0AA0ACQCABKAIIKAIEIgMoAhAiBCoCGCIHIAMoAgQoAhAiBSoCGCIIXQ0AIAcgCFsEQCAEKgIcIAUqAhxfDQELIAEoAgQoAhAgASgCECAEEAxDAAAAAGBBAXMNAiABKAIIKAIEIQMLIAAgASADEBIiAUUEQEEADwsgASgCBCIBIAIoAgxHDQALCyABKAIMIQELIAEoAgwgAkYNASABKAIEKAIQIgMqAhghBwwACwALIAIoAgwiAyABRg0BIAEgAygCDEcEQANAIAAgAyACEBIiAkUEQEEADwsgAigCBCICKAIMIgMoAgwgAUcNAAsLQQEPC0H3FEGhFUHAAkGsFRAAAAtByRVBoRVB5AJBrBUQAAALfQECfyAAKAIMQRggACgCABEAACICRQRAQQAPCyACQQI2AhQgAiABNgIMIAJBADYCACACIAI2AgggAiACNgIEQRAhAwJAIAAoAhwiAUEQTgRAQYAgIQMgAUGBIEgNAQsgACADNgIcIAMhAQsgAiAAQYAIQQwgARAZNgIQIAILwwECA38BfQJAAkAgAioCGCIGIAEoAgAiAygCECIEKgIYWwRAIAQqAhwgAioCHFsNAQsCQCAGIAMoAgQiBCgCECIFKgIYWwRAIAUqAhwgAioCHFsNAQsgACgCACAEEBFFDQIgASgCGARAIAAoAgAgAygCCBAORQ0DIAFBADYCGAsgACgCACACKAIIIAMQDUUNAiAAIAIQGg8LQYoPQZwPQZ8HQagPEAAAC0GKD0GcD0GKB0GoDxAAAAsgAEGQAWpBARADAAvWAQICfwJ9IAIoAgAiAigCBCgCECEDIAEoAgAiASgCBCgCECIEIAAoAkgiAEYEQCAAIANGBEACQCABKAIQIgEqAhgiBSACKAIQIgIqAhgiBl1FBEAgBSAGXA0BIAEqAhwgAioCHF9BAXMNAQsgACABIAIQDEMAAAAAXw8LIAAgAiABEAxDAAAAAGAPCyADIAAgAigCEBAMQwAAAABfDwsgASgCECEBIAAgA0YEQCAEIAAgARAMQwAAAABgDwsgBCAAIAEQIyACKAIEKAIQIAAgAigCEBAjYAvcCAIGfwR9AkAgACgCACIDKAJEIgIgA0HEAGoiBUcEQANAIAIoAgwhASACKAIAIQMCQAJAIAIoAhAiBCoCGCACKAIEKAIQIgYqAhhcDQAgBCoCHCAGKgIcXA0AIAEoAgwgAkYNAAJAIAAoAgAgASACEA0EQCAAKAIAIAIQDkUNASABKAIMIQQMAwsMBQsMBAsgASEEIAIhAQsCQCABIAQoAgxHBEAgAyECDAELIAEgBEcEQAJAIAMgBEcEQCAEIAMoAgRHDQELIAMoAgAhAwsgACgCACAEEA5FDQQLAn8CQCABIANGDQAgASADKAIERg0AIAMMAQsgAygCAAshAiAAKAIAIAEQDkUNAwsgAiAFRw0ACyAAKAIAIQMLQQAhAiADIAMoAgAiAUcEQANAIAJBAWohAiABKAIAIgEgA0cNAAsLIAAgAEHoAGoiBSAAKAKMASIBQQggAUEIShsgAmoQTSIBNgJEAkACQAJAAkACQCABBH8CQAJAIAAoAgAiBCgCACICIARHBEADQCACIAUgASACECsiAzYCICADQf////8ARg0CIAIoAgAiAiAERw0ACwsgBSABEEwNAQsgBSAAKAJEECAgAEEANgJEQQAPCyAAIAUgABBGIgE2AkAgAUUNBiAAIAAqAiwiByAAKgI0IgggB5MiB5MiCSAIIAeSIgcgACoCMCIIIAAqAjgiCiAIkyIIkxAqIAAgCSAHIAogCJIQKiAAKAJEEB8iAgRAA0ACQCAAKAJEEEsiAUUNACABKgIYIAIqAhhcDQAgASoCHCACKgIcXA0AIAAoAkQQHyEBIAAoAgAgAigCCCABKAIIEA0NAQwJCyAAIAIQGiAAKAJEEB8iAg0ACwsgACAAKAJAIgMoAgQoAgAiAigCACgCEDYCSEEAIQEDQAJAIAIoAhAEQCABIQQMAQsgAigCGEUNA0EBIQQgAQ0ECyACKAIIDQQgAigCACEBIAIoAhgEQCABKAIcDQYLIAFBADYCGCACKAIEIgEoAgQiBiABKAIINgIIIAEoAgggBjYCBCABIAMoAhAiAygCADYCACADIAE2AgAgAiAAKAJMIgEoAgA2AgAgASACNgIAIAQhASAAKAJAIgMoAgQoAgAiAg0ACyADKAIQEBggBSgCDCADIAUoAggRAQAgBSAAKAJEECAgACgCACIEKAIsIgEgBEEsaiIDRwR/A0AgASgCCCIEKAIMIgIgBEYNByABKAIAIQECQCACKAIMIARHDQAgBCgCCCICIAIoAhwgBCgCHGo2AhwgAigCBCICIAIoAhwgBCgCBCgCHGo2AhwgACgCACAEEA4NAEEADwsgASADRw0ACyAAKAIABSAECxAsQQEFQQALDwtBvg9BnA9B+QhBnBQQAAALQakUQZwPQfoIQZwUEAAAC0G7FEGcD0H8CEGcFBAAAAtB8w9BnA9BkgFBihAQAAALQdMUQZwPQecJQeEUEAAACyAAQZABakEBEAMAC5YBAQN/IAFBAE4EQCAAKAIAIAEQTg8LAkAgAUF/cyIBIAAoAhBODQAgACgCBCABQQJ0aiIBKAIARQ0AIAFBADYCAAJAIAAoAgwiAUEBSA0AIAAoAgghAwNAIAMgAUEBayICQQJ0aigCACgCAA0BIAAgAjYCDCABQQFKIQQgAiEBIAQNAAsLDwtBvQ5BiA1B/ANB5g4QAAALkwECAX8CfSAAKAIMIgFFBEAgACgCACIAKAIEIAAoAgAoAgRBA3RqKAIADwsgACgCCCABQQJ0akEEaygCACgCACEBAkACQCAAKAIAIgAoAghFDQAgACgCBCAAKAIAKAIEQQN0aigCACIAKgIYIgIgASoCGCIDXQ0BIAIgA1wNACAAKgIcIAEqAhxfDQELIAEhAAsgAAvYBwIOfwJ9IwBBkANrIgskACABIAAoAgwgASgCDEECdEEEaiAAKAIAEQAAIgM2AggCQAJAIANFBEAMAQsgAyADIAEoAgwiD0ECdGpBBGsiBk0EQCABKAIEIQAgAyECA0AgAiAANgIAIABBBGohACACQQRqIgIgBk0NAAsLIAsgBjYCBCALIAM2AgBBw+HDwQchDEEBIQQDQCALIARBA3RqQQRrKAIAIgkgCyAIQQN0aigCACIFQShqSwRAA0AgBSAMQY2+ht4FbEEBaiIMIAkgBWtBAnVBAWpwQQJ0aiIAKAIAIQ0gACAFKAIANgIAIAUgDTYCACAJQQRqIQIgBUEEayEAA0AgAiEDIABBBGohAgJ/An8gACAAKAIEIgooAgAiByoCGCIQIA0oAgAiDioCGCIRXQ0AGgNAIAIhBAJAIBAgEVwNACAHKgIcIA4qAhxfRQ0AIAAhBiAEDAMLIARBBGohAiAEIgAoAgQiCigCACIHKgIYIhAgEV1BAXMNAAsgAAshBiACCyEAAkAgESADQQRrIgIoAgAiBCgCACIHKgIYIhBdDQADQAJAIBAgEVwNACAOKgIcIAcqAhxfRQ0ADAILIBEgAiIDQQRrIgIoAgAiBCgCACIHKgIYIhBdQQFzDQALCyAAIAQ2AgAgAiAKNgIAIAAgAkkNAAsgACgCACEEIAAgCjYCACACIAQ2AgACQCAAIAVrIAkgAmtIBEAgAyEAIAkhAiAGIQkMAQsgBSEAIAYhAiADIQULIAsgCEEDdGoiAyACNgIEIAMgADYCACAIQQFqIQggCSAFQShqSw0ACwsgCCEEIAkgBUEEaiIKTwRAA0AgCigCACEDAkAgCiICIgAgBU0NAANAIAMoAgAiBioCGCIQIAJBBGsiACgCACIHKAIAIggqAhgiEV0EQCACIQAMAgsCQCAQIBFcDQAgBioCHCAIKgIcX0UNACACIQAMAgsgAiAHNgIAIAUgACICSQ0ACwsgACADNgIAIApBBGoiCiAJTQ0ACwsgBEEBayEIIARBAU4NAAtBASECIAFBATYCFCABIA82AhAgASgCACIDKAIIIgBBAU4EQANAIAMgABAbIABBAUohBiAAQQFrIQAgBg0ACwsgA0EBNgIUIAEoAggiACAAIAEoAgxBAnRqQQRrIgNPDQAgACgCACgCACIHKgIYIRADQCAAKAIEKAIAIgEqAhgiESAQXUUEQCAQIBFcDQMgASoCHCAHKgIcX0UNAwsgESEQIAEhByAAQQRqIgAgA0kNAAsLIAtBkANqJAAgAg8LQYYOQYgNQZ0DQZoOEAAAC/ICAQR/IAAoAgxBHCAAKAIAEQAAIgNFBEBBAA8LAkACQAJAIAAoAgxBHCAAKAIAEQAAIgJFDQAgAiABNgIMIAJBADYCCCACIAAoAgwgAUEBaiIEQQJ0IAAoAgARAAAiBTYCACAFRQRAIAAoAgwgAiAAKAIIEQEADAELIAIgACgCDCAEQQN0IAAoAgARAAAiBDYCBCAEDQEgACgCDCACKAIAIAAoAggRAQAgACgCDCACIAAoAggRAQALIANBADYCAAwBCyACQQE2AhggAkIANwIQIAIoAgBBATYCBCAEQQA2AgggAyACNgIAIAMgACgCDCABQQJ0IAAoAgARAAAiAjYCBCACRQRAIAAoAgwgAygCACIBKAIEIAAoAggRAQAgACgCDCABKAIAIAAoAggRAQAgACgCDCABIAAoAggRAQAMAQsgA0EBNgIYIANBADYCFCADIAE2AhAgA0EANgIMIAMPCyAAKAIMIAMgACgCCBEBAEEAC6sDAgt/An0CQCABQQFIDQAgACgCDCABSA0AIAAoAgQiBCABQQN0aiIHKAIARQ0AIAAoAgAiBSAHKAIEIgNBAnRqIAUgACgCCCICQQJ0aigCACIINgIAIAQgCEEDdGoiDCADNgIEIAAgAkEBazYCCAJAIAIgA0wNAAJAAkAgA0ECSA0AIAQgBSADQQF2IglBAnRqKAIAIgZBA3RqKAIAIgIqAhgiDSAEIAhBA3RqKAIAIgoqAhgiDl0NACANIA5cDQEgAioCHCAKKgIcX0EBcw0BCyAAIAMQGwwBCwJAIA4gBCAGQQN0aigCACILKgIYIg1eBEAgAyECDAELA0AgCSECAkAgDSAOXA0AIAsqAhwgCioCHF9FDQAgAyECDAILIAUgA0ECdGogBjYCACAEIAZBA3RqIAM2AgQgAkEBdSIJRQ0BIAIhAyAEIAUgCUECdGooAgAiBkEDdGooAgAiCyoCGCINIA5dQQFzDQALCyAFIAJBAnRqIAg2AgAgDCACNgIECyAHQQA2AgAgByAAKAIQNgIEIAAgATYCEA8LQaUNQYgNQZICQdwNEAAAC8UDAgd/An0gASABKAIIQQFqIgM2AggCQAJAIAEoAgwiBCADQQF0Tg0AQf////8AIQUgACgCBCIGRQ0BIAEgBEEBdDYCDCABKAIEIQcgASAAKAIMIAEoAgAiCCAEQQN0QQRyIAYRAgAiBDYCACAERQRAIAEgCDYCAEH/////AA8LIAEgACgCDCABKAIEIAEoAgxBA3RBCGogACgCBBECACIANgIEIAANACABIAc2AgQMAQsgASgCBCEEIAMhBSABKAIQIgAEQCABIAQgAEEDdGooAgQ2AhAgACEFCyABKAIAIgYgA0ECdGogBTYCACAEIAVBA3RqIgcgAjYCACAHIAM2AgQgASgCFARAAkAgA0EBdSIARQRAIAMhAQwBCyACKgIYIQoDQCAKIAQgBiAAIgFBAnRqKAIAIgBBA3RqIggoAgAiCSoCGCILXgRAIAMhAQwCCwJAIAogC1wNACAJKgIcIAIqAhxfRQ0AIAMhAQwCCyAGIANBAnRqIAA2AgAgCCADNgIEIAEhAyABQQF1IgANAAsLIAYgAUECdGogBTYCACAHIAE2AgQLIAVB/////wBHDQBB9QxBiA1B8AFBmA0QAAALIAULogIBC38gACgCLCIEIABBLGoiCkcEQANAIAQtABUEQCAEQQhqKAIAIggoAhAhCwNAIAgiAigCDCEIAkAgAigCBCIDRQ0AIAMoAhQiB0UNACAHLQAVRQ0AQQAhBSAEKAIIIgkhBgNAIAUiDEEBaiEFIAYoAgwiBiAJRw0AC0EAIQUgBygCCCIHIQYDQCAFIglBAWohBSAGKAIMIgYgB0cNAAsgASAJIAxqTgRAIAIoAggoAgQoAhAgAigCECADKAIMKAIMKAIQEC5FDQEgAygCCCgCBCgCECADKAIQIAIoAgwoAgwoAhAQLkUNASADKAIMIQggACADEA4NAkEADwsgAkUNAQsgAigCDCgCECALRw0ACwsgBCgCACIEIApHDQALC0EBC90CAQR/IAAoAgxBkAEgACgCABEAACIBRQRAQQAPC0EQIQICQCAAKAIQIgNBEE4EQEGAICECIANBgSBIDQELIAAgAjYCECACIQMLQRAhAgJAIAAoAhQiBEEQTgRAQYAgIQIgBEGBIEgNAQsgACACNgIUC0EQIQICQCAAKAIYIgRBEE4EQEGAICECIARBgSBIDQELIAAgAjYCGAsgASAAQYoJQcAAIAMQGTYChAEgASAAQZUJQSwgACgCFBAZNgKIASABIABBowlBGCAAKAIYEBk2AowBIAEgAUEsaiIANgIwIAFBADYCCCABQgA3AkwgASABQeQAaiICNgJIIAEgAUHEAGoiAzYCRCABQQA7AUAgAUIANwI0IAEgADYCLCABQgA3AlQgAUIANwJcIAFCADcCbCABIAM2AmggASACNgJkIAFCADcCdCABQgA3AnwgASABNgIEIAEgATYCACABC7wCAQV/AkAgACgChAEQDyICRQ0AIAIgASgCBCIEIAEgASAESxsiBigCBCIDKAIAIgQ2AiAgBCgCBCACNgIAIAIgBjYCACADIAJBIGoiBDYCACACQgA3AhAgAiAENgIMIAIgBDYCBCACQgA3AhggAkIANwIwIAIgBDYCKCACQgA3AjggAiACNgIIIAIgAjYCLCACIAI2AiQgASgCDCIGKAIIIQMgAiAGNgIsIAMoAgQgAjYCDCACIAM2AgggBiACNgIIIAIgASgCBCgCEDYCECAAKAKIARAPIgNFDQAgAyACKAIQIgUoAgQiADYCBCAAIAM2AgAgAyAFNgIAIAUgAzYCBCADIAQ2AgggBCEAA0AgACADNgIQIAAoAggiACAERw0ACyACIAEoAhQiADYCFCACIAA2AjQgAiEFCyAFC6YRAgN/B30CQAJAIAAqAhgiCSABKgIYIghdDQAgCCAJWwRAIAAqAhwgASoCHF8NAQsgACEGDAELIAEhBiAAIQELAkACQCACKgIYIgkgAyoCGCIIXQ0AIAggCVsEQCACKgIcIAMqAhxfDQELIAIhAAwBCyAJIQggAyEAIAIhAwsCQAJAIAEqAhgiCSAIXQ0AIAggCVsEQCABKgIcIAMqAhxfDQELIAYhAiABIQUMAQsgCCEJIAAhAiADIQUgBiEAIAEhAwsCQAJAAkACQAJAAkACQAJAIAQCfQJAIAkgACoCGCIKXSIBDQAgCSAKWwRAIAUqAhwgACoCHF8NAQsgCSAKkkMAAAA/lAwBCwJAIAogAioCGCILXSIHRQRAIAogC1wiBg0BIAAqAhwgAioCHF9BAXMNAQsgAyoCGCIIIAldRQRAIAggCVwNBiADKgIcIAUqAhxfQQFzDQYLIAFFBEAgCSAKXA0GIAUqAhwgACoCHF9FDQYLIAogCZMiDSAJIAiTIgiSIg5DAAAAAF5BAXNFBEAgBSoCHCADIAAgCCANXSIGGyoCHCIMkyAIIA0gBhsgDpUgDCAAIAMgBhsqAhyTlJIhDAsgAUUEQCAJIApcDQYgBSoCHCAAKgIcX0EBcw0GCyAHRQRAIAogC1wNBiAAKgIcIAIqAhxfRQ0GC0MAAAAAIQggDIwgDAJ/IA0gCyAKkyILkiIOQwAAAABeQQFzRQRAIAAqAhwgBSACIAsgDV4iARsqAhwiCJMgDSALIAEbIA6VIAggAiAFIAEbKgIck5SSIQgLIAwgCJJDAAAAAF0iAQsbQwAAAACXIgsgCIwgCCABG0MAAAAAlyIIX0EBc0UEQCAJIAqSQwAAAD+UIAhDAAAAAFsNAhogCSANIAsgCyAIkpWUkgwCCyAKIAkgCpMgCCALIAiSlZSSDAELIAMqAhgiDSAJXUUEQCAJIA1cDQcgAyoCHCAFKgIcX0EBcw0HCyABRQRAIAkgClwNByAFKgIcIAAqAhxfRQ0HC0MAAAAAIQggCiAJkyIMIAkgDZMiDpJDAAAAAF5BAXNFBEAgDiAFKgIcIgggACoCHJOUIAwgCCADKgIck5SSIQgLIAsgDV5FBEAgCyANXA0HIAMqAhwgAioCHF9BAXMNBwsgCiALXkUEQCAGDQcgAioCHCAAKgIcX0UNBwtDAAAAACEMIAiMIAgCfyAKIAuTIgogCyANkyINkkMAAAAAXkEBc0UEQCANIAIqAhwiDCAAKgIck5QgCiAMIAMqAhyTlJIhDAsgCCAMk0MAAAAAXSIBCxtDAAAAAJciCiAMIAyMIAEbQwAAAACXIghfQQFzRQRAIAkgC5JDAAAAP5QgCEMAAAAAWw0BGiAJIAsgCZMgCiAKIAiSlZSSDAELIAsgCSALkyAIIAogCJKVlJILOAIYIAMqAhwiCSAAKgIcIghdDQEgCCAJWwRAIAMqAhggACoCGF8NAgsgAyEGDAILAAsgACEGIAMhAAsCQAJAIAUqAhwiCCACKgIcIgldDQAgCCAJWwRAIAUqAhggAioCGF8NAQsgBSEDDAELIAghCSACIQMgBSECCwJAAkAgACoCHCIIIAldDQAgCCAJWwRAIAAqAhggAioCGF8NAQsgBiEFIAAhAQwBCyADIQUgAiEBIAYhAyAAIQILAkAgASoCHCIJIAMqAhwiCl0iAA0AIAkgClsEQCABKgIYIAMqAhhfDQELDAILAkACQAJAIAogBSoCHCILXSIHRQRAIAogC1wiBg0BIAMqAhggBSoCGF9BAXMNAQsgAioCHCIIIAldRQRAIAggCVwNByACKgIYIAEqAhhfQQFzDQcLIABFBEAgCSAKXA0HIAEqAhggAyoCGF9FDQcLQwAAAAAhDCAKIAmTIg0gCSAIkyIIkiIOQwAAAABeQQFzRQRAIAEqAhggAiADIAggDV0iBhsqAhgiDJMgCCANIAYbIA6VIAwgAyACIAYbKgIYk5SSIQwLIABFBEAgCSAKXA0HIAEqAhggAyoCGF9BAXMNBwsgB0UEQCAKIAtcDQcgAyoCGCAFKgIYX0UNBwtDAAAAACEIIAyMIAwCfyANIAsgCpMiC5IiDkMAAAAAXkEBc0UEQCADKgIYIAEgBSALIA1eIgAbKgIYIgiTIA0gCyAAGyAOlSAIIAUgASAAGyoCGJOUkiEICyAMIAiSQwAAAABdIgALG0MAAAAAlyILIAiMIAggABtDAAAAAJciCF9BAXNFBEAgCEMAAAAAWwRADAYLIAQgCSANIAsgCyAIkpWUkjgCHA8LIAQgCiAJIAqTIAggCyAIkpWUkjgCHA8LIAIqAhwiDSAJXUUEQCAJIA1cDQcgAioCGCABKgIYX0EBcw0HCyAARQRAIAkgClwNByABKgIYIAMqAhhfRQ0HC0MAAAAAIQggCiAJkyIMIAkgDZMiDpJDAAAAAF5BAXNFBEAgDiABKgIYIgggAyoCGJOUIAwgCCACKgIYk5SSIQgLIAsgDV5FBEAgCyANXA0CIAIqAhggBSoCGF9BAXMNAgsgCiALXkUEQCAGDQIgBSoCGCADKgIYX0UNAgtDAAAAACEMIAiMIAgCfyAKIAuTIgogCyANkyINkkMAAAAAXkEBc0UEQCANIAUqAhgiDCADKgIYk5QgCiAMIAIqAhiTlJIhDAsgCCAMk0MAAAAAXSIACxtDAAAAAJciCiAMIAyMIAAbQwAAAACXIghfQQFzRQRAIAhDAAAAAFsEQCAEIAkgC5JDAAAAP5Q4AhwPCyAEIAkgCyAJkyAKIAogCJKVlJI4AhwPCyAEIAsgCSALkyAIIAogCJKVlJI4AhwPCwALDAQLQYUIQagIQTpBswgQAAALIAQgCSAKkkMAAAA/lDgCHA8LQYUIQagIQdIAQb8IEAAAC0HLCEGoCEHxAEHwCBAAAAtBywhBqAhBiQFB/QgQAAALC6UOAwBBgAgLhQ5EaWN0AFZlcnRMZXEoIHUsIHYgKSAmJiBWZXJ0TGVxKCB2LCB3ICkAc3JjL2dlb20uYwB0ZXNlZGdlRXZhbAB0ZXNlZGdlU2lnbgBUcmFuc0xlcSggdSwgdiApICYmIFRyYW5zTGVxKCB2LCB3ICkAdGVzdHJhbnNFdmFsAHRlc3RyYW5zU2lnbgBNZXNoIEVkZ2VzAE1lc2ggVmVydGljZXMATWVzaCBGYWNlcwBmLT5wcmV2ID09IGZQcmV2AHNyYy9tZXNoLmMAdGVzc01lc2hDaGVja01lc2gAZS0+U3ltICE9IGUAZS0+U3ltLT5TeW0gPT0gZQBlLT5MbmV4dC0+T25leHQtPlN5bSA9PSBlAGUtPk9uZXh0LT5TeW0tPkxuZXh0ID09IGUAZS0+TGZhY2UgPT0gZgBmLT5wcmV2ID09IGZQcmV2ICYmIGYtPmFuRWRnZSA9PSBOVUxMAHYtPnByZXYgPT0gdlByZXYAZS0+T3JnID09IHYAdi0+cHJldiA9PSB2UHJldiAmJiB2LT5hbkVkZ2UgPT0gTlVMTABlLT5TeW0tPm5leHQgPT0gZVByZXYtPlN5bQBlLT5PcmcgIT0gTlVMTABlLT5Ec3QgIT0gTlVMTABlLT5TeW0tPm5leHQgPT0gZVByZXYtPlN5bSAmJiBlLT5TeW0gPT0gJm1lc2gtPmVIZWFkU3ltICYmIGUtPlN5bS0+U3ltID09IGUgJiYgZS0+T3JnID09IE5VTEwgJiYgZS0+RHN0ID09IE5VTEwgJiYgZS0+TGZhY2UgPT0gTlVMTCAmJiBlLT5SZmFjZSA9PSBOVUxMAGZyZWUgIT0gSU5WX0hBTkRMRQBzcmMvcHJpb3JpdHlxLmMAcHFIZWFwSW5zZXJ0AGhDdXJyID49IDEgJiYgaEN1cnIgPD0gcHEtPm1heCAmJiBoW2hDdXJyXS5rZXkgIT0gTlVMTABwcUhlYXBEZWxldGUAcHEgIT0gTlVMTABwcURlbGV0ZVByaW9yaXR5UQBMRVEoICoqKGkrMSksICoqaSApAHBxSW5pdABjdXJyICE9IElOVl9IQU5ETEUAcHFJbnNlcnQAY3VyciA8IHBxLT5tYXggJiYgcHEtPmtleXNbY3Vycl0gIT0gTlVMTABwcURlbGV0ZQBjaGlsZCA8PSBwcS0+bWF4AEZsb2F0RG93bgBUT0xFUkFOQ0VfTk9OWkVSTwBzcmMvc3dlZXAuYwBDb25uZWN0TGVmdERlZ2VuZXJhdGUAcmVnLT5maXhVcHBlckVkZ2UARml4VXBwZXJFZGdlAEZBTFNFAElzV2luZGluZ0luc2lkZQByZWctPmVVcC0+d2luZGluZyA9PSAwAERlbGV0ZVJlZ2lvbgAhIFZlcnRFcSggZHN0TG8sIGRzdFVwICkAQ2hlY2tGb3JJbnRlcnNlY3QARWRnZVNpZ24oIGRzdFVwLCB0ZXNzLT5ldmVudCwgb3JnVXAgKSA8PSAwAEVkZ2VTaWduKCBkc3RMbywgdGVzcy0+ZXZlbnQsIG9yZ0xvICkgPj0gMABvcmdVcCAhPSB0ZXNzLT5ldmVudCAmJiBvcmdMbyAhPSB0ZXNzLT5ldmVudAAhIHJlZ1VwLT5maXhVcHBlckVkZ2UgJiYgISByZWdMby0+Zml4VXBwZXJFZGdlAE1JTiggb3JnVXAtPnQsIGRzdFVwLT50ICkgPD0gaXNlY3QudABpc2VjdC50IDw9IE1BWCggb3JnTG8tPnQsIGRzdExvLT50ICkATUlOKCBkc3RMby0+cywgZHN0VXAtPnMgKSA8PSBpc2VjdC5zAGlzZWN0LnMgPD0gTUFYKCBvcmdMby0+cywgb3JnVXAtPnMgKQAhIFZlcnRFcSggZVVwLT5Ec3QsIGVMby0+RHN0ICkAQ2hlY2tGb3JMZWZ0U3BsaWNlAFZlcnRMZXEoIGUtPk9yZywgZS0+RHN0ICkAQWRkUmlnaHRFZGdlcwByZWdQcmV2LT53aW5kaW5nTnVtYmVyIC0gZS0+d2luZGluZyA9PSByZWctPndpbmRpbmdOdW1iZXIARG9uZUVkZ2VEaWN0ACsrZml4ZWRFZGdlcyA9PSAxAHJlZy0+d2luZGluZ051bWJlciA9PSAwAGUtPkxuZXh0ICE9IGUAUmVtb3ZlRGVnZW5lcmF0ZUZhY2VzAHVwLT5MbmV4dCAhPSB1cCAmJiB1cC0+TG5leHQtPkxuZXh0ICE9IHVwAHNyYy90ZXNzLmMAdGVzc01lc2hUZXNzZWxsYXRlTW9ub1JlZ2lvbgBsby0+TG5leHQgIT0gdXAAUmVnaW9ucwBmYWNlVmVydHMgPD0gcG9seVNpemUAT3V0cHV0UG9seW1lc2gAQYgWCwkMAAAADQAAAA4AQbAWCwNADVA=";if(!j(G)){var Q=G;G=e.locateFile?e.locateFile(Q,y):y+Q}function z(){try{if(v)return new Uint8Array(v);var t=G;if(j(t))try{var e=X(t.slice(37)),i=new Uint8Array(e.length);for(t=0;t<e.length;++t)i[t]=e.charCodeAt(t);var n=i}catch(t){throw Error("Converting base64 string to bytes failed.")}else n=void 0;if(n)return n;throw"both async and sync fetching of the wasm failed"}catch(t){U(t)}}function H(t){for(;0<t.length;){var i=t.shift();if("function"==typeof i)i(e);else{var n=i.J;"number"==typeof n?void 0===i.H?M.get(n)():M.get(n)(i.H):n(void 0===i.H?null:i.H)}}}var X="function"==typeof atob?atob:function(t){var e="",i=0;t=t.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(i++)),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(i++)),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(i++)),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(i++));n=n<<2|r>>4,r=(15&r)<<4|o>>2;var a=(3&o)<<6|s;e+=String.fromCharCode(n),64!==o&&(e+=String.fromCharCode(r)),64!==s&&(e+=String.fromCharCode(a))}while(i<t.length);return e};L.push({J:function(){Y()}});var q={a:function(t,e,i,n){U("Assertion failed: "+P(t)+", at: "+[e?P(e):"unknown filename",i,n?P(n):"unknown function"])},d:function(t,e){throw $(t,e||1),"longjmp"},k:function(t,e,i){D.copyWithin(t,e,e+i)},l:function(t){t>>>=0;var e=D.length;if(2147483648<t)return!1;for(var i=1;4>=i;i*=2){var n=e*(1+.2/i);n=Math.min(n,t+100663296),0<(n=Math.max(16777216,t,n))%65536&&(n+=65536-n%65536);t:{try{x.grow(Math.min(2147483648,n)-E.byteLength+65535>>>16),B();var r=1;break t}catch(t){}r=void 0}if(r)return!0}return!1},c:function(){return 0|b},j:function(t,e){var i=W();try{return M.get(t)(e)}catch(t){if(J(i),t!==t+0&&"longjmp"!==t)throw t;$(1,0)}},g:function(t,e,i){var n=W();try{return M.get(t)(e,i)}catch(t){if(J(n),t!==t+0&&"longjmp"!==t)throw t;$(1,0)}},f:function(t,e){var i=W();try{M.get(t)(e)}catch(t){if(J(i),t!==t+0&&"longjmp"!==t)throw t;$(1,0)}},e:function(t,e,i){var n=W();try{M.get(t)(e,i)}catch(t){if(J(n),t!==t+0&&"longjmp"!==t)throw t;$(1,0)}},h:function(t,e,i,n){var r=W();try{M.get(t)(e,i,n)}catch(t){if(J(r),t!==t+0&&"longjmp"!==t)throw t;$(1,0)}},i:function(t,e,i,n,r,o){var s=W();try{M.get(t)(e,i,n,r,o)}catch(t){if(J(s),t!==t+0&&"longjmp"!==t)throw t;$(1,0)}},b:function(t){b=0|t}};!function(){function t(t){e.asm=t.exports,x=e.asm.m,B(),M=e.asm.n,k--,e.monitorRunDependencies&&e.monitorRunDependencies(k),0==k&&V&&(t=V,V=null,t())}function i(e){t(e.instance)}function r(t){return(v||"function"!=typeof fetch?Promise.resolve().then(z):fetch(G,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+G+"'";return t.arrayBuffer()})).catch((function(){return z()}))).then((function(t){return WebAssembly.instantiate(t,o)})).then(t,(function(t){A("failed to asynchronously prepare wasm: "+t),U(t)}))}var o={a:q};if(k++,e.monitorRunDependencies&&e.monitorRunDependencies(k),e.instantiateWasm)try{return e.instantiateWasm(o,t)}catch(t){return A("Module.instantiateWasm callback failed with error: "+t),!1}(v||"function"!=typeof WebAssembly.instantiateStreaming||j(G)||"function"!=typeof fetch?r(i):fetch(G,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,o).then(i,(function(t){return A("wasm streaming compile failed: "+t),A("falling back to ArrayBuffer instantiation"),r(i)}))}))).catch(n)}();var Y=e.___wasm_call_ctors=function(){return(Y=e.___wasm_call_ctors=e.asm.o).apply(null,arguments)};e._malloc=function(){return(e._malloc=e.asm.p).apply(null,arguments)},e._free=function(){return(e._free=e.asm.q).apply(null,arguments)},e._tessNewTess=function(){return(e._tessNewTess=e.asm.r).apply(null,arguments)},e._tessDeleteTess=function(){return(e._tessDeleteTess=e.asm.s).apply(null,arguments)},e._tessAddContour=function(){return(e._tessAddContour=e.asm.t).apply(null,arguments)},e._tessTesselate=function(){return(e._tessTesselate=e.asm.u).apply(null,arguments)},e._tessGetVertexCount=function(){return(e._tessGetVertexCount=e.asm.v).apply(null,arguments)},e._tessGetVertices=function(){return(e._tessGetVertices=e.asm.w).apply(null,arguments)},e._tessGetVertexIndices=function(){return(e._tessGetVertexIndices=e.asm.x).apply(null,arguments)},e._tessGetElementCount=function(){return(e._tessGetElementCount=e.asm.y).apply(null,arguments)},e._tessGetElements=function(){return(e._tessGetElements=e.asm.z).apply(null,arguments)};var K,W=e.stackSave=function(){return(W=e.stackSave=e.asm.A).apply(null,arguments)},J=e.stackRestore=function(){return(J=e.stackRestore=e.asm.B).apply(null,arguments)},Z=e.stackAlloc=function(){return(Z=e.stackAlloc=e.asm.C).apply(null,arguments)},$=e._setThrew=function(){return($=e._setThrew=e.asm.D).apply(null,arguments)};function tt(){function t(){if(!K&&(K=!0,e.calledRun=!0,!C)){if(H(L),H(R),i(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var t=e.postRun.shift();N.unshift(t)}H(N)}}if(!(0<k)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)F();H(O),0<k||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),t()}),1)):t())}}if(e.cwrap=function(t,e,i,n){var r=(i=i||[]).every((function(t){return"number"===t}));return"string"!==e&&r&&!n?w(t):function(){return I(t,e,i,arguments)}},V=function t(){K||tt(),K||(V=t)},e.run=tt,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return tt(),t.ready}),Aa=window.SHAPE_INFO={total_time:0,tess_time:0,multy_contours:0,single_contours:0},va=function(){function t(){}return t.prepareWasm=function(){var e=this;window.WebAssembly||(console.warn("[GraphicsFactoryFills] WASM not supported"),this.wasmIsOk=!1),ya().then((function(e){var i=e.Tess;t.Tess2Wasm=i})).catch((function(t){console.warn("[GraphicsFactoryFills] WASM initialisation fail:",t),e.wasmIsOk=!1}))},t.toFixed=function(t){return(1e3*t|0)/1e3},t.nearest=function(t,e,i,n){var r=t-i;r<0&&(r=-r);var o=e-n;return o<0&&(o=-o),r+o<this.EPS},t.draw_pathes=function(t){for(var e=t.queued_fill_pathes,i=e.length,n=0;n<i;n++){var r=e[n],o=r.style,s=t.popEmptyFillShape(),a=s?s.elements:null,l=a?a.concatenatedBuffer:null,u=this.pathToAttributesBuffer(r,!1,l);if(u&&u.length){a?(a.invalidate(),a._numVertices=u.count):(a=new Us(u)).setPositions(new Nn(u)),a.isDynamic=t._clearCount>0;var c=void 0,h=new Ze,p=new or;switch(o.data_type){case ws.data_type:c=(d=$s.get_material_for_color(o.color,o.alpha)).material,d.colorPos?(c.animateUVs=!0,p.addSamplerAt(h,c.getTextureAt(0)),p.uvMatrix=new T(0,0,0,0,d.colorPos.x,d.colorPos.y)):p=h=null;break;case Is.data_type:var d,f=o;(c=(d=$s.get_material_for_gradient(f)).material).animateUVs=!0,p.addSamplerAt(h,c.getTextureAt(0)),p.uvMatrix=f.getUVMatrix(),f.type==bs.LINEAR?c.getTextureAt(0).mappingMode=jn.LINEAR:f.type==bs.RADIAL&&(h.imageRect=f.uvRectangle,c.imageRect=!0,c.getTextureAt(0).mappingMode=jn.RADIAL);break;case Es.data_type:var _=o;c=_.material,h.repeat=_.repeat,c.style.sampler=h,c.animateUVs=!0,p.addSamplerAt(h,c.getTextureAt(0)),p.uvMatrix=_.getUVMatrix()}(s=s||qs.getShape(a)).style=p,s.material=c,t.addShapeInternal(s)}}},t.prepareContours=function(t,e){void 0===e&&(e=!1),t.prepare();for(var i=t._positions,n=[],r=0;r<i.length;r++){var o=i[r];if(this.nearest(o[0],o[1],o[o.length-2],o[o.length-1])&&(o.pop(),o.pop()),o.length>=6)if(e){for(var s=new Array(o.length),a=0,l=o.length;a<l;a++)s[a]=this.toFixed(o[a]*this.TESS_SCALE);n.push(s)}else n.push(o)}return n},t.runTesselator=function(t){var e=this.prepareContours(t,this.USE_TESS_FIX);e.length>0?Aa.multy_contours+=1:Aa.single_contours+=1;var i,n=null;if(e.length>0){var r=!this.Tess2Wasm||!this.wasmIsOk,o=performance.now();if(!r)try{return this._lastTess=i=new this.Tess2Wasm,i.addContours(e),n=i.tesselate(),Aa.tess_time+=performance.now()-o,n}catch(t){this.wasmIsOk=!1,r=!0,console.warn("[GraphicsFactoryFills] Tess2Wasm crash, dowside to JS",t.message)}if(r){this.wasmIsOk||console.debug("[GraphicsFactoryFills] WASM Tess not loaded, JS will used.");try{return n=function(t){var e=t.windingRule,i=void 0===e?Ws.ODD:e,n=t.elementType,r=void 0===n?Js.POLYGONS:n,o=t.polySize,s=void 0===o?3:o,a=t.vertexSize,l=void 0===a?2:a,u=t.normal,c=void 0===u?[0,0,1]:u,h=t.contours,p=void 0===h?[]:h,d=t.strict,f=void 0===d||d,_=t.debug,m=void 0!==_&&_;if(!p&&f)throw new Error("Contours can't be empty");if(p){for(var g=new fa,y=0;y<p.length;y++)g.addContour(l||2,p[y]);return g.tesselate(i,r,s,l,c,f),{vertices:g.vertices,vertexIndices:g.vertexIndices,vertexCount:g.vertexCount,elements:g.elements,elementCount:g.elementCount,mesh:m?g.mesh:void 0}}}({contours:e,windingRule:ma,elementType:ga,polySize:3,vertexSize:2,debug:!0}),Aa.tess_time+=performance.now()-o,n}catch(t){return console.debug("[GraphicsFactoryFills] Error when trying to tesselate",e),null}}}},t.fillBuffer=function(t,e){for(var i=t.elements.length,n=this.USE_TESS_FIX?1/this.TESS_SCALE:1,r=0,o=0,s=0,a=0,l=0,u=0,c=0,h=0;h<i;h+=3)o=n*t.vertices[2*t.elements[h+0]+0],s=n*t.vertices[2*t.elements[h+0]+1],a=n*t.vertices[2*t.elements[h+1]+0],l=n*t.vertices[2*t.elements[h+1]+1],u=n*t.vertices[2*t.elements[h+2]+0],c=n*t.vertices[2*t.elements[h+2]+1],ta.isClockWiseXY(o,s,a,l,u,c)?(e[r++]=u,e[r++]=c,e[r++]=a,e[r++]=l,e[r++]=o,e[r++]=s):(e[r++]=o,e[r++]=s,e[r++]=a,e[r++]=l,e[r++]=u,e[r++]=c);return e},t.pathToAttributesBuffer=function(t,e,i){void 0===i&&(i=null);var n,r=performance.now(),o=t.verts?t.verts.length:0,s=0,a=t.pretesselatedBuffer;a?(o=a.length,console.debug("[GraphicsFactoryFills] Use prebuild buffer:",t)):(n=this.runTesselator(t))&&n.elements.length>0&&(s=2*n.elements.length,o+=2*n.elements.length);i||(i=new Pn(2*Float32Array.BYTES_PER_ELEMENT,o/2|0)),i.count=o/2|0;var l=new Float32Array(i.buffer);a?l.set(a):n&&(this.fillBuffer(n,l),this._lastTess&&(this._lastTess.dispose(),this._lastTess=null));for(var u=t.verts.length,c=0;c<u;c++)l[s+c]=t.verts[c];return Aa.total_time+=performance.now()-r,i},t.wasmIsOk=!0,t.TESS_SCALE=20,t.USE_TESS_FIX=!0,t.EPS=.001,t}(),ba=function(){function t(){}return t.NO_OP=0,t.MOVE_TO=1,t.LINE_TO=2,t.CURVE_TO=3,t.BUILD_JOINT=13,t.BUILD_ROUND_JOINT=14,t.WIDE_LINE_TO=4,t.WIDE_MOVE_TO=5,t.CUBIC_CURVE=6,t}(),xa=function(){function t(){}return t.draw_pathes=function(e){for(var i,n=e.queued_stroke_pathes,r=n.length,o=0;o<r;o++){var s=n[o],a=s.style,l=$s.get_material_for_color(a.color,a.alpha),u=l.material,c=e.popEmptyStrokeShape(),h=void 0,p=void 0;s.prepare();var d=void 0;(d=t.fillLineElements([s],u.curves,s.stroke.scaleMode,null===(i=c)||void 0===i?void 0:i.elements))&&(d.stroke=s.stroke,l.colorPos&&(h=new or,p=new Ze,u.animateUVs=!0,u.style.sampler=p,h.addSamplerAt(p,u.getTextureAt(0)),h.uvMatrix=new T(0,0,0,0,l.colorPos.x,l.colorPos.y)),c?(c.material=u,c.style=h):c=qs.getShape(d,u,h),e.addShapeInternal(c))}},t.fillLineElements=function(t,e,i,n){void 0===i&&(i=Cs.NORMAL),void 0===n&&(n=null);for(var r,o=[],s=[],a=0,l=0,u=0,c=0,h=0,p=0,d=0,f=t.length;d<f;d++){var _=t[d];_.prepare();for(var m=_._positions,g=_.stroke,y=i!=Cs.HAIRLINE?g.half_thickness:.5,A=0,v=m.length;A<v;A++){u=(r=m[A])[0],c=r[1];for(var b=2,x=r.length;b<x;b+=2){a=r[b+0],l=r[b+1],va.nearest(a,l,u,c)||(o[h++]=u,o[h++]=c,o[h++]=0,o[h++]=a,o[h++]=l,o[h++]=0,s[p++]=y),u=a,c=l}}}if(0==o.length)return null;var C=n||new zs(new Pn);return C.setPositions(o),C.setThickness(s),C},t.getTriangleElements=function(t,e,i){void 0===i&&(i=Cs.NORMAL);var n,r,o,s,a,l=[],u=t.length,c=0,h=0,p=new D,d=new D,f=new D,_=new D,m=new D,g=0,y=0,A=0,v=0,b=0,x=0,C=0,w=0,I=0,E=0,S=0,T=0,P=0,B=0,O=0,L=0,R=0,N=0,F=0,k=0,V=0,U=0,j=0,G=0,Q=0,z=0,H=0,X=0,q=!0,Y=!1,K=!1,W=0,J=0,Z=0,$=0,tt=0,et=0,it=0,nt=0,rt=[],ot=[],st=0,at=0,lt=0;for(lt=0;lt<u;lt++)for(n=t[lt]._positions,it=(r=t[lt].stroke).half_thickness,nt=r.half_thickness,Cs.NORMAL,h=0;h<n.length;h++){for(K=!0,null,null,(o=n[h])[0]!=o[o.length-2]||o[1]!=o[o.length-1]?K=!1:(d.x=o[o.length-2]-o[o.length-4],d.y=o[o.length-1]-o[o.length-3],d.normalize(),Z=Math.atan2(d.y,d.x)*M.RADIANS_TO_DEGREES,o[o.length-2],o[o.length-1]),A=o[0],v=o[1],rt=[],ot=[],st=0,at=0,s=-1*d.y,a=d.x,c=2;c<o.length;c+=2)g=o[c],y=o[c+1],g==A&&y==v||(p.x=g-A,p.y=y-v,p.normalize(),(J=(W=Math.atan2(p.y,p.x)*M.RADIANS_TO_DEGREES)-Z)>180&&(J-=360),J<-180&&(J+=360),Z=W,f.x=-1*p.y,f.y=p.x,b=A+f.x*it,x=v+f.y*nt,C=A-f.x*it,w=v-f.y*nt,Y=!1,2!=c||K?($=180-J,J<0&&($=-180-J),0==J||180==Math.abs(J)?Y=2==c:Math.abs($)<5?Y=!0:(Y=!0,$=-.5*$*M.DEGREES_TO_RADIANS,_.x=p.x*Math.cos($)+p.y*Math.sin($),_.y=p.y*Math.cos($)-p.x*Math.sin($),_.normalize(),Math.abs(J)<=1||Math.abs(J)>=359||Math.abs(J)>=179&&Math.abs(J)<=181?(tt=J<0?it:-it,et=J<0?nt:-nt):(tt=it/Math.sin($),et=nt/Math.sin($)),I=A-_.x*tt,E=v-_.y*et,S=A+_.x*tt,T=v+_.y*et,J>0?(O=A-s*it,L=v-a*nt,b=I,x=E,C=P=A-f.x*it,w=B=v-f.y*nt):(F=A+s*it,k=v+a*nt,C=S,w=T,b=R=A+f.x*it,x=N=v+f.y*nt),q=!0,r.jointstyle==Ts.MITER&&(Math.sqrt((tt*tt+et*et)/(it*it+nt*nt)-1)<=r.miter_limit?(q=!1,C=S,w=T,b=I,x=E):J>0?(P-=p.x*(r.miter_limit*it),B-=p.y*(r.miter_limit*nt),m.x=-1*a,m.y=s,O-=m.x*(r.miter_limit*it),L-=m.y*(r.miter_limit*nt)):(R-=p.x*(r.miter_limit*it),N-=p.y*(r.miter_limit*nt),m.x=-1*a,m.y=s,F-=m.x*(r.miter_limit*it),k-=m.y*(r.miter_limit*nt))),q&&(rt[st++]=r.jointstyle!=Ts.ROUND?ba.BUILD_JOINT:ba.BUILD_ROUND_JOINT,J>0?(ot[at++]=I,ot[at++]=E,ot[at++]=O,ot[at++]=L,ot[at++]=P,ot[at++]=B):(ot[at++]=F,ot[at++]=k,ot[at++]=S,ot[at++]=T,ot[at++]=R,ot[at++]=N),r.jointstyle==Ts.ROUND&&(ot[at++]=A-_.x*Math.abs(it),ot[at++]=v-_.y*Math.abs(nt),J>0?(ot[at++]=O,ot[at++]=L,ot[at++]=P,ot[at++]=B):(ot[at++]=F,ot[at++]=k,ot[at++]=R,ot[at++]=N))))):Y=!0,s=f.x,a=f.y,Y&&(rt[st++]=ba.LINE_TO,ot[at++]=b,ot[at++]=x,ot[at++]=C,ot[at++]=w),A,v,A=g,v=y,c==o.length-2&&(rt[st++]=ba.NO_OP,K?(ot[at++]=ot[0],ot[at++]=ot[1],ot[at++]=ot[2],ot[at++]=ot[3]):(ot[at++]=A+f.x*it,ot[at++]=v+f.y*nt,ot[at++]=A-f.x*it,ot[at++]=v-f.y*nt)));for(st=0,at=0,c=0;c<rt.length;c++)rt[c]==ba.LINE_TO?(V=ot[at++],U=ot[at++],j=ot[at++],G=ot[at++],Q=ot[at],z=ot[at+1],H=ot[at+2],X=ot[at+3],ta.addTriangle(V,U,Q,z,j,G,0,l,e),ta.addTriangle(j,G,Q,z,H,X,0,l,e)):rt[c]>=ba.BUILD_JOINT&&(Q=ot[at++],z=ot[at++],V=ot[at++],U=ot[at++],j=ot[at++],G=ot[at++],ta.addTriangle(V,U,j,G,Q,z,0,l,e),rt[c]==ba.BUILD_ROUND_JOINT&&(H=ot[at++],X=ot[at++],V=ot[at++],U=ot[at++],j=ot[at++],G=ot[at++],ta.tesselateCurve(V,U,H,X,j,G,l,!0)));K||(d.x=o[2]-o[0],d.y=o[3]-o[1],d.normalize(),ta.createCap(o[0],o[1],ot[0],ot[1],ot[2],ot[3],d.x,d.y,r.capstyle,-1,it,nt,l,e),d.x=o[o.length-2]-o[o.length-4],d.y=o[o.length-1]-o[o.length-3],d.normalize(),ta.createCap(o[o.length-2],o[o.length-1],ot[ot.length-4],ot[ot.length-3],ot[ot.length-2],ot[ot.length-1],d.x,d.y,r.capstyle,1,it,nt,l,e))}if(0!=l.length){var ut=new On(Float32Array,e?3:2);ut.set(l);var ct=ut.attributesBuffer.cloneBufferView();ut.dispose();var ht=new Us(ct);return ht.setPositions(new Nn(ct)),ht}},t}(),Ca=function(){function t(){}return t.EVEN_ODD="evenOdd",t.NON_ZERO="nonZero",t}(),wa=function(){function t(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=Ca.EVEN_ODD),this._orientedBoxBoundsDirty=!0,this._lastDirtyID=0,this._dirtyID=-1,this._startMerge=-1,this._endMerge=-1,this._mergeSource=-1,this._mergetarget=-1,this._connectedIdx=[],this._positionOffset=[],this.forceClose=!1,this._cache={},this._cacheSharedSegments={},this._data=[],this._commands=[],this._style=null,this.verts=[],this._positions=[],null!=t&&null!=e?(this._data[0]=e,this._commands[0]=t):(this._data[0]=[],this._commands[0]=[]),this._startPoint=new D,this._cur_point=new D,this._winding_rule=i,this._winding_directions=[]}return Object.defineProperty(t.prototype,"dirty",{get:function(){return this._lastDirtyID!==this._dirtyID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data_type",{get:function(){return t.data_type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(t){this._style=t,this._dirtyID++},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return null==this._style?null:this._style.data_type==ws.data_type?this._style:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return null==this._style?null:this._style.data_type==Ps.data_type?this._style:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commands",{get:function(){return this._commands},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.cacheSegment=function(t,e,i,n,r,o,s,a,l){void 0===a&&(a=null),void 0===l&&(l=null);var u=i.toString()+"#";u+=n>o?n.toString()+"#"+o.toString():o.toString()+"#"+n.toString(),u+=r>s?r.toString()+"#"+s.toString():s.toString()+"#"+r.toString(),null!=a&&null!=l&&(u+=a.toString()+"#"+l.toString());var c=this._cache[u];null==c&&(this._cache[u]=c=[]),c.push(t),c.push(e),c.length>2&&(this._cacheSharedSegments[u]=c)},t.prototype.curveTo=function(t,e,i,n){if(t!=i||e!=n)return this._cur_point.x!=i||this._cur_point.y!=n||this._cur_point.x==t&&this._cur_point.y==e?void((this._cur_point.x==i&&this._cur_point.y==n||this._cur_point.x!=t||this._cur_point.y!=e)&&(this._cur_point.x!=i||this._cur_point.y!=n||this._cur_point.x!=t||this._cur_point.y!=e)?(0==this._commands[this._commands.length-1].length&&(this._commands[this._commands.length-1].push(ba.MOVE_TO),this._data[this._data.length-1].push(this._cur_point.x),this._data[this._data.length-1].push(this._cur_point.y)),this._commands[this._commands.length-1].push(ba.CURVE_TO),this._data[this._data.length-1].push(t),this._data[this._data.length-1].push(e),this._data[this._data.length-1].push(i),this._data[this._data.length-1].push(n),this._cur_point.x=i,this._cur_point.y=n,this._dirtyID++):this.lineTo(i,n)):(this.lineTo(t,e),void this.moveTo(i,n));this.lineTo(t,e)},t.prototype.cubicCurveTo=function(t,e,i,n,r,o){console.log("cubicCurveTo not yet fully supported."),this._cur_point.x==r&&this._cur_point.y==o||(0==this._commands[this._commands.length-1].length&&(this._commands[this._commands.length-1].push(ba.MOVE_TO),this._data[this._data.length-1].push(this._cur_point.x),this._data[this._data.length-1].push(this._cur_point.y)),this._commands[this._commands.length-1].push(ba.CURVE_TO),this._data[this._data.length-1].push(t),this._data[this._data.length-1].push(e),this._data[this._data.length-1].push(r),this._data[this._data.length-1].push(o),this._cur_point.x=r,this._cur_point.y=o,this._dirtyID++)},t.prototype.lineTo=function(t,e){0==this._commands[this._commands.length-1].length&&(this._commands[this._commands.length-1].push(ba.MOVE_TO),this._data[this._data.length-1].push(this._cur_point.x),this._data[this._data.length-1].push(this._cur_point.y)),this._commands[this._commands.length-1].push(ba.LINE_TO),this._data[this._data.length-1].push(t),this._data[this._data.length-1].push(e),this._cur_point.x=t,this._cur_point.y=e,this._dirtyID++},t.prototype.moveTo=function(t,e){this._cur_point.x==t&&this._cur_point.y==e||(this._commands[this._commands.length-1].length>0&&(this._commands.push([ba.MOVE_TO]),this._data.push([t,e])),this._startPoint.x=t,this._startPoint.y=e,this._cur_point.x=t,this._cur_point.y=e,this._dirtyID++)},t.prototype.wideLineTo=function(t,e){},t.prototype.wideMoveTo=function(t,e){},t.prototype.mergeContours=function(){var t=-1;if(this._startMerge==this._endMerge){var e=this._connectedIdx[this._mergetarget][this._startMerge],i=this.data[this._mergetarget][this._positionOffset[this._mergetarget][this._startMerge]-2],n=this.data[this._mergetarget][this._positionOffset[this._mergetarget][this._startMerge]-1],r=this.data[this._mergetarget][this._positionOffset[this._mergetarget][this._startMerge]],o=this.data[this._mergetarget][this._positionOffset[this._mergetarget][this._startMerge]+1],s=this.data[this._mergeSource][this._positionOffset[this._mergeSource][e]],a=this.data[this._mergeSource][this._positionOffset[this._mergeSource][e]+1],l=this.data[this._mergeSource][this._positionOffset[this._mergeSource][e]+2],u=this.data[this._mergeSource][this._positionOffset[this._mergeSource][e]+3];i==s&&n==a&&r==l&&o==u&&(t=1)}var c=this._connectedIdx[this._mergetarget][this._startMerge],h=this._connectedIdx[this._mergetarget][this._endMerge],p=Math.abs(this._startMerge-this._endMerge)+1,d=this._commands[this._mergeSource].length-p;t=-1;c>h&&(t=1);for(var f,_=c,m=0,g=0,y=0,A=0,v=0,b=0,x=0,C=0,w=(this._positionOffset[this._mergeSource][c],0);w<d;w++)switch((_+=t)>=this._commands[this._mergeSource].length&&(_-=this._commands[this._mergeSource].length),_<0&&(_+=this._commands[this._mergeSource].length),this._commands[this._mergeSource][_]){case ba.LINE_TO:m=this.data[this._mergeSource][this._positionOffset[this._mergeSource][_]],g=this.data[this._mergeSource][this._positionOffset[this._mergeSource][_]+1],this._positions[this._mergetarget].push(m),this._positions[this._mergetarget].push(g),y=m,A=g;break;case ba.CURVE_TO:for(v=this.data[this._mergeSource][this._positionOffset[this._mergeSource][_]],b=this.data[this._mergeSource][this._positionOffset[this._mergeSource][_]+1],m=this.data[this._mergeSource][this._positionOffset[this._mergeSource][_]+2],g=this.data[this._mergeSource][this._positionOffset[this._mergeSource][_]+3],f=[],ta.tesselateCurve(y,A,v,b,m,g,f),C=f.length,x=0;x<C;x+=2)this._positions[this._mergetarget].push(f[x]),this._positions[this._mergetarget].push(f[x+1]);y=m,A=g}this._startMerge=-1,this._endMerge=-1,this._mergetarget=-1,this._mergeSource=-1},t.prototype.prepare=function(){if(this._dirtyID!==this._lastDirtyID){this._lastDirtyID=this._dirtyID;var t,e,i,n,r,o,s,a=[],l=[],u=0,c=0,h=0,p=this.commands.length;if(1!==p||this.commands[0]){for(var d=0;d<p;d++){var f=this.commands[d],_=this.data[d];this._positions[d]=[],this._connectedIdx[d]=[],this._positionOffset[d]=[],l[d]=!1,a[d]=[],Math.abs(_[0]-_[_.length-2])+Math.abs(_[1]-_[_.length-1])>.01&&this.forceClose&&(f[f.length]=ba.LINE_TO,_[_.length]=_[0],_[_.length]=_[1])}p=this.commands.length;for(var m=0;m<p;m++){var g=this.commands[m],y=this.data[m];c=0,e=y[c++],i=y[c++],n=0,r=0,o=0,h=0,this._positions[m].push(e),this._positions[m].push(i),this._startMerge=-1,this._endMerge=-1,this._mergetarget=-1,this._mergeSource=-1,c=0,e=y[c++],i=y[c++];for(var A=1;A<g.length;A++)switch(g[A]){case ba.MOVE_TO:console.log("ERROR ! ONLY THE FIRST COMMAND FOR A CONTOUR IS ALLOWED TO BE A 'MOVE_TO' COMMAND");break;case ba.LINE_TO:n=y[c++],r=y[c++],this._positions[m].push(n),this._positions[m].push(r),e=n,i=r;break;case ba.CURVE_TO:for(o=y[c++],h=y[c++],n=y[c++],r=y[c++],s=[],ta.tesselateCurve(e,i,o,h,n,r,s),u=s.length,t=0;t<u;t+=2)this._positions[m].push(s[t]),this._positions[m].push(s[t+1]);e=n,i=r}}}}},t.prototype.invalidate=function(){this._orientedBoxBoundsDirty=!0,this._dirtyID++},t.prototype.getBoxBounds=function(t,e,i){return void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),t?this._internalGetBoxBounds(t,e,i):(this._orientedBoxBoundsDirty&&(this._orientedBoxBoundsDirty=!1,this._orientedBoxBounds=this._internalGetBoxBounds(null,this._orientedBoxBounds,null)),null!=this._orientedBoxBounds&&(i=this._orientedBoxBounds.union(i,i||e)),i)},t.prototype._internalGetBoxBounds=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null);var n=0,r=0,o=0,s=0,a=this._positions.length;if(0==a)return i;var l,u,c,h=0,p=0,d=this._positions[p++],f=d.length;for(t&&(c=t._rawData),null==i?(i=e||new B,t?(l=d[h]*c[0]+d[h+1]*c[4]+c[12],u=d[h]*c[1]+d[h+1]*c[5]+c[13]):(l=d[h],u=d[h+1]),o=n=l,s=r=u,h+=2):(o=(n=i.x)+i.width,s=(r=i.y)+i.height);h<f;h+=2)t?(l=d[h]*c[0]+d[h+1]*c[4]+c[12],u=d[h]*c[1]+d[h+1]*c[5]+c[13]):(l=d[h],u=d[h+1]),l<n?n=l:l>o&&(o=l),u<r?r=u:u>s&&(s=u),h>=f-2&&p<a&&(h=0,f=(d=this._positions[p++]).length);return i.width=o-(i.x=n),i.height=s-(i.y=r),i.depth=0,i},t.data_type="[graphicsdata path]",t}(),Ia=function(){function t(){}return t.TRIANGLE="triangle",t.LINE="line",t}(),Ea=(function(){function t(){}Object.defineProperty(t.prototype,"vertexTransform",{get:function(){return this._defaultVertexTransform},set:function(t){this._defaultVertexTransform=t,this._defaultInvVertexTransform=t.clone(),this._defaultInvVertexTransform.invert(),this._defaultInvVertexTransform.transpose()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UVTransform",{get:function(){return this._defaultUVTransform},set:function(t){this._defaultUVTransform=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"invVertexTransform",{get:function(){return this._defaultInvVertexTransform},enumerable:!0,configurable:!0})}(),function(){function t(t,e,i){void 0===e&&(e=10),void 0===i&&(i=!0),this.baseClass=t,this._limit=e,this.enabled=i,this._store=[]}return t.prototype.resize=function(t){if(!(t>=this._store.length))for(var e=0,i=this._store.splice(0,this._store.length-t);e<i.length;e++){i[e].dispose()}},Object.defineProperty(t.prototype,"size",{get:function(){return this._store.length},set:function(t){this.resize(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"limit",{get:function(){return this._limit},set:function(t){this.resize(t),this._limit=t},enumerable:!0,configurable:!0}),t.prototype.pop=function(){return this._store.length&&this.enabled?this._store.shift():null},t.prototype.store=function(t){return!!this.enabled&&(t.assetType===this.baseClass.assetType&&(!(this._store.length>=this._limit)&&(this._store.push(t),!0)))},t.prototype.release=function(t){var e=this._store.indexOf(t);return-1!==e&&(this._store.splice(e,1),!0)},t.prototype.clear=function(){this.resize(0)},t.prototype.dispose=function(){for(var t=0,e=this._store;t<e.length;t++){e[t].dispose()}this._store=null,this._limit=0},t.REDUCE_TIMEOUT=5e3,t}());va.prepareWasm();var Sa=function(t){function e(){var e=t.call(this)||this;return e._bitmapFillPool={},e._queuedShapeTags=[],e._shapes=[],e._current_position=new D,e._scale=new P,e._scaleX=0,e._scaleY=0,e._lastPrebuildedShapes=[],e._drawingDirty=!1,e.usages=0,e._clearCount=0,e._internalShapesId=[],e._rFillPool=new Ea(qs,100,!1),e._rStrokePool=new Ea(qs,100,!1),e._poolingConfig={fill:Fs.FILLS,stroke:Fs.STROKES,clearsCount:ks},e.push=Array.prototype.push,e._drawingDirty=!1,e._current_position=new D,e._queued_fill_pathes=[],e._queued_stroke_pathes=[],e._active_fill_path=null,e._active_stroke_path=null,e._fillStyle=null,e._lineStyle=null,e._onInvalidateDelegate=function(t){return e._onInvalidate(t)},e}return i(e,t),e.getGraphics=function(){return e._pool.length?e._pool.pop():new e},e.clearPool=function(){e._pool=[]},Object.defineProperty(e.prototype,"start",{get:function(){return!this._start&&this.sourceGraphics?this.sourceGraphics.start:this._start},set:function(t){this._start=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return!this._end&&this.sourceGraphics?this.sourceGraphics.end:this._end},set:function(t){this._end=t},enumerable:!0,configurable:!0}),e.prototype.updateSlice9=function(t,e){if(this._scaleX!=t||this._scaleY!=e){this._scaleX=t,this._scaleY=e;for(var i=this._shapes.length,n=0;n<i;n++)Rs.updateTriangleGraphicsSlice9(this._shapes[n].elements,this.originalSlice9Size,t,e);this.invalidate()}},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this._shapes.length+this._queued_stroke_pathes.length+this._queued_fill_pathes.length+this._queuedShapeTags.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"queued_stroke_pathes",{get:function(){return this._queued_stroke_pathes},set:function(t){this._queued_stroke_pathes=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"queued_fill_pathes",{get:function(){return this._queued_fill_pathes},set:function(t){this._queued_fill_pathes=t},enumerable:!0,configurable:!0}),e.prototype.add_queued_path=function(t,e){void 0===e&&(e=!1),t.style&&(t.style.data_type!=ws.data_type&&t.style.data_type!=Is.data_type&&t.style.data_type!=Es.data_type||(this._drawingDirty=!0,this._queued_fill_pathes.push(t)),t.style.data_type==Ps.data_type&&(this._queued_stroke_pathes.push(t),e||this.endFill()))},Object.defineProperty(e.prototype,"internalPoolConfig",{get:function(){return this._poolingConfig},set:function(t){this._poolingConfig.fill="boolean"==typeof t?t:t.fill,this._poolingConfig.stroke="boolean"==typeof t?t:t.stroke,t||(this._rFillPool.enabled&&this._rFillPool.clear(),this._rStrokePool.enabled&&this._rStrokePool.clear(),this._rStrokePool.enabled=!1,this._rStrokePool.enabled=!1),this._clearCount=0},enumerable:!0,configurable:!0}),e.prototype.popEmptyFillShape=function(){return this._rFillPool.pop()},e.prototype.popEmptyStrokeShape=function(){return this._rStrokePool.pop()},e.prototype.addShapeInternal=function(t){this.addShape(t),this._internalShapesId.push(t.id)},e.prototype.addShape=function(t){t.usages++;var e=this.getShapeIndex(t);return-1!=e&&this.removeShapeAt(e),this._shapes.push(t),t.addEventListener(tr.INVALIDATE_ELEMENTS,this._onInvalidateDelegate),t.addEventListener(tr.INVALIDATE_MATERIAL,this._onInvalidateDelegate),t.addEventListener(tr.INVALIDATE_STYLE,this._onInvalidateDelegate),t.addEventListener(l.INVALIDATE,this._onInvalidateDelegate),this._scaleX=0,this._scaleY=0,this.invalidate(),t},e.prototype.removeShape=function(t){var e=this.getShapeIndex(t);if(-1==e)throw new S("Shape parameter is not a shape of the caller");this.removeShapeAt(e)},e.prototype.removeShapeAt=function(t){if(t<0||t>=this._shapes.length)throw new k("Index is out of range");var e=this._shapes.splice(t,1)[0];e.removeEventListener(tr.INVALIDATE_ELEMENTS,this._onInvalidateDelegate),e.removeEventListener(tr.INVALIDATE_MATERIAL,this._onInvalidateDelegate),e.removeEventListener(tr.INVALIDATE_STYLE,this._onInvalidateDelegate),e.removeEventListener(l.INVALIDATE,this._onInvalidateDelegate),e.usages--,e.usages||this.tryPoolShape(e)||e.dispose(),this.invalidate()},e.prototype.getShapeAt=function(t){return this._shapes[t]},e.prototype.getShapeIndex=function(t){return this._shapes.indexOf(t)},e.prototype.applyTransformation=function(t){for(var e=this._shapes.length,i=0;i<e;++i)this._shapes[i].applyTransformation(t)},e.prototype.copyTo=function(t,e){void 0===e&&(e=!1),this._drawingDirty&&this.endFill(),this.slice9Rectangle&&(t.slice9Rectangle=new Y,t.slice9Rectangle.copyFrom(this.slice9Rectangle),t.originalSlice9Size=new Y,t.originalSlice9Size.copyFrom(this.originalSlice9Size),t.minSlice9Width=this.minSlice9Width,t.minSlice9Height=this.minSlice9Height),t.sourceGraphics=this,t._addShapes(this._shapes,e)},e.prototype.scale=function(t){for(var e=this._shapes.length,i=0;i<e;++i)this._shapes[i].scale(t)},e.prototype.tryPoolShape=function(t){var e=t.elements.assetType===Us.assetType,i=t.elements.assetType===zs.assetType;return!(!i&&!e)&&(-1!==this._internalShapesId.indexOf(t.id)&&(e?this._rFillPool.store(t):!!i&&this._rStrokePool.store(t)))},e.prototype.clear=function(){var t;this._clearCount++,this._lastPrebuildedShapes.length=0,!(this._internalShapesId.length>0&&this._clearCount>=this._poolingConfig.clearsCount)||this._rStrokePool.enabled===this._poolingConfig.stroke&&this._rFillPool.enabled===this._poolingConfig.fill||(console.warn("[Graphics] To many clears, pooling shapes internally!",this.id,this._internalShapesId.length),this._rFillPool.enabled=this._poolingConfig.fill,this._rStrokePool.enabled=this._poolingConfig.stroke);for(var e=this._shapes.length,i=0;i<e;i++)(t=this._shapes[i]).removeEventListener(tr.INVALIDATE_ELEMENTS,this._onInvalidateDelegate),t.removeEventListener(tr.INVALIDATE_MATERIAL,this._onInvalidateDelegate),t.removeEventListener(tr.INVALIDATE_STYLE,this._onInvalidateDelegate),t.removeEventListener(l.INVALIDATE,this._onInvalidateDelegate),t.usages--,t.usages||this.tryPoolShape(t)||t.dispose();this._internalShapesId.length=0,this._shapes.length=0,this.invalidate(),this._active_fill_path=null,this._active_stroke_path=null,this._queued_fill_pathes.length=0,this._queued_stroke_pathes.length=0,this._current_position.x=0,this._current_position.y=0,this._drawingDirty=!1,this._lineStyle=null,this._fillStyle=null},e.prototype.dispose=function(){if(this.clear(),this._bitmapFillPool){for(var t in this._bitmapFillPool)this._bitmapFillPool[t].material.dispose();this._bitmapFillPool=null}this._bitmapFillPool=null,this._rFillPool.clear(),this._rStrokePool.clear(),this._internalShapesId.length=0,this._clearCount=0,e._pool.push(this)},e.prototype.scaleUV=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1);for(var i=this._shapes.length,n=0;n<i;++n)this._shapes[n].scaleUV(t,e)},e.prototype._acceptTraverser=function(t){if(this._drawingDirty){for(var e=0,i=this._lastPrebuildedShapes;e<i.length;e++){var n=i[e];this.removeShape(n)}t instanceof te?this._endFillInternal(!1):this.endFill()}for(var r=this._shapes.length-1;r>=0;r--)t.applyTraversable(this._shapes[r])},e.prototype._onInvalidate=function(t){this.invalidate()},e.prototype.draw_fills=function(t){void 0===t&&(t=!0),va.draw_pathes(this),t&&(this._active_fill_path=null,this._queued_fill_pathes.length=0)},e.prototype.draw_strokes=function(t){void 0===t&&(t=!0),xa.draw_pathes(this),t&&(this._active_stroke_path=null,this._queued_stroke_pathes.length=0)},e.prototype.beginBitmapFill=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=!0),void 0===n&&(n=!1),this.draw_fills(),this._bitmapFillPool||(this._bitmapFillPool={});var r=this._bitmapFillPool[t.id];r?(r.matrix=e,r.repeat=i,r.smooth=n):r=this._bitmapFillPool[t.id]=new Es($s.get_material_for_BitmapImage2D(t),e,i,n),this._fillStyle=r},e.prototype.beginFill=function(t,e){void 0===e&&(e=1),0==t&&(t=65793),this.draw_fills(),this._fillStyle=new ws(t,e)},e.prototype.beginGradientFill=function(t,e,i,n,r,o,s,a){void 0===r&&(r=null),void 0===o&&(o="pad"),void 0===s&&(s="rgb"),void 0===a&&(a=0),this.draw_fills(),this._fillStyle=new Is(t,e,i,n,r,o,s,a)},e.prototype.copyFrom=function(t){t.copyTo(this)},e.prototype.cubicCurveTo=function(t,e,i,n,r,o){throw new F("cubicCurveTo")},e.prototype.curveTo=function(t,e,i,n){this._drawingDirty=!0,this._createGraphicPathes(),null!=this._active_fill_path&&this._active_fill_path.curveTo(t,e,i,n),null!=this._active_stroke_path&&this._active_stroke_path.curveTo(t,e,i,n),this._current_position.x=i,this._current_position.y=n,this.invalidate()},e.prototype.drawCircle=function(t,e,i){if(this._drawingDirty=!0,this._createGraphicPathes(),null!=this._active_fill_path){this._active_fill_path.moveTo(t,e);var n=i;null!=this._active_stroke_path&&(n-=this._active_stroke_path.style.thickness/2),ta.drawElipse(t,e,n,n,this._active_fill_path.verts,0,360,5,!1)}null!=this._active_stroke_path&&(this._active_stroke_path.moveTo(t,e),ta.drawElipseStrokes(t,e,i,i,this._active_stroke_path.verts,0,360,5,this._active_stroke_path.style.thickness/2,!1)),this.invalidate()},e.prototype.drawEllipse=function(t,e,i,n){if(this._drawingDirty=!0,this._createGraphicPathes(),null!=this._active_fill_path){this._active_fill_path.moveTo(t,e);var r=i,o=n;null!=this._active_stroke_path&&(r-=this._active_stroke_path.style.thickness/2,o-=this._active_stroke_path.style.thickness/2),ta.drawElipse(t,e,r,o,this._active_fill_path.verts,0,360,5,!1)}null!=this._active_stroke_path&&(this._active_stroke_path.moveTo(t,e),ta.drawElipseStrokes(t,e,i,n,this._active_stroke_path.verts,0,360,5,this._active_stroke_path.style.thickness/2,!1)),this.invalidate()},e.prototype.drawGraphicsData=function(t){},e.prototype.drawPath=function(t,e,i){},e.prototype.drawRect=function(t,e,i,n){if(this._drawingDirty=!0,this._createGraphicPathes(),null!=this._active_fill_path){this._active_fill_path.moveTo(t,e);var r=i,o=n,s=0;null!=this._active_stroke_path&&(s=this._active_stroke_path.style.thickness/2,r-=this._active_stroke_path.style.thickness,o-=this._active_stroke_path.style.thickness),ta.addTriangle(t+s,e+o+s,t+s,e+s,t+r+s,e+s,0,this._active_fill_path.verts,!1),ta.addTriangle(t+s,e+o+s,t+s+r,e+s,t+r+s,e+o+s,0,this._active_fill_path.verts,!1)}null!=this._active_stroke_path&&(this._active_stroke_path.moveTo(t,e),this._active_stroke_path.lineTo(t+i,e),this._active_stroke_path.lineTo(t+i,e+n),this._active_stroke_path.lineTo(t,e+n),this._active_stroke_path.lineTo(t,e)),this.invalidate()},e.prototype.drawRoundRect=function(t,e,i,n,r,o){void 0===o&&(o=NaN),this._drawingDirty=!0,this._createGraphicPathes(),isNaN(o)&&(o=r);var s=i,a=n,l=r/2,u=o/2,c=0;null!=this._active_fill_path&&(this._active_fill_path.moveTo(t,e),null!=this._active_stroke_path&&(c=this._active_stroke_path.style.thickness/2,s-=this._active_stroke_path.style.thickness,a-=this._active_stroke_path.style.thickness),ta.addTriangle(t+c,e+a-u,t+c,e+u,t+s-c,e+u,0,this._active_fill_path.verts,!1),ta.addTriangle(t+c,e+a-u,t+s-c,e+u,t+s-c,e+a-u,0,this._active_fill_path.verts,!1),ta.addTriangle(t+l,e+c,t+s-l,e+u,t+l,e+u,0,this._active_fill_path.verts,!1),ta.addTriangle(t+l,e+c,t+s-l,e+c,t+s-l,e+u,0,this._active_fill_path.verts,!1),ta.addTriangle(t+l,e+a-u,t+s-l,e+a-c,t+l,e+a-c,0,this._active_fill_path.verts,!1),ta.addTriangle(t+l,e+a-u,t+s-l,e+a-u,t+s-l,e+a-c,0,this._active_fill_path.verts,!1),ta.drawElipse(t+l,e+u,l-c,u-c,this._active_fill_path.verts,180,270,5,!1),ta.drawElipse(t+s-l,e+u,l-c,u-c,this._active_fill_path.verts,270,360,5,!1),ta.drawElipse(t+s-l,e+a-u,l-c,u-c,this._active_fill_path.verts,0,90,5,!1),ta.drawElipse(t+l,e+a-u,l-c,u-c,this._active_fill_path.verts,90,180,5,!1)),null!=this._active_stroke_path&&(this._active_stroke_path.moveTo(t,e),c=this._active_stroke_path.style.thickness/2,ta.addTriangle(t-c,e+a-u,t-c,e+u,t+c,e+u,0,this._active_stroke_path.verts,!1),ta.addTriangle(t-c,e+a-u,t+c,e+a-u,t+c,e+u,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+l,e-c,t+s-l,e-c,t+l,e+c,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+l,e+c,t+s-l,e-c,t+s-l,e+c,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+s-c,e+a-u,t+s-c,e+u,t+s+c,e+a-u,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+s+c,e+a-u,t+s+c,e+u,t+s-c,e+u,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+l,e+a+c,t+s-l,e+a+c,t+l,e+a-c,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+l,e+a-c,t+s-l,e+a+c,t+s-l,e+a-c,0,this._active_stroke_path.verts,!1),ta.drawElipseStrokes(t+l,e+u,l,u,this._active_stroke_path.verts,180,270,5,c,!1),ta.drawElipseStrokes(t+s-l,e+u,l,u,this._active_stroke_path.verts,270,360,5,c,!1),ta.drawElipseStrokes(t+s-l,e+a-u,l,u,this._active_stroke_path.verts,0,90,5,c,!1),ta.drawElipseStrokes(t+l,e+a-u,l,u,this._active_stroke_path.verts,90,180,5,c,!1)),this.invalidate()},e.prototype.drawRoundRectComplex=function(t,e,i,n,r,o,s,a){var l=i,u=n,c=r,h=o,p=s,d=a;this._drawingDirty=!0,this._createGraphicPathes();var f=0;null!=this._active_fill_path&&(this._active_fill_path.moveTo(t,e),null!=this._active_stroke_path&&(f=this._active_stroke_path.style.thickness/2,l-=this._active_stroke_path.style.thickness,u-=this._active_stroke_path.style.thickness),ta.addTriangle(t+c,e+c,t+l-h,e+h,t+l-d,e+u-d,0,this._active_fill_path.verts,!1),ta.addTriangle(t+c,e+c,t+l-d,e+u-d,t+p,e+u-p,0,this._active_fill_path.verts,!1),ta.addTriangle(t+f,e+c,t+c,e+c,t+f,e+u-p,0,this._active_fill_path.verts,!1),ta.addTriangle(t+c,e+c,t+f,e+u-p,t+p,e+u-p,0,this._active_fill_path.verts,!1),ta.addTriangle(t+c,e+f,t+c,e+c,t+l-h,e+f,0,this._active_fill_path.verts,!1),ta.addTriangle(t+c,e+c,t+l-h,e+h,t+l-h,e+f,0,this._active_fill_path.verts,!1),ta.addTriangle(t+l-f,e+h,t+l-h,e+h,t+l-f,e+u-d,0,this._active_fill_path.verts,!1),ta.addTriangle(t+l-h,e+h,t+l-d,e+u-d,t+l-f,e+u-d,0,this._active_fill_path.verts,!1),ta.addTriangle(t+p,e+u-f,t+l-d,e+u-f,t+p,e+u-p,0,this._active_fill_path.verts,!1),ta.addTriangle(t+p,e+u-p,t+l-d,e+u-f,t+l-d,e+u-d,0,this._active_fill_path.verts,!1),ta.drawElipse(t+c,e+c,c-f,c-f,this._active_fill_path.verts,180,270,5,!1),ta.drawElipse(t+l-h,e+h,h-f,h-f,this._active_fill_path.verts,270,360,5,!1),ta.drawElipse(t+l-d,e+u-d,d-f,d-f,this._active_fill_path.verts,0,90,5,!1),ta.drawElipse(t+p,e+u-p,p-f,p-f,this._active_fill_path.verts,90,180,5,!1)),null!=this._active_stroke_path&&(this._active_stroke_path.moveTo(t,e),f=this._active_stroke_path.style.thickness/2,ta.addTriangle(t-f,e+u-p,t-f,e+c,t+f,e+c,0,this._active_stroke_path.verts,!1),ta.addTriangle(t-f,e+u-p,t+f,e+u-p,t+f,e+c,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+c,e-f,t+l-h,e-f,t+h,e+f,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+c,e+f,t+l-h,e-f,t+l-h,e+f,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+l-f,e+u-d,t+l-f,e+h,t+l+f,e+u-d,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+l+f,e+u-d,t+l+f,e+h,t+l-f,e+h,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+p,e+u+f,t+l-d,e+u+f,t+p,e+u-f,0,this._active_stroke_path.verts,!1),ta.addTriangle(t+p,e+u-f,t+l-d,e+u+f,t+l-d,e+u-f,0,this._active_stroke_path.verts,!1),ta.drawElipseStrokes(t+c,e+c,c,c,this._active_stroke_path.verts,180,270,5,f,!1),ta.drawElipseStrokes(t+l-h,e+h,h,h,this._active_stroke_path.verts,270,360,5,f,!1),ta.drawElipseStrokes(t+l-d,e+u-d,d,d,this._active_stroke_path.verts,0,90,5,f,!1),ta.drawElipseStrokes(t+p,e+u-p,p,p,this._active_stroke_path.verts,90,180,5,f,!1)),this.invalidate()},e.prototype.drawTriangles=function(t,e,i,n){this._drawingDirty=!0,this._active_fill_path,this._active_stroke_path},e.prototype.endFill=function(){this._active_stroke_path&&this._active_fill_path&&(this._active_stroke_path.forceClose=!0),this._endFillInternal(!0),this._active_fill_path=null,this._active_stroke_path=null,this._fillStyle=null},e.prototype._endFillInternal=function(t){if(void 0===t&&(t=!1),this._queuedShapeTags.length){var e=this._queuedShapeTags,i=e.length;this._queuedShapeTags=[];for(var n=0;n<i;n++)this.convertRecordsToShapeData(e[n]);e.length=0}var r=this._shapes.length;if(this.draw_fills(t),this.draw_strokes(t),t)this._lastPrebuildedShapes.length=0;else{for(n=r;n<this._shapes.length;n++)this._lastPrebuildedShapes[n-r]=this._shapes[n];this._lastPrebuildedShapes.length=this._shapes.length-r}this._drawingDirty=!1},e.prototype.lineBitmapStyle=function(t,e,i,n){},e.prototype.lineGradientStyle=function(t,e,i,n,r,o,s,a){this._drawingDirty=!0,this._lineStyle=new Ps(e[0],i[0],1)},e.prototype.lineStyle=function(t,e,i,n,r,o,s,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=null),void 0===o&&(o=Ds.NONE),void 0===s&&(s=Ts.MITER),void 0===a&&(a=100),0==t&&(t=.05,r=Cs.HAIRLINE);var l=t>0&&i>0;this._drawingDirty=!0,this._lineStyle=l?new Ps(e,i,t,s,o,a):null},e.prototype.lineTo=function(t,e){this._drawingDirty=!0,this._createGraphicPathes(),null!=this._active_fill_path&&this._active_fill_path.lineTo(t,e),null!=this._active_stroke_path&&this._active_stroke_path.lineTo(t,e),this._current_position.x=t,this._current_position.y=e,this.invalidate()},e.prototype.moveTo=function(t,e){this._drawingDirty=!0,this._createGraphicPathes(),null!=this._active_fill_path&&this._active_fill_path.moveTo(t,e),null!=this._active_stroke_path&&this._active_stroke_path.moveTo(t,e),this._current_position.x=t,this._current_position.y=e,this.invalidate()},e.prototype.processLazyTesselation=function(t){if(t.lazyTaskDone=null,t.needParse=!1,t.parsingTime<30){var e=this._queuedShapeTags.indexOf(t);e>-1&&this._queuedShapeTags.splice(e,1),this.convertRecordsToShapeData(t,t.parsingTime>1)}else console.debug("[Graphics] Supress lazy shape convertion:",t)},e.prototype.queueShapeTag=function(t){this._queuedShapeTags.push(t),this._drawingDirty=!0},e.prototype._createGraphicPathes=function(){null==this._fillStyle||null!=this._active_fill_path&&this._active_fill_path.style==this._fillStyle||(this._active_fill_path=new wa,this._active_fill_path.style=this._fillStyle,0==this._current_position.x&&0==this._current_position.y||this._active_fill_path.moveTo(this._current_position.x,this._current_position.y),this._queued_fill_pathes.push(this._active_fill_path)),null==this._lineStyle||null!=this._active_stroke_path&&this._active_stroke_path.style==this._lineStyle||(this._active_stroke_path=new wa,this._active_stroke_path.style=this._lineStyle,0==this._current_position.x&&0==this._current_position.y||this._active_stroke_path.moveTo(this._current_position.x,this._current_position.y),this._queued_stroke_pathes.push(this._active_stroke_path))},e.prototype._addShapes=function(t,e){var i;void 0===e&&(e=!1);for(var n=t.length,r=0;r<n;r++)i=t[r],this.slice9Rectangle?i=qs.getShape(Rs.updateTriangleGraphicsSlice9(i.elements,this.originalSlice9Size,1,1,!1,!0),i.material,i.style):e&&(i=qs.getShape(i.elements,i.material,i.style,i.count,i.offset)),i.particleCollection=t[r].particleCollection,i.addEventListener(tr.INVALIDATE_ELEMENTS,this._onInvalidateDelegate),i.addEventListener(tr.INVALIDATE_MATERIAL,this._onInvalidateDelegate),i.addEventListener(tr.INVALIDATE_STYLE,this._onInvalidateDelegate),i.addEventListener(l.INVALIDATE,this._onInvalidateDelegate),this._shapes.push(i),i.usages++;this._scaleX=0,this._scaleY=0,this._scale.identity(),this.invalidate()},e.prototype._isShapeMaterial=function(t){for(var e=this._shapes.length,i=0;i<e;i++)if(t==this._shapes[i].material)return!0;return!1},e.prototype.convertRecordsToShapeData=function(t,e){void 0===e&&(e=!1),t.needParse&&t.lazyParser();for(var i,n=t.records,r=t.fillStyles,o=t.lineStyles,s=t.recordsMorph||null,a=null!==s,l=t.parser,u=Pa(r,!1,!!s,l),c=Pa(o,!0,!!s,l),h={fill0:0,fill1:0,line:0},p=[],d=[],f=n.length,_=0,m=0,g=0,y=0,A=0,v=0;A<f;A++){var b=n[A];if(a&&(i=s[v++]),0===b.type){for(var x=0;x<3;x++)p[x]=void 0;16&b.flags&&(d||(d=[]),this.push.apply(d,u),u=Pa(b.fillStyles,!1,a,l),this.push.apply(d,c),c=Pa(b.lineStyles,!0,a,l),h={fill0:0,fill1:0,line:0}),2&b.flags&&(h.fill0=b.fillStyle0),4&b.flags&&(h.fill1=b.fillStyle1),8&b.flags&&(h.line=b.lineStyle),h.fill0&&(p[0]={path:u[h.fill0-1]}),h.fill1&&(p[1]={path:u[h.fill1-1]}),h.line&&(p[2]={path:c[h.line-1]}),1&b.flags&&(_=0|b.moveX,m=0|b.moveY),h.fill1&&h.fill0&&h.fill0==h.fill1&&(p[0]=p[1]=void 0),a&&(0===i.type?(g=0|i.moveX,y=0|i.moveY):v--);for(var C=0;C<3;C++){(I=p[C])&&(I.segment=xs.FromDefaults(a),I.path.addSegment(I.segment),a?I.segment.morphMoveTo(_,m,g,y):I.segment.moveTo(_,m))}}else{if(co(1===b.type),a){for(;i&&0===i.type;)i=s[v++];i||(i=b)}if(32&b.flags&&(!a||32&i.flags)){_+=0|b.deltaX,m+=0|b.deltaY,a&&(g+=0|i.deltaX,y+=0|i.deltaY);for(var w=0;w<3;w++){var I;(I=p[w])&&(a?I.segment.morphLineTo(_,m,g,y):I.segment.lineTo(_,m))}}else{var E=this.transformCurve(b,_,m);_=E.x,m=E.y;var S=void 0;a&&(g=(S=this.transformCurve(i,g,y)).x,y=S.y);for(var D=0;D<3;D++){var T=p[D];if(T){var P=T.segment;a?P.morphCurveTo(E.cx,E.cy,_,m,S.cx,S.cy,g,y):P.curveTo(E.cx,E.cy,_,m)}}}}}var B,M,O=d.length+u.length+c.length,L=[d,u,c],R=0;if(a){this.start=new Array(O),this.end=new Array(O);for(A=0;R<L.length;A++)!L[R]||L[R].length<=A?(R++,A=-1):(B=new wa,M=new wa,L[R][A].serializeAJS(B,M),this.start.push(B),this.end.push(M))}else for(A=0;R<L.length;A++)!L[R]||L[R].length<=A?(R++,A=-1):(B=new wa,L[R][A].serializeAJS(B,null),this.add_queued_path(B,e))},e.prototype.transformCurve=function(t,e,i){var n,r;if(32&t.flags){var o=0|t.deltaX,s=0|t.deltaY;n=e+(o>>1),r=i+(s>>1),e+=o,i+=s}else n=e+t.controlDeltaX|0,r=i+t.controlDeltaY|0,e=n+t.anchorDeltaX|0,i=r+t.anchorDeltaY|0;return{cx:n,cy:r,x:e,y:i}},e.CLEARS_BEFORE_POOLING=10,e._pool=new Array,e.assetType="[asset Graphics]",e}(p),Da={a:1,b:0,c:0,d:1,tx:0,ty:0};function Ta(t,e,i,n){var r,o=t;if(i&&(o.morph=function t(e,i){var n,r=Object.create(e);if(i){if(r.width=e.widthMorph,!e.color&&e.hasFill){var o=t(e.fillStyle,!1);return r.transform=o.transform,r.colors=o.colors,r.ratios=o.ratios,r}return r.color=e.colorMorph,r}if(void 0===e.type)return r;if(e.type===As.Solid)return r.color=e.colorMorph,r;switch(e.type){case As.LinearGradient:case As.RadialGradient:case As.FocalRadialGradient:for(var s=e.records,a=r.colors=[],l=r.ratios=[],u=0;u<s.length;u++){var c=s[u];a.push(c.colorMorph),l.push(c.ratioMorph)}n=1;break;case As.RepeatingBitmap:case As.ClippedBitmap:case As.NonsmoothedRepeatingBitmap:case As.NonsmoothedClippedBitmap:n=.05;break;default:console.log("shape parser encountered invalid fill style")}if(!e.matrix)return r.transform=Da,r;var h=e.matrixMorph;return r.transform={a:h.a*n,b:h.b*n,c:h.c*n,d:h.d*n,tx:h.tx/20,ty:h.ty/20},r}(t,e)),e){if(o.miterLimit=2*(t.miterLimitFactor||1.5),!t.color&&t.hasFill){var s=Ta(t.fillStyle,!1,!1,n);return o.type=s.type,o.transform=s.transform,o.colors=s.colors,o.ratios=s.ratios,o.focalPoint=s.focalPoint,o.bitmapId=s.bitmapId,o.material=s.material,o.repeat=s.repeat,t.fillStyle=null,o}return o.type=As.Solid,o}if(void 0===t.type||t.type===As.Solid)return o;switch(t.type){case As.LinearGradient:case As.RadialGradient:case As.FocalRadialGradient:for(var a=t.records,l=o.colors=[],u=o.ratios=[],c=0;c<a.length;c++){var h=a[c];0!=u.length&&u[u.length-1]==h.ratio||(l.push(h.color),u.push(h.ratio))}r=1;break;case As.RepeatingBitmap:case As.ClippedBitmap:case As.NonsmoothedRepeatingBitmap:case As.NonsmoothedClippedBitmap:o.smooth=t.type!==As.NonsmoothedRepeatingBitmap&&t.type!==As.NonsmoothedClippedBitmap,o.repeat=t.type!==As.ClippedBitmap&&t.type!==As.NonsmoothedClippedBitmap,o.material=n.getMaterial(t.bitmapId),r=.05;break;default:console.log("shape parser encountered invalid fill style "+t.type)}if(!t.matrix)return o.transform=Da,o;var p=t.matrix;return o.transform={a:p.a*r,b:p.b*r,c:p.c*r,d:p.d*r,tx:p.tx/20,ty:p.ty/20},t.matrix=null,o}function Pa(t,e,i,n){for(var r=[],o=0;o<t.length;o++){var s=Ta(t[o],e,i,n);r[o]=e?new Bs(null,s):new Bs(s,null)}return r}console.debug("AwayJS - Graphics - 0.5.35");var Ba=function(t){function e(e,i){var n=t.call(this,e)||this;return n._object=i,n}return i(e,t),Object.defineProperty(e.prototype,"object",{get:function(){return this._object},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._object)},e.VISIBLITY_UPDATED="visiblityUpdated",e.SCENETRANSFORM_CHANGED="scenetransformChanged",e.PARTITION_CHANGED="partitionChanged",e}(a),Ma=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.clone=function(){var t=new e(this.type);return t.view=this.view,t.entity=this.entity,t},e.FOCUS_IN="focusIn3d",e.FOCUS_OUT="focusOut3d",e}(a),Oa=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i="triangle");var n=t.call(this)||this;if(n._primitiveDirty=!0,n._uvDirty=!0,n._scaleU=1,n._scaleV=1,n._material=e,n._elementsType=i,n._elementsType==Ia.TRIANGLE){var r=new Us(new Pn);r.autoDeriveNormals=!1,r.autoDeriveTangents=!1,n._elements=r}else n._elementsType==Ia.LINE&&(n._elements=new zs(new Pn));return n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementsType",{get:function(){return this._elementsType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t!=this._material){this._material=t;for(var e=this._pObjects.length,i=0;i<e;i++)this._pObjects[i].material=this._material}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleU",{get:function(){return this._scaleU},set:function(t){this._scaleU!=t&&(this._scaleU=t,this._pInvalidateUVs())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleV",{get:function(){return this._scaleV},set:function(t){this._scaleV!=t&&(this._scaleV=t,this._pInvalidateUVs())},enumerable:!0,configurable:!0}),e.prototype._pBuildGraphics=function(t,e){throw new s},e.prototype._pBuildUVs=function(t,e){throw new s},e.prototype._pInvalidatePrimitive=function(){this._primitiveDirty=!0},e.prototype._pInvalidateUVs=function(){this._uvDirty=!0},e.prototype.updateGraphics=function(){this._pBuildGraphics(this._elements,this._elementsType),this._primitiveDirty=!1},e.prototype.updateUVs=function(){this._pBuildUVs(this._elements,this._elementsType),this._uvDirty=!1},e.prototype._iValidate=function(){this._primitiveDirty&&this.updateGraphics(),this._uvDirty&&this.updateUVs()},e.prototype._pCreateObject=function(){var t=new ka(null,this._material);return t.graphics.addShape(qs.getShape(this._elements)),t._iSourcePrefab=this,t},e.assetType="[asset PrimitivePrefab]",e}(function(t){function e(){var e=t.call(this)||this;return e._pObjects=new Array,e}return i(e,t),e.prototype.getNewObject=function(){var t=this._pCreateObject();return this._pObjects.push(t),t},e.prototype._pCreateObject=function(){throw new s},e.prototype._iValidate=function(){},e}(p)),La=function(t){function e(e,i,n,r,o,s,a,l,u){void 0===e&&(e=null),void 0===i&&(i="triangle"),void 0===n&&(n=100),void 0===r&&(r=100),void 0===o&&(o=100),void 0===s&&(s=1),void 0===a&&(a=1),void 0===l&&(l=1),void 0===u&&(u=!0);var c=t.call(this,e,i)||this;return c._width=n,c._height=r,c._depth=o,c._segmentsW=s,c._segmentsH=a,c._segmentsD=l,c._tile6=u,c}return i(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this._depth},set:function(t){this._depth=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tile6",{get:function(){return this._tile6},set:function(t){this._tile6=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsD",{get:function(){return this._segmentsD},set:function(t){this._segmentsD=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),e.prototype._pBuildGraphics=function(t,e){var i,n,r,o,s,a,l,u,c,h,p,d,f,_,m,g,y,A,v,b,x=0;if(_=this._width/2,m=this._height/2,g=this._depth/2,e==Ia.TRIANGLE){var C=t,w=2*((this._segmentsW+1)*(this._segmentsH+1)+(this._segmentsW+1)*(this._segmentsD+1)+(this._segmentsH+1)*(this._segmentsD+1)),I=12*(this._segmentsW*this._segmentsH+this._segmentsW*this._segmentsD+this._segmentsH*this._segmentsD);for(w==C.numVertices&&null!=C.indices?(C.invalidateIndices(),C.invalidateVertices(C.positions),C.invalidateVertices(C.normals),C.invalidateVertices(C.tangents)):(C.setIndices(new Uint16Array(I)),C.setPositions(new Float32Array(3*w)),C.setNormals(new Float32Array(3*w)),C.setTangents(new Float32Array(3*w)),this._pInvalidateUVs()),i=C.indices.get(C.numElements),n=C.positions.get(w),r=C.normals.get(w),o=C.tangents.get(w),s=C.concatenatedBuffer.stride/4,d=0,f=0,y=this._width/this._segmentsW,A=this._height/this._segmentsH,v=this._depth/this._segmentsD,h=0;h<=this._segmentsW;h++)for(b=h*y-_,p=0;p<=this._segmentsH;p++)n[d]=b,n[d+1]=p*A-m,n[d+2]=-g,r[d]=0,r[d+1]=0,r[d+2]=-1,o[d]=1,o[d+1]=0,o[d+2]=0,n[d+=s]=b,n[d+1]=p*A-m,n[d+2]=g,r[d]=0,r[d+1]=0,r[d+2]=1,o[d]=-1,o[d+1]=0,o[d+2]=0,d+=s,h&&p&&(u=(a=2*((h-1)*(this._segmentsH+1)+(p-1)))+2,c=(l=2*(h*(this._segmentsH+1)+(p-1)))+2,i[f++]=a,i[f++]=u,i[f++]=c,i[f++]=a,i[f++]=c,i[f++]=l,i[f++]=l+1,i[f++]=c+1,i[f++]=u+1,i[f++]=l+1,i[f++]=u+1,i[f++]=a+1);for(x+=2*(this._segmentsW+1)*(this._segmentsH+1),h=0;h<=this._segmentsW;h++)for(b=h*y-_,p=0;p<=this._segmentsD;p++)n[d]=b,n[d+1]=m,n[d+2]=p*v-g,r[d]=0,r[d+1]=1,r[d+2]=0,o[d]=1,o[d+1]=0,o[d+2]=0,n[d+=s]=b,n[d+1]=-m,n[d+2]=p*v-g,r[d]=0,r[d+1]=-1,r[d+2]=0,o[d]=1,o[d+1]=0,o[d+2]=0,d+=s,h&&p&&(u=(a=x+2*((h-1)*(this._segmentsD+1)+(p-1)))+2,c=(l=x+2*(h*(this._segmentsD+1)+(p-1)))+2,i[f++]=a,i[f++]=u,i[f++]=c,i[f++]=a,i[f++]=c,i[f++]=l,i[f++]=l+1,i[f++]=c+1,i[f++]=u+1,i[f++]=l+1,i[f++]=u+1,i[f++]=a+1);for(x+=2*(this._segmentsW+1)*(this._segmentsD+1),h=0;h<=this._segmentsD;h++)for(b=g-h*v,p=0;p<=this._segmentsH;p++)n[d]=-_,n[d+1]=p*A-m,n[d+2]=b,r[d]=-1,r[d+1]=0,r[d+2]=0,o[d]=0,o[d+1]=0,o[d+2]=-1,n[d+=s]=_,n[d+1]=p*A-m,n[d+2]=b,r[d]=1,r[d+1]=0,r[d+2]=0,o[d]=0,o[d+1]=0,o[d+2]=1,d+=s,h&&p&&(u=(a=x+2*((h-1)*(this._segmentsH+1)+(p-1)))+2,c=(l=x+2*(h*(this._segmentsH+1)+(p-1)))+2,i[f++]=a,i[f++]=u,i[f++]=c,i[f++]=a,i[f++]=c,i[f++]=l,i[f++]=l+1,i[f++]=c+1,i[f++]=u+1,i[f++]=l+1,i[f++]=u+1,i[f++]=a+1)}else if(e==Ia.LINE){var E=t,S=4*this._segmentsH+4*this._segmentsW+4*this._segmentsD,D=void 0;for(n=new Float32Array(6*S),D=new Float32Array(S),d=0,f=0,h=0;h<this._segmentsH;++h)n[d++]=-_,n[d++]=h*this._height/this._segmentsH-m,n[d++]=-g,n[d++]=_,n[d++]=h*this._height/this._segmentsH-m,n[d++]=-g,D[f++]=1,n[d++]=-_,n[d++]=m-h*this._height/this._segmentsH,n[d++]=g,n[d++]=_,n[d++]=m-h*this._height/this._segmentsH,n[d++]=g,D[f++]=1;for(h=0;h<this._segmentsW;++h)n[d++]=h*this._width/this._segmentsW-_,n[d++]=-m,n[d++]=-g,n[d++]=h*this._width/this._segmentsW-_,n[d++]=m,n[d++]=-g,D[f++]=1,n[d++]=_-h*this._width/this._segmentsW,n[d++]=-m,n[d++]=g,n[d++]=_-h*this._width/this._segmentsW,n[d++]=m,n[d++]=g,D[f++]=1;for(h=0;h<this._segmentsH;++h)n[d++]=-_,n[d++]=h*this._height/this._segmentsH-m,n[d++]=-g,n[d++]=-_,n[d++]=h*this._height/this._segmentsH-m,n[d++]=g,D[f++]=1,n[d++]=_,n[d++]=m-h*this._height/this._segmentsH,n[d++]=-g,n[d++]=_,n[d++]=m-h*this._height/this._segmentsH,n[d++]=g,D[f++]=1;for(h=0;h<this._segmentsD;++h)n[d++]=_,n[d++]=-m,n[d++]=h*this._depth/this._segmentsD-g,n[d++]=_,n[d++]=m,n[d++]=h*this._depth/this._segmentsD-g,D[f++]=1,n[d++]=-_,n[d++]=-m,n[d++]=g-h*this._depth/this._segmentsD,n[d++]=-_,n[d++]=m,n[d++]=g-h*this._depth/this._segmentsD,D[f++]=1;for(h=0;h<this._segmentsD;++h)n[d++]=-_,n[d++]=-m,n[d++]=g-h*this._depth/this._segmentsD,n[d++]=_,n[d++]=-m,n[d++]=g-h*this._depth/this._segmentsD,D[f++]=1,n[d++]=-_,n[d++]=m,n[d++]=h*this._depth/this._segmentsD-g,n[d++]=_,n[d++]=m,n[d++]=h*this._depth/this._segmentsD-g,D[f++]=1;for(h=0;h<this._segmentsW;++h)n[d++]=_-h*this._width/this._segmentsW,n[d++]=-m,n[d++]=-g,n[d++]=_-h*this._width/this._segmentsW,n[d++]=-m,n[d++]=g,D[f++]=1,n[d++]=h*this._width/this._segmentsW-_,n[d++]=m,n[d++]=-g,n[d++]=h*this._width/this._segmentsW-_,n[d++]=m,n[d++]=g,D[f++]=1;E.setPositions(n),E.setThickness(D)}},e.prototype._pBuildUVs=function(t,e){var i,n,r,o,s,a,l,u,c,h,p,d,f,_,m,g;if(e==Ia.TRIANGLE){g=2*((this._segmentsW+1)*(this._segmentsH+1)+(this._segmentsW+1)*(this._segmentsD+1)+(this._segmentsH+1)*(this._segmentsD+1));var y=t;for(y.uvs&&g==y.numVertices?y.invalidateVertices(y.uvs):y.setUVs(new Float32Array(2*g)),o=y.uvs.get(g),s=y.uvs.stride,this._tile6?(a=u=1/3,l=c=.5):(a=l=1,u=c=0),r=0,h=1*u,p=1*c,d=2*u,f=0*c,_=a/this._segmentsW,m=l/this._segmentsH,i=0;i<=this._segmentsW;i++)for(n=0;n<=this._segmentsH;n++)o[r]=(h+i*_)*this._scaleU,o[r+1]=(p+(l-n*m))*this._scaleV,o[r+=s]=(d+(a-i*_))*this._scaleU,o[r+1]=(f+(l-n*m))*this._scaleV,r+=s;for(h=1*u,p=0*c,d=0*u,f=0*c,_=a/this._segmentsW,m=l/this._segmentsD,i=0;i<=this._segmentsW;i++)for(n=0;n<=this._segmentsD;n++)o[r]=(h+i*_)*this._scaleU,o[r+1]=(p+(l-n*m))*this._scaleV,o[r+=s]=(d+i*_)*this._scaleU,o[r+1]=(f+n*m)*this._scaleV,r+=s;for(h=0*u,p=1*c,d=2*u,f=1*c,_=a/this._segmentsD,m=l/this._segmentsH,i=0;i<=this._segmentsD;i++)for(n=0;n<=this._segmentsH;n++)o[r]=(h+i*_)*this._scaleU,o[r+1]=(p+(l-n*m))*this._scaleV,o[r+=s]=(d+(a-i*_))*this._scaleU,o[r+1]=(f+(l-n*m))*this._scaleV,r+=s}},e}(Oa),Ra=function(t){function e(e,i,n,r,o,s){void 0===e&&(e=null),void 0===i&&(i="triangle"),void 0===n&&(n=50),void 0===r&&(r=16),void 0===o&&(o=12),void 0===s&&(s=!0);var a=t.call(this,e,i)||this;return a._radius=n,a._segmentsW=r,a._segmentsH=o,a._yUp=s,a}return i(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),e.prototype._pBuildGraphics=function(t,e){var i,n,r,o,s,a,l,u,c,h,p;if(e==Ia.TRIANGLE){var d=t;(p=(this._segmentsH+1)*(this._segmentsW+1))==d.numVertices&&null!=d.indices?(d.invalidateIndices(),d.invalidateVertices(d.positions),d.invalidateVertices(d.normals),d.invalidateVertices(d.tangents)):(d.setIndices(new Uint16Array((this._segmentsH-1)*this._segmentsW*6)),d.setPositions(new Float32Array(3*p)),d.setNormals(new Float32Array(3*p)),d.setTangents(new Float32Array(3*p)),this._pInvalidateUVs()),i=d.indices.get(d.numElements),B=d.positions.get(p),n=d.normals.get(p),r=d.tangents.get(p),o=d.concatenatedBuffer.stride/4,l=0,u=0;var f=void 0,_=void 0,m=void 0;for(a=0;a<=this._segmentsH;++a){f=l;var g=Math.PI*a/this._segmentsH,y=-this._radius*Math.cos(g),A=this._radius*Math.sin(g);for(s=0;s<=this._segmentsW;++s){var v=2*Math.PI*s/this._segmentsW,b=A*Math.cos(v),x=A*Math.sin(v),C=1/Math.sqrt(b*b+x*x+y*y),w=Math.sqrt(x*x+b*b);if(this._yUp?(_=0,m=w>.007?b/w:0,c=-y,h=x):(_=w>.007?b/w:0,m=0,c=x,h=y),s==this._segmentsW?(B[l]=B[f],B[l+1]=B[f+1],B[l+2]=B[f+2],n[l]=n[f]+b*C*.5,n[l+1]=n[f+1]+c*C*.5,n[l+2]=n[f+2]+h*C*.5,r[l]=w>.007?-x/w:1,r[l+1]=_,r[l+2]=m):(B[l]=b,B[l+1]=c,B[l+2]=h,n[l]=b*C,n[l+1]=c*C,n[l+2]=h*C,r[l]=w>.007?-x/w:1,r[l+1]=_,r[l+2]=m),s>0&&a>0){var I=(this._segmentsW+1)*a+s,E=(this._segmentsW+1)*a+s-1,S=(this._segmentsW+1)*(a-1)+s-1,D=(this._segmentsW+1)*(a-1)+s;a==this._segmentsH?(B[l]=B[f],B[l+1]=B[f+1],B[l+2]=B[f+2],i[u++]=I,i[u++]=S,i[u++]=D):1==a?(i[u++]=I,i[u++]=E,i[u++]=S):(i[u++]=I,i[u++]=E,i[u++]=S,i[u++]=I,i[u++]=S,i[u++]=D)}l+=o}}}else if(e==Ia.LINE){var T=t,P=this._segmentsH*this._segmentsW*2+this._segmentsW,B=new Float32Array(6*P),M=new Float32Array(P);for(l=0,u=0,a=0;a<=this._segmentsH;++a){g=Math.PI*a/this._segmentsH,y=-this._radius*Math.cos(g),A=this._radius*Math.sin(g);for(s=0;s<=this._segmentsW;++s){v=2*Math.PI*s/this._segmentsW,b=A*Math.cos(v),x=A*Math.sin(v);if(this._yUp?(c=-y,h=x):(c=x,h=y),s>0&&(B[l++]=b,B[l++]=c,B[l++]=h,M[u++]=1,a>0)){var O=1==a?3-(6*(this._segmentsW-s)+12*s):3-12*this._segmentsW;B[l]=B[l+++O],B[l]=B[l+++O],B[l]=B[l+++O],B[l++]=b,B[l++]=c,B[l++]=h,M[u++]=1}s<this._segmentsW&&(B[l++]=b,B[l++]=c,B[l++]=h)}}T.setPositions(B),T.setThickness(M)}},e.prototype._pBuildUVs=function(t,e){var i,n,r,o,s=(this._segmentsH+1)*(this._segmentsW+1);if(e==Ia.TRIANGLE){s=(this._segmentsH+1)*(this._segmentsW+1);var a=t;a.uvs&&s==a.numVertices?a.invalidateVertices(a.uvs):a.setUVs(new Float32Array(2*s)),r=a.uvs.get(s),o=a.uvs.stride;var l=0;for(n=0;n<=this._segmentsH;++n)for(i=0;i<=this._segmentsW;++i)r[l]=i/this._segmentsW*this._scaleU,r[l+1]=n/this._segmentsH*this._scaleV,l+=o}},e}(Oa),Na=function(t){function e(){var e=t.call(this)||this;return e._queuedEvents=new Array,e._concatenatedMatrix3D=new R,e._sessionID=-1,e._avmDepthID=-1,e._scenePosition=new P,e._explicitVisibility=!0,e._explicitMaskId=-1,e._implicitVisibility=!0,e._implicitMaskId=-1,e._explicitMouseEnabled=!0,e._implicitMouseEnabled=!0,e._orientationMatrix=new R,e._inheritColorTransform=!0,e._maskMode=!1,e._renderMode=!0,e.isSlice9ScaledMC=!1,e.isSlice9ScaledSprite=!1,e.isAVMScene=!1,e.placeObjectTag=null,e.alignmentMode=St.REGISTRATION_POINT,e._blendMode="",e.castsShadows=!0,e.orientationMode=Tt.DEFAULT,e.zOffset=0,e.hasDispatchedAddedToStage=!1,e.cursorType="",e._isInFocus=!1,e._tabEnabled=!1,e._tabIndex=-1,e._avmDepthID=-1,e._onInvalidatePropertiesDelegate=function(t){return e._onInvalidateProperties(t)},e._transform=new N(null,e._concatenatedMatrix3D),e._transform.addEventListener(E.INVALIDATE_MATRIX3D,e._onInvalidateMatrix3D.bind(e)),e._transform.addEventListener(E.UPDATE_CONCATENATED_MATRIX3D,e._onUpdateConcatenatedMatrix3D.bind(e)),e._transform.addEventListener(E.INVALIDATE_COLOR_TRANSFORM,e._onInvalidateColorTransform.bind(e)),e._defaultBoundingVolume=e._getDefaultBoundingVolume(),e}return i(e,t),e.prototype.getScriptPrecedence=function(){if(!this._parent)return[];var t=this._parent.getScriptPrecedence();return this.placeObjectTag&&t.push(this.placeObjectTag.actionBlocksPrecedence),t},e.prototype.dispatchFrameEvents=function(t){this.dispatchEvent(t[0]),this.dispatchEvent(t[1])},e.prototype.dispatchEnterFrame=function(t){this.dispatchEvent(t)},e.prototype.dispatchExitFrame=function(t){this.dispatchEvent(t)},e.prototype.getMouseCursor=function(){return"initial"},Object.defineProperty(e.prototype,"tabEnabled",{get:function(){return this._tabEnabled},set:function(t){this._tabEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabIndex",{get:function(){return this._tabIndex},set:function(t){this._tabIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInFocus",{get:function(){return this._isInFocus},set:function(t){this._isInFocus=t},enumerable:!0,configurable:!0}),e.prototype.setFocus=function(t,i,n){this._isInFocus!=t&&(this._isInFocus=t,this._isInFocus?e.focusEvent.type=Ma.FOCUS_IN:e.focusEvent.type=Ma.FOCUS_OUT,this.dispatchEnterFrame(e.focusEvent))},Object.defineProperty(e.prototype,"inheritColorTransform",{get:function(){return this._inheritColorTransform},set:function(t){this._inheritColorTransform!=t&&(this._inheritColorTransform=t,this._invalidateHierarchicalProperties(Dt.COLOR_TRANSFORM))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._transform.colorTransform.alphaMultiplier},set:function(t){this._transform.colorTransform.alphaMultiplier=t,this._transform.invalidateColorTransform()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this._blendMode!==t&&(this._blendMode=t,t===fn.OVERLAY&&this._transform.invalidateColorTransform())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultBoundingVolume",{get:function(){return this._defaultBoundingVolume},set:function(t){this._defaultBoundingVolume!=t&&(this._defaultBoundingVolume=t,this._boundsPrimitive&&(this._boundsPrimitive.dispose(),this._boundsPrimitive=null),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eulers",{get:function(){return this._eulers||(this._eulers=new P),this._eulers.x=this.rotationX,this._eulers.y=this.rotationY,this._eulers.z=this.rotationZ,this._eulers},set:function(t){this._transform.rotation.x=t.x,this._transform.rotation.y=t.y,this._transform.rotation.z=t.z,this._transform.invalidateMatrix3D()},enumerable:!0,configurable:!0}),e.prototype.updateFilters=function(t){console.warn("[scene/DisplayObject] - updateFilters is just a stub")},Object.defineProperty(e.prototype,"index",{get:function(){return this._parent?this._parent.getChildIndex(this):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRenderable",{get:function(){return this._renderMode&&this._iAssignedColorTransform()._isRenderable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loader",{get:function(){return this._loader},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{set:function(t){t&&(t.maskMode=!0),this.masks||(this.masks=[]),this.masks.push(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maskMode",{get:function(){return this._maskMode},set:function(t){var e;this._maskMode!=t&&(this._partition&&(e=this._partition.parent)&&e.removeChild(this._partition),this._implicitPartition&&this._implicitPartition.clearEntity(this),this._maskMode=t,this._partition&&e&&e.addChild(this._partition),this._implicitPartition&&this._implicitPartition.invalidateEntity(this),this._explicitMaskId=t?this.id:-1,this._updateMaskMode())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pickObject",{get:function(){return this._pickObject&&this._pickObjectDirty&&this._updatePickObject(),this._pickObject},set:function(t){this._pickObject!=t&&(this._pickObject&&(this._pickObject.partition=null),this._pickObject=t.pickObjectFromTimeline?t.clone():t,this._pickObject&&(this._pickObject.partition=new oe(this._pickObject),this._pickObject.mouseChildren=!1,this._pickObject.mouseEnabled=!1,this._updatePickObject()))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseEnabled",{get:function(){return this._explicitMouseEnabled},set:function(t){this._explicitMouseEnabled!=t&&(this._explicitMouseEnabled=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseX",{get:function(){return this._mouseX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseY",{get:function(){return this._mouseY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._pName?this._pName:""},set:function(t){this._pName=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partition",{get:function(){return this._partition},set:function(t){this._partition!=t&&(this._partition&&this._partition.parent&&this._partition.parent.removeChild(this._partition),this._partition=t,this._setPartition(this._parent?this._parent._implicitPartition:null))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"registrationPoint",{get:function(){return this._registrationMatrix3D?new P(-this._registrationMatrix3D._rawData[12]*this.scaleX,-this._registrationMatrix3D._rawData[13]*this.scaleY,-this._registrationMatrix3D._rawData[14]*this.scaleZ):null},set:function(t){if(t)this._registrationMatrix3D||(this._registrationMatrix3D=new R),this._registrationMatrix3D._rawData[12]=-t.x/this._transform.scale.x,this._registrationMatrix3D._rawData[13]=-t.y/this._transform.scale.y,this._registrationMatrix3D._rawData[14]=-t.z/this._transform.scale.z;else{if(!this._registrationMatrix3D)return;this._registrationMatrix3D._rawData[12]=0,this._registrationMatrix3D._rawData[13]=0,this._registrationMatrix3D._rawData[14]=0,this._registrationMatrix3D.isIdentity()&&(this._registrationMatrix3D=null)}this._registrationMatrix3D.invalidatePosition(),this._invalidateHierarchicalProperties(Dt.SCENE_TRANSFORM)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"registrationScale",{get:function(){return this._registrationMatrix3D?new P(this._registrationMatrix3D._rawData[0],this._registrationMatrix3D._rawData[5],this._registrationMatrix3D._rawData[10]):null},set:function(t){if(t)this._registrationMatrix3D||(this._registrationMatrix3D=new R),this._registrationMatrix3D._rawData[0]=t.x,this._registrationMatrix3D._rawData[5]=t.y,this._registrationMatrix3D._rawData[10]=t.z;else{if(!this._registrationMatrix3D)return;this._registrationMatrix3D._rawData[0]=1,this._registrationMatrix3D._rawData[5]=1,this._registrationMatrix3D._rawData[10]=1,this._registrationMatrix3D.isIdentity()&&(this._registrationMatrix3D=null)}this._invalidateHierarchicalProperties(Dt.SCENE_TRANSFORM)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationX",{get:function(){return this._transform.rotation.x*M.RADIANS_TO_DEGREES},set:function(t){this.rotationX!=t&&(this._transform.rotation.x=t*M.DEGREES_TO_RADIANS,this._transform.invalidateMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationY",{get:function(){return this._transform.rotation.y*M.RADIANS_TO_DEGREES},set:function(t){this.rotationY!=t&&(this._transform.rotation.y=t*M.DEGREES_TO_RADIANS,this._transform.invalidateMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationZ",{get:function(){return this._transform.rotation.z*M.RADIANS_TO_DEGREES},set:function(t){this.rotationZ!=t&&(this._transform.rotation.z=t*M.DEGREES_TO_RADIANS,this._transform.invalidateMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._transform.scale.x},set:function(t){this._setScaleX(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._transform.scale.y},set:function(t){this._setScaleY(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleZ",{get:function(){return this._transform.scale.z},set:function(t){this._setScaleZ(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skewX",{get:function(){return this._transform.skew.x},set:function(t){this.skewX!=t&&(this._transform.skew.x=t,this._transform.invalidateMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skewY",{get:function(){return this._transform.skew.y},set:function(t){this.skewY!=t&&(this._transform.skew.y=t,this._transform.invalidateMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skewZ",{get:function(){return this._transform.skew.z},set:function(t){this.skewZ!=t&&(this._transform.skew.z=t,this._transform.invalidateMatrix3D())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scenePosition",{get:function(){return this._scenePositionDirty&&(this._registrationMatrix3D&&this.alignmentMode==St.REGISTRATION_POINT?(this._scenePosition.x=-this._registrationMatrix3D._rawData[12],this._scenePosition.y=-this._registrationMatrix3D._rawData[13],this._scenePosition.z=-this._registrationMatrix3D._rawData[14],this._scenePosition=this._transform.concatenatedMatrix3D.transformVector(this._scenePosition,this._scenePosition)):this._transform.concatenatedMatrix3D.copyColumnTo(3,this._scenePosition),this._scenePositionDirty=!1),this._scenePosition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollRect",{get:function(){return this._scrollRect},set:function(t){if(this._scrollRect=t,!t&&this._scrollRectSprite){var e=this.masks.indexOf(this._scrollRectSprite);this.masks.splice(e,1),this._scrollRectSprite=null}this._transform.invalidatePosition()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},set:function(t){this._animator&&this._animator.removeOwner(this),this._animator=t,this._animator&&this._animator.addOwner(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){this._material!=t&&(this._material=t,this._invalidateMaterial())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){this._style!=t&&(this._style&&this._style.removeEventListener(rr.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate),this._style=t,this._style&&this._style.addEventListener(rr.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate),this._invalidateStyle())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boundsVisible",{get:function(){return this._boundsVisible},set:function(t){t!=this._boundsVisible&&(this._boundsVisible=t,this._boundsVisible&&!this.partition&&(this.partition=new oe(this)),this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.getBoundsPrimitive=function(t){if(null==this._boundsPrimitive){switch(this._defaultBoundingVolume){case It.BOX:case It.BOX_BOUNDS:case It.BOX_BOUNDS_FAST:case It.BOX_FAST:this._boundsPrefab=new La(null,Ia.LINE),this._boundsPrimitive=this._boundsPrefab.getNewObject();break;case It.SPHERE:case It.SPHERE_BOUNDS:case It.SPHERE_BOUNDS_FAST:case It.SPHERE_FAST:this._boundsPrefab=new Ra(null,Ia.LINE),this._boundsPrimitive=this._boundsPrefab.getNewObject()}this._boundsPrefabDirty=!0,this._boundsPrimitiveDirty=!0}return this._boundsPrefabDirty&&this._updateBoundsPrefab(t),this._boundsPrimitiveDirty&&this._updateBoundsPrimitive(),this._boundsPrimitive},Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._explicitVisibility},set:function(t){this._explicitVisibility!=t&&(this._explicitVisibility=t,this._invalidateHierarchicalProperties(Dt.VISIBLE))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"masks",{get:function(){return this._explicitMasks},set:function(t){if(this._explicitMasks!=t){if(this._explicitMasks=t,null!=t&&t.length)for(var e=t.length,i=0;i<e;i++)t[i].maskMode=!0;this._invalidateHierarchicalProperties(Dt.MASKS)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._transform.position.x},set:function(t){this._transform.position.x!=t&&(this._transform.matrix3D._rawData[12]=t,this._transform.invalidatePosition())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._transform.position.y},set:function(t){this._transform.position.y!=t&&(this._transform.matrix3D._rawData[13]=t,this._transform.invalidatePosition())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._transform.position.z},set:function(t){this._transform.position.z!=t&&(this._transform.matrix3D._rawData[14]=t,this._transform.invalidatePosition())},enumerable:!0,configurable:!0}),e.prototype.advanceFrame=function(){},e.prototype.isEntity=function(){return!!this._scrollRect},e.prototype.addEventListener=function(e,i){switch(t.prototype.addEventListener.call(this,e,i),e){case Ba.SCENETRANSFORM_CHANGED:this._listenToSceneTransformChanged=!0}},e.prototype.clone=function(){var t=new e;return this.copyTo(t),t},e.prototype.copyTo=function(t){t.defaultBoundingVolume=this._defaultBoundingVolume,this._registrationMatrix3D&&(t._registrationMatrix3D=this._registrationMatrix3D.clone()),t.material=this._material,t.style=this._style,t.pickObject=this._pickObject,t.pickObjectFromTimeline=this.pickObjectFromTimeline,t.boundsVisible=this._boundsVisible,t.name=this._pName,t.mouseEnabled=this._explicitMouseEnabled,t.extra=this.extra,t.maskMode=this._maskMode,t.castsShadows=this.castsShadows,t.isSlice9ScaledMC=this.isSlice9ScaledMC,t.assetNamespace=this.assetNamespace,t._symbol=this._symbol,t.avm1Symbol=this.avm1Symbol,t.isAVMScene=this.isAVMScene,this._explicitMasks&&(t.masks=this._explicitMasks),this._animator&&(t.animator=this._animator.clone()),this._transform.copyRawDataTo(t._transform)},e.prototype.dispose=function(){this.disposeValues()},e.prototype.disposeValues=function(){this._parent&&this._parent.removeChild(this),this.material=null,this._animator&&this._animator.dispose(),this._adapter&&(this._adapter.dispose(),this._adapter=null),this._pickObject=null,this._explicitMasks=null},e.prototype.lookAt=function(t,e){void 0===e&&(e=null),this.transform.lookAt(t,e)},e.prototype.localToGlobal3D=function(t){return this._transform.concatenatedMatrix3D.transformVector(t)},e.prototype.movePivot=function(t,e,i){0==t&&0==e&&0==i||(this._registrationMatrix3D||(this._registrationMatrix3D=new R),this._registrationMatrix3D._rawData[12]-=t/this._transform.scale.x,this._registrationMatrix3D._rawData[13]-=e/this._transform.scale.y,this._registrationMatrix3D._rawData[14]-=i/this._transform.scale.z,this._invalidateHierarchicalProperties(Dt.SCENE_TRANSFORM))},e.prototype.reset=function(){this.visible=!0,this.noTimelineUpdate||this._transform.clearMatrix3D(),this._transform.clearColorTransform(),this.masks=null,this.maskMode=!1},e.prototype.getRenderSceneTransform=function(t){if(this.orientationMode==Tt.CAMERA_PLANE){var e=t.decompose();return e[0].copyFrom(this.scenePosition),e[3].copyFrom(this._transform.scale),this._orientationMatrix.recompose(e),this._registrationMatrix3D&&(this._orientationMatrix.prepend(this._registrationMatrix3D),this.alignmentMode!=St.REGISTRATION_POINT&&this._orientationMatrix.appendTranslation(-this._registrationMatrix3D._rawData[12]*this._transform.scale.x,-this._registrationMatrix3D._rawData[13]*this._transform.scale.y,-this._registrationMatrix3D._rawData[14]*this._transform.scale.z)),this._orientationMatrix}return this._transform.concatenatedMatrix3D},e.prototype.removeEventListener=function(e,i){if(t.prototype.removeEventListener.call(this,e,i),!this.hasEventListener(e))switch(e){case Ba.SCENETRANSFORM_CHANGED:this._listenToSceneTransformChanged=!0}},e.prototype.isOnDisplayList=function(){for(var t=this;t;){if(t.isAVMScene)return!0;t=t.parent}return!1},e.prototype._setParent=function(t){this._partition&&(!t&&this._parent&&this._parent._implicitPartition?(this._parent._implicitPartition.removeChild(this._partition),this.clear()):this._implicitPartition&&this._implicitPartition==this._partition&&this.isEntity()&&this._implicitPartition.invalidateEntity(this)),this._parent=t,this._setPartition(t&&t._implicitPartition?t._implicitPartition:null),this._invalidateHierarchicalProperties(Dt.ALL)},e.prototype._invalidateHierarchicalProperties=function(t){var e=(this._hierarchicalPropsDirty^t)&t;return!e||(this._hierarchicalPropsDirty|=t,e&Dt.SCENE_TRANSFORM&&(this.transform.invalidateConcatenatedMatrix3D(),this._scenePositionDirty=!0,this._boundsPrimitiveDirty=!0,this._pickObjectDirty=!0,this._implicitPartition&&this.isEntity()&&this._implicitPartition.invalidateEntity(this),this._listenToSceneTransformChanged&&(this._sceneTransformChanged||(this._sceneTransformChanged=new Ba(Ba.SCENETRANSFORM_CHANGED,this)),this.queueDispatch(this._sceneTransformChanged))),!1)},e.prototype._setPartition=function(t){t&&null==this._partition&&(this._partition=t.getPartition(this)||this._partition),this._partition&&t&&t.addChild(this._partition);var e=this._partition||t;return this._implicitPartition==e||(this._implicitPartition&&this.clear(),this._implicitPartition=e,this._implicitPartition&&this.isEntity()&&this._implicitPartition.invalidateEntity(this),this.dispatchEvent(new Ba(Ba.PARTITION_CHANGED,this)),!1)},e.prototype._onUpdateConcatenatedMatrix3D=function(t){this._concatenatedMatrix3D.copyFrom(this._transform.matrix3D),this._registrationMatrix3D&&(this._concatenatedMatrix3D.prepend(this._registrationMatrix3D),this.alignmentMode!=St.REGISTRATION_POINT&&this._concatenatedMatrix3D.appendTranslation(-this._registrationMatrix3D._rawData[12]*this._transform.scale.x,-this._registrationMatrix3D._rawData[13]*this._transform.scale.y,-this._registrationMatrix3D._rawData[14]*this._transform.scale.z)),this._parent&&this._concatenatedMatrix3D.append(this._parent._transform.concatenatedMatrix3D),this.scrollRect&&this._concatenatedMatrix3D.prependTranslation(-this.scrollRect.x,-this.scrollRect.y,0),this._matrix3DDirty=!1,this._hierarchicalPropsDirty^=Dt.SCENE_TRANSFORM,this._iController&&this._iController.updateController()},e.prototype._iInternalUpdate=function(){this._iController&&this._iController.update();for(var t=this._queuedEvents.length,e=0;e<t;++e)this.dispatchEvent(this._queuedEvents[e]);this._queuedEvents.length=0},e.prototype._iIsVisible=function(){return this._hierarchicalPropsDirty&Dt.VISIBLE&&this._updateVisible(),this._implicitVisibility},Object.defineProperty(e.prototype,"maskId",{get:function(){return this._hierarchicalPropsDirty&Dt.MASK_ID&&this._updateMaskId(),this._implicitMaskId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maskOwners",{get:function(){return this._hierarchicalPropsDirty&Dt.MASKS&&this._updateMaskOwners(),this._maskOwners},enumerable:!0,configurable:!0}),e.prototype._iAssignedColorTransform=function(){return this._hierarchicalPropsDirty&Dt.COLOR_TRANSFORM&&this._updateColorTransform(),this._pImplicitColorTransform||(this._pImplicitColorTransform=new I)},e.prototype._startDrag=function(){this._isDragEntity=!0},e.prototype._stopDrag=function(){this._isDragEntity=!1},e.prototype.isDragEntity=function(){return this._isDragEntity},e.prototype._iIsMouseEnabled=function(){return this._hierarchicalPropsDirty&Dt.MOUSE_ENABLED&&this._updateMouseEnabled(),this._implicitMouseEnabled&&this._explicitMouseEnabled},e.prototype.isDescendant=function(t){for(var e=this;e.parent;)if((e=e.parent)==t)return!0;return!1},e.prototype.isAncestor=function(t){return t.isDescendant(this)},e.prototype._acceptTraverser=function(t){this._scrollRect&&(this._scrollRectSprite||(this._scrollRectSprite=new e._scrollRectSpriteClass,this._scrollRectSprite.graphics.beginFill(255,1),this._scrollRectSprite.graphics.drawRect(0,0,this._scrollRect.width,this._scrollRect.height),this._scrollRectSprite.graphics.endFill(),this._scrollRectSprite._setParent(this.parent),this.transform.copyRawDataTo(this._scrollRectSprite.transform),this._scrollRectSprite.maskMode=!0,this.masks||(this.masks=[]),this.masks.push(this._scrollRectSprite)))},e.prototype._onInvalidateMatrix3D=function(t){this._matrix3DDirty||(this._matrix3DDirty=!0,this._invalidateHierarchicalProperties(Dt.SCENE_TRANSFORM))},e.prototype._onInvalidateColorTransform=function(t){this._invalidateHierarchicalProperties(Dt.COLOR_TRANSFORM)},e.prototype.queueDispatch=function(t){this._queuedEvents.push(t)},e.prototype._setScaleX=function(t){this.scaleX!=t&&(this._transform.scale.x=t,this._transform.invalidateMatrix3D())},e.prototype._setScaleY=function(t){this.scaleY!=t&&(this._transform.scale.y=t,this._transform.invalidateMatrix3D())},e.prototype._setScaleZ=function(t){this.scaleZ!=t&&(this._transform.scale.z=t,this._transform.invalidateMatrix3D())},e.prototype._updateMouseEnabled=function(){this._implicitMouseEnabled=!this._parent||this._parent.mouseChildren&&this._parent._implicitMouseEnabled,this._hierarchicalPropsDirty^=Dt.MOUSE_ENABLED},e.prototype._updateVisible=function(){this._implicitVisibility=this._parent?this._explicitVisibility&&this._parent._iIsVisible():this._explicitVisibility,this._hierarchicalPropsDirty^=Dt.VISIBLE},e.prototype._updateMaskId=function(){this._implicitMaskId=-1!=this._explicitMaskId?this._explicitMaskId:this._parent&&-1!=this._parent.maskId?this._parent.maskId:-1,this._hierarchicalPropsDirty^=Dt.MASK_ID},e.prototype._updateMaskOwners=function(){this._maskOwners=this._parent&&this._parent.maskOwners&&-1==this.maskId?this._explicitMasks?this._parent.maskOwners.concat([this]):this._parent.maskOwners.concat():null!=this._explicitMasks?[this]:null,this._hierarchicalPropsDirty^=Dt.MASKS},e.prototype._updateColorTransform=function(){this._pImplicitColorTransform||(this._pImplicitColorTransform=new I),this._inheritColorTransform&&this._parent&&this._parent._iAssignedColorTransform()?(this._pImplicitColorTransform.copyFrom(this._parent._iAssignedColorTransform()),this._pImplicitColorTransform.prepend(this._transform.colorTransform)):this._pImplicitColorTransform.copyFrom(this._transform.colorTransform),this.blendMode===fn.OVERLAY&&(this._pImplicitColorTransform.alphaMultiplier*=.5),this._hierarchicalPropsDirty^=Dt.COLOR_TRANSFORM},e.prototype._updateBoundsPrefab=function(t){if(this._boundsPrefab instanceof La){var e=t.getBoundsPicker(this.partition).getBoundingVolume(null,this._defaultBoundingVolume).getBox();if(null==e)return;this._boundsPrefab.width=e.width,this._boundsPrefab.height=e.height,this._boundsPrefab.depth=e.depth,this._boundsPrimitive.registrationPoint=new P(-(e.x+e.width/2)*this._boundsPrimitive.transform.scale.x,-(e.y+e.height/2)*this._boundsPrimitive.transform.scale.y,-(e.z+e.depth/2)*this._boundsPrimitive.transform.scale.z)}else if(this._boundsPrefab instanceof Ra){var i=t.getBoundsPicker(this.partition).getBoundingVolume(null,this._defaultBoundingVolume).getSphere();if(null==i)return;this._boundsPrefab.radius=i.radius,this._boundsPrimitive.registrationPoint=new P(-i.x*this._boundsPrimitive.transform.scale.x,-i.y*this._boundsPrimitive.transform.scale.y,-i.z*this._boundsPrimitive.transform.scale.z)}},e.prototype._updatePickObject=function(){this._pickObject.pickObjectFromTimeline&&(this._pickObject.transform.matrix3D=this.transform.concatenatedMatrix3D)},e.prototype._updateBoundsPrimitive=function(){this._boundsPrimitiveDirty=!1,this._boundsPrimitive.transform.matrix3D=this.transform.concatenatedMatrix3D},e.prototype._updateMaskMode=function(){this.maskMode&&(this.mouseEnabled=!1),this._invalidateHierarchicalProperties(Dt.MASK_ID)},e.prototype.invalidate=function(){t.prototype.invalidate.call(this),this._implicitPartition&&this.isEntity()&&this._implicitPartition.invalidateEntity(this)},e.prototype.clear=function(){t.prototype.clear.call(this),this._pImplicitColorTransform=null,this._maskOwners=null},e.prototype._invalidateMaterial=function(){this.dispatchEvent(new tr(tr.INVALIDATE_MATERIAL,this))},e.prototype._invalidateStyle=function(){this.dispatchEvent(new tr(tr.INVALIDATE_STYLE,this))},e.prototype.invalidateElements=function(){this.dispatchEvent(new tr(tr.INVALIDATE_ELEMENTS,this))},e.prototype._onInvalidateProperties=function(t){this._invalidateStyle()},e.prototype._getDefaultBoundingVolume=function(){return It.BOX_BOUNDS_FAST},e.focusEvent=new Ma(Ma.FOCUS_IN),e}(p),Fa=function(t){function e(){var e=t.call(this)||this;return e._mouseChildren=!0,e._children=new Array,e.doingSwap=!1,e.tabChildren=!1,e}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.dispatchFrameEvents=function(t){this.dispatchEvent(t[0]);for(var e=this._children.length;e>0;)e--,this._children[e].dispatchFrameEvents(t);this.dispatchEvent(t[1])},e.prototype.dispatchEnterFrame=function(t){for(var e=this._children.length;e>0;)--e<this._children.length&&this._children[e].dispatchEnterFrame(t);this.dispatchEvent(t)},e.prototype.dispatchExitFrame=function(t){for(var e=this._children.length;e>0;)--e<this._children.length&&this._children[e].dispatchExitFrame(t);this.dispatchEvent(t)},Object.defineProperty(e.prototype,"mouseChildren",{get:function(){return this._hierarchicalPropsDirty&Dt.MOUSE_ENABLED&&this._updateMouseEnabled(),this._mouseChildren},set:function(t){this._mouseChildren!=t&&(this._mouseChildren=t,this._invalidateHierarchicalProperties(Dt.MOUSE_ENABLED))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numChildren",{get:function(){return this._children.length},enumerable:!0,configurable:!0}),e.prototype.advanceFrame=function(){for(var t=0;t<this._children.length;t++)this._children[t].advanceFrame()},e.prototype.getChildForDraw=function(t){return t._setParent(null),t},e.prototype.returnChildAfterDraw=function(t){return t._setParent(this),t},e.prototype.addChild=function(t){return this.addChildAt(t,this._children.length)},e.prototype.addChildAt=function(t,e){return t.parent&&t.parent.removeChild(t),this._children.splice(e,0,t),t._setParent(this),t},e.prototype.addChildren=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t.length,n=0;n<i;n++)this.addChild(t[n])},e.prototype.clone=function(){var t=new e;return this.copyTo(t),t},e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e),e.mouseChildren=this._mouseChildren;for(var i=this._children.length,n=0;n<i;++n){var r=this._children[n].adapter.clone().adaptee;e.addChild(r)}},e.prototype.contains=function(t){return this._children.indexOf(t)>=0},e.prototype.disposeValues=function(){for(var e=this._children.length-1;e>=0;e--)this.removeChild(this._children[e]);t.prototype.disposeValues.call(this)},e.prototype.getChildAt=function(t){var e=this._children[t];if(null==e)throw new k("Index does not exist in the child list of the caller");return e},e.prototype.getChildByName=function(t){for(var e=this._children.length,i=0;i<e;++i)if(this._children[i].name==t)return this._children[i];return null},e.prototype.getChildIndex=function(t){var e=this._children.indexOf(t);if(-1==e)throw new S("Child parameter is not a child of the caller");return e},e.prototype.getObjectsUnderPoint=function(t){return new Array},e.prototype.removeChild=function(t){if(null==t)throw new S("Parameter child cannot be null");return this.removeChildAt(this.getChildIndex(t)),t},e.prototype.removeChildAt=function(t){return this.removeChildAtInternal(t)},e.prototype.removeChildren=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=2147483647),t<0)throw new k("beginIndex is out of range of the child list");if(e>this._children.length)throw new k("endIndex is out of range of the child list");for(var i=e-1;i>=t;i--)this.removeChildAtInternal(i)},e.prototype.setChildIndex=function(t,e){var i=this.getChildIndex(t);if(i<0)throw new S("Parameter child must be child of this object");if(e>this._children.length)throw new k("Parameter index is out of range of the child list");this._children.splice(i,1),this._children.splice(e,0,t),t._setParent(null),t._setParent(this),t._sessionID>=0&&this._sessionID_childs&&(delete this._sessionID_childs[t._sessionID],t._sessionID=-1)},e.prototype.swapChildren=function(t,e){t.parent==this&&e.parent==this&&this.swapChildrenAt(this.getChildIndex(t),this.getChildIndex(e))},e.prototype.swapChildrenAt=function(t,e){var i;if(t!=e){if(t>=this._children.length||e>=this._children.length)throw"[scene/DisplayobjectContainer] - swapChildrenAt - Range Error";i=[this._children[t],this._children[e]],this._children[e]=i[0],this._children[t]=i[1],this._children[t]._setParent(null),this._children[t]._setParent(this),this._children[e]._setParent(null),this._children[e]._setParent(this),this._sessionID_childs&&(this._children[t]._sessionID>=0&&(delete this._sessionID_childs[this._children[t]._sessionID],this._children[t]._sessionID,this._children[t]._avmDepthID),this._children[e]._sessionID>=0&&(delete this._sessionID_childs[this._children[e]._sessionID],this._children[e]._sessionID,this._children[t]._avmDepthID))}},e.prototype._invalidateHierarchicalProperties=function(e){if(t.prototype._invalidateHierarchicalProperties.call(this,e))return!0;for(var i=this._children.length,n=0;n<i;++n)this._children[n]._invalidateHierarchicalProperties(e);return!1},e.prototype._setPartition=function(e){if(t.prototype._setPartition.call(this,e))return!0;for(var i=this._children.length,n=0;n<i;++n)this._children[n]._setPartition(this._implicitPartition);return!1},e.prototype.removeChildAtInternal=function(t){var e=this._children.splice(t,1)[0];return e._setParent(null),e},e.prototype._updateMaskMode=function(){this.maskMode&&(this.mouseChildren=!1),t.prototype._updateMaskMode.call(this)},e.assetType="[asset DisplayObjectContainer]",e}(Na);re.registerAbstraction(se,Fa);var ka=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this)||this;return n._isEntity=!1,n._onGraphicsInvalidateDelegate=function(t){return n._onGraphicsInvalidate(t)},n.graphics=e||Sa.getGraphics(),n.material=i,n}return i(e,t),e.getNewSprite=function(t,i){if(void 0===t&&(t=null),void 0===i&&(i=null),e._sprites.length){var n=e._sprites.pop();return n.graphics=t||Sa.getGraphics(),n.material=i,n}return new e(t,i)},e.clearPool=function(){e._sprites=[]},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphics",{get:function(){return this._iSourcePrefab&&this._iSourcePrefab._iValidate(),this.isSlice9ScaledSprite&&this._graphics.updateSlice9(this.parent.scaleX,this.parent.scaleY),this._graphics},set:function(t){if(null==t)throw new Error("Cannot have graphics set to null");this._setGraphics(t)},enumerable:!0,configurable:!0}),e.prototype._setGraphics=function(t){this._graphics!=t&&(this._graphics&&(this._graphics.removeEventListener(l.INVALIDATE,this._onGraphicsInvalidateDelegate),this._graphics.usages--),this._graphics=t,this._graphics.usages++,this._onGraphicsInvalidate(null))},e.prototype._setParent=function(e){t.prototype._setParent.call(this,e),e?this._graphics.addEventListener(l.INVALIDATE,this._onGraphicsInvalidateDelegate):this._graphics.removeEventListener(l.INVALIDATE,this._onGraphicsInvalidateDelegate)},e.prototype.isEntity=function(){return Boolean(this._scrollRect||this._graphics&&this._graphics.count)},e.prototype.dispose=function(){this.disposeValues(),e._sprites.push(this)},e.prototype.disposeValues=function(){t.prototype.disposeValues.call(this)},e.prototype.clone=function(){var t=e.getNewSprite();return this.copyTo(t),t},e.prototype.copyTo=function(e,i){void 0===i&&(i=!1),t.prototype.copyTo.call(this,e),e._iSourcePrefab=this._iSourcePrefab,this._graphics.copyTo(e._graphics,i)},e.prototype._iInternalUpdate=function(){t.prototype._iInternalUpdate.call(this)},e.prototype._onGraphicsInvalidate=function(t){var e=this.isEntity();this._isEntity!=e&&(!e&&this._implicitPartition&&this._implicitPartition.clearEntity(this),this._isEntity=e),this.invalidate()},e.prototype._acceptTraverser=function(e){t.prototype._acceptTraverser.call(this,e),this.graphics._acceptTraverser(e)},e.prototype.bakeTransformations=function(){this._graphics.applyTransformation(this.transform.matrix3D),this.transform.clearMatrix3D()},e._sprites=new Array,e.assetType="[asset Sprite]",e}(Fa);Na._scrollRectSpriteClass=ka,re.registerAbstraction(se,ka);var Va=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._frameCaches={},e}return i(e,t),e.getNewMorphSprite=function(t,i){if(void 0===t&&(t=null),void 0===i&&(i=null),e._morphSprites.length){var n=e._morphSprites.pop();return n.graphics=t||Sa.getGraphics(),n.material=i,n}return new e(t,i)},e.prototype._setGraphics=function(t){this._graphics!=t&&(this._graphics&&(this._graphics.removeEventListener(l.INVALIDATE,this._onGraphicsInvalidateDelegate),this._graphics.usages--),this._graphics||(this._graphics=Sa.getGraphics()),this._graphics.copyFrom(t),this._onGraphicsInvalidate(null))},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.reset=function(){t.prototype.reset.call(this),this.setRatio(0)},e.prototype._blendStyle=function(t,e,i,n){var r,o,s=1-n,a=n;if(t.style.data_type!=e.style.data_type)throw"Error in morph data - different styles of pathes";switch(t.style.data_type){case ws.data_type:var l=t.style,u=e.style;o=s*l.alpha+a*u.alpha,r=w.interpolateFloat32Color(l.color,u.color,n),i.style=new ws(r,o);break;case Is.data_type:for(var c=[],h=[],p=[],d=(l=t.style,u=e.style,l.colors.length),f=0;f<d;f++)c[c.length]=w.interpolateFloat32Color(l.colors[f],u.colors[f],n),p[p.length]=s*l.alphas[f]+a*u.alphas[f],h[h.length]=s*l.ratios[f]+a*u.ratios[f];var _=l.matrix,m=u.matrix;(g=new T).a=_.a*s+m.a*a,g.b=_.b*s+m.b*a,g.c=_.c*s+m.c*a,g.d=_.d*s+m.d*a,g.tx=_.tx*s+m.tx*a,g.ty=_.ty*s+m.ty*a,i.style=new Is(l.type,c,p,h,g,l.spreadMethod,l.interpolationMethod,l.focalPointRatio);break;case Es.data_type:var g;l=t.style,u=e.style,_=l.matrix,m=u.matrix;(g=new T).a=_.a*s+m.a*a,g.b=_.b*s+m.b*a,g.c=_.c*s+m.c*a,g.d=_.d*s+m.d*a,g.tx=_.tx*s+m.tx*a,g.ty=_.ty*s+m.ty*a,i.style=new Es(l.material,g,l.repeat,l.smooth);break;case Ps.data_type:l=t.style,u=e.style;o=s*l.alpha+a*u.alpha,r=w.interpolateFloat32Color(l.color,u.color,n);var y=s*l.thickness+a*u.thickness;i.style=new Ps(r,o,y,l.jointstyle,l.capstyle,l.miter_limit,l.scaleMode)}},e.prototype._blendContours=function(t,e,i,n){var r=1-n,o=n,s=t._commands.length;if(e._commands.length!==s)throw"Error in morph data - different number of contour";for(var a=0;a<s;a++){var l=t._commands[a],u=t._data[a],c=e._commands[a],h=e._data[a],p=0,d=0,f=0,_=0,m=0,g=0,y=l.length;if(c.length!=y)throw y=Math.min(c.length,y),"Error in morph data - different number of commands in contour";for(var A=0;A<y;A++)switch(l[A]){case ba.MOVE_TO:if(c[A]!=ba.MOVE_TO)throw"Error in morph data - both shapes must start with Move too command";f=u[p++],_=u[p++],m=h[d++],g=h[d++],i.moveTo(r*f+o*m,r*_+o*g);break;case ba.LINE_TO:if(c[A]==ba.LINE_TO)f=u[p++],_=u[p++],m=h[d++],g=h[d++],i.lineTo(r*f+o*m,r*_+o*g);else if(c[A]==ba.CURVE_TO){var v=f+(u[p++]-f)/2,b=_+(u[p++]-_)/2;i.curveTo(r*v+o*h[d++],r*b+o*h[d++],r*u[p-2]+o*h[d++],r*u[p-1]+o*h[d++]),f=u[p-2],_=u[p-1],m=h[d-2],g=h[d-1]}break;case ba.CURVE_TO:if(c[A]==ba.LINE_TO){v=m+(h[d++]-m)/2,b=g+(h[d++]-g)/2;i.curveTo(r*u[p++]+o*v,r*u[p++]+o*b,r*u[p++]+o*h[d-2],r*u[p++]+o*h[d-1]),f=u[p-2],_=u[p-1],m=h[d-2],g=h[d-1]}else c[A]==ba.CURVE_TO&&(i.curveTo(r*u[p++]+o*h[d++],r*u[p++]+o*h[d++],r*u[p++]+o*h[d++],r*u[p++]+o*h[d++]),f=u[p-2],_=u[p-1],m=h[d-2],g=h[d-1])}}},e.prototype.setRatio=function(t){var e=65535*t|0,i=this._graphics;if(this._ratio!==e){if(this._ratio=e,i.buildQueueTags?i.buildQueueTags(!0):(i.endFill(),i.clear()),i.start.length!==i.end.length)throw"Error in morph data - different number of pathes";for(var n=i.start.length,r=0;r<n;r++){var o=new wa,s=i.start[r],a=i.end[r];this._blendStyle(s,a,o,t),this._blendContours(s,a,o,t),i.add_queued_path(o)}i._endFillInternal(!0)}},e.prototype.dispose=function(){this.disposeValues(),this._frameCaches={},e._morphSprites.push(this)},e.prototype.clone=function(){var t=e.getNewMorphSprite();return this.copyTo(t),t},e.assetType="[asset MorphSprite]",e._morphSprites=new Array,e}(ka);re.registerAbstraction(se,Va);var Ua=["",fn.NORMAL,fn.LAYER,fn.MULTIPLY,fn.SCREEN,fn.LIGHTEN,fn.DARKEN,fn.DIFFERENCE,fn.ADD,fn.SUBTRACT,fn.INVERT,fn.ALPHA,fn.ERASE,fn.OVERLAY,fn.HARDLIGHT];var ja=function(){function t(){this._functions=[],this._update_indices=[],this._update_frames=[],this.isButton=!1,this._initalMcID=-1,this.numKeyFrames=0,this.keyframe_indices=[],this.avm1Exports={},this.avm1InitActions={},this.avm1ButtonActions=[],this.graphicsPool={},this.audioPool={},this.placeObjectTagsForSessionIDs={},this._labels={},this._framescripts={},this._framescripts_translated={},this.keyframe_to_frameidx={},this._functions[1]=this.update_mtx_all.bind(this),this._functions[2]=this.update_colortransform.bind(this),this._functions[3]=this.update_masks.bind(this),this._functions[4]=this.update_name.bind(this),this._functions[5]=this.update_button_name.bind(this),this._functions[6]=this.update_visibility.bind(this),this._functions[7]=this.update_blendmode.bind(this),this._functions[8]=this.update_rendermode.bind(this),this._functions[9]=this.update_filters.bind(this),this._functions[11]=this.update_mtx_scale_rot.bind(this),this._functions[12]=this.update_mtx_pos.bind(this),this._functions[200]=this.enable_maskmode.bind(this),this._functions[201]=this.remove_masks.bind(this),this._functions[202]=this.swap_graphics.bind(this),this._functions[203]=this.set_ratio.bind(this),this._functions[204]=this.start_audio.bind(this)}return Object.defineProperty(t.prototype,"symbolDecoder",{get:function(){return this._symbolDecoder},set:function(t){this._symbolDecoder=t},enumerable:!0,configurable:!0}),t.prototype.resetScripts=function(){this._framescripts={},this._framescripts_translated={}},t.prototype.init=function(){if(this._symbolDecoder||console.warn("[Timeline] - init - no _symbolDecoder is set"),null!=this.frame_command_indices&&null!=this.frame_recipe&&null!=this.keyframe_durations){var t=0,e=0,i=0,n=0,r=0,o=0;this.keyframe_firstframes=[],this.keyframe_constructframes=[],this.keyframe_indices=[],this.keyframe_to_frameidx={},this.keyframe_to_frameidx[0]=0;var s=0;for(e=0;e<this.numKeyFrames;e++)for(this.keyframe_to_frameidx[e]=s,s+=n=this.keyframe_durations[e],1&this.frame_recipe[e]&&(o=r),this.keyframe_firstframes[r]=t,this.keyframe_constructframes[r++]=o,i=0;i<n;i++)this.keyframe_indices[t++]=e}},t.prototype.get_framescript=function(t){if(null==this._framescripts[t])return"";if("string"==typeof this._framescripts[t])return this._framescripts[t];throw new Error("Framescript is already translated to Function!!!")},t.prototype.add_framescript=function(t,e,i,n){if(void 0===n&&(n=!1),!(this._initalMcID>=0&&i.id!=this._initalMcID)){if(this._initalMcID=i.id,this._framescripts[e]||(this._framescripts[e]=[]),Array.isArray(t))for(var r=0;r<t.length;r++)this._framescripts[e][this._framescripts[e].length]=t[r];else this._framescripts[e].push(t);this._framescripts_translated[e]=!n}},t.prototype.get_script_for_frame=function(t,e,i){if(void 0===i&&(i=!1),e>=0&&this._framescripts[e]){if(i&&!this._framescripts_translated[e]){var n=t.className?t.className:t.name;this._framescripts[e]=this.symbolDecoder.prepareFrameScriptsForAVM1(this._framescripts[e],e,n,t.id),this._framescripts_translated[e]=!0}return this._framescripts[e]}return null},Object.defineProperty(t.prototype,"numFrames",{get:function(){return this.keyframe_indices.length},enumerable:!0,configurable:!0}),t.prototype.getKeyframeIndexForFrameIndex=function(t){return this.keyframe_indices[t]},t.prototype.getChildInstance=function(t,e){return this.symbolDecoder.createChildInstanceForTimeline(this,t,e)},t.prototype.extractHitArea=function(t){t.reset(!1),this.gotoFrame(t,this.numFrames-1,!1);for(var e,i,n=t.numChildren,r=new Fa;n>0;)n--,(e=(i=t.getChildAt(n)).clone()).x=i.x,e.scaleX=i.scaleX,e.y=i.y,e.scaleY=i.scaleY,e.rotationZ=i.rotationZ,r.addChild(e);return r.pickObjectFromTimeline=!0,t.pickObject=r,t.reset(!1),r},t.prototype.getCurrentFrameLabel=function(t){for(var e in this._labels)if(this._labels[e].keyFrameIndex==t.constructedKeyFrameIndex)return this._labels[e].name;return null},t.prototype.getCurrentLabel=function(t){var e=null,i=-1;for(var n in this._labels){var r=this._labels[n].keyFrameIndex;r>i&&r<=t.constructedKeyFrameIndex&&(i=r,e=this._labels[n].name)}return e},t.prototype.jumpToLabel=function(t,e,i){if(void 0===i&&(i=0),this._labels[e]){var n=this._labels[e].keyFrameIndex;n>=0&&(t.currentFrameIndex=this.keyframe_firstframes[n]+i)}else console.warn("[TIMELINE] - jumpToLabel with invalid label",t,e,i)},t.prototype.getScriptForLabel=function(t,e,i){void 0===i&&(i=!1);var n=this._labels[e.toLowerCase()].keyFrameIndex;if(n<0)return null;var r=this.keyframe_firstframes[n];return r>=0&&this._framescripts[r]?this.get_script_for_frame(t,r,i):null},t.prototype.gotoFrame=function(t,e,i,n,r){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=t.constructedKeyFrameIndex,s=this.keyframe_indices[e];if(o!=s||r)if(o+1!=s){var a=this.keyframe_constructframes[s],l=a,u=s>o;u&&o>a&&(l=o+1),t.adapter.constructFrame(this,l,s,u,e,n,i),this.applyCollectedUpdateCommands(t),t.constructedKeyFrameIndex=s}else this.constructNextFrame(t,i,!0)},t.prototype.applyCollectedUpdateCommands=function(t){var e,i=this._update_indices.length;for(e=0;e<i;e++)this.update_childs(t,this._update_indices[e],this._update_frames[e])},t.prototype.constructNextFrame=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1);var n=t.currentFrameIndex,r=this.keyframe_indices[n];if(e&&t.adapter.queueFrameScripts(this,n,i),t.constructedKeyFrameIndex!=r){t.constructedKeyFrameIndex=r;var o=this.frame_command_indices[r],s=this.frame_recipe[r];if(1&s)for(var a=t.numChildren-1;a>=0;a--)t._children[a]._avmDepthID<0&&t.removeChildAt(a);else 2&s&&this.remove_childs_continous(t,o++);4&s&&this.add_childs_continous(t,o++),8&s&&this.update_childs(t,o++),16&s&&this.start_sounds(t,o++)}},t.prototype.remove_childs_continous=function(t,e){for(var i=this.command_index_stream[e],n=i+this.command_length_stream[e],r=i;r<n;r++)t.adapter.removeTimelineChildAt(this.remove_child_stream[r])},t.prototype.add_childs_continous=function(t,e){for(var i,n=this.command_index_stream[e],r=n+this.command_length_stream[e],o=n;o<r;o++)if(i=3*o,void 0!==this.add_child_stream[i]){var s=this._symbolDecoder.createChildInstanceForTimeline(this,this.add_child_stream[i+2],this.add_child_stream[i]);t.adapter.addTimelineChildAtDepth(s,this.add_child_stream[i+1])}else console.warn("[Timeline] - add_childs_continous - could not find child-id in child_stream for idx",i,this.add_child_stream)},t.prototype.start_sounds=function(t,e){for(var i=this.command_index_stream[e],n=i+this.command_length_stream[e],r=i;r<n;r++){var o=this.audioPool[this.add_sounds_stream[r]];if(o)if(15==o.cmd){var s=o.sound;if(!s)return void console.warn("[Timeline] Missed sound to start!",o);o.props.loopCount>0?s.loopsToPlay=o.props.loopCount:s.loopsToPlay=0,t.startSound(o.id,s,s.loopsToPlay)}else 16==o.cmd&&t.stopSound(o.id)}},t.prototype.update_childs=function(t,e,i){for(var n,r,o,s,a=this.command_index_stream[e],l=a+this.command_length_stream[e],u=a;u<l;u++)if(s=t.getTimelineChildAtSessionID(this.update_child_stream[u]))for(this._blocked=Boolean(s._adapter&&s.adapter.isBlockedByScript()),o=(r=this.update_child_props_indices_stream[u])+this.update_child_props_length_stream[u],n=r;n<o;n++)this._functions[this.property_type_stream[n]](s,t,this.property_index_stream[n])},t.prototype.update_mtx_all=function(t,e,i){if(!this._blocked&&!t.noTimelineUpdate){i*=6;var n=t.transform.matrix3D;n._rawData[0]=this.properties_stream_f32_mtx_all[i++],n._rawData[1]=this.properties_stream_f32_mtx_all[i++],n._rawData[4]=this.properties_stream_f32_mtx_all[i++],n._rawData[5]=this.properties_stream_f32_mtx_all[i++],n._rawData[12]=this.properties_stream_f32_mtx_all[i++],n._rawData[13]=this.properties_stream_f32_mtx_all[i],t.transform.invalidateComponents()}},t.prototype.update_colortransform=function(t,e,i){if(!t._adapter||!t.adapter.isColorTransformByScript()){i*=8;var n=t.transform.colorTransform||(t.transform.colorTransform=new I);n._rawData[0]=this.properties_stream_f32_ct[i++],n._rawData[1]=this.properties_stream_f32_ct[i++],n._rawData[2]=this.properties_stream_f32_ct[i++],n._rawData[3]=this.properties_stream_f32_ct[i++],n._rawData[4]=this.properties_stream_f32_ct[i++],n._rawData[5]=this.properties_stream_f32_ct[i++],n._rawData[6]=this.properties_stream_f32_ct[i++],n._rawData[7]=this.properties_stream_f32_ct[i],t.transform.invalidateColorTransform()}},t.prototype.update_masks=function(t,e,i){var n,r=new Array,o=this.properties_stream_int[i++];if(0!=o){for(var s=0;s<o;s++)(n=e.getTimelineChildAtSessionID(this.properties_stream_int[i++]))&&r.push(n);t.masks=r}else t.masks=null},t.prototype.update_name=function(t,e,i){e.adapter.unregisterScriptObject(t),t.name=this.properties_stream_strings[i],e.adapter.registerScriptObject(t)},t.prototype.update_button_name=function(t,e,i){t.name=this.properties_stream_strings[i],t.addButtonListeners(),e.adapter.registerScriptObject(t)},t.prototype.update_visibility=function(t,e,i){t._adapter&&t.adapter.isVisibilityByScript()||(t.visible=Boolean(i))},t.prototype.update_mtx_scale_rot=function(t,e,i){if(!this._blocked&&!t.noTimelineUpdate){i*=4;var n=t.transform.matrix3D;n._rawData[0]=this.properties_stream_f32_mtx_scale_rot[i++],n._rawData[1]=this.properties_stream_f32_mtx_scale_rot[i++],n._rawData[4]=this.properties_stream_f32_mtx_scale_rot[i++],n._rawData[5]=this.properties_stream_f32_mtx_scale_rot[i],t.transform.invalidateComponents(),t._invalidateHierarchicalProperties(Dt.SCENE_TRANSFORM)}},t.prototype.update_mtx_pos=function(t,e,i){if(!this._blocked&&!t.noTimelineUpdate){i*=2;var n=t.transform.matrix3D;n._rawData[12]=this.properties_stream_f32_mtx_pos[i++],n._rawData[13]=this.properties_stream_f32_mtx_pos[i],t.transform.invalidatePosition()}},t.prototype.enable_maskmode=function(t,e,i){t.maskMode=!0},t.prototype.remove_masks=function(t,e,i){t.masks=null},t.prototype.update_filters=function(t,e,i){var n=this.properties_stream_int[i++],r=this.properties_stream_int[i++],o=t.adapter;0!==r?o.updateFilters(this.properties_stream_filters.slice(n,n+r)):o.updateFilters(null)},t.prototype.swap_graphics=function(t,e,i){if(t.isAsset(ka)){var n=this.graphicsPool[this.properties_stream_int[i]];if(n.id==t.graphics.id)return;t.graphics=n}else console.warn("[Timeline] - swap_graphics - child is not a Sprite")},t.prototype.start_audio=function(t,e,i){},t.prototype.set_ratio=function(t,e,i){t.isAsset(Va)?t.setRatio(this.properties_stream_int[i]/65535):console.warn("[Timeline] - set_ratio - child is not a MorphSprite")},t.prototype.update_blendmode=function(t,e,i){t.blendMode=function(t){return void 0===t&&(t=1),Ua[t]||Ua[1]}(i)},t.prototype.update_rendermode=function(t,e,i){console.log("update rendermode "+i)},t.prototype.dispose=function(){this.keyframe_indices=[],this.avm1Exports={},this.avm1InitActions={},this.avm1ButtonActions=[],this.graphicsPool={},this.audioPool={},this.placeObjectTagsForSessionIDs={},this._labels={},this._framescripts={},this._framescripts_translated={}},t}(),Ga=function(){function t(t){void 0===t&&(t=null),this._pAutoUpdate=!0,this.targetObject=t}return t.prototype.pNotifyUpdate=function(){this._pTargetObject&&this._pTargetObject._invalidateHierarchicalProperties(Dt.SCENE_TRANSFORM)},Object.defineProperty(t.prototype,"targetObject",{get:function(){return this._pTargetObject},set:function(t){this._pTargetObject!=t&&(this._pTargetObject&&this._pAutoUpdate&&(this._pTargetObject._iController=null),this._pTargetObject=t,this._pTargetObject&&this._pAutoUpdate&&(this._pTargetObject._iController=this),this.pNotifyUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._pAutoUpdate},set:function(t){this._pAutoUpdate!=t&&(this._pAutoUpdate=t,this._pTargetObject&&(this._pAutoUpdate?this._pTargetObject._iController=this:this._pTargetObject._iController=null))},enumerable:!0,configurable:!0}),t.prototype.update=function(t){throw new s},t.prototype.updateController=function(){this._pControllerDirty&&this._pAutoUpdate&&(this._pControllerDirty=!1,this.pNotifyUpdate())},t}(),Qa=(function(t){function e(e,i,n,r,o,s,a){void 0===e&&(e=null),void 0===i&&(i=0),void 0===n&&(n=90),void 0===r&&(r=-90),void 0===o&&(o=90),void 0===s&&(s=8),void 0===a&&(a=!1);var l=t.call(this,e)||this;return l._iCurrentPanAngle=0,l._iCurrentTiltAngle=90,l._panAngle=0,l._tiltAngle=90,l._minTiltAngle=-90,l._maxTiltAngle=90,l._steps=8,l._walkIncrement=0,l._strafeIncrement=0,l._wrapPanAngle=!1,l.fly=!1,l.panAngle=i,l.tiltAngle=n,l.minTiltAngle=r,l.maxTiltAngle=o,l.steps=s,l.wrapPanAngle=a,l._iCurrentPanAngle=l._panAngle,l._iCurrentTiltAngle=l._tiltAngle,l}i(e,t),Object.defineProperty(e.prototype,"steps",{get:function(){return this._steps},set:function(t){t=t<1?1:t,this._steps!=t&&(this._steps=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panAngle",{get:function(){return this._panAngle},set:function(t){this._panAngle!=t&&(this._panAngle=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tiltAngle",{get:function(){return this._tiltAngle},set:function(t){t=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,t)),this._tiltAngle!=t&&(this._tiltAngle=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minTiltAngle",{get:function(){return this._minTiltAngle},set:function(t){this._minTiltAngle!=t&&(this._minTiltAngle=t,this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxTiltAngle",{get:function(){return this._maxTiltAngle},set:function(t){this._maxTiltAngle!=t&&(this._maxTiltAngle=t,this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wrapPanAngle",{get:function(){return this._wrapPanAngle},set:function(t){this._wrapPanAngle!=t&&(this._wrapPanAngle=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),e.prototype.update=function(t){if(void 0===t&&(t=!0),this._tiltAngle!=this._iCurrentTiltAngle||this._panAngle!=this._iCurrentPanAngle){if(this._pControllerDirty=!0,this._wrapPanAngle){for(this._panAngle<0?(this._iCurrentPanAngle+=this._panAngle%360+360-this._panAngle,this._panAngle=this._panAngle%360+360):(this._iCurrentPanAngle+=this._panAngle%360-this._panAngle,this._panAngle=this._panAngle%360);this._panAngle-this._iCurrentPanAngle<-180;)this._iCurrentPanAngle-=360;for(;this._panAngle-this._iCurrentPanAngle>180;)this._iCurrentPanAngle+=360}t?(this._iCurrentTiltAngle+=(this._tiltAngle-this._iCurrentTiltAngle)/(this.steps+1),this._iCurrentPanAngle+=(this._panAngle-this._iCurrentPanAngle)/(this.steps+1)):(this._iCurrentTiltAngle=this._tiltAngle,this._iCurrentPanAngle=this._panAngle),Math.abs(this.tiltAngle-this._iCurrentTiltAngle)<.01&&Math.abs(this._panAngle-this._iCurrentPanAngle)<.01&&(this._iCurrentTiltAngle=this._tiltAngle,this._iCurrentPanAngle=this._panAngle)}this.targetObject.rotationX=this._iCurrentTiltAngle,this.targetObject.rotationY=this._iCurrentPanAngle,this._walkIncrement&&(this.fly?this.targetObject.transform.moveForward(this._walkIncrement):(this.targetObject.x+=this._walkIncrement*Math.sin(this._panAngle*M.DEGREES_TO_RADIANS),this.targetObject.z+=this._walkIncrement*Math.cos(this._panAngle*M.DEGREES_TO_RADIANS)),this._walkIncrement=0),this._strafeIncrement&&(this.targetObject.transform.moveRight(this._strafeIncrement),this._strafeIncrement=0)},e.prototype.incrementWalk=function(t){0!=t&&(this._walkIncrement+=t,this.pNotifyUpdate())},e.prototype.incrementStrafe=function(t){0!=t&&(this._strafeIncrement+=t,this.pNotifyUpdate())}}(Ga),function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this,e)||this;return n._pOrigin=new P(0,0,0),n._onLookAtObjectChangedDelegate=function(t){return n.onLookAtObjectChanged(t)},i?n.lookAtObject=i:n.lookAtPosition=new P,n}return i(e,t),Object.defineProperty(e.prototype,"lookAtPosition",{get:function(){return this._pLookAtPosition},set:function(t){this._pLookAtObject&&(this._pLookAtObject.removeEventListener(Ba.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate),this._pLookAtObject=null),this._pLookAtPosition=t,this.pNotifyUpdate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lookAtObject",{get:function(){return this._pLookAtObject},set:function(t){this._pLookAtPosition&&(this._pLookAtPosition=null),this._pLookAtObject!=t&&(this._pLookAtObject&&this._pLookAtObject.removeEventListener(Ba.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate),this._pLookAtObject=t,this._pLookAtObject&&this._pLookAtObject.addEventListener(Ba.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate),this.pNotifyUpdate())},enumerable:!0,configurable:!0}),e.prototype.update=function(t){this._pTargetObject&&(this._pLookAtPosition?this._pTargetObject.lookAt(this._pLookAtPosition):this._pLookAtObject&&this._pTargetObject.lookAt(this._pLookAtObject.transform.concatenatedMatrix3D.position))},e.prototype.onLookAtObjectChanged=function(t){this.pNotifyUpdate()},e}(Ga)),za=(function(t){function e(e,i,n,r){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=45),void 0===r&&(r=700),t.call(this,e,i,0,n,r)||this}i(e,t),e.prototype.update=function(e){this.lookAtObject&&(this.panAngle=this._pLookAtObject.rotationY-180,t.prototype.update.call(this))}}(function(t){function e(e,i,n,r,o,s,a,l,u,c,h,p){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=0),void 0===r&&(r=90),void 0===o&&(o=1e3),void 0===s&&(s=-90),void 0===a&&(a=90),void 0===l&&(l=null),void 0===u&&(u=null),void 0===c&&(c=8),void 0===h&&(h=2),void 0===p&&(p=!1);var d=t.call(this,e,i)||this;return d._iCurrentPanAngle=0,d._iCurrentTiltAngle=90,d._panAngle=0,d._tiltAngle=90,d._distance=1e3,d._minPanAngle=-1/0,d._maxPanAngle=1/0,d._minTiltAngle=-90,d._maxTiltAngle=90,d._steps=8,d._yFactor=2,d._wrapPanAngle=!1,d._upAxis=new P,d.distance=o,d.panAngle=n,d.tiltAngle=r,d.minPanAngle=null!=l?l:-1/0,d.maxPanAngle=null!=u?u:1/0,d.minTiltAngle=s,d.maxTiltAngle=a,d.steps=c,d.yFactor=h,d.wrapPanAngle=p,d._iCurrentPanAngle=d._panAngle,d._iCurrentTiltAngle=d._tiltAngle,d}return i(e,t),Object.defineProperty(e.prototype,"steps",{get:function(){return this._steps},set:function(t){t=t<1?1:t,this._steps!=t&&(this._steps=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panAngle",{get:function(){return this._panAngle},set:function(t){t=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,t)),this._panAngle!=t&&(this._panAngle=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tiltAngle",{get:function(){return this._tiltAngle},set:function(t){t=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,t)),this._tiltAngle!=t&&(this._tiltAngle=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance!=t&&(this._distance=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minPanAngle",{get:function(){return this._minPanAngle},set:function(t){this._minPanAngle!=t&&(this._minPanAngle=t,this.panAngle=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,this._panAngle)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxPanAngle",{get:function(){return this._maxPanAngle},set:function(t){this._maxPanAngle!=t&&(this._maxPanAngle=t,this.panAngle=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,this._panAngle)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minTiltAngle",{get:function(){return this._minTiltAngle},set:function(t){this._minTiltAngle!=t&&(this._minTiltAngle=t,this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxTiltAngle",{get:function(){return this._maxTiltAngle},set:function(t){this._maxTiltAngle!=t&&(this._maxTiltAngle=t,this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yFactor",{get:function(){return this._yFactor},set:function(t){this._yFactor!=t&&(this._yFactor=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wrapPanAngle",{get:function(){return this._wrapPanAngle},set:function(t){this._wrapPanAngle!=t&&(this._wrapPanAngle=t,this.pNotifyUpdate())},enumerable:!0,configurable:!0}),e.prototype.update=function(t){if(void 0===t&&(t=!0),this._tiltAngle!=this._iCurrentTiltAngle||this._panAngle!=this._iCurrentPanAngle){if(this._pControllerDirty=!0,this._wrapPanAngle){for(this._panAngle<0?(this._iCurrentPanAngle+=this._panAngle%360+360-this._panAngle,this._panAngle=this._panAngle%360+360):(this._iCurrentPanAngle+=this._panAngle%360-this._panAngle,this._panAngle=this._panAngle%360);this._panAngle-this._iCurrentPanAngle<-180;)this._iCurrentPanAngle-=360;for(;this._panAngle-this._iCurrentPanAngle>180;)this._iCurrentPanAngle+=360}t?(this._iCurrentTiltAngle+=(this._tiltAngle-this._iCurrentTiltAngle)/(this.steps+1),this._iCurrentPanAngle+=(this._panAngle-this._iCurrentPanAngle)/(this.steps+1)):(this._iCurrentPanAngle=this._panAngle,this._iCurrentTiltAngle=this._tiltAngle),Math.abs(this.tiltAngle-this._iCurrentTiltAngle)<.01&&Math.abs(this._panAngle-this._iCurrentPanAngle)<.01&&(this._iCurrentTiltAngle=this._tiltAngle,this._iCurrentPanAngle=this._panAngle)}var e=this.lookAtObject?this.lookAtObject.transform.position:this.lookAtPosition?this.lookAtPosition:this._pOrigin;this.targetObject.x=e.x+this.distance*Math.sin(this._iCurrentPanAngle*M.DEGREES_TO_RADIANS)*Math.cos(this._iCurrentTiltAngle*M.DEGREES_TO_RADIANS),this.targetObject.y=e.y+this.distance*Math.sin(this._iCurrentTiltAngle*M.DEGREES_TO_RADIANS)*this.yFactor,this.targetObject.z=e.z+this.distance*Math.cos(this._iCurrentPanAngle*M.DEGREES_TO_RADIANS)*Math.cos(this._iCurrentTiltAngle*M.DEGREES_TO_RADIANS),this._upAxis.x=-Math.sin(this._iCurrentPanAngle*M.DEGREES_TO_RADIANS)*Math.sin(this._iCurrentTiltAngle*M.DEGREES_TO_RADIANS),this._upAxis.y=Math.cos(this._iCurrentTiltAngle*M.DEGREES_TO_RADIANS),this._upAxis.z=-Math.cos(this._iCurrentPanAngle*M.DEGREES_TO_RADIANS)*Math.sin(this._iCurrentTiltAngle*M.DEGREES_TO_RADIANS),this._pTargetObject&&(this._pLookAtPosition?this._pTargetObject.lookAt(this._pLookAtPosition,this._upAxis):this._pLookAtObject&&this._pTargetObject.lookAt(this._pLookAtObject.transform.concatenatedMatrix3D.position,this._upAxis))},e}(Qa)),function(t){function e(e,i,n,r,o){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=1),void 0===r&&(r=40),void 0===o&&(o=4);var s=t.call(this,e,i)||this;return s.positionOffset=new P(0,500,-1e3),s.stiffness=n,s.damping=o,s.mass=r,s._velocity=new P,s._dv=new P,s._stretch=new P,s._force=new P,s._acceleration=new P,s._desiredPosition=new P,s}i(e,t),e.prototype.update=function(e){var i;if(this._pLookAtObject&&this._pTargetObject){this._pControllerDirty=!0,i=this._pLookAtObject.transform.matrix3D.deltaTransformVector(this.positionOffset),this._desiredPosition.x=this._pLookAtObject.x+i.x,this._desiredPosition.y=this._pLookAtObject.y+i.y,this._desiredPosition.z=this._pLookAtObject.z+i.z,this._stretch=this._pTargetObject.transform.position.add(this._desiredPosition),this._stretch.scaleBy(-this.stiffness),this._dv.copyFrom(this._velocity),this._dv.scaleBy(this.damping),this._force.x=this._stretch.x-this._dv.x,this._force.y=this._stretch.y-this._dv.y,this._force.z=this._stretch.z-this._dv.z,this._acceleration.copyFrom(this._force),this._acceleration.scaleBy(1/this.mass),this._velocity.incrementBy(this._acceleration);var n=this._pTargetObject.transform.position.add(this._velocity);this._pTargetObject.transform.moveTo(n.x,n.y,n.z),t.prototype.update.call(this)}}}(Qa),function(t){function e(e,i,n){void 0===n&&(n=!1);var r=t.call(this)||this;return r.preserveDimensions=!1,r._onInvalidateTextureDelegate=function(t){return r._onInvalidateTexture(t)},r.material=e,r._updateDimensions(),r._sampler&&(r._sampler.smooth=n),r}return i(e,t),e.getNewBillboard=function(t,i,n){if(void 0===i&&(i="auto"),void 0===n&&(n=!1),e._billboards.length){var r=e._billboards.pop();return r.material=t,r}return new e(t,i,n)},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"billboardRect",{get:function(){return this._billboardRect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"billboardHeight",{get:function(){return this._billboardHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"billboardWidth",{get:function(){return this._billboardWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){t!=this._material&&(this._material&&this._material.removeEventListener(Jn.INVALIDATE_TEXTURES,this._onInvalidateTextureDelegate),this._material=t,this._material&&this._material.addEventListener(Jn.INVALIDATE_TEXTURES,this._onInvalidateTextureDelegate),this._updateDimensions(),this._invalidateMaterial())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sampler",{get:function(){return this._sampler},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width!=t&&(this._width=t,this.scaleX=this._width/this._billboardRect.width)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height!=t&&(this._height=t,this.scaleY=this._height/this._billboardRect.height)},enumerable:!0,configurable:!0}),e.prototype.advanceFrame=function(){},e.prototype.isEntity=function(){return!0},e.prototype.dispose=function(){this.disposeValues(),e._billboards.push(this)},e.prototype.clone=function(){var t=e.getNewBillboard(this._material);return this.copyTo(t),t},e.prototype._acceptTraverser=function(t){t.applyTraversable(this)},e.prototype._updateDimensions=function(){var t,e,i,n,r=this.material.getTextureAt(0),o=r?(null===(t=this._style)||void 0===t?void 0:t.getImageAt(r))||(null===(e=this.material.style)||void 0===e?void 0:e.getImageAt(r))||r.getImageAt(0):null;o?(this._sampler=(null===(i=this._style)||void 0===i?void 0:i.getSamplerAt(r))||(null===(n=this.material.style)||void 0===n?void 0:n.getSamplerAt(r))||r.getSamplerAt(0)||on.getDefaultSampler(),this._sampler.imageRect?(this._billboardWidth=this._sampler.imageRect.width*o.width,this._billboardHeight=this._sampler.imageRect.height*o.height):(this._billboardWidth=o.rect.width,this._billboardHeight=o.rect.height),this._billboardRect=this._sampler.frameRect||new Y(0,0,this._billboardWidth,this._billboardHeight)):(this._billboardWidth=1,this._billboardHeight=1,this._billboardRect=new Y(0,0,1,1)),this.invalidate(),this.invalidateElements(),this.preserveDimensions?(this.scaleX=this._width/this._billboardRect.width,this.scaleY=this._height/this._billboardRect.height):(this._width=this._billboardRect.width*this.scaleX,this._height=this._billboardRect.height*this.scaleY)},e.prototype._onInvalidateProperties=function(e){void 0===e&&(e=null),t.prototype._onInvalidateProperties.call(this,e),this._updateDimensions()},e.prototype._onInvalidateTexture=function(t){this._updateDimensions()},e._billboards=new Array,e.assetType="[asset Billboard]",e}(Fa)),Ha=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getStageElements=function(){var t=this._asset.billboardWidth,i=this._asset.billboardHeight,n=this._asset.billboardRect,r=t.toString()+i.toString()+n.toString();this._id=r;var o=e._samplerElements[r];return o?o.setPositions([-n.x,i-n.y,0,t-n.x,i-n.y,0,t-n.x,-n.y,0,-n.x,-n.y,0]):((o=e._samplerElements[r]=new Us(new Pn(11,4))).autoDeriveNormals=!1,o.autoDeriveTangents=!1,o.setIndices([0,1,2,0,2,3]),o.setPositions([-n.x,i-n.y,0,t-n.x,i-n.y,0,t-n.x,-n.y,0,-n.x,-n.y,0]),o.setNormals([1,0,0,1,0,0,1,0,0,1,0,0]),o.setTangents([0,0,-1,0,0,-1,0,0,-1,0,0,-1]),o.setUVs([0,1,1,1,1,0,0,0])),o.getAbstraction(this._stage)},e.prototype.executeRender=function(e,i,n,r){void 0===e&&(e=!0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this._stage.context.setCulling(zt.NONE),t.prototype.executeRender.call(this,e,i,n,r)},e.prototype._getRenderMaterial=function(){return(this._asset.material||er.getDefaultColorMaterial()).getAbstraction(this.renderGroup.getRenderElements(this.stageElements.elements))},e.prototype._getStyle=function(){return this._asset.style},e._samplerElements=new Object,e}(ir),Xa=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._billboardBoxDirty=!0,n._onInvalidateElementsDelegate=function(t){return n._onInvalidateElements(t)},n._asset.addEventListener(tr.INVALIDATE_ELEMENTS,n._onInvalidateElementsDelegate),n}return i(e,t),e.prototype._onInvalidateElements=function(t){this._billboardBoxDirty=!0},e.prototype.onClear=function(e){this._asset.removeEventListener(tr.INVALIDATE_ELEMENTS,this._onInvalidateElementsDelegate),t.prototype.onClear.call(this,e)},e.prototype.hitTestPoint=function(t,e,i){return!0},e.prototype.getBoxBounds=function(t,e,i,n){if(void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),this._billboardBoxDirty){this._billboardBoxDirty=!1;var r=this._asset.billboardRect;this._billboardBox=new B(r.x,r.y,0,r.width,r.height,0)}return(t?t.transformBox(this._billboardBox):this._billboardBox).union(n,n||i)},e.prototype.getSphereBounds=function(t,e,i,n,r){return void 0===r&&(r=null),r},e.prototype.testCollision=function(t,e){var i=-t.rayPosition.z/t.rayDirection.z,n=new P(t.rayPosition.x+i*t.rayDirection.x,t.rayPosition.y+i*t.rayDirection.y);return t.traversable=this._asset,t.rayEntryDistance=i,t.position=n,t.normal=new P(0,0,1),!0},e}(ee);nr.registerRenderable(Ha,za),te.registerPickable(Xa,za),re.registerAbstraction(se,za);var qa=function(t){function e(e,i){var n=t.call(this,e)||this;return n._camera=i,n}return i(e,t),Object.defineProperty(e.prototype,"camera",{get:function(){return this._camera},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._camera)},e.PROJECTION_CHANGED="projectionChanged",e}(a),Ya=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._projection=e||new vt,i._projection.transform=i._transform,i.z=-1e3,i}return i(e,t),e.prototype.isEntity=function(){return!0},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},set:function(t){if(this._projection!=t){if(!t)throw new Error("Projection cannot be null!");this._projection.transform=null,this._projection=t,this._projection.transform=this._transform,this.dispatchEvent(new qa(qa.PROJECTION_CHANGED,this))}},enumerable:!0,configurable:!0}),e.prototype.project=function(t,e){return void 0===e&&(e=null),this._projection.project(this._transform.inverseConcatenatedMatrix3D.transformVector(t,e),e)},e.prototype.unproject=function(t,e,i,n){return void 0===n&&(n=null),this._transform.concatenatedMatrix3D.transformVector(this._projection.unproject(t,e,i,n))},e.prototype._getDefaultBoundingVolume=function(){return It.NULL},e.assetType="[asset Camera]",e}(Fa),Ka=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.acceptTraverser=function(t){},e}(se);re.registerAbstraction(Ka,Ya);var Wa=function(t){function e(e,i,n,r){void 0===r&&(r=1);var o=t.call(this)||this;return o.material=e,o._startPosition=i,o._endPosition=n,o._halfThickness=.5*r,o}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startPosition",{get:function(){return this._startPosition},set:function(t){this._startPosition!=t&&(this._startPosition=t,this.invalidateElements())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endPosition",{get:function(){return this._endPosition},set:function(t){this._endPosition!=t&&(this._endPosition=t,this.invalidateElements())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thickness",{get:function(){return 2*this._halfThickness},set:function(t){this._halfThickness!=t&&(this._halfThickness=.5*t,this.invalidateElements())},enumerable:!0,configurable:!0}),e.prototype.isEntity=function(){return!0},e.prototype._acceptTraverser=function(t){t.applyTraversable(this)},e.assetType="[asset LineSegment]",e}(Na),Ja=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getStageElements=function(){var t=e._lineGraphics[this._asset.id]||(e._lineGraphics[this._asset.id]=new zs),i=this._asset.startPosition,n=this._asset.endPosition,r=new Float32Array(6),o=new Float32Array(1);return r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=n.x,r[4]=n.y,r[5]=n.z,o[0]=this._asset.thickness,t.setPositions(r),t.setThickness(o),t.getAbstraction(this._stage)},e.prototype._getRenderMaterial=function(){return(this._asset.material||er.getDefaultColorMaterial()).getAbstraction(this.renderGroup.getRenderElements(this.stageElements.elements))},e.prototype._getStyle=function(){return this._asset.style},e._lineGraphics=new Object,e}(ir),Za=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._lineSegmentBoxDirty=!0,n._lineSegmentSphereDirty=!0,n._onInvalidateElementsDelegate=function(t){return n._onInvalidateElements(t)},n._asset.addEventListener(tr.INVALIDATE_ELEMENTS,n._onInvalidateElementsDelegate),n}return i(e,t),e.prototype._onInvalidateElements=function(t){this._lineSegmentBoxDirty=!0,this._lineSegmentSphereDirty=!0},e.prototype.onClear=function(e){this._asset.removeEventListener(tr.INVALIDATE_ELEMENTS,this._onInvalidateElementsDelegate),t.prototype.onClear.call(this,e)},e.prototype.hitTestPoint=function(t,e,i){return!0},e.prototype.getBoxBounds=function(t,e,i,n){if(void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),this._lineSegmentBoxDirty){this._lineSegmentBoxDirty=!1;var r=this._asset.startPosition,o=this._asset.endPosition;this._lineSegmentBox=new B(Math.min(r.x,o.x),Math.min(r.y,o.y),Math.min(r.z,o.z),Math.abs(r.x-o.x),Math.abs(r.y-o.y),Math.abs(r.z-o.z))}return(t?t.transformBox(this._lineSegmentBox):this._lineSegmentBox).union(n,n||i)},e.prototype.getSphereBounds=function(t,e,i,n,r){if(void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=null),this._lineSegmentSphereDirty){this._lineSegmentSphereDirty=!1;var o=this._asset.startPosition,s=this._asset.endPosition,a=(s.x-o.x)/2,l=(s.y-o.y)/2,u=(s.z-o.z)/2;this._lineSegmentSphere=new L(o.x+a,o.y+l,o.z+u,Math.sqrt(a*a+l*l+u*u))}return(e?e.transformSphere(this._lineSegmentSphere):this._lineSegmentSphere).union(r,r||n)},e.prototype.testCollision=function(t,e){return t.traversable=null,!1},e}(ee);nr.registerRenderable(Ja,Wa),te.registerPickable(Za,Wa),re.registerAbstraction(se,Wa);var $a=function(t){function e(e,i){var n;void 0===e&&(e=!0),void 0===i&&(i=null);var r=t.call(this)||this;return r._useAssetLib=e,r._assetLibId=i,r._onLoaderStartDelegate=function(t){return r._onLoaderStart(t)},r._onLoadProgressDelegate=function(t){return r._onLoadProgress(t)},r._onLoadCompleteDelegate=function(t){return r._onLoadComplete(t)},r._onAssetCompleteDelegate=function(t){return r._onAssetComplete(t)},r._onLoaderCompleteDelegate=function(t){return r._onLoaderComplete(t)},r._onLoadErrorDelegate=function(t){return r._onLoadError(t)},r._onParseErrorDelegate=function(t){return r._onParseError(t)},r._errorDelegateSelector=((n={})[Q.LOAD_ERROR]=r._onLoadErrorDelegate,n[U.PARSE_ERROR]=r._onParseErrorDelegate,n),r}return i(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentLoader",{get:function(){return this._contentLoader},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,i){(this._contentLoader&&e==Q.LOAD_ERROR||e==U.PARSE_ERROR)&&this._contentLoader.addEventListener(e,this._errorDelegateSelector[e]),t.prototype.addEventListener.call(this,e,i)},e.prototype.removeEventListener=function(e,i){(this._contentLoader&&e==Q.LOAD_ERROR||e==U.PARSE_ERROR)&&this._contentLoader.removeEventListener(e,this._errorDelegateSelector[e]),t.prototype.removeEventListener.call(this,e,i)},e.prototype.close=function(){this._contentLoader&&(this._useAssetLib&&ct.getInstance(this._assetLibId).stopLoader(this._contentLoader),this._disposeLoader())},e.prototype.load=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),this._getLoader().load(t,e,i,n)},e.prototype.loadData=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),this._getLoader().loadData(t,"",e,i,n)},e.prototype._getLoader=function(){return this._contentLoader&&this.close(),this._contentLoader=this._useAssetLib?ct.getInstance(this._assetLibId).getLoader():new ut,this._contentLoader.addEventListener(V.LOADER_START,this._onLoaderStartDelegate),this._contentLoader.addEventListener(Q.LOAD_PROGRESS,this._onLoadProgressDelegate),this._contentLoader.addEventListener(Q.LOAD_COMPLETE,this._onLoadCompleteDelegate),this._contentLoader.addEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),this._contentLoader.addEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),this.hasEventListener(Q.LOAD_ERROR)&&this._contentLoader.addEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate),this.hasEventListener(U.PARSE_ERROR)&&this._contentLoader.addEventListener(U.PARSE_ERROR,this._onParseErrorDelegate),this._contentLoader},e.prototype._disposeLoader=function(){this._contentLoader.removeEventListener(V.LOADER_START,this._onLoaderStartDelegate),this._contentLoader.removeEventListener(Q.LOAD_PROGRESS,this._onLoadProgressDelegate),this._contentLoader.removeEventListener(Q.LOAD_COMPLETE,this._onLoadCompleteDelegate),this._contentLoader.removeEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),this._contentLoader.removeEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),this.hasEventListener(Q.LOAD_ERROR)&&this._contentLoader.removeEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate),this.hasEventListener(U.PARSE_ERROR)&&this._contentLoader.removeEventListener(U.PARSE_ERROR,this._onParseErrorDelegate),this._useAssetLib||this._contentLoader.stop(),this._contentLoader=null},e.prototype.unload=function(){},e.enableParser=function(t){ut.enableParser(t)},e.enableParsers=function(t){ut.enableParsers(t)},e.prototype._onLoaderStart=function(t){this.dispatchEvent(t)},e.prototype._onLoadProgress=function(t){this.dispatchEvent(t)},e.prototype._onLoadComplete=function(t){this.dispatchEvent(t)},e.prototype._onAssetComplete=function(t){this.dispatchEvent(t)},e.prototype._onLoadError=function(t){return!!this.hasEventListener(Q.LOAD_ERROR)&&(this.dispatchEvent(t),!0)},e.prototype._onParseError=function(t){return!!this.hasEventListener(U.PARSE_ERROR)&&(this.dispatchEvent(t),!0)},e.prototype._onLoaderComplete=function(t){this._content=t.content,this._content&&this.addChild(this._content),this.dispatchEvent(t),this._disposeLoader()},e}(Fa),tl=function(t){function e(e){return t.call(this,e)||this}return i(e,t),Object.defineProperty(e.prototype,"bubbles",{get:function(){var t=this._iAllowedToPropagate&&this._iAllowedToImmediatlyPropagate;return this._iAllowedToPropagate=!0,this._iAllowedToImmediatlyPropagate=!0,t},enumerable:!0,configurable:!0}),e.prototype.stopPropagation=function(){this._iAllowedToPropagate=!1,this._iParentEvent&&this._iParentEvent.stopPropagation()},e.prototype.stopImmediatePropagation=function(){this._iAllowedToPropagate=!1,this._iAllowedToImmediatlyPropagate=!1,this._iParentEvent&&this._iParentEvent.stopImmediatePropagation()},e.prototype.clone=function(){var t=new e(this.type);return t.screenX=this.screenX,t.screenY=this.screenY,t.view=this.view,t.entity=this.entity,t.pickerEntity=this.pickerEntity,t.traversable=this.traversable,t.material=this.material,t.uv=this.uv,t.position=this.position,t.normal=this.normal,t.elementIndex=this.elementIndex,t.delta=this.delta,t.ctrlKey=this.ctrlKey,t.shiftKey=this.shiftKey,t._iParentEvent=this,t._iAllowedToPropagate=this._iAllowedToPropagate,t},Object.defineProperty(e.prototype,"scenePosition",{get:function(){return this.entity.transform.concatenatedMatrix3D.transformVector(this.position)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sceneNormal",{get:function(){var t=this.entity.transform.concatenatedMatrix3D.deltaTransformVector(this.normal);return t.normalize(),t},enumerable:!0,configurable:!0}),e.MOUSE_OVER="mouseOver3d",e.MOUSE_OUT="mouseOut3d",e.ROLL_OVER="rollOver3d",e.ROLL_OUT="rollOut3d",e.MOUSE_UP="mouseUp3d",e.MOUSE_UP_OUTSIDE="mouseUpOutside3d",e.MOUSE_DOWN="mouseDown3d",e.MOUSE_MOVE="mouseMove3d",e.DRAG_MOVE="dragMove3d",e.DRAG_OUT="dragOut3d",e.DRAG_OVER="dragOver3d",e.DRAG_START="dragStart3d",e.DRAG_STOP="dragStop3d",e.FOCUS_IN="focusIn3d",e.FOCUS_OUT="focusOut3d",e.CLICK="click3d",e.DOUBLE_CLICK="doubleClick3d",e.MOUSE_WHEEL="mouseWheel3d",e}(a),el=function(){function t(){}return t.setInterval=function(t,e){return this._intervalID++,e<4&&(e=4),this._active_intervals[this._intervalID]={f:t,t:e,dt:0,isTimeout:!1},this._intervalID},t.setTimeOut=function(t,e){return this._intervalID++,e<4&&(e=4),this._active_intervals[this._intervalID]={f:t,t:e,dt:0,isTimeout:!0},this._intervalID},t.clearInterval=function(t){delete this._active_intervals[t]},t.clearTimeout=function(t){delete this._active_intervals[t]},t.execute_intervals=function(t){var e;for(var i in void 0===t&&(t=0),this._active_intervals)for((e=this._active_intervals[i]).dt+=t;this._active_intervals[i]&&e.dt>=e.t;)e.dt-=e.t,e.f(),e.isTimeout&&delete this._active_intervals[i]},t.add_child_to_dispose=function(t){this._queued_dispose.push(t)},t.get_queue=function(){return t._queue||(t._queue={queued_mcs:[],queued_scripts:[],queued_mcs_pass2:[],queued_scripts_pass2:[],constructors:[]}),t._queue},t.add_script_to_queue=function(e,i){var n=t.get_queue(),r=n.queued_mcs_pass2.length,o=0;for(o=0;o<r;o++)n.queued_mcs.push(n.queued_mcs_pass2[o]),n.queued_scripts.push(n.queued_scripts_pass2[o]);n.queued_mcs_pass2.length=0,n.queued_scripts_pass2.length=0,e.adapter.allowScript=!0,n.queued_mcs.push(e),n.queued_scripts.push(i)},t.add_loaded_action_to_queue=function(e){var i=t.get_queue();i.queued_mcs.push(e),i.queued_scripts.push(null)},t.add_script_to_queue_pass2=function(e,i){var n=t.get_queue();e.adapter.allowScript=!0,n.queued_mcs_pass2.push(e),n.queued_scripts_pass2.push(i)},t.execute_as3_constructors_finish_scene=function(e){for(var i=e._children,n=0;n<i.length;n++)i[n].parent&&i[n].adapter.executeConstructor&&t.execute_as3_constructors_recursiv(i[n])},t.execute_as3_constructors_enterFrame=function(e){t.invalidAS3Constructors&&(t.execute_as3_constructors_recursiv(e),t.invalidAS3Constructors=!1)},t.execute_as3_constructors_recursiv=function(e){var i=e.adapter,n=i.executeConstructor;if(n)i.executeConstructor=null,n();else for(var r=e._children,o=0;o<r.length;o++)r[o].parent&&t.execute_as3_constructors_recursiv(r[o]);e.just_added_to_timeline&&e._sessionID>=0&&i&&i.dispatchStaticEvent&&(i.dispatchStaticEvent("added",i),e.just_added_to_timeline=!1,e.hasDispatchedAddedToStage=e.isOnDisplayList(),e.hasDispatchedAddedToStage&&i.dispatchStaticEvent("addedToStage",i))},t.isOnStage=function(t){for(var e=t;e&&!e.isAVMScene;)e=e.parent;return!(!e||!e.isAVMScene)},t.execute_avm1_constructors=function(){var e=t.get_queue();if(0!=e.queued_mcs.length||0!=e.queued_mcs_pass2.length){for(var i=e.queued_mcs_pass2.length;i>0;)i--,e.queued_mcs.push(e.queued_mcs_pass2[i]),e.queued_scripts.push(e.queued_scripts_pass2[i]);e.queued_mcs_pass2.length=0,e.queued_scripts_pass2.length=0;var n,r=e.queued_mcs;if(t.useAVM1){for(i=r.length;i>0;)if(n=r[--i],t.isOnStage(n)&&n.onInitialize){var o=n.onInitialize;n.onInitialize=null,o()}for(i=0;i<r.length;i++)if(n=r[i],t.isOnStage(n)){if(n.onConstruct){o=n.onConstruct;n.onConstruct=null,o()}var s=n.adapter.executeConstructor;s&&(n.adapter.executeConstructor=null,s())}}}},t.execute_queue=function(){var e=t.get_queue();if(0!=e.queued_mcs.length||0!=e.queued_mcs_pass2.length){var i=e.queued_mcs.concat(),n=e.queued_scripts.concat();e.queued_mcs.length=0,e.queued_scripts.length=0;var r,o=e.queued_mcs_pass2.length,s=0;for(s=0;s<o;s++)i.push(e.queued_mcs_pass2[s]),n.push(e.queued_scripts_pass2[s]);if(e.queued_mcs_pass2.length=0,e.queued_scripts_pass2.length=0,t.useAVM1){for(s=0;s<i.length;s++)if(r=i[s],t.isOnStage(r)&&r.onInitialize){var a=r.onInitialize;r.onInitialize=null,a()}for(s=0;s<i.length;s++)if(r=i[s],t.isOnStage(r)){if(r.onConstruct){a=r.onConstruct;r.onConstruct=null,a()}var l=r.adapter.executeConstructor;l&&(r.adapter.executeConstructor=null,l())}}for(s=0;s<i.length;s++){if(r=i[s],t.useAVM1){if(!t.isOnStage(r))continue;if(r.onLoaded){a=r.onLoaded;r.onLoaded=null,a()}if(!r.adapter.hasOnLoadExecuted){r.adapter.hasOnLoadExecuted=!0;var u=r.adapter.alGet("onLoad");u&&u.alCall(r.adapter)}}null!=n[s]&&((r=i[s])&&r.adapter&&!r.adapter.constructorHasRun?(e.queued_mcs.push(r),e.queued_scripts.push(n[s])):r&&r.adapter&&r.adapter.executeScript&&r.adapter.executeScript(n[s]))}}},t.execute_dispose=function(){for(var t=this._queued_dispose.length,e=0;e<t;e++)this._queued_dispose[e].dispose();this._queued_dispose.length=0},t.invalidAS3Constructors=!1,t.frameScriptDebug=void 0,t.useAVM1=!1,t._queued_dispose=[],t._active_intervals=new Object,t._intervalID=0,t}(),il=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.symbolID=0,i.preventScript=!1,i._buttonMode=!1,i._isButton=!1,i._time=0,i._currentFrameIndex=-1,i._isPlaying=!0,i._isInit=!0,i._sessionID_childs={},i._sounds={},i._skipFramesForStream=0,i.buttonEnabled=!0,i.loop=!0,i.constructedKeyFrameIndex=-1,i._soundVolume=1,i._parentSoundVolume=1,i.doingSwap=!1,i._isButton=!1,i._buttonMode=!1,i._useHandCursor=!0,i.cursorType="pointer",i.inheritColorTransform=!0,i._onMouseOver=function(t){i.buttonEnabled?i.currentFrameIndex=1:i.currentFrameIndex=0},i._onMouseOut=function(t){i.currentFrameIndex=0},i._onMouseDown=function(t){i.buttonEnabled?i.currentFrameIndex=2:i.currentFrameIndex=0},i._onMouseUp=function(t){i.currentFrameIndex=0==i.currentFrameIndex?0:1},i._onDragOver=function(t){i.buttonEnabled?i.currentFrameIndex=2:i.currentFrameIndex=0},i._onDragOut=function(t){i.currentFrameIndex=1},i._timeline=e||new ja,i}return i(e,t),e.getNewMovieClip=function(t){if(void 0===t&&(t=null),e._movieClips.length){var i=e._movieClips.pop();return i.timeline=t||new ja,i.graphics=Sa.getGraphics(),i}return new e(t)},e.clearPool=function(){e._movieClips=[]},e.prototype.initSoundStream=function(t,i){this._soundStreams||(this._soundStreams=new e.movieClipSoundsManagerClass(this)),this._soundStreams.initSoundStream(t,i)},e.prototype.addSoundStreamBlock=function(t,i){this._soundStreams||(this._soundStreams=new e.movieClipSoundsManagerClass(this)),this._soundStreams.addSoundStreamBlock(t,i)},e.prototype.stopCurrentStream=function(t){if(this._soundStreams)return this._soundStreams.stopStream(t)},e.prototype.resetStreamStopped=function(){this._soundStreams&&this._soundStreams.resetStreamStopped()},e.prototype._syncSounds=function(t){return this._soundStreams?this._soundStreams.syncSounds(t,this._isPlaying,this.parent):0},e.prototype.startSound=function(t,i,n){this._sounds[t]&&this._sounds[t].stop(),i.loopsToPlay=n,i.play(0,!1),this._sounds[t]=i,e._activeSounds[t]||(e._activeSounds[t]=[]),e._activeSounds[t].push(i)},e.prototype.stopSounds=function(t){if(void 0===t&&(t=null),t)this._sounds[t]&&(this._sounds[t].stop(),delete this._sounds[t]);else{for(var i in this._sounds)this._sounds[i].stop();this._sounds={}}for(var n,r=this._children.length,o=0;o<r;++o)(n=this._children[o]).isAsset(e)&&n.stopSounds(t);this.stopCurrentStream(this._currentFrameIndex),e._activeSounds={},this._soundStreams&&this._soundStreams.syncSounds(0,!1,this.parent)},Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this._isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"soundVolume",{get:function(){return this._soundVolume},set:function(t){if(this._soundVolume!=t){for(var i in this._soundVolume=t,this._sounds)this._sounds[i].volume=t;for(var n,r=this._children.length,o=0;o<r;++o)(n=this._children[o]).isAsset(e)&&(n.soundVolume=t)}},enumerable:!0,configurable:!0}),e.prototype.stopSound=function(t){if(this._sounds[t]&&(this._sounds[t].stop(),delete this._sounds[t]),e._activeSounds[t]){for(var i=0;i<e._activeSounds[t].length;i++)e._activeSounds[t][i].stop();delete e._activeSounds[t]}},e.prototype.buttonReset=function(){this._isButton&&!this.buttonEnabled&&(this.currentFrameIndex=0)},e.prototype.getMouseCursor=function(){return"scene"==this.name?"initial":this._useHandCursor&&this.buttonMode?this.cursorType:"initial"},e.prototype.queueFrameScripts=function(t,e,i){console.warn("[MovieClip] - queueFrameScripts should only be called on AVM-Adapters")},e.prototype.registerScriptObject=function(t){this[t.name]=t,t.isAsset(e)&&t.removeButtonListeners()},e.prototype.unregisterScriptObject=function(t){delete this[t.name],t.isAsset(e)&&t.removeButtonListeners()},e.prototype.dispose=function(){this.disposeValues(),e._movieClips.push(this)},e.prototype.disposeValues=function(){t.prototype.disposeValues.call(this),this._sessionID_childs={},this._timeline=null},Object.defineProperty(e.prototype,"useHandCursor",{get:function(){return this._useHandCursor},set:function(t){this._useHandCursor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonMode",{get:function(){return this._buttonMode},set:function(t){this._buttonMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isButton",{get:function(){return this._isButton},set:function(t){this._isButton=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInit",{get:function(){return this._isInit},set:function(t){this._isInit=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeline",{get:function(){return this._timeline},set:function(t){this._timeline!=t&&(this._timeline=t,this.reset(!1,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFrames",{get:function(){return this._timeline.numFrames},enumerable:!0,configurable:!0}),e.prototype.jumpToLabel=function(t,e){void 0===e&&(e=0),this._timeline.jumpToLabel(this,t,e)},e.prototype.reset=function(e,i){void 0===e&&(e=!0),void 0===i&&(i=!0),i&&t.prototype.reset.call(this),4115==this.id&&console.warn("reset",this.id),this.resetStreamStopped(),this._time=0,i&&this._adapter&&this.adapter.freeFromScript(),this.constructedKeyFrameIndex=-1;for(var n=this.numChildren-1;n>=0;n--)this.removeChildAt(n);if(this.graphics.clear(),e){var r=this._timeline.keyframe_indices.length;this._isPlaying=Boolean(r>1),r?(this._currentFrameIndex=0,this._timeline.constructNextFrame(this,e&&!this.doingSwap&&!this.preventScript,!0)):this._currentFrameIndex=-1}this._skipAdvance=!0},Object.defineProperty(e.prototype,"currentFrameIndex",{get:function(){return this._currentFrameIndex},set:function(t){var e=!0,i=this._timeline.keyframe_indices.length;this.resetStreamStopped(),i&&(t<0?t=0:t>=i&&(t=i-1,e=!1),this._skipAdvance=!1,this._currentFrameIndex!=t&&(this._currentFrameIndex=t,this._timeline.gotoFrame(this,t,e,!1,!0)))},enumerable:!0,configurable:!0}),e.prototype.addButtonListeners=function(){this._isButton=!0,this.stop(),this.addEventListener(tl.MOUSE_OVER,this._onMouseOver),this.addEventListener(tl.MOUSE_OUT,this._onMouseOut),this.addEventListener(tl.MOUSE_DOWN,this._onMouseDown),this.addEventListener(tl.MOUSE_UP,this._onMouseUp),this.addEventListener(tl.DRAG_OVER,this._onDragOver),this.addEventListener(tl.DRAG_OUT,this._onDragOut),this.mouseChildren=!1},e.prototype.removeButtonListeners=function(){this.removeEventListener(tl.MOUSE_OVER,this._onMouseOver),this.removeEventListener(tl.MOUSE_OUT,this._onMouseOut),this.removeEventListener(tl.MOUSE_DOWN,this._onMouseDown),this.removeEventListener(tl.MOUSE_UP,this._onMouseUp),this.removeEventListener(tl.DRAG_OVER,this._onDragOver),this.removeEventListener(tl.DRAG_OUT,this._onDragOut)},e.prototype.swapChildrenAt=function(t,e){console.warn("[scene/MovieClip] - swapChildrenAt - not implemented")},e.prototype.swapDepths=function(t,e){console.warn("[scene/MovieClip] - swapDepths - not implemented")},e.prototype.getTimelineChildAtSessionID=function(t){return this._sessionID_childs[t]},e.prototype.constructFrame=function(t,e,i,n,r,o,s){console.warn("[scene/MovieClip] - constructFrame not implemented")},e.prototype.addTimelineChildAtDepth=function(t,e,i){return console.warn("[scene/MovieClip] - addTimelineChildAtDepth not implemented"),null},e.prototype.removeTimelineChildAtDepth=function(t){console.warn("[scene/MovieClip] - removeTimelineChildAtDepth not implemented")},e.prototype.removeChildAtInternal=function(e){var i=this._children[e];return i._adapter&&i.adapter.freeFromScript(),this.adapter.unregisterScriptObject(i),delete this._sessionID_childs[i._sessionID],i._sessionID=-1,i.adapter&&i.adapter.dispatchStaticEvent&&i.adapter.dispatchStaticEvent("removed",i.adapter),this.isOnDisplayList()&&i.adapter.dispatch_REMOVED_FROM_STAGE&&i.adapter.dispatch_REMOVED_FROM_STAGE(i),t.prototype.removeChildAtInternal.call(this,e)},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.play=function(){this._timeline.keyframe_indices.length>1&&(this._isPlaying=!0)},e.prototype.stop=function(){this.resetStreamStopped(),this._isPlaying=!1},e.prototype.clone=function(){var t=e.getNewMovieClip(this._timeline);return this.copyTo(t),t},e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e),e.loop=this.loop,e._soundStreams=this._soundStreams,e.symbolID=this.symbolID},e.prototype.advanceFrameInternal=function(){this._timeline&&this._timeline.numFrames>0&&this._isPlaying&&!this._skipAdvance&&(this._currentFrameIndex==this._timeline.keyframe_indices.length-1?this.loop?0==this._currentFrameIndex||(this._currentFrameIndex=0,this.resetStreamStopped(),this._timeline.gotoFrame(this,0,!0,!0,!0)):this._isPlaying=!1:(this._currentFrameIndex++,this._timeline.constructNextFrame(this))),t.prototype.advanceFrame.call(this),this._skipAdvance=!1},e.prototype.advanceFrame=function(){for(0==this._skipFramesForStream&&this.advanceFrameInternal(),this._skipFramesForStream=this._syncSounds(this._currentFrameIndex);this._skipFramesForStream>0;)el.execute_queue(),this.advanceFrameInternal(),this._skipFramesForStream=this._syncSounds(this._currentFrameIndex)},e.prototype.logHierarchy=function(t){void 0===t&&(t=0),this.printHierarchyName(t,this);for(var i,n=this._children.length,r=0;r<n;r++)(i=this._children[r]).isAsset(e)?i.logHierarchy(t+1):this.printHierarchyName(t+1,i)},e.prototype.printHierarchyName=function(t,e){for(var i="",n=0;n<t;++n)i+="--";i+=" "+e.name+" = "+e.id,console.log(i)},e.prototype.clear=function(){this.resetStreamStopped(),t.prototype.clear.call(this)},e.avm1ScriptQueue=[],e.avm1ScriptQueueScripts=[],e.avm1LoadedActions=[],e.movieClipSoundsManagerClass=null,e._movieClips=new Array,e._activeSounds={},e.assetType="[asset MovieClip]",e}(ka);re.registerAbstraction(se,il);!function(t){function e(e,i,n,r){return t.call(this)||this}i(e,t),Object.defineProperty(e.prototype,"downState",{get:function(){return this._downState},set:function(t){this._downState=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this.enabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitTestState",{get:function(){return this._hitTestState},set:function(t){this._hitTestState=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overState",{get:function(){return this._overState},set:function(t){this._overState=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"soundTransform",{get:function(){return console.log("soundTransform not implemented yet in flash/SimpleButton"),null},set:function(t){console.log("soundTransform not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trackAsMenu",{get:function(){return console.log("trackAsMenu not implemented yet in flash/SimpleButton"),!1},set:function(t){console.log("trackAsMenu not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"upState",{get:function(){return this._upState},set:function(t){this._upState=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useHandCursor",{get:function(){return console.log("useHandCursor not implemented yet in flash/SimpleButton"),!1},set:function(t){console.log("useHandCursor not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0})}(ka);var nl=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.clone=function(){return new e(this.type)},e.CASTS_SHADOW_CHANGE="castsShadowChange",e}(a),rl=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.clone=function(){return new e(this.type)},e.TEXTURE_CHANGE="textureChange",e}(a),ol=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.SHADER_INVALIDATED="shaderInvalidated",e}(a),sl=function(t){function e(){var e=t.call(this)||this;return e._numImages=0,e._images=new Array,e._samplers=new Array,e}return i(e,t),Object.defineProperty(e.prototype,"mappingMode",{get:function(){return this._mappingMode},set:function(t){this._mappingMode!=t&&(this._mappingMode=t)},enumerable:!0,configurable:!0}),e.prototype.getNumImages=function(){return this._numImages},e.prototype.setNumImages=function(t){this._numImages!=t&&(this._numImages=t,this._images.length=t,this._samplers.length=t,this.invalidate())},e.prototype.getImageAt=function(t){return this._images[t]},e.prototype.setImageAt=function(t,e){this._images[e]=t,this.invalidate()},e.prototype.getSamplerAt=function(t){return this._samplers[t]},e.prototype.setSamplerAt=function(t,e){this._samplers[e]=t,this.invalidate()},e.prototype.invalidateShaderProgram=function(){this.invalidate(),this.dispatchEvent(new ol(ol.SHADER_INVALIDATED))},e}(p),al=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._mappingMode=e||jn.LINEAR,i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[texture Texture2D]",e}(sl),ll=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[texture TextureCube]",e}(sl),ul=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.setNumImages(1),i.image=e,i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sampler",{get:function(){return this._samplers[0]},set:function(t){this._samplers[0]!=t&&this.setSamplerAt(t,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"image",{get:function(){return this._images[0]},set:function(t){this._images[0]!=t&&this.setImageAt(t,0)},enumerable:!0,configurable:!0}),e.assetType="[texture ImageTextureCube]",e}(ll),cl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getFragmentCode=function(t,e,i,n){this._imageIndex=this._shader.renderMaterial.getImageIndex(this._texture,0);var r=this.getTextureReg(this._imageIndex,e,i);return this._textureIndex=r.index,"tex "+t+", "+n+", "+r+" <"+this._shader.renderMaterial.images[this._imageIndex].getType()+",linear,miplinear,wrap>\n"},e.prototype.activate=function(){var t=this._shader.renderMaterial.samplers[this._imageIndex];this._shader.renderMaterial.images[this._imageIndex].activate(this._textureIndex,t)},e.prototype._setRenderState=function(t){var e=t.samplers[this._imageIndex],i=t.images[this._imageIndex];i&&e&&i.activate(this._textureIndex,e)},e}(sr);Kn.registerAbstraction(cl,ul);var hl=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this,i)||this;return n.setNumImages(1),n.image=e,n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sampler",{get:function(){return this._samplers[0]},set:function(t){this._samplers[0]!=t&&this.setSamplerAt(t,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"image",{get:function(){return this._images[0]},set:function(t){if(this._images[0]!=t){if(!on.isImage2DValid(t))throw new o("Invalid imageData: Width and height must be power of 2 and cannot exceed 2048");this.setImageAt(t,0)}},enumerable:!0,configurable:!0}),e.assetType="[texture ImageTexture2D]",e}(al),pl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getFragmentCode=function(e,i,n,r){var o,s="";if(this._texture.mappingMode==jn.RADIAL&&(s+="mul "+(o=i.getFreeFragmentVectorTemp())+".xy, "+r+", "+r+"\n",s+="add "+o+".x, "+o+".x, "+o+".y\n",s+="sub "+o+".y, "+o+".y, "+o+".y\n",s+="sqt "+o+".x, "+o+".x, "+o+".x\n",r=o),this._shader.useImageRect){var a=i.getFreeFragmentConstant();this._samplerIndex=4*a.index,s+="mul "+(o=i.getFreeFragmentVectorTemp())+", "+r+", "+a+".xy\n",s+="add "+o+", "+o+", "+a+".zw\n",r=o}return s+=t.prototype._getFragmentCode.call(this,e,i,n,r),this._shader.usesPremultipliedAlpha&&(s+="div "+e+".xyz, "+e+", "+e+".w\n"),s},e.prototype.activate=function(){t.prototype.activate.call(this);var e=this._shader.renderMaterial.samplers[this._imageIndex];if(this._shader.useImageRect){var i=this._samplerIndex,n=this._shader.fragmentConstantData;e.imageRect?(n[i]=e.imageRect.width,n[i+1]=e.imageRect.height,n[i+2]=e.imageRect.x,n[i+3]=e.imageRect.y):(n[i]=1,n[i+1]=1,n[i+2]=0,n[i+3]=0)}},e.prototype._setRenderState=function(e){t.prototype._setRenderState.call(this,e);var i=e.samplers[this._imageIndex];if(this._shader.useImageRect&&i){var n=this._samplerIndex,r=this._shader.fragmentConstantData;i.imageRect?(r[n]=i.imageRect.width,r[n+1]=i.imageRect.height,r[n+2]=i.imageRect.x,r[n+3]=i.imageRect.y):(r[n]=1,r[n+1]=1,r[n+2]=0,r[n+3]=0)}},e}(cl);Kn.registerAbstraction(pl,hl);var dl=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[texture DepthTextureCube]",e}(ul),fl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._initVO=function(t){this._decodeReg=null,this._decodeIndex=-1},e.prototype._initConstants=function(){var t=this._shader.fragmentConstantData,e=this._decodeIndex;t[e]=1,t[e+1]=1/255,t[e+2]=1/65025,t[e+3]=1/16581375},e.prototype._getFragmentCode=function(e,i,n,r){-1==this._decodeIndex&&(this._decodeIndex=4*(this._decodeReg=i.getFreeFragmentConstant()).index);var o=i.getFreeFragmentVectorTemp();return t.prototype._getFragmentCode.call(this,o,i,n,r)+"dp4 "+e+".w, "+o+", "+this._decodeReg+"\n"},e}(cl);Kn.registerAbstraction(fl,dl);var _l=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[texture ShadowTexture2D]",e}(hl),ml=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getFragmentCode=function(e,i,n,r){return t.prototype._getFragmentCode.call(this,e,i,n,r)+"slt "+e+".w, "+r+".z, "+e+".w\n"},e}(fl);Kn.registerAbstraction(ml,_l);var gl=function(t){function e(){var e=t.call(this)||this;return e._textures=new Array,e._owners=new Array,e._counts=new Array,e}return i(e,t),e.prototype.dispose=function(){},e.prototype.iAddOwner=function(t){var e=this._owners.indexOf(t);if(-1!=e)this._counts[e]++;else{this._owners.push(t),this._counts.push(1);for(var i=this._textures.length,n=0;n<i;n++)t.addTexture(this._textures[n])}},e.prototype.iRemoveOwner=function(t){var e=this._owners.indexOf(t);if(1!=this._counts[e])this._counts[e]--;else{this._owners.splice(e,1),this._counts.splice(e,1);for(var i=this._textures.length,n=0;n<i;n++)t.removeTexture(this._textures[n])}},e.prototype.iAddTexture=function(t){this._textures.push(t);for(var e=this._owners.length,i=0;i<e;i++)this._owners[i].addTexture(t)},e.prototype.iRemoveTexture=function(t){this._textures.splice(this._textures.indexOf(t),1);for(var e=this._owners.length,i=0;i<e;i++)this._owners[i].removeTexture(t)},e.prototype.invalidateShaderProgram=function(){this.invalidate(),this.dispatchEvent(new ol(ol.SHADER_INVALIDATED))},e.prototype.copyFrom=function(t){},e}(p),yl=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.chunkVO=new pr,n}return i(e,t),e.prototype._isUsed=function(){return!0},e.prototype._usesTangentSpace=function(){return!0},e.prototype._initVO=function(t){},e.prototype._initConstants=function(){},e.prototype._reset=function(t){this._invalid=!0,t.useChunk=!1,t.needsProjection=!1,t.needsView=!1,t.needsNormals=!1,t.needsTangents=!1,t.needsGlobalVertexPos=!1,t.needsGlobalFragmentPos=!1,this._cleanCompilationData()},e.prototype._cleanCompilationData=function(){},e.prototype._getVertexCode=function(t,e){return""},e.prototype._getFragmentCode=function(t,e,i){return""},e.prototype._activate=function(){},e.prototype._setRenderState=function(t){},e.prototype._deactivate=function(){this._invalid=!1},e}(K),Al=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._epsilon=.02,e._alpha=1,e.autoUpdate=!0,e}return i(e,t),Object.defineProperty(e.prototype,"textureMap",{get:function(){return this._textureMap},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"light",{get:function(){return this._light},set:function(t){this._light!=t&&(this._light=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"epsilon",{get:function(){return this._epsilon},set:function(t){this._epsilon=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size!=t&&(this._size=t,this._updateSize())},enumerable:!0,configurable:!0}),e.prototype.update=function(t,e){this._updateProjection(e.view.projection),this._renderMap(t,e)},e.prototype._updateProjection=function(t){throw new s},e.prototype._renderMap=function(t,e){throw new s},e.prototype._updateSize=function(){throw new s},e.prototype.dispose=function(){this._light=null},e}(gl),vl=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.autoUpdate=!0,n._mapper=e,n._shader=i,n._shader.renderMaterial.renderGroup._addMapper(n._mapper),n}return i(e,t),e.prototype._cleanCompilationData=function(){t.prototype._cleanCompilationData.call(this),this._depthMapCoordReg=null},Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthMapCoordReg",{get:function(){return this._depthMapCoordReg},enumerable:!0,configurable:!0}),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._shader.renderMaterial.renderGroup._removeMapper(this._mapper)},e.prototype._initVO=function(t){this._texture=this._mapper.textureMap.getAbstraction(this._shader),this._texture._initVO(t)},e.prototype._initConstants=function(){this._texture._initConstants()},e.prototype._getFragmentCode=function(t,e,i){var n=e.getFreeFragmentConstant();return this._fragmentAlphaIndex=4*n.index,"add "+t+".w, "+t+".w, "+n+".x\nsat "+t+".w, "+t+".w\n"},e.prototype._activate=function(){this._shader.fragmentConstantData[this._fragmentAlphaIndex]=1-this._mapper.alpha,this._texture.activate()},e.prototype._setRenderState=function(t){this._texture._setRenderState(t)},e}(yl),bl=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._lightOffset=1e4,i._snap=64,i._size=2048,i._image2D=e||new sn(i._size,i._size),i._textureMap=new _l(i._image2D),i.iAddTexture(i._textureMap),i._cullPlanes=[],i._overallDepthProjection=new At,i._overallDepthProjection.transform=new N,i._localFrustum=[],i._matrix=new R,i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){t.prototype.dispose.call(this),this._textureMap.image=null,this._textureMap=null,this._image2D=null},Object.defineProperty(e.prototype,"snap",{get:function(){return this._snap},set:function(t){this._snap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightOffset",{get:function(){return this._lightOffset},set:function(t){this._lightOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthProjection",{get:function(){return this._overallDepthProjection.viewMatrix3D},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this._maxZ-this._minZ},enumerable:!0,configurable:!0}),e.prototype._updateSize=function(){this._image2D._setSize(this._size,this._size)},e.prototype._updateProjection=function(t){this._updateProjectionFromFrustumCorners(t,t.viewFrustumCorners,this._matrix),this._overallDepthProjection.frustumMatrix3D=this._matrix,this._updateCullPlanes(t)},e.prototype._renderMap=function(t,e){var i=e.depthRenderGroup.getRenderer(t);i.cullPlanes=this._cullPlanes,i.view.preservePixelRatio=!1,i.view.target=this._image2D,i.view.projection=this._overallDepthProjection,i.render()},e.prototype._updateCullPlanes=function(t){var e=this._overallDepthProjection.viewFrustumPlanes,i=t.viewFrustumPlanes;this._cullPlanes.length=4,this._cullPlanes[0]=e[0],this._cullPlanes[1]=e[1],this._cullPlanes[2]=e[2],this._cullPlanes[3]=e[3];for(var n=this._light.sceneDirection,r=n.x,o=n.y,s=n.z,a=4,l=0;l<6;++l){var u=i[l];u.a*r+u.b*o+u.c*s<0&&(this._cullPlanes[a++]=u)}},e.prototype._updateProjectionFromFrustumCorners=function(t,e,i){var n,r,o,s,a,l,u,c,h=t.transform.concatenatedMatrix3D.position,p=this._light.sceneDirection;for(this._overallDepthProjection.transform.matrix3D=this._light.transform.concatenatedMatrix3D,n=Math.floor((h.x-p.x*this._lightOffset)/this._snap)*this._snap,r=Math.floor((h.y-p.y*this._lightOffset)/this._snap)*this._snap,o=Math.floor((h.z-p.z*this._lightOffset)/this._snap)*this._snap,this._overallDepthProjection.transform.moveTo(n,r,o),this._overallDepthProjection.transform.inverseConcatenatedMatrix3D.transformVectors(e,this._localFrustum),s=l=this._localFrustum[0],a=u=this._localFrustum[1],this._maxZ=this._localFrustum[2],c=3;c<24;)(n=this._localFrustum[c])<s&&(s=n),n>l&&(l=n),(r=this._localFrustum[c+1])<a&&(a=r),r>u&&(u=r),(o=this._localFrustum[c+2])>this._maxZ&&(this._maxZ=o),c+=3;this._minZ=1;var d=l-s,f=u-a,_=1/(this._maxZ-this._minZ);s<0&&(s-=this._snap),a<0&&(a-=this._snap),s=Math.floor(s/this._snap)*this._snap,a=Math.floor(a/this._snap)*this._snap;var m=2*this._snap;l=s+(d=Math.floor(d/m+2)*m),u=a+(f=Math.floor(f/m+2)*m),d=1/d,f=1/f;var g=i._rawData;g[0]=2*d,g[5]=2*f,g[10]=_,g[12]=-(l+s)*d,g[13]=-(u+a)*f,g[14]=-this._minZ*_,g[15]=1,g[1]=g[2]=g[3]=g[4]=g[6]=g[7]=g[8]=g[9]=g[11]=0,i.invalidatePosition()},e.assetType="[asset DirectionalShadowMapper]",e}(Al),xl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._initVO=function(e){t.prototype._initVO.call(this,e),e.needsView=!0,e.needsGlobalVertexPos=!0},e.prototype._initConstants=function(){t.prototype._initConstants.call(this);var e=this._shader.vertexConstantData,i=this._vertexScalingIndex;e[i]=.5,e[i+1]=.5,e[i+2]=0,e[i+3]=1,this._depthProjectionMatrix=new R(new Float32Array(this._shader.vertexConstantData.buffer,4*(i+4),16))},e.prototype._getVertexCode=function(t,e){var i="",n=t.getFreeVertexVectorTemp(),r=t.getFreeVertexConstant();this._vertexScalingIndex=4*r.index;var o=t.getFreeVertexConstant();return t.getFreeVertexConstant(),t.getFreeVertexConstant(),t.getFreeVertexConstant(),this._depthMapCoordReg=t.getFreeVarying(),i+="m44 "+n+", "+e.globalPositionVertex+", "+o+"\ndiv "+n+", "+n+", "+n+".w\nmul "+n+".xy, "+n+".xy, "+r+".xy\nadd "+this._depthMapCoordReg+", "+n+", "+r+".xxwz\n"},e.prototype._activate=function(){t.prototype._activate.call(this);var e=this._shader.vertexConstantData;this._vertexScalingIndex;e[this._vertexScalingIndex+3]=-1/(this._mapper.depth*this._mapper.epsilon),this._depthProjectionMatrix.copyFrom(this._mapper.depthProjection,!0)},e}(vl);Kn.registerAbstraction(xl,bl);var Cl=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._color=16777215,i._colorR=1,i._colorG=1,i._colorB=1,i._ambientColor=16777215,i._ambient=0,i._specular=1,i._diffuse=1,i._shadowsEnabled=!1,i._ambientR=0,i._ambientG=0,i._ambientB=0,i._specularR=1,i._specularG=1,i._specularB=1,i._diffuseR=1,i._diffuseG=1,i._diffuseB=1,i._onInvalidateConcatenatedMatrix3DDelegate=function(t){return i._onInvalidateConcatenatedMatrix3D(t)},i.transform=e||new N,i}return i(e,t),Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform},set:function(t){this._transform!=t&&(this._transform&&this._transform.removeEventListener(E.INVALIDATE_CONCATENATED_MATRIX3D,this._onInvalidateConcatenatedMatrix3DDelegate),this._transform=t,this._transform&&this._transform.addEventListener(E.INVALIDATE_CONCATENATED_MATRIX3D,this._onInvalidateConcatenatedMatrix3DDelegate))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsEnabled",{get:function(){return this._shadowsEnabled},set:function(t){this._shadowsEnabled!=t&&(this._shadowsEnabled=t,t&&null==this._shadowMapper?(this._shadowMapper=this._createShadowMapper(),this._shadowMapper.light=this):t||(this._shadowMapper.dispose(),this._shadowMapper=null),this.dispatchEvent(new nl(nl.CASTS_SHADOW_CHANGE)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specular",{get:function(){return this._specular},set:function(t){t<0&&(t=0),this._specular=t,this._updateSpecular()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diffuse",{get:function(){return this._diffuse},set:function(t){t<0&&(t=0),this._diffuse=t,this._updateDiffuse()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t,this._colorR=(this._color>>16&255)/255,this._colorG=(this._color>>8&255)/255,this._colorB=(255&this._color)/255,this._updateDiffuse(),this._updateSpecular()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ambient",{get:function(){return this._ambient},set:function(t){t<0?t=0:t>1&&(t=1),this._ambient=t,this._updateAmbient()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this._ambientColor},set:function(t){this._ambientColor!=t&&(this._ambientColor=t,this._updateAmbient())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowMapper",{get:function(){return this.shadowsEnabled=!0,this._shadowMapper},set:function(t){this._shadowMapper!=t&&(this._shadowMapper=t,this._shadowMapper.light=this)},enumerable:!0,configurable:!0}),e.prototype._createShadowMapper=function(){throw new s},e.prototype._updateSpecular=function(){this._specularR=this._colorR*this._specular,this._specularG=this._colorG*this._specular,this._specularB=this._colorB*this._specular},e.prototype._updateDiffuse=function(){this._diffuseR=this._colorR*this._diffuse,this._diffuseG=this._colorG*this._diffuse,this._diffuseB=this._colorB*this._diffuse},e.prototype._updateAmbient=function(){this._ambientR=(this._ambientColor>>16&255)/255*this._ambient,this._ambientG=(this._ambientColor>>8&255)/255*this._ambient,this._ambientB=(255&this._ambientColor)/255*this._ambient},e.prototype._onInvalidateConcatenatedMatrix3D=function(t){},e}(p),wl=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this,i)||this;return n._sceneDirectionDirty=!0,e&&(n.direction=e),n._sceneDirection=new P,n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sceneDirection",{get:function(){return this._sceneDirectionDirty&&this._updateSceneDirection(),this._sceneDirection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction=t,this._tmpLookAt||(this._tmpLookAt=new P),this._tmpLookAt.x=this.transform.position.x+this._direction.x,this._tmpLookAt.y=this.transform.position.y+this._direction.y,this._tmpLookAt.z=this.transform.position.z+this._direction.z,this.transform.lookAt(this._tmpLookAt)},enumerable:!0,configurable:!0}),e.prototype._onInvalidateConcatenatedMatrix3D=function(t){this._sceneDirectionDirty=!0},e.prototype._updateSceneDirection=function(){this._sceneDirectionDirty=!1,this.transform.concatenatedMatrix3D.copyColumnTo(2,this._sceneDirection),this._sceneDirection.normalize()},e.prototype._createShadowMapper=function(){return new bl},e.assetType="[light DirectionalLight]",e}(Cl),Il=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this)||this;return n.diffuseSampler=new Ze,n.specularSampler=new Ze,n.diffuseMap=e,n.specularMap=i,n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[light LightProbe]",e}(Cl),El=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,i)||this;return n._mapper=e,n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapper",{get:function(){return this._mapper},enumerable:!0,configurable:!0}),e.assetType="[texture ShadowTextureCube]",e}(ul),Sl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getFragmentCode=function(e,i,n,r){var o=i.getFreeFragmentConstant();this._positionIndex=4*o.index;var s=i.getFreeFragmentConstant(),a="",l=i.getFreeFragmentVectorTemp();return a+="sub "+l+", "+r+", "+o+"\ndp3 "+l+".w, "+l+".xyz, "+l+".xyz\nnrm "+l+".xyz, "+l+".xyz\n",a+=t.prototype._getFragmentCode.call(this,e,i,n,l)+"add "+l+".w, "+l+".w, "+s+".x\nmul "+l+".w, "+l+".w, "+o+".w\nslt "+e+".w, "+l+".w, "+e+".w\n"},e.prototype._activate=function(){t.prototype.activate.call(this);var e=this._shader.fragmentConstantData,i=this._positionIndex,n=this._texture.mapper.light.transform.concatenatedMatrix3D.position,r=this._texture.mapper.light.fallOff;e[i]=n.x,e[i+1]=n.y,e[i+2]=n.z,e[i+3]=1/(2*r*r),e[i+4]=-Math.pow(1/(r*this._texture.mapper.epsilon),2)},e}(fl);Kn.registerAbstraction(Sl,El);var Dl=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._needsRender=new Array,i._size=512,i._imageCube=e||new Zi(i._size),i._textureMap=new El(i,i._imageCube),i.iAddTexture(i._textureMap),i.initCameras(),i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){t.prototype.dispose.call(this),this._textureMap.image=null,this._textureMap=null,this._imageCube=null},e.prototype.initCameras=function(){this._depthProjections=new Array,this.addProjection(0,90,0),this.addProjection(0,-90,0),this.addProjection(-90,0,0),this.addProjection(90,0,0),this.addProjection(0,0,0),this.addProjection(0,180,0)},e.prototype.addProjection=function(t,e,i){var n=new vt;n.transform=new N,n.transform.rotateTo(t,e,i),n.near=.01,n.fieldOfView=90,this._depthProjections.push(n)},e.prototype._updateSize=function(){this._imageCube._setSize(this._size)},e.prototype._updateProjection=function(t){for(var e=this._light.fallOff,i=this._light.transform.concatenatedMatrix3D.position,n=0;n<6;++n)this._depthProjections[n].far=e,this._depthProjections[n].transform.moveTo(i.x,i.y,i.z),this._needsRender[n]=!0},e.prototype._renderMap=function(t,e){for(var i=e.distanceRenderGroup.getRenderer(t),n=0;n<6;++n)this._needsRender[n]&&(i.view.target=this._imageCube,i.view.projection=this._depthProjections[n],i.render(null,n))},e.assetType="[asset PointShadowMapper]",e}(Al),Tl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._initVO=function(e){t.prototype._initVO.call(this,e),e.needsGlobalFragmentPos=!0},e.prototype._getVertexCode=function(t,e){return this._depthMapCoordReg=e.globalPositionVarying,""},e}(vl);Kn.registerAbstraction(Tl,Dl);var Pl=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this,i)||this;return n._radius=9e4,n._fallOff=1e5,e&&(n._transform.matrix3D._rawData[12]=e.x,n._transform.matrix3D._rawData[13]=e.y,n._transform.matrix3D._rawData[14]=e.z,n._transform.invalidatePosition()),n._fallOffFactor=1/(n._fallOff*n._fallOff-n._radius*n._radius),n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._radius<0?this._radius=0:this._radius>this._fallOff&&(this._fallOff=this._radius),this._fallOffFactor=1/(this._fallOff*this._fallOff-this._radius*this._radius)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fallOff",{get:function(){return this._fallOff},set:function(t){this._fallOff=t,this._fallOff<0&&(this._fallOff=0),this._fallOff<this._radius&&(this._radius=this._fallOff),this._fallOffFactor=1/(this._fallOff*this._fallOff-this._radius*this._radius)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fallOffFactor",{get:function(){return this._fallOffFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._transform.position.x},set:function(t){this._transform.position.x!=t&&(this._transform.matrix3D._rawData[12]=t,this._transform.invalidatePosition())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._transform.position.y},set:function(t){this._transform.position.y!=t&&(this._transform.matrix3D._rawData[13]=t,this._transform.invalidatePosition())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._transform.position.z},set:function(t){this._transform.position.z!=t&&(this._transform.matrix3D._rawData[14]=t,this._transform.invalidatePosition())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scenePosition",{get:function(){return this._transform.concatenatedMatrix3D.position},enumerable:!0,configurable:!0}),e.prototype._createShadowMapper=function(){return new Dl},e.assetType="[light PointLight]",e}(Cl),Bl=(function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this)||this;n._transform=i||new N,n._projection=new vt,n._projection.transform=n._transform,n._texture=e;e.getImageAt(0).width,e.getImageAt(0).height;return n}i(e,t),Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform},set:function(t){this._transform!=t&&(this._transform=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){if(t!=this._texture){this._texture=t;t.getImageAt(0).width,t.getImageAt(0).height;this.dispatchEvent(new rl(rl.TEXTURE_CHANGE))}},enumerable:!0,configurable:!0}),e.assetType="[asset TextureProjector]"}(p),function(t){function e(){var e=t.call(this)||this;return e._alpha=1,e._strength=1,e}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength!=t&&(this._strength=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!=t&&(this._alpha=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!=t&&(this._texture&&this.iRemoveTexture(this._texture),this._texture=t,this._texture&&this.iAddTexture(this._texture),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.prototype.copyFrom=function(t){},e.assetType="[asset AmbientBasicMethod]",e}(gl)),Ml=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._method=null,this._shader=null,this._texture&&(this._texture.onClear(new l(l.CLEAR,this._method.texture)),this._texture=null)},e.prototype._initVO=function(t){this._method.texture?(this._texture=this._method.texture.getAbstraction(this._shader),this._texture._initVO(t),this._method.texture instanceof ll?t.needsNormals=!0:this._shader.uvDependencies++):this._texture&&(this._texture=null)},e.prototype._initConstants=function(){this._texture&&this._texture._initConstants()},e.prototype._getFragmentCode=function(t,e,i){var n="";if(this._texture){if(n+=this._texture._getFragmentCode(t,e,i,this._method.texture instanceof ll?i.normalFragment:i.uvVarying),this._shader.alphaThreshold>0){var r=e.getFreeFragmentConstant();this._colorIndex=4*r.index,n+="sub "+t+".w, "+t+".w, "+r+".x\nkil "+t+".w\nadd "+t+".w, "+t+".w, "+r+".x\n"}}else{var o=e.getFreeFragmentConstant();this._colorIndex=4*o.index,n+="mov "+t+", "+o+"\n"}return n},e.prototype._activate=function(){if(this._texture)this._texture.activate(),this._invalid&&this._shader.alphaThreshold>0&&(this._shader.fragmentConstantData[this._colorIndex]=this._shader.alphaThreshold);else if(this._invalid){var t=this._colorIndex,e=this._shader.fragmentConstantData,i=this._shader.numLights?16777215:this._shader.renderMaterial.style.color;e[t]=(i>>16&255)/255*this._method.strength,e[t+1]=(i>>8&255)/255*this._method.strength,e[t+2]=(255&i)/255*this._method.strength,e[t+3]=this._method.alpha}},e.prototype._setRenderState=function(t){this._texture&&this._texture._setRenderState(t)},e}(yl);Kn.registerAbstraction(Ml,Bl);var Ol=function(t){function e(e){var i=t.call(this)||this;return i._castingLight=e,e.shadowsEnabled=!0,i._shadowMapper=e.shadowMapper,i.iAddTexture(e.shadowMapper.textureMap),i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"castingLight",{get:function(){return this._castingLight},enumerable:!0,configurable:!0}),e.assetType="[asset AmbientDepthMethod]",e}(Bl),Ll=function(t){function e(e,i){var n=t.call(this,e,i)||this,r=e.castingLight.shadowMapper.textureMap;return n._shadowTexture=r.getAbstraction(n._shader),n}return i(e,t),e.prototype._initVO=function(t){this._shadowTexture._initVO(t)},e.prototype._initConstants=function(){this._shadowTexture._initConstants();var t=this._shader.fragmentConstantData,e=this._decRegIndex;t[e]=1,t[e+1]=1/255,t[e+2]=1/65025,t[e+3]=1/16581375},e.prototype._getFragmentCode=function(t,e,i){var n="",r=e.getFreeFragmentConstant();return this._decRegIndex=4*r.index,n+=this._shadowTexture._getFragmentCode(t,e,i,i.uvVarying)+"dp4 "+t+".x, "+t+", "+r+"\nmov "+t+".yz, "+t+".xx\t\t\t\nmov "+t+".w, "+r+".x\nsub "+t+".xyz, "+r+".xxx, "+t+".xyz\n"},e}(Ml);Kn.registerAbstraction(Ll,Ol);var Rl=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._onShaderInvalidatedDelegate=function(t){return i.onShaderInvalidated(t)},i._baseMethod=e||i.createBaseMethod(),i._baseMethod.addEventListener(ol.SHADER_INVALIDATED,i._onShaderInvalidatedDelegate),i}return i(e,t),Object.defineProperty(e.prototype,"baseMethod",{get:function(){return this._baseMethod},set:function(t){this._baseMethod!=t&&(this._baseMethod.removeEventListener(ol.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate),this._baseMethod=t,this._baseMethod.addEventListener(ol.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.prototype.createBaseMethod=function(){throw new s},e.prototype.iAddOwner=function(e){t.prototype.iAddOwner.call(this,e),this._baseMethod.iAddOwner(e)},e.prototype.iRemoveOwner=function(e){t.prototype.iRemoveOwner.call(this,e),this._baseMethod.iRemoveOwner(e)},e.prototype.dispose=function(){this._baseMethod.removeEventListener(ol.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate)},e.prototype.onShaderInvalidated=function(t){this.invalidateShaderProgram()},e}(gl),Nl=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.chunkVO=new pr,n._baseChunk=e.baseMethod.getAbstraction(i),n}return i(e,t),e.prototype._isUsed=function(){return!0},e.prototype._usesTangentSpace=function(){return this._baseChunk._usesTangentSpace()},e.prototype._initVO=function(t){this._baseChunk._initVO(t)},e.prototype._initConstants=function(){this._baseChunk._initConstants()},e.prototype._activate=function(){this._baseChunk._activate()},e.prototype._setRenderState=function(t){this._baseChunk._setRenderState(t)},e.prototype._deactivate=function(){this._baseChunk._deactivate(),this._invalid=!1},e.prototype._getVertexCode=function(t,e){return this._baseChunk._getVertexCode(t,e)},e.prototype._getFragmentCode=function(t,e,i){return this._baseChunk._getFragmentCode(t,e,i)},e.prototype._reset=function(t){this._baseChunk._reset(t),this._invalid=!0,this._cleanCompilationData()},e.prototype._cleanCompilationData=function(){this._baseChunk._cleanCompilationData()},e}(K),Fl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getFragmentPreLightingCode=function(t,e){return this._baseChunk._getFragmentPreLightingCode(t,e)},e.prototype._getFragmentCodePerLight=function(t,e,i,n){var r=this._baseChunk._getFragmentCodePerLight(t,e,i,n);return this._totalLightColorReg=this._baseChunk._totalLightColorReg,r},e.prototype._getFragmentCodePerProbe=function(t,e,i,n){var r=this._baseChunk._getFragmentCodePerProbe(t,e,i,n);return this._totalLightColorReg=this._baseChunk._totalLightColorReg,r},e}(Nl),kl=function(t){function e(){var e=t.call(this)||this;return e._multiply=!0,e._ambientColorR=1,e._ambientColorG=1,e._ambientColorB=1,e._color=16777215,e._colorR=1,e._colorG=1,e._colorB=1,e}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiply",{get:function(){return this._multiply},set:function(t){this._multiply!=t&&(this._multiply=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!=t&&(this._texture&&this.iRemoveTexture(this._texture),this._texture=t,this._texture&&this.iAddTexture(this._texture),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._texture=null},e.prototype.copyFrom=function(t){var e=t;this.texture=e.texture,this.multiply=e.multiply,this.color=e.color},e.assetType="[asset DiffuseBasicMethod]",e}(gl),Vl=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._ambientColorR=1,n._ambientColorG=1,n._ambientColorB=1,n._color=16777215,n._colorR=1,n._colorG=1,n._colorB=1,n._method=e,n._shader=i,n}return i(e,t),e.prototype.onInvalidate=function(e){t.prototype.onInvalidate.call(this,e),this._updateProperties()},e.prototype._isUsed=function(){return Boolean(this._shader.numLights)},e.prototype._initVO=function(t){this._method.texture?(this._texture=this._method.texture.getAbstraction(this._shader),this._texture._initVO(t),this._method.texture instanceof ll?t.needsNormals=!0:this._shader.uvDependencies++):this._texture&&(this._texture=null),this._shader.numLights&&(this._shader.usesCommonData=!0,t.needsNormals=!0)},e.prototype._initConstants=function(){this._texture&&this._texture._initConstants(),this._updateProperties()},e.prototype._cleanCompilationData=function(){t.prototype._cleanCompilationData.call(this),this._totalLightColorReg=null},e.prototype._getFragmentPreLightingCode=function(t,e){return this._pIsFirstLight=!0,t.addFragmentTempUsages(this._totalLightColorReg=t.getFreeFragmentVectorTemp(),1),""},e.prototype._getFragmentCodePerLight=function(t,e,i,n){var r,o="";return this._pIsFirstLight?r=this._totalLightColorReg:(r=i.getFreeFragmentVectorTemp(),i.addFragmentTempUsages(r,1)),o+="dp3 "+r+".x, "+t+", "+n.normalFragment+"\nmax "+r+".w, "+r+".x, "+n.commons+".y\n",this._shader.usesLightFallOff&&(o+="mul "+r+".w, "+r+".w, "+t+".w\n"),null!=this._modulateFunction&&(o+=this._modulateFunction(r,i,n)),o+="mul "+r+", "+r+".w, "+e+"\n",this._pIsFirstLight||(o+="add "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+", "+r+"\n",i.removeFragmentTempUsage(r)),this._pIsFirstLight=!1,o},e.prototype._getFragmentCodePerProbe=function(t,e,i,n){var r,o="";return this._pIsFirstLight?r=this._totalLightColorReg:(r=i.getFreeFragmentVectorTemp(),i.addFragmentTempUsages(r,1)),o+="tex "+r+", "+n.normalFragment+", "+t+" <cube,linear,miplinear>\nmul "+r+".xyz, "+r+".xyz, "+e+"\n",null!=this._modulateFunction&&(o+=this._modulateFunction(r,i,n)),this._pIsFirstLight||(o+="add "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+", "+r+"\n",i.removeFragmentTempUsage(r)),this._pIsFirstLight=!1,o},e.prototype._getFragmentCode=function(t,e,i){var n,r="";i.shadowTarget&&(r+=this._applyShadow(e,i)),e.addFragmentTempUsages(n=e.getFreeFragmentVectorTemp(),1);var o=e.getFreeFragmentConstant();if(this._ambientColorRegister=4*o.index,this._texture)r+=this._texture._getFragmentCode(n,e,i,this._method.texture instanceof ll?i.normalFragment:i.uvVarying);else{var s=e.getFreeFragmentConstant();this._diffuseColorRegister=4*s.index,r+="mov "+n+", "+s+"\n"}return r+="sat "+this._totalLightColorReg+", "+this._totalLightColorReg+"\nmul "+n+".xyz, "+n+", "+this._totalLightColorReg+"\n",this._method.multiply?r+="add "+n+".xyz, "+n+", "+o+"\nmul "+t+".xyz, "+t+", "+n+"\n":this._texture?r+="mul "+t+".xyz, "+t+", "+o+"\nmul "+this._totalLightColorReg+".xyz, "+t+", "+this._totalLightColorReg+"\nsub "+t+".xyz, "+t+", "+this._totalLightColorReg+"\nadd "+t+".xyz, "+t+", "+n+"\n":r+="mul "+this._totalLightColorReg+".xyz, "+o+", "+this._totalLightColorReg+"\nsub "+this._totalLightColorReg+".xyz, "+o+", "+this._totalLightColorReg+"\nadd "+n+".xyz, "+n+", "+this._totalLightColorReg+"\nmul "+t+".xyz, "+t+", "+n+"\n",e.removeFragmentTempUsage(this._totalLightColorReg),e.removeFragmentTempUsage(n),r},e.prototype._applyShadow=function(t,e){return"mul "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+", "+e.shadowTarget+".w\n"},e.prototype._activate=function(){if(this._texture)this._texture.activate();else{var t=this._diffuseColorRegister,e=this._shader.fragmentConstantData;this._method.multiply?(e[t]=this._colorR*this._ambientColorR,e[t+1]=this._colorG*this._ambientColorG,e[t+2]=this._colorB*this._ambientColorB):(e[t]=this._colorR,e[t+1]=this._colorG,e[t+2]=this._colorB),e[t+3]=1}},e.prototype._updateProperties=function(){this._ambientColor=this._shader.renderMaterial.style.color,this._ambientColorR=(this._ambientColor>>16&255)/255,this._ambientColorG=(this._ambientColor>>8&255)/255,this._ambientColorB=(255&this._ambientColor)/255,this._color=this._method.color,this._colorR=(this._color>>16&255)/255,this._colorG=(this._color>>8&255)/255,this._colorB=(255&this._color)/255},e.prototype._setRenderState=function(t){this._texture&&this._texture._setRenderState(t);var e=this._ambientColorRegister,i=this._shader.fragmentConstantData;i[e]=this._shader.ambientR*this._ambientColorR,i[e+1]=this._shader.ambientG*this._ambientColorG,i[e+2]=this._shader.ambientB*this._ambientColorB,i[e+3]=1},e}(yl);Kn.registerAbstraction(Vl,kl);var Ul=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return i(e,t),e.prototype.createBaseMethod=function(){return new kl},Object.defineProperty(e.prototype,"texture",{get:function(){return this._baseMethod.texture},set:function(t){this._baseMethod.texture=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._baseMethod.color},set:function(t){this._baseMethod.color=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiply",{get:function(){return this._baseMethod.multiply},set:function(t){this._baseMethod.multiply=t},enumerable:!0,configurable:!0}),e}(Rl),jl=function(t){function e(e,i,n){void 0===e&&(e=3),void 0===i&&(i=.1),void 0===n&&(n=null);var r=t.call(this,n)||this;return r._levels=e,r._smoothness=i,r}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levels",{get:function(){return this._levels},set:function(t){this._levels=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smoothness",{get:function(){return this._smoothness},set:function(t){this._smoothness=t},enumerable:!0,configurable:!0}),e.assetType="[asset DiffuseCelMethod]",e}(Ul),Gl=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n._baseChunk._modulateFunction=function(t,e,i){return n.clampDiffuse(t,e,i)},n}return i(e,t),e.prototype._initConstants=function(){t.prototype._initConstants.call(this);var e=this._shader.fragmentConstantData,i=this._clampDataIndex;e[i+1]=1,e[i+2]=0},e.prototype._cleanCompilationData=function(){t.prototype._cleanCompilationData.call(this),this._clampDataRegister=null},e.prototype._getFragmentPreLightingCode=function(e,i){return this._clampDataRegister=e.getFreeFragmentConstant(),this._clampDataIndex=4*this._clampDataRegister.index,t.prototype._getFragmentPreLightingCode.call(this,e,i)},e.prototype._activate=function(){if(t.prototype._activate.call(this),this._invalid){var e=this._shader.fragmentConstantData,i=this._clampDataIndex;e[i]=this._method.levels,e[i+3]=this._method.smoothness}},e.prototype.clampDiffuse=function(t,e,i){return"mul "+t+".w, "+t+".w, "+this._clampDataRegister+".x\nfrc "+t+".z, "+t+".w\nsub "+t+".y, "+t+".w, "+t+".z\nmov "+t+".x, "+this._clampDataRegister+".x\nsub "+t+".x, "+t+".x, "+this._clampDataRegister+".y\nrcp "+t+".x,"+t+".x\nmul "+t+".w, "+t+".y, "+t+".x\nsub "+t+".y, "+t+".w, "+t+".x\ndiv "+t+".z, "+t+".z, "+this._clampDataRegister+".w\nsat "+t+".z, "+t+".z\nmul "+t+".w, "+t+".w, "+t+".z\nsub "+t+".z, "+this._clampDataRegister+".y, "+t+".z\nmul "+t+".y, "+t+".y, "+t+".z\nadd "+t+".w, "+t+".w, "+t+".y\nsat "+t+".w, "+t+".w\n"},e}(Fl);Kn.registerAbstraction(Gl,jl);var Ql=function(t){function e(e){var i=t.call(this)||this;return i._gradient=e,i.iAddTexture(i._gradient),i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gradient",{get:function(){return this._gradient},set:function(t){this._gradient!=t&&(this._gradient&&this.iRemoveTexture(this._gradient),this._gradient=t,this._gradient&&this.iAddTexture(this._gradient),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.assetType="[asset DiffuseGradientMethod]",e}(kl),zl=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._initVO=function(e){t.prototype._initVO.call(this,e);var i=this._method.gradient||new hl;this._gradient=i.getAbstraction(this._shader),this._gradient._initVO(e)},e.prototype._initConstants=function(){this._gradient._initConstants()},e.prototype._getFragmentPreLightingCode=function(e,i){var n=t.prototype._getFragmentPreLightingCode.call(this,e,i);return this._pIsFirstLight=!0,n},e.prototype._getFragmentCodePerLight=function(t,e,i,n){var r,o="";return this._pIsFirstLight?r=this._totalLightColorReg:(r=i.getFreeFragmentVectorTemp(),i.addFragmentTempUsages(r,1)),o+="dp3 "+r+".w, "+t+".xyz, "+n.normalFragment+".xyz\nmul "+r+".w, "+r+".w, "+n.commons+".x\nadd "+r+".w, "+r+".w, "+n.commons+".x\nmul "+r+".xyz, "+r+".w, "+t+".w\n",null!=this._modulateFunction&&(o+=this._modulateFunction(r,i,n)),o+=this._gradient._getFragmentCode(r,i,n,r)+"mul "+r+".xyz, "+r+".xyz, "+e+".xyz\n",this._pIsFirstLight||(o+="add "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+".xyz, "+r+".xyz\n",i.removeFragmentTempUsage(r)),this._pIsFirstLight=!1,o},e.prototype._activate=function(){t.prototype._activate.call(this),this._gradient.activate()},e.prototype._setRenderState=function(e){t.prototype._setRenderState.call(this,e),this._gradient._setRenderState(e)},e}(Vl);Kn.registerAbstraction(zl,Ql);var Hl=function(t){function e(e,i,n,r){void 0===i&&(i="multiply"),void 0===n&&(n=!1),void 0===r&&(r=null);var o=t.call(this,r)||this;return o._lightMap=e,o.blendMode=i,o._useSecondaryUV=n,o._lightMap&&o.iAddTexture(o._lightMap),o}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){if(t!=e.ADD&&t!=e.MULTIPLY)throw new Error("Unknown blendmode!");this._blendMode!=t&&(this._blendMode=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightMap",{get:function(){return this._lightMap},set:function(t){this._lightMap!=t&&(this._lightMap&&this.iRemoveTexture(this._lightMap),this._lightMap=t,this._lightMap&&this.iAddTexture(this._lightMap),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useSecondaryUV",{get:function(){return this._useSecondaryUV},set:function(t){this._useSecondaryUV!=t&&(this._useSecondaryUV=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.MULTIPLY="multiply",e.ADD="add",e.assetType="[asset DiffuseLightMapMethod]",e}(Ul),Xl=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._initVO=function(t){var e=this._method.lightMap||new hl;this._lightMap=e.getAbstraction(this._shader),this._lightMap._initVO(t),this._method.useSecondaryUV?this._shader.secondaryUVDependencies++:this._shader.uvDependencies++},e.prototype._initConstants=function(){this._lightMap._initConstants()},e.prototype._getFragmentCode=function(e,i,n){var r,o=i.getFreeFragmentVectorTemp();switch(r=this._lightMap._getFragmentCode(o,i,n,this._method.useSecondaryUV?n.secondaryUVVarying:n.uvVarying),this._method.blendMode){case Hl.MULTIPLY:r+="mul "+this._totalLightColorReg+", "+this._totalLightColorReg+", "+o+"\n";break;case Hl.ADD:r+="add "+this._totalLightColorReg+", "+this._totalLightColorReg+", "+o+"\n"}return r+=t.prototype._getFragmentCode.call(this,e,i,n)},e.prototype._activate=function(){t.prototype._activate.call(this),this._lightMap.activate()},e.prototype._setRenderState=function(e){t.prototype._setRenderState.call(this,e),this._lightMap._setRenderState(e)},e}(Fl);Kn.registerAbstraction(Xl,Hl);var ql=function(t){function e(e){void 0===e&&(e=.5);var i=t.call(this)||this;return i.wrapFactor=e,i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wrapFactor",{get:function(){return this._wrapFactor},set:function(t){this._wrapFactor=t,this._wrapFactor=1/(t+1),this.invalidate()},enumerable:!0,configurable:!0}),e.assetType="[asset DiffuseWrapMethod]",e}(kl),Yl=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._cleanCompilationData=function(){t.prototype._cleanCompilationData.call(this),this._wrapDataRegister=null},e.prototype._getFragmentPreLightingCode=function(e,i){var n=t.prototype._getFragmentPreLightingCode.call(this,e,i);return this._pIsFirstLight=!0,this._wrapDataRegister=e.getFreeFragmentConstant(),this._wrapDataIndex=4*this._wrapDataRegister.index,n},e.prototype._getFragmentCodePerLight=function(t,e,i,n){var r,o="";return this._pIsFirstLight?r=this._totalLightColorReg:(r=i.getFreeFragmentVectorTemp(),i.addFragmentTempUsages(r,1)),o+="dp3 "+r+".x, "+t+".xyz, "+n.normalFragment+".xyz\nadd "+r+".y, "+r+".x, "+this._wrapDataRegister+".x\nmul "+r+".y, "+r+".y, "+this._wrapDataRegister+".y\nsat "+r+".w, "+r+".y\nmul "+r+".xz, "+r+".w, "+t+".wz\n",null!=this._modulateFunction&&(o+=this._modulateFunction(t,i,n)),o+="mul "+r+", "+r+".x, "+e+"\n",this._pIsFirstLight||(o+="add "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+".xyz, "+r+".xyz\n",i.removeFragmentTempUsage(r)),this._pIsFirstLight=!1,o},e.prototype._activate=function(){if(t.prototype._activate.call(this),this._invalid){var e=this._wrapDataIndex,i=this._shader.fragmentConstantData;i[e]=this._method.wrapFactor,i[e+1]=1/(this._method.wrapFactor+1)}},e}(Vl);Kn.registerAbstraction(Yl,ql);var Kl=function(t){function e(e,i){void 0===i&&(i=!1);var n=t.call(this)||this;return n._texture=e,n._useSecondaryUV=i,n._texture&&n.iAddTexture(n._texture),n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!=t&&(this._texture&&this.iRemoveTexture(this._texture),this._texture=t,this._texture&&this.iAddTexture(this._texture),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useSecondaryUV",{get:function(){return this._useSecondaryUV},set:function(t){this._useSecondaryUV!=t&&(this._useSecondaryUV=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.assetType="[asset EffectAlphaMaskMethod]",e}(gl),Wl=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._initVO=function(t){var e=this._method.texture||new hl;this._alphaMask=e.getAbstraction(this._shader),this._alphaMask._initVO(t),this._method.useSecondaryUV?this._shader.secondaryUVDependencies++:this._shader.uvDependencies++},e.prototype._initConstants=function(){this._alphaMask._initConstants()},e.prototype._getFragmentCode=function(t,e,i){var n=e.getFreeFragmentVectorTemp();return this._alphaMask._getFragmentCode(n,e,i,this._method.useSecondaryUV?i.secondaryUVVarying:i.uvVarying)+"mul "+t+", "+t+", "+n+".x\n"},e.prototype._activate=function(){t.prototype._activate.call(this),this._alphaMask.activate()},e.prototype._setRenderState=function(t){this._alphaMask._setRenderState(t)},e}(yl);Kn.registerAbstraction(Wl,Kl);var Jl=function(t){function e(e){var i=t.call(this)||this;if(20!=e.length)throw new Error("Matrix length must be 20!");return i._matrix=e,i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrix",{get:function(){return this._matrix},set:function(t){if(20!=t.length)throw new Error("Matrix length must be 20!");this._matrix=t,this.invalidate()},enumerable:!0,configurable:!0}),e.assetType="[asset EffectColorMatrixMethod]",e}(gl),Zl=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._getFragmentCode=function(t,e,i){var n="",r=e.getFreeFragmentConstant();e.getFreeFragmentConstant(),e.getFreeFragmentConstant(),e.getFreeFragmentConstant();var o=e.getFreeFragmentConstant();this._colorMatrixIndex=4*r.index;var s=e.getFreeFragmentVectorTemp();return n+="m44 "+s+", "+t+", "+r+"\nadd "+t+", "+s+", "+o+"\n"},e.prototype._activate=function(){if(this._invalid){var t=this._method.matrix,e=this._colorMatrixIndex,i=this._shader.fragmentConstantData;i[e]=t[0],i[e+1]=t[1],i[e+2]=t[2],i[e+3]=t[3],i[e+4]=t[5],i[e+5]=t[6],i[e+6]=t[7],i[e+7]=t[8],i[e+8]=t[10],i[e+9]=t[11],i[e+10]=t[12],i[e+11]=t[13],i[e+12]=t[15],i[e+13]=t[16],i[e+14]=t[17],i[e+15]=t[18],i[e+16]=t[4],i[e+17]=t[9],i[e+18]=t[14],i[e+19]=t[19]}},e}(yl);Kn.registerAbstraction(Zl,Jl);var $l=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._colorTransform=e,i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){this._colorTransform=t,this.invalidate()},enumerable:!0,configurable:!0}),e.assetType="[asset EffectColorTransformMethod]",e}(gl),tu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._getFragmentCode=function(t,e,i){var n="",r=e.getFreeFragmentConstant(),o=e.getFreeFragmentConstant();return this._colorTransformIndex=4*r.index,n+="mul "+t+", "+t+", "+r+"\nadd "+t+", "+t+", "+o+"\n"},e.prototype._activate=function(){if(this._invalid){var t=this._colorTransformIndex,e=this._shader.fragmentConstantData,i=this._method.colorTransform._rawData;e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7]}},e}(yl);Kn.registerAbstraction(tu,$l);var eu=function(t){function e(e,i){void 0===i&&(i=1);var n=t.call(this)||this;return n._envMap=e,n._alpha=i,n.iAddTexture(n._envMap),n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"envMap",{get:function(){return this._envMap},set:function(t){this._envMap!=t&&(this._envMap&&this.iRemoveTexture(this._envMap),this._envMap=t,this._envMap&&this.iAddTexture(this._envMap),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){t!=this._mask&&(this._mask&&this.iRemoveTexture(this._mask),this._mask=t,this._mask&&this.iAddTexture(this._mask),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t,this.invalidate()},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){},e.assetType="[asset EffectEnvMapMethod]",e}(gl),iu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._initVO=function(t){t.needsNormals=!0,t.needsView=!0,this._envMap=this._method.envMap.getAbstraction(this._shader),this._envMap._initVO(t),this._method.mask?(this._maskMap=this._method.mask.getAbstraction(this._shader),this._shader.uvDependencies++):this._maskMap&&(this._maskMap=null)},e.prototype._initConstants=function(){this._envMap._initConstants()},e.prototype.dispose=function(){this._envMap=null,this._maskMap=null},e.prototype._activate=function(){this._envMap.activate(),this._maskMap&&this._maskMap.activate(),this._invalid&&this._updateProperties()},e.prototype._setRenderState=function(t){this._envMap._setRenderState(t),this._maskMap&&this._maskMap._setRenderState(t)},e.prototype._getFragmentCode=function(t,e,i){var n=e.getFreeFragmentConstant(),r="";this._fragmentIndex=4*n.index;var o=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(o,1);var s=e.getFreeFragmentVectorTemp();return e.addFragmentTempUsages(s,1),r+="dp3 "+o+".w, "+i.viewDirFragment+".xyz, "+i.normalFragment+".xyz\nadd "+o+".w, "+o+".w, "+o+".w\nmul "+o+".xyz, "+i.normalFragment+".xyz, "+o+".w\nsub "+o+".xyz, "+o+".xyz, "+i.viewDirFragment+".xyz\n"+this._envMap._getFragmentCode(o,e,i,o)+"sub "+s+".w, "+o+".w, fc0.x\nkil "+s+".w\nsub "+o+", "+o+", "+t+"\n",this._maskMap&&(r+=this._maskMap._getFragmentCode(s,e,i,i.uvVarying)+"mul "+o+", "+s+", "+o+"\n"),r+="mul "+o+", "+o+", "+n+".x\nadd "+t+", "+t+", "+o+"\n",e.removeFragmentTempUsage(o),e.removeFragmentTempUsage(s),r},e.prototype._updateProperties=function(){this._shader.fragmentConstantData[this._fragmentIndex]=this._method.alpha},e}(yl);Kn.registerAbstraction(iu,eu);var nu=function(t){function e(e,i,n){void 0===e&&(e=0),void 0===i&&(i=1e3),void 0===n&&(n=8421504);var r=t.call(this)||this;return r._minDistance=e,r._maxDistance=i,r._fogColor=n,r}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minDistance",{get:function(){return this._minDistance},set:function(t){this._minDistance=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxDistance",{get:function(){return this._maxDistance},set:function(t){this._maxDistance=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fogColor",{get:function(){return this._fogColor},set:function(t){this._fogColor=t,this.invalidate()},enumerable:!0,configurable:!0}),e.assetType="[asset EffectFogMethod]",e}(gl),ru=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._initVO=function(t){t.needsProjection=!0},e.prototype._activate=function(){if(this._invalid){var t=this._shader.fragmentConstantData,e=this._fogColorIndex,i=this._method.fogColor;t[e]=(i>>16&255)/255,t[e+1]=(i>>8&255)/255,t[e+2]=(255&i)/255,t[e+3]=1,t[e+4]=this._method.minDistance,t[e+5]=1/(this._method.maxDistance-this._method.minDistance),t[e+6]=0,t[e+7]=0}},e.prototype._getFragmentCode=function(t,e,i){var n=e.getFreeFragmentConstant(),r=e.getFreeFragmentConstant(),o=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(o,1);var s=e.getFreeFragmentVectorTemp(),a="";return this._fogColorIndex=4*n.index,a+="sub "+s+".w, "+i.projectionFragment+".z, "+r+".x\nmul "+s+".w, "+s+".w, "+r+".y\nsat "+s+".w, "+s+".w\nsub "+o+", "+n+", "+t+"\nmul "+o+", "+o+", "+s+".w\nadd "+t+", "+t+", "+o+"\n",e.removeFragmentTempUsage(o),a},e}(yl);Kn.registerAbstraction(ru,nu);var ou=function(t){function e(e,i,n,r){void 0===i&&(i=1),void 0===n&&(n=5),void 0===r&&(r=0);var o=t.call(this,e,i)||this;return o._fresnelPower=n,o._normalReflectance=r,o}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fresnelPower",{get:function(){return this._fresnelPower},set:function(t){this._fresnelPower=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalReflectance",{get:function(){return this._normalReflectance},set:function(t){this._normalReflectance!=t&&(this._normalReflectance=t,this.invalidate())},enumerable:!0,configurable:!0}),e.assetType="[asset EffectFresnelEnvMapMethod]",e}(eu),su=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getFragmentCode=function(t,e,i){var n=e.getFreeFragmentConstant(),r="",o=i.viewDirFragment,s=i.normalFragment;this._fragmentIndex=4*n.index;var a=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(a,1);var l=e.getFreeFragmentVectorTemp();return e.addFragmentTempUsages(l,1),r+="dp3 "+a+".w, "+o+".xyz, "+s+".xyz\nadd "+a+".w, "+a+".w, "+a+".w\nmul "+a+".xyz, "+s+".xyz, "+a+".w\nsub "+a+".xyz, "+a+".xyz, "+o+".xyz\n"+this._envMap._getFragmentCode(a,e,i,a)+"sub "+l+".w, "+a+".w, fc0.x\nkil "+l+".w\nsub "+a+", "+a+", "+t+"\n",r+="dp3 "+o+".w, "+o+".xyz, "+s+".xyz\nsub "+o+".w, "+n+".w, "+o+".w\npow "+o+".w, "+o+".w, "+n+".z\nsub "+s+".w, "+n+".w, "+o+".w\nmul "+s+".w, "+n+".y, "+s+".w\nadd "+o+".w, "+o+".w, "+s+".w\nmul "+o+".w, "+n+".x, "+o+".w\n",this._maskMap&&(r+=this._maskMap._getFragmentCode(l,e,i,i.uvVarying)+"mul "+o+".w, "+l+".x, "+o+".w\n"),r+="mul "+a+", "+a+", "+o+".w\nadd "+t+", "+t+", "+a+"\n",e.removeFragmentTempUsage(a),e.removeFragmentTempUsage(l),r},e.prototype._updateProperties=function(){var t=this._fragmentIndex,e=this._shader.fragmentConstantData;e[t]=this._method.alpha,e[t+1]=this._method.normalReflectance,e[t+2]=this._method.fresnelPower},e}(iu);Kn.registerAbstraction(su,ou);var au=function(t){function e(i,n,r){void 0===n&&(n="multiply"),void 0===r&&(r=!1);var o=t.call(this)||this;if(n!=e.ADD&&n!=e.MULTIPLY)throw new Error("Unknown blendmode!");return o._lightMap=i,o._blendMode=n,o._useSecondaryUV=r,o._lightMap&&o.iAddTexture(o._lightMap),o}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){if(this._blendMode!=t){if(t!=e.ADD&&t!=e.MULTIPLY)throw new Error("Unknown blendmode!");this._blendMode=t,this.invalidateShaderProgram()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightMap",{get:function(){return this._lightMap},set:function(t){this._lightMap!=t&&(this._lightMap&&this.iRemoveTexture(this._lightMap),this._lightMap=t,this._lightMap&&this.iAddTexture(this._lightMap),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useSecondaryUV",{get:function(){return this._useSecondaryUV},set:function(t){this._useSecondaryUV!=t&&(this._useSecondaryUV=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.MULTIPLY="multiply",e.ADD="add",e.assetType="[asset EffectLightMapMethod]",e}(gl),lu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._initVO=function(t){this._lightMap=this._method.lightMap.getAbstraction(this._shader),this._lightMap._initVO(t),this._method.useSecondaryUV?this._shader.secondaryUVDependencies++:this._shader.uvDependencies++},e.prototype._initConstants=function(){this._lightMap._initConstants()},e.prototype._getFragmentCode=function(t,e,i){var n,r=e.getFreeFragmentVectorTemp();switch(n=this._lightMap._getFragmentCode(r,e,i,this._method.useSecondaryUV?i.secondaryUVVarying:i.uvVarying),this._method.blendMode){case au.MULTIPLY:n+="mul "+t+", "+t+", "+r+"\n";break;case au.ADD:n+="add "+t+", "+t+", "+r+"\n"}return n},e.prototype._activate=function(){this._lightMap.activate()},e.prototype._setRenderState=function(t){this._lightMap._setRenderState(t)},e}(yl);Kn.registerAbstraction(lu,au);var uu=function(t){function e(e,i,n){void 0===i&&(i="multiply"),void 0===n&&(n=1);var r=t.call(this)||this;return r._onTextureChangedDelegate=function(t){return r._onTextureChanged(t)},r._projector=e,r._exposure=n,r._mode=i,r._projector.addEventListener(rl.TEXTURE_CHANGE,r._onTextureChangedDelegate),r}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exposure",{get:function(){return this._exposure},set:function(t){this._exposure!=t&&(this._exposure=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode!=t&&(this._mode=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projector",{get:function(){return this._projector},set:function(t){this._projector!=t&&(this._projector&&this._projector.removeEventListener(rl.TEXTURE_CHANGE,this._onTextureChangedDelegate),this._projector=t,this._projector&&this._projector.addEventListener(rl.TEXTURE_CHANGE,this._onTextureChangedDelegate),this.updateTexture())},enumerable:!0,configurable:!0}),e.prototype._onTextureChanged=function(t){this.updateTexture()},e.prototype.updateTexture=function(){this._texture&&this.iRemoveTexture(this._texture),this._texture=this._projector?this._projector.texture:null,this._texture&&this.iAddTexture(this._texture),this.invalidateShaderProgram()},e.OVERLAY="overlay",e.MULTIPLY="multiply",e.ADD="add",e.MIX="mix",e.assetType="[asset EffectProjectiveTextureMethod]",e}(gl),cu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._initVO=function(t){this._texture=this._method.projector.texture.getAbstraction(this._shader),this._texture._initVO(t)},e.prototype._initConstants=function(){this._texture._initConstants();var t=this._exposureIndex,e=this._shader.fragmentConstantData;e[t]=this._method.exposure,e[t+1]=.5,e[t+2]=4,e[t+3]=-1,this._projectionMatrix=new R(new Float32Array(this._shader.vertexConstantData.buffer,4*this._projectionIndex,16))},e.prototype._cleanCompilationData=function(){t.prototype._cleanCompilationData.call(this),this._uvVarying=null,this._projectionMatrix=null},e.prototype._getVertexCode=function(t,e){var i="",n=t.getFreeVertexConstant();return t.getFreeVertexConstant(),t.getFreeVertexConstant(),t.getFreeVertexConstant(),this._projectionIndex=4*n.index,this._uvVarying=t.getFreeVarying(),i+="m44 "+this._uvVarying+", "+e.animatedPosition+", "+n+"\n"},e.prototype._getFragmentCode=function(t,e,i){var n="",r=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(r,1);var s=e.getFreeFragmentVectorTemp(),a=e.getFreeFragmentConstant();if(this._exposureIndex=4*a.index,n+=this._texture._getFragmentCode(r,e,i,this._uvVarying),n+="mul "+r+", "+r+", "+a+".xxx\nadd "+r+", "+r+", "+a+".xxx\n",this._method.mode==uu.MULTIPLY)n+="mul "+t+".xyz, "+t+".xyz, "+r+".xyz\t\t\t\n";else if(this._method.mode==uu.ADD)n+="add "+t+".xyz, "+t+".xyz, "+r+".xyz\t\t\t\n";else if(this._method.mode==uu.MIX)n+="sub "+r+".xyz, "+r+".xyz, "+t+".xyz\t\t\t\t\nmul "+r+".xyz, "+r+".xyz, "+r+".w\t\t\t\t\t\t\nadd "+t+".xyz, "+t+".xyz, "+r+".xyz\t\t\t\n";else{if(this._method.mode!=uu.OVERLAY)throw new o('Unknown mode "'+this._method.mode+'"');n+="sge "+s+", "+t+", "+a+".yyy\n",n+="sub "+t+", "+t+", "+s+"\n",n+="sub "+r+", "+r+", "+s+"\n",n+="mul "+r+", "+r+", "+t+"\n",n+="sub "+t+", "+a+".yyy, "+s+"\n",n+="mul "+t+", "+a+".zzz, "+t+"\n",n+="mul "+r+", "+r+", "+t+"\n",n+="add "+t+", "+r+", "+s+"\n"}return e.removeFragmentTempUsage(r),n},e.prototype._setRenderState=function(t){var e=R.CALCULATION_MATRIX;e.copyFrom(this._method.projector.projection.viewMatrix3D),e.prepend(t.renderSceneTransform),this._projectionMatrix.copyFrom(e,!0),this._texture._setRenderState(t)},e.prototype._activate=function(){this._texture.activate(),this._invalid&&(this._shader.fragmentConstantData[this._exposureIndex]=this._method.exposure)},e}(yl);Kn.registerAbstraction(cu,uu);var hu=function(t){function e(e,i,n,r,o,s){void 0===i&&(i=1),void 0===n&&(n=.1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0);var a=t.call(this,e,i)||this;return a._dispersionR=0,a._dispersionG=0,a._dispersionB=0,a._refractionIndex=n,a._dispersionR=r,a._dispersionG=o,a._dispersionB=s,a}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"refractionIndex",{get:function(){return this._refractionIndex},set:function(t){this._refractionIndex=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dispersionR",{get:function(){return this._dispersionR},set:function(t){this._dispersionR!=t&&(this._dispersionR=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dispersionG",{get:function(){return this._dispersionG},set:function(t){this._dispersionG!=t&&(this._dispersionG=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dispersionB",{get:function(){return this._dispersionB},set:function(t){this._dispersionB!=t&&(this._dispersionB=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.assetType="[asset EffectRefractionEnvMapMethod]",e}(eu),pu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._initVO=function(e){t.prototype._initVO.call(this,e),this._useDispersion=!(this._method.dispersionR==this._method.dispersionB&&this._method.dispersionR==this._method.dispersionG)},e.prototype._getFragmentCode=function(t,e,i){var n,r,o,s=e.getFreeFragmentConstant(),a=e.getFreeFragmentConstant(),l="";this._fragmentIndex=4*s.index,n=e.getFreeFragmentVectorTemp(),e.addFragmentTempUsages(n,1),r=e.getFreeFragmentVectorTemp(),e.addFragmentTempUsages(r,1),o=e.getFreeFragmentVectorTemp(),e.addFragmentTempUsages(o,1);var u=i.viewDirFragment,c=i.normalFragment;return l+="neg "+u+".xyz, "+u+".xyz\n",l+="dp3 "+o+".x, "+u+".xyz, "+c+".xyz\nmul "+o+".w, "+o+".x, "+o+".x\nsub "+o+".w, "+a+".x, "+o+".w\nmul "+o+".w, "+s+".x, "+o+".w\nmul "+o+".w, "+s+".x, "+o+".w\nsub "+o+".w, "+a+".x, "+o+".w\nsqt "+o+".y, "+o+".w\nmul "+o+".x, "+s+".x, "+o+".x\nadd "+o+".x, "+o+".x, "+o+".y\nmul "+o+".xyz, "+o+".x, "+c+".xyz\nmul "+n+", "+s+".x, "+u+"\nsub "+n+".xyz, "+n+".xyz, "+o+".xyz\nnrm "+n+".xyz, "+n+".xyz\n"+this._envMap._getFragmentCode(r,e,i,n)+"sub "+r+".w, "+r+".w, fc0.x\t\nkil "+r+".w\n",this._useDispersion&&(l+="dp3 "+o+".x, "+u+".xyz, "+c+".xyz\nmul "+o+".w, "+o+".x, "+o+".x\nsub "+o+".w, "+a+".x, "+o+".w\nmul "+o+".w, "+s+".y, "+o+".w\nmul "+o+".w, "+s+".y, "+o+".w\nsub "+o+".w, "+a+".x, "+o+".w\nsqt "+o+".y, "+o+".w\nmul "+o+".x, "+s+".y, "+o+".x\nadd "+o+".x, "+o+".x, "+o+".y\nmul "+o+".xyz, "+o+".x, "+c+".xyz\nmul "+n+", "+s+".y, "+u+"\nsub "+n+".xyz, "+n+".xyz, "+o+".xyz\nnrm "+n+".xyz, "+n+".xyz\n"+this._envMap._getFragmentCode(o,e,i,n)+"mov "+r+".y, "+o+".y\n",l+="dp3 "+o+".x, "+u+".xyz, "+c+".xyz\nmul "+o+".w, "+o+".x, "+o+".x\nsub "+o+".w, "+a+".x, "+o+".w\nmul "+o+".w, "+s+".z, "+o+".w\nmul "+o+".w, "+s+".z, "+o+".w\nsub "+o+".w, "+a+".x, "+o+".w\nsqt "+o+".y, "+o+".w\nmul "+o+".x, "+s+".z, "+o+".x\nadd "+o+".x, "+o+".x, "+o+".y\nmul "+o+".xyz, "+o+".x, "+c+".xyz\nmul "+n+", "+s+".z, "+u+"\nsub "+n+".xyz, "+n+".xyz, "+o+".xyz\nnrm "+n+".xyz, "+n+".xyz\n"+this._envMap._getFragmentCode(o,e,i,n)+"mov "+r+".z, "+o+".z\n"),l+="sub "+r+".xyz, "+r+".xyz, "+t+".xyz\nmul "+r+".xyz, "+r+".xyz, "+s+".w\nadd "+t+".xyz, "+t+".xyz, "+r+".xyz\n",e.removeFragmentTempUsage(o),e.removeFragmentTempUsage(n),e.removeFragmentTempUsage(r),l+="neg "+u+".xyz, "+u+".xyz\n"},e.prototype._updateProperties=function(){var t=this._fragmentIndex,e=this._shader.fragmentConstantData,i=this._method.refractionIndex;e[t]=this._method.dispersionR+i,this._useDispersion&&(e[t+1]=this._method.dispersionG+i,e[t+2]=this._method.dispersionB+i),e[t+3]=this._method.alpha},e}(iu);Kn.registerAbstraction(pu,hu);var du=function(t){function e(e,i,n,r){void 0===e&&(e=16777215),void 0===i&&(i=.4),void 0===n&&(n=2),void 0===r&&(r="mix");var o=t.call(this)||this;return o._blendMode=r,o._strength=i,o._power=n,o._color=e,o}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._power!=t&&(this._color=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength!=t&&(this._strength=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"power",{get:function(){return this._power},set:function(t){this._power!=t&&(this._power=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this._blendMode!=t&&(this._blendMode=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.ADD="add",e.MULTIPLY="multiply",e.MIX="mix",e.assetType="[asset EffectRimLightMethod]",e}(gl),fu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._initVO=function(t){t.needsNormals=!0,t.needsView=!0},e.prototype._activate=function(){if(this._invalid){var t=this._rimColorIndex,e=this._shader.fragmentConstantData,i=this._method.color;e[t]=(i>>16&255)/255,e[t+1]=(i>>8&255)/255,e[t+2]=(255&i)/255,e[t+3]=1,e[t+4]=this._method.strength,e[t+5]=this._method.power}},e.prototype._getFragmentCode=function(t,e,i){var n=e.getFreeFragmentConstant(),r=e.getFreeFragmentConstant(),o=e.getFreeFragmentVectorTemp(),s="";return this._rimColorIndex=4*n.index,s+="dp3 "+o+".x, "+i.viewDirFragment+".xyz, "+i.normalFragment+".xyz\nsat "+o+".x, "+o+".x\nsub "+o+".x, "+n+".w, "+o+".x\npow "+o+".x, "+o+".x, "+r+".y\nmul "+o+".x, "+o+".x, "+r+".x\nsub "+o+".x, "+n+".w, "+o+".x\nmul "+t+".xyz, "+t+".xyz, "+o+".x\nsub "+o+".w, "+n+".w, "+o+".x\n",this._method.blendMode==du.ADD?s+="mul "+o+".xyz, "+o+".w, "+n+".xyz\nadd "+t+".xyz, "+t+".xyz, "+o+".xyz\n":this._method.blendMode==du.MULTIPLY?s+="mul "+o+".xyz, "+o+".w, "+n+".xyz\nmul "+t+".xyz, "+t+".xyz, "+o+".xyz\n":s+="sub "+o+".xyz, "+n+".xyz, "+t+".xyz\nmul "+o+".xyz, "+o+".xyz, "+o+".w\nadd "+t+".xyz, "+t+".xyz, "+o+".xyz\n",s},e}(yl);Kn.registerAbstraction(fu,du);var _u=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._texture=e,i._texture&&i.iAddTexture(i._texture),i}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!=t&&(this._texture&&this.iRemoveTexture(this._texture),this._texture=t,this._texture&&this.iAddTexture(this._texture),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.prototype.copyFrom=function(t){var e=t;null!=e.texture&&(this.texture=e.texture)},e.prototype.dispose=function(){this._texture&&(this._texture=null)},e.assetType="[asset NormalBasicMethod]",e}(gl),mu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._isUsed=function(){return!(!this._texture||!this._shader.normalDependencies)},e.prototype._initVO=function(t){this._method.texture&&(this._texture=this._method.texture.getAbstraction(this._shader),this._texture._initVO(t),this._shader.uvDependencies++)},e.prototype._initConstants=function(){this._method.texture&&this._texture._initConstants()},e.prototype._outputsTangentNormals=function(){return!0},e.prototype._activate=function(){this._texture&&this._texture.activate()},e.prototype._setRenderState=function(t){this._texture&&this._texture._setRenderState(t)},e.prototype._getFragmentCode=function(t,e,i){var n="";return this._texture&&(n+=this._texture._getFragmentCode(t,e,i,i.uvVarying)),n+="sub "+t+".xyz, "+t+".xyz, "+i.commons+".xxx\nnrm "+t+".xyz, "+t+"\n"},e}(yl);Kn.registerAbstraction(mu,_u);var gu=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.texture=e,o._worldXYRatio=i/n,o._worldXZRatio=r/n,o}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldXYRatio",{get:function(){return this._worldXYRatio},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldXZRatio",{get:function(){return this._worldXZRatio},enumerable:!0,configurable:!0}),e.prototype.copyFrom=function(e){t.prototype.copyFrom.call(this,e),this._worldXYRatio=e._worldXYRatio,this._worldXZRatio=e._worldXZRatio},e.assetType="[asset NormalHeightMapMethod]",e}(_u),yu=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._initConstants=function(){t.prototype._initConstants.call(this);var e=this._fragmentConstantsIndex,i=this._shader.fragmentConstantData,n=this._method.texture.image;i[e]=1/n.width,i[e+1]=1/n.height,i[e+2]=0,i[e+3]=1,i[e+4]=this._method.worldXYRatio,i[e+5]=this._method.worldXZRatio},Object.defineProperty(e.prototype,"tangentSpace",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype._getFragmentCode=function(t,e,i){var n="",r=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(r,1);var o=e.getFreeFragmentConstant(),s=e.getFreeFragmentConstant();return this._fragmentConstantsIndex=4*o.index,n+=this._texture._getFragmentCode(t,e,i,i.uvVarying)+"add "+r+", "+i.uvVarying+", "+o+".xzzz\n"+this._texture._getFragmentCode(r,e,i,r)+"sub "+t+".x, "+t+".x, "+r+".x\nadd "+r+", "+i.uvVarying+", "+o+".zyzz\n"+this._texture._getFragmentCode(r,e,i,r)+"sub "+t+".z, "+t+".z, "+r+".x\nmov "+t+".y, "+o+".w\nmul "+t+".xz, "+t+".xz, "+s+".xy\nnrm "+t+".xyz, "+t+".xyz\n",e.removeFragmentTempUsage(r),n},e}(mu);Kn.registerAbstraction(yu,gu);var Au=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this,e)||this;return n._water1OffsetX=0,n._water1OffsetY=0,n._water2OffsetX=0,n._water2OffsetY=0,n._secondaryNormalMap=i,n._secondaryNormalMap&&n.iAddTexture(n._secondaryNormalMap),n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"water1OffsetX",{get:function(){return this._water1OffsetX},set:function(t){this._water1OffsetX=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"water1OffsetY",{get:function(){return this._water1OffsetY},set:function(t){this._water1OffsetY=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"water2OffsetX",{get:function(){return this._water2OffsetX},set:function(t){this._water2OffsetX=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"water2OffsetY",{get:function(){return this._water2OffsetY},set:function(t){this._water2OffsetY=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryNormalMap",{get:function(){return this._secondaryNormalMap},set:function(t){this._secondaryNormalMap!=t&&(this._secondaryNormalMap&&this.iRemoveTexture(this._secondaryNormalMap),this._secondaryNormalMap=t,this._secondaryNormalMap&&this.iAddTexture(this._secondaryNormalMap),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){t.prototype.dispose.call(this),this._secondaryNormalMap=null},e.assetType="[asset NormalSimpleWaterMethod]",e}(_u),vu=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._initConstants=function(){t.prototype._initConstants.call(this);var e=this._fragmentConstantsIndex,i=this._shader.fragmentConstantData;i[e]=.5,i[e+1]=0,i[e+2]=0,i[e+3]=1},e.prototype._initVO=function(e){t.prototype._initVO.call(this,e);var i=this._method.secondaryNormalMap;i&&(this._secondaryNormalMap=i.getAbstraction(this._shader),this._shader.uvDependencies++)},e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._secondaryNormalMap=null},e.prototype._activate=function(){if(t.prototype._activate.call(this),this._invalid){var e=this._shader.fragmentConstantData,i=this._fragmentConstantsIndex;e[i+4]=this._method.water1OffsetX,e[i+5]=this._method.water1OffsetY,e[i+6]=this._method.water2OffsetX,e[i+7]=this._method.water2OffsetY}this._secondaryNormalMap&&this._secondaryNormalMap.activate()},e.prototype._setRenderState=function(e){t.prototype._setRenderState.call(this,e),this._secondaryNormalMap&&this._secondaryNormalMap._setRenderState(e)},e.prototype._getFragmentCode=function(t,e,i){var n="",r=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(r,1);var o=e.getFreeFragmentConstant(),s=e.getFreeFragmentConstant();return this._fragmentConstantsIndex=4*o.index,n+="add "+r+", "+i.uvVarying+", "+s+".xyxy\n",this._texture&&(n+=this._texture._getFragmentCode(t,e,i,r)),n+="add "+r+", "+i.uvVarying+", "+s+".zwzw\n",this._secondaryNormalMap&&(n+=this._secondaryNormalMap._getFragmentCode(r,e,i,r)),n+="add "+t+", "+t+", "+r+"\t\t\nmul "+t+", "+t+", "+o+".x\t\nsub "+t+".xyz, "+t+".xyz, "+i.commons+".xxx\t\nnrm "+t+".xyz, "+t+".xyz\t\t\t\t\t\t\t\n"},e}(mu);Kn.registerAbstraction(vu,Au);var bu=function(t){function e(e){var i=t.call(this,e.shadowMapper)||this;return i._castingLight=e,i}return i(e,t),Object.defineProperty(e.prototype,"castingLight",{get:function(){return this._castingLight},enumerable:!0,configurable:!0}),e}(Rl),xu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._initVO=function(e){t.prototype._initVO.call(this,e),this._baseTexture=this._baseChunk.texture},e}(Nl),Cu=function(t){function e(i,n,r){void 0===n&&(n=4),void 0===r&&(r=1);var o=t.call(this,i)||this;return o._depthMapSize=o._castingLight.shadowMapper.size,o.numSamples=n,o.range=r,++e._grainUsages,e._grainTexture||o.initGrainTexture(),o}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numSamples",{get:function(){return this._numSamples},set:function(t){t<1?t=1:t>24&&(t=24),this._numSamples!=t&&(this._numSamples=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return 2*this._range},set:function(t){this._range=t/2},enumerable:!0,configurable:!0}),e.prototype.initGrainTexture=function(){e._grainBitmapImage2D=new hn(64,64,!1);for(var t,i,n=new Array,r=1/(this._depthMapSize*this._range),o=0;o<4096;++o)(t=2*(Math.random()-.5))<0?t-=r:t+=r,(i=2*(Math.random()-.5))<0?i-=r:i+=r,t>1?t=1:t<-1&&(t=-1),i>1?i=1:i<-1&&(i=-1),n[o]=Math.floor(255*(.5*t+.5))<<16|Math.floor(255*(.5*i+.5))<<8;e._grainBitmapImage2D.setArray(e._grainBitmapImage2D.rect,n),e._grainTexture=new hl(e._grainBitmapImage2D)},e.prototype.dispose=function(){0==--e._grainUsages&&(e._grainTexture.dispose(),e._grainBitmapImage2D.dispose(),e._grainTexture=null)},e.assetType="[asset ShadowDitheredMethod]",e}(bu),wu=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._initVO=function(e){t.prototype._initVO.call(this,e),e.needsProjection=!0,this._grainMap=Cu._grainTexture.getAbstraction(this._shader)},e.prototype._initConstants=function(){t.prototype._initConstants.call(this),this._shader.fragmentConstantData[this._fragmentConstantsIndex]=1/this._method.numSamples},e.prototype._activate=function(){t.prototype._activate.call(this);var e=this._shader.fragmentConstantData,i=this._fragmentConstantsIndex;e[i+1]=(this._shader.renderMaterial.renderGroup.view.width-1)/63,e[i+2]=(this._shader.renderMaterial.renderGroup.view.height-1)/63,e[i+3]=2*this._method.range/this._method.castingLight.shadowMapper.size,this._grainMap.activate()},e.prototype._getFragmentCode=function(e,i,n){var r=i.getFreeFragmentConstant();this._fragmentConstantsIndex=4*r.index;var o="",s=this._method.numSamples,a=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(a,1);var l=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(l,1);var u=n.projectionFragment;o+="div "+a+", "+u+", "+u+".w\nmul "+a+".xy, "+a+".xy, "+r+".yz\n";for(var c=s;c>0;)o+=c==s?this._grainMap._getFragmentCode(a,i,n,a):"mov "+l+", "+a+".zwxy \n"+this._grainMap._getFragmentCode(a,i,n,l),o+="sub "+a+".zw, "+a+".xy, fc0.xx\nmul "+a+".zw, "+a+".zw, "+r+".w\n",o+=c==s?"add "+a+".xy, "+a+".zw, "+this._baseChunk.depthMapCoordReg+".xy\n"+this._baseTexture._getFragmentCode(e,i,n,a):this._addSample(a,e,i,n),c>4&&(o+="add "+a+".xy, "+a+".xy, "+a+".zw\n"+this._addSample(a,e,i,n)),c>1&&(o+="sub "+a+".xy, "+this._baseChunk.depthMapCoordReg+".xy, "+a+".zw\n"+this._addSample(a,e,i,n)),c>5&&(o+="sub "+a+".xy, "+a+".xy, "+a+".zw\n"+this._addSample(a,e,i,n)),c>2&&(o+="neg "+a+".w, "+a+".w\nadd "+a+".xy, "+a+".wz, "+this._baseChunk.depthMapCoordReg+".xy\n"+this._addSample(a,e,i,n)),c>6&&(o+="add "+a+".xy, "+a+".xy, "+a+".wz\n"+this._addSample(a,e,i,n)),c>3&&(o+="sub "+a+".xy, "+this._baseChunk.depthMapCoordReg+".xy, "+a+".wz\n"+this._addSample(a,e,i,n)),c>7&&(o+="sub "+a+".xy, "+a+".xy, "+a+".wz\n"+this._addSample(a,e,i,n)),c-=8;return i.removeFragmentTempUsage(l),i.removeFragmentTempUsage(a),o+="mul "+e+".w, "+e+".w, "+r+".x\n"+t.prototype._getFragmentCode.call(this,e,i,n)},e.prototype._setRenderState=function(e){t.prototype._setRenderState.call(this,e),this._grainMap._setRenderState(e)},e.prototype._addSample=function(t,e,i,n){var r=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(r,1);var o=this._baseTexture._getFragmentCode(r,i,n,t)+"add "+e+".w, "+e+".w, "+r+".w\n";return i.removeFragmentTempUsage(r),o},e}(xu);Kn.registerAbstraction(wu,Cu);var Iu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[asset ShadowFilteredMethod]",e}(bu),Eu=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._initConstants=function(){t.prototype._initConstants.call(this);var e=this._shader.fragmentConstantData,i=this._fragmentConstantsIndex;e[i]=.5;var n=this._method.castingLight.shadowMapper.size;e[i+1]=n,e[i+2]=1/n},e.prototype._getFragmentCode=function(e,i,n){var r=i.getFreeFragmentConstant();this._fragmentConstantsIndex=4*r.index;var o="",s=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(s,1);var a=i.getFreeFragmentVectorTemp();return i.addFragmentTempUsages(a,1),o+="mov "+s+", "+this._baseChunk.depthMapCoordReg+"\n"+this._baseTexture._getFragmentCode(a,i,n,s)+"mov "+s+".w, "+a+".w\nadd "+s+".x, "+this._baseChunk.depthMapCoordReg+".x, "+r+".z\n"+this._baseTexture._getFragmentCode(a,i,n,s)+"mul "+a+".x, "+this._baseChunk.depthMapCoordReg+".x, "+r+".y\nfrc "+a+".x, "+a+".x\nsub "+a+".w, "+a+".w, "+s+".w\nmul "+a+".w, "+a+".w, "+a+".x\nadd "+e+".w, "+s+".w, "+a+".w\nmov "+s+".x, "+this._baseChunk.depthMapCoordReg+".x\nadd "+s+".y, "+this._baseChunk.depthMapCoordReg+".y, "+r+".z\n"+this._baseTexture._getFragmentCode(a,i,n,s)+"mov "+s+".w, "+a+".w\nadd "+s+".x, "+this._baseChunk.depthMapCoordReg+".x, "+r+".z\n"+this._baseTexture._getFragmentCode(a,i,n,s)+"mul "+a+".x, "+this._baseChunk.depthMapCoordReg+".x, "+r+".y\nfrc "+a+".x, "+a+".x\nsub "+a+".w, "+a+".w, "+s+".w\nmul "+a+".w, "+a+".w, "+a+".x\nadd "+s+".w, "+s+".w, "+a+".w\nmul "+a+".x, "+this._baseChunk.depthMapCoordReg+".y, "+r+".y\nfrc "+a+".x, "+a+".x\nsub "+s+".w, "+s+".w, "+e+".w\nmul "+s+".w, "+s+".w, "+a+".x\nadd "+e+".w, "+e+".w, "+s+".w\n",i.removeFragmentTempUsage(a),i.removeFragmentTempUsage(s),t.prototype._getFragmentCode.call(this,e,i,n),o},e}(xu);Kn.registerAbstraction(Eu,Iu);var Su=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[asset ShadowHardMethod]",e}(bu),Du=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._getFragmentCode=function(e,i,n){var r=this._baseTexture._getFragmentCode(e,i,n,this._baseChunk.depthMapCoordReg);return r+=t.prototype._getFragmentCode.call(this,e,i,n)},e}(xu);Kn.registerAbstraction(Du,Su);var Tu=function(t){function e(e,i,n){void 0===i&&(i=5),void 0===n&&(n=1);var r=t.call(this,e)||this;return r.numSamples=i,r.range=n,r}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return this._offsets},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numSamples",{get:function(){return this._numSamples},set:function(t){this._numSamples=t,this._numSamples<1?this._numSamples=1:this._numSamples>32&&(this._numSamples=32),this._offsets=X.getDistribution(this._numSamples),this.invalidateShaderProgram()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t},enumerable:!0,configurable:!0}),e.assetType="[asset ShadowSoftMethod]",e}(bu),Pu=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._initConstants=function(){t.prototype._initConstants.call(this),this._shader.fragmentConstantData[this._fragmentConstantsIndex]=1/this._method.numSamples,this._shader.fragmentConstantData[this._fragmentConstantsIndex+1]=0},e.prototype._activate=function(){t.prototype._activate.call(this);for(var e=.5*this._method.range/this._method.castingLight.shadowMapper.size,i=this._shader.fragmentConstantData,n=this._fragmentConstantsIndex+2,r=this._method.numSamples<<1,o=0;o<r;++o)i[n+o]=this._method.offsets[o]*e},e.prototype._getFragmentCode=function(e,i,n){var r=i.getFreeFragmentConstant();this._fragmentConstantsIndex=4*r.index;var o="",s=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(s,1);for(var a=new Array(r+".zw"),l=this._method.numSamples>>1,u=0;u<l;++u){var c=i.getFreeFragmentConstant();a.push(c+".xy"),a.push(c+".zw")}var h=i.getFreeFragmentVectorTemp();for(u=0;u<this._method.numSamples;++u)o+=0==u?"add "+s+", "+this._baseChunk.depthMapCoordReg+", "+r+".zwyy\n"+this._baseTexture._getFragmentCode(e,i,n,s):"add "+s+".xy, "+this._baseChunk.depthMapCoordReg+".xy, "+a[u]+"\n"+this._baseTexture._getFragmentCode(h,i,n,s)+"add "+e+".w, "+e+".w, "+h+".w\n";return i.removeFragmentTempUsage(s),o+="mul "+e+".w, "+e+".w, "+r+".x\n"+t.prototype._getFragmentCode.call(this,e,i,n)},e}(xu);Kn.registerAbstraction(Pu,Tu);var Bu=function(t){function e(){var e=t.call(this)||this;return e._gloss=50,e._strength=1,e._color=16777215,e}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gloss",{get:function(){return this._gloss},set:function(t){this._gloss!=t&&(this._gloss=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength!=t&&(this._strength=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t,0==this._color||0==t?this.invalidateShaderProgram():this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!=t&&(this._texture&&this.iRemoveTexture(this._texture),this._texture=t,this._texture&&this.iAddTexture(this._texture),this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._texture=null},e.prototype.copyFrom=function(t){var e=t;this.texture=e.texture,this.strength=e.strength,this.color=e.color,this.gloss=e.gloss},e.assetType="[asset SpecularBasicMethod]",e}(gl),Mu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n}return i(e,t),e.prototype._isUsed=function(){return!!this._shader.numLights},e.prototype._initVO=function(t){t.needsNormals=this._shader.numLights>0,t.needsView=this._shader.numLights>0,this._method.texture?(this._texture=this._method.texture.getAbstraction(this._shader),this._texture._initVO(t),this._shader.uvDependencies++):this._texture&&(this._texture=null)},e.prototype._initConstants=function(){this._method.texture&&this._texture._initConstants()},e.prototype._cleanCompilationData=function(){t.prototype._cleanCompilationData.call(this),this._totalLightColorReg=null,this._specularTexData=null,this._specularDataRegister=null},e.prototype._getFragmentPreLightingCode=function(t,e){var i="";return this._pIsFirstLight=!0,this._specularDataRegister=t.getFreeFragmentConstant(),this._specularDataIndex=4*this._specularDataRegister.index,this._texture&&(this._specularTexData=t.getFreeFragmentVectorTemp(),t.addFragmentTempUsages(this._specularTexData,1),i+=this._texture._getFragmentCode(this._specularTexData,t,e,e.uvVarying)),this._totalLightColorReg=t.getFreeFragmentVectorTemp(),t.addFragmentTempUsages(this._totalLightColorReg,1),i},e.prototype._getFragmentCodePerLight=function(t,e,i,n){var r,o="";return this._pIsFirstLight?r=this._totalLightColorReg:(r=i.getFreeFragmentVectorTemp(),i.addFragmentTempUsages(r,1)),o+="add "+r+", "+t+", "+n.viewDirFragment+"\nnrm "+r+".xyz, "+r+"\ndp3 "+r+".w, "+n.normalFragment+", "+r+"\nsat "+r+".w, "+r+".w\n",this._texture?o+="mul "+this._specularTexData+".w, "+this._specularTexData+".y, "+this._specularDataRegister+".w\npow "+r+".w, "+r+".w, "+this._specularTexData+".w\n":o+="pow "+r+".w, "+r+".w, "+this._specularDataRegister+".w\n",this._shader.usesLightFallOff&&(o+="mul "+r+".w, "+r+".w, "+t+".w\n"),null!=this._modulateFunction&&(o+=this._modulateFunction(r,i,n)),o+="mul "+r+".xyz, "+e+", "+r+".w\n",this._pIsFirstLight||(o+="add "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+", "+r+"\n",i.removeFragmentTempUsage(r)),this._pIsFirstLight=!1,o},e.prototype._getFragmentCodePerProbe=function(t,e,i,n){var r,o="";this._pIsFirstLight?r=this._totalLightColorReg:(r=i.getFreeFragmentVectorTemp(),i.addFragmentTempUsages(r,1));var s=n.normalFragment,a=n.viewDirFragment;return o+="dp3 "+r+".w, "+s+", "+a+"\nadd "+r+".w, "+r+".w, "+r+".w\nmul "+r+", "+r+".w, "+s+"\nsub "+r+", "+r+", "+a+"\ntex "+r+", "+r+", "+t+" <cube,linear,miplinear>\nmul "+r+".xyz, "+r+", "+e+"\n",null!=this._modulateFunction&&(o+=this._modulateFunction(r,i,n)),this._pIsFirstLight||(o+="add "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+", "+r+"\n",i.removeFragmentTempUsage(r)),this._pIsFirstLight=!1,o},e.prototype._getFragmentCode=function(t,e,i){var n="";return i.shadowTarget&&(n+="mul "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+", "+i.shadowTarget+".w\n"),this._texture&&(n+="mul "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+", "+this._specularTexData+".x\n",e.removeFragmentTempUsage(this._specularTexData)),n+="mul "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+", "+this._specularDataRegister+"\nadd "+t+".xyz, "+t+", "+this._totalLightColorReg+"\n",e.removeFragmentTempUsage(this._totalLightColorReg),n},e.prototype._activate=function(){if(this._texture&&this._texture.activate(),this._invalid){var t=this._specularDataIndex,e=this._shader.fragmentConstantData;e[t]=(this._method.color>>16&255)/255*this._method.strength,e[t+1]=(this._method.color>>8&255)/255*this._method.strength,e[t+2]=(255&this._method.color)/255*this._method.strength,e[t+3]=this._method.gloss}},e.prototype._setRenderState=function(t){this._texture&&this._texture._setRenderState(t)},e}(yl);Kn.registerAbstraction(Mu,Bu);var Ou=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[asset SpecularAnisotropicMethod]",e}(Bu),Lu=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._initVO=function(e){t.prototype._initVO.call(this,e),e.needsTangents=this._shader.numLights>0},e.prototype._getFragmentCodePerLight=function(t,e,i,n){var r,o="";return this._pIsFirstLight?r=this._totalLightColorReg:(r=i.getFreeFragmentVectorTemp(),i.addFragmentTempUsages(r,1)),o+="nrm "+r+".xyz, "+n.tangentVarying+".xyz\ndp3 "+r+".w, "+r+".xyz, "+t+".xyz\ndp3 "+r+".z, "+r+".xyz, "+n.viewDirFragment+".xyz\n",o+="sin "+r+".x, "+r+".w\nsin "+r+".y, "+r+".z\nmul "+r+".x, "+r+".x, "+r+".y\ncos "+r+".z, "+r+".z\ncos "+r+".w, "+r+".w\nmul "+r+".w, "+r+".w, "+r+".z\nsub "+r+".w, "+r+".x, "+r+".w\n",this._texture?o+="mul "+this._specularTexData+".w, "+this._specularTexData+".y, "+this._specularDataRegister+".w\npow "+r+".w, "+r+".w, "+this._specularTexData+".w\n":o+="pow "+r+".w, "+r+".w, "+this._specularDataRegister+".w\n",o+="mul "+r+".w, "+r+".w, "+t+".w\n",null!=this._modulateFunction&&(o+=this._modulateFunction(r,i,n)),o+="mul "+r+".xyz, "+e+".xyz, "+r+".w\n",this._pIsFirstLight||(o+="add "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+".xyz, "+r+".xyz\n",i.removeFragmentTempUsage(r)),this._pIsFirstLight=!1,o},e}(Mu);Kn.registerAbstraction(Lu,Ou);var Ru=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return i(e,t),e.prototype.createBaseMethod=function(){return new Bu},Object.defineProperty(e.prototype,"gloss",{get:function(){return this._baseMethod.gloss},set:function(t){this._baseMethod.gloss=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._baseMethod.strength},set:function(t){this._baseMethod.strength=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._baseMethod.color},set:function(t){this._baseMethod.color=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._baseMethod.texture},set:function(t){this._baseMethod.texture=t},enumerable:!0,configurable:!0}),e}(Rl),Nu=function(t){function e(e,i,n){void 0===e&&(e=.5),void 0===i&&(i=.1),void 0===n&&(n=null);var r=t.call(this,n)||this;return r._specularCutOff=e,r._smoothness=i,r}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smoothness",{get:function(){return this._smoothness},set:function(t){this._smoothness!=t&&(this._smoothness=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specularCutOff",{get:function(){return this._specularCutOff},set:function(t){this._specularCutOff!=t&&(this._specularCutOff=t,this.invalidate())},enumerable:!0,configurable:!0}),e.assetType="[asset SpecularCelMethod]",e}(Ru),Fu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n._baseChunk._modulateFunction=function(t,e,i){return n.clampSpecular(t,e,i)},n}return i(e,t),e.prototype._activate=function(){if(t.prototype._activate.call(this),this._invalid){var e=this._cutoffDataIndex,i=this._shader.fragmentConstantData;i[e]=this._method.smoothness,i[e+1]=this._method.specularCutOff}},e.prototype._cleanCompilationData=function(){t.prototype._cleanCompilationData.call(this),this._cutoffDataRegister=null},e.prototype.clampSpecular=function(t,e,i){return"sub "+t+".y, "+t+".w, "+this._cutoffDataRegister+".y\ndiv "+t+".y, "+t+".y, "+this._cutoffDataRegister+".x\nsat "+t+".y, "+t+".y\nsge "+t+".w, "+t+".w, "+this._cutoffDataRegister+".y\nmul "+t+".w, "+t+".w, "+t+".y\n"},e.prototype._getFragmentPreLightingCode=function(e,i){return this._cutoffDataRegister=e.getFreeFragmentConstant(),this._cutoffDataIndex=4*this._cutoffDataRegister.index,t.prototype._getFragmentPreLightingCode.call(this,e,i)},e}(Fl);Kn.registerAbstraction(Fu,Nu);var ku=function(t){function e(e,i,n,r){void 0===e&&(e=!0),void 0===i&&(i=5),void 0===n&&(n=.028),void 0===r&&(r=null);var o=t.call(this,r)||this;return o._basedOnSurface=e,o._fresnelPower=i,o._normalReflectance=n,o}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"basedOnSurface",{get:function(){return this._basedOnSurface},set:function(t){this._basedOnSurface!=t&&(this._basedOnSurface=t,this.invalidateShaderProgram())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fresnelPower",{get:function(){return this._fresnelPower},set:function(t){this._fresnelPower!=t&&(this._fresnelPower=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalReflectance",{get:function(){return this._normalReflectance},set:function(t){this._normalReflectance!=t&&(this._normalReflectance=t,this.invalidate())},enumerable:!0,configurable:!0}),e.assetType="[asset SpecularFresnelMethod]",e}(Ru),Vu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._method=e,n._shader=i,n._baseChunk._modulateFunction=function(t,e,i){return n.modulateSpecular(t,e,i)},n}return i(e,t),e.prototype._cleanCompilationData=function(){t.prototype._cleanCompilationData.call(this),this._fresnelDataRegister=null},e.prototype._activate=function(){if(t.prototype._activate.call(this),this._invalid){var e=this._shader.fragmentConstantData,i=this._fresnelDataIndex;e[i]=this._method.normalReflectance,e[i+1]=this._method.fresnelPower,e[i+2]=1,e[i+3]=0}},e.prototype._getFragmentPreLightingCode=function(e,i){return this._fresnelDataRegister=e.getFreeFragmentConstant(),this._fresnelDataIndex=4*this._fresnelDataRegister.index,t.prototype._getFragmentPreLightingCode.call(this,e,i)},e.prototype.modulateSpecular=function(t,e,i){return"dp3 "+t+".y, "+i.viewDirFragment+".xyz, "+(this._method.basedOnSurface?i.normalFragment:t)+".xyz\nsub "+t+".y, "+this._fresnelDataRegister+".z, "+t+".y\npow "+t+".x, "+t+".y, "+this._fresnelDataRegister+".y\nsub "+t+".y, "+this._fresnelDataRegister+".z, "+t+".y\nmul "+t+".y, "+this._fresnelDataRegister+".x, "+t+".y\nadd "+t+".y, "+t+".x, "+t+".y\nmul "+t+".w, "+t+".w, "+t+".y\n"},e}(Fl);Kn.registerAbstraction(Vu,ku);var Uu=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[asset SpecularPhongMethod]",e}(Bu),ju=function(t){function e(e,i){return t.call(this,e,i)||this}return i(e,t),e.prototype._getFragmentCodePerLight=function(t,e,i,n){var r,o="";this._pIsFirstLight?r=this._totalLightColorReg:(r=i.getFreeFragmentVectorTemp(),i.addFragmentTempUsages(r,1));var s=n.viewDirFragment,a=n.normalFragment;return o+="dp3 "+r+".w, "+t+", "+a+"\nadd "+r+".w, "+r+".w, "+r+".w\nmul "+r+".xyz, "+a+", "+r+".w\nsub "+r+".xyz, "+r+", "+t+"\nadd "+r+".w, "+r+".w, "+n.commons+".w\nsat "+r+".w, "+r+".w\nmul "+r+".xyz, "+r+", "+r+".w\ndp3 "+r+".w, "+r+", "+s+"\nsat "+r+".w, "+r+".w\n",this._texture?o+="mul "+this._specularTexData+".w, "+this._specularTexData+".y, "+this._specularDataRegister+".w\npow "+r+".w, "+r+".w, "+this._specularTexData+".w\n":o+="pow "+r+".w, "+r+".w, "+this._specularDataRegister+".w\n",this._shader.usesLightFallOff&&(o+="mul "+r+".w, "+r+".w, "+t+".w\n"),null!=this._modulateFunction&&(o+=this._modulateFunction(r,i,n)),o+="mul "+r+".xyz, "+e+".xyz, "+r+".w\n",this._pIsFirstLight||(o+="add "+this._totalLightColorReg+".xyz, "+this._totalLightColorReg+".xyz, "+r+".xyz\n",i.removeFragmentTempUsage(r)),this._pIsFirstLight=!1,o},e}(Mu);Kn.registerAbstraction(ju,Uu);var Gu=function(){function t(){}return t.LIGHTS=1,t.PROBES=2,t.ALL=3,t}(),Qu=function(t){function e(e,i){var n=t.call(this)||this;return n._preserveAlpha=!0,n._forceSeparateMVP=!1,n._renderMaterial=e,n._renderElements=i,n._stage=i.stage,n}return i(e,t),Object.defineProperty(e.prototype,"shader",{get:function(){return this._shader},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preserveAlpha",{get:function(){return this._preserveAlpha},set:function(t){this._preserveAlpha!=t&&(this._preserveAlpha=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forceSeparateMVP",{get:function(){return this._forceSeparateMVP},set:function(t){this._forceSeparateMVP!=t&&(this._forceSeparateMVP=t,this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.invalidate=function(){this._shader.invalidateProgram(),this.dispatchEvent(new Wn(Wn.INVALIDATE,this))},e.prototype.dispose=function(){this._renderMaterial=null,this._renderElements=null,this._stage=null,this._shader&&(this._shader.dispose(),this._shader=null)},e.prototype._setRenderState=function(t){this._shader._setRenderState(t)},e.prototype._activate=function(){this._shader._activate()},e.prototype._deactivate=function(){this._shader._deactivate()},e.prototype._includeDependencies=function(t){t.alphaThreshold=this._renderMaterial.material.alphaThreshold,t.useImageRect=this._renderMaterial.material.imageRect,t.usesCurves=this._renderMaterial.material.curves,t.useBothSides=this._renderMaterial.material.bothSides,t.usesUVTransform=this._renderMaterial.material.animateUVs,t.usesColorTransform=this._renderMaterial.material.useColorTransform,this._forceSeparateMVP&&this._shader.globalPosDependencies++},e.prototype._initConstantData=function(){},e.prototype._getVertexCode=function(t,e){return""},e.prototype._getFragmentCode=function(t,e){return""},e.prototype._getPostAnimationFragmentCode=function(t,e){return""},e.prototype._getNormalVertexCode=function(t,e){return""},e.prototype._getNormalFragmentCode=function(t,e){return""},e}(u),zu=function(t){function e(e,i,n,r){var o=t.call(this,e,i,n,r)||this;return o._includeCasters=!0,o._lightingPass=n,o}return i(e,t),e.prototype._includeDependencies=function(){this.numPointLights=this._lightingPass.numPointLights,this.numDirectionalLights=this._lightingPass.numDirectionalLights,this.numLightProbes=this._lightingPass.numLightProbes;var e=this._lightingPass.numPointLights+this._lightingPass.numDirectionalLights,i=this._lightingPass.numLightProbes,n=this._lightingPass._iUsesDiffuse(this)?this._lightingPass.diffuseLightSources:0,r=this._lightingPass._iUsesSpecular(this)?this._lightingPass.specularLightSources:0,o=n|r;this.usesLightFallOff=this._lightingPass.enableLightFallOff&&this.profile!=Vt.BASELINE_CONSTRAINED,this.usesCommonData=this.usesLightFallOff||this.usesCommonData,this.numLights=e+i,this.usesLights=e>0&&0!=(o&Gu.LIGHTS),this.usesProbes=i>0&&0!=(o&Gu.PROBES),this.usesLightsForSpecular=e>0&&0!=(r&Gu.LIGHTS),this.usesProbesForSpecular=i>0&&0!=(r&Gu.PROBES),this.usesLightsForDiffuse=e>0&&0!=(n&Gu.LIGHTS),this.usesProbesForDiffuse=i>0&&0!=(n&Gu.PROBES),this.usesShadows=this._lightingPass._iUsesShadows(this),t.prototype._includeDependencies.call(this)},e.prototype._setRenderState=function(e){t.prototype._setRenderState.call(this,e),this._lightingPass.lightPicker&&this._lightingPass.lightPicker.collectLights(e.sourceEntity),this.usesLights&&this.updateLights(),this.usesProbes&&this.updateProbes()},e.prototype._initRegisterIndices=function(){if(t.prototype._initRegisterIndices.call(this),this.lightVertexConstantIndex=-1,this.lightFragmentConstantIndex=-1,this.probeWeightsIndex=-1,this._numProbeRegisters=Math.ceil(this.numLightProbes/4),this.usesTangentSpace||!this.usesGlobalPosFragment?(this._pointLightVertexConstants=new Array(this.numPointLights),this._pointLightFragmentConstants=new Array(2*this.numPointLights)):(this._pointLightVertexConstants=null,this._pointLightFragmentConstants=new Array(3*this.numPointLights)),this.usesTangentSpace?(this._dirLightVertexConstants=new Array(this.numDirectionalLights),this._dirLightFragmentConstants=new Array(2*this.numDirectionalLights)):(this._dirLightVertexConstants=null,this._dirLightFragmentConstants=new Array(3*this.numDirectionalLights)),this.usesLights){var e=void 0,i=void 0;if(this._dirLightVertexConstants)for(i=this._dirLightVertexConstants.length,e=0;e<i;++e)this._dirLightVertexConstants[e]=this._registerCache.getFreeVertexConstant(),-1==this.lightVertexConstantIndex&&(this.lightVertexConstantIndex=4*this._dirLightVertexConstants[e].index);if(this._pointLightVertexConstants)for(i=this._pointLightVertexConstants.length,e=0;e<i;++e)this._pointLightVertexConstants[e]=this._registerCache.getFreeVertexConstant(),-1==this.lightVertexConstantIndex&&(this.lightVertexConstantIndex=4*this._pointLightVertexConstants[e].index);for(i=this._dirLightFragmentConstants.length,e=0;e<i;++e)this._dirLightFragmentConstants[e]=this._registerCache.getFreeFragmentConstant(),-1==this.lightFragmentConstantIndex&&(this.lightFragmentConstantIndex=4*this._dirLightFragmentConstants[e].index);for(i=this._pointLightFragmentConstants.length,e=0;e<i;++e)this._pointLightFragmentConstants[e]=this._registerCache.getFreeFragmentConstant(),-1==this.lightFragmentConstantIndex&&(this.lightFragmentConstantIndex=4*this._pointLightFragmentConstants[e].index)}},e.prototype._compileDependencies=function(){t.prototype._compileDependencies.call(this),this._vertexCode+=this._lightingPass._getPreLightingVertexCode(this._registerCache,this._sharedRegisters),this._postAnimationFragmentCode+=this._lightingPass._getPreLightingFragmentCode(this._registerCache,this._sharedRegisters),this.usesShadows&&this._compileShadowCode(),this.usesLights&&this._compileLightCode(),this.usesProbes&&this._compileLightProbeCode()},e.prototype._compileShadowCode=function(){this.normalDependencies>0?this._sharedRegisters.shadowTarget=this._sharedRegisters.normalFragment:(this._sharedRegisters.shadowTarget=this._registerCache.getFreeFragmentVectorTemp(),this._registerCache.addFragmentTempUsages(this._sharedRegisters.shadowTarget,1))},e.prototype._compileLightCode=function(){for(var t,e,i,n,r=0,o=0,s=this.usesLightsForSpecular,a=this.usesLightsForDiffuse,l=0;l<this.numDirectionalLights;++l){if(this.usesTangentSpace){n=this._dirLightVertexConstants[r++];var u=this._registerCache.getFreeVarying();this._vertexCode+="m33 "+u+".xyz, "+n+", "+this._sharedRegisters.animatedTangent+"\nmov "+u+".w, "+n+".w\n",n=this._registerCache.getFreeFragmentVectorTemp(),this._registerCache.addVertexTempUsages(n,1),this._postAnimationFragmentCode+="nrm "+n+".xyz, "+u+"\nmov "+n+".w, "+u+".w\n"}else n=this._dirLightFragmentConstants[o++];t=this._dirLightFragmentConstants[o++],e=this._dirLightFragmentConstants[o++],a&&(this._postAnimationFragmentCode+=this._lightingPass._getPerLightDiffuseFragmentCode(n,t,this._registerCache,this._sharedRegisters)),s&&(this._postAnimationFragmentCode+=this._lightingPass._getPerLightSpecularFragmentCode(n,e,this._registerCache,this._sharedRegisters)),this.usesTangentSpace&&this._registerCache.removeVertexTempUsage(n)}r=0,o=0;for(l=0;l<this.numPointLights;++l){if(i=this.usesTangentSpace||!this.usesGlobalPosFragment?this._pointLightVertexConstants[r++]:this._pointLightFragmentConstants[o++],t=this._pointLightFragmentConstants[o++],e=this._pointLightFragmentConstants[o++],n=this._registerCache.getFreeFragmentVectorTemp(),this._registerCache.addFragmentTempUsages(n,1),this.usesTangentSpace){u=this._registerCache.getFreeVarying();var c=this._registerCache.getFreeVertexVectorTemp();this._vertexCode+="sub "+c+", "+i+", "+this._sharedRegisters.animatedPosition+"\nm33 "+u+".xyz, "+c+", "+this._sharedRegisters.animatedTangent+"\nmov "+u+".w, "+this._sharedRegisters.animatedPosition+".w\n"}else this.usesGlobalPosFragment?(u=n,this._postAnimationFragmentCode+="sub "+n+", "+i+", "+this._sharedRegisters.globalPositionVarying+"\n"):(u=this._registerCache.getFreeVarying(),this._vertexCode+="sub "+u+", "+i+", "+this._sharedRegisters.globalPositionVertex+"\n");this.usesLightFallOff?this._postAnimationFragmentCode+="dp3 "+n+".w, "+u+", "+u+"\nsub "+n+".w, "+n+".w, "+t+".w\nmul "+n+".w, "+n+".w, "+e+".w\nsat "+n+".w, "+n+".w\nsub "+n+".w, "+this._sharedRegisters.commons+".w, "+n+".w\nnrm "+n+".xyz, "+u+"\n":this._postAnimationFragmentCode+="nrm "+n+".xyz, "+u+"\nmov "+n+".w, "+u+".w\n",-1==this.lightFragmentConstantIndex&&(this.lightFragmentConstantIndex=4*i.index),a&&(this._postAnimationFragmentCode+=this._lightingPass._getPerLightDiffuseFragmentCode(n,t,this._registerCache,this._sharedRegisters)),s&&(this._postAnimationFragmentCode+=this._lightingPass._getPerLightSpecularFragmentCode(n,e,this._registerCache,this._sharedRegisters)),this._registerCache.removeFragmentTempUsage(n)}},e.prototype._compileLightProbeCode=function(){var t,e,i,n=[".x",".y",".z",".w"],r=new Array,o=this.usesProbesForSpecular,s=this.usesProbesForDiffuse;for(s&&(this.lightProbeDiffuseIndices=new Array),o&&(this.lightProbeSpecularIndices=new Array),e=0;e<this._numProbeRegisters;++e)r[e]=this._registerCache.getFreeFragmentConstant(),0==e&&(this.probeWeightsIndex=4*r[e].index);for(e=0;e<this.numLightProbes;++e)t=r[Math.floor(e/4)].toString()+n[e%4],s&&(i=this._registerCache.getFreeTextureReg(),this.lightProbeDiffuseIndices[e]=i.index,this._postAnimationFragmentCode+=this._lightingPass._getPerProbeDiffuseFragmentCode(i,t,this._registerCache,this._sharedRegisters)),o&&(i=this._registerCache.getFreeTextureReg(),this.lightProbeSpecularIndices[e]=i.index,this._postAnimationFragmentCode+=this._lightingPass._getPerProbeSpecularFragmentCode(i,t,this._registerCache,this._sharedRegisters))},e.prototype.updateLights=function(){var t,e,i,n,r,o,s=0,a=0,l=0,u=this.usesShadows?2:1;this.ambientR=this.ambientG=this.ambientB=0,r=this.lightVertexConstantIndex,a=this.lightFragmentConstantIndex;var c=0,h=this._lightingPass.lightPicker.directionalLights;for((o=this._lightingPass.directionalLightsOffset)>(i=this._lightingPass.lightPicker.directionalLights.length)&&(c=1,o-=i);c<u;++c)for(c&&(h=this._lightingPass.lightPicker.castingDirectionalLights),(i=h.length)>this.numDirectionalLights&&(i=this.numDirectionalLights),s=0;s<i;++s){if(n=(t=h[o+s]).sceneDirection,this.ambientR+=t._ambientR,this.ambientG+=t._ambientG,this.ambientB+=t._ambientB,this.usesTangentSpace){var p=-n.x,d=-n.y,f=-n.z;this.vertexConstantData[r++]=this._pInverseSceneMatrix[0]*p+this._pInverseSceneMatrix[4]*d+this._pInverseSceneMatrix[8]*f,this.vertexConstantData[r++]=this._pInverseSceneMatrix[1]*p+this._pInverseSceneMatrix[5]*d+this._pInverseSceneMatrix[9]*f,this.vertexConstantData[r++]=this._pInverseSceneMatrix[2]*p+this._pInverseSceneMatrix[6]*d+this._pInverseSceneMatrix[10]*f,this.vertexConstantData[r++]=1}else this.fragmentConstantData[a++]=-n.x,this.fragmentConstantData[a++]=-n.y,this.fragmentConstantData[a++]=-n.z,this.fragmentConstantData[a++]=1;this.fragmentConstantData[a++]=t._diffuseR,this.fragmentConstantData[a++]=t._diffuseG,this.fragmentConstantData[a++]=t._diffuseB,this.fragmentConstantData[a++]=1,this.fragmentConstantData[a++]=t._specularR,this.fragmentConstantData[a++]=t._specularG,this.fragmentConstantData[a++]=t._specularB,this.fragmentConstantData[a++]=1,++l==this.numDirectionalLights&&(s=i,c=u)}if(this.numDirectionalLights>l)for(s=a+12*(this.numDirectionalLights-l);a<s;)this.fragmentConstantData[a++]=0;l=0;var _=this._lightingPass.lightPicker.pointLights;for((o=this._lightingPass.pointLightsOffset)>(i=this._lightingPass.lightPicker.pointLights.length)?(c=1,o-=i):c=0;c<u;++c)for(c&&(_=this._lightingPass.lightPicker.castingPointLights),i=_.length,s=0;s<i;++s){n=(e=_[o+s]).transform.concatenatedMatrix3D.position,this.ambientR+=e._ambientR,this.ambientG+=e._ambientG,this.ambientB+=e._ambientB,this.usesTangentSpace?(p=n.x,d=n.y,f=n.z,this.vertexConstantData[r++]=this._pInverseSceneMatrix[0]*p+this._pInverseSceneMatrix[4]*d+this._pInverseSceneMatrix[8]*f+this._pInverseSceneMatrix[12],this.vertexConstantData[r++]=this._pInverseSceneMatrix[1]*p+this._pInverseSceneMatrix[5]*d+this._pInverseSceneMatrix[9]*f+this._pInverseSceneMatrix[13],this.vertexConstantData[r++]=this._pInverseSceneMatrix[2]*p+this._pInverseSceneMatrix[6]*d+this._pInverseSceneMatrix[10]*f+this._pInverseSceneMatrix[14],this.vertexConstantData[r++]=1):this.usesGlobalPosFragment?(this.fragmentConstantData[a++]=n.x,this.fragmentConstantData[a++]=n.y,this.fragmentConstantData[a++]=n.z,this.fragmentConstantData[a++]=1):(this.vertexConstantData[r++]=n.x,this.vertexConstantData[r++]=n.y,this.vertexConstantData[r++]=n.z,this.vertexConstantData[r++]=1),this.fragmentConstantData[a++]=e._diffuseR,this.fragmentConstantData[a++]=e._diffuseG,this.fragmentConstantData[a++]=e._diffuseB;var m=e.radius;this.fragmentConstantData[a++]=m*m,this.fragmentConstantData[a++]=e._specularR,this.fragmentConstantData[a++]=e._specularG,this.fragmentConstantData[a++]=e._specularB,this.fragmentConstantData[a++]=e.fallOffFactor,++l==this.numPointLights&&(s=i,c=u)}if(this.numPointLights>l)for(s=a+12*(l-this.numPointLights);a<s;++a)this.fragmentConstantData[a]=0},e.prototype.updateProbes=function(){var t,e=this._lightingPass.lightPicker.lightProbes,i=this._lightingPass.lightPicker.lightProbeWeights,n=e.length-this._lightingPass.lightProbesOffset,r=this.usesProbesForDiffuse,o=this.usesProbesForSpecular;if(r||o){n>this.numLightProbes&&(n=this.numLightProbes);for(var s=0;s<n;++s)t=e[this._lightingPass.lightProbesOffset+s],r&&t.diffuseMap.getAbstraction(this).activate(this.lightProbeDiffuseIndices[s],t.diffuseSampler),o&&t.specularMap.getAbstraction(this).activate(this.lightProbeSpecularIndices[s],t.diffuseSampler);for(s=0;s<n;++s)this.fragmentConstantData[this.probeWeightsIndex+s]=i[this._lightingPass.lightProbesOffset+s]}},e}(Kn),Hu=function(){function t(){}return t.EFFECTS=1,t.LIGHTING=2,t.SUPER_SHADER=3,t}(),Xu=function(t){function e(e,i,n){var r=t.call(this,i,n)||this;return r._maxLights=3,r._mode=3,r._includeCasters=!0,r._chunks=new Array,r._methods=new Array,r._numEffectDependencies=0,r.numDirectionalLights=0,r.numPointLights=0,r.numLightProbes=0,r.pointLightsOffset=0,r.directionalLightsOffset=0,r.lightProbesOffset=0,r._mode=e,r._onLightsChangeDelegate=function(t){return r.onLightsChange(t)},r._onMethodInvalidatedDelegate=function(t){return r.onMethodInvalidated(t)},r.lightPicker=i.lightPicker,null==r._shader&&r._updateShader(),r}return i(e,t),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode!=t&&(this._mode=t,this._updateLights())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"includeCasters",{get:function(){return this._includeCasters},set:function(t){this._includeCasters!=t&&(this._includeCasters=t,this._updateLights())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._lightPicker},set:function(t){this._lightPicker&&this._lightPicker.removeEventListener(l.INVALIDATE,this._onLightsChangeDelegate),this._lightPicker=t,this._lightPicker&&this._lightPicker.addEventListener(l.INVALIDATE,this._onLightsChangeDelegate),this._updateLights()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableLightFallOff",{get:function(){return this._renderMaterial.enableLightFallOff},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diffuseLightSources",{get:function(){return this._renderMaterial.diffuseLightSources},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specularLightSources",{get:function(){return this._renderMaterial.specularLightSources},enumerable:!0,configurable:!0}),e.prototype._updateShader=function(){!(this.numDirectionalLights||this.numPointLights||this.numLightProbes)||this._shader instanceof zu?null==this._shader&&(null!=this._shader&&(this._shader.dispose(),this._shader=null),this._shader=new Kn(this._renderElements,this._renderMaterial,this,this._stage)):(null!=this._shader&&(this._shader.dispose(),this._shader=null),this._shader=new zu(this._renderElements,this._renderMaterial,this,this._stage))},e.prototype._initConstantData=function(){for(var t=this._chunks.length,e=0;e<t;++e)this._chunks[e]._initConstants()},Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this.colorTransformMethod?this.colorTransformMethod.colorTransform:null},set:function(t){t?(null==this.colorTransformMethod&&(this.colorTransformMethod=new $l),this.colorTransformMethod.colorTransform=t):t||this.colorTransformMethod&&(this.colorTransformMethod=null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorTransformMethod",{get:function(){return this._colorTransformMethod},set:function(t){this._colorTransformMethod!=t&&(this._colorTransformMethod&&(this._removeDependency(this._colorTransformMethod),this._colorTransformChunk=null),this._colorTransformMethod=t,t&&(this._colorTransformChunk=t.getAbstraction(this._shader),this._addDependency(t)))},enumerable:!0,configurable:!0}),e.prototype._removeDependency=function(t,e){void 0===e&&(e=!1);var i=this._methods.indexOf(t);-1!=i&&(e||this._numEffectDependencies--,t.removeEventListener(ol.SHADER_INVALIDATED,this._onMethodInvalidatedDelegate),this._methods.splice(i,1),this._chunks.splice(i,1),this.invalidate())},e.prototype._addDependency=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=-1),t.addEventListener(ol.SHADER_INVALIDATED,this._onMethodInvalidatedDelegate);var n=t.getAbstraction(this._shader);e?(-1!=i?(this._methods.splice(i+this._methods.length-this._numEffectDependencies,0,t),this._chunks.splice(i+this._chunks.length-this._numEffectDependencies,0,n)):(this._methods.push(t),this._chunks.push(n)),this._numEffectDependencies++):(this._methods.splice(this._methods.length-this._numEffectDependencies,0,t),this._chunks.splice(this._chunks.length-this._numEffectDependencies,0,n)),this.invalidate()},e.prototype.addEffectMethod=function(t){this._addDependency(t,!0)},Object.defineProperty(e.prototype,"numEffectMethods",{get:function(){return this._numEffectDependencies},enumerable:!0,configurable:!0}),e.prototype.hasEffectMethod=function(t){return-1!=this._methods.indexOf(t)},e.prototype.getEffectMethodAt=function(t){return t<0||t>this._numEffectDependencies-1?null:this._methods[t+this._methods.length-this._numEffectDependencies]},e.prototype.addEffectMethodAt=function(t,e){this._addDependency(t,!0,e)},e.prototype.removeEffectMethod=function(t){this._removeDependency(t,!0)},e.prototype.removeEffectMethodAt=function(t){var e=this.getEffectMethodAt(t);null!=e&&this._removeDependency(e,!0)},Object.defineProperty(e.prototype,"normalMethod",{get:function(){return this._normalMethod},set:function(t){this._normalMethod!=t&&(this._normalMethod&&(this._removeDependency(this._normalMethod),this._normalChunk=null),this._normalMethod=t,t&&(this._normalChunk=t.getAbstraction(this._shader),this._addDependency(t)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ambientMethod",{get:function(){return this._ambientMethod},set:function(t){this._ambientMethod!=t&&(this._ambientMethod&&(this._removeDependency(this._ambientMethod),this._ambientChunk=null),this._ambientMethod=t,t&&(this._ambientChunk=t.getAbstraction(this._shader),this._addDependency(t)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowMethod",{get:function(){return this._shadowMethod},set:function(t){this._shadowMethod!=t&&(this._shadowMethod&&(this._removeDependency(this._shadowMethod),this._shadowChunk=null),this._shadowMethod=t,t&&(this._shadowChunk=t.getAbstraction(this._shader),this._addDependency(t)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diffuseMethod",{get:function(){return this._diffuseMethod},set:function(t){this._diffuseMethod!=t&&(this._diffuseMethod&&(this._removeDependency(this._diffuseMethod),this._diffuseChunk=null),t&&(this._diffuseChunk=t.getAbstraction(this._shader),this._addDependency(t)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specularMethod",{get:function(){return this._specularMethod},set:function(t){this._specularMethod!=t&&(this._specularMethod&&(this._removeDependency(this._specularMethod),this._specularChunk=null),t&&(this._specularChunk=t.getAbstraction(this._shader),this._addDependency(t)))},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){for(this._lightPicker&&this._lightPicker.removeEventListener(l.INVALIDATE,this._onLightsChangeDelegate);this._methods.length;)this._removeDependency(this._methods[0]);t.prototype.dispose.call(this),this._chunks=null,this._methods=null},e.prototype.onMethodInvalidated=function(t){this.invalidate()},e.prototype._activate=function(){var e;t.prototype._activate.call(this);for(var i=this._chunks.length,n=0;n<i;++n)(e=this._chunks[n]).chunkVO.useChunk&&e._activate()},e.prototype._setRenderState=function(e){var i;t.prototype._setRenderState.call(this,e);for(var n=this._chunks.length,r=0;r<n;++r)(i=this._chunks[r]).chunkVO.useChunk&&i._setRenderState(e)},e.prototype._deactivate=function(){var e;t.prototype._deactivate.call(this);for(var i=this._chunks.length,n=0;n<i;++n)(e=this._chunks[n]).chunkVO.useChunk&&e._deactivate()},e.prototype._includeDependencies=function(e){var i;t.prototype._includeDependencies.call(this,e),e.usesFragmentAnimation=Boolean(this._mode==Hu.SUPER_SHADER);var n=this._chunks.length;for(i=0;i<n;++i)this.setupAndCountDependencies(e,this._chunks[i]);var r,o=!0;for(i=0;i<n;++i)((r=this._chunks[i]).chunkVO.useChunk=r._isUsed())&&!r._usesTangentSpace()&&(o=!1);e.outputsNormals=this._normalChunk&&this._normalChunk.chunkVO.useChunk,e.outputsTangentNormals=e.outputsNormals&&this._normalChunk._outputsTangentNormals(),e.usesTangentSpace=e.outputsTangentNormals&&!e.usesProbes&&o,e.usesTangentSpace||(e.viewDirDependencies>0?e.globalPosDependencies++:this.numPointLights>0&&e.usesLights&&(e.globalPosDependencies++,this._mode&Hu.EFFECTS&&(e.usesGlobalPosFragment=!0)))},e.prototype.setupAndCountDependencies=function(t,e){var i=e.chunkVO;e._reset(i),e._initVO(i),i.needsProjection&&t.projectionDependencies++,(i.needsGlobalVertexPos||i.needsGlobalFragmentPos)&&(t.globalPosDependencies++,i.needsGlobalFragmentPos&&(t.usesGlobalPosFragment=!0)),i.needsNormals&&t.normalDependencies++,i.needsTangents&&t.tangentDependencies++,i.needsView&&t.viewDirDependencies++},e.prototype._getPreLightingVertexCode=function(t,e){return""},e.prototype._getPreLightingFragmentCode=function(t,e){var i="";return this._diffuseChunk&&this._diffuseChunk.chunkVO.useChunk&&(i+=this._diffuseChunk._getFragmentPreLightingCode(t,e)),this._specularChunk&&this._specularChunk.chunkVO.useChunk&&(i+=this._specularChunk._getFragmentPreLightingCode(t,e)),i},e.prototype._getPerLightDiffuseFragmentCode=function(t,e,i,n){return this._diffuseChunk._getFragmentCodePerLight(t,e,i,n)},e.prototype._getPerLightSpecularFragmentCode=function(t,e,i,n){return this._specularChunk._getFragmentCodePerLight(t,e,i,n)},e.prototype._getPerProbeDiffuseFragmentCode=function(t,e,i,n){return this._diffuseChunk._getFragmentCodePerProbe(t,e,i,n)},e.prototype._getPerProbeSpecularFragmentCode=function(t,e,i,n){return this._specularChunk._getFragmentCodePerProbe(t,e,i,n)},e.prototype._getNormalVertexCode=function(t,e){return this._normalChunk._getVertexCode(t,e)},e.prototype._getNormalFragmentCode=function(t,e){var i=this._normalChunk._getFragmentCode(e.normalFragment,t,e);return this._normalChunk.chunkVO.needsView&&t.removeFragmentTempUsage(e.viewDirFragment),(this._normalChunk.chunkVO.needsGlobalFragmentPos||this._normalChunk.chunkVO.needsGlobalVertexPos)&&t.removeVertexTempUsage(e.globalPositionVertex),i},e.prototype._getVertexCode=function(t,e){var i,n="";this._ambientChunk&&this._ambientChunk.chunkVO.useChunk&&(n+=this._ambientChunk._getVertexCode(t,e)),this._shadowChunk&&(n+=this._shadowChunk._getVertexCode(t,e)),this._diffuseChunk&&this._diffuseChunk.chunkVO.useChunk&&(n+=this._diffuseChunk._getVertexCode(t,e)),this._specularChunk&&this._specularChunk.chunkVO.useChunk&&(n+=this._specularChunk._getVertexCode(t,e));for(var r=this._chunks.length,o=r-this._numEffectDependencies;o<r;o++)(i=this._chunks[o]).chunkVO.useChunk&&(n+=i._getVertexCode(t,e),(i.chunkVO.needsGlobalVertexPos||i.chunkVO.needsGlobalFragmentPos)&&t.removeVertexTempUsage(e.globalPositionVertex));return this._colorTransformChunk&&this._colorTransformChunk.chunkVO.useChunk&&(n+=this._colorTransformChunk._getVertexCode(t,e)),n},e.prototype._getFragmentCode=function(t,e){var i="";return this._ambientChunk&&this._ambientChunk.chunkVO.useChunk&&(i+=this._ambientChunk._getFragmentCode(e.shadedTarget,t,e),this._ambientChunk.chunkVO.needsNormals&&t.removeFragmentTempUsage(e.normalFragment),this._ambientChunk.chunkVO.needsView&&t.removeFragmentTempUsage(e.viewDirFragment)),i},e.prototype._getPostAnimationFragmentCode=function(t,e){var i,n,r="";this._shadowChunk&&(r+=this._shadowChunk._getFragmentCode(e.shadowTarget,t,e)),this._diffuseChunk&&this._diffuseChunk.chunkVO.useChunk&&(r+=this._diffuseChunk._getFragmentCode(e.shadedTarget,t,e),this._diffuseChunk.chunkVO.needsNormals&&t.removeFragmentTempUsage(e.normalFragment),this._diffuseChunk.chunkVO.needsView&&t.removeFragmentTempUsage(e.viewDirFragment)),this._specularChunk&&this._specularChunk.chunkVO.useChunk&&(r+=this._specularChunk._getFragmentCode(e.shadedTarget,t,e),this._specularChunk.chunkVO.needsNormals&&t.removeFragmentTempUsage(e.normalFragment),this._specularChunk.chunkVO.needsView&&t.removeFragmentTempUsage(e.viewDirFragment)),this._shadowChunk&&!this._shader.normalDependencies&&t.removeFragmentTempUsage(e.shadowTarget),this.preserveAlpha&&this._numEffectDependencies>0&&(i=t.getFreeFragmentSingleTemp(),t.addFragmentTempUsages(i,1),r+="mov "+i+", "+e.shadedTarget+".w\n");for(var o=this._chunks.length,s=o-this._numEffectDependencies;s<o;s++)(n=this._chunks[s]).chunkVO.useChunk&&(r+=n._getFragmentCode(e.shadedTarget,t,e),n.chunkVO.needsNormals&&t.removeFragmentTempUsage(e.normalFragment),n.chunkVO.needsView&&t.removeFragmentTempUsage(e.viewDirFragment));return this.preserveAlpha&&this._numEffectDependencies>0&&(r+="mov "+e.shadedTarget+".w, "+i+"\n",t.removeFragmentTempUsage(i)),this._colorTransformChunk&&this._colorTransformChunk.chunkVO.useChunk&&(r+=this._colorTransformChunk._getFragmentCode(e.shadedTarget,t,e)),r},e.prototype._iUsesShadows=function(t){return Boolean(this._shadowChunk&&(this._lightPicker.castingDirectionalLights.length>0||this._lightPicker.castingPointLights.length>0))},e.prototype._iUsesSpecular=function(t){return Boolean(this._specularChunk)},e.prototype._iUsesDiffuse=function(t){return Boolean(this._diffuseChunk)},e.prototype.onLightsChange=function(t){this._updateLights()},e.prototype._updateLights=function(){var t=this.numDirectionalLights,e=this.numPointLights,i=this.numLightProbes;this._lightPicker&&this._mode&Hu.LIGHTING?(this.numDirectionalLights=this.calculateNumDirectionalLights(this._lightPicker.numDirectionalLights),this.numPointLights=this.calculateNumPointLights(this._lightPicker.numPointLights),this.numLightProbes=this.calculateNumProbes(this._lightPicker.numLightProbes),this._includeCasters&&(this.numDirectionalLights+=this._lightPicker.numCastingDirectionalLights,this.numPointLights+=this._lightPicker.numCastingPointLights)):(this.numDirectionalLights=0,this.numPointLights=0,this.numLightProbes=0),t==this.numDirectionalLights&&e==this.numPointLights&&i==this.numLightProbes||(this._updateShader(),this.invalidate())},e.prototype.calculateNumDirectionalLights=function(t){return Math.min(t-this.directionalLightsOffset,this._maxLights)},e.prototype.calculateNumPointLights=function(t){var e=this._maxLights-this.numDirectionalLights;return Math.min(t-this.pointLightsOffset,e)},e.prototype.calculateNumProbes=function(t){var e=0;return 0!=(this._renderMaterial.specularLightSources&Gu.PROBES)&&++e,0!=(this._renderMaterial.diffuseLightSources&Gu.PROBES)&&++e,Math.min(t-this.lightProbesOffset,4/e|0)},e}(Qu),qu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._diffuseR=1,n._diffuseG=1,n._diffuseB=1,n._diffuseA=1,n._shader=new Kn(i,e,n,n._stage),n.invalidate(),n}return i(e,t),e.prototype._includeDependencies=function(e){t.prototype._includeDependencies.call(this,e),null!=this._shaderTexture&&e.uvDependencies++},e.prototype.invalidate=function(){t.prototype.invalidate.call(this);var e=this._renderMaterial.material.getTextureAt(0);this._shaderTexture=e?e.getAbstraction(this._shader):null},e.prototype.dispose=function(){this._shaderTexture&&(this._shaderTexture.onClear(new l(l.CLEAR,this._renderMaterial.material.getTextureAt(0))),this._shaderTexture=null),t.prototype.dispose.call(this)},e.prototype._getFragmentCode=function(t,e){var i,n="";this.preserveAlpha&&(i=t.getFreeFragmentSingleTemp(),t.addFragmentTempUsages(i,1),n+="mov "+i+", "+e.shadedTarget+".w\n");var r=e.shadedTarget;if(null!=this._shaderTexture){if(n+=this._shaderTexture._getFragmentCode(r,t,e,e.uvVarying),this._shader.alphaThreshold>0){var o=t.getFreeFragmentConstant();this._fragmentConstantsIndex=4*o.index,n+="sub "+r+".w, "+r+".w, "+o+".x\nkil "+r+".w\nadd "+r+".w, "+r+".w, "+o+".x\n"}}else if(-1!=this._shader.colorBufferIndex)n+="mov "+r+", "+e.colorVarying+"\n";else{var s=t.getFreeFragmentConstant();this._fragmentConstantsIndex=4*s.index,n+="mov "+r+", "+s+"\n"}return this.preserveAlpha&&(n+="mul "+e.shadedTarget+".w, "+e.shadedTarget+".w, "+i+"\n",t.removeFragmentTempUsage(i)),n},e.prototype._setRenderState=function(e){t.prototype._setRenderState.call(this,e),null!=this._shaderTexture&&this._shaderTexture._setRenderState(e)},e.prototype._activate=function(){if(t.prototype._activate.call(this),null!=this._shaderTexture)this._shaderTexture.activate(),this._shader.alphaThreshold>0&&(this._shader.fragmentConstantData[this._fragmentConstantsIndex]=this._shader.alphaThreshold);else if(-1==this._shader.colorBufferIndex){var e=this._fragmentConstantsIndex,i=this._shader.fragmentConstantData;i[e]=this._diffuseR,i[e+1]=this._diffuseG,i[e+2]=this._diffuseB,i[e+3]=this._diffuseA}},e}(Qu),Yu=function(t){function e(e){var i=t.call(this)||this;return i._onCastShadowChangeDelegate=function(t){return i.onCastShadowChange(t)},i.lights=e,i}return i(e,t),Object.defineProperty(e.prototype,"lights",{get:function(){return this._lights},set:function(t){var e,i=0,n=0,r=0,o=0,s=0;this._lights&&this.clearListeners(),this._lights=t,this._allPickedLights=t,this._pointLights=new Array,this._castingPointLights=new Array,this._directionalLights=new Array,this._castingDirectionalLights=new Array,this._lightProbes=new Array;for(var a=t.length,u=0;u<a;++u)(e=t[u]).addEventListener(nl.CASTS_SHADOW_CHANGE,this._onCastShadowChangeDelegate),e instanceof Pl?e.shadowsEnabled?this._castingPointLights[r++]=e:this._pointLights[i++]=e:e instanceof wl?e.shadowsEnabled?this._castingDirectionalLights[o++]=e:this._directionalLights[n++]=e:e instanceof Il&&(this._lightProbes[s++]=e);this._numDirectionalLights==n&&this._numPointLights==i&&this._numLightProbes==s&&this._numCastingPointLights==r&&this._numCastingDirectionalLights==o||(this._numDirectionalLights=n,this._numCastingDirectionalLights=o,this._numPointLights=i,this._numCastingPointLights=r,this._numLightProbes=s,this._lightProbeWeights=new Array(4*Math.ceil(s/4)),this.dispatchEvent(new l(l.INVALIDATE,this)))},enumerable:!0,configurable:!0}),e.prototype.clearListeners=function(){for(var t=this._lights.length,e=0;e<t;++e)this._lights[e].removeEventListener(nl.CASTS_SHADOW_CHANGE,this._onCastShadowChangeDelegate)},e.prototype.onCastShadowChange=function(t){var e=t.target;e instanceof Pl?this.updatePointCasting(e):e instanceof wl&&this.updateDirectionalCasting(e),this.dispatchEvent(new l(l.INVALIDATE,this))},e.prototype.updateDirectionalCasting=function(t){var e=t;t.shadowsEnabled?(--this._numDirectionalLights,++this._numCastingDirectionalLights,this._directionalLights.splice(this._directionalLights.indexOf(e),1),this._castingDirectionalLights.push(t)):(++this._numDirectionalLights,--this._numCastingDirectionalLights,this._castingDirectionalLights.splice(this._castingDirectionalLights.indexOf(e),1),this._directionalLights.push(t))},e.prototype.updatePointCasting=function(t){var e=t;t.shadowsEnabled?(--this._numPointLights,++this._numCastingPointLights,this._pointLights.splice(this._pointLights.indexOf(e),1),this._castingPointLights.push(t)):(++this._numPointLights,--this._numCastingPointLights,this._castingPointLights.splice(this._castingPointLights.indexOf(e),1),this._pointLights.push(t))},e}(function(t){function e(){var e=t.call(this)||this;return e._numPointLights=0,e._numDirectionalLights=0,e._numCastingPointLights=0,e._numCastingDirectionalLights=0,e._numLightProbes=0,e}return i(e,t),e.prototype.dispose=function(){},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numDirectionalLights",{get:function(){return this._numDirectionalLights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numPointLights",{get:function(){return this._numPointLights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numCastingDirectionalLights",{get:function(){return this._numCastingDirectionalLights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numCastingPointLights",{get:function(){return this._numCastingPointLights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numLightProbes",{get:function(){return this._numLightProbes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointLights",{get:function(){return this._pointLights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"directionalLights",{get:function(){return this._directionalLights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"castingPointLights",{get:function(){return this._castingPointLights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"castingDirectionalLights",{get:function(){return this._castingDirectionalLights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightProbes",{get:function(){return this._lightProbes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightProbeWeights",{get:function(){return this._lightProbeWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allPickedLights",{get:function(){return this._allPickedLights},enumerable:!0,configurable:!0}),e.prototype.collectLights=function(t){this.updateProbeWeights(t)},e.prototype.updateProbeWeights=function(t){var e,i,n,r,o,s,a=t.scenePosition,l=a.x,u=a.y,c=a.z,h=0;for(s=0;s<this._numLightProbes;++s)o=(o=(i=l-(e=this._lightProbes[s].transform.concatenatedMatrix3D.position).x)*i+(n=u-e.y)*n+(r=c-e.z)*r)>1e-5?1/o:5e7,this._lightProbeWeights[s]=o,h+=o;for(h=1/h,s=0;s<this._numLightProbes;++s)this._lightProbeWeights[s]*=h},e.assetType="[asset LightPicker]",e}(p)),Ku=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=3);var n=t.call(this,e)||this;if(n._scissorRectsInvalid=!0,n._onClearDelegate=function(t){return n.onClear(t)},e.addEventListener(l.CLEAR,n._onClearDelegate),i<1||i>4)throw new Error("numCascades must be an integer between 1 and 4");return n._numCascades=i,n.init(),n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._image2D.removeEventListener(l.CLEAR,this._onClearDelegate),t.prototype.dispose.call(this)},e.prototype.getSplitRatio=function(t){return this._splitRatios[t]},e.prototype.setSplitRatio=function(t,e){if(e<0?e=0:e>1&&(e=1),t>=this._numCascades)throw new Error("index must be smaller than the number of cascades!");this._splitRatios[t]=e},e.prototype.getDepthProjections=function(t){return this._depthProjections[t].viewMatrix3D},e.prototype.init=function(){this._splitRatios=new Array(this._numCascades),this._nearPlaneDistances=new Array(this._numCascades);for(var t=1,e=this._numCascades-1;e>=0;--e)this._splitRatios[e]=t,t*=.4;for(this._texOffsetsX=Array(-1,1,-1,1),this._texOffsetsY=Array(1,1,-1,-1),this._pScissorRects=new Array(4),this._depthProjections=new Array,e=0;e<this._numCascades;++e)this._depthProjections[e]=new vt},e.prototype.onClear=function(t){this._scissorRectsInvalid=!0},Object.defineProperty(e.prototype,"numCascades",{get:function(){return this._numCascades},set:function(t){if(t!=this._numCascades){if(t<1||t>4)throw new Error("numCascades must be an integer between 1 and 4");this._numCascades=t,this._scissorRectsInvalid=!0,this.init(),this.dispatchEvent(new l(l.INVALIDATE,this))}},enumerable:!0,configurable:!0}),e.prototype._renderMap=function(t,e){this._scissorRectsInvalid&&this.updateScissorRects(),e.depthRenderGroup.getRenderer(t).cullPlanes=this._cullPlanes},e.prototype.updateScissorRects=function(){var t=.5*this._image2D.width;this._pScissorRects[0]=new Y(0,0,t,t),this._pScissorRects[1]=new Y(t,0,t,t),this._pScissorRects[2]=new Y(0,t,t,t),this._pScissorRects[3]=new Y(t,t,t,t),this._scissorRectsInvalid=!1},e.prototype._updateProjection=function(t){var e,i=t.near,n=t.far-i;this._updateProjectionFromFrustumCorners(t,t.viewFrustumCorners,this._matrix),this._matrix.appendScale(.96,.96,1),this._overallDepthProjection.frustumMatrix3D=this._matrix,this._updateCullPlanes(t);for(var r=0;r<this._numCascades;++r)e=this._depthProjections[r].frustumMatrix3D,this._nearPlaneDistances[r]=i+this._splitRatios[r]*n,this._depthProjections[r].transform.matrix3D=this._overallDepthProjection.transform.matrix3D,this.updateProjectionPartition(e,this._splitRatios[r],this._texOffsetsX[r],this._texOffsetsY[r]),this._depthProjections[r].frustumMatrix3D=e},e.prototype.updateProjectionPartition=function(t,e,i,n){for(var r,o,s,a,l,u,c=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,d=Number.NEGATIVE_INFINITY,f=Number.NEGATIVE_INFINITY,_=0;_<12;)(r=this._localFrustum[_])<c&&(c=r),r>p&&(p=r),(o=this._localFrustum[_+1])<h&&(h=o),o>d&&(d=o),(s=this._localFrustum[_+2])>f&&(f=s),(a=r+(this._localFrustum[_+12]-r)*e)<c&&(c=a),a>p&&(p=a),(l=o+(this._localFrustum[_+13]-o)*e)<h&&(h=l),l>d&&(d=l),(u=s+(this._localFrustum[_+14]-s)*e)>f&&(f=u),_+=3;var m=p-c,g=d-h,y=1/(f-1);c<0&&(c-=this._snap),h<0&&(h-=this._snap),c=Math.floor(c/this._snap)*this._snap,h=Math.floor(h/this._snap)*this._snap;var A=2*this._snap;p=c+(m=Math.floor(m/A+1)*A),d=h+(g=Math.floor(g/A+1)*A),m=1/m,g=1/g;var v=t._rawData;v[0]=2*m,v[5]=2*g,v[10]=y,v[12]=-(p+c)*m,v[13]=-(d+h)*g,v[14]=-1*y,v[15]=1,v[1]=v[2]=v[3]=v[4]=v[6]=v[7]=v[8]=v[9]=v[11]=0,t.appendScale(.96,.96,1),t.appendTranslation(i,n,0),t.appendScale(.5,.5,1)},Object.defineProperty(e.prototype,"_iNearPlaneDistances",{get:function(){return this._nearPlaneDistances},enumerable:!0,configurable:!0}),e.assetType="[asset CascadeShadowMapper]",e}(bl),Wu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._initVO=function(e){t.prototype._initVO.call(this,e),e.needsProjection=!0},e.prototype._initConstants=function(){t.prototype._initConstants.call(this);var e=this._shader.fragmentConstantData,i=this._shader.vertexConstantData,n=this._fragmentConstantsIndex;e[n]=1,e[n+1]=1/255,e[n+2]=1/65025,e[n+3]=1/16581375,e[n+6]=.5,e[n+7]=-.5,i[n=this._vertexConstantsIndex]=.5,i[n+1]=-.5,i[n+2]=0;var r=this._mapper.numCascades;this._projectionMatrices=new Array(r);for(var o=0;o<r;++o)this._projectionMatrices[o]=new R(new Float32Array(this._shader.vertexConstantData.buffer,4*(this._vertexConstantsIndex+4+16*o),16))},e.prototype._cleanCompilationData=function(){t.prototype._cleanCompilationData.call(this),this._cascadeProjections=null,this._depthMapCoordVaryings=null,this._projectionMatrices=null},e.prototype._getVertexCode=function(t,e){var i="",n=t.getFreeVertexConstant();this._vertexConstantsIndex=4*n.index,this._cascadeProjections=new Array(this._mapper.numCascades),this._depthMapCoordVaryings=new Array(this._mapper.numCascades);for(var r=0;r<this._mapper.numCascades;++r)this._depthMapCoordVaryings[r]=t.getFreeVarying(),this._cascadeProjections[r]=t.getFreeVertexConstant(),t.getFreeVertexConstant(),t.getFreeVertexConstant(),t.getFreeVertexConstant();var o=t.getFreeVertexVectorTemp();for(r=0;r<this._mapper.numCascades;++r)i+="m44 "+o+", "+e.globalPositionVertex+", "+this._cascadeProjections[r]+"\nadd "+this._depthMapCoordVaryings[r]+", "+o+", "+n+".zzwz\n";return i},e.prototype._getFragmentCode=function(t,e,i){var n,r=this._mapper.numCascades,o=e.getFreeFragmentConstant(),s=e.getFreeFragmentConstant(),a=e.getFreeFragmentConstant(),l=Array(a+".x",a+".y",a+".z",a+".w");this._fragmentConstantsIndex=4*o.index;var u=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(u,1);var c=e.getFreeFragmentVectorTemp();e.addFragmentTempUsages(c,1),n="mov "+c+", "+this._depthMapCoordVaryings[r-1]+"\n";for(var h=r-2;h>=0;--h){var p=this._depthMapCoordVaryings[h];n+="slt "+u+".z, "+i.projectionFragment+".z, "+l[h]+"\n";var d=e.getFreeFragmentVectorTemp();n+="sub "+d+", "+p+", "+c+"\nmul "+d+", "+d+", "+u+".z\nadd "+c+", "+c+", "+d+"\n"}return e.removeFragmentTempUsage(u),n+="div "+c+", "+c+", "+c+".w\nmul "+c+".xy, "+c+".xy, "+s+".zw\nadd "+c+".xy, "+c+".xy, "+s+".zz\n",e.removeFragmentTempUsage(c),n},e.prototype._activate=function(){this._shader.vertexConstantData[this._vertexConstantsIndex+3]=-1/(this._mapper.depth*this._mapper.epsilon);for(var t=this._mapper.numCascades,e=0;e<t;++e)this._projectionMatrices[e].copyFrom(this._mapper.getDepthProjections(e),!0);var i=this._shader.fragmentConstantData,n=this._fragmentConstantsIndex;i[n+5]=1-this._mapper.alpha;var r=this._mapper._iNearPlaneDistances;n+=8;for(var o=0;o<t;++o)i[n+o]=r[o]},e.prototype._setRenderState=function(t){},e}(xl);Kn.registerAbstraction(Wu,Ku);var Ju=function(t){function e(e,i,n){void 0===e&&(e=null),void 0===i&&(i=.5),void 0===n&&(n=.1);var r=t.call(this,e)||this;return r.coverageRatio=i,r._fadeRatio=n,r}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coverageRatio",{get:function(){return this._coverageRatio},set:function(t){t>1?t=1:t<0&&(t=0),this._coverageRatio=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fadeRatio",{get:function(){return this._fadeRatio},set:function(t){this._fadeRatio=t},enumerable:!0,configurable:!0}),e.prototype._updateProjection=function(t){for(var e=t.viewFrustumCorners,i=0;i<12;++i){var n=e[i];this._localFrustum[i]=n,this._localFrustum[i+12]=n+(e[i+12]-n)*this._coverageRatio}this._updateProjectionFromFrustumCorners(t,this._localFrustum,this._matrix),this._overallDepthProjection.frustumMatrix3D=this._matrix},e.assetType="[asset NearDirectionalShadowMapper]",e}(bl),Zu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._initConstants=function(){t.prototype._initConstants.call(this);var e=this._shader.fragmentConstantData,i=this._fragmentDistanceIndex;e[i+2]=0,e[i+3]=1},e.prototype._initVO=function(e){t.prototype._initVO.call(this,e),e.needsProjection=!0},e.prototype._getFragmentCode=function(e,i,n){var r=t.prototype._getFragmentCode.call(this,e,i,n),o=i.getFreeFragmentConstant(),s=i.getFreeFragmentSingleTemp();return this._fragmentDistanceIndex=4*o.index,r+="abs "+s+", "+n.projectionFragment+".w\nsub "+s+", "+s+", "+o+".x\nmul "+s+", "+s+", "+o+".y\nsat "+s+", "+s+"\nsub "+s+", "+o+".w,"+s+"\nsub "+e+".w, "+o+".w,"+e+".w\nmul "+e+".w, "+e+".w, "+s+"\nsub "+e+".w, "+o+".w,"+e+".w\n"},e.prototype._setRenderState=function(e){var i=this._shader.view.projection.near,n=this._shader.view.projection.far-i,r=this._mapper.coverageRatio,o=r*(1-this._mapper.fadeRatio);r=i+r*n,o=i+o*n;var s=this._shader.fragmentConstantData,a=this._fragmentDistanceIndex;s[a]=o,s[a+1]=1/(r-o),t.prototype._setRenderState.call(this,e)},e}(xl);Kn.registerAbstraction(Zu,Ju);var $u=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[texture DepthTexture2D]",e}(hl);Kn.registerAbstraction(fl,$u);!function(t){function e(){return t.call(this)||this}i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[texture VideoTexture]"}(hl);var tc=function(t){function e(e,i){void 0===e&&(e=16777215),void 0===i&&(i=1);var n=t.call(this)||this;return n._textures=new Array,n._pUseColorTransform=!1,n._alphaBlending=!1,n._alpha=1,n._pAlphaThreshold=0,n._pAnimateUVs=!1,n._style=new or,n._iBaseScreenPassIndex=0,n._bothSides=!1,n._pBlendMode=fn.NORMAL,n._imageRect=!1,n._curves=!1,n._onInvalidatePropertiesDelegate=function(t){return n._onInvalidateProperties(t)},n._style.addEventListener(rr.INVALIDATE_PROPERTIES,n._onInvalidatePropertiesDelegate),e instanceof Ue?n._style.image=e:n._style.color=Number(e),n.alpha=i,n._onTextureInvalidateDelegate=function(t){return n.onTextureInvalidate(t)},n}return i(e,t),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t>1?t=1:t<0&&(t=0),this._alpha!=t&&(this._alpha=t,null==this._colorTransform&&(this._colorTransform=new I),this._colorTransform.alphaMultiplier=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){this._colorTransform=t,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphaBlending",{get:function(){return this._alphaBlending},set:function(t){this._alphaBlending!=t&&(this._alphaBlending=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curves",{get:function(){return this._curves},set:function(t){this._curves!=t&&(this._curves=t,this.invalidatePasses())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageRect",{get:function(){return this._imageRect},set:function(t){this._imageRect!=t&&(this._imageRect=t,this.invalidatePasses())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){this._style!=t&&(this._style&&this._style.removeEventListener(rr.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate),this._style=t,this._style&&this._style.addEventListener(rr.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate),this.invalidatePasses())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animateUVs",{get:function(){return this._pAnimateUVs},set:function(t){this._pAnimateUVs!=t&&(this._pAnimateUVs=t,this.invalidatePasses())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useColorTransform",{get:function(){return this._pUseColorTransform},set:function(t){this._pUseColorTransform!=t&&(this._pUseColorTransform=t,this.invalidatePasses())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bothSides",{get:function(){return this._bothSides},set:function(t){(this._bothSides=t)||(this._bothSides=t,this.invalidatePasses())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._pBlendMode},set:function(t){this._pBlendMode!=t&&(this._pBlendMode=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphaThreshold",{get:function(){return this._pAlphaThreshold},set:function(t){t<0?t=0:t>1&&(t=1),this._pAlphaThreshold!=t&&(this._pAlphaThreshold=t,this.invalidatePasses())},enumerable:!0,configurable:!0}),e.prototype.getNumTextures=function(){return this._textures.length},e.prototype.getTextureAt=function(t){return this._textures[t]},e.prototype.dispose=function(){this.clear()},e.prototype.invalidatePasses=function(){this.dispatchEvent(new Jn(Jn.INVALIDATE_PASSES,this))},e.prototype.invalidateTextures=function(){this.dispatchEvent(new Jn(Jn.INVALIDATE_TEXTURES,this))},e.prototype.addTextureAt=function(t,e){var i=this._textures.indexOf(t);i!=e&&(-1!=i&&this._textures.splice(i,1),this._textures.splice(e,0,t),t.addEventListener(l.INVALIDATE,this._onTextureInvalidateDelegate),this.onTextureInvalidate())},e.prototype.addTexture=function(t){-1==this._textures.indexOf(t)&&(this._textures.push(t),t.addEventListener(l.INVALIDATE,this._onTextureInvalidateDelegate),this.onTextureInvalidate())},e.prototype.removeTexture=function(t){this._textures.splice(this._textures.indexOf(t),1),t.removeEventListener(l.INVALIDATE,this._onTextureInvalidateDelegate),this.onTextureInvalidate()},e.prototype.onTextureInvalidate=function(t){this.invalidatePasses(),this.invalidateTextures()},e.prototype._onInvalidateProperties=function(t){this.invalidatePasses(),this.invalidateTextures()},e}(p),ec=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"shader",{get:function(){return this._shader},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numUsedStreams",{get:function(){return this._shader.numUsedStreams},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numUsedTextures",{get:function(){return this._shader.numUsedTextures},enumerable:!0,configurable:!0}),e.prototype._includeDependencies=function(t){t.alphaThreshold=this._material.alphaThreshold,t.useImageRect=this._material.imageRect,t.usesCurves=this._material.curves,t.useBothSides=this._material.bothSides,t.usesUVTransform=this._material.animateUVs,t.usesColorTransform=this._material.useColorTransform},e.prototype.invalidate=function(){this._shader.invalidateProgram(),this.dispatchEvent(new Wn(Wn.INVALIDATE,this))},e.prototype.dispose=function(){this._shader&&(this._shader.dispose(),this._shader=null)},e.prototype._setRenderState=function(t){this._shader._setRenderState(t)},e.prototype._activate=function(){this._shader._activate()},e.prototype._deactivate=function(){this._shader._deactivate()},e.prototype._initConstantData=function(){},e.prototype._getVertexCode=function(t,e){return""},e.prototype._getFragmentCode=function(t,e){return""},e.prototype._getPostAnimationFragmentCode=function(t,e){return""},e.prototype._getNormalVertexCode=function(t,e){return""},e.prototype._getNormalFragmentCode=function(t,e){return""},e}(Zn),ic=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._shader=new Kn(i,n,n,n._stage),n._pAddPass(n),n.invalidate(),n}return i(e,t),e.prototype.invalidate=function(){t.prototype.invalidate.call(this);var e=this._material.getTextureAt(0);this._shaderTexture=e?e.getAbstraction(this._shader):null},e.prototype._includeDependencies=function(e){t.prototype._includeDependencies.call(this,e),e.projectionDependencies++,e.alphaThreshold>0&&e.uvDependencies++},e.prototype._initConstantData=function(){var t=this._fragmentConstantsIndex,e=this._shader.fragmentConstantData;e[t]=1,e[t+1]=255,e[t+2]=65025,e[t+3]=16581375,e[t+4]=1/255,e[t+5]=1/255,e[t+6]=1/255,e[t+7]=0},e.prototype._getFragmentCode=function(t,e){var i="",n=e.shadedTarget,r=t.getFreeFragmentConstant(),o=t.getFreeFragmentConstant();this._fragmentConstantsIndex=4*r.index;var s=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(s,1);var a=t.getFreeFragmentVectorTemp();if(t.addFragmentTempUsages(a,1),i+="div "+s+", "+e.projectionFragment+", "+e.projectionFragment+".w\nmul "+s+", "+r+", "+s+".z\nfrc "+s+", "+s+"\nmul "+a+", "+s+".yzww, "+o+"\n",this._shaderTexture&&this._shader.alphaThreshold>0){var l=t.getFreeFragmentVectorTemp();i+=this._shaderTexture._getFragmentCode(l,t,e,e.uvVarying),i+="sub "+l+".w, "+l+".w, "+t.getFreeFragmentConstant()+".x\nkil "+l+".w\n"}return i+="sub "+n+", "+s+", "+a+"\n",t.removeFragmentTempUsage(s),t.removeFragmentTempUsage(a),i},e.prototype._activate=function(){t.prototype._activate.call(this),this._shaderTexture&&this._shader.alphaThreshold>0&&(this._shaderTexture.activate(),this._shader.fragmentConstantData[this._fragmentConstantsIndex+8]=this._shader.alphaThreshold)},e}(ec),nc=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._shader=new Kn(i,n,n,n._stage),n._pAddPass(n),n.invalidate(),n}return i(e,t),e.prototype.invalidate=function(){t.prototype.invalidate.call(this);var e=this._material.getTextureAt(0);this._shaderTexture=e?e.getAbstraction(this._shader):null},e.prototype._initConstantData=function(){var t=this._fragmentConstantsIndex,e=this._shader.fragmentConstantData;e[t+4]=1/255,e[t+5]=1/255,e[t+6]=1/255,e[t+7]=0},e.prototype._includeDependencies=function(e){t.prototype._includeDependencies.call(this,e),e.projectionDependencies++,e.viewDirDependencies++,e.alphaThreshold>0&&e.uvDependencies++,e.viewDirDependencies>0&&e.globalPosDependencies++},e.prototype._getFragmentCode=function(t,e){var i,n=e.shadedTarget,r=t.getFreeFragmentConstant(),o=t.getFreeFragmentConstant();this._fragmentConstantsIndex=4*r.index;var s=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(s,1);var a=t.getFreeFragmentVectorTemp();if(t.addFragmentTempUsages(a,1),i="dp3 "+s+".z, "+e.viewDirVarying+".xyz, "+e.viewDirVarying+".xyz\nmul "+s+", "+r+", "+s+".z\nfrc "+s+", "+s+"\nmul "+a+", "+s+".yzww, "+o+"\n",this._shaderTexture&&this._shader.alphaThreshold>0){var l=t.getFreeFragmentVectorTemp();i+=this._shaderTexture._getFragmentCode(l,t,e,e.uvVarying),i+="sub "+l+".w, "+l+".w, "+t.getFreeFragmentConstant()+".x\nkil "+l+".w\n"}return i+="sub "+n+", "+s+", "+a+"\n"},e.prototype._activate=function(){t.prototype._activate.call(this);var e=this._shader.view.projection.far;e=1/(2*e*e);var i=this._fragmentConstantsIndex,n=this._shader.fragmentConstantData;n[i]=1*e,n[i+1]=255*e,n[i+2]=65025*e,n[i+3]=16581375*e,this._shaderTexture&&this._shader.alphaThreshold>0&&(this._shaderTexture.activate(),n[i+8]=this._shader.alphaThreshold)},e}(ec),rc=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=1);var n=t.call(this,e,i)||this;return n._preserveAlpha=!1,e instanceof Ue&&(n.texture=new hl),n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preserveAlpha",{get:function(){return this._preserveAlpha},set:function(t){this._preserveAlpha!=t&&(this._preserveAlpha=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!=t&&(this._texture&&this.removeTexture(this._texture),this._texture=t,this._texture&&this.addTexture(this._texture))},enumerable:!0,configurable:!0}),e.assetType="[materials BasicMaterial]",e}(tc),oc=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._basicMaterial=e,n._pAddPass(n._pass=new qu(n,i)),n}return i(e,t),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._basicMaterial=null},e.prototype._pUpdateRender=function(){t.prototype._pUpdateRender.call(this),this.requiresBlending=this._basicMaterial.blendMode!=fn.NORMAL||this._basicMaterial.alphaBlending||this._basicMaterial.colorTransform&&this._basicMaterial.colorTransform.alphaMultiplier<1,this._pass.preserveAlpha=this._basicMaterial.preserveAlpha,this._pass.shader.setBlendMode(this._basicMaterial.blendMode==fn.NORMAL&&this.requiresBlending?fn.LAYER:this._basicMaterial.blendMode)},e}(Zn);Ir.registerDefaultMaterial(oc,rc),Ir.registerDepthMaterial(ic,rc),Ir.registerDistanceMaterial(nc,rc),er.setDefaultMaterialClass(rc);var sc=function(){function t(){}return t.SINGLE_PASS="singlePass",t.MULTI_PASS="multiPass",t}(),ac=function(t){function e(e,i){void 0===e&&(e=16777215),void 0===i&&(i=1);var n=t.call(this,e,i)||this;return n._effectMethods=new Array,n._enableLightFallOff=!0,n._specularLightSources=1,n._diffuseLightSources=3,n._ambientMethod=new Bl,n._diffuseMethod=new kl,n._normalMethod=new _u,n._specularMethod=new Bu,n._depthCompareMode=Nt.LESS_EQUAL,n._mode=sc.SINGLE_PASS,n._ambientMethod.iAddOwner(n),n._diffuseMethod.iAddOwner(n),n._normalMethod.iAddOwner(n),n._specularMethod.iAddOwner(n),n._onLightChangeDelegate=function(t){return n.onLightsChange(t)},e instanceof Ue&&(n._ambientMethod.texture=new hl),n}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._pLightPicker},set:function(t){this._pLightPicker!=t&&(this._pLightPicker&&this._pLightPicker.removeEventListener(l.INVALIDATE,this._onLightChangeDelegate),this._pLightPicker=t,this._pLightPicker&&this._pLightPicker.addEventListener(l.INVALIDATE,this._onLightChangeDelegate),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableLightFallOff",{get:function(){return this._enableLightFallOff},set:function(t){this._enableLightFallOff!=t&&(this._enableLightFallOff=t,this.invalidatePasses())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diffuseLightSources",{get:function(){return this._diffuseLightSources},set:function(t){this._diffuseLightSources!=t&&(this._diffuseLightSources=t,this.invalidatePasses())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specularLightSources",{get:function(){return this._specularLightSources},set:function(t){this._specularLightSources!=t&&(this._specularLightSources=t,this.invalidatePasses())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode!=t&&(this._mode=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthCompareMode",{get:function(){return this._depthCompareMode},set:function(t){this._depthCompareMode!=t&&(this._depthCompareMode=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ambientMethod",{get:function(){return this._ambientMethod},set:function(t){this._ambientMethod!=t&&(this._ambientMethod&&this._ambientMethod.iRemoveOwner(this),this._ambientMethod=t,this._ambientMethod&&this._ambientMethod.iAddOwner(this),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowMethod",{get:function(){return this._shadowMethod},set:function(t){this._shadowMethod!=t&&(this._shadowMethod&&this._shadowMethod.iRemoveOwner(this),this._shadowMethod=t,this._shadowMethod&&this._shadowMethod.iAddOwner(this),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diffuseMethod",{get:function(){return this._diffuseMethod},set:function(t){this._diffuseMethod!=t&&(this._diffuseMethod&&this._diffuseMethod.iRemoveOwner(this),this._diffuseMethod=t,this._diffuseMethod&&this._diffuseMethod.iAddOwner(this),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specularMethod",{get:function(){return this._specularMethod},set:function(t){this._specularMethod!=t&&(this._specularMethod&&this._specularMethod.iRemoveOwner(this),this._specularMethod=t,this._specularMethod&&this._specularMethod.iAddOwner(this),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalMethod",{get:function(){return this._normalMethod},set:function(t){this._normalMethod!=t&&(this._normalMethod&&this._normalMethod.iRemoveOwner(this),this._normalMethod=t,this._normalMethod&&this._normalMethod.iAddOwner(this),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numEffectMethods",{get:function(){return this._effectMethods.length},enumerable:!0,configurable:!0}),e.prototype.addEffectMethod=function(t){t.iAddOwner(this),this._effectMethods.push(t),this.invalidate()},e.prototype.getEffectMethodAt=function(t){return this._effectMethods[t]},e.prototype.addEffectMethodAt=function(t,e){t.iAddOwner(this),this._effectMethods.splice(e,0,t),this.invalidate()},e.prototype.removeEffectMethod=function(t){t.iRemoveOwner(this),this._effectMethods.splice(this._effectMethods.indexOf(t),1),this.invalidate()},e.prototype.onLightsChange=function(t){this.invalidate()},e.assetType="[materials MethodMaterial]",e}(tc),lc=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._methodMaterial=e,n._renderElements=i,n}return i(e,t),Object.defineProperty(e.prototype,"numLights",{get:function(){return this._methodMaterial.lightPicker?this._methodMaterial.lightPicker.numLightProbes+this._methodMaterial.lightPicker.numDirectionalLights+this._methodMaterial.lightPicker.numPointLights+this._methodMaterial.lightPicker.numCastingDirectionalLights+this._methodMaterial.lightPicker.numCastingPointLights:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numNonCasters",{get:function(){return this._methodMaterial.lightPicker?this._methodMaterial.lightPicker.numLightProbes+this._methodMaterial.lightPicker.numDirectionalLights+this._methodMaterial.lightPicker.numPointLights:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._methodMaterial.lightPicker},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableLightFallOff",{get:function(){return this._methodMaterial.enableLightFallOff},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diffuseLightSources",{get:function(){return this._methodMaterial.diffuseLightSources},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specularLightSources",{get:function(){return this._methodMaterial.specularLightSources},enumerable:!0,configurable:!0}),e.prototype._pUpdateRender=function(){if(t.prototype._pUpdateRender.call(this),this.initPasses(),this.setBlendAndCompareModes(),this._pClearPasses(),this._methodMaterial.mode==sc.MULTI_PASS&&(this._casterLightPass&&this._pAddPass(this._casterLightPass),this._nonCasterLightPasses))for(var e=0;e<this._nonCasterLightPasses.length;++e)this._pAddPass(this._nonCasterLightPasses[e]);this._pass&&this._pAddPass(this._pass)},e.prototype.initPasses=function(){0==this.numLights||this._methodMaterial.numEffectMethods>0||this._methodMaterial.mode==sc.SINGLE_PASS?this.initEffectPass():this._pass&&this.removeEffectPass(),this._methodMaterial.shadowMethod&&this._methodMaterial.mode==sc.MULTI_PASS?this.initCasterLightPass():this._casterLightPass&&this.removeCasterLightPass(),this.numNonCasters>0&&this._methodMaterial.mode==sc.MULTI_PASS?this.initNonCasterLightPasses():this._nonCasterLightPasses&&this.removeNonCasterLightPasses()},e.prototype.setBlendAndCompareModes=function(){var t=Boolean(this._casterLightPass||this._pass);if(this._casterLightPass&&(this._casterLightPass.forceSeparateMVP=t,this._casterLightPass.shader.setBlendMode(fn.NORMAL),this._casterLightPass.shader.depthCompareMode=this._methodMaterial.depthCompareMode),this._nonCasterLightPasses){var e=0;this._casterLightPass||(this._nonCasterLightPasses[0].forceSeparateMVP=t,this._nonCasterLightPasses[0].shader.setBlendMode(fn.NORMAL),this._nonCasterLightPasses[0].shader.depthCompareMode=this._methodMaterial.depthCompareMode,e=1);for(var i=e;i<this._nonCasterLightPasses.length;++i)this._nonCasterLightPasses[i].forceSeparateMVP=t,this._nonCasterLightPasses[i].shader.setBlendMode(fn.ADD),this._nonCasterLightPasses[i].shader.depthCompareMode=Nt.LESS_EQUAL}this._casterLightPass||this._nonCasterLightPasses?(this.requiresBlending=!1,this._pass&&(this._pass.mode=Hu.EFFECTS,this._pass.forceSeparateMVP=t,this._pass.shader.depthCompareMode=Nt.LESS_EQUAL,this._pass.shader.setBlendMode(fn.LAYER))):this._pass&&(this.requiresBlending=this._methodMaterial.blendMode!=fn.NORMAL||this._methodMaterial.alphaBlending||this._methodMaterial.colorTransform&&this._methodMaterial.colorTransform.alphaMultiplier<1,this._pass.mode=Hu.SUPER_SHADER,this._pass.preserveAlpha=this.requiresBlending,this._pass.forceSeparateMVP=!1,this._pass.colorTransform=this._methodMaterial.colorTransform,this._pass.shader.setBlendMode(this._methodMaterial.blendMode==fn.NORMAL&&this.requiresBlending?fn.LAYER:this._methodMaterial.blendMode),this._pass.shader.depthCompareMode=this._methodMaterial.depthCompareMode)},e.prototype.initCasterLightPass=function(){null==this._casterLightPass&&(this._casterLightPass=new Xu(Hu.LIGHTING,this,this._renderElements)),this._casterLightPass.lightPicker=new Yu([this._methodMaterial.shadowMethod.castingLight]),this._casterLightPass.shadowMethod=this._methodMaterial.shadowMethod,this._casterLightPass.diffuseMethod=this._methodMaterial.diffuseMethod,this._casterLightPass.ambientMethod=this._methodMaterial.ambientMethod,this._casterLightPass.normalMethod=this._methodMaterial.normalMethod,this._casterLightPass.specularMethod=this._methodMaterial.specularMethod},e.prototype.removeCasterLightPass=function(){this._casterLightPass.dispose(),this._pRemovePass(this._casterLightPass),this._casterLightPass=null},e.prototype.initNonCasterLightPasses=function(){var t;this.removeNonCasterLightPasses();var e=this._methodMaterial.lightPicker.numDirectionalLights,i=this._methodMaterial.lightPicker.numPointLights,n=this._methodMaterial.lightPicker.numLightProbes,r=0,o=0,s=0;for(this._casterLightPass||(e+=this._methodMaterial.lightPicker.numCastingDirectionalLights,i+=this._methodMaterial.lightPicker.numCastingPointLights),this._nonCasterLightPasses=new Array;r<e||o<i||s<n;)(t=new Xu(Hu.LIGHTING,this,this._renderElements)).includeCasters=null==this._methodMaterial.shadowMethod,t.directionalLightsOffset=r,t.pointLightsOffset=o,t.lightProbesOffset=s,t.lightPicker=this._methodMaterial.lightPicker,t.diffuseMethod=this._methodMaterial.diffuseMethod,t.ambientMethod=this._methodMaterial.ambientMethod,t.normalMethod=this._methodMaterial.normalMethod,t.specularMethod=this._methodMaterial.specularMethod,this._nonCasterLightPasses.push(t),r+=t.numDirectionalLights,o+=t.numPointLights,s+=t.numLightProbes},e.prototype.removeNonCasterLightPasses=function(){if(this._nonCasterLightPasses){for(var t=0;t<this._nonCasterLightPasses.length;++t)this._pRemovePass(this._nonCasterLightPasses[t]);this._nonCasterLightPasses=null}},e.prototype.removeEffectPass=function(){this._pass.ambientMethod!=this._methodMaterial.ambientMethod&&this._pass.ambientMethod.dispose(),this._pass.diffuseMethod!=this._methodMaterial.diffuseMethod&&this._pass.diffuseMethod.dispose(),this._pass.specularMethod!=this._methodMaterial.specularMethod&&this._pass.specularMethod.dispose(),this._pass.normalMethod!=this._methodMaterial.normalMethod&&this._pass.normalMethod.dispose(),this._pRemovePass(this._pass),this._pass=null},e.prototype.initEffectPass=function(){null==this._pass&&(this._pass=new Xu(Hu.SUPER_SHADER,this,this._renderElements)),this._methodMaterial.mode==sc.SINGLE_PASS?(this._pass.ambientMethod=this._methodMaterial.ambientMethod,this._pass.diffuseMethod=this._methodMaterial.diffuseMethod,this._pass.specularMethod=this._methodMaterial.specularMethod,this._pass.normalMethod=this._methodMaterial.normalMethod,this._pass.shadowMethod=this._methodMaterial.shadowMethod):this._methodMaterial.mode==sc.MULTI_PASS&&(0==this.numLights?this._pass.ambientMethod=this._methodMaterial.ambientMethod:this._pass.ambientMethod=null,this._pass.preserveAlpha=!1,this._pass.normalMethod=this._methodMaterial.normalMethod);for(var t,e=0,i=Math.max(this._methodMaterial.numEffectMethods,this._pass.numEffectMethods);e<i;)(t=this._methodMaterial.getEffectMethodAt(e))!=this._pass.getEffectMethodAt(e)&&(this._pass.removeEffectMethodAt(e),null!=t&&(e<this._pass.numEffectMethods?this._pass.addEffectMethodAt(t,e):this._pass.addEffectMethod(t))),e++},e.prototype.onClear=function(e){t.prototype.onClear.call(this,e)},e}(Zn);Ir.registerDefaultMaterial(lc,ac),Ir.registerDepthMaterial(ic,ac),Ir.registerDistanceMaterial(nc,ac),console.debug("AwayJS - Materials - 0.6.5");var uc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[asset SkyboxElements]",e}(Us),cc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._includeDependencies=function(t){},e.prototype._getVertexCode=function(t,e,i){var n="",r=t.globalPosDependencies>0?i.globalPositionVertex:i.animatedPosition,o=e.getFreeVertexConstant();e.getFreeVertexConstant(),e.getFreeVertexConstant(),e.getFreeVertexConstant(),t.viewMatrixIndex=4*o.index;var s=e.getFreeVertexConstant();t.scenePositionIndex=4*s.index;var a=e.getFreeVertexConstant(),l=e.getFreeVertexVectorTemp();return n+="mul "+l+", "+r+", "+a+"\nadd "+l+", "+l+", "+s+"\n",t.projectionDependencies>0?(i.projectionFragment=e.getFreeVarying(),n+="m44 "+l+", "+l+", "+o+"\nmov "+i.projectionFragment+", "+l+"\nmov op, "+l+"\n"):n+="m44 op, "+l+", "+o+"\n",n},e.prototype._getFragmentCode=function(t,e,i){return""},e}($n),hc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._skyboxProjection=new R,e}return i(e,t),e.prototype.draw=function(t,e,i,n){var r=e.scenePositionIndex,o=e.view.projection.transform.concatenatedMatrix3D.position;e.vertexConstantData[r++]=2*o.x,e.vertexConstantData[r++]=2*o.y,e.vertexConstantData[r++]=2*o.z,e.vertexConstantData[r++]=1,e.vertexConstantData[r++]=e.vertexConstantData[r++]=e.vertexConstantData[r++]=e.view.projection.far/Math.sqrt(3),e.vertexConstantData[r]=1;var s=new P;this._skyboxProjection.copyFrom(e.view.viewMatrix3D),this._skyboxProjection.copyRowTo(2,s);var a=s.x,l=s.y,u=s.z,c=-(s.x*o.x+s.y*o.y+s.z*o.z+Math.sqrt(a*a+l*l+u*u)),h=new P(a>=0?1:-1,l>=0?1:-1,1,1),p=this._skyboxProjection.clone();p.invert();var d=p.transformVector(h);this._skyboxProjection.copyRowTo(3,h);var f=(d.x*h.x+d.y*h.y+d.z*h.z+d.w*h.w)/(a*d.x+l*d.y+u*d.z+c*d.w);this._skyboxProjection.copyRowFrom(2,new P(a*f,l*f,u*f,c*f)),e.sceneMatrixIndex>=0&&e.sceneMatrix.copyFrom(t.renderSceneTransform,!0),e.viewMatrix.copyFrom(this._skyboxProjection,!0);var _=this._stage.context;_.setProgramConstantsFromArray(Ut.VERTEX,e.vertexConstantData),_.setProgramConstantsFromArray(Ut.FRAGMENT,e.fragmentConstantData),this._indices?this.getIndexBufferGL().draw(Ft.TRIANGLES,0,this.numIndices):this._stage.context.drawVertices(Ft.TRIANGLES,n,i||this.numVertices)},e}(js);Ir.registerElements(cc,uc),Ji.registerAbstraction(hc,uc);var pc=function(t){function e(e,i){void 0===e&&(e=16777215);var n=t.call(this)||this;return n._textures=new Array,n._pBlendMode=fn.NORMAL,n.animateUVs=!1,n.bothSides=!1,n.curves=!1,n.imageRect=!1,n._onTextureInvalidateDelegate=function(t){return n.onTextureInvalidate(t)},n._owners=[n],n.style=new or,e instanceof Zi?(n._style.image=e,n.texture=new ul):n._style.color=Number(e),n}return i(e,t),Object.defineProperty(e.prototype,"animationSet",{get:function(){return this._animationSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._pBlendMode},set:function(t){this._pBlendMode!=t&&(this._pBlendMode=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iOwners",{get:function(){return this._owners},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!=t&&(this._texture&&this.removeTexture(this._texture),this._texture=t,this._texture&&this.addTexture(this._texture),this.invalidatePasses())},enumerable:!0,configurable:!0}),e.prototype.getNumTextures=function(){return this._textures.length},e.prototype.getTextureAt=function(t){return this._textures[t]},e.prototype.isEntity=function(){return!0},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.invalidatePasses=function(){this.dispatchEvent(new Jn(Jn.INVALIDATE_PASSES,this))},e.prototype.invalidateElements=function(){this.dispatchEvent(new tr(tr.INVALIDATE_ELEMENTS,this))},e.prototype.invalidateMaterial=function(){this.dispatchEvent(new tr(tr.INVALIDATE_MATERIAL,this))},e.prototype.invalidateStyle=function(){this.dispatchEvent(new tr(tr.INVALIDATE_STYLE,this))},e.prototype.addTexture=function(t){this._textures.push(t),t.addEventListener(l.INVALIDATE,this._onTextureInvalidateDelegate),this.onTextureInvalidate()},e.prototype.removeTexture=function(t){this._textures.splice(this._textures.indexOf(t),1),t.removeEventListener(l.INVALIDATE,this._onTextureInvalidateDelegate),this.onTextureInvalidate()},e.prototype.onTextureInvalidate=function(t){this.invalidate()},e.prototype._onInvalidateProperties=function(t){this.invalidateMaterial(),this.invalidatePasses()},e.prototype._acceptTraverser=function(t){t.applyTraversable(this)},e.prototype.iAddOwner=function(t){},e.prototype.iRemoveOwner=function(t){},e.prototype._getDefaultBoundingVolume=function(){return It.NULL},e.prototype.testCollision=function(t,e){return t.traversable=null,!1},e.assetType="[asset Skybox]",e}(Na),dc=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._skybox=e,n._shader=new Kn(i,n,n,n._stage),n._texture=n._skybox.texture.getAbstraction(n._shader),n._pAddPass(n),n}return i(e,t),e.prototype.onClear=function(e){t.prototype.onClear.call(this,e),this._texture.onClear(new l(l.CLEAR,this._skybox.texture)),this._texture=null,this._skybox=null},e.prototype._pUpdateRender=function(){t.prototype._pUpdateRender.call(this),this.requiresBlending=this._material.blendMode!=fn.NORMAL,this.shader.setBlendMode(this._material.blendMode==fn.NORMAL&&this.requiresBlending?fn.LAYER:this._material.blendMode)},e.prototype._includeDependencies=function(e){t.prototype._includeDependencies.call(this,e),e.usesPositionFragment=!0},e.prototype._getFragmentCode=function(t,e){return this._texture._getFragmentCode(e.shadedTarget,t,e,e.positionVarying)},e.prototype._setRenderState=function(e){t.prototype._setRenderState.call(this,e),this._texture._setRenderState(e)},e.prototype._activate=function(){t.prototype._activate.call(this),this._stage.context.setDepthTest(!1,Nt.LESS),this._texture.activate()},e}(ec),fc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getStageElements=function(){var t=e._elements;return t||((t=new uc(new Pn(11,4))).autoDeriveNormals=!1,t.autoDeriveTangents=!1,t.setIndices(Array(0,1,2,2,3,0,6,5,4,4,7,6,2,6,7,7,3,2,4,5,1,1,0,4,4,0,3,3,7,4,2,1,5,5,6,2)),t.setPositions(Array(-1,1,-1,1,1,-1,1,1,1,-1,1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1))),t.getAbstraction(this._stage)},e.prototype._getRenderMaterial=function(){return this._asset.getAbstraction(this.renderGroup.getRenderElements(this.stageElements.elements))},e.prototype._getStyle=function(){return this._asset.style},e}(ir),_c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.isInFrustum=function(t,e,i,n){return!!this.isVisible()},e.prototype.isCastingShadow=function(){return!1},e}(se);Ir.registerDefaultMaterial(dc,pc),nr.registerRenderable(fc,pc),re.registerAbstraction(_c,pc);var mc=function(){function t(){}return t.CENTER="center",t.LEFT="left",t.NONE="none",t.RIGHT="right",t}(),gc=function(){function t(){}return t.DYNAMIC="dynamic",t.INPUT="input",t.STATIC="input",t}(),yc=function(){function t(){}return t.STANDART="standart",t.BOLD="bold",t.ITALIC="italic",t.BOLDITALIC="boldItalic",t}(),Ac=function(){function t(){}return t.CENTER="center",t.JUSTIFY="justify",t.LEFT="left",t.RIGHT="right",t}(),vc=function(){function t(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),this.fnt_channel=0,this.kerningCharCodes=[],this.kerningValues=[],this.fill_data=t,this.stroke_data=e,this.fill_data_path=i}return t.prototype.dispose=function(){this.stroke_data&&(this.stroke_data=null),this.fill_data&&(this.fill_data=null),this.fill_data_path&&(this.fill_data_path=null)},t}(),bc=function(t,e,i,n,r,o,s,a,l,u){this.id=t,this.x=e,this.y=i,this.width=n,this.height=r,this.x_offset=o,this.y_offset=s,this.x_advance=a,this.page=l,this.channel=u},xc=function(t){function e(){var e=t.call(this)||this;return e._font_chars=[],e._materials=[],e._font_chars_dic=new Object,e._ascent=0,e._descent=0,e._current_size=0,e._size_multiply=0,e._init_size=0,e._texture_width=0,e._texture_height=0,e._adjust_size=0,e}return i(e,t),e.prototype.getGlyphCount=function(){return this._font_chars.length},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.initFontSize=function(t){this.fallbackTable&&this.fallbackTable.initFontSize(t),this._adjust_size&&(t*=this._adjust_size),this._current_size!=t&&(this._current_size=t,this._size_multiply=t/this._init_size)},e.prototype.getCharDataCanvas=function(t){var e=this._font_chars_dic[t];return e?[e.x,e.y,e.width,e.height,e.x_offset*this._size_multiply,e.y_offset*this._size_multiply]:[]},e.prototype.getCharData=function(t){var e=this._font_chars_dic[t];if(e){var i=e.height/this._init_size*this._current_size,n=e.width/this._init_size*this._current_size;return[e.x/this._texture_width,e.y/this._texture_height,e.width/this._texture_width,e.height/this._texture_height,e.x_offset*this._size_multiply,e.y_offset*this._size_multiply,i,n]}return[]},e.prototype.getCharVertCnt=function(t){return 24},Object.defineProperty(e.prototype,"texture_width",{get:function(){return this._texture_width},set:function(t){this._texture_width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture_height",{get:function(){return this._texture_height},set:function(t){this._texture_height=t},enumerable:!0,configurable:!0}),e.prototype.hasChar=function(t){return null!=this._font_chars_dic[t]},e.prototype.getCharWidth=function(t){var e=this._font_chars_dic[t];return e?this._size_multiply*e.x_advance:0},e.prototype.fillTextRun=function(t,e,i,n){},e.prototype.getLineHeight=function(){return this._current_size},e.prototype.dispose=function(){for(var t=this._materials.length,e=0;e<t;++e)this._materials[e].dispose();this._materials.length=0,this._font_chars.length=0,this._font_chars_dic=null},e.prototype.addMaterial=function(t){this._materials.push(t)},e.prototype.getMaterial=function(t){return void 0===t&&(t=0),this._materials[t]},Object.defineProperty(e.prototype,"ascent",{get:function(){return this._ascent},set:function(t){this._ascent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descent",{get:function(){return this._descent},set:function(t){this._descent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offset_x",{get:function(){return this._offset_x},set:function(t){this._offset_x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offset_y",{get:function(){return this._offset_y},set:function(t){this._offset_y=t},enumerable:!0,configurable:!0}),e.prototype.get_font_chars=function(){return this._font_chars},e.prototype.get_font_em_size=function(){return this._font_em_size},e.prototype.set_whitespace_width=function(t){this._whitespace_width=t},e.prototype.get_whitespace_width=function(){return this._whitespace_width},e.prototype.set_font_em_size=function(t){this._font_em_size=t},e.prototype.getChar=function(t){return this._font_chars_dic[t]},e.prototype.setChar=function(t,e,i,n,r,o,s,a,l,u){var c=new bc(t,e,i,n,r,o,s,a,l,u);this._font_chars.push(c),this._font_chars_dic[t]=c},e.assetType="[asset BitmapFontTable]",e}(p),Cc=function(t){function e(){var e=t.call(this)||this;return e._font_styles=[],e.fontName=null,e.regularFontStyle=null,e}return i(e,t),e.registerFont=function(t){},Object.defineProperty(e.prototype,"font_styles",{get:function(){return this._font_styles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){for(var t=this._font_styles.length,e=0;e<t;++e)this._font_styles[e].dispose();this._font_styles.length=0},e.prototype.replace_font_table=function(t,e){for(var i=this._font_styles.length,n=0;n<i;++n)this._font_styles[n].name==t&&(this._font_styles[n]=e)},e.prototype.get_font_table=function(t,e,i,n){void 0===e&&(e=Dc.assetType),void 0===i&&(i=null),void 0===n&&(n=!0);for(var r=this._font_styles.length,o=0;o<r;++o)if(this._font_styles[o].assetType==e&&this._font_styles[o].name==t)return this._font_styles[o];if(!n)return null;var s=null;return e==Dc.assetType?s=new Dc(i):e==xc.assetType&&(s=new xc),s.name=t,s.font=this,this._font_styles.push(s),s},e.assetType="[asset Font]",e}(p),wc=function(){function t(){}return t.getDefaultFont=function(){return this._default_font||this.setDefaultFont(),this._default_font},t.applySharedFonts=function(t){if(t!==this.shared_fonts_ns){this._registered_fonts[t]||(this._registered_fonts[t]={}),this._registered_fonts[this.shared_fonts_ns]||(this._registered_fonts[this.shared_fonts_ns]={}),this._default_font||this._registered_fonts[this.shared_fonts_ns].arial&&(this._default_font=this._registered_fonts[this.shared_fonts_ns].arial);var e=this._registered_fonts[this.shared_fonts_ns];for(var i in e){if(this._registered_fonts[t][i])for(var n=this._registered_fonts[this.shared_fonts_ns][i].font_styles.length,r=0;r<n;r++){var o=this._registered_fonts[this.shared_fonts_ns][i].font_styles[r],s=this._registered_fonts[t][i].get_font_table(o.name,Dc.assetType,null,!1);s?s.getGlyphCount()||this._registered_fonts[t][i].replace_font_table(o.name,o):this._registered_fonts[t][i].font_styles.push(o)}else this._registered_fonts[t][i]=e[i];this._registered_fonts[t][i].font&&(this._registered_fonts[t][i]=e[i])}}},t.defineFont=function(t,e){void 0===e&&(e=p.DEFAULT_NAMESPACE),this._registered_fonts||(this._registered_fonts={}),this._registered_fonts[e]||(this._registered_fonts[e]={});var i=this._registered_fonts[e][t];return i||(-1===this._namespaces.indexOf(e)&&this._namespaces.push(e),(i=new Cc).name=t,this._default_font,this._registered_fonts[e][t]=i,i)},t.registerFontForClassName=function(t,e){this._registered_fonts_by_className[e]=t},t.getFont=function(t,e){if(void 0===e&&(e=void 0),!t)return this.getDefaultFont();if(this._registered_fonts_by_className[t])return this._registered_fonts_by_className[t];var i=e||p.DEFAULT_NAMESPACE;this._registered_fonts||(this._registered_fonts={}),this._registered_fonts[i]||(this._registered_fonts[i]={});var n=this._registered_fonts[i][t];if(n)return n;if(this._namespaces.length>0&&!e)for(var r=0,o=this._namespaces;r<o.length;r++){var s=o[r];if(this._registered_fonts[s][t])return this._registered_fonts[s][t]}return this.getDefaultFont()},t.getFontTable=function(t,e){if(!t)return this.getDefaultFont().get_font_table(yc.STANDART)},t.setDefaultFont=function(t){void 0===t&&(t=null),this.deviceFont=this._default_font=t||new Cc},t.clearAll=function(){this._default_font=null,this._registered_fonts={},this.shared_fonts_ns=null},t._registered_fonts={},t._registered_fonts_by_className={},t._namespaces=[],t.deviceFont=null,t}(),Ic=Object.create(null);function Ec(t,e){void 0===e&&(e="");var i=Ic[t._id+e];return Ic[t._id+e]=!0,!i}var Sc,Dc=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;if(i._fntSizeLimit=-1,i._font_chars=[],i._font_chars_dic=Object.create(null),i._current_size=0,i._size_multiply=0,i._ascent=0,i._descent=0,i._usesCurves=!1,i._glyphIdxToChar={},i._fnt_channels=[],i._font_em_size=32,e){i._opentype_font=e,i._font_em_size=72,i._ascent=e.tables.hhea.ascender/(i._opentype_font.unitsPerEm/72),i._descent=e.tables.hhea.descender/(i._opentype_font.unitsPerEm/72)-2,i._current_size=0,i._size_multiply=0;var n=i._opentype_font.charToGlyph(String.fromCharCode(32));return n&&(i._whitespace_width=n.advanceWidth/(i._opentype_font.unitsPerEm/72)),i}return i}return i(e,t),Object.defineProperty(e.prototype,"fallbackTable",{get:function(){return wc.deviceFont&&wc.deviceFont.font_styles[0]!=this?wc.deviceFont.font_styles[0]:null},enumerable:!0,configurable:!0}),e.prototype.addFNTChannel=function(t){this._fnt_channels.push(t)},e.prototype.getGlyphCount=function(){return this._font_chars.length},e.prototype._drawDebugRect=function(t,e,i,n,r){t[t.length]=e,t[t.length]=n,t[t.length]=e+1,t[t.length]=r,t[t.length]=e,t[t.length]=r,t[t.length]=e,t[t.length]=n,t[t.length]=e+1,t[t.length]=n,t[t.length]=e+1,t[t.length]=r,t[t.length]=i,t[t.length]=n,t[t.length]=i-1,t[t.length]=r,t[t.length]=i,t[t.length]=r,t[t.length]=i,t[t.length]=n,t[t.length]=i-1,t[t.length]=n,t[t.length]=i-1,t[t.length]=r,t[t.length]=e+1,t[t.length]=n,t[t.length]=e+1,t[t.length]=n+1,t[t.length]=i-1,t[t.length]=n,t[t.length]=e+1,t[t.length]=n+1,t[t.length]=i-1,t[t.length]=n+1,t[t.length]=i-1,t[t.length]=n,t[t.length]=e+1,t[t.length]=r,t[t.length]=e+1,t[t.length]=r-1,t[t.length]=i-1,t[t.length]=r,t[t.length]=e+1,t[t.length]=r-1,t[t.length]=i-1,t[t.length]=r-1,t[t.length]=i-1,t[t.length]=r},e.prototype.generateFNTTextures=function(t,e,i){if(console.log("generateFNTTextures"),e&&(this._fntSizeLimit=.5*e,this.initFontSize(e)),this._opentype_font)for(var n=0;n<this._opentype_font.glyphs.length;n++){var r=this._opentype_font.charToGlyph(String.fromCharCode(this._opentype_font.glyphs.glyphs[n].unicode));if(r){var o=r.getPath(),s=new wa,a=0,l=o.commands.length,u=0,c=0,h=this._ascent;for(a=0;a<l;a++){var p=o.commands[a];"M"===p.type?(s.moveTo(p.x,p.y+h),u=p.x,c=p.y+h):"L"===p.type?s.lineTo(p.x,p.y+h):"Q"===p.type?s.curveTo(p.x1,p.y1+h,p.x,p.y+h):"C"===p.type?s.cubicCurveTo(p.x1,p.y1+h,p.x2,p.y2+h,p.x,p.y+h):"Z"===p.type&&s.lineTo(u,c)}var d=new vc(null,null,s);d.char_width=r.advanceWidth*(1/r.path.unitsPerEm*72),d.fill_data=va.pathToAttributesBuffer(s,!0),d.fill_data?(this._font_chars.push(d),this._font_chars_dic[this._opentype_font.glyphs.glyphs[n].unicode]=d):console.log("error tesselating opentype glyph",this._opentype_font.glyphs.glyphs[n])}else console.log("no char found for",this._opentype_font.glyphs.glyphs[n])}var f,_,m,g,y=0,A=0,v=[[]],b=0,x=[],C=Number.MIN_VALUE,w=Number.MIN_VALUE,I=Number.MAX_VALUE,E=Number.MAX_VALUE,S=0,D=0,P=0;for(a=0;a<this._font_chars.length;a++){for(f=this._font_chars[a].fill_data,_=new Float32Array(f.buffer),C=Number.MIN_VALUE,w=Number.MIN_VALUE,I=Number.MAX_VALUE,E=Number.MAX_VALUE,S=0,D=0,m=0;m<f.count;m++)(S=_[2*m])<E&&(E=S),S>w&&(w=S),(D=_[2*m+1])<I&&(I=D),D>C&&(C=D);this._font_chars[a].fnt_rect=new Y(E/this._font_chars[a].char_width,I/this._font_em_size,(w-E)/this._font_chars[a].char_width,(C-I)/this._font_em_size),P+=(w-E+t+t)*(C-I+t+t),x[x.length]={idx:a,minx:E,miny:I,width:w-E,height:C-I}}x.sort((function(t,e){return t.height>e.height?-1:1}));var B=0;g=i;var M,O=1;if(e)this.initFontSize(e),O=this._size_multiply;else{O=g/Math.sqrt(P)*1.2;for(var L=!0,R=0;L;){L=!1,y=0,A=t;for(a=0;a<x.length;a++){if(R=x[a].height*O,S=0,D=0,(y+=t)+x[a].width*O+t>=g&&(y=t,A+=B+2*t,B=0),R>B&&(B=R),A+R+2*t>=g){L=!0,O*=.995;break}y+=x[a].width*O+t}}}this._fntSizeLimit=O*this._font_em_size*.5,y=0,A=t;for(a=0;a<x.length;a++){for(f=(M=this._font_chars[x[a].idx]).fill_data,_=new Float32Array(f.buffer),E=x[a].minx,w=Number.MIN_VALUE,I=x[a].miny,C=Number.MIN_VALUE,S=0,D=0,(y+=t)+x[a].width*O+t>=g&&(y=t,A+=B+2*t,B=0),x[a].height*=O,x[a].height>B&&(B=x[a].height),A+B+2*t>=g&&(y=t,A=t,B=0,v[++b]=[]),M.fnt_channel=b,m=0;m<f.count;m++)S=(_[2*m]-E)*O+y,D=(_[2*m+1]-I)*O+A,v[b][v[b].length]=S,v[b][v[b].length]=D,S>w&&(w=S),D>C&&(C=D);M.fnt_uv=new Y(y/g,1-A/g,(w-y)/g,(C-A)/g),y+=x[a].width*O+t}var N=[];for(a=0;a<v.length;a++){var F=new On(Float32Array,2);F.set(v[a]);var k=F.attributesBuffer.cloneBufferView();F.dispose();var V=new Us(k);V.setPositions(new Nn(k));var U=qs.getShape(V),j=new Ze;U.style=new or;var G=$s.get_material_for_color(16777215,1);U.material=G.material,G.colorPos&&(U.style.addSamplerAt(j,U.material.getTextureAt(0)),U.material.animateUVs=!0,U.style.uvMatrix=new T(0,0,0,0,G.colorPos.x,G.colorPos.y)),N[a]=U}return N},e.prototype.getRatio=function(t){return this._size_multiply},e.prototype.hasChar=function(t){var e=!!this._font_chars_dic[t];return!e&&this._opentype_font&&(e=!!this._opentype_font.charToGlyph(String.fromCharCode(parseInt(t)))),!e&&this.fallbackTable&&(e=!!this.fallbackTable.hasChar(t)),e},e.prototype.changeOpenTypeFont=function(t,e){void 0===e&&(e=!0),e&&this._opentype_font,this._opentype_font=t},e.prototype.initFontSize=function(t){this.fallbackTable&&this.fallbackTable.initFontSize(t),this._current_size!==t&&(this._current_size=t,this._size_multiply=t/this._font_em_size,this._size_multiply)},e.prototype.getCharVertCnt=function(t){var e=this._font_chars_dic[t];return e?e.fill_data.length:0},e.prototype.getCharWidth=function(t){var i=this._whitespace_width*this._size_multiply||e.DEFAULT_SPACE;if("32"==t)return(20*i|0)/20;if("9"==t)return 8*i*20/20;var n=this.getChar(t);return n?Math.floor(n.char_width*this._size_multiply*20)/20:"9679"==t?(n=this.createPointGlyph_9679(),Math.floor(n.char_width*this._size_multiply*20)/20):this.fallbackTable?this.fallbackTable.getCharWidth(t):0},Object.defineProperty(e.prototype,"usesCurves",{get:function(){return this._usesCurves},enumerable:!0,configurable:!0}),e.prototype.getLineHeight=function(){return this._size_multiply*(this._ascent-this.descent)},e.prototype.getUnderLineHeight=function(){return this._size_multiply*(this._ascent-this.descent/2)},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){for(var t=0;t<this._font_chars.length;t++)this._font_chars[t].dispose();this._font_chars.length=0,this._font_chars_dic=null},Object.defineProperty(e.prototype,"fntSizeLimit",{get:function(){return this._fntSizeLimit},set:function(t){this._fntSizeLimit=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ascent",{get:function(){return this._ascent},set:function(t){this._ascent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descent",{get:function(){return this._descent},set:function(t){this._descent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offset_x",{get:function(){return this._offset_x},set:function(t){this._offset_x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offset_y",{get:function(){return this._offset_y},set:function(t){this._offset_y=t},enumerable:!0,configurable:!0}),e.prototype.get_font_chars=function(){return this._font_chars},e.prototype.get_font_em_size=function(){return this._font_em_size},e.prototype.set_whitespace_width=function(t){this._whitespace_width=t},e.prototype.get_whitespace_width=function(){return this._whitespace_width},e.prototype.set_font_em_size=function(t){this._font_em_size=t},e.prototype.buildTextLineFromIndices=function(t,e,i,n,r,o){var s,a,l,u,c,h=t.getTextShapeForIdentifierAndFormat(e.color.toString(),e),p=i;n-=this._ascent*this._size_multiply;var d=0,f=0,_=r.length;for(f=0;f<_;f++){if(d=r[f],s=this._glyphIdxToChar[d],c=this._size_multiply,s){if(null==s.fill_data&&(1==s.fill_data_path.commands[0][0]&&0==s.fill_data_path.data[0][0]&&0==s.fill_data_path.data[0][1]&&(s.fill_data_path.data[0].shift(),s.fill_data_path.data[0].shift(),s.fill_data_path.commands[0].shift(),s.fill_data_path.commands[0][0]=2),s.fill_data=va.pathToAttributesBuffer(s.fill_data_path,!0)),a=s.fill_data)if(l=new Float32Array(a.buffer),this.usesCurves)for(u=0;u<a.count;u++)h.verts[h.verts.length]=l[3*u]*c+i,h.verts[h.verts.length]=l[3*u+1]*c+n,h.verts[h.verts.length]=l[3*u+2];else for(u=0;u<a.count;u++)h.verts[h.verts.length]=l[2*u]*c+i,h.verts[h.verts.length]=l[2*u+1]*c+n}else;i+=o[f]}return new D(i-p,this.getLineHeight())},e.prototype.fillTextRun=function(t,e,i,n,r){var o,s,a=this._fntSizeLimit>=0&&(0==this._fntSizeLimit||this._fntSizeLimit>=e.size),l=t.getTextShapeForIdentifierAndFormat(e.color.toString()+a.toString()+"0",e),u={},c={};a&&(O=w.float32ColorToARGB(e.color),(B=new ac(this._fnt_channels[0])).colorTransform=new I(O[1]/255,O[2]/255,O[3]/255),B.bothSides=!0,B.alphaBlending=!0,B.useColorTransform=!0,B.style.sampler=new Ze(!1,!0,!0)),l.fntMaterial=a?B:null,u[e.color.toString()+a.toString()+"0"]=l;var h,p,d,f,_,m=null,g=0,y=i+5*n,A=0,v=0,b=0,x=0,C=0,E=t.selectionBeginIndex,S=t.selectionEndIndex,D=0;for(t.selectable&&((s=e.clone()).color=16777215,o=t.getTextShapeForIdentifierAndFormat(a.toString()+"0",s),c[a.toString()+"0"]=o,(B=new ac(this._fnt_channels[0])).bothSides=!0,B.alphaBlending=!0,B.useColorTransform=!0,B.style.sampler=new Ze(!1,!0,!0),o.fntMaterial=a?B:null,s.underline&&i+1<t.words.length&&(D=t.words[i+1]),t.selectionEndIndex<t.selectionBeginIndex&&(E=t.selectionEndIndex,S=t.selectionBeginIndex)),r&&(l.verts.length=t.last_word_vertices_count||0),g=i;g<y;g+=5)if(!(g<t._words_amount_prev)){for(g==y-5&&(t.last_word_vertices_count=l.verts.length),C=t.words[g],b=t.words[g+1],x=t.words[g+2],v=C+t.words[g+4],A=C;A<v;A++)if(m=t.isInFocus&&A>=E&&A<S?o:l,32!=t.chars_codes[A]&&9!=t.chars_codes[A])if(h=this.getChar(t.chars_codes[A].toString()),_=this._size_multiply,!h&&this.fallbackTable&&(h=this.fallbackTable.getChar(t.chars_codes[A].toString()),_=this.fallbackTable._size_multiply),h){if(a){var T=m.format,P=t.isInFocus&&A>=E&&A<S?c[a.toString()+h.fnt_channel]:u[T.color.toString()+a.toString()+h.fnt_channel];if(!P){var B,M=t.getTextShapeForIdentifierAndFormat(T.color.toString()+a.toString()+h.fnt_channel.toString(),T),O=w.float32ColorToARGB(T.color);(B=new ac(this._fnt_channels[h.fnt_channel])).colorTransform=new I(O[1]/255,O[2]/255,O[3]/255),B.bothSides=!0,B.alphaBlending=!0,B.useColorTransform=!0,B.style.sampler=new Ze(!1,!0,!0),M.fntMaterial=B,u[T.color.toString()+a.toString()+h.fnt_channel]=M,P=M}var L=b+h.char_width*_*h.fnt_rect.x,R=L+h.char_width*_*h.fnt_rect.width,N=x+this._font_em_size*_*h.fnt_rect.y,F=N+this._font_em_size*_*h.fnt_rect.height;P.verts[P.verts.length]=L,P.verts[P.verts.length]=N,P.verts[P.verts.length]=h.fnt_uv.x,P.verts[P.verts.length]=h.fnt_uv.y,P.verts[P.verts.length]=R,P.verts[P.verts.length]=N,P.verts[P.verts.length]=h.fnt_uv.x+h.fnt_uv.width,P.verts[P.verts.length]=h.fnt_uv.y,P.verts[P.verts.length]=R,P.verts[P.verts.length]=F,P.verts[P.verts.length]=h.fnt_uv.x+h.fnt_uv.width,P.verts[P.verts.length]=h.fnt_uv.y-h.fnt_uv.height,P.verts[P.verts.length]=L,P.verts[P.verts.length]=N,P.verts[P.verts.length]=h.fnt_uv.x,P.verts[P.verts.length]=h.fnt_uv.y,P.verts[P.verts.length]=L,P.verts[P.verts.length]=F,P.verts[P.verts.length]=h.fnt_uv.x,P.verts[P.verts.length]=h.fnt_uv.y-h.fnt_uv.height,P.verts[P.verts.length]=R,P.verts[P.verts.length]=F,P.verts[P.verts.length]=h.fnt_uv.x+h.fnt_uv.width,P.verts[P.verts.length]=h.fnt_uv.y-h.fnt_uv.height}else if(p=h.fill_data,d=new Float32Array(p.buffer),this.usesCurves)for(f=0;f<p.count;f++)m.verts[m.verts.length]=d[3*f]*_+b,m.verts[m.verts.length]=d[3*f+1]*_+x,m.verts[m.verts.length]=d[3*f+2];else for(f=0;f<p.count;f++)m.verts[m.verts.length]=d[2*f]*_+b,m.verts[m.verts.length]=d[2*f+1]*_+x;b+=h.char_width*_}else Ec(this,"miss"+t.chars_codes[A])&&console.debug("[TesselatedFontTable] Error: char not found in fontTable",t.chars_codes[A],String.fromCharCode(t.chars_codes[A]));var k=.25*t.internalScale.y,V=x+this.getUnderLineHeight()+k,U=x+this.getUnderLineHeight()-k;t.selectable&&s.underline&&i+1<t.words.length&&(m.verts[m.verts.length]=D,m.verts[m.verts.length]=U,m.verts[m.verts.length]=D,m.verts[m.verts.length]=V,m.verts[m.verts.length]=b,m.verts[m.verts.length]=V,m.verts[m.verts.length]=b,m.verts[m.verts.length]=V,m.verts[m.verts.length]=b,m.verts[m.verts.length]=U,m.verts[m.verts.length]=D,m.verts[m.verts.length]=U)}d=null},e.prototype.createPointGlyph_9679=function(){var t=[];ta.drawElipse(this._font_em_size/2,this._font_em_size/2,this._font_em_size/8,this._font_em_size/8,t,0,360,5,!1);var e=new On(Float32Array,2);e.set(t);var i=e.attributesBuffer.cloneBufferView();e.dispose();var n=new vc(i,null,null);return n.char_width=this._font_em_size,this._font_chars.push(n),this._font_chars_dic[9679]=n,n},e.prototype.getChar=function(t){if(null==(i=this._font_chars_dic[t])){if(this._opentype_font){var e=this._opentype_font.charToGlyph(String.fromCharCode(parseInt(t)));if(e){var i,n=e.getPath(),r=new wa,o=0,s=n.commands.length,a=0,l=0,u=this._ascent;for(o=0;o<s;o++){var c=n.commands[o];"M"===c.type?(r.moveTo(c.x,c.y+u),a=c.x,l=c.y+u):"L"===c.type?r.lineTo(c.x,c.y+u):"Q"===c.type?r.curveTo(c.x1,c.y1+u,c.x,c.y+u):"C"===c.type?r.cubicCurveTo(c.x1,c.y1+u,c.x2,c.y2+u,c.x,c.y+u):"Z"===c.type&&r.lineTo(a,l)}if((i=new vc(null,null,r)).char_width=e.advanceWidth*(1/e.path.unitsPerEm*72),i.fill_data=va.pathToAttributesBuffer(r,!0),!i.fill_data)return Ec(this,"tess"+t)&&console.debug("[TesselatedFontTable] Error:tesselating opentype glyph:",t.charCodeAt(0)),null;this._font_chars.push(i),this._font_chars_dic[t]=i}}"9679"==t&&(i=this.createPointGlyph_9679())}else if(null==i.fill_data&&null==i.stroke_data&&null!=i.fill_data_path&&(1==i.fill_data_path.commands[0][0]&&0==i.fill_data_path.data[0][0]&&0==i.fill_data_path.data[0][1]&&(i.fill_data_path.data[0].shift(),i.fill_data_path.data[0].shift(),i.fill_data_path.commands[0].shift(),i.fill_data_path.commands[0][0]=2),i.fill_data=va.pathToAttributesBuffer(i.fill_data_path,!0),!i.fill_data))return Ec(this,"tess"+t)&&console.debug("[TesselatedFontTable] Error:tesselating glyph:",t.charCodeAt(0)),null;return i},e.prototype.setChar=function(t,e,i,n,r,o,s){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=!1),void 0===o&&(o=0),void 0===s&&(s=null),e=Math.floor(20*e)/20,null==i&&null==n&&null==s)throw"TesselatedFontTable: trying to create a TesselatedFontChar with no data (fills_data, stroke_data and fill_data_path is null)";if(this._font_chars.length>0){if(r!=this._usesCurves)throw"TesselatedFontTable: Can not set different types of graphic-glyphs (curves vs non-cuves) on the same FontTable!"}else this._usesCurves=r;var a=new vc(i,n,s);a.char_width=e,a.glyph_idx=o,a.name=t,this._glyphIdxToChar[o]=a,this._font_chars.push(a),this._font_chars_dic[t]=a},e.prototype.buildTextRuns=function(t,e){if(2*t.length!=e.length)throw"Invalid data passed to TesselatedFontTable.buildTextRuns(). output_verts.length is not double textRuns.length.";var i,n=0,r=0,o=0,s=0,a=0,l=t.length;for(n=0;n<l;n++)for((i=t[n])[0],r=i[1],i[2],a=i.length,s=3;s<a;s+=2){if(o=i[s],i[s+1],this.getChar(o.toString()),(r==Os.BOTH||r==Os.STROKE)&&null==e[2*n])throw"Trying to render strokes for a textrun, but no output_vert list was set for this textrun strokes";if((r==Os.BOTH||r==Os.FILL)&&null==e[2*n+1])throw"Trying to render fills for a textrun, but no output_vert list was set for this textrun fills"}},e.assetType="[asset TesselatedFontTable]",e.DEFAULT_SPACE=14,e}(p),Tc=["font","align","leftMargin","rightMargin","indent","size","color","bold","italic","underline","leading","letterSpacing","style_name","font_table"],Pc=function(t){function e(e,i,n,r,o,s,a,l,u,c,h,p,d){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===c&&(c=null),void 0===h&&(h=null),void 0===p&&(p=null),void 0===d&&(d=null);var f=t.call(this)||this;return f._updateID=0,f.tabStops=[],f._size=i,f._color=n,f._bold=r,f._italic=o,f._underline=s,f.url=a,f.link_target=l,f._align=u,f._leftMargin=c,f._rightMargin=h,f._indent=p,f._leading=d,f._letterSpacing=null,f._font_table=null,f._style_name=yc.STANDART,"string"==typeof e?f._setFontFromString(e):f._font=e,f}return i(e,t),Object.defineProperty(e.prototype,"updateID",{get:function(){return this._updateID},enumerable:!0,configurable:!0}),e.prototype.hasPropertySet=function(t){return null!==this["_"+t]},Object.defineProperty(e.prototype,"align",{get:function(){return this._align?this._align:Ac.LEFT},set:function(t){this._align!==t&&this._updateID++,this._align=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blockIndent",{get:function(){return this._blockIndent?this._blockIndent:0},set:function(t){this._blockIndent!==t&&this._updateID++,this._blockIndent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this._leftMargin?this._leftMargin:0},set:function(t){t!==this._leftMargin&&this._updateID++,this._leftMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this._rightMargin?this._rightMargin:0},set:function(t){t!==this._rightMargin&&this._updateID++,this._rightMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indent",{get:function(){return this._indent?this._indent:0},set:function(t){t!==this._indent&&this._updateID++,this._indent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return null!==this._color?this._color:0},set:function(t){t!==this._color&&this._updateID++,this._color=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kerning",{get:function(){return!!this._kerning&&this._kerning},set:function(t){t!==this._kerning&&this._updateID++,this._kerning=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leading",{get:function(){return this._leading?this._leading:0},set:function(t){t!==this._leading&&this._updateID++,this._leading=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing?this._letterSpacing:0},set:function(t){t!==this._letterSpacing&&this._updateID++,this._letterSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size?this._size:12},set:function(t){t!==this._size&&this._updateID++,this._size=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return!!this._bold&&this._bold},set:function(t){t!==this._bold&&this._updateID++,this._bold=t,this._font&&(this.font_table=this.font.get_font_table(yc.STANDART,Dc.assetType))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return!!this._italic&&this._italic},set:function(t){t!==this._italic&&this._updateID++,this._italic=t,this._font&&(this.font_table=this.font.get_font_table(yc.STANDART,Dc.assetType))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return!!this._underline&&this._underline},set:function(t){t!==this._underline&&this._updateID++,this._underline=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font_table",{get:function(){return this._font_table||(this.font_table=this.font.get_font_table(yc.STANDART,Dc.assetType)),this._font_table},set:function(t){t!==this._font_table&&this._updateID++,this._font_table=t,this._style_name=this._font_table.name,this._style_name==yc.ITALIC&&(this._italic=!0),this._style_name==yc.BOLD&&(this._bold=!0),this._style_name==yc.BOLDITALIC&&(this._bold=!0,this._italic=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font_name",{get:function(){var t;return null===(t=this.font)||void 0===t?void 0:t.fontName},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style_name",{get:function(){return this._style_name},set:function(t){t!==this._style_name&&this._updateID++,this._style_name=t,this._style_name!=yc.BOLD&&this._style_name!=yc.BOLDITALIC||(this._bold=!0),this._style_name!=yc.ITALIC&&this._style_name!=yc.BOLDITALIC||(this._italic=!0),this._font&&(this.font_table=this.font.get_font_table(yc.STANDART,Dc.assetType))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return this._font||(this._font=wc.getFont(null),this._font_table=this._font.get_font_table(yc.STANDART,Dc.assetType)),this._font},set:function(t){"string"!=typeof t?(t!==this._font&&this._updateID++,this._font=t,this._font_table=this._font.get_font_table(yc.STANDART,Dc.assetType)):this._setFontFromString(t)},enumerable:!0,configurable:!0}),e.prototype._setFontFromString=function(t){var e=wc.getFont(t);e&&(this._style_name=yc.STANDART),this.font=e},e.prototype.clone=function(){return new e(this._font,this._size,this._color,this._bold,this._italic,this._underline,this.url,this.link_target,this._align,this._leftMargin,this._rightMargin,this._indent,this._leading)},e.prototype.applyToFormat=function(t){for(var e=0,i=Tc;e<i.length;e++){var n=i[e];null!==this["_"+n]&&(t[n]=this["_"+n])}return t},e.prototype.mergeFormat=function(t){for(var e=0,i=Tc;e<i.length;e++){var n=i[e];this["_"+n]!==t[n]&&(this["_"+n]=null)}},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.assetType="[asset TextFormat]",e}(p),Bc=function(t,e,i,n,r,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=0),this.x=t,this.width=e,this.height=i,this.ascent=n,this.descent=r,this.leading=o},Mc=function(t){function e(e,i,n){void 0===n&&(n=0);var r=t.call(this,e)||this;return r._char=i,r._charCode=n,r.isShift=!1,r.isCTRL=!1,r.isAlt=!1,r}return i(e,t),Object.defineProperty(e.prototype,"char",{get:function(){return this._char},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"charCode",{get:function(){return this._charCode},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._char,this._charCode)},e.KEYDOWN="keydown",e.KEYUP="keyup",e}(a),Oc=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.clone=function(){return new e(this.type)},e.CHANGED="onChanged",e}(a),Lc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._acceptTraverser=function(t){var e=this.parentTextField;if(e.reConstruct(!0),e._textFormat&&!e._textFormat.font_table.isAsset(Dc)&&!e._textFormat.material){e.transform.colorTransform||(e.transform.colorTransform=new I);this.transform.colorTransform.color=null!=e.textColor?e.textColor:e._textFormat.color,this._invalidateHierarchicalProperties(Dt.COLOR_TRANSFORM)}this._graphics._acceptTraverser(t)},e}(ka),Rc=function(){this.verts=[]};class Nc{constructor(){this.childNodes=[]}get innerText(){return this.rawText}}!function(t){t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE"}(Sc||(Sc={}));var Fc=Sc;class kc extends Nc{constructor(t){super(),this.rawText=t,this.nodeType=Fc.COMMENT_NODE}get text(){return this.rawText}toString(){return`\x3c!--${this.rawText}--\x3e`}}var Vc="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Uc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function jc(t,e){return t(e={exports:{}},e.exports),e.exports}var Gc=jc((function(t,e){!function(i){var n=e,r=t&&t.exports==n&&t,o="object"==typeof Vc&&Vc;o.global!==o&&o.window!==o||(i=o);var s=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,a=/[\x01-\x7F]/g,l=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,u=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,c={"­":"shy","‌":"zwnj","‍":"zwj","‎":"lrm","⁣":"ic","⁢":"it","⁡":"af","‏":"rlm","​":"ZeroWidthSpace","⁠":"NoBreak","̑":"DownBreve","⃛":"tdot","⃜":"DotDot","\t":"Tab","\n":"NewLine"," ":"puncsp"," ":"MediumSpace"," ":"thinsp"," ":"hairsp"," ":"emsp13"," ":"ensp"," ":"emsp14"," ":"emsp"," ":"numsp"," ":"nbsp","  ":"ThickSpace","‾":"oline",_:"lowbar","‐":"dash","–":"ndash","—":"mdash","―":"horbar",",":"comma",";":"semi","⁏":"bsemi",":":"colon","⩴":"Colone","!":"excl","¡":"iexcl","?":"quest","¿":"iquest",".":"period","‥":"nldr","…":"mldr","·":"middot","'":"apos","‘":"lsquo","’":"rsquo","‚":"sbquo","‹":"lsaquo","›":"rsaquo",'"':"quot","“":"ldquo","”":"rdquo","„":"bdquo","«":"laquo","»":"raquo","(":"lpar",")":"rpar","[":"lsqb","]":"rsqb","{":"lcub","}":"rcub","⌈":"lceil","⌉":"rceil","⌊":"lfloor","⌋":"rfloor","⦅":"lopar","⦆":"ropar","⦋":"lbrke","⦌":"rbrke","⦍":"lbrkslu","⦎":"rbrksld","⦏":"lbrksld","⦐":"rbrkslu","⦑":"langd","⦒":"rangd","⦓":"lparlt","⦔":"rpargt","⦕":"gtlPar","⦖":"ltrPar","⟦":"lobrk","⟧":"robrk","⟨":"lang","⟩":"rang","⟪":"Lang","⟫":"Rang","⟬":"loang","⟭":"roang","❲":"lbbrk","❳":"rbbrk","‖":"Vert","§":"sect","¶":"para","@":"commat","*":"ast","/":"sol",undefined:null,"&":"amp","#":"num","%":"percnt","‰":"permil","‱":"pertenk","†":"dagger","‡":"Dagger","•":"bull","⁃":"hybull","′":"prime","″":"Prime","‴":"tprime","⁗":"qprime","‵":"bprime","⁁":"caret","`":"grave","´":"acute","˜":"tilde","^":"Hat","¯":"macr","˘":"breve","˙":"dot","¨":"die","˚":"ring","˝":"dblac","¸":"cedil","˛":"ogon","ˆ":"circ","ˇ":"caron","°":"deg","©":"copy","®":"reg","℗":"copysr","℘":"wp","℞":"rx","℧":"mho","℩":"iiota","←":"larr","↚":"nlarr","→":"rarr","↛":"nrarr","↑":"uarr","↓":"darr","↔":"harr","↮":"nharr","↕":"varr","↖":"nwarr","↗":"nearr","↘":"searr","↙":"swarr","↝":"rarrw","↝̸":"nrarrw","↞":"Larr","↟":"Uarr","↠":"Rarr","↡":"Darr","↢":"larrtl","↣":"rarrtl","↤":"mapstoleft","↥":"mapstoup","↦":"map","↧":"mapstodown","↩":"larrhk","↪":"rarrhk","↫":"larrlp","↬":"rarrlp","↭":"harrw","↰":"lsh","↱":"rsh","↲":"ldsh","↳":"rdsh","↵":"crarr","↶":"cularr","↷":"curarr","↺":"olarr","↻":"orarr","↼":"lharu","↽":"lhard","↾":"uharr","↿":"uharl","⇀":"rharu","⇁":"rhard","⇂":"dharr","⇃":"dharl","⇄":"rlarr","⇅":"udarr","⇆":"lrarr","⇇":"llarr","⇈":"uuarr","⇉":"rrarr","⇊":"ddarr","⇋":"lrhar","⇌":"rlhar","⇐":"lArr","⇍":"nlArr","⇑":"uArr","⇒":"rArr","⇏":"nrArr","⇓":"dArr","⇔":"iff","⇎":"nhArr","⇕":"vArr","⇖":"nwArr","⇗":"neArr","⇘":"seArr","⇙":"swArr","⇚":"lAarr","⇛":"rAarr","⇝":"zigrarr","⇤":"larrb","⇥":"rarrb","⇵":"duarr","⇽":"loarr","⇾":"roarr","⇿":"hoarr","∀":"forall","∁":"comp","∂":"part","∂̸":"npart","∃":"exist","∄":"nexist","∅":"empty","∇":"Del","∈":"in","∉":"notin","∋":"ni","∌":"notni","϶":"bepsi","∏":"prod","∐":"coprod","∑":"sum","+":"plus","±":"pm","÷":"div","×":"times","<":"lt","≮":"nlt","<⃒":"nvlt","=":"equals","≠":"ne","=⃥":"bne","⩵":"Equal",">":"gt","≯":"ngt",">⃒":"nvgt","¬":"not","|":"vert","¦":"brvbar","−":"minus","∓":"mp","∔":"plusdo","⁄":"frasl","∖":"setmn","∗":"lowast","∘":"compfn","√":"Sqrt","∝":"prop","∞":"infin","∟":"angrt","∠":"ang","∠⃒":"nang","∡":"angmsd","∢":"angsph","∣":"mid","∤":"nmid","∥":"par","∦":"npar","∧":"and","∨":"or","∩":"cap","∩︀":"caps","∪":"cup","∪︀":"cups","∫":"int","∬":"Int","∭":"tint","⨌":"qint","∮":"oint","∯":"Conint","∰":"Cconint","∱":"cwint","∲":"cwconint","∳":"awconint","∴":"there4","∵":"becaus","∶":"ratio","∷":"Colon","∸":"minusd","∺":"mDDot","∻":"homtht","∼":"sim","≁":"nsim","∼⃒":"nvsim","∽":"bsim","∽̱":"race","∾":"ac","∾̳":"acE","∿":"acd","≀":"wr","≂":"esim","≂̸":"nesim","≃":"sime","≄":"nsime","≅":"cong","≇":"ncong","≆":"simne","≈":"ap","≉":"nap","≊":"ape","≋":"apid","≋̸":"napid","≌":"bcong","≍":"CupCap","≭":"NotCupCap","≍⃒":"nvap","≎":"bump","≎̸":"nbump","≏":"bumpe","≏̸":"nbumpe","≐":"doteq","≐̸":"nedot","≑":"eDot","≒":"efDot","≓":"erDot","≔":"colone","≕":"ecolon","≖":"ecir","≗":"cire","≙":"wedgeq","≚":"veeeq","≜":"trie","≟":"equest","≡":"equiv","≢":"nequiv","≡⃥":"bnequiv","≤":"le","≰":"nle","≤⃒":"nvle","≥":"ge","≱":"nge","≥⃒":"nvge","≦":"lE","≦̸":"nlE","≧":"gE","≧̸":"ngE","≨︀":"lvnE","≨":"lnE","≩":"gnE","≩︀":"gvnE","≪":"ll","≪̸":"nLtv","≪⃒":"nLt","≫":"gg","≫̸":"nGtv","≫⃒":"nGt","≬":"twixt","≲":"lsim","≴":"nlsim","≳":"gsim","≵":"ngsim","≶":"lg","≸":"ntlg","≷":"gl","≹":"ntgl","≺":"pr","⊀":"npr","≻":"sc","⊁":"nsc","≼":"prcue","⋠":"nprcue","≽":"sccue","⋡":"nsccue","≾":"prsim","≿":"scsim","≿̸":"NotSucceedsTilde","⊂":"sub","⊄":"nsub","⊂⃒":"vnsub","⊃":"sup","⊅":"nsup","⊃⃒":"vnsup","⊆":"sube","⊈":"nsube","⊇":"supe","⊉":"nsupe","⊊︀":"vsubne","⊊":"subne","⊋︀":"vsupne","⊋":"supne","⊍":"cupdot","⊎":"uplus","⊏":"sqsub","⊏̸":"NotSquareSubset","⊐":"sqsup","⊐̸":"NotSquareSuperset","⊑":"sqsube","⋢":"nsqsube","⊒":"sqsupe","⋣":"nsqsupe","⊓":"sqcap","⊓︀":"sqcaps","⊔":"sqcup","⊔︀":"sqcups","⊕":"oplus","⊖":"ominus","⊗":"otimes","⊘":"osol","⊙":"odot","⊚":"ocir","⊛":"oast","⊝":"odash","⊞":"plusb","⊟":"minusb","⊠":"timesb","⊡":"sdotb","⊢":"vdash","⊬":"nvdash","⊣":"dashv","⊤":"top","⊥":"bot","⊧":"models","⊨":"vDash","⊭":"nvDash","⊩":"Vdash","⊮":"nVdash","⊪":"Vvdash","⊫":"VDash","⊯":"nVDash","⊰":"prurel","⊲":"vltri","⋪":"nltri","⊳":"vrtri","⋫":"nrtri","⊴":"ltrie","⋬":"nltrie","⊴⃒":"nvltrie","⊵":"rtrie","⋭":"nrtrie","⊵⃒":"nvrtrie","⊶":"origof","⊷":"imof","⊸":"mumap","⊹":"hercon","⊺":"intcal","⊻":"veebar","⊽":"barvee","⊾":"angrtvb","⊿":"lrtri","⋀":"Wedge","⋁":"Vee","⋂":"xcap","⋃":"xcup","⋄":"diam","⋅":"sdot","⋆":"Star","⋇":"divonx","⋈":"bowtie","⋉":"ltimes","⋊":"rtimes","⋋":"lthree","⋌":"rthree","⋍":"bsime","⋎":"cuvee","⋏":"cuwed","⋐":"Sub","⋑":"Sup","⋒":"Cap","⋓":"Cup","⋔":"fork","⋕":"epar","⋖":"ltdot","⋗":"gtdot","⋘":"Ll","⋘̸":"nLl","⋙":"Gg","⋙̸":"nGg","⋚︀":"lesg","⋚":"leg","⋛":"gel","⋛︀":"gesl","⋞":"cuepr","⋟":"cuesc","⋦":"lnsim","⋧":"gnsim","⋨":"prnsim","⋩":"scnsim","⋮":"vellip","⋯":"ctdot","⋰":"utdot","⋱":"dtdot","⋲":"disin","⋳":"isinsv","⋴":"isins","⋵":"isindot","⋵̸":"notindot","⋶":"notinvc","⋷":"notinvb","⋹":"isinE","⋹̸":"notinE","⋺":"nisd","⋻":"xnis","⋼":"nis","⋽":"notnivc","⋾":"notnivb","⌅":"barwed","⌆":"Barwed","⌌":"drcrop","⌍":"dlcrop","⌎":"urcrop","⌏":"ulcrop","⌐":"bnot","⌒":"profline","⌓":"profsurf","⌕":"telrec","⌖":"target","⌜":"ulcorn","⌝":"urcorn","⌞":"dlcorn","⌟":"drcorn","⌢":"frown","⌣":"smile","⌭":"cylcty","⌮":"profalar","⌶":"topbot","⌽":"ovbar","⌿":"solbar","⍼":"angzarr","⎰":"lmoust","⎱":"rmoust","⎴":"tbrk","⎵":"bbrk","⎶":"bbrktbrk","⏜":"OverParenthesis","⏝":"UnderParenthesis","⏞":"OverBrace","⏟":"UnderBrace","⏢":"trpezium","⏧":"elinters","␣":"blank","─":"boxh","│":"boxv","┌":"boxdr","┐":"boxdl","└":"boxur","┘":"boxul","├":"boxvr","┤":"boxvl","┬":"boxhd","┴":"boxhu","┼":"boxvh","═":"boxH","║":"boxV","╒":"boxdR","╓":"boxDr","╔":"boxDR","╕":"boxdL","╖":"boxDl","╗":"boxDL","╘":"boxuR","╙":"boxUr","╚":"boxUR","╛":"boxuL","╜":"boxUl","╝":"boxUL","╞":"boxvR","╟":"boxVr","╠":"boxVR","╡":"boxvL","╢":"boxVl","╣":"boxVL","╤":"boxHd","╥":"boxhD","╦":"boxHD","╧":"boxHu","╨":"boxhU","╩":"boxHU","╪":"boxvH","╫":"boxVh","╬":"boxVH","▀":"uhblk","▄":"lhblk","█":"block","░":"blk14","▒":"blk12","▓":"blk34","□":"squ","▪":"squf","▫":"EmptyVerySmallSquare","▭":"rect","▮":"marker","▱":"fltns","△":"xutri","▴":"utrif","▵":"utri","▸":"rtrif","▹":"rtri","▽":"xdtri","▾":"dtrif","▿":"dtri","◂":"ltrif","◃":"ltri","◊":"loz","○":"cir","◬":"tridot","◯":"xcirc","◸":"ultri","◹":"urtri","◺":"lltri","◻":"EmptySmallSquare","◼":"FilledSmallSquare","★":"starf","☆":"star","☎":"phone","♀":"female","♂":"male","♠":"spades","♣":"clubs","♥":"hearts","♦":"diams","♪":"sung","✓":"check","✗":"cross","✠":"malt","✶":"sext","❘":"VerticalSeparator","⟈":"bsolhsub","⟉":"suphsol","⟵":"xlarr","⟶":"xrarr","⟷":"xharr","⟸":"xlArr","⟹":"xrArr","⟺":"xhArr","⟼":"xmap","⟿":"dzigrarr","⤂":"nvlArr","⤃":"nvrArr","⤄":"nvHarr","⤅":"Map","⤌":"lbarr","⤍":"rbarr","⤎":"lBarr","⤏":"rBarr","⤐":"RBarr","⤑":"DDotrahd","⤒":"UpArrowBar","⤓":"DownArrowBar","⤖":"Rarrtl","⤙":"latail","⤚":"ratail","⤛":"lAtail","⤜":"rAtail","⤝":"larrfs","⤞":"rarrfs","⤟":"larrbfs","⤠":"rarrbfs","⤣":"nwarhk","⤤":"nearhk","⤥":"searhk","⤦":"swarhk","⤧":"nwnear","⤨":"toea","⤩":"tosa","⤪":"swnwar","⤳":"rarrc","⤳̸":"nrarrc","⤵":"cudarrr","⤶":"ldca","⤷":"rdca","⤸":"cudarrl","⤹":"larrpl","⤼":"curarrm","⤽":"cularrp","⥅":"rarrpl","⥈":"harrcir","⥉":"Uarrocir","⥊":"lurdshar","⥋":"ldrushar","⥎":"LeftRightVector","⥏":"RightUpDownVector","⥐":"DownLeftRightVector","⥑":"LeftUpDownVector","⥒":"LeftVectorBar","⥓":"RightVectorBar","⥔":"RightUpVectorBar","⥕":"RightDownVectorBar","⥖":"DownLeftVectorBar","⥗":"DownRightVectorBar","⥘":"LeftUpVectorBar","⥙":"LeftDownVectorBar","⥚":"LeftTeeVector","⥛":"RightTeeVector","⥜":"RightUpTeeVector","⥝":"RightDownTeeVector","⥞":"DownLeftTeeVector","⥟":"DownRightTeeVector","⥠":"LeftUpTeeVector","⥡":"LeftDownTeeVector","⥢":"lHar","⥣":"uHar","⥤":"rHar","⥥":"dHar","⥦":"luruhar","⥧":"ldrdhar","⥨":"ruluhar","⥩":"rdldhar","⥪":"lharul","⥫":"llhard","⥬":"rharul","⥭":"lrhard","⥮":"udhar","⥯":"duhar","⥰":"RoundImplies","⥱":"erarr","⥲":"simrarr","⥳":"larrsim","⥴":"rarrsim","⥵":"rarrap","⥶":"ltlarr","⥸":"gtrarr","⥹":"subrarr","⥻":"suplarr","⥼":"lfisht","⥽":"rfisht","⥾":"ufisht","⥿":"dfisht","⦚":"vzigzag","⦜":"vangrt","⦝":"angrtvbd","⦤":"ange","⦥":"range","⦦":"dwangle","⦧":"uwangle","⦨":"angmsdaa","⦩":"angmsdab","⦪":"angmsdac","⦫":"angmsdad","⦬":"angmsdae","⦭":"angmsdaf","⦮":"angmsdag","⦯":"angmsdah","⦰":"bemptyv","⦱":"demptyv","⦲":"cemptyv","⦳":"raemptyv","⦴":"laemptyv","⦵":"ohbar","⦶":"omid","⦷":"opar","⦹":"operp","⦻":"olcross","⦼":"odsold","⦾":"olcir","⦿":"ofcir","⧀":"olt","⧁":"ogt","⧂":"cirscir","⧃":"cirE","⧄":"solb","⧅":"bsolb","⧉":"boxbox","⧍":"trisb","⧎":"rtriltri","⧏":"LeftTriangleBar","⧏̸":"NotLeftTriangleBar","⧐":"RightTriangleBar","⧐̸":"NotRightTriangleBar","⧜":"iinfin","⧝":"infintie","⧞":"nvinfin","⧣":"eparsl","⧤":"smeparsl","⧥":"eqvparsl","⧫":"lozf","⧴":"RuleDelayed","⧶":"dsol","⨀":"xodot","⨁":"xoplus","⨂":"xotime","⨄":"xuplus","⨆":"xsqcup","⨍":"fpartint","⨐":"cirfnint","⨑":"awint","⨒":"rppolint","⨓":"scpolint","⨔":"npolint","⨕":"pointint","⨖":"quatint","⨗":"intlarhk","⨢":"pluscir","⨣":"plusacir","⨤":"simplus","⨥":"plusdu","⨦":"plussim","⨧":"plustwo","⨩":"mcomma","⨪":"minusdu","⨭":"loplus","⨮":"roplus","⨯":"Cross","⨰":"timesd","⨱":"timesbar","⨳":"smashp","⨴":"lotimes","⨵":"rotimes","⨶":"otimesas","⨷":"Otimes","⨸":"odiv","⨹":"triplus","⨺":"triminus","⨻":"tritime","⨼":"iprod","⨿":"amalg","⩀":"capdot","⩂":"ncup","⩃":"ncap","⩄":"capand","⩅":"cupor","⩆":"cupcap","⩇":"capcup","⩈":"cupbrcap","⩉":"capbrcup","⩊":"cupcup","⩋":"capcap","⩌":"ccups","⩍":"ccaps","⩐":"ccupssm","⩓":"And","⩔":"Or","⩕":"andand","⩖":"oror","⩗":"orslope","⩘":"andslope","⩚":"andv","⩛":"orv","⩜":"andd","⩝":"ord","⩟":"wedbar","⩦":"sdote","⩪":"simdot","⩭":"congdot","⩭̸":"ncongdot","⩮":"easter","⩯":"apacir","⩰":"apE","⩰̸":"napE","⩱":"eplus","⩲":"pluse","⩳":"Esim","⩷":"eDDot","⩸":"equivDD","⩹":"ltcir","⩺":"gtcir","⩻":"ltquest","⩼":"gtquest","⩽":"les","⩽̸":"nles","⩾":"ges","⩾̸":"nges","⩿":"lesdot","⪀":"gesdot","⪁":"lesdoto","⪂":"gesdoto","⪃":"lesdotor","⪄":"gesdotol","⪅":"lap","⪆":"gap","⪇":"lne","⪈":"gne","⪉":"lnap","⪊":"gnap","⪋":"lEg","⪌":"gEl","⪍":"lsime","⪎":"gsime","⪏":"lsimg","⪐":"gsiml","⪑":"lgE","⪒":"glE","⪓":"lesges","⪔":"gesles","⪕":"els","⪖":"egs","⪗":"elsdot","⪘":"egsdot","⪙":"el","⪚":"eg","⪝":"siml","⪞":"simg","⪟":"simlE","⪠":"simgE","⪡":"LessLess","⪡̸":"NotNestedLessLess","⪢":"GreaterGreater","⪢̸":"NotNestedGreaterGreater","⪤":"glj","⪥":"gla","⪦":"ltcc","⪧":"gtcc","⪨":"lescc","⪩":"gescc","⪪":"smt","⪫":"lat","⪬":"smte","⪬︀":"smtes","⪭":"late","⪭︀":"lates","⪮":"bumpE","⪯":"pre","⪯̸":"npre","⪰":"sce","⪰̸":"nsce","⪳":"prE","⪴":"scE","⪵":"prnE","⪶":"scnE","⪷":"prap","⪸":"scap","⪹":"prnap","⪺":"scnap","⪻":"Pr","⪼":"Sc","⪽":"subdot","⪾":"supdot","⪿":"subplus","⫀":"supplus","⫁":"submult","⫂":"supmult","⫃":"subedot","⫄":"supedot","⫅":"subE","⫅̸":"nsubE","⫆":"supE","⫆̸":"nsupE","⫇":"subsim","⫈":"supsim","⫋︀":"vsubnE","⫋":"subnE","⫌︀":"vsupnE","⫌":"supnE","⫏":"csub","⫐":"csup","⫑":"csube","⫒":"csupe","⫓":"subsup","⫔":"supsub","⫕":"subsub","⫖":"supsup","⫗":"suphsub","⫘":"supdsub","⫙":"forkv","⫚":"topfork","⫛":"mlcp","⫤":"Dashv","⫦":"Vdashl","⫧":"Barv","⫨":"vBar","⫩":"vBarv","⫫":"Vbar","⫬":"Not","⫭":"bNot","⫮":"rnmid","⫯":"cirmid","⫰":"midcir","⫱":"topcir","⫲":"nhpar","⫳":"parsim","⫽":"parsl","⫽⃥":"nparsl","♭":"flat","♮":"natur","♯":"sharp","¤":"curren","¢":"cent",$:"dollar","£":"pound","¥":"yen","€":"euro","¹":"sup1","½":"half","⅓":"frac13","¼":"frac14","⅕":"frac15","⅙":"frac16","⅛":"frac18","²":"sup2","⅔":"frac23","⅖":"frac25","³":"sup3","¾":"frac34","⅗":"frac35","⅜":"frac38","⅘":"frac45","⅚":"frac56","⅝":"frac58","⅞":"frac78","𝒶":"ascr","𝕒":"aopf","𝔞":"afr","𝔸":"Aopf","𝔄":"Afr","𝒜":"Ascr","ª":"ordf","á":"aacute","Á":"Aacute","à":"agrave","À":"Agrave","ă":"abreve","Ă":"Abreve","â":"acirc","Â":"Acirc","å":"aring","Å":"angst","ä":"auml","Ä":"Auml","ã":"atilde","Ã":"Atilde","ą":"aogon","Ą":"Aogon","ā":"amacr","Ā":"Amacr","æ":"aelig","Æ":"AElig","𝒷":"bscr","𝕓":"bopf","𝔟":"bfr","𝔹":"Bopf","ℬ":"Bscr","𝔅":"Bfr","𝔠":"cfr","𝒸":"cscr","𝕔":"copf","ℭ":"Cfr","𝒞":"Cscr","ℂ":"Copf","ć":"cacute","Ć":"Cacute","ĉ":"ccirc","Ĉ":"Ccirc","č":"ccaron","Č":"Ccaron","ċ":"cdot","Ċ":"Cdot","ç":"ccedil","Ç":"Ccedil","℅":"incare","𝔡":"dfr","ⅆ":"dd","𝕕":"dopf","𝒹":"dscr","𝒟":"Dscr","𝔇":"Dfr","ⅅ":"DD","𝔻":"Dopf","ď":"dcaron","Ď":"Dcaron","đ":"dstrok","Đ":"Dstrok","ð":"eth","Ð":"ETH","ⅇ":"ee","ℯ":"escr","𝔢":"efr","𝕖":"eopf","ℰ":"Escr","𝔈":"Efr","𝔼":"Eopf","é":"eacute","É":"Eacute","è":"egrave","È":"Egrave","ê":"ecirc","Ê":"Ecirc","ě":"ecaron","Ě":"Ecaron","ë":"euml","Ë":"Euml","ė":"edot","Ė":"Edot","ę":"eogon","Ę":"Eogon","ē":"emacr","Ē":"Emacr","𝔣":"ffr","𝕗":"fopf","𝒻":"fscr","𝔉":"Ffr","𝔽":"Fopf","ℱ":"Fscr","ﬀ":"fflig","ﬃ":"ffilig","ﬄ":"ffllig","ﬁ":"filig",fj:"fjlig","ﬂ":"fllig","ƒ":"fnof","ℊ":"gscr","𝕘":"gopf","𝔤":"gfr","𝒢":"Gscr","𝔾":"Gopf","𝔊":"Gfr","ǵ":"gacute","ğ":"gbreve","Ğ":"Gbreve","ĝ":"gcirc","Ĝ":"Gcirc","ġ":"gdot","Ġ":"Gdot","Ģ":"Gcedil","𝔥":"hfr","ℎ":"planckh","𝒽":"hscr","𝕙":"hopf","ℋ":"Hscr","ℌ":"Hfr","ℍ":"Hopf","ĥ":"hcirc","Ĥ":"Hcirc","ℏ":"hbar","ħ":"hstrok","Ħ":"Hstrok","𝕚":"iopf","𝔦":"ifr","𝒾":"iscr","ⅈ":"ii","𝕀":"Iopf","ℐ":"Iscr","ℑ":"Im","í":"iacute","Í":"Iacute","ì":"igrave","Ì":"Igrave","î":"icirc","Î":"Icirc","ï":"iuml","Ï":"Iuml","ĩ":"itilde","Ĩ":"Itilde","İ":"Idot","į":"iogon","Į":"Iogon","ī":"imacr","Ī":"Imacr","ĳ":"ijlig","Ĳ":"IJlig","ı":"imath","𝒿":"jscr","𝕛":"jopf","𝔧":"jfr","𝒥":"Jscr","𝔍":"Jfr","𝕁":"Jopf","ĵ":"jcirc","Ĵ":"Jcirc","ȷ":"jmath","𝕜":"kopf","𝓀":"kscr","𝔨":"kfr","𝒦":"Kscr","𝕂":"Kopf","𝔎":"Kfr","ķ":"kcedil","Ķ":"Kcedil","𝔩":"lfr","𝓁":"lscr","ℓ":"ell","𝕝":"lopf","ℒ":"Lscr","𝔏":"Lfr","𝕃":"Lopf","ĺ":"lacute","Ĺ":"Lacute","ľ":"lcaron","Ľ":"Lcaron","ļ":"lcedil","Ļ":"Lcedil","ł":"lstrok","Ł":"Lstrok","ŀ":"lmidot","Ŀ":"Lmidot","𝔪":"mfr","𝕞":"mopf","𝓂":"mscr","𝔐":"Mfr","𝕄":"Mopf","ℳ":"Mscr","𝔫":"nfr","𝕟":"nopf","𝓃":"nscr","ℕ":"Nopf","𝒩":"Nscr","𝔑":"Nfr","ń":"nacute","Ń":"Nacute","ň":"ncaron","Ň":"Ncaron","ñ":"ntilde","Ñ":"Ntilde","ņ":"ncedil","Ņ":"Ncedil","№":"numero","ŋ":"eng","Ŋ":"ENG","𝕠":"oopf","𝔬":"ofr","ℴ":"oscr","𝒪":"Oscr","𝔒":"Ofr","𝕆":"Oopf","º":"ordm","ó":"oacute","Ó":"Oacute","ò":"ograve","Ò":"Ograve","ô":"ocirc","Ô":"Ocirc","ö":"ouml","Ö":"Ouml","ő":"odblac","Ő":"Odblac","õ":"otilde","Õ":"Otilde","ø":"oslash","Ø":"Oslash","ō":"omacr","Ō":"Omacr","œ":"oelig","Œ":"OElig","𝔭":"pfr","𝓅":"pscr","𝕡":"popf","ℙ":"Popf","𝔓":"Pfr","𝒫":"Pscr","𝕢":"qopf","𝔮":"qfr","𝓆":"qscr","𝒬":"Qscr","𝔔":"Qfr","ℚ":"Qopf","ĸ":"kgreen","𝔯":"rfr","𝕣":"ropf","𝓇":"rscr","ℛ":"Rscr","ℜ":"Re","ℝ":"Ropf","ŕ":"racute","Ŕ":"Racute","ř":"rcaron","Ř":"Rcaron","ŗ":"rcedil","Ŗ":"Rcedil","𝕤":"sopf","𝓈":"sscr","𝔰":"sfr","𝕊":"Sopf","𝔖":"Sfr","𝒮":"Sscr","Ⓢ":"oS","ś":"sacute","Ś":"Sacute","ŝ":"scirc","Ŝ":"Scirc","š":"scaron","Š":"Scaron","ş":"scedil","Ş":"Scedil","ß":"szlig","𝔱":"tfr","𝓉":"tscr","𝕥":"topf","𝒯":"Tscr","𝔗":"Tfr","𝕋":"Topf","ť":"tcaron","Ť":"Tcaron","ţ":"tcedil","Ţ":"Tcedil","™":"trade","ŧ":"tstrok","Ŧ":"Tstrok","𝓊":"uscr","𝕦":"uopf","𝔲":"ufr","𝕌":"Uopf","𝔘":"Ufr","𝒰":"Uscr","ú":"uacute","Ú":"Uacute","ù":"ugrave","Ù":"Ugrave","ŭ":"ubreve","Ŭ":"Ubreve","û":"ucirc","Û":"Ucirc","ů":"uring","Ů":"Uring","ü":"uuml","Ü":"Uuml","ű":"udblac","Ű":"Udblac","ũ":"utilde","Ũ":"Utilde","ų":"uogon","Ų":"Uogon","ū":"umacr","Ū":"Umacr","𝔳":"vfr","𝕧":"vopf","𝓋":"vscr","𝔙":"Vfr","𝕍":"Vopf","𝒱":"Vscr","𝕨":"wopf","𝓌":"wscr","𝔴":"wfr","𝒲":"Wscr","𝕎":"Wopf","𝔚":"Wfr","ŵ":"wcirc","Ŵ":"Wcirc","𝔵":"xfr","𝓍":"xscr","𝕩":"xopf","𝕏":"Xopf","𝔛":"Xfr","𝒳":"Xscr","𝔶":"yfr","𝓎":"yscr","𝕪":"yopf","𝒴":"Yscr","𝔜":"Yfr","𝕐":"Yopf","ý":"yacute","Ý":"Yacute","ŷ":"ycirc","Ŷ":"Ycirc","ÿ":"yuml","Ÿ":"Yuml","𝓏":"zscr","𝔷":"zfr","𝕫":"zopf","ℨ":"Zfr","ℤ":"Zopf","𝒵":"Zscr","ź":"zacute","Ź":"Zacute","ž":"zcaron","Ž":"Zcaron","ż":"zdot","Ż":"Zdot","Ƶ":"imped","þ":"thorn","Þ":"THORN","ŉ":"napos","α":"alpha","Α":"Alpha","β":"beta","Β":"Beta","γ":"gamma","Γ":"Gamma","δ":"delta","Δ":"Delta","ε":"epsi","ϵ":"epsiv","Ε":"Epsilon","ϝ":"gammad","Ϝ":"Gammad","ζ":"zeta","Ζ":"Zeta","η":"eta","Η":"Eta","θ":"theta","ϑ":"thetav","Θ":"Theta","ι":"iota","Ι":"Iota","κ":"kappa","ϰ":"kappav","Κ":"Kappa","λ":"lambda","Λ":"Lambda","μ":"mu","µ":"micro","Μ":"Mu","ν":"nu","Ν":"Nu","ξ":"xi","Ξ":"Xi","ο":"omicron","Ο":"Omicron","π":"pi","ϖ":"piv","Π":"Pi","ρ":"rho","ϱ":"rhov","Ρ":"Rho","σ":"sigma","Σ":"Sigma","ς":"sigmaf","τ":"tau","Τ":"Tau","υ":"upsi","Υ":"Upsilon","ϒ":"Upsi","φ":"phi","ϕ":"phiv","Φ":"Phi","χ":"chi","Χ":"Chi","ψ":"psi","Ψ":"Psi","ω":"omega","Ω":"ohm","а":"acy","А":"Acy","б":"bcy","Б":"Bcy","в":"vcy","В":"Vcy","г":"gcy","Г":"Gcy","ѓ":"gjcy","Ѓ":"GJcy","д":"dcy","Д":"Dcy","ђ":"djcy","Ђ":"DJcy","е":"iecy","Е":"IEcy","ё":"iocy","Ё":"IOcy","є":"jukcy","Є":"Jukcy","ж":"zhcy","Ж":"ZHcy","з":"zcy","З":"Zcy","ѕ":"dscy","Ѕ":"DScy","и":"icy","И":"Icy","і":"iukcy","І":"Iukcy","ї":"yicy","Ї":"YIcy","й":"jcy","Й":"Jcy","ј":"jsercy","Ј":"Jsercy","к":"kcy","К":"Kcy","ќ":"kjcy","Ќ":"KJcy","л":"lcy","Л":"Lcy","љ":"ljcy","Љ":"LJcy","м":"mcy","М":"Mcy","н":"ncy","Н":"Ncy","њ":"njcy","Њ":"NJcy","о":"ocy","О":"Ocy","п":"pcy","П":"Pcy","р":"rcy","Р":"Rcy","с":"scy","С":"Scy","т":"tcy","Т":"Tcy","ћ":"tshcy","Ћ":"TSHcy","у":"ucy","У":"Ucy","ў":"ubrcy","Ў":"Ubrcy","ф":"fcy","Ф":"Fcy","х":"khcy","Х":"KHcy","ц":"tscy","Ц":"TScy","ч":"chcy","Ч":"CHcy","џ":"dzcy","Џ":"DZcy","ш":"shcy","Ш":"SHcy","щ":"shchcy","Щ":"SHCHcy","ъ":"hardcy","Ъ":"HARDcy","ы":"ycy","Ы":"Ycy","ь":"softcy","Ь":"SOFTcy","э":"ecy","Э":"Ecy","ю":"yucy","Ю":"YUcy","я":"yacy","Я":"YAcy","ℵ":"aleph","ℶ":"beth","ℷ":"gimel","ℸ":"daleth"},h=/["&'<>`]/g,p={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},d=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,f=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,_=/&(CounterClockwiseContourIntegral|DoubleLongLeftRightArrow|ClockwiseContourIntegral|NotNestedGreaterGreater|NotSquareSupersetEqual|DiacriticalDoubleAcute|NotRightTriangleEqual|NotSucceedsSlantEqual|NotPrecedesSlantEqual|CloseCurlyDoubleQuote|NegativeVeryThinSpace|DoubleContourIntegral|FilledVerySmallSquare|CapitalDifferentialD|OpenCurlyDoubleQuote|EmptyVerySmallSquare|NestedGreaterGreater|DoubleLongRightArrow|NotLeftTriangleEqual|NotGreaterSlantEqual|ReverseUpEquilibrium|DoubleLeftRightArrow|NotSquareSubsetEqual|NotDoubleVerticalBar|RightArrowLeftArrow|NotGreaterFullEqual|NotRightTriangleBar|SquareSupersetEqual|DownLeftRightVector|DoubleLongLeftArrow|leftrightsquigarrow|LeftArrowRightArrow|NegativeMediumSpace|blacktriangleright|RightDownVectorBar|PrecedesSlantEqual|RightDoubleBracket|SucceedsSlantEqual|NotLeftTriangleBar|RightTriangleEqual|SquareIntersection|RightDownTeeVector|ReverseEquilibrium|NegativeThickSpace|longleftrightarrow|Longleftrightarrow|LongLeftRightArrow|DownRightTeeVector|DownRightVectorBar|GreaterSlantEqual|SquareSubsetEqual|LeftDownVectorBar|LeftDoubleBracket|VerticalSeparator|rightleftharpoons|NotGreaterGreater|NotSquareSuperset|blacktriangleleft|blacktriangledown|NegativeThinSpace|LeftDownTeeVector|NotLessSlantEqual|leftrightharpoons|DoubleUpDownArrow|DoubleVerticalBar|LeftTriangleEqual|FilledSmallSquare|twoheadrightarrow|NotNestedLessLess|DownLeftTeeVector|DownLeftVectorBar|RightAngleBracket|NotTildeFullEqual|NotReverseElement|RightUpDownVector|DiacriticalTilde|NotSucceedsTilde|circlearrowright|NotPrecedesEqual|rightharpoondown|DoubleRightArrow|NotSucceedsEqual|NonBreakingSpace|NotRightTriangle|LessEqualGreater|RightUpTeeVector|LeftAngleBracket|GreaterFullEqual|DownArrowUpArrow|RightUpVectorBar|twoheadleftarrow|GreaterEqualLess|downharpoonright|RightTriangleBar|ntrianglerighteq|NotSupersetEqual|LeftUpDownVector|DiacriticalAcute|rightrightarrows|vartriangleright|UpArrowDownArrow|DiacriticalGrave|UnderParenthesis|EmptySmallSquare|LeftUpVectorBar|leftrightarrows|DownRightVector|downharpoonleft|trianglerighteq|ShortRightArrow|OverParenthesis|DoubleLeftArrow|DoubleDownArrow|NotSquareSubset|bigtriangledown|ntrianglelefteq|UpperRightArrow|curvearrowright|vartriangleleft|NotLeftTriangle|nleftrightarrow|LowerRightArrow|NotHumpDownHump|NotGreaterTilde|rightthreetimes|LeftUpTeeVector|NotGreaterEqual|straightepsilon|LeftTriangleBar|rightsquigarrow|ContourIntegral|rightleftarrows|CloseCurlyQuote|RightDownVector|LeftRightVector|nLeftrightarrow|leftharpoondown|circlearrowleft|SquareSuperset|OpenCurlyQuote|hookrightarrow|HorizontalLine|DiacriticalDot|NotLessGreater|ntriangleright|DoubleRightTee|InvisibleComma|InvisibleTimes|LowerLeftArrow|DownLeftVector|NotSubsetEqual|curvearrowleft|trianglelefteq|NotVerticalBar|TildeFullEqual|downdownarrows|NotGreaterLess|RightTeeVector|ZeroWidthSpace|looparrowright|LongRightArrow|doublebarwedge|ShortLeftArrow|ShortDownArrow|RightVectorBar|GreaterGreater|ReverseElement|rightharpoonup|LessSlantEqual|leftthreetimes|upharpoonright|rightarrowtail|LeftDownVector|Longrightarrow|NestedLessLess|UpperLeftArrow|nshortparallel|leftleftarrows|leftrightarrow|Leftrightarrow|LeftRightArrow|longrightarrow|upharpoonleft|RightArrowBar|ApplyFunction|LeftTeeVector|leftarrowtail|NotEqualTilde|varsubsetneqq|varsupsetneqq|RightTeeArrow|SucceedsEqual|SucceedsTilde|LeftVectorBar|SupersetEqual|hookleftarrow|DifferentialD|VerticalTilde|VeryThinSpace|blacktriangle|bigtriangleup|LessFullEqual|divideontimes|leftharpoonup|UpEquilibrium|ntriangleleft|RightTriangle|measuredangle|shortparallel|longleftarrow|Longleftarrow|LongLeftArrow|DoubleLeftTee|Poincareplane|PrecedesEqual|triangleright|DoubleUpArrow|RightUpVector|fallingdotseq|looparrowleft|PrecedesTilde|NotTildeEqual|NotTildeTilde|smallsetminus|Proportional|triangleleft|triangledown|UnderBracket|NotHumpEqual|exponentiale|ExponentialE|NotLessTilde|HilbertSpace|RightCeiling|blacklozenge|varsupsetneq|HumpDownHump|GreaterEqual|VerticalLine|LeftTeeArrow|NotLessEqual|DownTeeArrow|LeftTriangle|varsubsetneq|Intersection|NotCongruent|DownArrowBar|LeftUpVector|LeftArrowBar|risingdotseq|GreaterTilde|RoundImplies|SquareSubset|ShortUpArrow|NotSuperset|quaternions|precnapprox|backepsilon|preccurlyeq|OverBracket|blacksquare|MediumSpace|VerticalBar|circledcirc|circleddash|CircleMinus|CircleTimes|LessGreater|curlyeqprec|curlyeqsucc|diamondsuit|UpDownArrow|Updownarrow|RuleDelayed|Rrightarrow|updownarrow|RightVector|nRightarrow|nrightarrow|eqslantless|LeftCeiling|Equilibrium|SmallCircle|expectation|NotSucceeds|thickapprox|GreaterLess|SquareUnion|NotPrecedes|NotLessLess|straightphi|succnapprox|succcurlyeq|SubsetEqual|sqsupseteq|Proportion|Laplacetrf|ImaginaryI|supsetneqq|NotGreater|gtreqqless|NotElement|ThickSpace|TildeEqual|TildeTilde|Fouriertrf|rmoustache|EqualTilde|eqslantgtr|UnderBrace|LeftVector|UpArrowBar|nLeftarrow|nsubseteqq|subsetneqq|nsupseteqq|nleftarrow|succapprox|lessapprox|UpTeeArrow|upuparrows|curlywedge|lesseqqgtr|varepsilon|varnothing|RightFloor|complement|CirclePlus|sqsubseteq|Lleftarrow|circledast|RightArrow|Rightarrow|rightarrow|lmoustache|Bernoullis|precapprox|mapstoleft|mapstodown|longmapsto|dotsquare|downarrow|DoubleDot|nsubseteq|supsetneq|leftarrow|nsupseteq|subsetneq|ThinSpace|ngeqslant|subseteqq|HumpEqual|NotSubset|triangleq|NotCupCap|lesseqgtr|heartsuit|TripleDot|Leftarrow|Coproduct|Congruent|varpropto|complexes|gvertneqq|LeftArrow|LessTilde|supseteqq|MinusPlus|CircleDot|nleqslant|NotExists|gtreqless|nparallel|UnionPlus|LeftFloor|checkmark|CenterDot|centerdot|Mellintrf|gtrapprox|bigotimes|OverBrace|spadesuit|therefore|pitchfork|rationals|PlusMinus|Backslash|Therefore|DownBreve|backsimeq|backprime|DownArrow|nshortmid|Downarrow|lvertneqq|eqvparsl|imagline|imagpart|infintie|integers|Integral|intercal|LessLess|Uarrocir|intlarhk|sqsupset|angmsdaf|sqsubset|llcorner|vartheta|cupbrcap|lnapprox|Superset|SuchThat|succnsim|succneqq|angmsdag|biguplus|curlyvee|trpezium|Succeeds|NotTilde|bigwedge|angmsdah|angrtvbd|triminus|cwconint|fpartint|lrcorner|smeparsl|subseteq|urcorner|lurdshar|laemptyv|DDotrahd|approxeq|ldrushar|awconint|mapstoup|backcong|shortmid|triangle|geqslant|gesdotol|timesbar|circledR|circledS|setminus|multimap|naturals|scpolint|ncongdot|RightTee|boxminus|gnapprox|boxtimes|andslope|thicksim|angmsdaa|varsigma|cirfnint|rtriltri|angmsdab|rppolint|angmsdac|barwedge|drbkarow|clubsuit|thetasym|bsolhsub|capbrcup|dzigrarr|doteqdot|DotEqual|dotminus|UnderBar|NotEqual|realpart|otimesas|ulcorner|hksearow|hkswarow|parallel|PartialD|elinters|emptyset|plusacir|bbrktbrk|angmsdad|pointint|bigoplus|angmsdae|Precedes|bigsqcup|varkappa|notindot|supseteq|precneqq|precnsim|profalar|profline|profsurf|leqslant|lesdotor|raemptyv|subplus|notnivb|notnivc|subrarr|zigrarr|vzigzag|submult|subedot|Element|between|cirscir|larrbfs|larrsim|lotimes|lbrksld|lbrkslu|lozenge|ldrdhar|dbkarow|bigcirc|epsilon|simrarr|simplus|ltquest|Epsilon|luruhar|gtquest|maltese|npolint|eqcolon|npreceq|bigodot|ddagger|gtrless|bnequiv|harrcir|ddotseq|equivDD|backsim|demptyv|nsqsube|nsqsupe|Upsilon|nsubset|upsilon|minusdu|nsucceq|swarrow|nsupset|coloneq|searrow|boxplus|napprox|natural|asympeq|alefsym|congdot|nearrow|bigstar|diamond|supplus|tritime|LeftTee|nvinfin|triplus|NewLine|nvltrie|nvrtrie|nwarrow|nexists|Diamond|ruluhar|Implies|supmult|angzarr|suplarr|suphsub|questeq|because|digamma|Because|olcross|bemptyv|omicron|Omicron|rotimes|NoBreak|intprod|angrtvb|orderof|uwangle|suphsol|lesdoto|orslope|DownTee|realine|cudarrl|rdldhar|OverBar|supedot|lessdot|supdsub|topfork|succsim|rbrkslu|rbrksld|pertenk|cudarrr|isindot|planckh|lessgtr|pluscir|gesdoto|plussim|plustwo|lesssim|cularrp|rarrsim|Cayleys|notinva|notinvb|notinvc|UpArrow|Uparrow|uparrow|NotLess|dwangle|precsim|Product|curarrm|Cconint|dotplus|rarrbfs|ccupssm|Cedilla|cemptyv|notniva|quatint|frac35|frac38|frac45|frac56|frac58|frac78|tridot|xoplus|gacute|gammad|Gammad|lfisht|lfloor|bigcup|sqsupe|gbreve|Gbreve|lharul|sqsube|sqcups|Gcedil|apacir|llhard|lmidot|Lmidot|lmoust|andand|sqcaps|approx|Abreve|spades|circeq|tprime|divide|topcir|Assign|topbot|gesdot|divonx|xuplus|timesd|gesles|atilde|solbar|SOFTcy|loplus|timesb|lowast|lowbar|dlcorn|dlcrop|softcy|dollar|lparlt|thksim|lrhard|Atilde|lsaquo|smashp|bigvee|thinsp|wreath|bkarow|lsquor|lstrok|Lstrok|lthree|ltimes|ltlarr|DotDot|simdot|ltrPar|weierp|xsqcup|angmsd|sigmav|sigmaf|zeetrf|Zcaron|zcaron|mapsto|vsupne|thetav|cirmid|marker|mcomma|Zacute|vsubnE|there4|gtlPar|vsubne|bottom|gtrarr|SHCHcy|shchcy|midast|midcir|middot|minusb|minusd|gtrdot|bowtie|sfrown|mnplus|models|colone|seswar|Colone|mstpos|searhk|gtrsim|nacute|Nacute|boxbox|telrec|hairsp|Tcedil|nbumpe|scnsim|ncaron|Ncaron|ncedil|Ncedil|hamilt|Scedil|nearhk|hardcy|HARDcy|tcedil|Tcaron|commat|nequiv|nesear|tcaron|target|hearts|nexist|varrho|scedil|Scaron|scaron|hellip|Sacute|sacute|hercon|swnwar|compfn|rtimes|rthree|rsquor|rsaquo|zacute|wedgeq|homtht|barvee|barwed|Barwed|rpargt|horbar|conint|swarhk|roplus|nltrie|hslash|hstrok|Hstrok|rmoust|Conint|bprime|hybull|hyphen|iacute|Iacute|supsup|supsub|supsim|varphi|coprod|brvbar|agrave|Supset|supset|igrave|Igrave|notinE|Agrave|iiiint|iinfin|copysr|wedbar|Verbar|vangrt|becaus|incare|verbar|inodot|bullet|drcorn|intcal|drcrop|cularr|vellip|Utilde|bumpeq|cupcap|dstrok|Dstrok|CupCap|cupcup|cupdot|eacute|Eacute|supdot|iquest|easter|ecaron|Ecaron|ecolon|isinsv|utilde|itilde|Itilde|curarr|succeq|Bumpeq|cacute|ulcrop|nparsl|Cacute|nprcue|egrave|Egrave|nrarrc|nrarrw|subsup|subsub|nrtrie|jsercy|nsccue|Jsercy|kappav|kcedil|Kcedil|subsim|ulcorn|nsimeq|egsdot|veebar|kgreen|capand|elsdot|Subset|subset|curren|aacute|lacute|Lacute|emptyv|ntilde|Ntilde|lagran|lambda|Lambda|capcap|Ugrave|langle|subdot|emsp13|numero|emsp14|nvdash|nvDash|nVdash|nVDash|ugrave|ufisht|nvHarr|larrfs|nvlArr|larrhk|larrlp|larrpl|nvrArr|Udblac|nwarhk|larrtl|nwnear|oacute|Oacute|latail|lAtail|sstarf|lbrace|odblac|Odblac|lbrack|udblac|odsold|eparsl|lcaron|Lcaron|ograve|Ograve|lcedil|Lcedil|Aacute|ssmile|ssetmn|squarf|ldquor|capcup|ominus|cylcty|rharul|eqcirc|dagger|rfloor|rfisht|Dagger|daleth|equals|origof|capdot|equest|dcaron|Dcaron|rdquor|oslash|Oslash|otilde|Otilde|otimes|Otimes|urcrop|Ubreve|ubreve|Yacute|Uacute|uacute|Rcedil|rcedil|urcorn|parsim|Rcaron|Vdashl|rcaron|Tstrok|percnt|period|permil|Exists|yacute|rbrack|rbrace|phmmat|ccaron|Ccaron|planck|ccedil|plankv|tstrok|female|plusdo|plusdu|ffilig|plusmn|ffllig|Ccedil|rAtail|dfisht|bernou|ratail|Rarrtl|rarrtl|angsph|rarrpl|rarrlp|rarrhk|xwedge|xotime|forall|ForAll|Vvdash|vsupnE|preceq|bigcap|frac12|frac13|frac14|primes|rarrfs|prnsim|frac15|Square|frac16|square|lesdot|frac18|frac23|propto|prurel|rarrap|rangle|puncsp|frac25|Racute|qprime|racute|lesges|frac34|abreve|AElig|eqsim|utdot|setmn|urtri|Equal|Uring|seArr|uring|searr|dashv|Dashv|mumap|nabla|iogon|Iogon|sdote|sdotb|scsim|napid|napos|equiv|natur|Acirc|dblac|erarr|nbump|iprod|erDot|ucirc|awint|esdot|angrt|ncong|isinE|scnap|Scirc|scirc|ndash|isins|Ubrcy|nearr|neArr|isinv|nedot|ubrcy|acute|Ycirc|iukcy|Iukcy|xutri|nesim|caret|jcirc|Jcirc|caron|twixt|ddarr|sccue|exist|jmath|sbquo|ngeqq|angst|ccaps|lceil|ngsim|UpTee|delta|Delta|rtrif|nharr|nhArr|nhpar|rtrie|jukcy|Jukcy|kappa|rsquo|Kappa|nlarr|nlArr|TSHcy|rrarr|aogon|Aogon|fflig|xrarr|tshcy|ccirc|nleqq|filig|upsih|nless|dharl|nlsim|fjlig|ropar|nltri|dharr|robrk|roarr|fllig|fltns|roang|rnmid|subnE|subne|lAarr|trisb|Ccirc|acirc|ccups|blank|VDash|forkv|Vdash|langd|cedil|blk12|blk14|laquo|strns|diams|notin|vDash|larrb|blk34|block|disin|uplus|vdash|vBarv|aelig|starf|Wedge|check|xrArr|lates|lbarr|lBarr|notni|lbbrk|bcong|frasl|lbrke|frown|vrtri|vprop|vnsup|gamma|Gamma|wedge|xodot|bdquo|srarr|doteq|ldquo|boxdl|boxdL|gcirc|Gcirc|boxDl|boxDL|boxdr|boxdR|boxDr|TRADE|trade|rlhar|boxDR|vnsub|npart|vltri|rlarr|boxhd|boxhD|nprec|gescc|nrarr|nrArr|boxHd|boxHD|boxhu|boxhU|nrtri|boxHu|clubs|boxHU|times|colon|Colon|gimel|xlArr|Tilde|nsime|tilde|nsmid|nspar|THORN|thorn|xlarr|nsube|nsubE|thkap|xhArr|comma|nsucc|boxul|boxuL|nsupe|nsupE|gneqq|gnsim|boxUl|boxUL|grave|boxur|boxuR|boxUr|boxUR|lescc|angle|bepsi|boxvh|varpi|boxvH|numsp|Theta|gsime|gsiml|theta|boxVh|boxVH|boxvl|gtcir|gtdot|boxvL|boxVl|boxVL|crarr|cross|Cross|nvsim|boxvr|nwarr|nwArr|sqsup|dtdot|Uogon|lhard|lharu|dtrif|ocirc|Ocirc|lhblk|duarr|odash|sqsub|Hacek|sqcup|llarr|duhar|oelig|OElig|ofcir|boxvR|uogon|lltri|boxVr|csube|uuarr|ohbar|csupe|ctdot|olarr|olcir|harrw|oline|sqcap|omacr|Omacr|omega|Omega|boxVR|aleph|lneqq|lnsim|loang|loarr|rharu|lobrk|hcirc|operp|oplus|rhard|Hcirc|orarr|Union|order|ecirc|Ecirc|cuepr|szlig|cuesc|breve|reals|eDDot|Breve|hoarr|lopar|utrif|rdquo|Umacr|umacr|efDot|swArr|ultri|alpha|rceil|ovbar|swarr|Wcirc|wcirc|smtes|smile|bsemi|lrarr|aring|parsl|lrhar|bsime|uhblk|lrtri|cupor|Aring|uharr|uharl|slarr|rbrke|bsolb|lsime|rbbrk|RBarr|lsimg|phone|rBarr|rbarr|icirc|lsquo|Icirc|emacr|Emacr|ratio|simne|plusb|simlE|simgE|simeq|pluse|ltcir|ltdot|empty|xharr|xdtri|iexcl|Alpha|ltrie|rarrw|pound|ltrif|xcirc|bumpe|prcue|bumpE|asymp|amacr|cuvee|Sigma|sigma|iiint|udhar|iiota|ijlig|IJlig|supnE|imacr|Imacr|prime|Prime|image|prnap|eogon|Eogon|rarrc|mdash|mDDot|cuwed|imath|supne|imped|Amacr|udarr|prsim|micro|rarrb|cwint|raquo|infin|eplus|range|rangd|Ucirc|radic|minus|amalg|veeeq|rAarr|epsiv|ycirc|quest|sharp|quot|zwnj|Qscr|race|qscr|Qopf|qopf|qint|rang|Rang|Zscr|zscr|Zopf|zopf|rarr|rArr|Rarr|Pscr|pscr|prop|prod|prnE|prec|ZHcy|zhcy|prap|Zeta|zeta|Popf|popf|Zdot|plus|zdot|Yuml|yuml|phiv|YUcy|yucy|Yscr|yscr|perp|Yopf|yopf|part|para|YIcy|Ouml|rcub|yicy|YAcy|rdca|ouml|osol|Oscr|rdsh|yacy|real|oscr|xvee|andd|rect|andv|Xscr|oror|ordm|ordf|xscr|ange|aopf|Aopf|rHar|Xopf|opar|Oopf|xopf|xnis|rhov|oopf|omid|xmap|oint|apid|apos|ogon|ascr|Ascr|odot|odiv|xcup|xcap|ocir|oast|nvlt|nvle|nvgt|nvge|nvap|Wscr|wscr|auml|ntlg|ntgl|nsup|nsub|nsim|Nscr|nscr|nsce|Wopf|ring|npre|wopf|npar|Auml|Barv|bbrk|Nopf|nopf|nmid|nLtv|beta|ropf|Ropf|Beta|beth|nles|rpar|nleq|bnot|bNot|nldr|NJcy|rscr|Rscr|Vscr|vscr|rsqb|njcy|bopf|nisd|Bopf|rtri|Vopf|nGtv|ngtr|vopf|boxh|boxH|boxv|nges|ngeq|boxV|bscr|scap|Bscr|bsim|Vert|vert|bsol|bull|bump|caps|cdot|ncup|scnE|ncap|nbsp|napE|Cdot|cent|sdot|Vbar|nang|vBar|chcy|Mscr|mscr|sect|semi|CHcy|Mopf|mopf|sext|circ|cire|mldr|mlcp|cirE|comp|shcy|SHcy|vArr|varr|cong|copf|Copf|copy|COPY|malt|male|macr|lvnE|cscr|ltri|sime|ltcc|simg|Cscr|siml|csub|Uuml|lsqb|lsim|uuml|csup|Lscr|lscr|utri|smid|lpar|cups|smte|lozf|darr|Lopf|Uscr|solb|lopf|sopf|Sopf|lneq|uscr|spar|dArr|lnap|Darr|dash|Sqrt|LJcy|ljcy|lHar|dHar|Upsi|upsi|diam|lesg|djcy|DJcy|leqq|dopf|Dopf|dscr|Dscr|dscy|ldsh|ldca|squf|DScy|sscr|Sscr|dsol|lcub|late|star|Star|Uopf|Larr|lArr|larr|uopf|dtri|dzcy|sube|subE|Lang|lang|Kscr|kscr|Kopf|kopf|KJcy|kjcy|KHcy|khcy|DZcy|ecir|edot|eDot|Jscr|jscr|succ|Jopf|jopf|Edot|uHar|emsp|ensp|Iuml|iuml|eopf|isin|Iscr|iscr|Eopf|epar|sung|epsi|escr|sup1|sup2|sup3|Iota|iota|supe|supE|Iopf|iopf|IOcy|iocy|Escr|esim|Esim|imof|Uarr|QUOT|uArr|uarr|euml|IEcy|iecy|Idot|Euml|euro|excl|Hscr|hscr|Hopf|hopf|TScy|tscy|Tscr|hbar|tscr|flat|tbrk|fnof|hArr|harr|half|fopf|Fopf|tdot|gvnE|fork|trie|gtcc|fscr|Fscr|gdot|gsim|Gscr|gscr|Gopf|gopf|gneq|Gdot|tosa|gnap|Topf|topf|geqq|toea|GJcy|gjcy|tint|gesl|mid|Sfr|ggg|top|ges|gla|glE|glj|geq|gne|gEl|gel|gnE|Gcy|gcy|gap|Tfr|tfr|Tcy|tcy|Hat|Tau|Ffr|tau|Tab|hfr|Hfr|ffr|Fcy|fcy|icy|Icy|iff|ETH|eth|ifr|Ifr|Eta|eta|int|Int|Sup|sup|ucy|Ucy|Sum|sum|jcy|ENG|ufr|Ufr|eng|Jcy|jfr|els|ell|egs|Efr|efr|Jfr|uml|kcy|Kcy|Ecy|ecy|kfr|Kfr|lap|Sub|sub|lat|lcy|Lcy|leg|Dot|dot|lEg|leq|les|squ|div|die|lfr|Lfr|lgE|Dfr|dfr|Del|deg|Dcy|dcy|lne|lnE|sol|loz|smt|Cup|lrm|cup|lsh|Lsh|sim|shy|map|Map|mcy|Mcy|mfr|Mfr|mho|gfr|Gfr|sfr|cir|Chi|chi|nap|Cfr|vcy|Vcy|cfr|Scy|scy|ncy|Ncy|vee|Vee|Cap|cap|nfr|scE|sce|Nfr|nge|ngE|nGg|vfr|Vfr|ngt|bot|nGt|nis|niv|Rsh|rsh|nle|nlE|bne|Bfr|bfr|nLl|nlt|nLt|Bcy|bcy|not|Not|rlm|wfr|Wfr|npr|nsc|num|ocy|ast|Ocy|ofr|xfr|Xfr|Ofr|ogt|ohm|apE|olt|Rho|ape|rho|Rfr|rfr|ord|REG|ang|reg|orv|And|and|AMP|Rcy|amp|Afr|ycy|Ycy|yen|yfr|Yfr|rcy|par|pcy|Pcy|pfr|Pfr|phi|Phi|afr|Acy|acy|zcy|Zcy|piv|acE|acd|zfr|Zfr|pre|prE|psi|Psi|qfr|Qfr|zwj|Or|ge|Gg|gt|gg|el|oS|lt|Lt|LT|Re|lg|gl|eg|ne|Im|it|le|DD|wp|wr|nu|Nu|dd|lE|Sc|sc|pi|Pi|ee|af|ll|Ll|rx|gE|xi|pm|Xi|ic|pr|Pr|in|ni|mp|mu|ac|Mu|or|ap|Gt|GT|ii);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)(?!;)([=a-zA-Z0-9]?)|&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+)/g,m={aacute:"á",Aacute:"Á",abreve:"ă",Abreve:"Ă",ac:"∾",acd:"∿",acE:"∾̳",acirc:"â",Acirc:"Â",acute:"´",acy:"а",Acy:"А",aelig:"æ",AElig:"Æ",af:"⁡",afr:"𝔞",Afr:"𝔄",agrave:"à",Agrave:"À",alefsym:"ℵ",aleph:"ℵ",alpha:"α",Alpha:"Α",amacr:"ā",Amacr:"Ā",amalg:"⨿",amp:"&",AMP:"&",and:"∧",And:"⩓",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",aogon:"ą",Aogon:"Ą",aopf:"𝕒",Aopf:"𝔸",ap:"≈",apacir:"⩯",ape:"≊",apE:"⩰",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",aring:"å",Aring:"Å",ascr:"𝒶",Ascr:"𝒜",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",bcy:"б",Bcy:"Б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",beta:"β",Beta:"Β",beth:"ℶ",between:"≬",bfr:"𝔟",Bfr:"𝔅",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bnot:"⌐",bNot:"⫭",bopf:"𝕓",Bopf:"𝔹",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxhD:"╥",boxHd:"╤",boxHD:"╦",boxhu:"┴",boxhU:"╨",boxHu:"╧",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"𝒷",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpe:"≏",bumpE:"⪮",bumpeq:"≏",Bumpeq:"≎",cacute:"ć",Cacute:"Ć",cap:"∩",Cap:"⋒",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",ccaron:"č",Ccaron:"Č",ccedil:"ç",Ccedil:"Ç",ccirc:"ĉ",Ccirc:"Ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",cdot:"ċ",Cdot:"Ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"𝔠",Cfr:"ℭ",chcy:"ч",CHcy:"Ч",check:"✓",checkmark:"✓",chi:"χ",Chi:"Χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cire:"≗",cirE:"⧃",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",colone:"≔",Colone:"⩴",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"𝕔",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",cscr:"𝒸",Cscr:"𝒞",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cup:"∪",Cup:"⋓",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",dArr:"⇓",Darr:"↡",dash:"‐",dashv:"⊣",Dashv:"⫤",dbkarow:"⤏",dblac:"˝",dcaron:"ď",Dcaron:"Ď",dcy:"д",Dcy:"Д",dd:"ⅆ",DD:"ⅅ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",delta:"δ",Delta:"Δ",demptyv:"⦱",dfisht:"⥿",dfr:"𝔡",Dfr:"𝔇",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",djcy:"ђ",DJcy:"Ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",dopf:"𝕕",Dopf:"𝔻",dot:"˙",Dot:"¨",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",downarrow:"↓",Downarrow:"⇓",DownArrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",dscr:"𝒹",Dscr:"𝒟",dscy:"ѕ",DScy:"Ѕ",dsol:"⧶",dstrok:"đ",Dstrok:"Đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",dzcy:"џ",DZcy:"Џ",dzigrarr:"⟿",eacute:"é",Eacute:"É",easter:"⩮",ecaron:"ě",Ecaron:"Ě",ecir:"≖",ecirc:"ê",Ecirc:"Ê",ecolon:"≕",ecy:"э",Ecy:"Э",eDDot:"⩷",edot:"ė",eDot:"≑",Edot:"Ė",ee:"ⅇ",efDot:"≒",efr:"𝔢",Efr:"𝔈",eg:"⪚",egrave:"è",Egrave:"È",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",emacr:"ē",Emacr:"Ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",eng:"ŋ",ENG:"Ŋ",ensp:" ",eogon:"ę",Eogon:"Ę",eopf:"𝕖",Eopf:"𝔼",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",epsilon:"ε",Epsilon:"Ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",esim:"≂",Esim:"⩳",eta:"η",Eta:"Η",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",fcy:"ф",Fcy:"Ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",ffr:"𝔣",Ffr:"𝔉",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",fopf:"𝕗",Fopf:"𝔽",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",Fscr:"ℱ",gacute:"ǵ",gamma:"γ",Gamma:"Γ",gammad:"ϝ",Gammad:"Ϝ",gap:"⪆",gbreve:"ğ",Gbreve:"Ğ",Gcedil:"Ģ",gcirc:"ĝ",Gcirc:"Ĝ",gcy:"г",Gcy:"Г",gdot:"ġ",Gdot:"Ġ",ge:"≥",gE:"≧",gel:"⋛",gEl:"⪌",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",gfr:"𝔤",Gfr:"𝔊",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",gjcy:"ѓ",GJcy:"Ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",gopf:"𝕘",Gopf:"𝔾",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",gscr:"ℊ",Gscr:"𝒢",gsim:"≳",gsime:"⪎",gsiml:"⪐",gt:">",Gt:"≫",GT:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",hardcy:"ъ",HARDcy:"Ъ",harr:"↔",hArr:"⇔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",hcirc:"ĥ",Hcirc:"Ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"𝒽",Hscr:"ℋ",hslash:"ℏ",hstrok:"ħ",Hstrok:"Ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",iacute:"í",Iacute:"Í",ic:"⁣",icirc:"î",Icirc:"Î",icy:"и",Icy:"И",Idot:"İ",iecy:"е",IEcy:"Е",iexcl:"¡",iff:"⇔",ifr:"𝔦",Ifr:"ℑ",igrave:"ì",Igrave:"Ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",ijlig:"ĳ",IJlig:"Ĳ",Im:"ℑ",imacr:"ī",Imacr:"Ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",int:"∫",Int:"∬",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",iocy:"ё",IOcy:"Ё",iogon:"į",Iogon:"Į",iopf:"𝕚",Iopf:"𝕀",iota:"ι",Iota:"Ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",itilde:"ĩ",Itilde:"Ĩ",iukcy:"і",Iukcy:"І",iuml:"ï",Iuml:"Ï",jcirc:"ĵ",Jcirc:"Ĵ",jcy:"й",Jcy:"Й",jfr:"𝔧",Jfr:"𝔍",jmath:"ȷ",jopf:"𝕛",Jopf:"𝕁",jscr:"𝒿",Jscr:"𝒥",jsercy:"ј",Jsercy:"Ј",jukcy:"є",Jukcy:"Є",kappa:"κ",Kappa:"Κ",kappav:"ϰ",kcedil:"ķ",Kcedil:"Ķ",kcy:"к",Kcy:"К",kfr:"𝔨",Kfr:"𝔎",kgreen:"ĸ",khcy:"х",KHcy:"Х",kjcy:"ќ",KJcy:"Ќ",kopf:"𝕜",Kopf:"𝕂",kscr:"𝓀",Kscr:"𝒦",lAarr:"⇚",lacute:"ĺ",Lacute:"Ĺ",laemptyv:"⦴",lagran:"ℒ",lambda:"λ",Lambda:"Λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larr:"←",lArr:"⇐",Larr:"↞",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",latail:"⤙",lAtail:"⤛",late:"⪭",lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",lcaron:"ľ",Lcaron:"Ľ",lcedil:"ļ",Lcedil:"Ļ",lceil:"⌈",lcub:"{",lcy:"л",Lcy:"Л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",leftarrow:"←",Leftarrow:"⇐",LeftArrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",Leftrightarrow:"⇔",LeftRightArrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",leg:"⋚",lEg:"⪋",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",lfr:"𝔩",Lfr:"𝔏",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",ljcy:"љ",LJcy:"Љ",ll:"≪",Ll:"⋘",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",lmidot:"ŀ",Lmidot:"Ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",Longleftarrow:"⟸",LongLeftArrow:"⟵",longleftrightarrow:"⟷",Longleftrightarrow:"⟺",LongLeftRightArrow:"⟷",longmapsto:"⟼",longrightarrow:"⟶",Longrightarrow:"⟹",LongRightArrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",lopf:"𝕝",Lopf:"𝕃",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",lstrok:"ł",Lstrok:"Ł",lt:"<",Lt:"≪",LT:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",map:"↦",Map:"⤅",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",mcy:"м",Mcy:"М",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",mfr:"𝔪",Mfr:"𝔐",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",mopf:"𝕞",Mopf:"𝕄",mp:"∓",mscr:"𝓂",Mscr:"ℳ",mstpos:"∾",mu:"μ",Mu:"Μ",multimap:"⊸",mumap:"⊸",nabla:"∇",nacute:"ń",Nacute:"Ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",ncaron:"ň",Ncaron:"Ň",ncedil:"ņ",Ncedil:"Ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",ncy:"н",Ncy:"Н",ndash:"–",ne:"≠",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",nfr:"𝔫",Nfr:"𝔑",nge:"≱",ngE:"≧̸",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",ngt:"≯",nGt:"≫⃒",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",njcy:"њ",NJcy:"Њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nle:"≰",nlE:"≦̸",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nlt:"≮",nLt:"≪⃒",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"𝕟",Nopf:"ℕ",not:"¬",Not:"⫬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrarr:"↛",nrArr:"⇏",nrarrc:"⤳̸",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",nscr:"𝓃",Nscr:"𝒩",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsube:"⊈",nsubE:"⫅̸",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupe:"⊉",nsupE:"⫆̸",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",ntilde:"ñ",Ntilde:"Ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",nu:"ν",Nu:"Ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",oacute:"ó",Oacute:"Ó",oast:"⊛",ocir:"⊚",ocirc:"ô",Ocirc:"Ô",ocy:"о",Ocy:"О",odash:"⊝",odblac:"ő",Odblac:"Ő",odiv:"⨸",odot:"⊙",odsold:"⦼",oelig:"œ",OElig:"Œ",ofcir:"⦿",ofr:"𝔬",Ofr:"𝔒",ogon:"˛",ograve:"ò",Ograve:"Ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",omacr:"ō",Omacr:"Ō",omega:"ω",Omega:"Ω",omicron:"ο",Omicron:"Ο",omid:"⦶",ominus:"⊖",oopf:"𝕠",Oopf:"𝕆",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",or:"∨",Or:"⩔",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",oscr:"ℴ",Oscr:"𝒪",oslash:"ø",Oslash:"Ø",osol:"⊘",otilde:"õ",Otilde:"Õ",otimes:"⊗",Otimes:"⨷",otimesas:"⨶",ouml:"ö",Ouml:"Ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",pcy:"п",Pcy:"П",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",pfr:"𝔭",Pfr:"𝔓",phi:"φ",Phi:"Φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",pi:"π",Pi:"Π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"𝕡",Popf:"ℙ",pound:"£",pr:"≺",Pr:"⪻",prap:"⪷",prcue:"≼",pre:"⪯",prE:"⪳",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",pscr:"𝓅",Pscr:"𝒫",psi:"ψ",Psi:"Ψ",puncsp:" ",qfr:"𝔮",Qfr:"𝔔",qint:"⨌",qopf:"𝕢",Qopf:"ℚ",qprime:"⁗",qscr:"𝓆",Qscr:"𝒬",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",racute:"ŕ",Racute:"Ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarr:"→",rArr:"⇒",Rarr:"↠",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",rarrtl:"↣",Rarrtl:"⤖",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",rcaron:"ř",Rcaron:"Ř",rcedil:"ŗ",Rcedil:"Ŗ",rceil:"⌉",rcub:"}",rcy:"р",Rcy:"Р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",rho:"ρ",Rho:"Ρ",rhov:"ϱ",RightAngleBracket:"⟩",rightarrow:"→",Rightarrow:"⇒",RightArrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"𝓇",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",sacute:"ś",Sacute:"Ś",sbquo:"‚",sc:"≻",Sc:"⪼",scap:"⪸",scaron:"š",Scaron:"Š",sccue:"≽",sce:"⪰",scE:"⪴",scedil:"ş",Scedil:"Ş",scirc:"ŝ",Scirc:"Ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",scy:"с",Scy:"С",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",sfr:"𝔰",Sfr:"𝔖",sfrown:"⌢",sharp:"♯",shchcy:"щ",SHCHcy:"Щ",shcy:"ш",SHcy:"Ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",sigma:"σ",Sigma:"Σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",softcy:"ь",SOFTcy:"Ь",sol:"/",solb:"⧄",solbar:"⌿",sopf:"𝕤",Sopf:"𝕊",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",square:"□",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",sscr:"𝓈",Sscr:"𝒮",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",star:"☆",Star:"⋆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",sube:"⊆",subE:"⫅",subedot:"⫃",submult:"⫁",subne:"⊊",subnE:"⫋",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup:"⊃",Sup:"⋑",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supe:"⊇",supE:"⫆",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supne:"⊋",supnE:"⫌",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",tau:"τ",Tau:"Τ",tbrk:"⎴",tcaron:"ť",Tcaron:"Ť",tcedil:"ţ",Tcedil:"Ţ",tcy:"т",Tcy:"Т",tdot:"⃛",telrec:"⌕",tfr:"𝔱",Tfr:"𝔗",there4:"∴",therefore:"∴",Therefore:"∴",theta:"θ",Theta:"Θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",thorn:"þ",THORN:"Þ",tilde:"˜",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",topf:"𝕥",Topf:"𝕋",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",tscr:"𝓉",Tscr:"𝒯",tscy:"ц",TScy:"Ц",tshcy:"ћ",TSHcy:"Ћ",tstrok:"ŧ",Tstrok:"Ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",uacute:"ú",Uacute:"Ú",uarr:"↑",uArr:"⇑",Uarr:"↟",Uarrocir:"⥉",ubrcy:"ў",Ubrcy:"Ў",ubreve:"ŭ",Ubreve:"Ŭ",ucirc:"û",Ucirc:"Û",ucy:"у",Ucy:"У",udarr:"⇅",udblac:"ű",Udblac:"Ű",udhar:"⥮",ufisht:"⥾",ufr:"𝔲",Ufr:"𝔘",ugrave:"ù",Ugrave:"Ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",umacr:"ū",Umacr:"Ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",uogon:"ų",Uogon:"Ų",uopf:"𝕦",Uopf:"𝕌",uparrow:"↑",Uparrow:"⇑",UpArrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",updownarrow:"↕",Updownarrow:"⇕",UpDownArrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",upsilon:"υ",Upsilon:"Υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",uring:"ů",Uring:"Ů",urtri:"◹",uscr:"𝓊",Uscr:"𝒰",utdot:"⋰",utilde:"ũ",Utilde:"Ũ",utri:"▵",utrif:"▴",uuarr:"⇈",uuml:"ü",Uuml:"Ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",vcy:"в",Vcy:"В",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",vee:"∨",Vee:"⋁",veebar:"⊻",veeeq:"≚",vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",vfr:"𝔳",Vfr:"𝔙",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",vopf:"𝕧",Vopf:"𝕍",vprop:"∝",vrtri:"⊳",vscr:"𝓋",Vscr:"𝒱",vsubne:"⊊︀",vsubnE:"⫋︀",vsupne:"⊋︀",vsupnE:"⫌︀",Vvdash:"⊪",vzigzag:"⦚",wcirc:"ŵ",Wcirc:"Ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",wfr:"𝔴",Wfr:"𝔚",wopf:"𝕨",Wopf:"𝕎",wp:"℘",wr:"≀",wreath:"≀",wscr:"𝓌",Wscr:"𝒲",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",xfr:"𝔵",Xfr:"𝔛",xharr:"⟷",xhArr:"⟺",xi:"ξ",Xi:"Ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",xopf:"𝕩",Xopf:"𝕏",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",xscr:"𝓍",Xscr:"𝒳",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",yacute:"ý",Yacute:"Ý",yacy:"я",YAcy:"Я",ycirc:"ŷ",Ycirc:"Ŷ",ycy:"ы",Ycy:"Ы",yen:"¥",yfr:"𝔶",Yfr:"𝔜",yicy:"ї",YIcy:"Ї",yopf:"𝕪",Yopf:"𝕐",yscr:"𝓎",Yscr:"𝒴",yucy:"ю",YUcy:"Ю",yuml:"ÿ",Yuml:"Ÿ",zacute:"ź",Zacute:"Ź",zcaron:"ž",Zcaron:"Ž",zcy:"з",Zcy:"З",zdot:"ż",Zdot:"Ż",zeetrf:"ℨ",ZeroWidthSpace:"​",zeta:"ζ",Zeta:"Ζ",zfr:"𝔷",Zfr:"ℨ",zhcy:"ж",ZHcy:"Ж",zigrarr:"⇝",zopf:"𝕫",Zopf:"ℤ",zscr:"𝓏",Zscr:"𝒵",zwj:"‍",zwnj:"‌"},g={aacute:"á",Aacute:"Á",acirc:"â",Acirc:"Â",acute:"´",aelig:"æ",AElig:"Æ",agrave:"à",Agrave:"À",amp:"&",AMP:"&",aring:"å",Aring:"Å",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",brvbar:"¦",ccedil:"ç",Ccedil:"Ç",cedil:"¸",cent:"¢",copy:"©",COPY:"©",curren:"¤",deg:"°",divide:"÷",eacute:"é",Eacute:"É",ecirc:"ê",Ecirc:"Ê",egrave:"è",Egrave:"È",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",frac12:"½",frac14:"¼",frac34:"¾",gt:">",GT:">",iacute:"í",Iacute:"Í",icirc:"î",Icirc:"Î",iexcl:"¡",igrave:"ì",Igrave:"Ì",iquest:"¿",iuml:"ï",Iuml:"Ï",laquo:"«",lt:"<",LT:"<",macr:"¯",micro:"µ",middot:"·",nbsp:" ",not:"¬",ntilde:"ñ",Ntilde:"Ñ",oacute:"ó",Oacute:"Ó",ocirc:"ô",Ocirc:"Ô",ograve:"ò",Ograve:"Ò",ordf:"ª",ordm:"º",oslash:"ø",Oslash:"Ø",otilde:"õ",Otilde:"Õ",ouml:"ö",Ouml:"Ö",para:"¶",plusmn:"±",pound:"£",quot:'"',QUOT:'"',raquo:"»",reg:"®",REG:"®",sect:"§",shy:"­",sup1:"¹",sup2:"²",sup3:"³",szlig:"ß",thorn:"þ",THORN:"Þ",times:"×",uacute:"ú",Uacute:"Ú",ucirc:"û",Ucirc:"Û",ugrave:"ù",Ugrave:"Ù",uml:"¨",uuml:"ü",Uuml:"Ü",yacute:"ý",Yacute:"Ý",yen:"¥",yuml:"ÿ"},y={0:"�",128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},A=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],v=String.fromCharCode,b={}.hasOwnProperty,x=function(t,e){return b.call(t,e)},C=function(t,e){if(!t)return e;var i,n={};for(i in e)n[i]=x(t,i)?t[i]:e[i];return n},w=function(t,e){var i="";return t>=55296&&t<=57343||t>1114111?(e&&S("character reference outside the permissible Unicode range"),"�"):x(y,t)?(e&&S("disallowed character reference"),y[t]):(e&&function(t,e){for(var i=-1,n=t.length;++i<n;)if(t[i]==e)return!0;return!1}(A,t)&&S("disallowed character reference"),t>65535&&(i+=v((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=v(t))},I=function(t){return"&#x"+t.toString(16).toUpperCase()+";"},E=function(t){return"&#"+t+";"},S=function(t){throw Error("Parse error: "+t)},D=function(t,e){(e=C(e,D.options)).strict&&f.test(t)&&S("forbidden code point");var i=e.encodeEverything,n=e.useNamedReferences,r=e.allowUnsafeSymbols,o=e.decimal?E:I,p=function(t){return o(t.charCodeAt(0))};return i?(t=t.replace(a,(function(t){return n&&x(c,t)?"&"+c[t]+";":p(t)})),n&&(t=t.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),n&&(t=t.replace(u,(function(t){return"&"+c[t]+";"})))):n?(r||(t=t.replace(h,(function(t){return"&"+c[t]+";"}))),t=(t=t.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;")).replace(u,(function(t){return"&"+c[t]+";"}))):r||(t=t.replace(h,p)),t.replace(s,(function(t){var e=t.charCodeAt(0),i=t.charCodeAt(1);return o(1024*(e-55296)+i-56320+65536)})).replace(l,p)};D.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1,decimal:!1};var T=function(t,e){var i=(e=C(e,T.options)).strict;return i&&d.test(t)&&S("malformed character reference"),t.replace(_,(function(t,n,r,o,s,a,l,u,c){var h,p,d,f,_,y;return n?m[_=n]:r?(_=r,(y=o)&&e.isAttributeValue?(i&&"="==y&&S("`&` did not start a character reference"),t):(i&&S("named character reference was not terminated by a semicolon"),g[_]+(y||""))):s?(d=s,p=a,i&&!p&&S("character reference was not terminated by a semicolon"),h=parseInt(d,10),w(h,i)):l?(f=l,p=u,i&&!p&&S("character reference was not terminated by a semicolon"),h=parseInt(f,16),w(h,i)):(i&&S("named character reference was not terminated by a semicolon"),t)}))};T.options={isAttributeValue:!1,strict:!1};var P={version:"1.2.0",encode:D,decode:T,escape:function(t){return t.replace(h,(function(t){return p[t]}))},unescape:T};if(n&&!n.nodeType)if(r)r.exports=P;else for(var B in P)x(P,B)&&(n[B]=P[B]);else i.he=P}(Vc)})).decode;class Qc extends Nc{constructor(t){super(),this.rawText=t,this.nodeType=Fc.TEXT_NODE}get text(){return this.rawText}get isWhitespace(){return/^(\s|&nbsp;)*$/.test(this.rawText)}toString(){return this.text}}let zc={};function Hc(t,e){return t?e?t.toLowerCase()===e.toLowerCase():!t:!e}const Xc={f145(t,e,i){if(e=e||"",i=i||[],t.id!==e.substr(1))return!1;for(let e=i,n=0;n<e.length;n++)if(-1===t.classNames.indexOf(e[n]))return!1;return!0},f45(t,e,i){for(let e=i=i||[],n=0;n<e.length;n++)if(-1===t.classNames.indexOf(e[n]))return!1;return!0},f15:(t,e)=>(e=e||"",t.id===e.substr(1)),f1(t,e){if(e=e||"",t.id!==e.substr(1))return!1},f5:()=>!0,f55(t,e,i,n){n=n||"";return t.attributes.hasOwnProperty(n)},f245(t,e,i,n,r){n=(n||"").toLowerCase(),r=r||"";const o=t.attributes;return Object.keys(o).some(t=>{const e=o[t];return t.toLowerCase()===n&&e===r})},f25(t,e,i,n,r){n=(n||"").toLowerCase(),r=r||"";const o=t.attributes;return Object.keys(o).some(t=>{const e=o[t];return t.toLowerCase()===n&&e===r})},f2(t,e,i,n,r){n=(n||"").toLowerCase(),r=r||"";const o=t.attributes;return Object.keys(o).some(t=>{const e=o[t];return t.toLowerCase()===n&&e===r})},f345(t,e,i){if(e=e||"",i=i||[],!Hc(t.tagName,e))return!1;for(let e=i,n=0;n<e.length;n++)if(-1===t.classNames.indexOf(e[n]))return!1;return!0},f35:(t,e)=>(e=e||"",Hc(t.tagName,e)),f3:(t,e)=>(e=e||"",Hc(t.tagName,e))};class qc{constructor(t){this.nextMatch=0,this.matchers=t.split(" ").map(t=>{if(zc[t])return zc[t];const e=t.split("."),i=e[0],n=e.slice(1).sort();let r="f",o="",s="";if(i&&"*"!==i){let t;if(i.startsWith("#"))r+="1";else if(t=/^\[\s*(\S+)\s*(=|!=)\s*((((["'])([^\6]*)\6))|(\S*?))\]\s*/.exec(i),t){o=t[1];let e=t[2];if("="!==e&&"!="!==e)throw new Error("Selector not supported, Expect [key${op}value].op must be =,!=");"="===e&&(e="=="),s=t[7]||t[8],r+="2"}else(t=/^\[(.*?)\]/.exec(i))?(o=t[1],r+="5"):r+="3"}n.length>0&&(r+="4"),r+="5";const a={func:Xc[r],tagName:i||"",classes:n||"",attr_key:o||"",value:s||""};return zc[t]=a})}advance(t){return!!(this.nextMatch<this.matchers.length&&this.matchers[this.nextMatch].func(t,this.matchers[this.nextMatch].tagName,this.matchers[this.nextMatch].classes,this.matchers[this.nextMatch].attr_key,this.matchers[this.nextMatch].value))&&(this.nextMatch++,!0)}rewind(){this.nextMatch--}get matched(){return this.nextMatch===this.matchers.length}reset(){this.nextMatch=0}flushCache(){zc={}}}function Yc(t){return t[t.length-1]}const Kc=new Map;Kc.set("DIV",!0),Kc.set("div",!0),Kc.set("P",!0),Kc.set("p",!0),Kc.set("LI",!0),Kc.set("li",!0),Kc.set("TD",!0),Kc.set("td",!0),Kc.set("SECTION",!0),Kc.set("section",!0),Kc.set("BR",!0),Kc.set("br",!0);class Wc extends Nc{constructor(t,e,i="",n=null){if(super(),this.rawAttrs=i,this.parentNode=n,this.classNames=[],this.nodeType=Fc.ELEMENT_NODE,this.rawTagName=t,this.rawAttrs=i||"",this.parentNode=n||null,this.childNodes=[],e.id&&(this.id=e.id,i||(this.rawAttrs=`id="${e.id}"`)),e.class&&(this.classNames=e.class.split(/\s+/),!i)){const t=`class="${this.classNames.join(" ")}"`;this.rawAttrs?this.rawAttrs+=" "+t:this.rawAttrs=t}}removeChild(t){this.childNodes=this.childNodes.filter(e=>e!==t)}exchangeChild(t,e){let i=-1;for(let e=0;e<this.childNodes.length;e++)if(this.childNodes[e]===t){i=e;break}this.childNodes[i]=e}get tagName(){return this.rawTagName?this.rawTagName.toUpperCase():this.rawTagName}get rawText(){return this.childNodes.reduce((t,e)=>t+e.rawText,"")}get text(){return Gc(this.rawText)}get structuredText(){let t=[];const e=[t];return function i(n){if(n.nodeType===Fc.ELEMENT_NODE)Kc.get(n.rawTagName)?(t.length>0&&e.push(t=[]),n.childNodes.forEach(i),t.length>0&&e.push(t=[])):n.childNodes.forEach(i);else if(n.nodeType===Fc.TEXT_NODE)if(n.isWhitespace)t.prependWhitespace=!0;else{let e=n.text;t.prependWhitespace&&(e=" "+e,t.prependWhitespace=!1),t.push(e)}}(this),e.map(t=>t.join("").trim().replace(/\s{2,}/g," ")).join("\n").replace(/\s+$/,"")}toString(){const t=this.rawTagName;if(t){const e=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/i.test(t),i=this.rawAttrs?" "+this.rawAttrs:"";return e?`<${t}${i}>`:`<${t}${i}>${this.innerHTML}</${t}>`}return this.innerHTML}get innerHTML(){return this.childNodes.map(t=>t.toString()).join("")}set_content(t,e={}){if(t instanceof Nc)t=[t];else if("string"==typeof t){const i=nh(t,e);t=i.childNodes.length?i.childNodes:[new Qc(t)]}this.childNodes=t}get outerHTML(){return this.toString()}trimRight(t){for(let e=0;e<this.childNodes.length;e++){const i=this.childNodes[e];if(i.nodeType===Fc.ELEMENT_NODE)i.trimRight(t);else{const n=i.rawText.search(t);n>-1&&(i.rawText=i.rawText.substr(0,n),this.childNodes.length=e+1)}}return this}get structure(){const t=[];let e=0;function i(i){t.push("  ".repeat(e)+i)}return function t(n){const r=n.id?"#"+n.id:"",o=n.classNames.length?"."+n.classNames.join("."):"";i(n.rawTagName+r+o),e++,n.childNodes.forEach(e=>{e.nodeType===Fc.ELEMENT_NODE?t(e):e.nodeType===Fc.TEXT_NODE&&(e.isWhitespace||i("#text"))}),e--}(this),t.join("\n")}removeWhitespace(){let t=0;return this.childNodes.forEach(e=>{if(e.nodeType===Fc.TEXT_NODE){if(e.isWhitespace)return;e.rawText=e.rawText.trim()}else e.nodeType===Fc.ELEMENT_NODE&&e.removeWhitespace();this.childNodes[t++]=e}),this.childNodes.length=t,this}querySelectorAll(t){let e;if(t instanceof qc)e=t,e.reset();else{if(t.includes(",")){const e=t.split(",");return Array.from(e.reduce((t,e)=>this.querySelectorAll(e.trim()).reduce((t,e)=>t.add(e),t),new Set))}e=new qc(t)}const i=[];return this.childNodes.reduce((n,r)=>{for(i.push([r,0,!1]);i.length;){const r=Yc(i),o=r[0];if(0===r[1]){if(o.nodeType!==Fc.ELEMENT_NODE){i.pop();continue}const s=o;if(r[2]=e.advance(s),r[2]&&e.matched){n.push(s),n.push(...s.querySelectorAll(t)),e.rewind(),i.pop();continue}}r[1]<o.childNodes.length?i.push([o.childNodes[r[1]++],0,!1]):(r[2]&&e.rewind(),i.pop())}return n},[])}querySelector(t){let e;t instanceof qc?(e=t,e.reset()):e=new qc(t);const i=[];for(const t of this.childNodes)for(i.push([t,0,!1]);i.length;){const t=Yc(i),n=t[0];if(0===t[1]){if(n.nodeType!==Fc.ELEMENT_NODE){i.pop();continue}if(t[2]=e.advance(n),t[2]&&e.matched)return n}t[1]<n.childNodes.length?i.push([n.childNodes[t[1]++],0,!1]):(t[2]&&e.rewind(),i.pop())}return null}appendChild(t){return this.childNodes.push(t),t instanceof Wc&&(t.parentNode=this),t}get firstChild(){return this.childNodes[0]}get lastChild(){return Yc(this.childNodes)}get attributes(){if(this._attrs)return this._attrs;this._attrs={};const t=this.rawAttributes;for(const e in t){const i=t[e]||"";this._attrs[e]=Gc(i)}return this._attrs}get rawAttributes(){if(this._rawAttrs)return this._rawAttrs;const t={};if(this.rawAttrs){const e=/\b([a-z][a-z0-9-]*)(?:\s*=\s*(?:"([^"]*)"|'([^']*)'|(\S+)))?/gi;let i;for(;i=e.exec(this.rawAttrs);)t[i[1]]=i[2]||i[3]||i[4]||null}return this._rawAttrs=t,t}removeAttribute(t){const e=this.rawAttributes;delete e[t],this._attrs&&delete this._attrs[t],this.rawAttrs=Object.keys(e).map(t=>{const i=JSON.stringify(e[t]);return void 0===i||"null"===i?t:`${t}=${i}`}).join(" ")}hasAttribute(t){return t in this.attributes}getAttribute(t){return this.attributes[t]}setAttribute(t,e){if(arguments.length<2)throw new Error("Failed to execute 'setAttribute' on 'Element'");const i=this.rawAttributes;i[t]=String(e),this._attrs&&(this._attrs[t]=Gc(i[t])),this.rawAttrs=Object.keys(i).map(t=>{const e=JSON.stringify(i[t]);return"null"===e||'""'===e?t:`${t}=${e}`}).join(" ")}setAttributes(t){this._attrs&&delete this._attrs,this._rawAttrs&&delete this._rawAttrs,this.rawAttrs=Object.keys(t).map(e=>{const i=t[e];return"null"===i||'""'===i?e:`${e}=${JSON.stringify(String(i))}`}).join(" ")}insertAdjacentHTML(t,e){if(arguments.length<2)throw new Error("2 arguments required");const i=nh(e);if("afterend"===t){const t=this.parentNode.childNodes.findIndex(t=>t===this);this.parentNode.childNodes.splice(t+1,0,...i.childNodes),i.childNodes.forEach(t=>{t instanceof Wc&&(t.parentNode=this.parentNode)})}else if("afterbegin"===t)this.childNodes.unshift(...i.childNodes);else if("beforeend"===t)i.childNodes.forEach(t=>{this.appendChild(t)});else{if("beforebegin"!==t)throw new Error(`The value provided ('${t}') is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'`);{const t=this.parentNode.childNodes.findIndex(t=>t===this);this.parentNode.childNodes.splice(t,0,...i.childNodes),i.childNodes.forEach(t=>{t instanceof Wc&&(t.parentNode=this.parentNode)})}}}}const Jc=/<!--[^]*?(?=-->)-->|<(\/?)([a-z][-.:0-9_a-z]*)\s*([^>]*?)(\/?)>/gi,Zc=/(^|\s)(id|class)\s*=\s*("([^"]+)"|'([^']+)'|(\S+))/gi,$c={area:!0,AREA:!0,base:!0,BASE:!0,br:!0,BR:!0,col:!0,COL:!0,hr:!0,HR:!0,img:!0,IMG:!0,input:!0,INPUT:!0,link:!0,LINK:!0,meta:!0,META:!0,source:!0,SOURCE:!0,embed:!0,EMBED:!0,param:!0,PARAM:!0,track:!0,TRACK:!0,wbr:!0,WBR:!0},th={li:{li:!0,LI:!0},LI:{li:!0,LI:!0},p:{p:!0,div:!0,P:!0,DIV:!0},P:{p:!0,div:!0,P:!0,DIV:!0},b:{div:!0,DIV:!0},B:{div:!0,DIV:!0},td:{td:!0,th:!0,TD:!0,TH:!0},TD:{td:!0,th:!0,TD:!0,TH:!0},th:{td:!0,th:!0,TD:!0,TH:!0},TH:{td:!0,th:!0,TD:!0,TH:!0},h1:{h1:!0,H1:!0},H1:{h1:!0,H1:!0},h2:{h2:!0,H2:!0},H2:{h2:!0,H2:!0},h3:{h3:!0,H3:!0},H3:{h3:!0,H3:!0},h4:{h4:!0,H4:!0},H4:{h4:!0,H4:!0},h5:{h5:!0,H5:!0},H5:{h5:!0,H5:!0},h6:{h6:!0,H6:!0},H6:{h6:!0,H6:!0}},eh={li:{ul:!0,ol:!0,UL:!0,OL:!0},LI:{ul:!0,ol:!0,UL:!0,OL:!0},a:{div:!0,DIV:!0},A:{div:!0,DIV:!0},b:{div:!0,DIV:!0},B:{div:!0,DIV:!0},i:{div:!0,DIV:!0},I:{div:!0,DIV:!0},p:{div:!0,DIV:!0},P:{div:!0,DIV:!0},td:{tr:!0,table:!0,TR:!0,TABLE:!0},TD:{tr:!0,table:!0,TR:!0,TABLE:!0},th:{tr:!0,table:!0,TR:!0,TABLE:!0},TH:{tr:!0,table:!0,TR:!0,TABLE:!0}},ih="documentfragmentcontainer";function nh(t,e={lowerCaseTagName:!1,comment:!1}){const i=e.blockTextElements||{script:!0,noscript:!0,style:!0,pre:!0},n=Object.keys(i),r=n.map(t=>new RegExp(t,"i")),o=n.filter(t=>i[t]).map(t=>new RegExp(t,"i"));function s(t){return o.some(e=>e.test(t))}function a(t){return r.some(e=>e.test(t))}const l=new Wc(null,{});let u=l;const c=[l];let h,p=-1;for(t=`<${ih}>${t}</${ih}>`;h=Jc.exec(t);){if(p>-1&&p+h[0].length<Jc.lastIndex){const e=t.substring(p,Jc.lastIndex-h[0].length);u.appendChild(new Qc(e))}if(p=Jc.lastIndex,h[2]!==ih)if("!"!==h[0][1]){if(e.lowerCaseTagName&&(h[2]=h[2].toLowerCase()),!h[1]){const i={};for(let t;t=Zc.exec(h[3]);)i[t[2].toLowerCase()]=t[4]||t[5]||t[6];const n=u.rawTagName;if(!h[4]&&th[n]&&th[n][h[2]]&&(c.pop(),u=Yc(c)),u=u.appendChild(new Wc(h[2],i,h[3])),c.push(u),a(h[2])){const i=`</${h[2]}>`,n=e.lowerCaseTagName?t.toLocaleLowerCase().indexOf(i,Jc.lastIndex):t.indexOf(i,Jc.lastIndex);if(s(h[2])){let e;e=-1===n?t.substr(Jc.lastIndex):t.substring(Jc.lastIndex,n),e.length>0&&u.appendChild(new Qc(e))}-1===n?p=Jc.lastIndex=t.length+1:(p=Jc.lastIndex=n+i.length,h[1]="true")}}if(h[1]||h[4]||$c[h[2]])for(;;){if(u.rawTagName===h[2]){c.pop(),u=Yc(c);break}{const t=u.tagName;if(eh[t]&&eh[t][h[2]]){c.pop(),u=Yc(c);continue}break}}}else if(e.comment){const e=t.substring(p-3,p-h[0].length+4);u.appendChild(new kc(e))}}const d=Boolean(1===c.length);if(!e.noFix){const t=l;for(t.valid=d;c.length>1;){const t=c.pop(),e=Yc(c);t.parentNode&&t.parentNode.parentNode&&(t.parentNode===e&&t.tagName===e.tagName?(e.removeChild(t),t.childNodes.forEach(t=>{e.parentNode.appendChild(t)}),c.pop()):(e.removeChild(t),t.childNodes.forEach(t=>{e.appendChild(t)})))}return t.childNodes.forEach(t=>{t instanceof Wc&&(t.parentNode=null)}),t}const f=new Qc(t);return f.valid=d,f}var rh=function(){function t(){}return t.get=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.processHTML=function(t,e){e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(new RegExp("&nbsp;","g")," ")).replace(new RegExp("â","g"),String.fromCharCode(8730))).replace(new RegExp("Ã","g"),String.fromCharCode(215))).replace(new RegExp("<\\\\","g"),"</")).replace(new RegExp("<br>","g"),"<br/>")).replace(new RegExp("<BR>","g"),"<br/>")).replace(new RegExp("<BR/>","g"),"<br/>")).replace(new RegExp("<B","g"),"<b")).replace(new RegExp("</B>","g"),"</b>")).replace(new RegExp("<I","g"),"<i")).replace(new RegExp("</I>","g"),"</i>")).replace(new RegExp("<P","g"),"<p")).replace(new RegExp("</P>","g"),"</p>")).replace(new RegExp("<U","g"),"<u")).replace(new RegExp("</U>","g"),"</u>")).replace(new RegExp("<LI","g"),"<li")).replace(new RegExp("</LI>","g"),"</li>")).replace(new RegExp("<FONT","g"),"<font")).replace(new RegExp("</FONT>","g"),"</font>")).replace(new RegExp("& ","g"),"&amp; ");for(var i=0,n=[],r=[],o=[];i<e.length;)if("<"==e[i]){if("p"==e[i+1])n[n.length]="p";else if("b"==e[i+1]&&"r"!=e[i+2])n[n.length]="b";else if("i"==e[i+1])n[n.length]="i";else if("u"==e[i+1])n[n.length]="u";else if("f"==e[i+1]&&"o"==e[i+2]&&"n"==e[i+3]&&"t"==e[i+4])n[n.length]="font",i+=2;else if("l"==e[i+1]&&"i"==e[i+2])n[n.length]="li",i++;else if("/"==e[i+1]&&"p"==e[i+2]){for(var s=n.length,a=-1;s>0;)if("p"==n[--s]){a=s;break}if(a<0)r[r.length]=i,o[o.length]=4;else{for(s=n.length-1;s>a;)r[r.length]=i,o[o.length]="</"+n[s]+">",n.pop(),s--;n.pop()}}else if("/"==e[i+1]&&"b"==e[i+2]){var l=n.length;for(a=-1;l>0;)if("b"==n[--l]){a=l;break}if(a<0)r[r.length]=i,o[o.length]=4;else{for(l=n.length-1;l>a;)r[r.length]=i,o[o.length]="</"+n[l]+">",n.pop(),l--;n.pop()}}else if("/"==e[i+1]&&"i"==e[i+2]){var u=n.length;for(a=-1;u>0;)if("i"==n[--u]){a=u;break}if(a<0)r[r.length]=i,o[o.length]=4;else{for(u=n.length-1;u>a;)r[r.length]=i,o[o.length]="</"+n[u]+">",n.pop(),u--;n.pop()}}else if("/"==e[i+1]&&"u"==e[i+2]){var c=n.length;for(a=-1;c>0;)if("u"==n[--c]){a=c;break}if(a<0)r[r.length]=i,o[o.length]=4;else{for(c=n.length-1;c>a;)r[r.length]=i,o[o.length]="</"+n[c]+">",n.pop(),c--;n.pop()}}else if("/"==e[i+1]&&"l"==e[i+2]&&"i"==e[i+3]){var h=n.length;for(a=-1;h>0;)if("li"==n[--h]){a=h;break}if(a<0)r[r.length]=i,o[o.length]=7;else{for(h=n.length-1;h>a;)r[r.length]=i,o[o.length]="</"+n[h]+">",n.pop(),h--;n.pop()}}else if("/"==e[i+1]&&"f"==e[i+2]&&"o"==e[i+3]&&"n"==e[i+4]&&"t"==e[i+5]){var p=n.length;for(a=-1;p>0;)if("font"==n[--p]){a=p;break}if(a<0)r[r.length]=i,o[o.length]=7;else{for(p=n.length-1;p>a;)r[r.length]=i,o[o.length]="</"+n[p]+">",n.pop(),p--;n.pop()}}i++}else i++;for(var d=n.length;d>0;)d--,r[r.length]=i,o[o.length]="</"+n[d]+">";for(var f=0,_=o.length,m=0;m<_;m++)"number"==typeof o[m]?(e=e.slice(0,r[m]+f)+e.slice(r[m]+f+o[m]),f-=o[m]):(e=e.slice(0,r[m]+f)+o[m]+e.slice(r[m]+f),f+=o[m].length);var g={text:""};t._textFormat.italic=!1,t._textFormat.bold=!1,t._textFormats=[t._textFormat],t._textFormatsIdx=[0];var y=nh(e);return y&&y.firstChild&&(g.multiline=y.firstChild.childNodes.length>0,this.readHTMLTextPropertiesRecursive(t,y,g,t._textFormat)),""==g.text||13!=g.text.charCodeAt(g.text.length-1)&&10!=g.text.charCodeAt(g.text.length-1)||(g.text=g.text.slice(0,g.text.length-1)),""!=g.text&&g.text.length>=2&&"n"==g.text[g.text.length-1]&&"\\"==g.text[g.text.length-2]&&(g.text=g.text.slice(0,g.text.length-2)),""!=g.text&&g.text.length>=2&&"n"==g.text[g.text.length-1]&&"\\"==g.text[g.text.length-2]&&(g.text=g.text.slice(0,g.text.length-2)),t._textFormatsIdx[t._textFormatsIdx.length-1]=g.text.replace(/(\r\n|\n|\\n|\r)/gm,"").length,g.text},t.prototype.readHTMLTextPropertiesRecursive=function(t,e,i,n){var r=[],o=[];if(e.attributes){if(e.attributes.size||e.attributes.SIZE)s=(s=e.attributes.size?e.attributes.size:e.attributes.SIZE).replace(/[^0-9.]/g,""),r[r.length]=parseInt(s),o[o.length]="size";if(e.attributes.color||e.attributes.COLOR)s=(s=e.attributes.color?e.attributes.color:e.attributes.COLOR).replace("#","0x"),r[r.length]=parseInt(s),o[o.length]="color";if(e.attributes.indent||e.attributes.INDENT)s=(s=e.attributes.indent?e.attributes.indent:e.attributes.INDENT).replace(/[^0-9.]/g,""),r[r.length]=parseInt(s),o[o.length]="indent";if(e.attributes.leftMargin||e.attributes.LEFTMARGIN)s=(s=e.attributes.leftMargin?e.attributes.leftMargin:e.attributes.LEFTMARGIN).replace(/[^0-9.]/g,""),r[r.length]=parseInt(s),o[o.length]="leftMargin";if(e.attributes.rightMargin||e.attributes.RIGHTMARGIN)s=(s=e.attributes.rightMargin?e.attributes.rightMargin:e.attributes.RIGHTMARGIN).replace(/[^0-9.]/g,""),r[r.length]=parseInt(s),o[o.length]="rightMargin";if(e.attributes.align||e.attributes.ALIGN){var s=e.attributes.align?e.attributes.align:e.attributes.ALIGN;r[r.length]=s,o[o.length]="align"}if(e.attributes.face||e.attributes.FACE){s=e.attributes.face?e.attributes.face:e.attributes.FACE;r[r.length]=s,o[o.length]="font"}}for(var a=r.length,l=!1;a>0;)if(n[o[--a]]!=r[a]){l=!0;break}"b"==e.tagName?n.bold||(l=!0,r[r.length]=!0,o[o.length]="bold"):"i"==e.tagName?n.italic||(l=!0,r[r.length]=!0,o[o.length]="italic"):"u"==e.tagName?n.underline||(l=!0,r[r.length]=!0,o[o.length]="underline"):"font"==e.tagName?l=!0:"li"==e.tagName?i.text+="    ●    ":"br"==e.tagName&&t.multiline&&(i.text+="\n");var u=n;if(l){for(u=n.clone(),a=r.length;a>0;)u[o[--a]]=r[a];t._textFormats.push(u),t._textFormatsIdx[t._textFormatsIdx.length-1]=i.text.replace(/(\r\n|\n|\\n|\r)/gm,"").length,t._textFormatsIdx.push(i.text.replace(/(\r\n|\n|\\n|\r)/gm,"").length)}if(e.childNodes&&e.childNodes.length>0)for(var c=0;c<e.childNodes.length;c++)t._textFormats[t._textFormats.length-1]!=u&&(t._textFormats.push(u),t._textFormatsIdx[t._textFormatsIdx.length-1]=i.text.replace(/(\r\n|\n|\\n|\r)/gm,"").length,t._textFormatsIdx.push(i.text.replace(/(\r\n|\n|\\n|\r)/gm,"").length)),this.readHTMLTextPropertiesRecursive(t,e.childNodes[c],i,u);else""!=e.text.replace(/[\s\r\n]/gi,"")&&(i.text+=e.text);"li"!=e.tagName&&"p"!=e.tagName||(i.text+="\n")},t}(),oh=[{test:/\&apos;/g,replace:"'"}],sh=function(t){function e(){var e=t.call(this)||this;return e._isEntity=!1,e.textOffsetX=0,e.textOffsetY=0,e._selectionBeginIndex=0,e._selectionEndIndex=0,e._biggestLine=0,e._iText="",e._text="",e._iTextWoLineBreaks="",e.inMaskMode=!1,e.cursorIntervalID=-1,e.cursorBlinking=!1,e.showSelection=!1,e._textDirty=!1,e._positionsDirty=!1,e._glyphsDirty=!1,e._shapesDirty=!1,e._textShapesDirty=!1,e.chars_codes=[],e.chars_codes_prev=[],e.chars_width=[],e.tf_per_char=[],e.tf_per_char_prev=[],e.last_word_vertices_count=0,e.words=[],e._textRuns_formats=[],e._textRuns_words=[],e._paragraph_textRuns_indices=[],e.cleanLastWord=!1,e._maxWidthLine=0,e._labelData=null,e.lines_wordStartIndices=[],e.lines_wordEndIndices=[],e.lines_start_y=[],e.lines_start_x=[],e.lines_charIdx_start=[],e.lines_charIdx_end=[],e.lines_width=[],e.lines_height=[],e.lines_numSpacesPerline=[],e.char_positions_x=[],e.char_positions_y=[],e.sourceTextField=null,e._maskWidth=0,e._maskHeight=0,e._maskTextOffsetX=0,e._maskTextOffsetY=0,e.isStatic=!1,e._internalScale=new P(1,1,1),e.onKeyDelegate=function(t){return e.onKey(t)},e.startSelectionByMouseDelegate=function(t){return e.startSelectionByMouse(t)},e.stopSelectionByMouseDelegate=function(t){return e.stopSelectionByMouse(t)},e.updateSelectionByMouseDelegate=function(t){return e.updateSelectionByMouse(t)},e._onGraphicsInvalidateDelegate=function(t){return e._onGraphicsInvalidate(t)},e.cursorIntervalID=-1,e._tabEnabled=!0,e.cursorType="",e.textOffsetX=0,e.textOffsetY=0,e.textShapes={},e._textColor=0,e._width=100,e._height=100,e._textWidth=0,e._textHeight=0,e._type=gc.DYNAMIC,e._selectable=!1,e._numLines=0,e.multiline=!1,e._autoSize=mc.NONE,e._wordWrap=!1,e._background=!1,e._backgroundColor=16777215,e._border=!1,e._borderColor=0,e.html=!1,e.maxChars=0,e._selectionBeginIndex=0,e._selectionEndIndex=0,e._scrollH=0,e._scrollV=0,e._textFormats=[],e._graphics=Sa.getGraphics(),e._graphics.addEventListener(l.INVALIDATE,e._onGraphicsInvalidateDelegate),e.mouseEnabled=e._selectable,e}return i(e,t),e.getNewTextField=function(){return e._textFields.length?e._textFields.pop():new e},e.clearPool=function(){e._textFields=[]},e.prototype.updateMaskMode=function(){if(this.inMaskMode&&(this._maskWidth==this._width&&this._maskHeight==this._height&&this._maskTextOffsetX==this.textOffsetX&&this._maskTextOffsetY==this.textOffsetY||(this._maskWidth=this._width,this._maskHeight=this._height,this._maskTextOffsetX=this.textOffsetX,this._maskTextOffsetY=this.textOffsetY,this.maskChild.graphics.clear(),this.maskChild.graphics.beginFill(16777215),this.maskChild.graphics.drawRect(this.textOffsetX,this.textOffsetY,this._width,this._height),this.maskChild.graphics.endFill()),this._graphics.clear()),!this.inMaskMode)return this.inMaskMode=!0,this.maskChild||(this.maskChild=new ka),this.textChild||(this.textChild=new Lc),this.textChild.mouseEnabled=!1,this.textChild.parentTextField=this,this.maskChild.mouseEnabled=!1,this.maskChild.graphics.beginFill(16777215),this.maskChild.graphics.drawRect(this.textOffsetX,this.textOffsetY,this._width,this._height),this.maskChild.graphics.endFill(),this.addChild(this.maskChild),this.addChild(this.textChild),this.maskChild.maskMode=!0,this._graphics.clear(),void(this.targetGraphics=this.textChild.graphics);this._textWidth>this._width||this._textHeight>this._height?this.textChild.masks=[this.maskChild]:this.textChild.masks=null},e.prototype.getMouseCursor=function(){return this.cursorType},Object.defineProperty(e.prototype,"isInFocus",{get:function(){return this._isInFocus},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.setFocus=function(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!0),this._isInFocus!=e&&(t.prototype.setFocus.call(this,e,i,n),this.enableInput(e),this._selectable&&(this.setSelection(0,0),this._glyphsDirty=!0,this._implicitPartition&&this._implicitPartition.invalidateEntity(this)))},e.prototype.enableInput=function(t){if(void 0===t&&(t=!0),this.cursorIntervalID>=0&&(window.clearInterval(this.cursorIntervalID),this.cursorIntervalID=-1),t&&this._isInFocus&&this.selectable){this.drawSelectionGraphics();var e=this;this.cursorIntervalID=window.setInterval((function(){e.cursorBlinking=!e.cursorBlinking,e.selectable||(e.cursorBlinking=!0),e._shapesDirty=!0,e.invalidate()}),500)}},e.prototype.findCharIdxForMouse=function(t){var e=this.textChild.transform.globalToLocal(new D(t.scenePosition.x,t.scenePosition.y)),i=this.getLineIndexAtPoint(e.x,e.y),n=this.getCharIndexAtPoint(e.x,e.y,i);return i>=this.lines_start_x.length&&(i=this.lines_start_x.length-1),i<0&&(i=0),i>=0&&n<0&&void 0!==this.lines_start_x[i]&&(n=e.x<=this.lines_start_x[i]?this.lines_charIdx_start[i]:this.lines_charIdx_end[i]),(i<0||n<0)&&(n=0),n},e.prototype.startSelectionByMouse=function(t){this._selectionBeginIndex=this.findCharIdxForMouse(t),this._selectionEndIndex=this._selectionBeginIndex,this.cursorShape&&this.cursorShape.invalidate(),this.cursorShape=void 0,this.bgShapeSelect&&this.bgShapeSelect.invalidate(),this.bgShapeSelect=void 0,this._glyphsDirty=!0,this._shapesDirty=!0,this._textShapesDirty=!0,this.cursorBlinking=!1,this.drawSelectionGraphics()},e.prototype.stopSelectionByMouse=function(t){this._selectionEndIndex=this.findCharIdxForMouse(t),this._glyphsDirty=!0,this.reConstruct(),this.drawSelectionGraphics()},e.prototype.updateSelectionByMouse=function(t){this._selectionEndIndex=this.findCharIdxForMouse(t),this.bgShapeSelect&&this.bgShapeSelect.invalidate(),this.bgShapeSelect=void 0,this._glyphsDirty=!0,this.reConstruct(),this.drawSelectionGraphics()},e.prototype.drawSelectionGraphics=function(){this._selectionBeginIndex<0&&(this._selectionBeginIndex=0),this._selectionBeginIndex>this.char_positions_x.length&&(this._selectionBeginIndex=this.char_positions_x.length),this._selectionEndIndex<0&&(this._selectionEndIndex=0),this._selectionEndIndex>this.char_positions_x.length&&(this._selectionEndIndex=this.char_positions_x.length),this._selectionBeginIndex===this._selectionEndIndex?(this.showSelection=!1,this.drawCursor()):(this.showSelection=!0,this.cursorBlinking=!0,this.drawSelectedBG())},e.prototype.scrollToCursor=function(t,e){},e.prototype.drawCursor=function(){if(this._shapesDirty=!0,!this.cursorBlinking&&this.selectable&&this.selectionBeginIndex===this.selectionEndIndex){var t=0,e=0,i=this.newTextFormat;0==this.char_positions_x.length?(t=this.textOffsetX+this._width/2+this._textWidth/2,"justify"==i.align||"center"==i.align||("right"==i.align?t=this.textOffsetX+this._width-2:"left"==i.align&&(t=this.textOffsetX+4+this._textWidth))):this._selectionBeginIndex==this.char_positions_x.length?(t=this.char_positions_x[this._selectionBeginIndex-1]+this.chars_width[this._selectionBeginIndex-1],e=this.char_positions_y[this._selectionBeginIndex-1],i=this.tf_per_char[this._selectionBeginIndex-1]):(t=this.char_positions_x[this._selectionBeginIndex],e=this.char_positions_y[this._selectionBeginIndex],i=this.tf_per_char[this._selectionBeginIndex]),i.font_table.initFontSize(i.size);var n=i.font_table.getLineHeight(),r=this.getTextColorForTextFormat(i),o=this.internalScale.x;o<=0&&(o=1);var s=[t-.5*o,e,o,n];if(this.cursorShape?ta.updateRectanglesShape(this.cursorShape,s):(this.cursorShape=ta.drawRectangles(s,r,1),this.cursorShape.usages++),this.cursorShape.style.color!==r){var a=w.float32ColorToARGB(r)[0],l=$s.get_material_for_color(r,a/255||1);if(l.colorPos){this.cursorShape.style=new or;var u=new Ze;l.material.animateUVs=!0,this.cursorShape.style.color=r,this.cursorShape.style.addSamplerAt(u,l.material.getTextureAt(0)),this.cursorShape.style.uvMatrix=new T(0,0,0,0,l.colorPos.x,l.colorPos.y)}}this.scrollToCursor(t,e)}},e.prototype.drawSelectedBG=function(){this._shapesDirty=!0,this._textShapesDirty=!0,this._selectionBeginIndex<0&&(this._selectionBeginIndex=0),this._selectionBeginIndex>this.char_positions_x.length&&(this._selectionBeginIndex=this.char_positions_x.length);var t=this._selectionBeginIndex,e=this._selectionEndIndex;this._selectionEndIndex<this._selectionBeginIndex&&(t=this._selectionEndIndex,e=this._selectionBeginIndex);var i=0,n=0,r=-1,o=null,s=-1,a=0,l=0,u=[];if(0!=this.char_positions_x.length&&this._selectionEndIndex!=this._selectionBeginIndex)for(var c=e>this.char_positions_x.length?this.char_positions_x.length:e,h=t;h<c;h++)h==this.char_positions_x.length?(i=this.char_positions_x[h-1]+this.chars_width[h-1],n=this.char_positions_y[h-1],o=this.tf_per_char[h-1]):(i=this.char_positions_x[h],n=this.char_positions_y[h],o=this.tf_per_char[h]),s<0&&(s=i),r>=0&&r!=n&&(u.push(s,r,a,l),a=0,s=i),a+=this.chars_width[h],r=n,o.font_table.initFontSize(o.size),l=Math.max(l,o.font_table.getLineHeight());if(a>0)return u.push(s,r,a,l),void(this.bgShapeSelect?ta.updateRectanglesShape(this.bgShapeSelect,u):(this.bgShapeSelect=ta.drawRectangles(u,0,1),this.bgShapeSelect.usages++));this.scrollToCursor(s+a,r+l)},e.prototype.drawBG=function(){this._graphics.beginFill(this.backgroundColor,this._background?1:0),this._graphics.drawRect(this.textOffsetX,this.textOffsetY,this.width,this.height),this._graphics.endFill()},e.prototype.drawBorder=function(){var t=this.border?.25*this.internalScale.x:0,e=this.border?.25*this.internalScale.y:0;this._graphics.beginFill(this._borderColor,1),this._graphics.drawRect(this.textOffsetX,this.textOffsetY,this._width,2*e),this._graphics.drawRect(this.textOffsetX,this.textOffsetY+this._height-2*e,this._width,2*e),this._graphics.drawRect(this.textOffsetX,this.textOffsetY+2*e,2*t,this._height-2*e),this._graphics.drawRect(this.textOffsetX+this._width-2*t,this.textOffsetY+2*e,2*t,this._height-2*e),this._graphics.endFill()},e.prototype.getTextShapeForIdentifierAndFormat=function(t,e){return this.textShapes.hasOwnProperty(t)||(this.textShapes[t]=new Rc,this.textShapes[t].format=e),this.textShapes[t]},Object.defineProperty(e.prototype,"autoSize",{get:function(){return this._autoSize},set:function(t){if(this._autoSize!=t){if("string"==typeof t){if(t!=mc.CENTER&&t!=mc.NONE&&t!=mc.LEFT&&t!=mc.RIGHT)return}else"boolean"==typeof t&&(t=t?mc.LEFT:mc.NONE),"number"==typeof t&&(t=t>0?mc.LEFT:mc.NONE);this._autoSize=t,this._positionsDirty=!0,this._autoSize!=mc.NONE&&this.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"internalScale",{get:function(){return this._internalScale},enumerable:!0,configurable:!0}),e.prototype._iInternalUpdate=function(){t.prototype._iInternalUpdate.call(this),this.reConstruct(!0)},e.prototype._onGraphicsInvalidate=function(t){var e=this.isEntity();this._isEntity!=e&&(!e&&this._implicitPartition&&this._implicitPartition.clearEntity(this),this._isEntity=e),this.invalidate()},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._background},set:function(t){this._background!=t&&(this._background=t,this._shapesDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._shapesDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"border",{get:function(){return this._border},set:function(t){t!=this._border&&(this._border=t,this._shapesDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderColor",{get:function(){return this._borderColor},set:function(t){t!=this.borderColor&&(this._borderColor=t,this._shapesDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomScrollV",{get:function(){return this._bottomScrollV},set:function(t){t!=this._bottomScrollV&&(this._bottomScrollV=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"caretIndex",{get:function(){return this._caretIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._autoSize!=mc.NONE&&this.reConstruct(),this._height},set:function(t){this._height!=t&&this._autoSize==mc.NONE&&(this._height=t,this._positionsDirty=!0,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"htmlText",{get:function(){return this._htmlText},set:function(t){if(t!=this._htmlText){this._htmlText=t;var e=rh.get().processHTML(this,t);this._labelData=null,this._text=e,this._iText=e,this._iTextWoLineBreaks=e.replace(/(\r\n|\n|\\n|\r)/gm,""),this._textDirty=!0,this._autoSize!=mc.NONE?this.invalidate():this._implicitPartition&&this._implicitPartition.invalidateEntity(this),this.newTextFormat=this._textFormats[this._textFormats.length-1]}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._iText.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollH",{get:function(){return this.reConstruct(),this._maxScrollH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollV",{get:function(){return this.reConstruct(),this._maxScrollV},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numLines",{get:function(){return this.reConstruct(),this._numLines},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restrict",{get:function(){return this._restrict},set:function(t){t!=this._restrict&&(this._restrict=t,this._restrictRegex=null,void 0!==t&&((t=t.toString()).length>=2&&"-"==t[0]&&!isNaN(parseInt(t[1]))&&(t="0"+t),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\\/g,"")).replace(/\^/g,"")).replace(/([^a-zA-Z0-9])\-/g,"$1\\-")).replace(/\./g,"\\.")).replace(/\</g,"\\<")).replace(/\>/g,"\\>")).replace(/\+/g,"\\+")).replace(/\*/g,"\\*")).replace(/\?/g,"\\?")).replace(/\[/g,"\\[")).replace(/\]/g,"\\]")).replace(/\$/g,"\\$")).replace(/\(/g,"\\(")).replace(/\)/g,"\\)")).replace(/\{/g,"\\{")).replace(/\}/g,"\\}")).replace(/\=/g,"\\=")).replace(/\!/g,"\\!")).replace(/\:/g,"\\:")).replace(/\|/g,"\\|")).replace(/\//g,"\\/")).replace(/\%/g,"\\%"),this._restrictRegex=new RegExp("[^"+t+"]","g")))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollH",{get:function(){return this._scrollH},set:function(t){t!=this._scrollH&&(this._scrollH=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollV",{get:function(){return this._scrollV},set:function(t){Math.floor(t)!=this._scrollV&&(this._scrollV=Math.floor(t),this._scrollV>this._maxScrollV&&(this._scrollV=this._maxScrollV),this.textChild&&(this.textChild.y=-this.lines_start_y[this._scrollV]))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectable",{get:function(){return this._selectable},set:function(t){this.selectable!=t&&(this._selectable=t,this.mouseEnabled=t,this.cursorType=t?"text":"",t?(this.addEventListener(tl.DRAG_START,this.startSelectionByMouseDelegate),this.addEventListener(tl.DRAG_STOP,this.stopSelectionByMouseDelegate),this.addEventListener(tl.DRAG_MOVE,this.updateSelectionByMouseDelegate)):(this.removeEventListener(tl.DRAG_START,this.startSelectionByMouseDelegate),this.removeEventListener(tl.DRAG_STOP,this.stopSelectionByMouseDelegate),this.removeEventListener(tl.DRAG_MOVE,this.updateSelectionByMouseDelegate)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionBeginIndex",{get:function(){return this._selectionBeginIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEndIndex",{get:function(){return this._selectionEndIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){if(t=(t=void 0===t?"":t.toString()).replace(String.fromCharCode(160)," "),this._text!=t){this._labelData=null,this._text=t,""==t||13!=t.charCodeAt(t.length-1)&&10!=t.charCodeAt(t.length-1)||(t=t.slice(0,t.length-1)),""!=t&&t.length>=3&&"n"==t[t.length-1]&&"\\"==t[t.length-2]&&"\\"==t[t.length-3]&&(t=t.slice(0,t.length-3)),""!=t&&t.length>=3&&"n"==t[t.length-1]&&"\\"==t[t.length-2]&&(t=t.slice(0,t.length-2));for(var e=0,i=oh;e<i.length;e++){var n=i[e];t=t.replace(n.test,n.replace)}this._iText=t,this._iTextWoLineBreaks=t.replace(/(\r\n|\n|\\n|\r)/gm,""),this._textFormats=[this.newTextFormat],this._textFormatsIdx=[this._iText.length],this._textDirty=!0,this._autoSize!=mc.NONE?this.invalidate():this._implicitPartition&&this._implicitPartition.invalidateEntity(this)}},enumerable:!0,configurable:!0}),e.prototype.setLabelData=function(t){this._labelData=t,this.isStatic=!0,this._iText="",this._iTextWoLineBreaks="",this._textDirty=!1,this._positionsDirty=!1,this._glyphsDirty=!0,this._autoSize!=mc.NONE?this.invalidate():this._implicitPartition&&this._implicitPartition.invalidateEntity(this)},Object.defineProperty(e.prototype,"newTextFormat",{get:function(){return this._newTextFormat?this._newTextFormat:this._textFormat?this._textFormat:new Pc},set:function(t){this._newTextFormat=t?t.applyToFormat(this._textFormat.clone()):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textFormat",{get:function(){return null==this._textFormat&&(this._textFormat=new Pc),this._textFormat},set:function(t){if(!t)throw new Error("TextField::: set textFormat - no value!");this._textFormat!=t&&(this._textDirty=!0,this._textFormat=t,this._textShapesDirty=!0,this._textDirty=!0,this._autoSize!=mc.NONE?this.invalidate():this._implicitPartition&&this._implicitPartition.invalidateEntity(this))},enumerable:!0,configurable:!0}),e.prototype._acceptTraverser=function(t){this.maskMode||this._graphics._acceptTraverser(t)},Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._transform.scale.x},set:function(t){this._transform.scale.x!=t&&this._setScaleX(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._transform.scale.y},set:function(t){this._transform.scale.y!=t&&this._setScaleY(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textColor",{get:function(){return this._textColor},set:function(t){if(this._textColor!=t){if(this._textColor=t,this._textFormats){for(var e=this._textFormats.length;e>0;)e--,this._textFormats[e]&&(this._textFormats[e].color=t);this._textDirty=!0}this._glyphsDirty=!0,this._implicitPartition&&this._implicitPartition.invalidateEntity(this)}},enumerable:!0,configurable:!0}),e.prototype.getTextColorForTextFormat=function(t){return t.hasPropertySet("color")?t.color:this._textColor},Object.defineProperty(e.prototype,"textInteractionMode",{get:function(){return this._textInteractionMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.reConstruct(),this._textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.reConstruct(),this.type==gc.INPUT&&""==this._iText?(this.textFormat.font_table.initFontSize(this.textFormat.size),this.textFormat.font_table.getLineHeight()):this._textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type!=t&&(this._type=t,this._textDirty=!0,this._implicitPartition&&this._implicitPartition.invalidateEntity(this),t==gc.INPUT?(this.enableInput(!0),this.addEventListener(Mc.KEYDOWN,this.onKeyDelegate)):(this.enableInput(!1),this.removeEventListener(Mc.KEYDOWN,this.onKeyDelegate)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._autoSize==mc.NONE||this._wordWrap||this.reConstruct(),this._transform.position.x},set:function(t){this._autoSize==mc.NONE||this._wordWrap||this.reConstruct(),this._transform.position.x!=t&&(this._transform.matrix3D._rawData[12]=t,this._transform.invalidatePosition())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._autoSize==mc.NONE||this._wordWrap||this.reConstruct(),this._width},set:function(t){this._width!=t&&(this._width=t,this._positionsDirty=!0,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!=t&&(this._wordWrap=t,this._positionsDirty=!0,t||this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.advanceFrame=function(){},e.prototype.isEntity=function(){return!0},e.prototype.clear=function(){t.prototype.clear.call(this)},e.prototype.dispose=function(){this.disposeValues(),e._textFields.push(this)},e.prototype.disposeValues=function(){t.prototype.disposeValues.call(this),this.maskChild&&(this.maskChild.dispose(),this.maskChild=null),this.textChild&&(this.textChild.dispose(),this.textChild=null),this.cursorShape&&(this.cursorShape.dispose(),this.cursorShape=null),this.bgShapeSelect&&(this.bgShapeSelect.dispose(),this.bgShapeSelect=null),this._labelData&&(this._labelData=null),this._clearTextShapes(),this._textFormat=null},e.prototype.reConstruct=function(t){void 0===t&&(t=!1),(this._textDirty||this._positionsDirty||this._glyphsDirty||this._shapesDirty)&&(this._textDirty&&(this._positionsDirty=!0,this.cleanLastWord=!1,this.chars_codes_prev=Array.from(this.chars_codes),this.tf_per_char_prev=Array.from(this.tf_per_char),this._words_amount_prev=this.words.length,this.chars_codes.length=0,this.chars_width.length=0,this.char_positions_x.length=0,this.char_positions_y.length=0,this.tf_per_char.length=0,this.words.length=0,this._textRuns_words.length=0,this._textRuns_formats.length=0,this._paragraph_textRuns_indices.length=0,this.lines_wordStartIndices.length=0,this.lines_wordEndIndices.length=0,this.lines_start_y.length=0,this.lines_start_x.length=0,this.lines_charIdx_start.length=0,this.lines_charIdx_end.length=0,this.lines_width.length=0,this.lines_height.length=0,this.lines_numSpacesPerline.length=0,this._maxScrollH=0,this._maxScrollV=0,this._maxWidthLine=0,!this._textFormat&&this._textFormats.length>0&&(this._textFormat=this._textFormats[0]),""!=this._iText&&null!=this._textFormat&&this.buildParagraphs()),this._positionsDirty&&(this._glyphsDirty=!0,""!=this._iText&&null!=this._textFormat?this.getWordPositions():(this._textWidth=0,this._textHeight=0,this._autoSize!=mc.NONE&&(this.wordWrap||this.adjustPositionForAutoSize(0),this._height=4,this._type==gc.INPUT&&(this.newTextFormat.font_table.initFontSize(this.newTextFormat.size),this._height=this.newTextFormat.font_table.getLineHeight()+4)),this._type==gc.INPUT&&this.drawSelectionGraphics()),this.updateMaskMode()),this._textDirty=!1,this._positionsDirty=!1,t&&(this._textShapesDirty||0==this.chars_codes_prev.length||(this.chars_codes_prev.length>this.chars_codes.length||this.chars_codes_prev[0]!==this.chars_codes[0])&&(this._textShapesDirty=!0),this._glyphsDirty&&(this._labelData?this.buildGlyphsForLabelData():this.buildGlyphs()),this._glyphsDirty=!1,this._labelData||(this.buildShapes(),this._shapesDirty=!1)))},e.prototype.reset=function(){t.prototype.reset.call(this),this.sourceTextField&&this.sourceTextField.copyTo(this)},e.prototype.buildParagraphs=function(){var t=this._iText.toString(),e=this._textFormatsIdx.length,i=0,n=0;this._paragraph_textRuns_indices[this._paragraph_textRuns_indices.length]=this._textRuns_formats.length;for(var r=0;r<e;r++){var o=0,s=0,a=!0,l=this._textFormats[r],u=this._width-(l.indent+l.leftMargin+l.rightMargin);l.font_table.initFontSize(l.size);var c=r===e-1?t.length:this._textFormatsIdx[r];if(c>n){this._textRuns_formats[this._textRuns_formats.length]=l,this._textRuns_words[this._textRuns_words.length]=this.words.length;for(var h=n;h<c;h++){if(13!==(_=t.charCodeAt(h))){var p=t.charCodeAt(h+1);if(92!==_||114!==p)if(92===_&&110===p&&(h+=1,_=10,p=t.charCodeAt(h+1)),10===_)this._textRuns_words[this._textRuns_words.length]=o,this._textRuns_words[this._textRuns_words.length]=i,this._textRuns_words[this._textRuns_words.length]=s,this._paragraph_textRuns_indices[this._paragraph_textRuns_indices.length]=this._textRuns_formats.length,this._textRuns_formats[this._textRuns_formats.length]=l,this._textRuns_words[this._textRuns_words.length]=this.words.length,a=!0,s=0,o=0,this._maxWidthLine<i&&(this._maxWidthLine=i),i=0;else{this.chars_codes[this.chars_codes.length]=_,this.tf_per_char[this.tf_per_char.length]=l;var d=l.font_table.getCharWidth(_.toString()),f=9==_||32==_;!f&&h<c-1&&9!=p&&32!=p&&(d+=l.letterSpacing),i+=d,this.chars_width[this.chars_width.length]=d,f?(s++,this.words[this.words.length]=this.chars_codes.length-1,this.words[this.words.length]=0,this.words[this.words.length]=0,this.words[this.words.length]=d,this.words[this.words.length]=1,o++,a=!0):(this._autoSize==mc.NONE&&this._wordWrap&&this.words[this.words.length-2]+d>=u&&(a=!0),a?(this.words[this.words.length]=this.chars_codes.length-1,this.words[this.words.length]=0,this.words[this.words.length]=0,this.words[this.words.length]=d,this.words[this.words.length]=1,o++):(this.words[this.words.length-2]+=d,this.words[this.words.length-1]++),a=!1)}else h+=1}}this._textRuns_words[this._textRuns_words.length]=o,this._textRuns_words[this._textRuns_words.length]=i,this._textRuns_words[this._textRuns_words.length]=s,this._maxWidthLine<i&&(this._maxWidthLine=i)}n=c}if(0!=this.chars_codes_prev.length)if(this.chars_codes_prev[0]===this.chars_codes[0]){for(h=this.chars_codes.length-1;h>=0;h--){var _=this.chars_codes[h];l=this.tf_per_char_prev[h];if(this.chars_codes_prev[h]&&(this.chars_codes_prev[h]!=_||this.tf_per_char_prev[h]._style_name!=l._style_name)){this._textShapesDirty=!0;break}}this._wordWrap&&(this.cleanLastWord=!0,this._words_amount_prev-=5)}else this._textShapesDirty=!0},e.prototype.adjustPositionForAutoSize=function(t){var e=this._width;this._width=4+t,this._autoSize==mc.RIGHT?(this._transform.matrix3D._rawData[12]-=this._width-e,this._transform.invalidatePosition()):this._autoSize==mc.CENTER&&(this._transform.matrix3D._rawData[12]-=(this._width-e)/2,this._transform.invalidatePosition())},e.prototype.getWordPositions=function(){var t,e=0,i=this._textRuns_formats.length,n=0,r=0,o=0,s=0,a=0;this._numLines=0;var l=0,u=0,c=0,h=this.textOffsetY+2;if(this._autoSize!=mc.NONE&&!this._wordWrap&&this._textDirty){var p=this._maxWidthLine+this._textFormat.indent+this._textFormat.leftMargin+this._textFormat.rightMargin;this.adjustPositionForAutoSize(p)}var d=this._width-(this._textFormat.indent+this._textFormat.leftMargin+this._textFormat.rightMargin),f=0,_=this._paragraph_textRuns_indices.length;l=0,this.lines_wordStartIndices.length=0,this.lines_wordEndIndices.length=0,this.lines_start_y.length=0,this.lines_start_x.length=0,this.lines_width.length=0,this.lines_height.length=0,this.lines_numSpacesPerline.length=0,this.lines_charIdx_start.length=0,this.lines_charIdx_end.length=0;var m=[],g=[];for(f=0;f<_;f++){for(i=f==_-1?this._textRuns_formats.length:this._paragraph_textRuns_indices[f+1],o=0,m[m.length]=0,e=this._paragraph_textRuns_indices[f];e<i;e++)(t=this._textRuns_formats[e]).font_table.initFontSize(t.size),m[m.length-1]<t.font_table.getLineHeight()+t.leading&&(m[m.length-1]=t.font_table.getLineHeight()+t.leading),r=this._textRuns_words[4*e]+5*this._textRuns_words[4*e+1],o+=this._textRuns_words[4*e+2];this.lines_wordStartIndices[this.lines_wordStartIndices.length]=this._textRuns_words[4*this._paragraph_textRuns_indices[f]],this.lines_wordEndIndices[this.lines_wordEndIndices.length]=r,this.lines_width[this.lines_width.length]=0,this.lines_numSpacesPerline[this.lines_numSpacesPerline.length]=0;var y=0;for(this.lines_height[this.lines_height.length]=m[y],g[l]=t,e=this._paragraph_textRuns_indices[f];e<i;e++)if((t=this._textRuns_formats[e]).font_table.initFontSize(t.size),a=t.indent,r=this._textRuns_words[4*e]+5*this._textRuns_words[4*e+1],o<=d||!this.wordWrap)for(n=this._textRuns_words[4*e];n<r;n+=5)u+=c=this.words[n+3],this.lines_wordEndIndices[l]=n+5,this.lines_width[l]+=c,g[l]=t,32!=this.chars_codes[this.words[n]]&&9!=this.chars_codes[this.words[n]]||(this.lines_numSpacesPerline[l]+=1);else for(c=0,a=0,n=this._textRuns_words[4*e];n<r;n+=5){c=this.words[n+3];var A=!1;32!=this.chars_codes[this.words[n]]&&9!=this.chars_codes[this.words[n]]||(this.lines_numSpacesPerline[l]+=1,A=!0),A||this.lines_width[l]+c<=d-a-1*t.font_table.getCharWidth("32")||0==this.lines_width[l]?(this.lines_wordEndIndices[l]=n+5,this.lines_width[l]+=c,g[l]=t):(l++,this.lines_wordStartIndices[l]=n,this.lines_wordEndIndices[l]=n+5,this.lines_width[l]=c,this.lines_numSpacesPerline[l]=0,this.lines_height[this.lines_height.length]=m[y],g[l]=t,a=t.indent)}y++,l++}var v,b,x,C,w,I=this.textOffsetX,E=0,S=this.lines_wordStartIndices.length,D=0;for(this._biggestLine=0,this._numLines=S,w=0;w<S;w++){u=this.lines_width[w],b=this.lines_height[w],v=this.lines_wordStartIndices[w],x=this.lines_wordEndIndices[w],this.lines_numSpacesPerline[w],t=g[w],C=d-u,I=this.textOffsetX+t.leftMargin+t.indent,t.align==Ac.JUSTIFY?0!=w&&(I-=t.indent):t.align==Ac.CENTER?I+=C>0?C/2:2:t.align==Ac.RIGHT?I+=C>0?C-2:2:t.align==Ac.LEFT&&(I+=2);var T=0,P=I;this.lines_start_x[w]=I,this.lines_start_y[w]=h,this.lines_charIdx_start[w]=D;var B=0;for(n=v;n<x;n+=5){this.words[n+1]=I,P=0,T=(v=this.words[n])+this.words[n+4];var M=this.tf_per_char[v];M.font_table.initFontSize(M.size);var O=b-(M.font_table.getLineHeight()+M.leading);for(O=O>0?O-2:0,this.words[n+2]=h+O,E=v;E<T;E++)this.char_positions_x[this.char_positions_x.length]=I+P,this.char_positions_y[this.char_positions_y.length]=h+O,P+=this.chars_width[E],D++;I+=P,B+=P}this.lines_charIdx_end[w]=D,h+=b,B>s&&(this._biggestLine=w,s=B)}if(this._textWidth=s,this._textHeight=h,this.autoSize!=mc.NONE&&(this._height=this._textHeight+4),this._textWidth>this._width){v=this.lines_charIdx_start[this._biggestLine],E=this.lines_charIdx_end[this._biggestLine];for(var L=0;E>v;)if(E--,(L+=this.chars_width[E])>this._width){this._maxScrollH=E;break}}if(this._textHeight>this._height){var R=this.lines_height.length;for(L=4;R>0;)if(R--,(L+=this.lines_height[R])>this._height){this._maxScrollV=R+1;break}}this.updateMaskMode()},e.prototype.buildGlyphsForLabelData=function(){this._clearTextShapes();for(var t,e,i=[],n=[],r=[],o=[],s=this.staticMatrix.tx/20,a=this.staticMatrix.ty/20,l=0,u=0;u<this._labelData.records.length;u++){i[u]=new Pc,n[u]=[],r[u]=[],(t=this._labelData.records[u]).font_table?i[u].font_table=t.font_table:u>0?i[u].font_table=i[u-1].font_table:console.log("error - no font for label"),t.fontHeight?i[u].size=t.fontHeight/20:u>0&&(i[u].size=i[u-1].size),t.color?i[u].color=w.f32_RGBA_To_f32_ARGB(t.color):u>0&&(i[u].color=i[u-1].color),null!=t.moveY&&(l=a+=t.moveY/20-l),null!=t.moveX&&(s=this.staticMatrix.tx/20+t.moveX/20),o.push(s),o.push(a);for(var c=0;c<t.entries.length;c++)n[u][c]=t.entries[c].glyphIndex,r[u][c]=t.entries[c].advance/20,s+=r[u][c]}var h,p=0,d=i.length,f=0,_=0;for(p=0;p<d;p++)i[p].font_table.initFontSize(i[p].size),_+=(h=i[p].font_table.buildTextLineFromIndices(this,i[p],o[2*p],o[2*p+1],n[p],r[p])).y,f=h.x>f?h.x:f;for(var m in this._textWidth=f,this._textHeight=_,this.targetGraphics=this._graphics,this.targetGraphics.clear(),this.drawBG(),(this.border||!this._background&&this._type!=gc.INPUT)&&this.drawBorder(),this.textShapes){e=this.textShapes[m];var g=new On(Float32Array,2);g.set(e.verts);var y=g.attributesBuffer.cloneBufferView();g.dispose(),e.elements=new Us(y),e.elements.setPositions(new Nn(y)),e.shape=this.targetGraphics.addShape(qs.getShape(e.elements)),e.shape.usages++;var A=new Ze;if(e.shape.style=new or,e.format.material&&0==this._textColor)e.shape.material=this._textFormat.material,e.shape.style.addSamplerAt(A,e.shape.material.getTextureAt(0)),e.shape.material.animateUVs=!0,e.shape.style.uvMatrix=new T(0,0,0,0,e.format.uv_values[0],e.format.uv_values[1]);else{var v=this.getTextColorForTextFormat(e.format),b=w.float32ColorToARGB(v)[0];0==b&&(b=255);var x=$s.get_material_for_color(v,b/255);e.shape.material=x.material,x.colorPos&&(e.shape.style.addSamplerAt(A,e.shape.material.getTextureAt(0)),e.shape.material.animateUVs=!0,e.shape.style.uvMatrix=new T(0,0,0,0,x.colorPos.x,x.colorPos.y))}}},e.prototype.buildGlyphs=function(){var t,e=this._textRuns_formats,i=this._textRuns_words,n=e.length;this._textShapesDirty&&this._clearTextShapes();for(var r=0;r<n;r++)0!=i[4*r+1]&&(i[4*r]+5*i[4*r+1]<=this._words_amount_prev||(e[r].font_table.initFontSize(e[r].size),e[r].font_table.fillTextRun(this,e[r],i[4*r],i[4*r+1],r==n-1&&this.cleanLastWord)));for(var o in this.textShapes){t=this.textShapes[o];var s=this.getTextColorForTextFormat(t.format),a=w.float32ColorToARGB(s)[0];0==a&&(a=255);var l=t.fntMaterial?4:2,u=new On(Float32Array,l);u.set(t.verts);var c=u.attributesBuffer.cloneBufferView();u.dispose(),t.elements=new Us(c),t.elements.setPositions(new Nn(c)),t.fntMaterial&&t.elements.setUVs(new Nn(c)),t.shape=qs.getShape(t.elements),t.shape.usages++;var h=new Ze(!1,!0,!0);if(t.shape.style=new or,t.fntMaterial)t.shape.material=t.fntMaterial,t.shape.style.addSamplerAt(h,t.shape.material.getTextureAt(0));else if(t.format.material&&0==this._textColor)t.shape.material=this._textFormat.material,t.shape.style.addSamplerAt(h,t.shape.material.getTextureAt(0)),t.shape.material.animateUVs=!0,t.shape.style.uvMatrix=new T(0,0,0,0,t.format.uv_values[0],t.format.uv_values[1]);else{var p=$s.get_material_for_color(s,a/255);t.shape.material=p.material,p.colorPos&&(t.shape.style.addSamplerAt(h,t.shape.material.getTextureAt(0)),t.shape.material.animateUVs=!0,t.shape.style.uvMatrix=new T(0,0,0,0,p.colorPos.x,p.colorPos.y))}}},e.prototype.buildShapes=function(){var t;for(var e in this.targetGraphics?this._graphics.clear():this.targetGraphics=this._graphics,this.targetGraphics.clear(),this.drawBG(),!this._border&&this._background||this.drawBorder(),this.drawSelectionGraphics(),this.bgShapeSelect&&this.isInFocus&&this.showSelection&&this.targetGraphics.addShape(this.bgShapeSelect),this.textShapes)t=this.textShapes[e],this.targetGraphics.addShape(t.shape);this.type===gc.INPUT&&this.isInFocus&&this.cursorShape&&!this.cursorBlinking&&this.targetGraphics.addShape(this.cursorShape)},e.prototype.appendText=function(t){t.length&&(this._iText+=t,this._textDirty=!0,this._autoSize!=mc.NONE?this.invalidate():this._implicitPartition&&this._implicitPartition.invalidateEntity(this))},e.prototype.closeParagraph=function(){this._iText+="\n",this._textDirty=!0,this._autoSize!=mc.NONE?this.invalidate():this._implicitPartition&&this._implicitPartition.invalidateEntity(this)},e.prototype.getCharBoundaries=function(t){return console.log("Textfield.getCharBoundaries() not implemented"),this._charBoundaries},e.prototype.getCharIndexAtPoint=function(t,e,i){void 0===i&&(i=-1),i<0&&(i=this.getLineIndexAtPoint(t,e));for(var n=this.lines_charIdx_start[i],r=this.lines_charIdx_end[i],o=n;o<r;o++)if(t>=this.char_positions_x[o]){if(t<=this.char_positions_x[o]+this.chars_width[o]/2)return o;if(t<=this.char_positions_x[o]+this.chars_width[o])return o+1}return-1},e.prototype.getFirstCharInParagraph=function(t){return console.log("Textfield.getFirstCharInParagraph() not implemented"),this._firstCharInParagraph},e.prototype.getImageReference=function(t){return console.log("TextField.getImageReference() not implemented"),this._imageReference},e.prototype.getLineIndexAtPoint=function(t,e){for(var i=this.lines_start_y.length,n=0;n<i-1;n++)if(e>=this.lines_start_y[n]&&e<=this.lines_start_y[n+1])return n;return e>=this.lines_start_y[i-1]?i-1:0},e.prototype.getLineIndexOfChar=function(t){this.buildParagraphs();for(var e=this.lines_charIdx_start.length-1,i=void 0;i<e;i++)if(t>=this.lines_charIdx_start[i]&&t<=this.lines_charIdx_end[i+1])return i;return e},e.prototype.getLineLength=function(t){return 0==this.lines_width.length?0:t>=this.lines_width.length?this.lines_width[this.lines_width.length-1]:this.lines_width[t]},e.prototype.getLineMetrics=function(t){var e=new Bc;return this.lines_width.length?(t>=this.lines_width.length&&(t=this.lines_width.length-1),e.x=this.lines_start_x[t],e.width=this.lines_width[t],e.height=this.lines_height[t],e):e},e.prototype.getLineOffset=function(t){return 0==this.lines_charIdx_start.length?0:t>=this.lines_charIdx_start.length?this.lines_charIdx_start[this.lines_charIdx_start.length-1]:this.lines_charIdx_start[t]},e.prototype.getLineText=function(t){return 0==this.lines_charIdx_start.length?"":(t>=this.lines_width.length&&(t=this.lines_width.length-1),this._iText.slice(this.lines_charIdx_start[t],this.lines_charIdx_end[t]))},e.prototype.getParagraphLength=function(t){return this._paragraphLength},e.prototype.getTextFormat=function(t,e){if(void 0===t&&(t=-1),void 0===e&&(e=-1),!this.tf_per_char||!this.tf_per_char.length)return this._textFormat?this._textFormat.clone():new Pc;t<0&&(t=0),e>this.tf_per_char.length&&(e=this.tf_per_char.length);for(var i=this.tf_per_char[t].clone(),n=this.tf_per_char[t],r=t+1;r<e;r++)this.tf_per_char[r]!=n&&(i.mergeFormat(this.tf_per_char[r]),n=this.tf_per_char[r]);return i},e.prototype.replaceSelectedText=function(t){var e=this._selectionBeginIndex,i=this._selectionEndIndex;if(i!=e){i<e&&(e=this._selectionEndIndex,i=this._selectionBeginIndex);var n=this._iText.slice(0,e-1),r=this._iText.slice(i,this._iText.length);return this.text=n+t+r,this._selectionBeginIndex=e,void(this._selectionEndIndex=this._selectionBeginIndex+t.length)}var o=this._iText.slice(0,e),s=this._iText.slice(i,this._iText.length);this.text=o+t+s,this._selectionBeginIndex=e+1,this._selectionEndIndex=this._selectionBeginIndex},e.prototype.replaceText=function(t,e,i){var n=this._iTextWoLineBreaks.slice(0,t-1),r=this._iTextWoLineBreaks.slice(e,this._iTextWoLineBreaks.length);this.text=n+i+r,this._selectionEndIndex=this._selectionBeginIndex+i.length},e.prototype.setSelection=function(t,e){this._selectionBeginIndex==t&&this._selectionBeginIndex==e||(this._selectionBeginIndex=t,this._selectionEndIndex=e,this._glyphsDirty=!0,this.reConstruct(),this.drawSelectionGraphics())},e.prototype.setTextFormat=function(t,e,i){if(void 0===e&&(e=-1),void 0===i&&(i=-1),t&&0!=this._iTextWoLineBreaks.length){if(-1==e&&-1==i||0==e&&-1==i||(-1==e||0==e)&&i>=this._iTextWoLineBreaks.length){for(var n=this._textFormats.length,r=0;r<n;r++)this._textFormats[r]=this._textFormats[r].clone(),t.applyToFormat(this._textFormats[r]);return this._textDirty=!0,void(this._textShapesDirty=!0)}var o,s=0,a=[],l=[],u=0,c=-1,h=this._textFormats.length,p=this._iTextWoLineBreaks.length;if(-1==e&&(e=0),-1==i&&(i=p),i<e){var d=i;i=e,e=d}i==e&&i++;for(var f=0;f<h;f++)if(f>0&&(u=c),c=this._textFormatsIdx[f],o=this._textFormats[f],u<=e&&c>e){for(u<e&&(a.push(o),l.push(e));c<i;){var _=this._textFormats[f].clone();t.applyToFormat(_),a.push(_),l.push(c),++f<h?(c=this._textFormatsIdx[f],o=this._textFormats[f]):c=i+1}if(c==i){_=o.clone();t.applyToFormat(_),a.push(_),l.push(i)}if(c>i){_=o.clone();t.applyToFormat(_),a.push(_),l.push(i),a.push(o),l.push(c)}}else a.push(this._textFormats[f]),l.push(this._textFormatsIdx[f]);for(this._textFormats.length=0,this._textFormatsIdx.length=0,s=0;s<a.length;s++)this._textFormats[s]=a[s],this._textFormatsIdx[s]=l[s];this._textDirty=!0,this._textShapesDirty=!0}},e.isFontCompatible=function(t,e){return!1},e.prototype.onKey=function(t){var e=t;this.addChar(e.char,e.isShift,e.isCTRL,e.isAlt)},e.prototype.addCharCode=function(t){this.addChar(String.fromCharCode(t))},e.prototype.deleteSelectedText=function(t){if(void 0===t&&(t="Backspace"),0!=this.text.length){if(this._selectionBeginIndex!=this._selectionEndIndex){var e=0!=this._selectionBeginIndex?this._iText.slice(0,this._selectionBeginIndex):"",i=this._selectionEndIndex<this._iText.length?this._iText.slice(this._selectionEndIndex,this._iText.length):"";return this.text=e+i,void(this._selectionEndIndex=this._selectionBeginIndex)}if("Backspace"==t){if(0==this._selectionBeginIndex)return;e=this._iText.slice(0,this._selectionBeginIndex-1),i=this._iText.slice(this._selectionEndIndex,this._iText.length);this.text=e+i,this._selectionBeginIndex-=1,this._selectionEndIndex=this._selectionBeginIndex}else if("Delete"==t){e=this._iText.slice(0,this._selectionBeginIndex),i=this._iText.slice(this._selectionEndIndex+1,this._iText.length);this.text=e+i,this._selectionEndIndex=this._selectionBeginIndex}}},e.prototype.addChar=function(t,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this._iText;if(this._selectionBeginIndex||(this._selectionBeginIndex=0),this._selectionEndIndex||(this._selectionEndIndex=0),this._selectionEndIndex<this._selectionBeginIndex){var s=this._selectionEndIndex;this._selectionEndIndex=this._selectionBeginIndex,this._selectionBeginIndex=s}if("Backspace"==t||"Delete"==t)this.deleteSelectedText(t);else if("ArrowRight"==t)i||this._selectionEndIndex==this._selectionBeginIndex?this._selectionEndIndex>this._selectionBeginIndex?(this._selectionEndIndex+=1,i||(this._selectionBeginIndex=this._selectionEndIndex)):(this._selectionBeginIndex+=1,i||(this._selectionEndIndex=this._selectionBeginIndex)):this._selectionEndIndex>this._selectionBeginIndex?this._selectionBeginIndex=this._selectionEndIndex:this._selectionEndIndex=this._selectionBeginIndex;else if("ArrowLeft"==t)i||this._selectionEndIndex==this._selectionBeginIndex?this._selectionEndIndex>this._selectionBeginIndex?(this._selectionBeginIndex-=1,i||(this._selectionEndIndex=this._selectionBeginIndex)):(this._selectionEndIndex-=1,i||(this._selectionBeginIndex=this._selectionEndIndex)):this._selectionEndIndex>this._selectionBeginIndex?this._selectionEndIndex=this._selectionBeginIndex:this._selectionBeginIndex=this._selectionEndIndex;else if("Enter"==t&&this.multiline)this._insertNewText("\n");else if(1==t.length){if(this._restrictRegex){var a=t.replace(this._restrictRegex,"");if(a.length<t.length){var l=t.toUpperCase().replace(this._restrictRegex,""),u=t.toLowerCase().replace(this._restrictRegex,"");t=l,l.length<u.length&&(t=u),a.length>t.length&&(t=a)}if(""==t)return}if(this.newTextFormat.font_table){var c=this.newTextFormat.font_table,h=t.charCodeAt(0).toString(),p=!1;if(!(p=(p=(p=p||c.hasChar(h))||c.hasChar(h.toLowerCase()))||c.hasChar(h.toUpperCase())))return void console.log("Char not found",h)}this._insertNewText(t)}else t.length>1&&console.log("invalid keyboard input: ",t);if(this._glyphsDirty=!0,this.reConstruct(),this.drawSelectionGraphics(),this.invalidate(),o!==this._iText&&this.dispatchEvent(e._onChangedEvent),t&&t.length>0&&this.adapter!=this){var d=void 0;switch(t){case"Backspace":d=8;break;case"Delete":d=46;break;case"ArrowRight":d=39;break;case"ArrowLeft":d=37;break;case".":d=189;break;default:d=t.charCodeAt(0)}this.adapter.dispatchKeyEvent(d,i,n,r)}},e.prototype._insertNewText=function(t){if(this._selectionBeginIndex!=this._selectionEndIndex){var e=this._iText.slice(0,this._selectionBeginIndex),i=this._iText.slice(this._selectionEndIndex,this._iText.length);if(this.maxChars>0&&e.length+i.length+t.length>this.maxChars){var n=this.maxChars-e.length+i.length;n>0&&(t=t.slice(0,n))}this.text=e+t+i,this._selectionBeginIndex+=1,this._selectionEndIndex=this._selectionBeginIndex}else if(this.maxChars>0&&this._iText.length>=this.maxChars);else{e=this._iText.slice(0,this._selectionBeginIndex),i=this._iText.slice(this._selectionEndIndex,this._iText.length);this.text=e+t+i,this._selectionBeginIndex+=1,this._selectionEndIndex=this._selectionBeginIndex}},e.prototype.clone=function(){var t=e.getNewTextField();return this.copyTo(t),t},e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e),e.autoSize=this.autoSize,e.type=this._type,e.html=this.html,e.width=this._width,e.height=this._height,this._textFormat&&(e.textFormat=this._textFormat.clone()),e.textColor=this._textColor,e.border=this._border,e.borderColor=this._borderColor,e.background=this._background,e.backgroundColor=this._backgroundColor,e.textOffsetX=this.textOffsetX,e.textOffsetY=this.textOffsetY,e.staticMatrix=this.staticMatrix,e.selectable=this._selectable,e.multiline=this.multiline,e.wordWrap=this.wordWrap,e.maxChars=this.maxChars,e.sourceTextField=this,e.html?e.htmlText=this.htmlText:e.text=this.text,this._labelData&&e.setLabelData(this._labelData)},e.prototype._clearTextShapes=function(){var t;for(var e in this._textShapesDirty=!1,this.last_word_vertices_count=0,this.tf_per_char_prev.length=0,this.chars_codes_prev.length=0,this._words_amount_prev=0,this.cleanLastWord=!1,this.targetGraphics&&this.targetGraphics.clear(),this.textShapes)(t=this.textShapes[e]).shape&&t.shape.dispose(),t.shape=null,t.elements=null,t.verts.length=0,delete this.textShapes[e]},e._textFields=[],e.assetType="[asset TextField]",e._onChangedEvent=new Oc(Oc.CHANGED),e}(Fa);re.registerAbstraction(se,sh);(function(t){function e(e){return t.call(this,e)||this}i(e,t)})(o),function(t){function e(e,i,n){void 0===i&&(i=NaN),void 0===n&&(n=NaN);var r=t.call(this,e)||this;return r._oldHeight=i,r._oldWidth=n,r}i(e,t),Object.defineProperty(e.prototype,"oldHeight",{get:function(){return this._oldHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oldWidth",{get:function(){return this._oldWidth},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this._oldHeight,this._oldWidth)},e.RESIZE="resize"}(a);var ah=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createMovieClip=function(t,e){return void 0===t&&(t=null),new il(t)},e.prototype.createSprite=function(t,e,i){return void 0===t&&(t=null),t?t.getNewObject():new ka},e.prototype.createDisplayObjectContainer=function(t){return new Fa},e.prototype.createTextField=function(t){return new sh},e.prototype.createBillboard=function(t,e){return new za(t)},e.prototype.createMaterial=function(t,e,i){return new ac(t,e)},e.prototype.createFrameScripts=function(t,e,i,n){throw"[DefaultSceneGraphFactory] - createFrameScripts should be overwritten by AVM"},e}(rn),lh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._enitityIDsToNodes={},e}return i(e,t),e.prototype.acceptTraverser=function(t){if(this._partition.root==this._entity&&this._partition.updateEntities(),(t.partition==this._partition||t==t.getTraverser(this._partition))&&t.enterNode(this)){var e;for(e=this._entity._children.length-1;e>=0;e--)this._enitityIDsToNodes[this._entity._children[e].id].acceptTraverser(t);this._graphicsNode&&this._graphicsNode.acceptTraverser(t)}},e.prototype.iAddNode=function(t){t.parent=this,this._entity==t.entity?this._graphicsNode=t:this._enitityIDsToNodes[t.entity.id]=t},e.prototype.isVisible=function(){return this._entity._iIsVisible()},e.prototype.iRemoveNode=function(t){this._graphicsNode==t?this._graphicsNode=null:delete this._enitityIDsToNodes[t.entity.id]},e}(ne),uh=function(t){function e(e,i){void 0===i&&(i=!1);var n=t.call(this,e,i)||this;return n._rootNode=new lh(e,n),n}return i(e,t),e.prototype.getPartition=function(t){return new e(t)},e}(re),ch=4,hh=0,ph=new I,dh=[],fh=new D(0,0),_h=new Y,mh=function(t){function e(e,i,n,r,o,s){void 0===n&&(n=!0),void 0===r&&(r=4294967295),void 0===o&&(o=!0),void 0===s&&(s=null);var a=t.call(this,e,i,n,null,o,s)||this;return a._updateRegions=[],a._dirtyRegions=[],a._maxDirtyArea=null,a._fullDirty=!1,a._initalFillColor=null,a._lastUsedFill=null,a._internalSync=!1,a._antialiasQuality=0,a._initalFillColor=r,a._lastUsedFill=r,a}return i(e,t),e.getImage=function(t,i,n,r,o,s,a){void 0===n&&(n=!0),void 0===r&&(r=4294967295),void 0===o&&(o=!0),void 0===s&&(s=null),void 0===a&&(a=!1);for(var l=-1,u=0;u<this._pool.length;u++){var c=this._pool[u];if((!s||c._stage===s)&&c.width===t&&c.height===i&&c.transparent===n&&c.powerOfTwo===o&&a===c._antialiasQuality>0){l=u;break}}if(l>-1){c=this._pool.splice(l,1)[0];return null!==r&&c.fillRect(c.rect,r),c}this._pool.length===this.MAX_POOL_SIZE&&this.MAX_POOL_SIZE<this.MAX_GROW_SIZE&&(this.MAX_POOL_SIZE+=.25*this.MAX_POOL_SIZE|0);var h=new e(t,i,n,r,o,s);return a&&(h._antialiasQuality=ch),h},e.tryStoreImage=function(t,e){return void 0===e&&(e=!1),!!(this._pool.length<=this.MAX_POOL_SIZE||e)&&(this._pool.push(t),!0)},e.getTemp=function(t,e,i,n){void 0===n&&(n=!1);for(var r=Math.max(t,e),o=this.TMP_STEP[0],s=0;s<this.TMP_STEP.length;s++)if(r<=this.TMP_STEP[s]){o=this.TMP_STEP[s];break}return this.getImage(o,o,!0,null,!0,i,n)},Object.defineProperty(e.prototype,"antialiasQuality",{get:function(){return this._antialiasQuality},enumerable:!0,configurable:!0}),e.prototype.syncData=function(t){var e=this;if(void 0===t&&(t=!1),t&&this._asyncRead)return this._asyncRead;if(!t&&this._asyncRead)throw"[SceneImage2D] Synced read not allowed while async read is requested!";if(this.applySymbol(),!this._imageDataDirty)return!!t&&Promise.resolve(!1);var i=this._stage.context;return this._stage.setRenderTarget(this,!1),this._data||(this._data=new Uint8ClampedArray(this.width*this.height*4)),this._internalSync=!0,this._asyncRead=i.drawToBitmapImage2D(this,!1,t),this._internalSync=!1,this._stage.setRenderTarget(null),t?this._asyncRead.then((function(t){return e.resetDirty(),e._unpackPMA=!1,e._asyncRead=null,!0})):(this.resetDirty(),this._unpackPMA=!1,!0)},e.prototype.getDataInternal=function(e,i){if(void 0===e&&(e=!0),void 0===i&&(i=!1),!i&&this._imageDataDirty&&!this._internalSync)return this.syncData(!1),this._data;if(null===this._initalFillColor)return t.prototype.getDataInternal.call(this,e,!0);var n=t.prototype.getDataInternal.call(this,!1,!0);return n||(t.prototype.fillRect.call(this,this.rect,this._initalFillColor),this._initalFillColor=null,this._data)},e.prototype.pushDirtyRegion=function(t){if(this._imageDataDirty=!0,this._fullDirty)this._updateRegions&&this._updateRegions.length&&(this._updateRegions.length=0);else{var e=t.equals(this._rect);if(this._dirtyRegions||(this._dirtyRegions=[]),e?(this._dirtyRegions=[this._rect],this._fullDirty=!0):this._dirtyRegions.push(t),!this._maxDirtyArea||e)this._maxDirtyArea=t.clone();else{var i=t._rawData,n=this._maxDirtyArea,r=n._rawData;r[0]=i[0]<r[0]?i[0]:r[0],r[1]=i[1]<r[1]?i[1]:r[1],n.right=n.right<t.right?n.right:t.right,n.bottom=n.bottom<t.bottom?n.bottom:t.bottom,r[0]<0&&(r[0]=0),r[1]<0&&(r[1]=0),r[2]>this.width&&(r[2]=this.width),r[3]>this.height&&(r[3]=this.height)}if(this._updateRegions)for(var o=this._updateRegions.length-1;o>=0;o--)this._updateRegions[o].intersects(t)&&this._updateRegions.splice(o,1)}},e.prototype.resetDirty=function(){this._dirtyRegions=[],this._updateRegions=[],this._maxDirtyArea=null,this._fullDirty=!1,this._imageDataDirty=!1},Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.createRenderer=function(){var t=new vt;t.coordinateSystem=_t.RIGHT_HANDED,t.originX=-1,t.originY=1,e._root=new Fa,e._renderer=Ir.getInstance(new Un(t,this._stage,null,null,null,!0),_r.DEFAULT).getRenderer(new uh(e._root)),e._root.partition=e._renderer.partition,e._renderer.disableClear=!0,e._renderer.view.backgroundAlpha=0,e._renderer.view.projection=t,e._renderer.view.projection.transform=new N,e._renderer.view.projection.transform.moveTo(0,0,-1e3),e._renderer.view.projection.transform.lookAt(new P),e._renderer.renderableSorter=null},e.prototype.createBillboardRenderer=function(){var t=new vt;t.coordinateSystem=_t.RIGHT_HANDED,t.originX=-1,t.originY=1,e._billboardRoot=new Fa,e._billboardRenderer=Ir.getInstance(new Un(t,this._stage,null,null,null,!0),_r.DEFAULT).getRenderer(new uh(e._billboardRoot)),e._billboardRoot.partition=e._billboardRenderer.partition,e._billboardRenderer.disableClear=!0,e._billboardRenderer.view.backgroundAlpha=0,e._billboardRenderer.view.projection=t,e._billboardRenderer.view.projection.transform=new N,e._billboardRenderer.view.projection.transform.moveTo(0,0,-1e3),e._billboardRenderer.view.projection.transform.lookAt(new P),e._billboardRenderer.renderableSorter=null;var i=new ac(new hn(128,128,!0,0));i.bothSides=!0,i.alphaBlending=!0,e._billboard=new za(i),e._billboard.style=new or,e._billboardRoot.addChild(e._billboard)},e.prototype.dispose=function(){this.dropAllReferences(),this.unmarkToUnload(),this.unuseWeakRef(),this._dirtyRegions=null,this._updateRegions=null,this._maxDirtyArea=null,this._data=null,this._locked=!1,this.wasUpload&&e.tryStoreImage(this,!1)||t.prototype.dispose.call(this)},e.prototype.unload=function(){var e=this,i=this.syncData(!0);"boolean"==typeof i?t.prototype.unload.call(this):i.then((function(){return t.prototype.unload.call(e)}))},e.prototype.deepClone=function(t){this.copyPixels(t,this._rect,new D(0,0))},e.prototype.clone=function(){var t=e.getImage(this.width,this.height,this.transparent,null,!1,this._stage);return this.addNestedReference(t),t},e.prototype.fillRect=function(t,e){this.dropAllReferences();var i=w.float32ColorToARGB(e),n=this._transparent?i[0]/255:1,r=t!==this._rect&&!this._rect.equals(t);this._stage.setRenderTarget(this,!0),r&&this._stage.setScissor(t),this._lastUsedFill=r?null:e,this._stage.clear(i[1]/255*n|0,i[2]/255*n|0,i[3]/255*n|0,n),r&&this._stage.setScissor(null),this.pushDirtyRegion(t)},e.prototype.copyPixels=function(t,i,n,r,o,s){if(this._lastUsedFill=null,this.dropAllReferences(),this.unmarkToUnload(),this._stage.context.setCulling(zt.NONE),this._stage.context.setBlendFactors(Lt.ONE,Lt.ONE_MINUS_SOURCE_ALPHA),s=this.transparent!==t.transparent||s,null!==this._initalFillColor&&(this.fillRect(this._rect,this._initalFillColor),this._initalFillColor=null),t!==this)this._stage.copyPixels(t,this,i,n,r,o,s);else{var a=e.getTemp(t.width,t.height,this._stage);if(a._antialiasQuality>0)throw"Using MSAA texture for copy pixel!";fh.setTo(0,0),_h.setTo(0,0,i.width,i.height),this._stage.copyPixels(t,a,i,fh,r,o,!1),this._stage.copyPixels(a,this,_h,n,r,o,s),e.tryStoreImage(a,!0)}this.pushDirtyRegion(new Y(n.x,n.y,i.width,i.height))},e.prototype.threshold=function(t,i,n,r,o,s,a,l){if(this._lastUsedFill=null,this.dropAllReferences(),this.unmarkToUnload(),this._stage.context.setCulling(zt.NONE),this._stage.context.setBlendFactors(Lt.ONE,Lt.ZERO),t===this){var u=e.getTemp(t.width,t.height,this._stage);fh.setTo(0,0),_h.setTo(0,0,i.width,i.height),this._stage.threshold(t,u,i,fh,r,o,s,a,l),this._stage.copyPixels(u,this,_h,n,null,null,!1),e.tryStoreImage(u,!0)}else this._stage.threshold(t,this,i,n,r,o,s,a,l);this.pushDirtyRegion(new Y(n.x,n.y,i.width,i.height)),this._imageDataDirty=!0},e.prototype.colorTransform=function(t,i){this._lastUsedFill=null,this.dropAllReferences(),this.unmarkToUnload(),this._stage.context.setCulling(zt.NONE),this._stage.context.setBlendFactors(Lt.ONE,Lt.ZERO);var n=e.getTemp(t.x+t.width,t.y+t.height,this._stage);this._stage.colorTransform(this,n,t,i),this._stage.copyPixels(n,this,t,new D(0,0),null,null,!1),this.pushDirtyRegion(new Y(t.x,t.y,t.width,t.height)),this._imageDataDirty=!0,e.tryStoreImage(n,!0)},e.prototype.getPixel32=function(e,i){return this.syncData(),t.prototype.getPixel32.call(this,e,i)},e.prototype.getPixel=function(t,e){return 16777215&this.getPixel32(t,e)},e.prototype.draw=function(t,e,i,n,r,o){this.dropAllReferences(),this.unmarkToUnload(),t instanceof Na?this._drawAsDisplay(t,e,i,n,r,o):this._drawAsBitmap(t,e,i,n,r,o),this._lastUsedFill=null,this.pushDirtyRegion(this._rect),this._imageDataDirty=!0},e.prototype._mapBlendMode=function(t){switch(void 0===t&&(t=""),t){case null:case"":case fn.NORMAL:case fn.LAYER:return fn.LAYER;case fn.MULTIPLY:case fn.ADD:case fn.ALPHA:return t}return fn.LAYER},e.prototype._drawAsBitmap=function(t,i,n,r,o,s){e._billboardRenderer||this.createBillboardRenderer(),null!==this._initalFillColor&&(this.fillRect(this._rect,this._initalFillColor),this._initalFillColor=null);var a=e._billboardRenderer,l=e._billboardRoot,u=e._billboard;if(u.sampler.smooth=s,a.disableClear=!0,a.view.target=this,a.view.projection.scale=1e3/this.rect.height,u.material.style.image=t,u.material.blendMode=this._mapBlendMode(r),u.material.useColorTransform=!!n,i){var c=l.transform.matrix3D;c.identity(),c._rawData[0]=i.a,c._rawData[1]=-i.b,c._rawData[4]=i.c,c._rawData[5]=-i.d,c._rawData[12]=i.tx,c._rawData[13]=this.rect.height-i.ty,l.transform.invalidateComponents()}else l.transform.rotateTo(0,0,0),l.transform.scaleTo(1,-1,1),l.transform.moveTo(0,this.rect.height,0);l.transform.colorTransform=n,a.render()},e.prototype.fastScaledNativeCopy=function(t,e,i){void 0===i&&(i=null);var n=this._stage.context._texContext;this._stage.setScissor(null),this._stage.setRenderTarget(t,!1);var r=e.getAbstraction(this._stage).getTexture();n.unsafeCopyToTexture(r,i||e._rect,fh,!0)},e.prototype._drawAsDisplay=function(t,i,n,r,o,s){e._renderer||this.createRenderer();var a=2===this._stage.context.glVersion&&ch>1,l=!a&&hh>1,u=this,c=1;a||l||null===this._initalFillColor||(this.fillRect(this._rect,this._initalFillColor),this._initalFillColor=null),a?(u=e.getTemp(this.width,this.height,this._stage,!0),null!==this._lastUsedFill?u.fillRect(u._rect,this._lastUsedFill):(fh.setTo(0,0),this._stage.copyPixels(this,u,this._rect,fh,null,null,!0))):l&&(c=hh,u=e.getTemp(this.width*c,this.height*c,this._stage,!1),null!==this._lastUsedFill?u.fillRect(u._rect,this._lastUsedFill):this.fastScaledNativeCopy(this,u,this._rect));var h=e._root,p=e._renderer,d=t.visible,f=t.parent;f&&f.adapter.getChildForDraw(t);for(var _=t.transform,m=0;m<4;m++)dh[0+m]=_.position._rawData[m],dh[4+m]=_.rotation._rawData[m],dh[8+m]=_.scale._rawData[m];ph.copyRawDataFrom(t.transform.colorTransform._rawData);var g=t.transform.matrix3D._rawData[10];if(i){var y=h.transform.matrix3D;y.identity(),y._rawData[0]=i.a,y._rawData[1]=-i.b,y._rawData[4]=i.c,y._rawData[5]=-i.d,y._rawData[10]=g,y._rawData[12]=i.tx,y._rawData[13]=this._rect.height-i.ty,h.transform.invalidateComponents()}else h.transform.rotateTo(0,0,0),h.transform.scaleTo(1,-1,1),h.transform.moveTo(0,this._rect.height,0);if(p.antiAlias=u._antialiasQuality||0,p.view.target=u,p.view.projection.scale=1e3/this._rect.height,l){var A=this._rect.width/this._rect.height;p.view.projection.ratio=A/1,p.view.x=0,p.view.y=0,p.view.width=u.width,p.view.height=u.height}else p.view.projection.ratio=this._rect.width/this._rect.height,p.view.x=-(u.width-this.width),p.view.y=-(u.height-this.height),p.view.width=this.width,p.view.height=this.height;h.removeChildren(0,h.numChildren),h.addChild(t),h.transform.colorTransform=n,t.transform.matrix3D=null,t.visible=!0,t.transform.colorTransform=null,r=r||t.blendMode||"",h.blendMode=this._mapBlendMode(r),p.render(),p.antiAlias=0,t.visible=d,_.moveTo(dh[0],dh[1],dh[2]),_.rotateTo(dh[4],dh[5],dh[6]),_.scaleTo(dh[8],dh[9],dh[10]),t.transform.colorTransform=ph,h.removeChild(t),f&&f.adapter.returnChildAfterDraw(t),a?(this._stage.copyPixels(u,this,this._rect,fh,null,null,!1),u.fillRect(u._rect,0),e.tryStoreImage(u,!0)):l&&(this.fastScaledNativeCopy(u,this,u._rect),u.fillRect(u._rect,0),e.tryStoreImage(u,!0))},e.assetType="[image SceneImage2D]",e.MAX_POOL_SIZE=30,e.MAX_GROW_SIZE=300,e._pool=[],e.TMP_STEP=[128,256,512,1024,2048,4096],e}(hn);Ji.registerAbstraction(pn,mh);var gh=function(){function t(t){var e=this;this._pickerLookup=new Array,this.allowKeyInput=!0,this._collisionIsEnabledButton=!1,this._eventBubbling=!0,this._allowFocusOnUnfocusable=!0,this._nullVector=new P,this._queuedEvents=new Array,this._mouseUp=new tl(tl.MOUSE_UP),this._mouseUpOutside=new tl(tl.MOUSE_UP_OUTSIDE),this._mouseClick=new tl(tl.CLICK),this._mouseOut=new tl(tl.MOUSE_OUT),this._dragOut=new tl(tl.DRAG_OUT),this._dragOver=new tl(tl.DRAG_OVER),this._mouseDown=new tl(tl.MOUSE_DOWN),this._mouseMove=new tl(tl.MOUSE_MOVE),this._mouseOver=new tl(tl.MOUSE_OVER),this._mouseWheel=new tl(tl.MOUSE_WHEEL),this._mouseDoubleClick=new tl(tl.DOUBLE_CLICK),this._rollOver=new tl(tl.ROLL_OVER),this._rollOut=new tl(tl.ROLL_OUT),this._dragMove=new tl(tl.DRAG_MOVE),this._dragStart=new tl(tl.DRAG_START),this._dragStop=new tl(tl.DRAG_STOP),this._useSoftkeyboard=!1,this._isAVM1Dragging=!1,this._isDown=!1,this._stage=t,this.onClickDelegate=function(t){return e.onClick(t)},this.onDoubleClickDelegate=function(t){return e.onDoubleClick(t)},this.onMouseDownDelegate=function(t){return e.onMouseDown(t)},this.onMouseMoveDelegate=function(t){return e.onMouseMove(t)},this.onMouseUpDelegate=function(t){return e.onMouseUp(t)},this.onMouseWheelDelegate=function(t){return e.onMouseWheel(t)},this.onMouseOverDelegate=function(t){return e.onMouseOver(t)},this.onMouseOutDelegate=function(t){return e.onMouseOut(t)},this.onKeyDownDelegate=function(t){return e.onKeyDown(t)},this.onKeyUpDelegate=function(t){return e.onKeyUp(t)},this.buttonEnabledDirty=!1,this._isTouch="ontouchstart"in window||navigator.msMaxTouchPoints>0,this._showCursor=!0,this._mouseDragging=!1;var i=this._stage.container;i.addEventListener("click",this.onClickDelegate),i.addEventListener("dblclick",this.onDoubleClickDelegate),i.addEventListener("touchstart",this.onMouseDownDelegate),i.addEventListener("mousedown",this.onMouseDownDelegate),window.addEventListener("touchmove",this.onMouseMoveDelegate),window.addEventListener("mousemove",this.onMouseMoveDelegate),window.addEventListener("mouseup",this.onMouseUpDelegate),i.addEventListener("touchend",this.onMouseUpDelegate),i.addEventListener("touchend",this.onClickDelegate),i.addEventListener("mousewheel",this.onMouseWheelDelegate),i.addEventListener("mouseover",this.onMouseOverDelegate),i.addEventListener("mouseout",this.onMouseOutDelegate),window.addEventListener("keydown",this.onKeyDownDelegate),window.addEventListener("keyup",this.onKeyUpDelegate)}return t.prototype.startDragObject=function(t){this._isAVM1Dragging=!0,this._mouseDragCollision||(this._mouseDragCollision=t)},t.prototype.stopDragObject=function(){this._isAVM1Dragging=!1},Object.defineProperty(t.prototype,"showCursor",{get:function(){return this._showCursor},set:function(t){this._showCursor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventBubbling",{get:function(){return this._eventBubbling},set:function(t){this._eventBubbling=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useSoftkeyboard",{get:function(){return this._useSoftkeyboard},set:function(t){this._useSoftkeyboard=t,t?t&&(window.removeEventListener("keydown",this.onKeyDownDelegate),window.removeEventListener("keyup",this.onKeyUpDelegate)):(window.addEventListener("keydown",this.onKeyDownDelegate),window.addEventListener("keyup",this.onKeyUpDelegate))},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this._stage.container;t.removeEventListener("click",this.onClickDelegate),t.removeEventListener("dblclick",this.onDoubleClickDelegate),t.removeEventListener("touchstart",this.onMouseDownDelegate),t.removeEventListener("mousedown",this.onMouseDownDelegate),window.removeEventListener("touchmove",this.onMouseMoveDelegate),window.removeEventListener("mousemove",this.onMouseMoveDelegate),window.removeEventListener("mouseup",this.onMouseUpDelegate),t.removeEventListener("touchend",this.onMouseUpDelegate),t.removeEventListener("touchend",this.onClickDelegate),t.removeEventListener("mousewheel",this.onMouseWheelDelegate),t.removeEventListener("mouseover",this.onMouseOverDelegate),t.removeEventListener("mouseout",this.onMouseOutDelegate),window.removeEventListener("keydown",this.onKeyDownDelegate),window.removeEventListener("keyup",this.onKeyUpDelegate),this._stage=null,this.onClickDelegate=null,this.onDoubleClickDelegate=null,this.onMouseDownDelegate=null,this.onMouseMoveDelegate=null,this.onMouseUpDelegate=null,this.onMouseWheelDelegate=null,this.onMouseOverDelegate=null,this.onMouseOutDelegate=null,this.onKeyDownDelegate=null,this.onKeyUpDelegate=null,this._mouseMoveEvent=null,this._mouseUp=null,this._mouseUpOutside=null,this._mouseClick=null,this._mouseOut=null,this._dragOut=null,this._dragOver=null,this._mouseDown=null,this._mouseMove=null,this._mouseOver=null,this._mouseWheel=null,this._mouseDoubleClick=null,this._dragMove=null,this._dragStart=null,this._dragStop=null},t.clearInstance=function(t){this._instancePool[t.id]&&(this._instancePool[t.id].dispose(),delete this._instancePool[t.id])},t.getInstance=function(e){return this._instancePool[e.id]||(this._instancePool[e.id]=new t(e))},t.prototype.setFocus=function(t){this._currentFocusEntity!=t&&(this._currentFocusEntity&&this._currentFocusEntity.setFocus(!1,!1),this._currentFocusEntity=t,this._currentFocusEntity&&this._currentFocusEntity.setFocus(!0,!1))},t.prototype.getFocus=function(){return this._currentFocusEntity},t.prototype.dispatchEvent=function(t,e){if(this._eventBubbling)for(;e;){if(t.commonAncestor&&e==t.commonAncestor)return;e._iIsMouseEnabled()&&(e.dispatchEvent(t),el.execute_queue()),e=t._iAllowedToPropagate?e.parent:null}else e&&(e.dispatchEvent(t),el.execute_queue())},t.prototype.setupAndDispatchEvent=function(t,e,i,n){void 0===n&&(n=null),e&&(t.delta=e.wheelDelta,t.ctrlKey=e.ctrlKey,t.altKey=e.altKey,t.shiftKey=e.shiftKey),t=this.setUpEvent(t,i,n),this.dispatchEvent(t,t.pickerEntity)},t.prototype.fireMouseEvents=function(t){var e,i,n,r,o;if(void 0===t&&(t=null),t)o=t.getViewCollision(this._stage.screenX,this._stage.screenY);else if(this._updateDirty)for(var s=0;s<this._pickerLookup.length;s++)o&&!this._pickerLookup[s].layeredView||(o=this._pickerLookup[s].getViewCollision(this._stage.screenX,this._stage.screenY,!1,o));if(t||this._updateDirty){var a,l,u=this._queuedEvents.length;for(s=0;s<u;++s)if(a=this._queuedEvents[s],l=null===(e=o)||void 0===e?void 0:e.pickerEntity,this.setUpEvent(a,o),a.type==tl.MOUSE_DOWN)this._mouseDragging=!0,this._eventBubbling||this._stage.dispatchEvent(a),this._isTouch&&this.setupAndDispatchEvent(this._mouseOver,this._mouseMoveEvent,o),this._mouseDragCollision=o,l?this.dispatchEvent(a,l):this._eventBubbling&&this._stage.dispatchEvent(a),(this._allowFocusOnUnfocusable||this._mouseDragCollision&&this._mouseDragCollision.pickerEntity.tabEnabled)&&(this._currentFocusEntity&&this._currentFocusEntity.setFocus(!1,!0),this._currentFocusEntity=null===(i=this._mouseDragCollision)||void 0===i?void 0:i.pickerEntity,this._currentFocusEntity&&this._currentFocusEntity.setFocus(!0,!0)),this._mouseDragCollision&&this.setupAndDispatchEvent(this._dragStart,a,this._mouseDragCollision);else if(a.type==tl.MOUSE_UP){this._eventBubbling||this._stage.dispatchEvent(a);var c=null,h=null;this._isAVM1Dragging&&this._mouseDragCollision?(h=this._mouseDragCollision.pickerEntity,c=this._mouseDragCollision.entity):this._mouseDragging&&this._mouseDragCollision&&this._mouseDragCollision.pickerEntity!=l?(this._mouseDragCollision.pickerEntity.buttonEnabled&&this.setupAndDispatchEvent(this._mouseOut,a,this._mouseDragCollision),this._eventBubbling||this.setupAndDispatchEvent(this._mouseUpOutside,a,this._mouseDragCollision)):this._mouseDragging&&this._mouseDragCollision&&this._mouseDragCollision.pickerEntity==l&&(h=this._mouseDragCollision.pickerEntity,c=this._mouseDragCollision.entity),this._mouseDragging&&l&&this.setupAndDispatchEvent(this._mouseOver,a,o),this._isTouch&&c&&this.setupAndDispatchEvent(this._mouseOut,this._mouseMoveEvent,this._mouseDragCollision),h?this.dispatchEvent(a,h):this._eventBubbling&&l?this.dispatchEvent(a,l):this._eventBubbling&&this._stage.dispatchEvent(a),c&&this.setupAndDispatchEvent(this._dragStop,a,this._mouseDragCollision),this._mouseDragCollision=null,this._mouseDragging=!1,this._isAVM1Dragging=!1}else a.type==tl.MOUSE_MOVE?(this._eventBubbling&&a.pickerEntity?this.dispatchEvent(a,a.pickerEntity):this._stage.dispatchEvent(a),this._mouseDragCollision&&this.setupAndDispatchEvent(this._dragMove,a,this._mouseDragCollision)):this.dispatchEvent(a,l);this._queuedEvents.length=0,this._rollOut.commonAncestor=null,this._rollOver.commonAncestor=null;var p=null===(n=o)||void 0===n?void 0:n.pickerEntity,d=null===(r=this._prevCollision)||void 0===r?void 0:r.pickerEntity;if(p!=d){if(d&&(this._isTouch||this._mouseDragging?this._mouseDragging&&this._mouseDragCollision&&this._mouseDragCollision.pickerEntity==d&&this.setupAndDispatchEvent(this._dragOut,this._mouseMoveEvent,this._prevCollision):this.setupAndDispatchEvent(this._mouseOut,this._mouseMoveEvent,this._prevCollision)),!d&&p&&(this.setupAndDispatchEvent(this._rollOut,this._mouseMoveEvent,this._prevCollision),this.setupAndDispatchEvent(this._rollOver,this._mouseMoveEvent,o)),d&&!p&&(this.setupAndDispatchEvent(this._rollOut,this._mouseMoveEvent,this._prevCollision),this.setupAndDispatchEvent(this._rollOver,this._mouseMoveEvent,o)),d&&p){for(var f=[],_=d;_&&!_.isAVMScene;)f.push(_),_=_.parent;var m=null;for(_=p;_&&!_.isAVMScene;){-1==f.indexOf(_)?_=_.parent:(m=_,_=null)}m!=d&&this.setupAndDispatchEvent(this._rollOut,this._mouseMoveEvent,this._prevCollision,m),m!=p&&this.setupAndDispatchEvent(this._rollOver,this._mouseMoveEvent,o,m)}this._collisionIsEnabledButton=!!p&&p.buttonEnabled,p&&(this._isTouch||this._mouseDragging?this._mouseDragging&&this._mouseDragCollision&&this._mouseDragCollision.pickerEntity==p&&this.setupAndDispatchEvent(this._dragOver,this._mouseMoveEvent,o):this.setupAndDispatchEvent(this._mouseOver,this._mouseMoveEvent,o)),this._prevCollision=o}else{var g=!!p&&p.buttonEnabled;this._collisionIsEnabledButton!=g&&g&&(this._isTouch?this._mouseDragCollision&&this._mouseDragCollision.pickerEntity==p&&this.setupAndDispatchEvent(this._dragOver,this._mouseMoveEvent,o):this.setupAndDispatchEvent(this._mouseOver,this._mouseMoveEvent,o)),this._collisionIsEnabledButton=g}this._mouseDragging||(document.body.style.cursor=this._showCursor?p?p.getMouseCursor():"initial":"none"),this._updateDirty=!1}},t.prototype.registerPicker=function(t){this._pickerLookup.push(t)},t.prototype.unregisterPicker=function(t){this._pickerLookup.splice(this._pickerLookup.indexOf(t),1)},t.prototype.addEventsForSceneBinary=function(t,e){var i={clientX:null,clientY:null,touches:[],changedTouches:[],preventDefault:function(){}},n=new Float32Array(t),r=0,o=0;o++;var s=n[o++],a=n[o++],l=n[o++];if(1!=a&&6!=a&&12!=a&&262!=a&&518!=a){for(r=0;r<s;r++){(u={}).identifier=n[o++],u.clientX=n[o++],u.clientY=n[o++],i.touches[r]=u}i.changedTouches[0]=i.touches[l],i.changedTouches[0].clientX,i.changedTouches[0].clientY}else{if(1==s)(u={}).identifier=n[o++],u.clientX=n[o++],u.clientY=n[o++],i.clientX=u.clientX,i.clientY=u.clientY,i.clientX,i.clientY;else for(r=0;r<s;r++){var u;(u={}).identifier=n[o++],u.clientX=n[o++],u.clientY=n[o++],r!=l?i.touches[0]=u:(i.clientX=u.clientX,i.clientY=u.clientY,i.clientX,i.clientY)}}0==a||5==a||11==a||261==a||517==a?this.onMouseDown(i):1==a||6==a||12==a||262==a||518==a?this.onMouseUp(i):2==a?this.onMouseMove(i):console.log("recieved unknown touch event-type: "+a)},t.prototype.fireEventsForSceneFromString=function(t,e){var i={clientX:null,clientY:null,preventDefault:function(){}},n=t.split(","),r=0,o=0,s=parseInt(n[o++]),a=parseInt(n[o++]),l=parseInt(n[o++]);if(i.touches=[],i.changedTouches=[],1!=a&&6!=a){for(r=0;r<s;r++){(u={}).identifier=n[o++],u.clientX=n[o++],u.clientY=n[o++],i.touches[r]=u,i.changedTouches[r]=u}i.changedTouches[r]=i.touches[l]}else for(r=0;r<s;r++){var u;if(r!=l)(u={}).identifier=n[o++],u.clientX=n[o++],u.clientY=n[o++],i.touches[r]=u,i.changedTouches[r]=u;else i.clientX=n[o++],i.clientY=n[o++],o++}0==a?this.onMouseDown(i):1==a?this.onMouseUp(i):2==a?this.onMouseMove(i):261==a?this.onMouseDown(i):6==a&&this.onMouseUp(i)},t.prototype.setUpEvent=function(t,e,i){var n,r;return void 0===i&&(i=null),t._iAllowedToImmediatlyPropagate=!0,t._iAllowedToPropagate=!0,t.screenX=this._stage.screenX,t.screenY=this._stage.screenY,e?(t.entity=e.entity,t.pickerEntity=e.pickerEntity,t.traversable=e.traversable,t.uv=e.uv,t.position=null===(n=e.position)||void 0===n?void 0:n.clone(),t.normal=null===(r=e.normal)||void 0===r?void 0:r.clone(),t.elementIndex=e.elementIndex):(t.entity=null,t.pickerEntity=null,t.traversable=null,t.uv=null,t.position=this._nullVector,t.normal=this._nullVector,t.elementIndex=0),t.commonAncestor=i,t},t.prototype.queueDispatch=function(t,e){t.delta=e.wheelDelta,t.ctrlKey=e.ctrlKey,t.altKey=e.altKey,t.shiftKey=e.shiftKey,this._queuedEvents.push(t)},t.prototype.onKeyDown=function(e){if(!t.inputRecorder||t.inputRecorder.recordEvent(e),this.allowKeyInput&&(e.preventDefault(),this._currentFocusEntity||this._stage)){var i=new Mc(Mc.KEYDOWN,e.key,e.code);i.isShift=e.shiftKey,i.isCTRL=e.ctrlKey,i.isAlt=e.altKey,i.keyCode=e.keyCode,this._currentFocusEntity&&this._currentFocusEntity.dispatchEvent(i),this._stage&&this._stage.dispatchEvent(i)}},t.prototype.onKeyUp=function(e){if(!t.inputRecorder||t.inputRecorder.recordEvent(e),this.allowKeyInput&&(e.preventDefault(),this._currentFocusEntity||this._stage)){var i=new Mc(Mc.KEYUP,e.key,e.code);i.isShift=e.shiftKey,i.isCTRL=e.ctrlKey,i.isAlt=e.altKey,i.keyCode=e.keyCode,this._currentFocusEntity&&this._currentFocusEntity.dispatchEvent(i),this._stage&&this._stage.dispatchEvent(i)}},t.prototype.onMouseMove=function(e){!t.inputRecorder||t.inputRecorder.recordEvent(e),this._isTouch="mousemove"!=e.type,this.updateColliders(e),this.queueDispatch(this._mouseMove,this._mouseMoveEvent=e)},t.prototype.onMouseOut=function(e){!t.inputRecorder||t.inputRecorder.recordEvent(e),this.updateColliders(e),this.queueDispatch(this._mouseOut,e)},t.prototype.onMouseOver=function(e){!t.inputRecorder||t.inputRecorder.recordEvent(e),this.updateColliders(e),this.queueDispatch(this._mouseOver,e)},t.prototype.onClick=function(e){!t.inputRecorder||t.inputRecorder.recordEvent(e),this.updateColliders(e),this.queueDispatch(this._mouseClick,e)},t.prototype.onDoubleClick=function(e){!t.inputRecorder||t.inputRecorder.recordEvent(e),this.updateColliders(e),this.queueDispatch(this._mouseDoubleClick,e)},t.prototype.onMouseDown=function(e){this._isTouch="mousedown"!=e.type,this._isDown||(!t.inputRecorder||t.inputRecorder.recordEvent(e),this._isDown=!0,this.updateColliders(e),this._isTouch&&(e.preventDefault(),this._stage.container.focus()),this.queueDispatch(this._mouseDown,e))},t.prototype.onMouseUp=function(e){this._isDown&&(!t.inputRecorder||t.inputRecorder.recordEvent(e),this._isDown=!1,this.updateColliders(e),this._isTouch&&(e.preventDefault(),this._stage.container.focus()),this.queueDispatch(this._mouseUp,e))},t.prototype.onMouseWheel=function(e){!t.inputRecorder||t.inputRecorder.recordEvent(e),this.updateColliders(e),this.queueDispatch(this._mouseWheel,e)},t.prototype.updateColliders=function(t){this._stage.interactionHandler(t),this._updateDirty=!0},t._instancePool={},t}(),yh=(function(t){function e(e,i,n,r,o,s,a){void 0===e&&(e=null),void 0===i&&(i="triangle"),void 0===n&&(n=50),void 0===r&&(r=100),void 0===o&&(o=16),void 0===s&&(s=15),void 0===a&&(a=!0);var l=t.call(this,e,i)||this;return l._numVertices=0,l._radius=n,l._height=r,l._segmentsW=o,l._segmentsH=s%2==0?s+1:s,l._yUp=a,l}i(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t%2==0?t+1:t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),e.prototype._pBuildGraphics=function(t,e){var i,n,r,o,s,a,l,u,c,h,p,d,f=0,_=0,m=0;if(e==Ia.TRIANGLE){var g=t;for(this._numVertices=(this._segmentsH+1)*(this._segmentsW+1),m=(this._segmentsH-1)*this._segmentsW*6,this._numVertices==g.numVertices?(g.invalidateIndices(),g.invalidateVertices(g.positions),g.invalidateVertices(g.normals),g.invalidateVertices(g.tangents)):(g.setIndices(new Uint16Array(m)),g.setPositions(new Float32Array(3*this._numVertices)),g.setNormals(new Float32Array(3*this._numVertices)),g.setTangents(new Float32Array(3*this._numVertices)),this._pInvalidateUVs()),i=g.indices.get(g.numElements),n=g.positions.get(this._numVertices),r=g.normals.get(this._numVertices),o=g.tangents.get(this._numVertices),s=g.concatenatedBuffer.stride/4,l=0;l<=this._segmentsH;++l){var y=Math.PI*l/this._segmentsH,A=-this._radius*Math.cos(y),v=this._radius*Math.sin(y);for(u=_,a=0;a<=this._segmentsW;++a){var b=2*Math.PI*a/this._segmentsW,x=v*Math.cos(b),C=l>this._segmentsH/2?this._height/2:-this._height/2,w=v*Math.sin(b),I=1/Math.sqrt(x*x+w*w+A*A),E=Math.sqrt(w*w+x*x);if(this._yUp?(p=0,d=E>.007?x/E:0,c=-A,h=w):(p=E>.007?x/E:0,d=0,c=w,h=A),a==this._segmentsW?(n[_]=n[u],n[_+1]=n[u+1],n[_+2]=n[u+2],r[_]=.5*(r[u]+x*I),r[_+1]=.5*(r[u+1]+c*I),r[_+2]=.5*(r[u+2]+h*I),o[_]=.5*(o[u]+(E>.007?-w/E:1)),o[_+1]=.5*(o[u+1]+p),o[_+2]=.5*(o[u+2]+d)):(n[_]=x,n[_+1]=this._yUp?c-C:c,n[_+2]=this._yUp?h:h+C,r[_]=x*I,r[_+1]=c*I,r[_+2]=h*I,o[_]=E>.007?-w/E:1,o[_+1]=p,o[_+2]=d),a>0&&l>0){var S=(this._segmentsW+1)*l+a,D=(this._segmentsW+1)*l+a-1,T=(this._segmentsW+1)*(l-1)+a-1,P=(this._segmentsW+1)*(l-1)+a;l==this._segmentsH?(n[_]=n[u],n[_+1]=n[u+1],n[_+2]=n[u+2],i[f++]=S,i[f++]=T,i[f++]=P):1==l?(i[f++]=S,i[f++]=D,i[f++]=T):(i[f++]=S,i[f++]=D,i[f++]=T,i[f++]=S,i[f++]=T,i[f++]=P)}_+=s}}}},e.prototype._pBuildUVs=function(t,e){var i,n,r,o;if(e==Ia.TRIANGLE){var s=t;s.uvs&&this._numVertices==s.numVertices?s.invalidateVertices(s.uvs):s.setUVs(new Float32Array(2*this._numVertices)),r=s.uvs.get(this._numVertices),o=s.uvs.stride;var a=0;for(n=0;n<=this._segmentsH;++n)for(i=0;i<=this._segmentsW;++i)r[a]=i/this._segmentsW*this._scaleU,r[a+1]=n/this._segmentsH*this._scaleV,a+=o}}}(Oa),function(t){function e(e,i,n,r,o,s,a,l,u,c,h){void 0===e&&(e=null),void 0===i&&(i="triangle"),void 0===n&&(n=50),void 0===r&&(r=50),void 0===o&&(o=100),void 0===s&&(s=16),void 0===a&&(a=1),void 0===l&&(l=!0),void 0===u&&(u=!0),void 0===c&&(c=!0),void 0===h&&(h=!0);var p=t.call(this,e,i)||this;return p._numVertices=0,p._topRadius=n,p._pBottomRadius=r,p._height=o,p._pSegmentsW=s,p._pSegmentsH=a,p._topClosed=l,p._bottomClosed=u,p._surfaceClosed=c,p._yUp=h,p}return i(e,t),Object.defineProperty(e.prototype,"topRadius",{get:function(){return this._topRadius},set:function(t){this._topRadius=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRadius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._pSegmentsW},set:function(t){this.setSegmentsW(t)},enumerable:!0,configurable:!0}),e.prototype.setSegmentsW=function(t){this._pSegmentsW=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._pSegmentsH},set:function(t){this.setSegmentsH(t)},enumerable:!0,configurable:!0}),e.prototype.setSegmentsH=function(t){this._pSegmentsH=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},Object.defineProperty(e.prototype,"topClosed",{get:function(){return this._topClosed},set:function(t){this._topClosed=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomClosed",{get:function(){return this._bottomClosed},set:function(t){this._bottomClosed=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),e.prototype._pBuildGraphics=function(t,e){var i,n,r,o,s,a,l,u,c,h,p,d,f,_,m,g,y,A,v,b,x,C=0,w=0,I=0,E=0;this._numVertices=0;var S=2*Math.PI/this._pSegmentsW;if(e==Ia.TRIANGLE){var D=t;if(this._surfaceClosed&&(this._numVertices+=(this._pSegmentsH+1)*(this._pSegmentsW+1),C+=this._pSegmentsH*this._pSegmentsW*6),this._topClosed&&(this._numVertices+=2*(this._pSegmentsW+1),C+=3*this._pSegmentsW),this._bottomClosed&&(this._numVertices+=2*(this._pSegmentsW+1),C+=3*this._pSegmentsW),this._numVertices==D.numVertices?(D.positions.invalidate(),D.normals.invalidate(),D.tangents.invalidate(),D.indices.invalidate()):(D.setIndices(new Uint16Array(C)),D.setPositions(new Float32Array(3*this._numVertices)),D.setNormals(new Float32Array(3*this._numVertices)),D.setTangents(new Float32Array(3*this._numVertices)),this._pInvalidateUVs()),i=D.indices.get(D.numElements),n=D.positions.get(this._numVertices),r=D.normals.get(this._numVertices),o=D.tangents.get(this._numVertices),s=D.concatenatedBuffer.stride/4,p=0,d=0,this._topClosed&&this._topRadius>0)for(h=-.5*this._height,this._yUp?(b=1,x=0,A=-h,v=0):(b=0,x=-1,A=0,v=h),n[p]=0,n[p+1]=A,n[p+2]=v,r[p]=0,r[p+1]=b,r[p+2]=x,o[p]=1,o[p+1]=0,o[p+2]=0,p+=s,I++,a=0;a<=this._pSegmentsW;++a)_=a*S,u=this._topRadius*Math.cos(_),c=this._topRadius*Math.sin(_),this._yUp?(A=-h,v=c):(A=c,v=h),a==this._pSegmentsW?(n[p]=n[w+s],n[p+1]=n[w+s+1],n[p+2]=n[w+s+2]):(n[p]=u,n[p+1]=A,n[p+2]=v),r[p]=0,r[p+1]=b,r[p+2]=x,o[p]=1,o[p+1]=0,o[p+2]=0,p+=s,a>0&&(i[d++]=I-1,i[d++]=E,i[d++]=I),I++;if(this._bottomClosed&&this._pBottomRadius>0)for(h=.5*this._height,w=I*s,E=I,this._yUp?(b=-1,x=0,A=-h,v=0):(b=0,x=1,A=0,v=h),a>0&&(n[p]=0,n[p+1]=A,n[p+2]=v,r[p]=0,r[p+1]=b,r[p+2]=x,o[p]=1,o[p+1]=0,o[p+2]=0,p+=s),I++,a=0;a<=this._pSegmentsW;++a)_=a*S,u=this._pBottomRadius*Math.cos(_),c=this._pBottomRadius*Math.sin(_),this._yUp?(A=-h,v=c):(A=c,v=h),a==this._pSegmentsW?(n[p]=n[w+s],n[p+1]=n[w+s+1],n[p+2]=n[w+s+2]):(n[p]=u,n[p+1]=A,n[p+2]=v),r[p]=0,r[p+1]=b,r[p+2]=x,o[p]=1,o[p+1]=0,o[p+2]=0,p+=s,a>0&&(i[d++]=I-1,i[d++]=I,i[d++]=E),I++;if(y=0==(g=(m=this._pBottomRadius-this._topRadius)/this._height)?1:this._height/m,this._surfaceClosed){var T=void 0,P=void 0,B=void 0,M=void 0,O=void 0,L=void 0,R=void 0,N=void 0;for(l=0;l<=this._pSegmentsH;++l)for(f=this._topRadius-l/this._pSegmentsH*(this._topRadius-this._pBottomRadius),h=-this._height/2+l/this._pSegmentsH*this._height,w=I*s,a=0;a<=this._pSegmentsW;++a)_=a*S,u=f*Math.cos(_),c=f*Math.sin(_),O=y*Math.cos(_),L=y*Math.sin(_),this._yUp?(b=0,x=-O,A=-h,v=c,R=g,N=L):(b=-O,x=0,A=c,v=h,R=L,N=g),a==this._pSegmentsW?(n[p]=n[w],n[p+1]=n[w+1],n[p+2]=n[w+2],r[p]=O,r[p+1]=g,r[p+2]=L,o[p]=L,o[p+1]=b,o[p+2]=x):(n[p]=u,n[p+1]=A,n[p+2]=v,r[p]=O,r[p+1]=R,r[p+2]=N,o[p]=-L,o[p+1]=b,o[p+2]=x),p+=s,a>0&&l>0&&(T=I,B=(P=I-1)-this._pSegmentsW-1,M=T-this._pSegmentsW-1,i[d++]=T,i[d++]=P,i[d++]=B,i[d++]=T,i[d++]=B,i[d++]=M),I++}}else if(e==Ia.LINE){var F=t,k=this._pSegmentsH*this._pSegmentsW*2+this._pSegmentsW;n=new Float32Array(6*k);var V=new Float32Array(k);for(p=0,d=0,l=0;l<=this._pSegmentsH;++l)for(f=this._topRadius-l/this._pSegmentsH*(this._topRadius-this._pBottomRadius),h=-this._height/2+l/this._pSegmentsH*this._height,a=0;a<=this._pSegmentsW;++a){if(_=a*S,u=f*Math.cos(_),c=f*Math.sin(_),this._yUp?(A=-h,v=c):(A=c,v=h),a>0&&(n[p++]=u,n[p++]=A,n[p++]=v,V[d++]=1,l>0)){var U=1==l?3-(6*(this._pSegmentsW-a)+12*a):3-12*this._pSegmentsW;n[p]=n[p+++U],n[p]=n[p+++U],n[p]=n[p+++U],n[p++]=u,n[p++]=A,n[p++]=v,V[d++]=1}a<this._pSegmentsW&&(n[p++]=u,n[p++]=A,n[p++]=v)}F.setPositions(n),F.setThickness(V)}},e.prototype._pBuildUVs=function(t,e){var i,n,r,o,s,a,l;if(e==Ia.TRIANGLE){var u=t;u.uvs&&this._numVertices==u.numVertices?u.invalidateVertices(u.uvs):u.setUVs(new Float32Array(2*this._numVertices)),a=u.uvs.get(this._numVertices),l=u.uvs.stride;var c=2*Math.PI/this._pSegmentsW,h=0;if(this._topClosed)for(a[h]=.5*this._scaleU,a[h+1]=.5*this._scaleV,h+=l,i=0;i<=this._pSegmentsW;++i)s=i*c,r=.5+.5*-Math.cos(s),o=.5+.5*Math.sin(s),a[h]=r*this._scaleU,a[h+1]=o*this._scaleV,h+=l;if(this._bottomClosed)for(a[h]=.5*this._scaleU,a[h+1]=.5*this._scaleV,h+=l,i=0;i<=this._pSegmentsW;++i)s=i*c,r=.5+.5*Math.cos(s),o=.5+.5*Math.sin(s),a[h]=r*this._scaleU,a[h+1]=o*this._scaleV,h+=l;if(this._surfaceClosed)for(n=0;n<=this._pSegmentsH;++n)for(i=0;i<=this._pSegmentsW;++i)a[h]=i/this._pSegmentsW*this._scaleU,a[h+1]=n/this._pSegmentsH*this._scaleV,h+=l}},e}(Oa)),Ah=(function(t){function e(e,i,n,r,o,s,a,l){return void 0===e&&(e=null),void 0===i&&(i="triangle"),void 0===n&&(n=50),void 0===r&&(r=100),void 0===o&&(o=16),void 0===s&&(s=1),void 0===a&&(a=!0),void 0===l&&(l=!0),t.call(this,e,i,0,n,r,o,s,!1,a,!0,l)||this}i(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0})}(yh),function(t){function e(e,i,n,r,o,s,a,l){void 0===e&&(e=null),void 0===i&&(i="triangle"),void 0===n&&(n=100),void 0===r&&(r=100),void 0===o&&(o=1),void 0===s&&(s=1),void 0===a&&(a=!0),void 0===l&&(l=!1);var u=t.call(this,e,i)||this;return u._segmentsW=o,u._segmentsH=s,u._yUp=a,u._width=n,u._height=r,u._doubleSided=l,u}i(e,t),Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"doubleSided",{get:function(){return this._doubleSided},set:function(t){this._doubleSided=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),e.prototype._pBuildGraphics=function(t,e){var i,n,r,o,s,a,l,u,c,h,p=this._segmentsW+1;if(e==Ia.TRIANGLE){var d=t,f=(this._segmentsH+1)*p,_=void 0,m=void 0;for(this._doubleSided&&(f*=2),o=this._segmentsH*this._segmentsW*6,this._doubleSided&&(o*=2),null!=d.indices&&o==d.indices.length?d.invalidateIndices():(d.setIndices(new Uint16Array(o)),this._pInvalidateUVs()),i=d.indices.get(d.numElements),f==d.numVertices?(d.invalidateVertices(d.positions),d.invalidateVertices(d.normals),d.invalidateVertices(d.tangents)):(d.setPositions(new Float32Array(3*f)),d.setNormals(new Float32Array(3*f)),d.setTangents(new Float32Array(3*f)),this._pInvalidateUVs()),A=d.positions.get(f),_=d.normals.get(f),m=d.tangents.get(f),s=d.concatenatedBuffer.stride/4,u=0,l=0,h=0;h<=this._segmentsH;++h)for(c=0;c<=this._segmentsW;++c){if(n=(c/this._segmentsW-.5)*this._width,r=(h/this._segmentsH-.5)*this._height,A[l]=n,this._yUp?(A[l+1]=0,A[l+2]=r):(A[l+1]=r,A[l+2]=0),_[l]=0,this._yUp?(_[l+1]=1,_[l+2]=0):(_[l+1]=0,_[l+2]=-1),m[l]=1,m[l+1]=0,m[l+2]=0,l+=s,this._doubleSided){for(var g=l;g<l+3;++g)A[g]=A[g-3],_[g]=-_[g-3],m[g]=-m[g-3];l+=s}if(c!=this._segmentsW&&h!=this._segmentsH){a=c+h*p;var y=this._doubleSided?2:1;i[u++]=a*y,i[u++]=(a+p)*y,i[u++]=(a+p+1)*y,i[u++]=a*y,i[u++]=(a+p+1)*y,i[u++]=(a+1)*y,this._doubleSided&&(i[u++]=(a+p+1)*y+1,i[u++]=(a+p)*y+1,i[u++]=a*y+1,i[u++]=(a+1)*y+1,i[u++]=(a+p+1)*y+1,i[u++]=a*y+1)}}}else if(e==Ia.LINE){var A,v=t,b=this._segmentsH+1+p,x=void 0,C=this._width/2,w=this._height/2;for(A=new Float32Array(6*b),x=new Float32Array(b),u=0,l=0,h=0;h<=this._segmentsH;++h)A[l++]=-C,A[l++]=0,A[l++]=h*this._height-w,A[l++]=C,A[l++]=0,A[l++]=h*this._height-w,x[u++]=1;for(c=0;c<=this._segmentsW;++c)A[l++]=c*this._width-C,A[l++]=0,A[l++]=-w,A[l++]=c*this._width-C,A[l++]=0,A[l++]=w,x[u++]=1;v.setPositions(A),v.setThickness(x)}},e.prototype._pBuildUVs=function(t,e){var i,n,r;if(e==Ia.TRIANGLE){r=(this._segmentsH+1)*(this._segmentsW+1),this._doubleSided&&(r*=2);var o=t;o.uvs&&r==o.numVertices?o.invalidateVertices(o.uvs):o.setUVs(new Float32Array(2*r)),i=o.uvs.get(r),n=o.uvs.stride;for(var s=0,a=0;a<=this._segmentsH;++a)for(var l=0;l<=this._segmentsW;++l)i[s]=l/this._segmentsW*this._scaleU,i[s+1]=(1-a/this._segmentsH)*this._scaleV,s+=n,this._doubleSided&&(i[s]=l/this._segmentsW*this._scaleU,i[s+1]=(1-a/this._segmentsH)*this._scaleV,s+=n)}}}(Oa),function(t){function e(e,i,n,r,o){return void 0===e&&(e=null),void 0===i&&(i="triangle"),void 0===n&&(n=100),void 0===r&&(r=16),void 0===o&&(o=!0),t.call(this,e,i,n,0,0,r,1,!0,!1,!1,o)||this}i(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sides",{get:function(){return this._pSegmentsW},set:function(t){this.setSegmentsW(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subdivisions",{get:function(){return this._pSegmentsH},set:function(t){this.setSegmentsH(t)},enumerable:!0,configurable:!0})}(yh),function(t){function e(e,i,n,r,o,s,a){void 0===e&&(e=null),void 0===i&&(i="triangle"),void 0===n&&(n=50),void 0===r&&(r=50),void 0===o&&(o=16),void 0===s&&(s=8),void 0===a&&(a=!0);var l=t.call(this,e,i)||this;return l._numVertices=0,l._radius=n,l._tubeRadius=r,l._segmentsR=o,l._segmentsT=s,l._yUp=a,l}i(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tubeRadius",{get:function(){return this._tubeRadius},set:function(t){this._tubeRadius=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsR",{get:function(){return this._segmentsR},set:function(t){this._segmentsR=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentsT",{get:function(){return this._segmentsT},set:function(t){this._segmentsT=t,this._pInvalidatePrimitive(),this._pInvalidateUVs()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t,this._pInvalidatePrimitive()},enumerable:!0,configurable:!0}),e.prototype._pBuildGraphics=function(t,e){var i,n,r,o,s,a,l,u,c,h,p,d,f,_,m,g,y,A=0;if(e==Ia.TRIANGLE){var v=t;this._numVertices=(this._segmentsT+1)*(this._segmentsR+1),A=this._segmentsT*this._segmentsR*6,this._numVertices==v.numVertices?(v.invalidateIndices(),v.invalidateVertices(v.positions),v.invalidateVertices(v.normals),v.invalidateVertices(v.tangents)):(v.setIndices(new Uint16Array(A)),v.setPositions(new Float32Array(3*this._numVertices)),v.setNormals(new Float32Array(3*this._numVertices)),v.setTangents(new Float32Array(3*this._numVertices)),this._pInvalidateUVs()),i=v.indices.get(v.numElements),n=v.positions.get(this._numVertices),r=v.normals.get(this._numVertices),o=v.tangents.get(this._numVertices),s=v.concatenatedBuffer.stride/4,g=0,y=0;var b,x=2*Math.PI/this._segmentsR,C=2*Math.PI/this._segmentsT,w=void 0,I=void 0,E=void 0,S=void 0,D=void 0,T=void 0,P=0,B=0,M=void 0,O=void 0,L=void 0,R=void 0;for(l=0;l<=this._segmentsT;++l)for(P=g,a=0;a<=this._segmentsR;++a)_=a*x,m=l*C,p=(b=Math.cos(m))*Math.cos(_),d=b*Math.sin(_),f=Math.sin(m),u=this._radius*Math.cos(_)+this._tubeRadius*p,c=this._radius*Math.sin(_)+this._tubeRadius*d,h=l==this._segmentsT?0:this._tubeRadius*f,this._yUp?(D=-f,T=d,E=0,S=b?p/b:u/this._radius,w=-h,I=c):(D=d,T=f,E=b?p/b:u/this._radius,S=0,w=c,I=h),a==this._segmentsR?(n[g]=u,n[g+1]=n[P+1],n[g+2]=n[P+2]):(n[g]=u,n[g+1]=w,n[g+2]=I),r[g]=p,r[g+1]=D,r[g+2]=T,o[g]=-(b?d/b:c/this._radius),o[g+1]=E,o[g+2]=S,g+=s,a>0&&l>0&&(M=B,L=(O=B-1)-this._segmentsR-1,R=M-this._segmentsR-1,i[y++]=M,i[y++]=O,i[y++]=L,i[y++]=M,i[y++]=L,i[y++]=R),B++}},e.prototype._pBuildUVs=function(t,e){var i,n,r,o;if(e==Ia.TRIANGLE){var s=t;s.uvs&&this._numVertices==s.numVertices?s.invalidateVertices(s.uvs):s.setUVs(new Float32Array(2*this._numVertices)),r=s.uvs.get(this._numVertices),o=s.uvs.stride;var a=0;for(n=0;n<=this._segmentsT;++n)for(i=0;i<=this._segmentsR;++i)r[a]=i/this._segmentsR*this._scaleU,r[a+1]=n/this._segmentsT*this._scaleV,a+=o}}}(Oa),function(){function t(t,e,i){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=!1),this._keepMaterial=t,this._disposeSources=e,this._objectSpace=i}Object.defineProperty(t.prototype,"disposeSources",{get:function(){return this._disposeSources},set:function(t){this._disposeSources=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keepMaterial",{get:function(){return this._keepMaterial},set:function(t){this._keepMaterial=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectSpace",{get:function(){return this._objectSpace},set:function(t){this._objectSpace=t},enumerable:!0,configurable:!0}),t.prototype.applyToContainer=function(t,e){this.reset(),this.parseContainer(t,e),this.collect(t,!1),this.merge(t,this._disposeSources)},t.prototype.applyToSprites=function(t,e){if(this.reset(),e.length){for(var i=0;i<e.length;i++)e[i]!=t&&this.collect(e[i],this._disposeSources);this.collect(t,!1),this.merge(t,this._disposeSources)}},t.prototype.apply=function(t,e){this.reset(),this.collect(e,this._disposeSources),this.collect(t,!1),this.merge(t,this._disposeSources)},t.prototype.reset=function(){this._toDispose=new Array,this._shapeVOs=new Array},t.prototype.merge=function(t,e){var i,n;for(i=t.graphics,n=this._shapeVOs.length>1,s=0;s<this._shapeVOs.length;s++){var r=new Us(new Pn);r.autoDeriveNormals=!1,r.autoDeriveTangents=!1;var o=this._shapeVOs[s];r.setIndices(o.indices),r.setPositions(o.vertices),r.setNormals(o.normals),r.setTangents(o.tangents),r.setUVs(o.uvs),this._keepMaterial&&n?i.addShape(qs.getShape(r,o.material)):i.addShape(qs.getShape(r))}if(this._keepMaterial&&!n&&this._shapeVOs.length&&(t.material=this._shapeVOs[0].material),e)for(var s,a=this._toDispose.length;s<a;s++)this._toDispose[s].dispose();this._toDispose=null},t.prototype.collect=function(t,e){var i,n;for(i=0;i<t.graphics.count;i++){var r,o,s,a,l,u,c,h,p,d,f,_,m,g;for(p=t.graphics.getShapeAt(i).elements,d=this.getShapeData(t.graphics.getShapeAt(i).material),f=this._objectSpace?d.vertices:new Array,_=this._objectSpace?d.normals:new Array,m=this._objectSpace?d.tangents:new Array,a=f.length,l=_.length,u=m.length,c=d.uvs.length,this.copyAttributes(p.positions,f,p.numVertices,a),this.copyAttributes(p.normals,_,p.numVertices,l),this.copyAttributes(p.tangents,m,p.numVertices,u),this.copyAttributes(p.uvs,d.uvs,p.numVertices,c),h=this._objectSpace?0:d.vertices.length/3,s=d.indices.length,o=p.numElements,g=p.indices.get(o),r=0;r<o;r++)n=3*r,d.indices[s++]=g[n]+h,d.indices[s++]=g[n+1]+h,d.indices[s++]=g[n+2]+h;if(!this._objectSpace)for(t.transform.concatenatedMatrix3D.transformVectors(f,f),t.transform.concatenatedMatrix3D.deltaTransformVectors(_,_),t.transform.concatenatedMatrix3D.deltaTransformVectors(m,m),a=d.vertices.length,l=d.normals.length,u=d.tangents.length,o=f.length,r=0;r<o;r++)d.vertices[a++]=f[r],d.normals[l++]=_[r],d.tangents[u++]=m[r]}e&&this._toDispose.push(t)},t.prototype.copyAttributes=function(t,e,i,n){for(var r=t.get(i),o=t.dimensions,s=t.stride,a=i*s,l=0;l<a;l+=s)for(var u=0;u<o;u++)e[n++]=r[l+u]},t.prototype.getShapeData=function(t){var e;if(this._keepMaterial){var i,n=void 0;for(i=this._shapeVOs.length,n=0;n<i;n++)if(this._shapeVOs[n].material==t){e=this._shapeVOs[n];break}}else this._shapeVOs.length&&(e=this._shapeVOs[0]);return e||((e=new Ah).vertices=new Array,e.normals=new Array,e.tangents=new Array,e.uvs=new Array,e.indices=new Array,e.material=t,this._shapeVOs.push(e)),e},t.prototype.parseContainer=function(t,e){var i,n;for(e instanceof ka&&e!=t&&this.collect(e,this._disposeSources),n=0;n<e.numChildren;++n)i=e.getChildAt(n),this.parseContainer(t,i)}}(),function(){});!function(){function t(t,e,i,n){var r=this;void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),this._time=0,this._deltaTime=0,this._onProjectionChangedDelegate=function(t){return r._onProjectionChanged(t)},this._rendererType=n||_r.DEFAULT,this.view=i||new Un,this.partition=t||new oe(new Fa),this.camera=e||new Ya}Object.defineProperty(t.prototype,"partition",{get:function(){return this._partition},set:function(t){this._partition!=t&&(this._mousePicker&&this._mouseManager.unregisterPicker(this._mousePicker),this._partition=t,this._mousePicker=this._pickGroup.getRaycastPicker(this._partition),this._tabPicker=this._pickGroup.getTabPicker(this._partition),this._mousePicker.findClosestCollision=!0,this._mouseManager.registerPicker(this._mousePicker),this._camera&&(this._camera.clear(),this._partition.invalidateEntity(this._camera),this._camera.partition=this._partition),this._partition.root.partition=this._partition)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){return this._view},set:function(t){this._view!=t&&(this._view&&(this._renderer&&(Ir.clearInstance(this._view,this._rendererType),this._renderer=null),ce.clearInstance(this._view),this._mousePicker&&this._mouseManager.unregisterPicker(this._mousePicker)),this._view=t,this._pickGroup=ce.getInstance(this._view),this._mouseManager=gh.getInstance(this._view.stage),this._mousePicker&&this._mouseManager.registerPicker(this._mousePicker),this._camera&&(this._view.projection=this._camera.projection))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this._renderer||(this._renderer=Ir.getInstance(this._view,this._rendererType).getRenderer(this._partition)),this._renderer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._partition.root},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mouseX",{get:function(){return this._mouseX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mouseY",{get:function(){return this._mouseY},enumerable:!0,configurable:!0}),t.prototype.getLocalMouseX=function(t){return t.transform.inverseConcatenatedMatrix3D.transformVector(this._view.unproject(this._view.stage.screenX,this._view.stage.screenY,1e3)).x},t.prototype.getLocalMouseY=function(t){return t.transform.inverseConcatenatedMatrix3D.transformVector(this._view.unproject(this._view.stage.screenX,this._view.stage.screenY,1e3)).y},t.prototype.getLocalTouchPoints=function(t){for(var e,i=new Array,n=this._view.stage.touchPoints.length,r=0;r<n;r++)e=t.transform.inverseConcatenatedMatrix3D.transformVector(this._view.unproject(this._view.stage.touchPoints[r].x,this._view.stage.touchPoints[r].y,1e3)),i.push(new Oe(e.x,e.y,this._view.stage.touchPoints[r].id));return i},Object.defineProperty(t.prototype,"rendererType",{get:function(){return this._rendererType},set:function(t){this._rendererType!=t&&(this._renderer&&(Ir.clearInstance(this._view,this._rendererType),this._renderer=null),this._rendererType=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"camera",{get:function(){return this._camera},set:function(t){this._camera!=t&&(this._camera&&(this._camera.clear(),this._camera.removeEventListener(qa.PROJECTION_CHANGED,this._onProjectionChangedDelegate)),this._camera=t,this._camera.addEventListener(qa.PROJECTION_CHANGED,this._onProjectionChangedDelegate),this._view&&(this._view.projection=this._camera.projection),this._partition.invalidateEntity(this._camera),this._camera.partition=this._partition)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deltaTime",{get:function(){return this._deltaTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mouseManager",{get:function(){return this._mouseManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mousePicker",{get:function(){return this._mousePicker},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabPicker",{get:function(){return this._tabPicker},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderedFacesCount",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.fireMouseEvents=function(){this.disableMouseEvents||this._mouseManager.fireMouseEvents(this._mousePicker)},t.prototype.render=function(t){void 0===t&&(t=!0),this._updateTime(),t&&!this.disableMouseEvents&&this._mouseManager.fireMouseEvents(this._mousePicker),this.beforeRenderCallback&&this.beforeRenderCallback();this._view.stage;this.renderer.render()},t.prototype._updateTime=function(){var t=ft();0==this._time&&(this._time=t),this._deltaTime=t-this._time,this._time=t},t.prototype.dispose=function(){this._renderer&&(Ir.clearInstance(this._view,this._rendererType),this._renderer=null),this._mouseManager.dispose(),this._mouseManager=null},t.prototype._onProjectionChanged=function(t){this._view.projection=this._camera.projection}}();$s.materialClass=ac,$s.textureClass=hl,console.debug("AwayJS - Scene - 0.13.145");var vh=Function("return this")();var bh={pow2:function(t){return t===(0|t)?t<0?1/(1<<-t):1<<t:Math.pow(2,t)},clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},roundHalfEven:function(t){if(.5===Math.abs(t%1)){var e=Math.floor(t);return e%2==0?e:Math.ceil(t)}return Math.round(t)},altTieBreakRound:function(t,e){return.5!==Math.abs(t%1)||e?Math.round(t):0|t},epsilonEquals:function(t,e){return Math.abs(t-e)<1e-7}};function xh(t){return"string"==typeof t?'"'+t+'"':"number"==typeof t||"boolean"==typeof t?String(t):t instanceof Array?"[] "+t.length:typeof t}var Ch=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];var wh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$_";function Ih(t){return t>=65&&t<=90?t-65:t>=97&&t<=122?t-71:t>=48&&t<=57?t+4:36===t?62:95===t?63:void 0}var Eh=new Array(3),Sh=new Array(4),Dh=new Array(9);function Th(t,e,i){return Eh[0]=t,Eh[1]=e,Eh[2]=i,Eh.join("")}function Ph(t,e,i,n){return Sh[0]=t,Sh[1]=e,Sh[2]=i,Sh[3]=n,Sh.join("")}function Bh(t,e,i,n,r,o,s,a,l){return Dh[0]=t,Dh[1]=e,Dh[2]=i,Dh[3]=n,Dh[4]=r,Dh[5]=o,Dh[6]=s,Dh[7]=a,Dh[8]=l,Dh.join("")}var Mh={repeatString:function(t,e){for(var i="",n=0;n<e;n++)i+=t;return i},memorySizeToString:function(t){var e=1024,i=e*e;return(t|=0)<e?t+" B":t<i?(t/e).toFixed(2)+"KB":(t/i).toFixed(2)+"MB"},toSafeString:xh,toSafeArrayString:function(t){for(var e=[],i=0;i<t.length;i++)e.push(xh(t[i]));return e.join(", ")},utf8decode:function(t){for(var e=new Uint8Array(4*t.length),i=0,n=0,r=t.length;n<r;n++){var o=t.charCodeAt(n);if(o<=127)e[i++]=o;else{if(55296<=o&&o<=56319){var s=t.charCodeAt(n+1);56320<=s&&s<=57343&&(o=((1023&o)<<10)+(1023&s)+65536,++n)}0!=(4292870144&o)?(e[i++]=248|o>>>24&3,e[i++]=128|o>>>18&63,e[i++]=128|o>>>12&63,e[i++]=128|o>>>6&63,e[i++]=128|63&o):0!=(4294901760&o)?(e[i++]=240|o>>>18&7,e[i++]=128|o>>>12&63,e[i++]=128|o>>>6&63,e[i++]=128|63&o):0!=(4294965248&o)?(e[i++]=224|o>>>12&15,e[i++]=128|o>>>6&63,e[i++]=128|63&o):(e[i++]=192|o>>>6&31,e[i++]=128|63&o)}}return e.subarray(0,i)},utf8encode:function(t){for(var e=0,i="";e<t.length;){var n=255&t[e++];if(n<=127)i+=String.fromCharCode(n);else{var r=192,o=5;do{if((n&(r>>1|128))===r)break;r=r>>1|128,--o}while(o>=0);if(o<=0){i+=String.fromCharCode(n);continue}for(var s=n&(1<<o)-1,a=!1,l=5;l>=o;--l){var u=t[e++];if(128!=(192&u)){a=!0;break}s=s<<6|63&u}if(a){for(var c=e-(7-l);c<e;++c)i+=String.fromCharCode(255&t[c]);continue}i+=s>=65536?String.fromCharCode(s-65536>>10&1023|55296,1023&s|56320):String.fromCharCode(s)}}return i},base64EncodeBytes:function(t){for(var e,i="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=t.byteLength,o=r%3,s=r-o,a=0;a<s;a+=3)i+=Ph(n[(16515072&(e=t[a]<<16|t[a+1]<<8|t[a+2]))>>18],n[(258048&e)>>12],n[(4032&e)>>6],n[63&e]);return 1==o?i+=Th(n[(252&(e=t[s]))>>2],n[(3&e)<<4],"=="):2==o&&(i+=Ph(n[(64512&(e=t[s]<<8|t[s+1]))>>10],n[(1008&e)>>4],n[(15&e)<<2],"=")),i},base64DecodeMap:Ch,base64DecodeMapOffset:43,base64EOF:61,decodeRestrictedBase64ToBytes:function(t){for(var e,i,n,r=t.length,o="="===t.charAt(r-2)?2:"="===t.charAt(r-1)?1:0,s=new Uint8Array(3*(t.length>>2)-o),a=0,l=0;a<t.length;){if(e=t.charCodeAt(a++),i=Ch[e-43],e=t.charCodeAt(a++),n=Ch[e-43],s[l++]=i<<2|(48&n)>>4,61==(e=t.charCodeAt(a++)))return s;if(i=Ch[e-43],s[l++]=(15&n)<<4|(60&i)>>2,61==(e=t.charCodeAt(a++)))return s;n=Ch[e-43],s[l++]=(3&i)<<6|n}return s},escapeString:function(t){return void 0!==t&&(t=t.replace(/[^\w$]/gi,"$"),/^\d/.test(t)&&(t="$"+t)),t},fromCharCodeArray:function(t){for(var e="",i=0;i<t.length;i+=16384){var n=Math.min(t.length-i,16384);e+=String.fromCharCode.apply(null,t.subarray(i,i+n))}return e},variableLengthEncodeInt32:function(t){for(var e=wh,i=32-Math.clz32(t),n=Math.ceil(i/6),r=e[n],o=n-1;o>=0;o--){r+=e[t>>6*o&63]}return r},toEncoding:function(t){return wh[t]},fromEncoding:Ih,variableLengthDecodeInt32:function(t){for(var e=Ih(t.charCodeAt(0)),i=0,n=0;n<e;n++){var r=6*(e-n-1);i|=Ih(t.charCodeAt(1+n))<<r}return i},trimMiddle:function(t,e){if(t.length<=e)return t;var i=e>>1,n=e-i-1;return t.substr(0,i)+"…"+t.substr(t.length-n,n)},multiple:function(t,e){for(var i="",n=0;n<e;n++)i+=t;return i},indexOfAny:function(t,e,i){for(var n=t.length,r=0;r<e.length;r++){var o=t.indexOf(e[r],i);o>=0&&(n=Math.min(n,o))}return n===t.length?-1:n},_concat3array:Eh,_concat4array:Sh,_concat9array:Dh,concat3:Th,concat4:Ph,concat9:Bh},Oh=function(){function t(t){this._data=Object.create(null),this._size=0,this._maxSize=t}return t.prototype.get=function(t){return this._data[t]},t.prototype.set=function(t,e){return!(this._size>=this._maxSize)&&(this._data[t]=e,this._size++,!0)},t}();function Lh(t){return function(t){return t/256}(function(t){return 256*t<<16>>16}(t))}function Rh(t){return t<<16>>16}Math.imul||(Math.imul=function(t,e){var i=65535&t,n=65535&e;return i*n+((t>>>16&65535)*n+i*(e>>>16&65535)<<16>>>0)|0}),Math.clz32||(Math.clz32=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,32-function(t){return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>24}(t|=t>>16)});var Nh=new Oh(1024);var Fh={getWeakMapKeys:function(t){return null}},kh="undefined"!=typeof window&&"document"in window&&"plugins"in window.document;"undefined"!=typeof navigator&&navigator.userAgent.indexOf("Firefox");vh.performance||(vh.performance={}),vh.performance.now||(vh.performance.now=function(){return Date.now()});performance.now();function Vh(t){return"string"==typeof t}function Uh(t){return"number"==typeof t}function jh(t){return(0|t)===t}function Gh(t){return"object"==typeof t||"function"==typeof t}function Qh(t){return+t}function zh(t){if("number"==typeof t)return!0;if("string"==typeof t){var e=t.charCodeAt(0);return!(65<=e&&e<=90||97<=e&&e<=122||36===e||95===e)&&(Hh(t)||function(t){return String(Number(t))===t}(t))}return!1}function Hh(t){var e=0;if("number"==typeof t)return t===(e=0|t)&&e>=0||t>>>0===t;if("string"!=typeof t)return!1;var i=t.length;if(0===i)return!1;if("0"===t)return!0;if(i>10)return!1;var n=0;if((e=t.charCodeAt(n++)-48)<1||e>9)return!1;for(var r=0,o=0;n<i;){if((o=t.charCodeAt(n++)-48)<0||o>9)return!1;r=e,e=10*e+o}return r<429496729||429496729===r&&o<=5}function Xh(t){return null==t}!function(){if("function"!=typeof vh.WeakMap){var t=0;e.prototype={has:function(t){return t.hasOwnProperty(this.id)},get:function(t,e){return t.hasOwnProperty(this.id)?t[this.id]:e},set:function(t,e){Object.defineProperty(t,this.id,{value:e,enumerable:!1,configurable:!0})},delete:function(t){delete t[this.id]}},vh.WeakMap=e}function e(){this.id="$weakmap"+t++}}();!function(){function t(){void 0!==Fh&&Fh.getWeakMapKeys?(this._map=new WeakMap,this._id=0,this._newAdditions=[]):this._list=[]}t.prototype.clear=function(){this._map?this._map.clear():this._list.length=0},t.prototype.push=function(t){this._map?(np(!this._map.has(t)),this._map.set(t,this._id++),this._newAdditions.forEach((function(e){e.push(t)}))):(np(-1===this._list.indexOf(t)),this._list.push(t))},t.prototype.remove=function(t){this._map?(np(this._map.has(t)),this._map.delete(t)):(np(this._list.indexOf(t)>-1),this._list[this._list.indexOf(t)]=null,np(-1===this._list.indexOf(t)))},t.prototype.forEach=function(t){if(this._map){var e=[];this._newAdditions.push(e);var i=this._map,n=Fh.getWeakMapKeys(i);return n.sort((function(t,e){return i.get(t)-i.get(e)})),n.forEach((function(e){0!==e._referenceCount&&t(e)})),e.forEach((function(e){0!==e._referenceCount&&t(e)})),void this._newAdditions.splice(this._newAdditions.indexOf(e),1)}for(var r=this._list,o=0,s=0;s<r.length;s++){(l=r[s])&&(0===l._referenceCount?(r[s]=null,o++):t(l))}if(o>16&&o>r.length>>2){var a=[];for(s=0;s<r.length;s++){var l;(l=r[s])&&l._referenceCount>0&&a.push(l)}this._list=a}},Object.defineProperty(t.prototype,"length",{get:function(){return this._map?-1:this._list.length},enumerable:!0,configurable:!0})}();var qh,Yh=function(){function t(e,i){void 0===e&&(e=!1),this._tab="  ",this._padding="",this._suppressOutput=e,this._out=i||t._consoleOut,this._outNoNewline=i||t._consoleOutNoNewline}return Object.defineProperty(t.prototype,"suppressOutput",{get:function(){return this._suppressOutput},set:function(t){this._suppressOutput=t},enumerable:!0,configurable:!0}),t.prototype.write=function(t,e){void 0===t&&(t=""),void 0===e&&(e=!1),this._suppressOutput||this._outNoNewline((e?this._padding:"")+t)},t.prototype.writeLn=function(t){void 0===t&&(t=""),this._suppressOutput||this._out(this._padding+t)},t.prototype.writeObject=function(t,e){void 0===t&&(t=""),this._suppressOutput||this._out(this._padding+t,e)},t.prototype.writeTimeLn=function(t){void 0===t&&(t=""),this._suppressOutput||this._out(this._padding+performance.now().toFixed(2)+" "+t)},t.prototype.writeComment=function(t){var e=(t||"").split("\n");if(1===e.length)this.writeLn("// "+e[0]);else{this.writeLn("/**");for(var i=0;i<e.length;i++)this.writeLn(" * "+e[i]);this.writeLn(" */")}},t.prototype.writeLns=function(t){for(var e=(t||"").split("\n"),i=0;i<e.length;i++)this.writeLn(e[i])},t.prototype.errorLn=function(e){1&t.logLevel&&this.boldRedLn(e)},t.prototype.warnLn=function(e){2&t.logLevel&&this.yellowLn(e)},t.prototype.debugLn=function(e){4&t.logLevel&&this.purpleLn(e)},t.prototype.logLn=function(e){8&t.logLevel&&this.writeLn(e)},t.prototype.infoLn=function(e){16&t.logLevel&&this.writeLn(e)},t.prototype.yellowLn=function(e){this.colorLn(t.YELLOW,e)},t.prototype.greenLn=function(e){this.colorLn(t.GREEN,e)},t.prototype.boldRedLn=function(e){this.colorLn(t.BOLD_RED,e)},t.prototype.redLn=function(e){this.colorLn(t.RED,e)},t.prototype.purpleLn=function(e){this.colorLn(t.PURPLE,e)},t.prototype.colorLn=function(e,i){this._suppressOutput||(kh?this._out(this._padding+i):this._out(this._padding+e+i+t.ENDC))},t.prototype.redLns=function(e){this.colorLns(t.RED,e)},t.prototype.colorLns=function(t,e){for(var i=(e||"").split("\n"),n=0;n<i.length;n++)this.colorLn(t,i[n])},t.prototype.enter=function(t){this._suppressOutput||this._out(this._padding+t),this.indent()},t.prototype.leaveAndEnter=function(t){this.leave(t),this.indent()},t.prototype.leave=function(t){this.outdent(),!this._suppressOutput&&t&&this._out(this._padding+t)},t.prototype.indent=function(){this._padding+=this._tab},t.prototype.outdent=function(){this._padding.length>0&&(this._padding=this._padding.substring(0,this._padding.length-this._tab.length))},t.prototype.writeArray=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),e=e||!1;for(var n=0,r=t.length;n<r;n++){var o="";e&&(o=null===t[n]?"null":void 0===t[n]?"undefined":t[n].constructor.name,o+=" ");var s=i?"":(""+n).padRight(" ",4);this.writeLn(s+o+t[n])}},t.PURPLE="33[94m",t.YELLOW="33[93m",t.GREEN="33[92m",t.RED="33[91m",t.BOLD_RED="33[1;91m",t.ENDC="33[0m",t.logLevel=31,t._consoleOut=console.log.bind(console),t._consoleOutNoNewline=console.log.bind(console),t}();(function(){function t(t,e,i,n){this.xMin=0|t,this.yMin=0|e,this.xMax=0|i,this.yMax=0|n}t.FromUntyped=function(e){return new t(e.xMin,e.yMin,e.xMax,e.yMax)},t.FromRectangle=function(e){return new t(20*e.x|0,20*e.y|0,20*(e.x+e.width)|0,20*(e.y+e.height)|0)},t.prototype.setElements=function(t,e,i,n){this.xMin=t,this.yMin=e,this.xMax=i,this.yMax=n},t.prototype.copyFrom=function(t){this.setElements(t.xMin,t.yMin,t.xMax,t.yMax)},t.prototype.contains=function(t,e){return t<this.xMin!=t<this.xMax&&e<this.yMin!=e<this.yMax},t.prototype.unionInPlace=function(t){t.isEmpty()||(this.extendByPoint(t.xMin,t.yMin),this.extendByPoint(t.xMax,t.yMax))},t.prototype.extendByPoint=function(t,e){this.extendByX(t),this.extendByY(e)},t.prototype.extendByX=function(t){134217728!==this.xMin?(this.xMin=Math.min(this.xMin,t),this.xMax=Math.max(this.xMax,t)):this.xMin=this.xMax=t},t.prototype.extendByY=function(t){134217728!==this.yMin?(this.yMin=Math.min(this.yMin,t),this.yMax=Math.max(this.yMax,t)):this.yMin=this.yMax=t},t.prototype.intersects=function(t){return this.contains(t.xMin,t.yMin)||this.contains(t.xMax,t.yMax)},t.prototype.isEmpty=function(){return this.xMax<=this.xMin||this.yMax<=this.yMin},Object.defineProperty(t.prototype,"width",{get:function(){return this.xMax-this.xMin},set:function(t){this.xMax=this.xMin+t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.yMax-this.yMin},set:function(t){this.yMax=this.yMin+t},enumerable:!0,configurable:!0}),t.prototype.getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return e*(this.xMax-this.xMin)+i*(this.yMax-this.yMin)},t.prototype.getBaseHeight=function(t){var e=Math.abs(Math.cos(t));return Math.abs(Math.sin(t))*(this.xMax-this.xMin)+e*(this.yMax-this.yMin)},t.prototype.setEmpty=function(){this.xMin=this.yMin=this.xMax=this.yMax=0},t.prototype.setToSentinels=function(){this.xMin=this.yMin=this.xMax=this.yMax=134217728},t.prototype.clone=function(){return new t(this.xMin,this.yMin,this.xMax,this.yMax)},t.prototype.toString=function(){return"{ xMin: "+this.xMin+", xMin: "+this.yMin+", xMax: "+this.xMax+", xMax: "+this.yMax+" }"}})(),function(){function t(t,e,i,n){np(jh(t)),np(jh(e)),np(jh(i)),np(jh(n)),this._xMin=0|t,this._yMin=0|e,this._xMax=0|i,this._yMax=0|n,this.assertValid()}t.FromUntyped=function(e){return new t(e.xMin,e.yMin,e.xMax,e.yMax)},t.FromRectangle=function(e){return new t(20*e.x|0,20*e.y|0,20*(e.x+e.width)|0,20*(e.y+e.height)|0)},t.prototype.setElements=function(t,e,i,n){this.xMin=t,this.yMin=e,this.xMax=i,this.yMax=n},t.prototype.copyFrom=function(t){this.setElements(t.xMin,t.yMin,t.xMax,t.yMax)},t.prototype.contains=function(t,e){return t<this.xMin!=t<this.xMax&&e<this.yMin!=e<this.yMax},t.prototype.unionInPlace=function(t){t.isEmpty()||(this.extendByPoint(t.xMin,t.yMin),this.extendByPoint(t.xMax,t.yMax))},t.prototype.extendByPoint=function(t,e){this.extendByX(t),this.extendByY(e)},t.prototype.extendByX=function(t){134217728!==this.xMin?(this.xMin=Math.min(this.xMin,t),this.xMax=Math.max(this.xMax,t)):this.xMin=this.xMax=t},t.prototype.extendByY=function(t){134217728!==this.yMin?(this.yMin=Math.min(this.yMin,t),this.yMax=Math.max(this.yMax,t)):this.yMin=this.yMax=t},t.prototype.intersects=function(t){return this.contains(t._xMin,t._yMin)||this.contains(t._xMax,t._yMax)},t.prototype.isEmpty=function(){return this._xMax<=this._xMin||this._yMax<=this._yMin},Object.defineProperty(t.prototype,"xMin",{get:function(){return this._xMin},set:function(t){np(jh(t)),this._xMin=t,this.assertValid()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return this._yMin},set:function(t){np(jh(t)),this._yMin=0|t,this.assertValid()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return this._xMax},set:function(t){np(jh(t)),this._xMax=0|t,this.assertValid()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._xMax-this._xMin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return this._yMax},set:function(t){np(jh(t)),this._yMax=0|t,this.assertValid()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._yMax-this._yMin},enumerable:!0,configurable:!0}),t.prototype.getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return e*(this._xMax-this._xMin)+i*(this._yMax-this._yMin)},t.prototype.getBaseHeight=function(t){var e=Math.abs(Math.cos(t));return Math.abs(Math.sin(t))*(this._xMax-this._xMin)+e*(this._yMax-this._yMin)},t.prototype.setEmpty=function(){this._xMin=this._yMin=this._xMax=this._yMax=0},t.prototype.clone=function(){return new t(this.xMin,this.yMin,this.xMax,this.yMax)},t.prototype.toString=function(){return"{ xMin: "+this._xMin+", yMin: "+this._yMin+", xMax: "+this._xMax+", yMax: "+this._yMax+" }"},t.prototype.assertValid=function(){}}(),function(){function t(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=n}t.FromARGB=function(e){return new t((e>>16&255)/255,(e>>8&255)/255,(e>>0&255)/255,(e>>24&255)/255)},t.FromRGBA=function(e){return t.FromARGB(function(t){return t>>8&16777215|(255&t)<<24}(e))},t.prototype.toRGBA=function(){return 255*this.r<<24|255*this.g<<16|255*this.b<<8|255*this.a},t.prototype.toCSSStyle=function(){return t=this.toRGBA(),"string"==typeof(e=Nh.get(t))||(e=Bh("rgba(",t>>24&255,",",t>>16&255,",",t>>8&255,",",(255&t)/255,")"),Nh.set(t,e)),e;var t,e},t.prototype.set=function(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a},t.randomColor=function(e){return void 0===e&&(e=1),new t(Math.random(),Math.random(),Math.random(),e)},t.parseColor=function(e){if(t.colorCache||(t.colorCache=Object.create(null)),t.colorCache[e])return t.colorCache[e];var i=document.createElement("span");document.body.appendChild(i),i.style.backgroundColor=e;var n=getComputedStyle(i).backgroundColor;document.body.removeChild(i);var r=/^rgb\((\d+), (\d+), (\d+)\)$/.exec(n);r||(r=/^rgba\((\d+), (\d+), (\d+), ([\d.]+)\)$/.exec(n));var o=new t(0,0,0,0);return o.r=parseFloat(r[1])/255,o.g=parseFloat(r[2])/255,o.b=parseFloat(r[3])/255,o.a=r[4]?parseFloat(r[4])/255:1,t.colorCache[e]=o},t.Red=new t(1,0,0,1),t.Green=new t(0,1,0,1),t.Blue=new t(0,0,1,1),t.None=new t(0,0,0,0),t.White=new t(1,1,1,1),t.Black=new t(0,0,0,1),t.colorCache={}}();!function(t){t[t.None=0]="None",t[t.PremultipliedAlphaARGB=1]="PremultipliedAlphaARGB",t[t.StraightAlphaARGB=2]="StraightAlphaARGB",t[t.StraightAlphaRGBA=3]="StraightAlphaRGBA",t[t.JPEG=4]="JPEG",t[t.PNG=5]="PNG",t[t.GIF=6]="GIF"}(qh||(qh={}));var Kh=function(){function t(){this.promise=new Promise(function(t,e){this.resolve=t,this.reject=e}.bind(this))}return t.prototype.then=function(t,e){return this.promise.then(t,e)},t}();"undefined"!=typeof exports&&(exports.Shumway={version:"",build:""}),function(){function t(t,e,i){t[e]||Object.defineProperty(t,e,{value:i,writable:!0,configurable:!0,enumerable:!1})}t(String.prototype,"padRight",(function(t,e){var i,n=this,r=(i=n,i.replace(/\033\[[0-9]*m/g,"")).length;if(!t||r>=e)return n;for(var o=(e-r)/t.length,s=0;s<o;s++)n+=t;return n})),t(String.prototype,"padLeft",(function(t,e){var i=this,n=i.length;if(!t||n>=e)return i;for(var r=(e-n)/t.length,o=0;o<r;o++)i=t+i;return i})),t(String.prototype,"trim",(function(){return this.replace(/^\s+|\s+$/g,"")})),t(String.prototype,"endsWith",(function(t){return-1!==this.indexOf(t,this.length-t.length)})),t(Array.prototype,"replace",(function(t,e){if(t===e)return 0;for(var i=0,n=0;n<this.length;n++)this[n]===t&&(this[n]=e,i++);return i}))}();var Wh=function(){function t(t,e){void 0===e&&(e=null),this.open=!1,this.name=t,this.settings=e||{},this.options=[]}return t.isOptionSet=function(e){return e instanceof t||!("object"!=typeof e||null===e||e instanceof Jh)&&("options"in e&&"name"in e&&"settings"in e)},t.prototype.register=function(e){if(t.isOptionSet(e))for(var i=0;i<this.options.length;i++){var n=this.options[i];if(t.isOptionSet(n)&&n.name===e.name)return n}if(this.options.push(e),this.settings)if(t.isOptionSet(e)){var r=this.settings[e.name];Gh(r)&&(e.settings=r.settings,e.open=r.open)}else if(void 0!==this.settings[e.longName])switch(e.type){case"boolean":e.value=!!this.settings[e.longName];break;case"number":e.value=+this.settings[e.longName];break;default:e.value=this.settings[e.longName]}return e},t.prototype.trace=function(t){t.enter(this.name+" {"),this.options.forEach((function(e){e.trace(t)})),t.leave("}")},t.prototype.getSettings=function(){var e={};return this.options.forEach((function(i){t.isOptionSet(i)?e[i.name]={settings:i.getSettings(),open:i.open}:e[i.longName]=i.value})),e},t.prototype.setSettings=function(e){e&&this.options.forEach((function(i){t.isOptionSet(i)?i.name in e&&i.setSettings(e[i.name].settings):i.longName in e&&(i.value=e[i.longName])}))},t}(),Jh=function(){function t(t,e,i,n,r,o){void 0===o&&(o=null),this.longName=e,this.shortName=t,this.type=i,this.defaultValue=n,this.value=n,this.description=r,this.config=o}return t.prototype.parse=function(t){this.value=t},t.prototype.trace=function(t){t.writeLn(("-"+this.shortName+"|--"+this.longName).padRight(" ",30)+" = "+this.type+" "+this.value+" ["+this.defaultValue+"] ("+this.description+")")},t}(),Zh=new Wh("Shumway Options"),$h=(Zh.register(new Wh("Logging Options")).register(new Jh("wo","warnOnce","boolean",!0,"Omit Repeated Warnings")),function(){function t(){}return t.release=!0,t.assert=np,t.error=ip,t.assertUnreachable=rp,t.assertNotImplemented=op,t.warning=ap,t.notImplemented=tp,t.dummyConstructor=up,t.warnCounts=lp,t.abstractMethod=cp,t.somewhatImplemented=ep,t.unexpected=hp,t.unexpectedCase=pp,t}());function tp(t){}function ep(t){}function ip(t){throw console.error(t),new Error(t)}function np(t,e){if(void 0===e&&(e="assertion failed"),""===t&&(t=!0),!t){if("undefined"!=typeof console&&"assert"in console)throw console.assert(!1,e),new Error(e);ip(e.toString())}}function rp(t){var e=(new Error).stack.split("\n")[1];throw new Error("Reached unreachable location "+e+t)}function op(t,e){t||ip("notImplemented: "+e)}var sp=Object.create(null);function ap(t,e,i){}function lp(){var t=[];for(var e in sp)t.push({key:e,count:sp[e]});return t.sort((function(t,e){return e.count-t.count})),t.reduce((function(t,e){return t+"\n"+e.count+"\t"+e.key}),"")}function up(t){}function cp(t){}function hp(t){np(!1,"Unexpected: "+t)}function pp(t){np(!1,"Unexpected Case: "+t)}function dp(t,e){var i=e.name;if(delete e.name,!e||!i)throw new Error("Method name should not be empty");var n=window._AWAY_DEBUG_=window._AWAY_DEBUG_||{};n.hasOwnProperty(i)&&console.warn("Overrides existed debug method definition: "+i),Object.assign(t,e),n[i]=t}var fp=[5512,11250,22500,44100],_p=new Uint8Array([82,73,70,70,0,0,0,0,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,0,0,0,0]);function mp(t,e,i,n,r){var o=n>>3,s=i*e*o,a=i*o,l=t.length+(1&t.length),u=new ArrayBuffer(_p.length+l),c=new Uint8Array(u);if(c.set(_p),r)for(var h=0,p=_p.length;h<t.length;h+=2,p+=2)c[p]=t[h+1],c[p+1]=t[h];else c.set(t,_p.length);var d=new DataView(u);return d.setUint32(4,l+36,!0),d.setUint16(22,i,!0),d.setUint32(24,e,!0),d.setUint32(28,s,!0),d.setUint16(32,a,!0),d.setUint16(34,n,!0),d.setUint32(40,l,!0),{data:c,mimeType:"audio/wav"}}function gp(t){var e,i,n=1==t.soundType?2:1,r=t.samplesCount,o=fp[t.soundRate],s=t.soundData;switch(t.soundFormat){case 0:if(e=new Float32Array(r*n),1==t.soundSize){for(var a=0,l=0;a<e.length;a++,l+=2)e[a]=(s[l]<<24|s[l+1]<<16)/2147483648;i=mp(s,o,n,16,!0)}else{for(a=0;a<e.length;a++)e[a]=(s[a]-128)/128;i=mp(s,o,n,8,!1)}break;case 3:if(e=new Float32Array(r*n),1==t.soundSize){for(a=0,l=0;a<e.length;a++,l+=2)e[a]=(s[l+1]<<24|s[l]<<16)/2147483648;i=mp(s,o,n,16,!1)}else{for(a=0;a<e.length;a++)e[a]=(s[a]-128)/128;i=mp(s,o,n,8,!1)}break;case 2:i={data:new Uint8Array(s.subarray(2)),mimeType:"audio/mpeg"};break;case 1:var u=new Int16Array(r*n);!function(t,e,i){function n(e){for(;s<e;)o=o<<8|t[r++],s+=8;return o>>>(s-=e)&(1<<e)-1}var r=0,o=0,s=0,a=0,l=n(2),u=yp[l];for(;a<e.length;){var c,h,p=e[a++]=n(16)<<16>>16,d=n(6);i>1&&(c=e[a++]=n(16)<<16>>16,h=n(6));for(var f=1<<l+1,_=0;_<4095;_++){for(var m=n(l+2),g=Ap[d],y=0,A=f>>1;A;A>>=1,g>>=1)m&A&&(y+=g);if(p+=(m&f?-1:1)*(y+g),e[a++]=p=p<-32768?-32768:p>32767?32767:p,d=(d+=u[m&~f])<0?0:d>88?88:d,i>1){m=n(l+2),g=Ap[h],y=0;for(A=f>>1;A;A>>=1,g>>=1)m&A&&(y+=g);c+=(m&f?-1:1)*(y+g),e[a++]=c=c<-32768?-32768:c>32767?32767:c,h=(h+=u[m&~f])<0?0:h>88?88:h}}}}(s,u,n),e=new Float32Array(r*n);for(a=0;a<e.length;a++)e[a]=u[a]/32768;i=mp(new Uint8Array(u.buffer),o,n,16,!new Uint8Array(new Uint16Array([1]).buffer)[0])}var c={type:"sound",id:t.id,sampleRate:o,channels:n,pcm:e,packaged:null};return i&&(c.packaged=i),c}var yp=[[-1,2],[-1,-1,2,4],[-1,-1,-1,-1,2,4,6,8],[-1,-1,-1,-1,-1,-1,-1,-1,1,2,4,6,8,10,13,16]],Ap=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767];var vp=0,bp=function(){function t(t,e,i,n){this.streamId=vp++,this.samplesCount=t,this.sampleRate=e,this.channels=i,this.streamSize=n,this.format=null,this.currentSample=0,this.allChunks=[]}return t.FromTag=function(e){var i=1==e.streamType?2:1,n=new t(e.samplesCount,fp[e.streamRate],i,e.streamSize);switch(e.streamCompression){case 0:case 3:n.format="wave",1==e.soundSize?n.decode=0===e.streamCompression?Cp:wp:n.decode=xp;break;case 2:n.format="mp3",n.decode=Ip;break;default:return null}return n},t}();function xp(t){for(var e=new Float32Array(t.length),i=0;i<e.length;i++)e[i]=(t[i]-128)/128;return this.currentSample+=e.length/this.channels,{streamId:this.streamId,samplesCount:e.length/this.channels,pcm:e,data:t,seek:0}}function Cp(t){for(var e=new Float32Array(t.length/2),i=0,n=0;i<e.length;i++,n+=2)e[i]=(t[n]<<24|t[n+1]<<16)/2147483648;return this.currentSample+=e.length/this.channels,{streamId:this.streamId,samplesCount:e.length/this.channels,pcm:e,data:t,seek:0}}function wp(t){for(var e=new Float32Array(t.length/2),i=0,n=0;i<e.length;i++,n+=2)e[i]=(t[n+1]<<24|t[n]<<16)/2147483648;return this.currentSample+=e.length/this.channels,{streamId:this.streamId,samplesCount:e.length/this.channels,pcm:e,data:t,seek:0}}function Ip(t){var e=t[1]<<8|t[0],i=t[3]<<8|t[2];return this.currentSample+=e,{streamId:this.streamId,samplesCount:e,data:new Uint8Array(t.subarray(4)),seek:i}}var Ep,Sp=function(){function t(t){this._sound=null,this._frameData=[],this._data=t,this._position=0}return Object.defineProperty(t.prototype,"currentTime",{get:function(){return this._sound.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sound",{get:function(){return this._sound},enumerable:!0,configurable:!0}),t.prototype.playFrom=function(t){this.stop(),this._sound.play(t)},t.prototype.stop=function(){this._sound&&this._sound.stop()},Object.defineProperty(t.prototype,"paused",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlaying",{get:function(){return this._sound.isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReady",{get:function(){return!!this._sound},enumerable:!0,configurable:!0}),t.prototype.queueData=function(t){t.pcm&&this._frameData.push(t)},t.prototype.finish=function(){for(var t=0,e=0;e<this._frameData.length;e++)t+=this._frameData[e].data.length;var i=new Int8Array(t);for(e=0;e<this._frameData.length;e++)i.set(this._frameData[e].data,this._position),this._position+=this._frameData[e].data.length;var n=mp(i,this._data.sampleRate,this._data.channels,this._data.streamSize,!1),r=new x(new C(n.data.buffer));this._sound=r},t}(),Dp=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.queueData=function(t){t.data&&this._frameData.push(t)},e.prototype.finish=function(){for(var t=0,e=0;e<this._frameData.length;e++)t+=this._frameData[e].data.length;var i=new Uint8Array(t);for(e=0;e<this._frameData.length;e++)i.set(this._frameData[e].data,this._position),this._position+=this._frameData[e].data.length;var n=new x(new C(i.buffer));this._sound=n},e}(Sp),Tp=function(){function t(t){this._stopped=!1,this.decode=t.decode.bind(t),this.data={sampleRate:t.sampleRate,channels:t.channels,streamSize:t.streamSize},this.seekIndex=[],this.position=0,this.isMP3="mp3"===t.format,this.soundStreamAdapter=this.isMP3?new Dp(this.data):new Sp(this.data)}return t.prototype.appendBlock=function(t,e){var i=this.decode(e),n=this.position;this.seekIndex[t]=n+i.seek;this.seekIndex[t],this.data.channels,this.data.sampleRate;this.isMP3&&this.data.channels,this.position=n+i.samplesCount,this.soundStreamAdapter.queueData(i)},Object.defineProperty(t.prototype,"stopped",{get:function(){return this._stopped},set:function(t){this._stopped=t},enumerable:!0,configurable:!0}),t.prototype.stop=function(){this.soundStreamAdapter.stop()},t.prototype.playFrame=function(e){if(this._stopped||isNaN(this.seekIndex[e]))return 0;this.isPlaying=!0,this.finalized||(this.finalized=!0,this.soundStreamAdapter.finish());var i=this.data,n=this.seekIndex[e]/i.channels/i.sampleRate,r=this.soundStreamAdapter.currentTime;this.isMP3&&(n*=i.channels),Pp.addActiveSound(this.soundStreamAdapter.sound),this.soundStreamAdapter.isPlaying||this.soundStreamAdapter.playFrom(n);return r-n<0?Math.ceil(1e3*(r-n)/(1e3/t.frameRate)):Math.floor(1e3*(r-n)/(1e3/t.frameRate))},t.frameRate=25,t}(),Pp=function(){function t(){this.lastFrameNum=-2,this._soundStreams=[],this._frameToSoundStream={}}return t.addActiveSound=function(e){t.activeSounds[e.id]||(t.activeSounds[e.id]={}),t.activeSounds[e.id].active=!0,t.activeSounds[e.id].sound=e},t.enterFrame=function(){for(var e in t.activeSounds){t.activeSounds[e].active=!1}},t.exitFrame=function(){for(var e in t.activeSounds){var i=t.activeSounds[e];i.active||(i.sound.stop(),delete t.activeSounds[e])}},t.prototype.initSoundStream=function(t){this.soundStreamHead=t},t.prototype.addSoundStreamBlock=function(t,e){this.soundStreamHead&&((0==this._soundStreams.length||t-this.lastFrameNum>1)&&this._soundStreams.push(new Tp(this.soundStreamHead)),this.lastFrameNum=t,this._soundStreams[this._soundStreams.length-1].appendBlock(t,e),this._frameToSoundStream[t]=this._soundStreams[this._soundStreams.length-1])},t.prototype.stopStream=function(t){this._frameToSoundStream[t]&&(this._frameToSoundStream[t].stopped=!0)},t.prototype.resetStreamStopped=function(){for(var t=0;t<this._soundStreams.length;t++)this._soundStreams[t].stopped=!1},t.prototype.syncSounds=function(t,e,i){return e&&i&&this._frameToSoundStream[t]&&!this._frameToSoundStream[t].stopped?this._frameToSoundStream[t].playFrame(t):0},t.activeSounds={},t}(),Bp=function(){function t(){}return t.EXACT_FIT="EXACT_FIT",t.NO_BORDER="noBorder",t.NO_SCALE="noScale",t.SHOW_ALL="showAll",t}(),Mp=function(){function t(){}return t.BOTTOM="B",t.BOTTOM_LEFT="BL",t.BOTTOM_RIGHT="BR",t.LEFT="L",t.RIGHT="R",t.TOP="T",t.TOP_LEFT="TL",t.TOP_RIGHT="TR",t}(),Op=!1;function Lp(t){Op||(Op=!0,alert("Can not connect to Server. Is Server.js running ?"))}!function(t){t.TESTING="TESTING",t.RECORDING="RECORDING"}(Ep||(Ep={}));for(var Rp=function(){function t(t,e){var i=this;this.frameIdx=0,this.snapshotCnt=0,this.snapShotsUploaded=0,this.config=t,this._avmStage=e,this.frameIdx=0,this.events={},this.reportedSWFInfos=!1,this.frames=[{messages:[],frameIdx:this.frameIdx}],this._finished=!1,this.snapshotCnt=0,this.config.recordtest&&(gh.inputRecorder=this),window.addEventListener("keydown",(function(t){t.ctrlKey&&69==t.keyCode&&i.finishTest()}))}return t.prototype.addMessage=function(t){this._finished||(this.frames[this.frames.length-1].messages.push(t),this.checkIfFinished())},t.prototype.setSWF=function(t){this.swfInfo={frameRate:t.frameRate,swfVersion:t.swfVersion,asVersion:t.useAVM1?2:3,width:t.bounds.width/20,height:t.bounds.height/20}},t.prototype.recordEvent=function(t){if(this.config.settings.snapShotOnMouseDown&&"mousedown"==t.type&&this.takeSnapshot(),this.config.settings.snapShotOnMouseUP&&"mouseup"==t.type&&this.takeSnapshot(),this.config.recordtest&&this.config.settings.recordInput){this.events[this.frameIdx]||(this.events[this.frameIdx]=[]);var e={type:t.type,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey};this.events[this.frameIdx].push(e)}},t.prototype.dispatchEvents=function(){if(!this.config.recordtest&&this.config.events&&this.config.events[this.frameIdx])for(var t=0;t<this.config.events[this.frameIdx].length;t++){var e=this.config.events[this.frameIdx][t];switch(e.preventDefault=function(){},e.type){case"click":gh.getInstance(null).onClick(e);break;case"dblclick":gh.getInstance(null).onDoubleClick(e);break;case"touchstart":gh.getInstance(null).onMouseDown(e);break;case"mousedown":this.config.settings.snapShotOnMouseDown&&this.takeSnapshot(),gh.getInstance(null).onMouseDown(e);break;case"touchmove":case"mousemove":gh.getInstance(null).onMouseMove(e);break;case"mouseup":this.config.settings.snapShotOnMouseUP&&this.takeSnapshot(),gh.getInstance(null).onMouseUp(e);break;case"touchend":gh.getInstance(null).onMouseUp(e);break;case"touchend":gh.getInstance(null).onClick(e);break;case"mousewheel":gh.getInstance(null).onMouseWheel(e);break;case"mouseover":gh.getInstance(null).onMouseOver(e);break;case"mouseout":gh.getInstance(null).onMouseOut(e);break;case"keydown":gh.getInstance(null).onKeyDown(e);break;case"keyup":gh.getInstance(null).onKeyUp(e)}}},t.prototype.closeBrowserTab=function(){this._finished&&(0==this.snapShotsUploaded&&0==this.snapshotCnt||this.snapShotsUploaded==this.snapshotCnt)&&this.finishAndUploadTest()},t.prototype.takeSnapshot=function(){if(!this._finished){var t=this,e=this.snapshotCnt++;this.addMessage("AWAYFLTEST SNAPSHOT "+e),this._avmStage.snapshot((function(i){i.toBlob((function(i){return function(i){console.log("snapshot done");var n=new FormData,r="snapshot_"+e+".png";n.append("file",i,r);var o=new XMLHttpRequest;o.onreadystatechange=function(e){4==o.readyState&&(200==o.status||0==o.status?(t.snapShotsUploaded++,t.closeBrowserTab()):Lp())},o.onerror=function(t){Lp()};try{o.open("POST","http://localhost:"+t.config.port+"/uploadImage",!0),o.send(n)}catch(t){Lp()}}(i)}))}))}},t.prototype.nextFrame=function(){this.frameIdx++,this.config.settings.stopRecAfterFrame>0&&this.frameIdx>this.config.settings.stopRecAfterFrame&&this.finishTest(),this._finished||(0!=this.config.settings.snapShotFrames&&this.frameIdx%this.config.settings.snapShotFrames==0&&this.takeSnapshot(),this.config.settings.onlyTraces||(this.frames[this.frames.length-1].messages.length>0?this.frames.push({messages:[],frameIdx:this.frameIdx}):this.frames[this.frames.length-1].frameIdx=this.frameIdx))},t.prototype.checkIfFinished=function(){if(this.config.frames){if(this.config.frames.length<this.frames.length)return void this.finishTest();for(var t=-1,e=0;e<this.config.frames.length;e++)this.config.frames[e].frameIdx==this.frames[this.frames.length-1].frameIdx&&(t=e);if(-1==t)return void this.finishTest();if(t==this.config.frames.length-1){var i=this.config.frames[t].messages.length;this.frames[this.frames.length-1].messages.length>=i&&this.finishTest()}}},t.prototype.finishTest=function(){this._finished||(this._finished=!0,this.closeBrowserTab())},t.prototype.finishAndUploadTest=function(){0==this.frames[this.frames.length-1].messages.length&&this.frames.pop();var t=window.location.pathname.split("/").pop().replace(".html",""),e={player:"awayflplayer",duration:Date.now()-this.config.startRecTime,date:(new Date).toLocaleString(),url:t,swf:this.config.swfPath,swfInfos:this.swfInfo,settings:this.config.settings,frames:this.frames,events:this.events,seed:this.config.seed},i=JSON.stringify(e),n=new FormData,r=new Blob([i],{type:"text/xml"});if(this.config.recordtest){var o=this.config.swfPath.replace(/\\/g,"/");n.append("file",r,o),n.append("record","true")}else{o=this.config.swfPath.replace(/\\/g,"/")+"/"+this.config.testPath;n.append("file",r,o)}var s=new XMLHttpRequest;s.onreadystatechange=function(t){4==s.readyState&&(200==s.status||0==s.status?console.log("AWAYFLTEST END"):Lp())},s.onerror=function(t){Lp()};try{s.open("POST","http://localhost:"+this.config.port+"/upload",!0),s.send(n)}catch(t){Lp()}},t}(),Np={},Fp=new Uint32Array(33),kp=1,Vp=0;kp<=32;++kp)Fp[kp]=Vp=Vp<<1|1;var Up,jp,Gp,Qp,zp,Hp=function(){function t(t,e,i,n){void 0===e&&(e=0),t.buffer instanceof ArrayBuffer&&(e+=t.byteOffset,t=t.buffer),void 0===i&&(i=t.byteLength-e),void 0===n&&(n=i),this.bytes=new Uint8Array(t,e,n),this.view=new DataView(t,e,n),this.pos=0,this.end=i,this.bitBuffer=0,this.bitLength=0}return t.prototype.align=function(){this.bitBuffer=this.bitLength=0},t.prototype.ensure=function(t){if(this.pos+t>this.end)throw Np},t.prototype.remaining=function(){return this.end-this.pos},t.prototype.substream=function(e,i){var n=new t(this.bytes);return n.pos=e,n.end=i,n},t.prototype.push=function(t){var e=this.bytes,i=this.end+t.length;if(i>e.length)throw"stream buffer overfow";e.set(t,this.end),this.end=i},t.prototype.readSi8=function(){return this.view.getInt8(this.pos++)},t.prototype.readSi16=function(){var t=this.view.getInt16(this.pos,!0);return this.pos+=2,t},t.prototype.readSi32=function(){var t=this.view.getInt32(this.pos,!0);return this.pos+=4,t},t.prototype.readUi8=function(){return this.bytes[this.pos++]},t.prototype.readUi16=function(){var t=this.view.getUint16(this.pos,!0);return this.pos+=2,t},t.prototype.readUi32=function(){var t=this.view.getUint32(this.pos,!0);return this.pos+=4,t},t.prototype.readFixed=function(){var t=this.view.getInt32(this.pos,!0)/65536;return this.pos+=4,t},t.prototype.readFixed8=function(){var t=this.view.getInt16(this.pos,!0)/256;return this.pos+=2,t},t.prototype.readFloat16=function(){var t=this.view.getUint16(this.pos,!1);this.pos+=2;var e=t>>15?-1:1,i=(31744&t)>>10,n=1023&t;return i?31===i?n?NaN:e*(1/0):e*Math.pow(2,i-15)*(1+n/1024):e*Math.pow(2,-14)*(n/1024)},t.prototype.readFloat=function(){var t=this.view.getFloat32(this.pos,!0);return this.pos+=4,t},t.prototype.readDouble=function(){var t=this.view.getFloat64(this.pos,!0);return this.pos+=8,t},t.prototype.readEncodedU32=function(){var t=this.bytes,e=t[this.pos++];return 128&e&&16384&(e=127&e|t[this.pos++]<<7)&&2097152&(e=16383&e|t[this.pos++]<<14)&&268435456&(e=2097151&e|t[this.pos++]<<21)?268435455&e|t[this.pos++]<<28:e},t.prototype.readBool=function(){return!!this.bytes[this.pos++]},t.prototype.readSb=function(t){return this.readUb(t)<<32-t>>32-t},t.prototype.readUb=function(t){for(var e=this.bitBuffer,i=this.bitLength,n=0;t>i;)i>24&&(n=e<<(t-=i),i=0),e=e<<8|this.bytes[this.pos++],i+=8;return n|=e>>>(i-=t)&Fp[t],this.bitBuffer=e,this.bitLength=i,n},t.prototype.readFb=function(t){return this.readSb(t)/65536},t.prototype.readString=function(t){var e,i=this.bytes,n=this.pos;if(t>-1)e=i.subarray(n,n+=t);else{t=0;for(var r=n;i[r];r++)t++;e=i.subarray(n,n+=t),n++}this.pos=n;var o=yo(e);return o.indexOf("\0")>=0&&(o=o.split("\0").join("")),o},t}();function Xp(t){return"SwfTagCode: "+t}function qp(t){t.align();var e=t.readUb(5),i=t.readSb(e),n=t.readSb(e),r=t.readSb(e),o=t.readSb(e);return t.align(),{xMin:i,xMax:n,yMin:r,yMax:o}}function Yp(t){return(t.readUi8()<<24|t.readUi8()<<16|t.readUi8()<<8|255)>>>0}function Kp(t){return t.readUi8()<<24|t.readUi8()<<16|t.readUi8()<<8|t.readUi8()}function Wp(t){var e={a:1,b:0,c:0,d:1,tx:0,ty:0};if(t.align(),t.readUb(1)){var i=t.readUb(5);e.a=t.readFb(i),e.d=t.readFb(i)}if(t.readUb(1)){i=t.readUb(5);e.b=t.readFb(i),e.c=t.readFb(i)}i=t.readUb(5);return e.tx=t.readSb(i),e.ty=t.readSb(i),t.align(),e}function Jp(t,e){var i={redMultiplier:255,greenMultiplier:255,blueMultiplier:255,alphaMultiplier:255,redOffset:0,greenOffset:0,blueOffset:0,alphaOffset:0};t.align();var n=t.readUb(1),r=t.readUb(1),o=t.readUb(4);return r&&(i.redMultiplier=t.readSb(o),i.greenMultiplier=t.readSb(o),i.blueMultiplier=t.readSb(o),e&&(i.alphaMultiplier=t.readSb(o))),n&&(i.redOffset=t.readSb(o),i.greenOffset=t.readSb(o),i.blueOffset=t.readSb(o),e&&(i.alphaOffset=t.readSb(o))),t.align(),i}function Zp(t,e,i,n){var r={code:i};if(r.actionBlocksPrecedence=t.pos,4===i)return r.symbolId=t.readUi16(),r.depth=t.readUi16(),r.flags|=4,r.matrix=Wp(t),t.pos<n&&(r.flags|=8,r.cxform=Jp(t,!1)),r;var o=r.flags=i>26?t.readUi16():t.readUi8();if(r.depth=t.readUi16(),2048&o&&(r.className=t.readString(-1)),2&o&&(r.symbolId=t.readUi16()),4&o&&(r.matrix=Wp(t)),8&o&&(r.cxform=Jp(t,!0)),16&o&&(r.ratio=t.readUi16()),32&o&&(r.name=t.readString(-1)),64&o&&(r.clipDepth=t.readUi16()),256&o)for(var s=t.readUi8(),a=r.filters=[];s--;)a.push(td(t));if(512&o&&(r.blendMode=t.readUi8()),1024&o&&(r.bmpCache=t.readUi8()),8192&o&&(r.visibility=t.readBool()),16384&o&&(r.backgroundColor=function(t){return t.readUi8()|t.readUi8()<<24|t.readUi8()<<16|t.readUi8()<<8}(t)),128&o){t.readUi16(),e>=6?t.readUi32():t.readUi16();for(var l=r.events=[],u=void 0;u=$p(t,e);){if(t.pos>n){console.log("PlaceObject handler attempted to read clip events beyond tag end"),t.pos=n;break}l.push(u)}}return r}function $p(t,e){var i=e>=6?t.readUi32():t.readUi16();if(!i)return null;var n={};6===e&&(i&=-262145),n.flags=i;var r=t.readUi32();131072&i&&(n.keyCode=t.readUi8(),r--);var o=t.pos+r;return n.actionsBlock=t.bytes.subarray(t.pos,o),t.pos=o,n}function td(t){var e={},i=e.type=t.readUi8();switch(i){case Up.DROPSHADOW:case Up.GLOW:case Up.BEVEL:case Up.GRADIENTGLOW:case Up.GRADIENTBEVEL:var n,r=e;n=i===Up.GRADIENTGLOW||i===Up.GRADIENTBEVEL?t.readUi8():i===Up.BEVEL?2:1;for(var o=r.colors=[],s=n;s--;)o.push(Kp(t));if(i===Up.GRADIENTGLOW||i===Up.GRADIENTBEVEL){var a=r.ratios=[];for(s=n;s--;)a.push(t.readUi8())}return r.blurX=t.readFixed(),r.blurY=t.readFixed(),i!==Up.GLOW&&(r.angle=t.readFixed(),r.distance=t.readFixed()),r.strength=t.readFixed8(),r.inner=!!t.readUb(1),r.knockout=!!t.readUb(1),r.compositeSource=!!t.readUb(1),i===Up.BEVEL||i===Up.GRADIENTGLOW||i===Up.GRADIENTBEVEL?(r.onTop=!!t.readUb(1),r.quality=t.readUb(4)):r.quality=t.readUb(5),r;case Up.BLUR:var l=e;return l.blurX=t.readFixed(),l.blurY=t.readFixed(),l.quality=t.readUb(5),t.readUb(3),l;case Up.CONVOLUTION:var u=e,c=u.matrixX=t.readUi8(),h=u.matrixY=t.readUi8();u.divisor=t.readFloat(),u.bias=t.readFloat();var p=u.matrix=[];for(s=c*h;s--;)p.push(t.readFloat());u.color=Kp(t);t.readUb(6);return u.clamp=!!t.readUb(1),u.preserveAlpha=!!t.readUb(1),u;case Up.COLORMATRIX:var d=e;for(p=d.matrix=[],s=20;s--;)p.push(t.readFloat());return d}return e}function ed(t,e,i){var n={code:i};return 5===i?(n.depth=t.readUi16(),n.symbolId=t.readUi16()):n.depth=t.readUi16(),n}function id(t,e,i,n,r){var o,s={code:i};if(s.id=t.readUi16(),i>21){var a=t.readUi32();90===i&&(s.deblock=t.readFixed8()),a+=t.pos,o=s.imgData=t.bytes.subarray(t.pos,a),s.alphaData=t.bytes.subarray(a,n),t.pos=n}else o=s.imgData=t.bytes.subarray(t.pos,n),t.pos=n;switch(o[0]<<8|o[1]){case 65496:case 65497:s.mimeType="image/jpeg";break;case 35152:s.mimeType="image/png";break;case 18249:s.mimeType="image/gif";break;default:s.mimeType="application/octet-stream"}return 6===i&&(s.jpegTables={data:r}),s}function nd(t,e,i,n){var r={code:i};r.id=t.readUi16();var o,s=r.characters=[];if(7==i){for(;o=rd(t,e,i);)s.push(o);r.actionsData=t.bytes.subarray(t.pos,n),t.pos=n}else{var a=t.readUi8();r.trackAsMenu=!!(a>>7&1);for(var l=t.readUi16();o=rd(t,e,i);)s.push(o);if(l){for(var u=r.buttonActions=[];t.pos<n;){var c=od(t,n);if(t.pos>n)break;u.push(c)}t.pos=n}}return r}function rd(t,e,i){var n=t.readUi8();if(!n)return null;var r={};if(e<8&&(n&=-769),r.flags=n,r.symbolId=t.readUi16(),r.depth=t.readUi16(),r.matrix=Wp(t),34===i&&(r.cxform=Jp(t,!0)),16&r.flags)for(var o=t.readUi8(),s=r.filters=[],a=o;a--;)s.push(td(t));return 32&r.flags&&(r.blendMode=t.readUi8()),r}function od(t,e){var i=t.pos,n=t.readUi16(),r=n?i+n:e,o=t.readUi16();return t.pos=r,{keyCode:(65024&o)>>9,stateTransitionFlags:511&o,actionsData:t.bytes.subarray(i+4,r)}}function sd(t,e,i){t.align();var n=t.readUb(4),r=t.readUb(4);return gd(t,e,i,!1,n,r,!1)}function ad(t,e,i){var n={code:i};n.id=t.readUi16(),n.bbox=qp(t),n.matrix=Wp(t);for(var r,o=t.readUi8(),s=t.readUi8(),a=n.records=[];r=ld(t,e,i,o,s);)a.push(r);return n}function ld(t,e,i,n,r){t.align();var o=t.readUb(8);if(!o)return null;var s={};s.flags=o,8&o&&(s.fontId=t.readUi16()),4&o&&(s.color=33===i?Kp(t):Yp(t)),1&o&&(s.moveX=t.readSi16()),2&o&&(s.moveY=t.readSi16()),8&o&&(s.fontHeight=t.readUi16());for(var a=t.readUi8(),l=s.entries=[],u=a;u--;)l.push({glyphIndex:t.readUb(n),advance:t.readSb(r)});return s}function ud(t,e,i){var n={code:i};return 15==i&&(n.soundId=t.readUi16()),89==i&&(n.soundClassName=t.readString(-1)),n.soundInfo=cd(t),n}function cd(t){var e={},i=e.flags=t.readUi8();if(1&i&&(e.inPoint=t.readUi32()),2&i&&(e.outPoint=t.readUi32()),4&i&&(e.loopCount=t.readUi16()),8&i)for(var n=t.readUi8(),r=e.envelopes=[],o=n;o--;)r.push({pos44:t.readUi32(),volumeLeft:t.readUi16(),volumeRight:t.readUi16()});return e}function hd(t,e){var i={},n=t.readUi8();i.playbackRate=n>>2&3,i.playbackSize=n>>1&1,i.playbackType=1&n;var r=t.readUi8(),o=i.streamCompression=r>>4&15;return i.streamRate=r>>2&3,i.streamSize=0==(r>>1&1)?8:16,i.streamType=1&r,i.samplesCount=t.readUi16(),2==o&&e-t.pos>=2&&(i.latencySeek=t.readSi16()),i}function pd(t,e,i,n){var r={code:i};r.id=t.readUi16();var o=r.format=t.readUi8();return r.width=t.readUi16(),r.height=t.readUi16(),r.hasAlpha=36===i,3===o&&(r.colorTableSize=t.readUi8()),r.bmpData=t.bytes.subarray(t.pos,n),t.pos=n,r}function dd(t,e,i,n){var r={code:i};r.id=t.readUi16();var o=r.flags=t.readUi8(),s=!!(4&o);e>5?r.language=t.readUi8():(o=r.flags=-65&o,t.pos+=1,r.language=0);var a=t.readUi8();r.name=t.readString(a),75===i&&(r.resolution=20);var l=t.readUi16();if(0===l)return r;var u=t.pos,c=r.offsets=[],h=l;if(8&o){for(;h--;)c.push(t.readUi32());r.mapOffset=t.readUi32()}else{for(;h--;)c.push(t.readUi16());r.mapOffset=t.readUi16()}var p=r.glyphs=[];for(h=l;h--;){1!==r.offsets[l-h]+u-t.pos?p.push(sd(t,e,i)):(t.pos+=1,p.push([]))}var d=r.codes=[];for(h=l;h--;)d.push(s?t.readUi16():t.readUi8());if(128&o){r.ascent=t.readUi16(),r.descent=t.readUi16(),r.leading=t.readSi16();var f=r.advance=[];for(h=l;h--;)f.push(t.readSi16());var _=r.bbox=[];for(h=l;h--;)_.push(qp(t));var m=t.readUi16(),g=r.kerning=[];for(h=m;h--&&n-t.pos>=2+(s?4:2);)g.push(fd(t,s))}return r}function fd(t,e){var i={};return e?(i.code1=t.readUi16(),i.code2=t.readUi16()):(i.code1=t.readUi8(),i.code2=t.readUi8()),i.adjustment=t.readUi16(),i}function _d(t,e){for(var i={code:e},n=t.readEncodedU32(),r=i.scenes=[],o=n;o--;)r.push({offset:t.readEncodedU32(),name:t.readString(-1),labels:[]});var s=t.readEncodedU32(),a=i.labels=[];for(o=s;o--;){var l={frame:t.readEncodedU32(),name:t.readString(-1)};a.push(l);for(var u=r[0],c=1;c<r.length;c++){var h=r[c];if(h.offset>l.frame)break;u=h}u.labels.push(l)}return i}function md(t,e,i,n){var r={code:i,needParse:!0},o=0;r.id=t.readUi16(),r.lineBounds=qp(t);var s=46===i||84===i;s&&(o|=8,r.lineBoundsMorph=qp(t)),(83===i||84===i)&&(r.fillBounds=qp(t),s&&(r.fillBoundsMorph=qp(t)),o|=7&t.readUi8()),r.flags=o,s&&(t.pos+=4);var a=t.substream(t.pos,t.end);return r.lazyParser=function(){r.needParse=!1,r.lazyParser=function(){return r};var t=performance.now();return function(t,e,i){var n=83===e.code||84===e.code,r=!!(8&e.flags);e.fillStyles=yd(t,i,e.code,r),e.lineStyles=bd(t,i,e.code,r,n),t.align();var o=t.readUb(4),s=t.readUb(4);e.records=gd(t,i,e.code,r,o,s,n),r&&(t.align(),o=t.readUb(4),s=t.readUb(4),e.recordsMorph=gd(t,i,e.code,r,o,s,n))}(a,r,e),r.parsingTime=performance.now()-t,r},t.pos=n,r}function gd(t,e,i,n,r,o,s){for(var a,l,u=new Array(10),c=0;;){var h={},p=h.type=t.readUb(1);if(l=t.readUb(5),!p&&!l)break;if(p)if(a=2+(15&l),32&(l=(240&l)<<1))if(h.isGeneral=t.readUb(1))l|=64,h.deltaX=t.readSb(a),h.deltaY=t.readSb(a);else(h.isVertical=t.readUb(1))?(l|=128,h.deltaY=t.readSb(a)):h.deltaX=t.readSb(a);else h.controlDeltaX=t.readSb(a),h.controlDeltaY=t.readSb(a),h.anchorDeltaX=t.readSb(a),h.anchorDeltaY=t.readSb(a);else i<=2&&(l&=-17),1&l&&(a=t.readUb(5),h.moveX=t.readSb(a),h.moveY=t.readSb(a)),2&l&&(h.fillStyle0=t.readUb(r)),4&l&&(h.fillStyle1=t.readUb(r)),8&l&&(h.lineStyle=t.readUb(o)),16&l&&(h.fillStyles=yd(t,e,i,n),h.lineStyles=bd(t,e,i,n,s),t.align(),r=t.readUb(4),o=t.readUb(4));h.flags=l,u[c++]=h}return u.length>c&&(u.length=c),u}function yd(t,e,i,n){var r=t.readUi8();i>2&&255===r&&(r=t.readUi16());for(var o=[],s=r;s--;)o.push(Ad(t,e,i,n));return o}function Ad(t,e,i,n){var r={},o=r.type=t.readUi8();switch(o){case 0:var s=r;return s.color=i>22||n?Kp(t):Yp(t),n&&(s.colorMorph=Kp(t)),s;case 16:case 18:case 19:var a=r;a.matrix=Wp(t),n&&(a.matrixMorph=Wp(t)),83===i?(a.spreadMode=t.readUb(2),a.interpolationMode=t.readUb(2)):t.readUb(4);for(var l=t.readUb(4),u=a.records=[],c=l;c--;)u.push(vd(t,i,n));return 19===o&&(a.focalPoint=t.readSi16(),n&&(a.focalPointMorph=t.readSi16())),a;case 64:case 65:case 66:case 67:var h=r;return h.bitmapId=t.readUi16(),h.condition=64===o||67===o,h.matrix=Wp(t),n&&(h.matrixMorph=Wp(t)),h}return r}function vd(t,e,i){var n={};return n.ratio=t.readUi8(),n.color=e>22?Kp(t):Yp(t),i&&(n.ratioMorph=t.readUi8(),n.colorMorph=Kp(t)),n}function bd(t,e,i,n,r){var o=t.readUi8();i>2&&255===o&&(o=t.readUi16());for(var s=[],a=o;a--;){var l={};if(l.width=t.readUi16(),n&&(l.widthMorph=t.readUi16()),r){t.align(),l.startCapsStyle=t.readUb(2);var u=l.jointStyle=t.readUb(2),c=l.hasFill=t.readUb(1);l.noHscale=!!t.readUb(1),l.noVscale=!!t.readUb(1),l.pixelHinting=!!t.readUb(1),t.readUb(5),l.noClose=!!t.readUb(1),l.endCapsStyle=t.readUb(2),2===u&&(l.miterLimitFactor=t.readFixed8()),c?l.fillStyle=Ad(t,0,i,n):(l.color=Kp(t),n&&(l.colorMorph=Kp(t)))}else l.color=i>22?Kp(t):Yp(t),n&&(l.colorMorph=Kp(t));s.push(l)}return s}!function(t){t[t.DROPSHADOW=0]="DROPSHADOW",t[t.BLUR=1]="BLUR",t[t.GLOW=2]="GLOW",t[t.BEVEL=3]="BEVEL",t[t.GRADIENTGLOW=4]="GRADIENTGLOW",t[t.CONVOLUTION=5]="CONVOLUTION",t[t.COLORMATRIX=6]="COLORMATRIX",t[t.GRADIENTBEVEL=7]="GRADIENTBEVEL"}(Up||(Up={})),function(t){t[t.CODE_DEFINE_SHAPE=2]="CODE_DEFINE_SHAPE",t[t.CODE_DEFINE_BITS=6]="CODE_DEFINE_BITS",t[t.CODE_DEFINE_BUTTON=7]="CODE_DEFINE_BUTTON",t[t.CODE_DEFINE_FONT=10]="CODE_DEFINE_FONT",t[t.CODE_DEFINE_TEXT=11]="CODE_DEFINE_TEXT",t[t.CODE_DEFINE_SOUND=14]="CODE_DEFINE_SOUND",t[t.CODE_DEFINE_BITS_LOSSLESS=20]="CODE_DEFINE_BITS_LOSSLESS",t[t.CODE_DEFINE_BITS_JPEG2=21]="CODE_DEFINE_BITS_JPEG2",t[t.CODE_DEFINE_SHAPE2=22]="CODE_DEFINE_SHAPE2",t[t.CODE_DEFINE_SHAPE3=32]="CODE_DEFINE_SHAPE3",t[t.CODE_DEFINE_TEXT2=33]="CODE_DEFINE_TEXT2",t[t.CODE_DEFINE_BUTTON2=34]="CODE_DEFINE_BUTTON2",t[t.CODE_DEFINE_BITS_JPEG3=35]="CODE_DEFINE_BITS_JPEG3",t[t.CODE_DEFINE_BITS_LOSSLESS2=36]="CODE_DEFINE_BITS_LOSSLESS2",t[t.CODE_DEFINE_EDIT_TEXT=37]="CODE_DEFINE_EDIT_TEXT",t[t.CODE_DEFINE_SPRITE=39]="CODE_DEFINE_SPRITE",t[t.CODE_DEFINE_MORPH_SHAPE=46]="CODE_DEFINE_MORPH_SHAPE",t[t.CODE_DEFINE_FONT2=48]="CODE_DEFINE_FONT2",t[t.CODE_DEFINE_VIDEO_STREAM=60]="CODE_DEFINE_VIDEO_STREAM",t[t.CODE_DEFINE_FONT3=75]="CODE_DEFINE_FONT3",t[t.CODE_DEFINE_SHAPE4=83]="CODE_DEFINE_SHAPE4",t[t.CODE_DEFINE_MORPH_SHAPE2=84]="CODE_DEFINE_MORPH_SHAPE2",t[t.CODE_DEFINE_BINARY_DATA=87]="CODE_DEFINE_BINARY_DATA",t[t.CODE_DEFINE_BITS_JPEG4=90]="CODE_DEFINE_BITS_JPEG4",t[t.CODE_DEFINE_FONT4=91]="CODE_DEFINE_FONT4"}(jp||(jp={})),function(t){t[t.CODE_DEFINE_BITS=6]="CODE_DEFINE_BITS",t[t.CODE_DEFINE_BITS_JPEG2=21]="CODE_DEFINE_BITS_JPEG2",t[t.CODE_DEFINE_BITS_JPEG3=35]="CODE_DEFINE_BITS_JPEG3",t[t.CODE_DEFINE_BITS_JPEG4=90]="CODE_DEFINE_BITS_JPEG4"}(Gp||(Gp={})),function(t){t[t.CODE_DEFINE_FONT=10]="CODE_DEFINE_FONT",t[t.CODE_DEFINE_FONT2=48]="CODE_DEFINE_FONT2",t[t.CODE_DEFINE_FONT3=75]="CODE_DEFINE_FONT3",t[t.CODE_DEFINE_FONT4=91]="CODE_DEFINE_FONT4"}(Qp||(Qp={})),function(t){t[t.CODE_PLACE_OBJECT=4]="CODE_PLACE_OBJECT",t[t.CODE_PLACE_OBJECT2=26]="CODE_PLACE_OBJECT2",t[t.CODE_PLACE_OBJECT3=70]="CODE_PLACE_OBJECT3",t[t.CODE_REMOVE_OBJECT=5]="CODE_REMOVE_OBJECT",t[t.CODE_REMOVE_OBJECT2=28]="CODE_REMOVE_OBJECT2",t[t.CODE_START_SOUND=15]="CODE_START_SOUND",t[t.CODE_START_SOUND2=89]="CODE_START_SOUND2",t[t.CODE_VIDEO_FRAME=61]="CODE_VIDEO_FRAME"}(zp||(zp={}));var xd={0:void 0,1:void 0,2:md,4:Zp,5:ed,6:id,7:nd,8:void 0,9:void 0,10:function(t,e,i){var n={code:i};n.id=t.readUi16();for(var r=t.readUi16(),o=r/2,s=[],a=o-1;a--;)s.push(t.readUi16());n.offsets=[r].concat(s);var l=n.glyphs=[];for(a=o;a--;)l.push(sd(t,e,i));return n},11:ad,12:void 0,13:void 0,14:function(t,e,i,n){var r={code:i};r.id=t.readUi16();var o=t.readUi8();return r.soundFormat=o>>4&15,r.soundRate=o>>2&3,r.soundSize=o>>1&1,r.soundType=1&o,r.samplesCount=t.readUi32(),r.soundData=t.bytes.subarray(t.pos,n),t.pos=n,r},15:ud,17:void 0,18:void 0,19:void 0,20:pd,21:id,22:md,23:void 0,24:void 0,26:Zp,28:ed,32:md,33:ad,34:nd,35:id,36:pd,37:function(t,e,i){var n={code:i};n.id=t.readUi16(),n.bbox=qp(t);var r=n.flags=t.readUi16();return 1&r&&(n.fontId=t.readUi16()),32768&r&&(n.fontClass=t.readString(-1)),1&r&&(n.fontHeight=t.readUi16()),4&r&&(n.color=Kp(t)),2&r&&(n.maxLength=t.readUi16()),8192&r&&(n.align=t.readUi8(),n.leftMargin=t.readUi16(),n.rightMargin=t.readUi16(),n.indent=t.readSi16(),n.leading=t.readSi16()),n.variableName=t.readString(-1),128&r&&(n.initialText=t.readString(-1)),n},39:void 0,43:void 0,45:void 0,46:md,48:dd,56:void 0,57:void 0,58:void 0,59:void 0,60:function(t,e,i){var n={code:i};return n.id=t.readUi16(),n.numFrames=t.readUi16(),n.width=t.readUi16(),n.height=t.readUi16(),t.readUb(4),n.deblocking=t.readUb(3),n.smoothing=!!t.readUb(1),n.codecId=t.readUi8(),n},61:function(t,e,i,n){var r={code:i};return r.streamId=t.readUi16(),r.frameNum=t.readUi16(),r.videoData=t.bytes.subarray(t.pos,n),t.pos=n,r},62:void 0,64:void 0,65:void 0,66:void 0,69:void 0,70:Zp,71:void 0,72:void 0,73:void 0,74:void 0,75:dd,76:void 0,77:void 0,78:function(t,e,i){var n={code:i};return n.symbolId=t.readUi16(),n.splitter=qp(t),n},82:void 0,83:md,84:md,86:_d,87:function(t,e,i,n){var r={code:i};return r.id=t.readUi16(),t.pos+=4,r.data=t.bytes.subarray(t.pos,n),t.pos=n,r},88:void 0,89:ud,90:id,91:function(t,e,i,n){var r={code:i};r.id=t.readUi16();var o=r.flags=t.readUi8();return r.name=t.readString(-1),4&o&&(r.data=t.bytes.subarray(t.pos,n),t.pos=n),r}};function Cd(t){var e=t.readUb(5),i=t.readSb(e),n=t.readSb(e),r=t.readSb(e),o=t.readSb(e);t.align();var s=t.readUi8();return{frameRate:t.readUi8()+s/256,frameCount:t.readUi16(),bounds:new fo(i,r,n,o)}}function wd(t,e){var i=8&t.flags;return t.parser=e,t.type=i?"morphshape":"shape",t}var Id=Math.pow,Ed=Math.log,Sd=String.fromCharCode;function Dd(t){for(var e=0,i=t;i>=2;)i/=2,++e;return Id(2,e)}function Td(t){return Sd(t>>8&255,255&t)}function Pd(t,e){var i="swf-font-"+t.id,n=t.name||i;"Helvetica"==n&&(n="arial");var r=wc.defineFont(n,e),o={type:"font",id:t.id,name:n,bold:!!(1&t.flags),italic:!!(2&t.flags),codes:t.codes,metrics:null,data:t.data,originalSize:!1,away:r,fontStyleName:yc.STANDART};r.name=n;var s=yc.STANDART;o.fontStyleName=s;var a=r.get_font_table(s,Dc.assetType),l=t.glyphs,u=l?l.length:0;if(!u)return o;var c=[],h={},p=[],d=!("advance"in t),f=48===t.code,_=75===t.code;d&&(t.advance=[]);var m=Math.max.apply(null,t.codes)||35;if(t.codes){for(var g=0;g<t.codes.length;g++){((E=t.codes[g])<32||E in h)&&(8232==++m&&(m=8240),E=m),c.push(E),h[E]=g}c.sort((function(t,e){return t-e}));var y;for(g=0;void 0!==(E=c[g++]);){var A=I=E;for(y=[g-1];void 0!==(E=c[g])&&A+1===E;)++A,y.push(g),++g;p.push([I,A,y])}}else{y=[];for(g=0;g<u;g++)E=57344+g,c.push(E),h[E]=g,y.push(g);p.push([57344,57344+u-1,y])}var v=t.resolution||1;f&&function(t){for(var e=0,i=0,n=0,r=0,o=0;o<t.length;o++){var s=t[o];if(s)for(var a,l=0,u=0,c=0;c<s.length;c++)(a=s[c]).type?32&a.flags?(l+=a.deltaX||0,u+=-(a.deltaY||0)):(l+=a.controlDeltaX,u+=-a.controlDeltaY,l+=a.anchorDeltaX,u+=-a.anchorDeltaY):1&a.flags&&(l=a.moveX,u=-a.moveY),e>l&&(e=l),i>u&&(i=u),n<l&&(n=l),r<u&&(r=u)}return Math.max(n-e,r-i)>5e3}(l)&&(v=20,o.originalSize=!0);var b=Math.ceil(t.ascent/v)||1024,x=-Math.ceil(t.descent/v)||0;0!=a.ascent||(a.ascent=b,a.descent=x);var C,w=a.ascent;for(t.leading,g=0;C=p[g++];)var I=C[0],E=(A=C[1],C[2][0]);for(var S=2*Dd(p.length+1),D=[],T=(g=0,{});void 0!==(E=c[g++]);){for(var P=l[h[E]],B=0,M=0,O=[],L=-1,R=0;R<P.length;R++){if((et=P[R]).type)if(L<0&&(O[L=0]={data:[],commands:[],xMin:0,xMax:0,yMin:0,yMax:0}),32&et.flags)O[L].commands.push(2),B+=(et.deltaX||0)/v,M+=-(et.deltaY||0)/v,O[L].data.push(B,M);else O[L].commands.push(3),B+=J=et.controlDeltaX/v,M+=Z=-et.controlDeltaY/v,O[L].data.push(B,M),B+=et.anchorDeltaX/v,M+=-et.anchorDeltaY/v,O[L].data.push(B,M);else if(1&et.flags){O[++L]={data:[],commands:[],xMin:0,xMax:0,yMin:0,yMax:0},O[L].commands.push(1);var N=et.moveX/v,F=-et.moveY/v;B=N,M=F,O[L].data.push(B,M)}L>-1&&(O[L].xMin>B&&(O[L].xMin=B),O[L].yMin>M&&(O[L].yMin=M),O[L].xMax<B&&(O[L].xMax=B),O[L].yMax<M&&(O[L].yMax=M))}_||O.sort((function(t,e){return(e.xMax-e.xMin)*(e.yMax-e.yMin)-(t.xMax-t.xMin)*(t.yMax-t.yMin)})),T[E]=O}var k=0;for(g=0;void 0!==(E=c[g++]);){var V=new wa,U=h[E];P=l[U];O=T[E];B=0,M=0;var j=0,G=-1024,Q=0,z=-1024,H=(L=-1,[]),X=[];for(R=0;R<O.length;R++)H=H.concat(O[R].data),X=X.concat(O[R].commands);B=0,M=0;var q=0,Y=0,K=0;for(R=0;R<X.length;R++){var W=X[R];if(1===W){q=H[K++],Y=H[K++];V.moveTo(q,-1*Y+w),B=q,M=Y}else if(2===W){q=H[K++],Y=H[K++];B=q,M=Y,V.lineTo(q,-1*Y+w)}else if(3===W){var J=(q=H[K++])-B,Z=(Y=H[K++])-M;B=q,M=Y;J=q,Z=Y,q=H[K++],Y=H[K++];B=q,M=Y,V.curveTo(J,-1*Z+w,q,-1*Y+w)}j>B&&(j=B),Q>M&&(Q=M),G<B&&(G=B),z<M&&(z=M)}R||(j=G=Q=z=0),D.push(Q);var $=0;d?(t.advance.push((G-j)*v*1.3),$=G-j):($=t.advance[U]/v)<0&&($=Math.abs($)),32==E&&(k=t.advance[U]/v)<0&&(k=Math.abs(k)),a.setChar(E.toString(),$,null,null,!1,U,V)}if(!_){var tt=Math.min.apply(null,D);tt<0&&(x=x||tt)}if(t.kerning&&t.kerning.length){var et,it=t.kerning,nt=it.length;for(S=2*Dd(nt),Td(14+6*nt),Td(nt),Td(S),Td(Ed(nt)/Ed(2)),Td(2*nt-S),g=0;et=it[g++];)Td(h[et.code1])+Td(h[et.code2])+Td(et.adjustment)}return a.set_font_em_size(1024),k&&a.set_whitespace_width(k),o}function Bd(t){return{type:"text",id:t.id,fillBounds:t.bbox,variableName:t.variableName,tag:t,bold:!1,italic:!1}}function Md(t,e){for(var i,n=t.characters,r={up:[],over:[],down:[],hitTest:[]},o=0;i=n[o++];){var s=e[i.symbolId];if(s){var a={symbolId:s.id,code:4,depth:i.depth,flags:0,matrix:null,cxform:null};i.matrix&&(a.flags|=4,a.matrix=i.matrix),i.cxform&&(a.flags|=8,a.cxform=i.cxform),1&i.flags&&r.up.push(a),2&i.flags&&r.over.push(a),4&i.flags&&r.down.push(a),8&i.flags&&r.hitTest.push(a)}else console.log("undefined character in button "+t.id)}return{type:"button",id:t.id,buttonActions:t.buttonActions,states:r}}function Od(t){var e=t.width,i=t.height,n=t.hasAlpha,r=function(t){return t+3&-4}(e)-e,o=n?4:3,s=(t.colorTableSize+1)*o,a=s+(e+r)*i,l=Uo.inflate(t.bmpData,a,!0),u=new Uint32Array(e*i),c=s,h=0,p=0;if(n)for(var d=0;d<i;d++){for(var f=0;f<e;f++){var _=l[(p=l[c++]<<2)+3],m=_/255;u[h++]=(_<<24|(l[p+2]*m|0)<<16|(l[p+1]*m|0)<<8|l[p+0]*m|0)>>>0}c+=r}else for(d=0;d<i;d++){for(f=0;f<e;f++)p=l[c++]*o,u[h++]=(255<<24|l[p+2]<<16|l[p+1]<<8|l[p+0])>>>0;c+=r}return new Uint8ClampedArray(u.buffer)}function Ld(t){for(var e=t.width,i=t.height*e*4,n=Uo.inflate(t.bmpData,i,!0),r=new Uint32Array(n.buffer),o=0,s=r.length;o<s;o++){var a=r[o],l=255&a,u=a>>24&255,c=a>>16&255,h=a>>8&255;r[o]=(l<<24|u<<16|c<<8|h)>>>0}return new Uint8ClampedArray(n.buffer)}function Rd(t){return console.log("parse15BPP"),null}function Nd(t){var e,i=po.None;switch(t.format){case 3:e=Od,i=po.PremultipliedAlphaARGB;break;case 5:e=Ld,i=po.PremultipliedAlphaARGB;break;case 4:e=Rd,i=po.PremultipliedAlphaARGB;break;default:console.log("invalid bitmap format")}var n={definition:{type:"image",id:t.id,width:t.width,height:t.height,mimeType:"application/octet-stream",data:null,dataType:i,isPMA:i===po.PremultipliedAlphaARGB,image:null},needParse:!0,lazyParser:function(){var i=this;return this.needParse=!1,this.definition.data=e(t),this.lazyParser=function(){return i},n},type:"image",id:t.id};return n}function Fd(t,e){return t[e]<<8|t[e+1]}function kd(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function Vd(t,e){for(var i=0,n=t.length;i<n&&(255!==t[i]||i+1<n&&(0===t[i+1]||255===t[i+1]));)++i;if(!(i>=n))do{var r=i++,o=t[i++];if(o>=192&&o<=199||o>=201&&o<=207||o>=218&&o<=239||254===o)i+=Fd(t,i);for(;i<n&&(255!==t[i]||i+1<n&&(0===t[i+1]||255===t[i+1]));)++i;216!==o&&217!==o&&e.push(t.subarray(r,i))}while(i<n)}var Ud=new Uint8Array([255,216]),jd=new Uint8Array([255,217]);function Gd(t){var e={type:"image",id:t.id,mimeType:t.mimeType},i=t.imgData;if("image/jpeg"===t.mimeType){var n=[];n.push(Ud),Vd(i,n),t.jpegTables&&function(t,e){if(!e.parsedChunks){var i=[];Vd(e.data,i),e.parsedChunks=i}for(var n=0;n<t.length&&!(t[n][1]>=192&&t[n][1]<=192);)n++;Array.prototype.splice.apply(t,Array.prototype.concat.call([n,0],e.parsedChunks))}(n,t.jpegTables),n.push(jd),n.forEach((function(t){var i=t[1];i>=192&&i<=195&&(e.height=Fd(t,5),e.width=Fd(t,7))})),e.data=function(t){for(var e=0,i=0;i<t.length;i++)e+=t[i].length;var n=new Uint8Array(e),r=0;for(i=0;i<t.length;i++){var o=t[i];n.set(o,r),r+=o.length}return n}(n),e.dataType=po.JPEG;var r=t.alphaData;if(r){var o=e.width*e.height;try{e.alphaData=Uo.inflate(r,o,!0)}catch(t){e.alphaData=new Uint8Array(o)}}}else!function(t,e){if(73===e[12]&&72===e[13]&&68===e[14]&&82===e[15]){t.width=kd(e,16),t.height=kd(e,20);var i=e[26];t.hasAlpha=4===i||6===i}}(e,i),e.data=i,e.dataType=po.PNG;return e}function Qd(t){return{type:"label",id:t.id,fillBounds:t.bbox,matrix:t.matrix,tag:{hasText:!0,initialText:"",html:!0,readonly:!0},records:t.records,coords:null,static:!0,require:null}}var zd=function(t,e,i,n,r,o,s){t&&Object.freeze(t),this.controlTags=t,this.labelNames=e,r&&Object.freeze(r),this.soundStreamHead=i,this.soundStreamBlock=n,this.actionBlocks=r,o&&Object.freeze(o),this.initActionBlocks=o,this.buttonStateName="",s&&Object.freeze(s),this.exports=s},Hd=self.requestIdleCallback||self.requestAnimationFrame,Xd=[],qd=-1,Yd=0,Kd=0;function Wd(){qd=-1;var t=performance.now(),e=0,i=0,n=!1;for(0===Kd&&(n=!0),Kd=t;!(!(Yd<Xd.length)||n||(e+=Jd())>4||++i>=8););Yd>1&&(Xd.splice(0,Yd),Yd=0,0===Xd.length)||(qd=Hd(Wd))}function Jd(){for(var t;t&&(!t.lazyParser||!t.needParse);)t=Xd[Yd],Yd++;if(!t)return 0;var e=performance.now();return t.lazyParser(),t.needParse=!1,t.lazyTaskDone&&t.lazyTaskDone(t),performance.now()-e}function Zd(t,e,i){return t[e++]=i.a,t[e++]=i.b,t[e++]=i.c,t[e++]=i.d,t[e++]=i.tx/20,t[e++]=i.ty/20,e}var $d=[Ac.LEFT,Ac.RIGHT,Ac.CENTER,Ac.JUSTIFY],tf=function(){function t(t){this.parser=t,this._awaySymbols={},this._buttonIds={},this._mcIds={},this.reqursive=!0}return Object.defineProperty(t.prototype,"factory",{get:function(){return this.parser.factory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"awaySymbols",{get:function(){return this._awaySymbols},enumerable:!0,configurable:!0}),t.prototype.prepareFrameScriptsForAVM1=function(t,e,i,n){return this.parser.swfFile.useAVM1?this.parser.factory.createFrameScripts(t,e,i,n):t},t.prototype.createChildInstanceForTimeline=function(t,e,i){el.invalidAS3Constructors=!0;var n,r=this.awaySymbols[e];if(r.isAsset(Sa))(n=ka.getNewSprite(r)).mouseEnabled=!1;else if(r.isAsset(ka))(n=ka.getNewSprite(r.graphics)).mouseEnabled=!1;else if(r.isAsset(Va))(n=Va.getNewMorphSprite(r.graphics)).mouseEnabled=!1;else if(r.isAsset(hn)){var o=new ac(r);o.alphaBlending=r.transparent,n=za.getNewBillboard(o)}else n=r.adapter.clone(!1).adaptee;if(this.parser.swfFile.useAVM1){var s=t.placeObjectTagsForSessionIDs[i];s&&(s.variableName||s.events&&s.events.length>0)&&(n.adapter.placeObjectTag=s,n.adapter.initEvents=s)}return n._sessionID=i,n},t.prototype._createShape=function(t,e,i){var n,r=new Sa;return(n=t).lazyParser&&n.needParse&&(Xd.push(n),qd>=0||(qd=Hd(Wd))),r.queueShapeTag(t),r.name=i||"AwayJS_shape_"+t.id.toString(),r.className=t.className,"morphshape"===t.type?new Va(r):r},t.prototype._createFont=function(t,e,i){return t.away.className=t.className,t.className&&wc.registerFontForClassName(t.away,t.className),t},t.prototype._createSprite=function(t,e,i){var n=this.framesToTimeline(e,t,t.frames,null,null);return t.scalingGrid&&(n.scale9Grid=new Y(t.scalingGrid.xMin/20,t.scalingGrid.yMin/20,t.scalingGrid.xMax/20,t.scalingGrid.yMax/20)),n.className=t.className,n.name=i||"AwayJS_mc_"+t.id.toString(),n.buttonMode?this._buttonIds[t.id]=!0:this._mcIds[t.id]=!0,n},t.prototype._createText=function(t,e,i){(e=e||this.factory.createTextField(t))._symbol=t,e.textFormat=new Pc,e.className=t.className;var n=this.reqursive?this.createAwaySymbol(t.tag.fontId):this._awaySymbols[t.tag.fontId];n&&(e.textFormat.font=n.away,e.textFormat.font_table=n.away.get_font_table(n.fontStyleName,Dc.assetType));var r=t.tag;return e.textFormat.size=r.fontHeight/20,e.textColor=4&r.flags?w.f32_RGBA_To_f32_ARGB(r.color):16777215,e.textFormat.leftMargin=r.leftMargin/20,e.textFormat.rightMargin=r.rightMargin/20,e.textFormat.letterSpacing=r.letterSpacing/20,e.textFormat.leading=r.leading/20,e.textFormat.align=$d[r.align],e.textOffsetX=t.fillBounds.xMin/20,e.textOffsetY=t.fillBounds.yMin/20,e.width=(t.fillBounds.xMax-t.fillBounds.xMin)/20,e.height=(t.fillBounds.yMax-t.fillBounds.yMin)/20,e.border=!!(2048&r.flags),e.background=e.border,e.multiline=!!(32&r.flags),e.wordWrap=!!(64&r.flags),e.selectable=!!r.flags&&!(4096&r.flags),r.maxLength&&r.maxLength>0&&(e.maxChars=r.maxLength),8&r.flags?e.type="dynamic":e.type="input",512&r.flags?(e.html=!0,r.initialText&&""!=r.initialText&&(e.htmlText=r.initialText)):(e.html=!1,r.initialText&&""!=r.initialText&&(e.text=r.initialText)),e.name=i||"tf_"+t.id.toString(),e},t.prototype._createSound=function(t,e,i){var n=this.parser.awayUnresolvedSymbols[t.id];return n?(n.className=this.parser.symbolClassesMap[t.id]||null,n.name=n.className):console.warn("SWF-parser: no sound loaded for sound-id:",t.id),n},t.prototype._createButton=function(t,e,i){return(e=this.framesToTimeline(e,t,null,t.states,t.buttonActions,t.buttonSounds)).name=i||"AwayJS_button_"+t.id.toString(),e.className=t.className,this._buttonIds[t.id]=!0,e},t.prototype._createLabel=function(t,e,i){var n=null,r=!1;(e=e||this.factory.createTextField(t)).className=t.className;for(var o=0;o<t.records.length;o++){var s=t.records[o];s.fontId&&(n=this.reqursive?this.createAwaySymbol(s.fontId):this._awaySymbols[s.fontId])&&(s.font=n,s.font_table=n.away.get_font_table(n.fontStyleName,Dc.assetType),s.font_table||(r=!0,console.log("no font_table set")))}return e.staticMatrix=t.matrix,e.textOffsetX=t.fillBounds.xMin/20,e.textOffsetY=t.fillBounds.yMin/20,e.width=t.fillBounds.xMax/20-t.fillBounds.xMin/20-1,e.height=t.fillBounds.yMax/20-t.fillBounds.yMin/20-1,r||e.setLabelData(t),e.name=i||"AwayJS_label_"+t.id.toString(),e.selectable=t.tag.flags&&!(4096&t.tag.flags),e},t.prototype._createImage=function(t,e,i){if(!(e=e||this.parser.awayUnresolvedSymbols[t.id])&&t.definition){var n=t.definition;(e=new hn(n.width,n.height,!0,null,!1)).addLazySymbol(t)}return e&&(e.className=this.parser.symbolClassesMap[t.id]?this.parser.symbolClassesMap[t.id]:t.className,e.name=e.className),e},t.prototype._createBinary=function(t,e,i){return this.factory.createBinarySymbol&&this.factory.createBinarySymbol(t),null},t.prototype._createVideo=function(t,e,i){var n=new hn(t.width,t.height,!1,65280,!1);return n._symbol=t,n.className=this.parser.symbolClassesMap[t.id]?this.parser.symbolClassesMap[t.id]:t.className,n.name=n.className,n},t.prototype.createAwaySymbol=function(t,e,i){if("number"==typeof t){if(!e&&this._awaySymbols[t])return this._awaySymbols[t];t=this.parser.getSymbol(t)}if(!t)throw new Error("Symbol can't be null");if(!e&&this._awaySymbols[t.id])return this._awaySymbols[t.id];var n;switch(t.type){case"morphshape":n=this._createShape(t,e,i||"AwayJS_morphshape_"+t.id.toString());break;case"shape":n=this._createShape(t,e,i);break;case"font":n=this._createFont(t,e,i);break;case"sprite":n=this._createSprite(t,e,i);break;case"text":n=this._createText(t,e,i);break;case"sound":n=this._createSound(t,e,i);break;case"button":n=this._createButton(t,e,i);break;case"label":n=this._createLabel(t,e,i);break;case"image":n=this._createImage(t,e,i);break;case"binary":n=this._createBinary(t,e,i);break;case"video":n=this._createVideo(t,e,i);break;default:throw Error("Unknown symbol type:"+t.type)}return this._awaySymbols[t.id]=n,this.parser.registerAwayAsset(n,t),n},t.prototype.framesToTimeline=function(t,e,i,n,r,o){var s=this;if(void 0===o&&(o=null),!n&&!i)throw"error when creating timeline - neither movieclip frames nor button-states present";var a,l=this.reqursive?function(t){return s._awaySymbols[t]||s.createAwaySymbol(t)}:function(t){return s._awaySymbols[t]},u=!1;if(e.isButton=!1,n&&!i)for(a in u=!0,e.isButton=!0,i=[],n){var c=new zd;c.controlTags=n[a],c.buttonStateName=a,i[i.length]=c}(t=t||this.factory.createMovieClip(null,e)).symbolID=e.id;var h=0,p=t.timeline;t.timeline.symbolDecoder=this;var d,f,_,m,g,y,A,v,b,x,C,w,I,E,S,D,T,P=[],B=[],M=[],O=[],L=[],R=[],N=[],F=[],k=[],V=[],U=[],j=[],G=[],Q=[],z=[],H=[],X=[],q=[],Y={},K=0,W=[],J=[],Z=[],$=[],tt=[],et=[],it={},nt=0,rt=i.length,ot=0,st=0,at=null,lt=-1,ut=-1,ct=-1,ht=!0;for(il.movieClipSoundsManagerClass=Pp,f=0;f<rt;f++){if(W.length=0,J.length=0,Z.length=0,$.length=0,tt.length=0,et.length=0,i[f].soundStreamHead&&t.initSoundStream(i[f].soundStreamHead,rt),i[f].soundStreamBlock&&t.addSoundStreamBlock(f,i[f].soundStreamBlock),i[f].initActionBlocks&&(p.avm1InitActions[f]=i[f].initActionBlocks),i[f].exports)for(a in p.avm1Exports[f]=i[f].exports,i[f].exports){var pt=i[f].exports[a],dt=l(pt.symbolId);dt?dt.isAsset&&(dt.name=pt.className.toLowerCase()):console.log("\n\nerror: no away-asset for export\n\n",i[f].exports[a])}if(y=!(i[f].controlTags&&0!=i[f].controlTags.length||i[f].labelNames&&0!=i[f].labelNames.length||i[f].actionBlocks&&0!=i[f].actionBlocks.length),0!=P.length&&y)if(u){for(a in ot=0,ot|=1,B.push(L.length),P[P.length]=1,M.push(ot),Y)d=Y[a];Y={},K++}else P[P.length-1]+=1;else{if(ot=0,u){for(a in ot|=1,Y)d=Y[a];Y={}}if(B.push(L.length),P[P.length]=1,!y&&i[f].labelNames&&i[f].labelNames.length>0)for(g=i[f].labelNames.length,m=0;m<g;m++){var ft=_=i[f].labelNames[m];this.parser.swfFile.useAVM1&&(_=_.toLowerCase()),p._labels[_]||(p._labels[_]={keyFrameIndex:K,name:ft})}if(!y&&i[f].actionBlocks&&i[f].actionBlocks.length>0&&p.add_framescript(i[f].actionBlocks,f,t,!0),o&&o[K]&&0!=o[K].id&&(at=l(o[K].id))&&(p.audioPool[st]={cmd:15,id:o[K].id,sound:at,props:o[K].info},$.push(st++)),K++,!y&&i[f].controlTags&&i[f].controlTags.length>0){for(A=i[f].controlTags.length,v=0;v<A;v++)switch((E=void 0===(b=i[f].controlTags[v]).tagCode?b:this.parser.getParsedTag(b)).code){case 15:at=l(E.soundId),E.soundInfo&&32&E.soundInfo.flags?p.audioPool[st]={cmd:16,id:E.soundId,sound:l(E.soundId),props:E.soundInfo}:p.audioPool[st]={cmd:15,id:E.soundId,sound:l(E.soundId),props:E.soundInfo},$.push(st++);break;case 16:p.audioPool[st]={cmd:16,id:E.soundId,sound:l(E.soundId),props:E.soundInfo},$.push(st++);break;case 5:case 28:(d=Y[E.depth])||console.log("Error in timeline. remove cant find the object to remove"),this.parser.swfFile.useAVM1?W[W.length]={depth:0|E.depth}:W[W.length]={depth:0|d.sessionID},Y[E.depth]=null,it[E.depth.toString()]=null,delete Y[E.depth];break;case 4:case 26:case 70:if(x=E,d=Y[E.depth],C=x.symbolId>-1,1&x.flags&&!d)break;if(at=null,lt=-1,ut=-1,ct=-1,C){if(!(at=l(x.symbolId))){console.warn("Symbol missed:",x.symbolId);break}w=this.parser.dictionary[x.symbolId],at.isAsset(Sa)?(ut=x.symbolId,p.graphicsPool[x.symbolId]||(p.graphicsPool[x.symbolId]=at),(I=this.factory.createSprite(null,at,w)).mouseEnabled=!1,d&&d.awayChild.isAsset(ka)?lt=d.sessionID:(null!=x&&(x.name&&""!=x.name||this._mcIds[x.symbolId]||this._buttonIds[x.symbolId])&&(x.name&&""!=x.name||(x.name="instance"+x.symbolId+"_"+nt++)),d&&(this.parser.swfFile.useAVM1?W[W.length]={depth:0|E.depth}:W[W.length]={depth:0|d.sessionID},Y[E.depth]=null,it[E.depth.toString()]=null,delete Y[E.depth]),lt=h++,(x.name||x.variableName||x.events&&x.events.length>0)&&(p.placeObjectTagsForSessionIDs[lt]=x),d=Y[E.depth]={sessionID:lt,id:x.symbolId,masks:[],isMask:!1,clipDepth:0,depth:0,awayChild:I,name:x.name?x.name:"noname"},J[J.length]={sessionID:lt,depth:E.depth,id:x.symbolId,name:x.name})):(x.name&&""!=x.name||(x.name="instance"+x.symbolId+"_"+nt++),lt=h++,(x.name||x.variableName||x.events&&x.events.length>0)&&(p.placeObjectTagsForSessionIDs[lt]=x),ht=!0,Y[E.depth]&&Y[E.depth].id==x.symbolId?ht=!1:Y[E.depth]&&(this.parser.swfFile.useAVM1?W[W.length]={depth:0|E.depth}:W[W.length]={depth:0|Y[E.depth].sessionID}),d=Y[E.depth]={sessionID:lt,id:x.symbolId,masks:[],isMask:!1,clipDepth:0,depth:0,awayChild:at,name:x.name?x.name:"noname"},ht&&(J[J.length]={sessionID:lt,depth:E.depth,id:x.symbolId,name:x.name}))}if(16&x.flags&&(at||(at=l(d.id)),at.isAsset(Va)&&(ct=x.ratio)),!d)throw"error in add command";Z[Z.length]={child:d,placeObjectTag:x,swapGraphicsID:ut,ratio:ct,depth:E.depth};break;default:console.log("unknown timeline command tag",E)}var _t=F.length,mt=W.length;if(mt){_t=F.length;for(var gt=0;gt<mt;gt++)F.push(W[gt].depth);ot|=2,O.push(F.length-_t),L.push(_t)}if(mt=J.length){_t=R.length;for(gt=0;gt<mt;gt++)R.push(J[gt].sessionID),R.push(J[gt].depth),R.push(J[gt].id);ot|=4,O.push(mt),L.push(_t/3)}for(a in mt=Z.length,Y)Y[a].oldMasks=Y[a].masks,Y[a].masks=[],Y[a].maskingChanged=!1;if(mt)for(gt=0;gt<mt;gt++)x=Z[gt].placeObjectTag,(d=Z[gt].child).maskingChanged=!0,64&x.flags&&(Y[x.depth].isMask=!0,Y[x.depth].clipDepth=x.clipDepth-1,Y[x.depth].depth=x.depth);for(a in Y)if(Y[a].isMask)for(var yt=Y[a].clipDepth;yt>Y[a].depth;)Y[yt]&&Y[yt].masks.push(Y[a].sessionID),yt--;var At=0,vt=0,bt=[];for(a in Y){var xt=Y[a];if(xt.masks.sort(),xt.oldMasks.sort(),xt.masks.length!=xt.oldMasks.length)bt.push(xt),xt.maskingChanged=!0;else for(At=0,vt=xt.masks.length,At=0;At<vt;At++)if(xt.masks[At]!=xt.oldMasks[At]){bt.push(xt),xt.maskingChanged=!0;break}}for(vt=bt.length,At=0;At<vt;At++){var Ct=!1;if(mt)for(gt=0;gt<mt;gt++)Z[gt].child==bt[At]&&(Ct=!0);Ct||(Z[Z.length]={child:bt[At],placeObjectTag:null,swapGraphicsID:null,ratio:null,depth:null})}if(mt=Z.length){_t=k.length;var wt=0;for(gt=0;gt<mt;gt++){var It=Z[gt];x=It.placeObjectTag,d=It.child;var Et=j.length,St=0;null!=It.swapGraphicsID&&It.swapGraphicsID>=0&&(St++,j.push(202),G.push(Q.length),Q.push(It.swapGraphicsID));var Dt=x&&(this._buttonIds[x.symbolId]||this._mcIds[x.symbolId]);if(x&&(x.name&&""!=x.name||Dt)&&(St++,this._buttonIds[x.symbolId]?j.push(5):j.push(4),G.push(q.length),q.push(x.name)),null!=x&&4&x.flags)St++,j.push(1),G.push(H.length/6),0==x.matrix.a&&0==x.matrix.b&&0==x.matrix.c&&0!=x.matrix.d?x.matrix.a=1:0==x.matrix.d&&0==x.matrix.b&&0==x.matrix.c&&0!=x.matrix.a&&(x.matrix.d=1),Zd(H,H.length,x.matrix),it[It.depth.toString()]=x.matrix;else if(null!=It.depth){var Tt=it[It.depth.toString()];Tt&&(St++,j.push(1),G.push(H.length/6),Zd(H,H.length,Tt))}if(null!=x&&8&x.flags&&(j.push(2),G.push(X.length/8),St++,S=X,D=X.length,T=x.cxform,S[D++]=T.redMultiplier/256,S[D++]=T.greenMultiplier/256,S[D++]=T.blueMultiplier/256,S[D++]=T.alphaMultiplier/256,S[D++]=T.redOffset,S[D++]=T.greenOffset,S[D++]=T.blueOffset,S[D++]=T.alphaOffset),null!=It.ratio&&It.ratio>=0&&(St++,j.push(203),G.push(Q.length),Q.push(0|It.ratio)),d.maskingChanged){St++,j.push(3),G.push(Q.length),Q.push(d.masks.length);for(var Pt=0,Bt=d.masks;Pt<Bt.length;Pt++){var Mt=Bt[Pt];Q.push(Mt)}}if(null!=x&&64&x.flags&&(St++,j.push(200),G.push(0)),null!=x&&256&x.flags){St++,j.push(9),G.push(Q.length),Q.push(z.length),Q.push(x.filters.length);for(var Ot=0;Ot<x.filters.length;Ot++)z.push(x.filters[Ot])}null!=x&&8192&x.flags&&(St++,j.push(6),G.push(x.visibility?1:0)),null!=x&&512&x.flags&&(St++,j.push(7),G.push(x.blendMode)),St>0&&(wt++,k.push(d.sessionID),V.push(Et),U.push(St))}wt>0&&(ot|=8,O.push(mt),L.push(_t))}if(mt=$.length){ot|=16,_t=N.length;for(gt=0;gt<mt;gt++)N.push($[gt]);O.push(mt),L.push(_t)}}0==M.length&&(ot|=1),M.push(ot)}}var Lt=["_up","_over","_down","_hit"];if(4==rt){var Rt=0;for(f=0;f<rt;f++)i[f].labelNames&&i[f].labelNames.length>0&&i[f].labelNames[0]==Lt[f]&&Rt++;4==Rt&&(u=!0)}return p.numKeyFrames=K,p.keyframe_durations=new Uint32Array(P),p.frame_command_indices=new Uint32Array(B),p.frame_recipe=new Uint32Array(M),p.command_length_stream=new Uint32Array(O),p.command_index_stream=new Uint32Array(L),p.add_child_stream=new Uint32Array(R),p.add_sounds_stream=new Uint32Array(N),p.remove_child_stream=new Uint32Array(F),p.update_child_stream=new Uint32Array(k),p.update_child_props_indices_stream=new Uint32Array(V),p.update_child_props_length_stream=new Uint32Array(U),p.property_type_stream=new Uint32Array(j),p.property_index_stream=new Uint32Array(G),p.properties_stream_int=new Uint32Array(Q),p.properties_stream_f32_mtx_scale_rot=new Float32Array([]),p.properties_stream_f32_mtx_pos=new Float32Array([]),p.properties_stream_f32_mtx_all=new Float32Array(H),p.properties_stream_f32_ct=new Float32Array(X),p.properties_stream_strings=q,p.properties_stream_filters=z,p.init(),u?(t.buttonMode=!0,p.isButton=!0,r&&(p.avm1ButtonActions=r),p.extractHitArea(t)):t.mouseEnabled=!1,t},t}(),ef=function(t){function e(){var e=t.call(this,"ROOT")||this;return window.AWAY_ROOT_STAT=e,e}return i(e,t),e.rec=function(t){return this._instance||(this._instance=new e),this._instance.rec(t)},e}(function(){function t(t,e){void 0===e&&(e=!1),this.name=t,this._subrecord=e,this._records={},this._startTime=0,this._endTime=0,this._subs=[],this._state=0}return t.prototype.rec=function(e,i){if(void 0===i&&(i=!1),this._subrecord)throw"Suprecord can't support nested records!";var n=this._subs[this._subs.length-1];return n&&1===n._state||(n=this),n._records[e]||(n._records[e]=new t(e,i))},t.prototype.begin=function(){if(0===this._state){if(!this._subrecord){this._subs[this._subs.length-1]&&this._subs[this._subs.length-1].end();var t=this.rec(this.name+"_"+this._subs.length,!0);return this._subs.push(t),t.begin()}return this._state=1,this._startTime=performance.now()}},t.prototype.end=function(){for(var t in this._records)this._records[t].end();if(1===this._state)return this._subrecord?(this._state=2,this._endTime=performance.now(),this._endTime-this._startTime):this._subs[this._subs.length-1].end()},t.prototype.drop=function(){if(this.end(),!this._subrecord)return this._subs[this._subs.length-1].drop();this._state=3,this._startTime=this._endTime=0},Object.defineProperty(t.prototype,"startTime",{get:function(){if(3==this._state)return 0;var t=this._startTime||Number.MAX_VALUE;for(var e in this._records){var i=this._records[e];t=Math.min(t,i.startTime)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endTime",{get:function(){if(3==this._state)return 0;var t=this._endTime||-Number.MAX_VALUE;for(var e in this._records){var i=this._records[e];t=Math.max(t,i.endTime)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){if(3==this._state)return 0;if(!Object.keys(this._records).length)return this._endTime-this._startTime;var t=0;for(var e in this._records)t+=this._records[e].duration;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selfDuration",{get:function(){return Object.keys(this._records).length?this.endTime-this.startTime:this._endTime-this._startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"density",{get:function(){return 3==this._state?0:this.duration/this.selfDuration},enumerable:!0,configurable:!0}),t.prototype.toString=function(){var t=this.selfDuration;return"Name: "+this.name+", duration: "+this.duration.toFixed(2)+"ms, self: "+t.toFixed(2)+"ms, density:"+(100*this.density).toFixed(0)+"%"},t.prototype.toTable=function(t,e){void 0===t&&(t=0);var i="  ".repeat(t)+this.toString()+"\n";if(1===this._subs.length&&1===Object.keys(this._records).length)return i;for(var n in this._records){var r=this._records[n];3!==r._state&&(e&&e(r)||(i+=r.toTable(t+1,e)))}return i},t}()),nf=(function(t){function e(e,i,n){var r=t.call(this,i)||this;return r._symbol=e,r.dataClass=n,r.isGeneric=!0,r}i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._symbol=null},e.prototype.clone=function(){return new e(this._symbol,this.name,this.dataClass)},e.assetType="[asset Generic]"}(p),function(e){function n(t){void 0===t&&(t=null);var i=e.call(this,nt.ARRAY_BUFFER)||this;return i._awayUnresolvedSymbols={},i._isEncrypted=!1,i._currentEncrActionBlocks=[],i.soundExports={},i.externalDependenciesCount=0,i._lockFinalize=!1,i.textFormatAlignMap=[Ac.LEFT,Ac.RIGHT,Ac.CENTER,Ac.JUSTIFY],i._buttonSounds={},i._swfFile=new r,i._factory=t,i._progressState=0,i._symbolDecoder=new tf(i),i}return i(n,e),Object.defineProperty(n.prototype,"awayUnresolvedSymbols",{get:function(){return this._awayUnresolvedSymbols},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"awaySymbols",{get:function(){return this._symbolDecoder.awaySymbols},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"swfFile",{get:function(){return this._swfFile},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"factory",{get:function(){return this._factory},set:function(t){this._factory=t,n.factory=t,this._progressState=4},enumerable:!0,configurable:!0}),n.prototype.onFactoryRequest=function(t){this.factory=n.factory||new ah},n.supportsType=function(t){return t=t.toLowerCase(),console.log("SWFParser supportsType extension: ",t,"result: ","swf"==t),"swf"==t},n.supportsData=function(t){return(67===t[0]||70===t[0]||90===t[0])&&87===t[1]&&83===t[2]},n.prototype._iResolveDependency=function(t){if(1!=t.assets.length)throw"SWFParser: error when resolving dependency";var e=this.eagerlyParsedSymbolsMap[t.id];if(e)switch(e.type){case"image":var i=t.assets[0];this._awayUnresolvedSymbols[t.id]=i;break;case"font":break;case"sound":var n=t.assets[0];this._awayUnresolvedSymbols[t.id]=n;break;default:console.log("finished unknown parsing",t)}else console.log("no eagerlyParsedSymbolsMap for id",t.id);this.externalDependenciesCount--,0==this.externalDependenciesCount&&(this.parseSymbolsToAwayJS(),this._progressState=5)},n.prototype._iResolveDependencyFailure=function(t){this.externalDependenciesCount--,0==this.externalDependenciesCount&&(this.parseSymbolsToAwayJS(),this._progressState=5)},n.prototype._iResolveDependencyName=function(t,e){var i=e.name,n=e.name;return e.name=i,n},n.prototype._pProceedParsing=function(){if(0==this._progressState){var t=this._pGetByteData(),e=new Uint8Array(t.arraybytes);if(!n.supportsData(e)){var i=e.slice(0,3).reverse().reduce((function(t,e){return t+String.fromCharCode(e)}),"");return console.error("[SWF Parser] unknow file type:",i),this.parsingFailure=!0,!1}if(ef.rec("parser").begin(),this.initSWFLoading(e,e.length),this._swfFile.url=this._iFileName,this._factory)this.parseSymbols();else{if(!this.onFactoryRequest)throw"Error in SWFParser. no factory and noFactoryRequest method exists.";this._progressState=3,this.onFactoryRequest(this._swfFile),this._factory&&this.parseSymbols()}}else if(4==this._progressState){if(!this.onFactoryRequest)throw"Error in SWFParser. no factory and noFactoryRequest method exists.";this._factory&&this.parseSymbols()}return 5!=this._progressState?mt.MORE_TO_PARSE:(ef.rec("parser").end(),mt.PARSING_DONE)},n.prototype.parseSymbols=function(){if(ef.rec("parser").rec("symbols").begin(),this._factory.url=this._iFileName,this._pContent=this._factory.createDisplayObjectContainer(),this._awayUnresolvedSymbols={},this._mapMatsForBitmaps={},this.abcBlocks.length&&this._factory.executeABCBytes&&this._factory.executeABCBytes(this.abcBlocks),this.externalDependenciesCount=0,this.eagerlyParsedSymbolsList.length>0)for(var t=0;t<this.eagerlyParsedSymbolsList.length;t++){var e=this.eagerlyParsedSymbolsList[t];if(e)switch(e.type){case"image":this._pAddDependency(e.id.toString(),null,new In(this._factory,e.definition.alphaData),new Blob([e.definition.data],{type:e.definition.mimeType}),!1,!0),this.externalDependenciesCount++;break;case"sound":if(!e.definition.packaged){console.warn("SWF-parser: Missed packaged data for sound-id:",e.id.toString());break}this._pAddDependency(e.id.toString(),null,new gt,new Blob([e.definition.packaged.data],{type:e.definition.packaged.mimeType}),!1,!0),this.externalDependenciesCount++;break;case"font":break;default:console.log("encountered eagerly parsed unknown type: ",e)}}this.externalDependenciesCount>0?(this._progressState=2,this._pPauseAndRetrieveDependencies()):(this.parseSymbolsToAwayJS(),this._progressState=5,ef.rec("parser").rec("symbols").end())},n.prototype.getMaterial=function(t){var e=this._mapMatsForBitmaps[t];if(!e){e=new ac;var i=this.awaySymbols[t];i&&(i.isAsset(hn)||i.isAsset(mh))||(i=new hn(512,512,!0,4278190335,!0)),e.ambientMethod.texture=new hl(i),e.alphaBlending=!0,e.useColorTransform=!0,e.bothSides=!0,this._mapMatsForBitmaps[t]=e}return e},n.prototype.registerAwayAsset=function(t,e){this._lockFinalize||("font"!==e.type?this._pFinalizeAsset(t):this._pFinalizeAsset(e.away))},n.prototype.parseSymbolsToAwayJS=function(){ef.rec("parser").rec("symbols").rec("away").begin();var t=0,e=Object.keys(this.dictionary).length,i=e/100|0,n={};this._symbolDecoder.reqursive=!1,this._lockFinalize=!0,console.debug("[Away Symbols] Start");for(var r=0,o=this.dictionary;r<o.length;r++){var s=o[r];if(s){t++,!i||t%100||console.debug("[Away Symbols] Decoded ("+t+"/"+e+"), "+(100*t/e|0));var a,l=this.getSymbol(s.id);(a=this._symbolDecoder.createAwaySymbol(l,null,null))&&("font"!==l.type?n[s.id]=a:n[l.name]=l.away)}}var u=this.dictionary[0]||{id:0,className:this.symbolClassesMap[0]},c=this._symbolDecoder.framesToTimeline(null,u,this._swfFile.frames,null,null);for(var h in c.isAVMScene=!0,n)this._pFinalizeAsset(n[h]);this._pFinalizeAsset(c,"scene"),wc.applySharedFonts(this._iFileName),this._lockFinalize=!1,this._symbolDecoder.reqursive=!0,ef.rec("parser").rec("symbols").rec("away").end()},n.prototype._pStartParsing=function(t){e.prototype._pStartParsing.call(this,t)},n.prototype.dispose=function(){this.swfData=null,this._dataStream=null},n.prototype.updateTimers=function(t){},n.prototype.initSWFLoading=function(t,e){co(67===t[0]||70===t[0]||90===t[0],"Unsupported compression format: "+t[0]),co(87===t[1]),co(83===t[2]),co(t.length>=30,"At least the header must be complete here."),this._swfFile.bytesTotal=e,this._swfFile.frames=[],this.abcBlocks=[],this.dictionary=[],this.fonts=[],this.symbolClassesMap=[],this.symbolClassesList=[],this.eagerlyParsedSymbolsMap=[],this.eagerlyParsedSymbolsList=[],this._jpegTables=null,this._currentFrameLabels=[],this._currentSoundStreamHead=null,this._currentSoundStreamBlock=null,this._currentControlTags=null,this._currentActionBlocks=null,this._currentInitActionBlocks=null,this._currentExports=null,this._endTagEncountered=!1,this._isEncrypted=!1,this._currentEncrActionBlocks=null,this.readHeaderAndInitialize(t)},n.prototype.finishLoading=function(){this._swfFile.compression!==t.None&&(this._decompressor.close(),this._decompressor=null,this.scanLoadedData())},n.prototype.getSymbol=function(t){if(this.eagerlyParsedSymbolsMap[t])return this.eagerlyParsedSymbolsMap[t];var e,i=this.dictionary[t];return i?((e=39===i.tagCode?this.parseSpriteTimeline(i):this.getParsedTag(i)).className=this.symbolClassesMap[t]||null,e.env=this.env,this._buttonSounds[e.id]&&(e.buttonSounds=this._buttonSounds[e.id]),i.scalingGrid&&(e.scalingGrid=i.scalingGrid),e):null},n.prototype.getParsedTag=function(t){this._dataStream.align(),this._dataStream.pos=t.byteOffset;var e=xd[t.tagCode],i=Math.min(t.byteOffset+t.byteLength,this._dataStream.end),n=e(this._dataStream,this._swfFile.swfVersion,t.tagCode,i,this._jpegTables);return this._dataStream.pos!==i&&this.emitTagSlopWarning(t,i),function(t,e,i){var n;switch(t.code){case 6:case 21:case 35:case 90:n=Gd(t);break;case 20:case 36:n=Nd(t);break;case 7:case 34:n=Md(t,e);break;case 37:n=Bd(t);break;case 10:case 48:case 75:case 91:n=Pd(t,i._iFileName);break;case 46:case 84:case 2:case 22:case 32:case 83:n=wd(t,i);break;case 14:n=gp(t);break;case 60:return{type:"video",id:t.id,width:t.width,height:t.height,deblocking:t.deblocking,smoothing:t.smoothing,codec:t.codecId};case 39:return t;case 87:return{type:"binary",id:t.id,data:t.data};case 11:case 33:n=Qd(t);break;default:return t}return n}(n,this.dictionary,this)},n.prototype.readHeaderAndInitialize=function(e){var i,n=67===e[0],r=90===e[0];n?this._swfFile.compression=t.Deflate:r&&(this._swfFile.compression=t.LZMA),this._swfFile.swfVersion=e[3],this._swfFile.mapSWFVersionToFPVersion(),this._swfFile.swfVersion,this._loadStarted=Date.now(),this._uncompressedLength=((i=e)[4]|i[5]<<8|i[6]<<16|i[7]<<24)>>>0,this._swfFile.bytesLoaded=e.length,this.swfData=new Uint8Array(this._swfFile.compression===t.None?this._swfFile.bytesTotal:this._uncompressedLength),this._dataStream=new Hp(this.swfData.buffer),this._dataStream.pos=8,this._dataView=this._dataStream.view,n?(this.swfData.set(e.subarray(0,8)),this._uncompressedLoadedLength=8,this._decompressor=Uo.create(!0),this._decompressor.onData=this.processFirstBatchOfDecompressedData.bind(this),this._decompressor.onError=function(t){throw new Error(t)},this._decompressor.push(e.subarray(8))):r?(this.swfData.set(e.subarray(0,8)),this._uncompressedLoadedLength=8,this._decompressor=new ps(!0),this._decompressor.onData=this.processFirstBatchOfDecompressedData.bind(this),this._decompressor.onError=function(t){},this._decompressor.push(e)):(this.swfData.set(e),this._uncompressedLoadedLength=e.length,this._decompressor=null,this.parseHeaderContents()),this._lastScanPosition=this._dataStream.pos,this.scanLoadedData()},n.prototype.parseHeaderContents=function(){var t=Cd(this._dataStream);this._swfFile.bounds=this._swfFile.bounds=t.bounds,this._swfFile.frameRate=this._swfFile.frameRate=t.frameRate,this._swfFile.frameCount=this._swfFile.frameCount=t.frameCount},n.prototype.processFirstBatchOfDecompressedData=function(t){ef.rec("parser").rec("unzip").begin(),this.processDecompressedData(t),this.parseHeaderContents(),this._decompressor.onData=this.processDecompressedData.bind(this)},n.prototype.processDecompressedData=function(t){ef.rec("parser").rec("unzip").end();var e=Math.min(t.length,this._uncompressedLength-this._uncompressedLoadedLength);ho(this.swfData,t,this._uncompressedLoadedLength,0,e),this._uncompressedLoadedLength+=e},n.prototype.scanLoadedData=function(){this._dataStream.pos=this._lastScanPosition,ef.rec("parser").rec("scanTags").begin(),this.scanTagsToOffset(this._uncompressedLoadedLength,!0),ef.rec("parser").rec("scanTags").end(),this._lastScanPosition=this._dataStream.pos},n.prototype.scanTagsToOffset=function(t,e){for(var i,n=new wo(0,0,0);(i=this._dataStream.pos)<t-1&&this.parseNextTagHeader(n);){if(0===n.tagCode)return void(e&&(this._endTagEncountered=!0));var r=n.byteOffset+n.byteLength;if(r>t)return void(this._dataStream.pos=i);this.scanTag(n,e),this._dataStream.pos!==r&&this.emitTagSlopWarning(n,r)}},n.prototype.parseNextTagHeader=function(t){var e=this._dataStream.pos,i=this._dataView.getUint16(e,!0);e+=2,t.tagCode=i>>6;var n=63&i;if(63===n){if(e+4>this._uncompressedLoadedLength)return!1;n=this._dataView.getUint32(e,!0),e+=4}return this._dataStream.pos=e,t.byteOffset=e,t.byteLength=n,!0},n.prototype.Utf8ArrayToStr=function(t){var e,i,n,r,o,s;for(e="",n=t.length,i=0;i<n;)switch((r=t[i++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(r);break;case 12:case 13:o=t[i++],e+=String.fromCharCode((31&r)<<6|63&o);break;case 14:o=t[i++],s=t[i++],e+=String.fromCharCode((15&r)<<12|(63&o)<<6|(63&s)<<0)}return e},n.prototype.scanTag=function(t,e){var i,n,r=this._dataStream,o=r.pos;co(o===t.byteOffset);var s=t.tagCode,a=t.byteLength;if(39===s){this.addLazySymbol(s,o,a);var l=o+a;return r.pos+=4,this.scanTagsToOffset(l,!1),void(this._dataStream.pos!==l&&this.emitTagSlopWarning(t,l))}if(Gp[s]){var u=this.addLazySymbol(s,o,a);this.decodeEmbeddedImage(u)}else{if(14===s){u=this.addLazySymbol(s,o,a);var c=this.getParsedTag(u),h=new Eo(c.id,u,"sound",c);return this.eagerlyParsedSymbolsMap[h.id]=h,void this.eagerlyParsedSymbolsList.push(h)}if(Qp[s]){u=this.addLazySymbol(s,o,a);this.registerEmbeddedFont(u)}else{if(jp[s])return this.addLazySymbol(s,o,a),void this.jumpToNextTag(a);if(e||76===s||56===s)if(zp[s])this.addControlTag(s,o,a);else switch(s){case 69:this.setFileAttributes(a);break;case 86:this.setSceneAndFrameLabelData(a);break;case 9:this._swfFile.backgroundColor=this._swfFile.backgroundColor=Yp(this._dataStream);break;case 8:this._jpegTables||(this._jpegTables=0===a?new Uint8Array(0):this.swfData.subarray(r.pos,r.pos+a-2)),this.jumpToNextTag(a);break;case 82:case 72:if(this._swfFile.useAVM1)this.jumpToNextTag(a);else{var p=o+a,d=new xo;82===s?(d.flags=r.readUi32(),d.name=r.readString(-1)):(d.flags=0,d.name=""),d.data=this.swfData.subarray(r.pos,p),this.abcBlocks.push(d),r.pos=p}break;case 76:p=o+a;for(var f=r.readUi16();f--;){var _=r.readUi16(),m=r.readString(-1);this.symbolClassesMap[_]=m,this.symbolClassesList.push({id:_,className:m})}r.pos=p;break;case 59:if(this._swfFile.useAVM1){var g=this._currentInitActionBlocks||(this._currentInitActionBlocks=[]),y=this._dataView.getUint16(r.pos,!0),A=this.swfData.subarray(o+2,o+a),v=this._isEncrypted?null===(i=this._currentEncrActionBlocks)||void 0===i?void 0:i.pop():void 0;g.push({spriteId:y,actionsData:A,encryptedData:v})}this.jumpToNextTag(a);break;case 12:if(this._swfFile.useAVM1){var b=this._currentActionBlocks||(this._currentActionBlocks=[]);A=this.swfData.subarray(r.pos,r.pos+a),v=this._isEncrypted?null===(n=this._currentEncrActionBlocks)||void 0===n?void 0:n.pop():void 0;b.push({actionsData:A,precedence:r.pos,encryptedData:v})}this.jumpToNextTag(a);break;case 18:case 45:var x=hd(this._dataStream,o+a);this._currentSoundStreamHead=bp.FromTag(x);break;case 19:this._currentSoundStreamBlock=this.swfData.subarray(r.pos,r.pos+=a);break;case 43:p=r.pos+a;this._currentFrameLabels[this._currentFrameLabels.length]=r.readString(-1),r.pos=p;break;case 1:this.finishFrame();break;case 0:return;case 56:p=r.pos+a;for(var C=r.readUi16(),w=this._currentExports||(this._currentExports=[]);C--;){_=r.readUi16();var I=r.readString(-1);if(r.pos>p){r.pos=p;break}w.push(new Co(_,I))}r.pos=p;break;case 17:p=r.pos+a;var E=r.readUi16();this._buttonSounds[E]={};for(var S=0;S<4;S++)this._buttonSounds[E][S]={},this._buttonSounds[E][S].id=r.readUi16(),0!=this._buttonSounds[E][S].id&&(this._buttonSounds[E][S].info=cd(r));r.pos=p;break;case 78:var D=this.getParsedTag(t);this.dictionary[D.symbolId].scalingGrid=D.splitter;break;case 23:case 13:case 62:case 57:case 71:this.jumpToNextTag(a);break;case 77:this.parseMetaData(a);break;case 74:case 73:case 65:case 66:case 58:case 64:case 63:case 88:case 40:case 41:case 24:case 25:case 93:case 55:case 49:this.jumpToNextTag(a);break;case 51:case 44:case 50:case 53:case 42:case 38:case 52:case 3:case 31:case 47:case 16:case 29:this.jumpToNextTag(a);break;case 255:console.log("Tag 255 present. SWF is encrypted"),this._isEncrypted=!0,this.jumpToNextTag(a);break;case 253:if(this._isEncrypted){var T=this._currentEncrActionBlocks||(this._currentEncrActionBlocks=[]),P=this.swfData.subarray(o+2,o+a);T.push({data:P,bytePos:o+2,size:a,rawTagId:s})}this.jumpToNextTag(a);break;default:s>100?console.log("Encountered undefined tag "+s+", probably used for AVM1 obfuscation. See http://ijs.mtasa.com/files/swfdecrypt.cpp."):console.log("Tag not handled by the parser: "+s+": "+Xp(s)),this.jumpToNextTag(a)}else this.jumpToNextTag(a)}}},n.prototype.parseSpriteTimeline=function(t){var e=this.swfData,i=this._dataStream,n=this._dataView,r={id:t.id,type:"sprite",frames:[]},o=t.byteOffset+t.byteLength,s=r.frames,a=[],l=[],u=null,c=null,h=null,p=null;i.pos=t.byteOffset+2,r.frameCount=n.getUint16(i.pos,!0),i.pos+=2;for(var d=new wo(0,0,0);i.pos<o;){this.parseNextTagHeader(d);var f=d.byteLength,_=d.tagCode;if(i.pos+f>o){console.log("DefineSprite child tags exceed DefineSprite tag length and are dropped");break}if(zp[_])l.push(new wo(_,i.pos,f)),i.pos+=f;else{switch(_){case 12:if(this._swfFile.useAVM1){h||(h=[]);var m=e.subarray(i.pos,i.pos+f);h.push({actionsData:m,precedence:i.pos})}break;case 59:if(this._swfFile.useAVM1){p||(p=[]);var g=n.getUint16(i.pos,!0);i.pos+=2;m=e.subarray(i.pos,i.pos+f);p.push({spriteId:g,actionsData:m})}break;case 43:var y=i.pos+f;a[a.length]=i.readString(-1),i.pos=y,f=0;break;case 1:s.push(new zd(l,a.concat(),u,c,h,p,null)),a.length=0,l=[],u=null,c=null,h=null,p=null;break;case 0:i.pos=o,f=0;break;case 18:case 45:var A=i.pos,v=hd(i,y=i.pos+f);u=bp.FromTag(v),i.pos=A;break;case 19:A=i.pos,y=i.pos+f;c=this.swfData.subarray(i.pos,y),i.pos=A}i.pos+=f,co(i.pos<=o)}}return r},n.prototype.parseMetaData=function(t){this._dataStream.pos+=t},n.prototype.jumpToNextTag=function(t){this._dataStream.pos+=t},n.prototype.emitTagSlopWarning=function(t,e){this._dataStream.pos,t.byteOffset;this._dataStream.pos=e},n.prototype.finishFrame=function(){0===this.pendingUpdateDelays&&this._swfFile.framesLoaded++,this._swfFile.frames.push(new zd(this._currentControlTags,this._currentFrameLabels.concat(),this._currentSoundStreamHead,this._currentSoundStreamBlock,this._currentActionBlocks,this._currentInitActionBlocks,this._currentExports)),this._currentFrameLabels.length=0,this._currentControlTags=null,this._currentSoundStreamHead=null,this._currentSoundStreamBlock=null,this._currentActionBlocks=null,this._currentInitActionBlocks=null,this._currentExports=null},n.prototype.setFileAttributes=function(t){this._swfFile.attributes&&this.jumpToNextTag(t);var e=this.swfData[this._dataStream.pos];this._dataStream.pos+=4,this._swfFile.attributes={network:1&e,relativeUrls:2&e,noCrossDomainCaching:4&e,doAbc:8&e,hasMetadata:16&e,useGpu:32&e,useDirectBlit:64&e},this._swfFile.useAVM1=!this._swfFile.attributes.doAbc},n.prototype.setSceneAndFrameLabelData=function(t){this._swfFile.sceneAndFrameLabelData?this.jumpToNextTag(t):this._swfFile.sceneAndFrameLabelData=this._swfFile.sceneAndFrameLabelData=_d(this._dataStream,86)},n.prototype.addControlTag=function(t,e,i){(this._currentControlTags||(this._currentControlTags=[])).push(new wo(t,e,i)),this.jumpToNextTag(i)},n.prototype.addLazySymbol=function(t,e,i){var n=this._dataView.getUint16(this._dataStream.pos,!0),r=new Io(n,t,e,i);return this.dictionary[n]=r,r},n.prototype.decodeEmbeddedFont=function(t){var e=this.getParsedTag(t),i=new Eo(e.id,t,"font",e);this.eagerlyParsedSymbolsMap[i.id]=i,this.eagerlyParsedSymbolsList.push(i);var n=rf(e.bold,e.italic);this.fonts.push({name:e.name,id:e.id,style:n})},n.prototype.registerEmbeddedFont=function(t){var e,i,n=this._dataStream,r=this._dataView.getUint16(n.pos,!0);if(10===t.tagCode)i="__autofont__"+t.byteOffset,e="regular";else{var o=this.swfData[n.pos+2];e=rf(!!(1&o),!!(2&o));var s=this.swfData[n.pos+4];n.pos+=5,i=n.readString(s)}this.fonts.push({name:i,id:r,style:e}),n.pos=t.byteOffset+t.byteLength},n.prototype.decodeEmbeddedImage=function(t){var e=this.getParsedTag(t),i=new Eo(e.id,t,"image",e);this.eagerlyParsedSymbolsMap[i.id]=i,this.eagerlyParsedSymbolsList.push(i)},n.factory=null,n}(mt));function rf(t,e){return t&&e?"boldItalic":t?"bold":e?"italic":"regular"}var of=function(t){function e(i){var n=t.call(this)||this;if(n._gameConfig=null,n._curFile=null,e._instance)throw"Only one AVMStage is allowed to be constructed";return e._instance=n,ut.enableParsers([gt,nf,In]),n._time=0,n._currentFps=0,n._avmHandlers={},n._stageWidth=550,n._stageHeight=400,n._scaleMode=Bp.SHOW_ALL,n._align=Mp.TOP_LEFT,n._scaleModeAllowUpdate=!0,n._alignAllowUpdate=!0,i.stageScaleMode&&(n._scaleMode=i.stageScaleMode,n._scaleModeAllowUpdate=!1),i.stageAlign&&(n._align=i.stageAlign,n._alignAllowUpdate=!1),i.forceINT&&(e.forceINT=i.forceINT),n._frameRate=30,n._showFrameRate=!1,n._showFrameRateIntervalID=-1,n._x=i.x?i.x:0,n._y=i.y?i.y:0,n._w=i.w?i.w:"100%",n._h=i.h?i.h:"100%",n._isPaused=!1,n._gameConfig=i,n.initAwayEninge(),n._renderer.view.backgroundColor=16777215,b.setVolume(1),n._resizeCallbackDelegate=function(t){return n.resizeCallback(t)},window.addEventListener("resize",n._resizeCallbackDelegate),n._onLoaderStartDelegate=function(t){return n.onLoaderStart(t)},n._onLoaderCompleteDelegate=function(t){return n.onLoaderComplete(t)},n._onAssetCompleteDelegate=function(t){return n._onAssetComplete(t)},n._onLoadErrorDelegate=function(t){return n._onLoadError(t)},n._gameConfig.testConfig&&(n.avmTestHandler=new Rp(n._gameConfig.testConfig,n)),document.addEventListener("fullscreenchange",n.onFullscreenChanged.bind(n)),n}return i(e,t),e.instance=function(){if(!e._instance)throw"AVMStage._instance should exists but does not";return e._instance},Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mousePicker",{get:function(){return this._mousePicker},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseManager",{get:function(){return this._mouseManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this._gameConfig},enumerable:!0,configurable:!0}),e.prototype.registerAVMStageHandler=function(t){this._avmHandlers[t.avmVersion]=t},Object.defineProperty(e.prototype,"displayState",{get:function(){return this._displayState},set:function(t){var e=this;if(document.fullscreenEnabled)switch(t){case"fullScreenInteractive":case"fullScreen":Element.prototype.requestFullscreen&&document.body.requestFullscreen().then((function(){e._displayState=t}));break;default:this._displayState=t,document.fullscreenElement&&document.exitFullscreen()}else this._displayState="normal"},enumerable:!0,configurable:!0}),e.prototype.onFullscreenChanged=function(t){document.fullscreenElement||(this._displayState="normal")},e.prototype.initAwayEninge=function(){this._root=new Fa,this._partition=new uh(this._root,!0),this._root.partition=this._partition,this._view=new Un,this._view.projection.transform.moveTo(0,0,-1e3),this._pickGroup=ce.getInstance(this._view),this._mousePicker=this._pickGroup.getRaycastPicker(this._partition),this._mousePicker.shapeFlag=!0,this._mouseManager=gh.getInstance(this._view.stage),this._renderer=Ir.getInstance(this._view,_r.DEFAULT).getRenderer(this._partition),this._rendererStage=this._view.stage,this._rendererStage.container.style.visibility="hidden",this._rendererStage.antiAlias=0,this._renderer.renderableSorter=null,this._projection=this._view.projection,this._projection.coordinateSystem=_t.RIGHT_HANDED,this._projection.originX=-1,this._projection.originY=1,this._projection.fieldOfView=360*Math.atan(window.innerHeight/1e3/2)/Math.PI},e.prototype.playSWF=function(t,e){var i=this;this._gameConfig={files:[{data:t,path:e,resourceType:"GAME"}]},this.addEventListener(V.LOADER_COMPLETE,(function(t){return i.play()})),this.loadNextResource()},e.prototype.snapshot=function(t){var e=new hn(this._stageWidth,this._stageHeight,!0,4294967295,!1);this._renderer.queueSnapshot(e),this._renderer.view.target=e,this._renderer.render(),this._renderer.view.target=null,e.invalidate();var i=e.data,n=new hn(this._stageWidth,this._stageHeight,!0,4278255615,!1),r=0,o=0,s=0,a=0;for(o=0;o<this._stageHeight;o++)for(r=0;r<this._stageWidth;r++)s=4*((this._stageHeight-1-o)*this._stageWidth+r),a=w.ARGBtoFloat32(i[s+3],i[s],i[s+1],i[s+2]),n.setPixel32(r,o,a);n.invalidate();var l=document.createElement("canvas");l.width=n.width,l.height=n.height;var u=l.getContext("2d"),c=u.getImageData(0,0,n.width,n.height);c.data.set(n.data),u.putImageData(c,0,0),t&&t(l)},e.prototype.loadNextResource=function(t){var e=this;if(void 0===t&&(t=null),this._curFile=this._gameConfig.files.shift(),this._curFile){var i=new nf;if(i._iFileName=this._curFile.path,"GAME"==this._curFile.resourceType){if(this._swfFile)throw"Only playing of 1 SWF file is supported at the moment";i.onFactoryRequest=function(t){e._swfFile=t,e.frameRate=e._swfFile.frameRate,e.color=w.f32_RGBA_To_f32_ARGB(t.backgroundColor),e.stageWidth=e._swfFile.bounds.width/20,e.stageHeight=e._swfFile.bounds.height/20;var n=e._swfFile.useAVM1?"AVM1":"AVM2";if(e._avmHandler=e._avmHandlers[n],e.avmTestHandler&&!e.avmTestHandler.config.settings.onlyTraces&&e.avmTestHandler.setSWF(e._swfFile),!e._avmHandler)throw"no avm-handler installed for "+n;e._avmHandler.init(e,e._swfFile,(function(t){i.factory=e._avmHandler.factory,nf.factory=e._avmHandler.factory,t&&e.dispatchEvent(new Et(Et.AVM_COMPLETE,n))}))}}ht.addEventListener(V.LOADER_START,this._onLoaderStartDelegate),ht.addEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),ht.addEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),ht.addEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate),this._curFile.data?ht.loadData(this._curFile.data,null,this._curFile.path,i):ht.load(new pt(this._curFile.path),null,this._curFile.path,i)}else{if(!this._swfFile)throw"no valid SWFFile was loaded!";t&&this.dispatchEvent(t)}},e.prototype.load=function(){this.loadNextResource()},e.prototype.onLoaderStart=function(t){this.dispatchEvent(t)},e.prototype._onAssetComplete=function(t){"GAME"==this._curFile.resourceType&&(0==e.runtimeStartTime&&(e.runtimeStartTime=Date.now()),this._avmHandler.addAsset(t.asset,!0)),this.dispatchEvent(t)},e.prototype.onLoaderComplete=function(t){ht.removeEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),ht.removeEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),ht.removeEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate),this.loadNextResource(t)},e.prototype._onLoadError=function(t){ht.removeEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),ht.removeEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),ht.removeEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate),console.log("error loading swf"),this.dispatchEvent(t)},e.prototype.play=function(t){void 0===t&&(t=0),this.resizeCallback(null),this._timer=new Ct(this.main_loop,this),this._timer.start();var e=this._root;e?(t&&(e.currentFrameIndex=t),this.showNextFrame(0),this._rendererStage.container.style.visibility="visible"):console.warn("warning: AVMPlayer.play called, but no scene is loaded")},e.prototype.updateFPS=function(){this._fpsTextField.style.visibility=this._currentFps&&this._frameRate?"visible":"hidden",this._fpsTextField.innerText=this._currentFps.toFixed(2)+"/"+this._frameRate+" fps",this._currentFps=0},e.prototype.setStageDimensions=function(t,e,i,n){this._x=t,this._y=e,this._w=i,this._h=n,this.resizeStageInternal()},e.prototype.resizeStageInternal=function(){var t="string"==typeof this._x?parseFloat(this._x.replace("%",""))/100*window.innerWidth:this._x,e="string"==typeof this._y?parseFloat(this._y.replace("%",""))/100*window.innerHeight:this._y,i="string"==typeof this._w?parseFloat(this._w.replace("%",""))/100*window.innerWidth:this._w,n="string"==typeof this._h?parseFloat(this._h.replace("%",""))/100*window.innerHeight:this._h,r=t,o=e,s=i,a=n;switch(this._scaleMode){case Bp.NO_SCALE:this._projection.fieldOfView=360*Math.atan(n/1e3/2)/Math.PI,this._stageWidth=i,this._stageHeight=n;break;case Bp.SHOW_ALL:a=n,(s=this._stageWidth/this._stageHeight*a)>i&&(a=(s=i)*(this._stageHeight/this._stageWidth)),r+=(i-s)/2,o+=(n-a)/2,this._projection.fieldOfView=360*Math.atan(this._stageHeight/1e3/2)/Math.PI;break;case Bp.EXACT_FIT:case Bp.NO_BORDER:this._projection.fieldOfView=360*Math.atan(n/1e3/2)/Math.PI;break;default:console.log("Stage: only implemented StageScaleMode are NO_SCALE, SHOW_ALL")}switch(this._align){case Mp.TOP_LEFT:this._view.x=r,this._view.y=o;break;default:this._view.x=r,this._view.y=o,console.log("Stage: only implemented StageAlign is TOP_LEFT")}this._view.x=r,this._view.y=o,this._view.width=s,this._view.height=a,this._fpsTextField&&(this._fpsTextField.style.left=.5*window.innerWidth-50+"px"),this._avmHandler&&this._avmHandler.resizeStage()},e.prototype.resizeCallback=function(t){this.resizeStageInternal()},e.prototype.pause=function(){b.setVolume(0),this._isPaused=!0},e.prototype.unPause=function(){b.setVolume(1),this._isPaused=!1},Object.defineProperty(e.prototype,"isPaused",{get:function(){return this._isPaused},set:function(t){this._isPaused=t},enumerable:!0,configurable:!0}),e.prototype.main_loop=function(t){if(!this._isPaused){if(!this._avmHandler)throw"error - can not render when no avm-stage is available";var e=Math.floor(1e3/this._frameRate);this._time+=Math.min(t,e),this._time>=e&&(this._currentFps++,this.showNextFrame(this._time),this._time-=e)}},e.prototype.requestRender=function(){el.execute_queue(),this._renderer.render()},e.prototype.showNextFrame=function(t){if(this._isPaused)return Pp.enterFrame(),void Pp.exitFrame();Pp.enterFrame(),this.avmTestHandler&&this.avmTestHandler.dispatchEvents(),this._mouseManager.fireMouseEvents(this._mousePicker),this._avmHandler.enterFrame(t),this.avmTestHandler&&this.avmTestHandler.nextFrame(),this._renderer.render(),Pp.exitFrame()},Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._alignAllowUpdate&&(this._align=t,this.resizeCallback())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accessibilityImplementation",{get:function(){return console.log("AVMStage: get accessibilityImplementation not implemented"),this._align},set:function(t){console.log("AVMStage:  accessibilityImplementation not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._renderer.view.backgroundColor},set:function(t){this._renderer.view.backgroundColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate=t},enumerable:!0,configurable:!0}),e.prototype.getLocalMouseX=function(t){return t.transform.inverseConcatenatedMatrix3D.transformVector(this._renderer.view.unproject(this._view.stage.screenX,this._view.stage.screenY,1e3)).x},e.prototype.getLocalMouseY=function(t){return t.transform.inverseConcatenatedMatrix3D.transformVector(this._renderer.view.unproject(this._view.stage.screenX,this._view.stage.screenY,1e3)).y},e.prototype.getLocalTouchPoints=function(t){for(var e,i=new Array,n=this._view.stage.touchPoints.length,r=0;r<n;r++)e=t.transform.inverseConcatenatedMatrix3D.transformVector(this._renderer.view.unproject(this._view.stage.touchPoints[r].x,this._view.stage.touchPoints[r].y,1e3)),i.push(new Oe(e.x,e.y,this._view.stage.touchPoints[r].id));return i},Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleModeAllowUpdate&&(this._scaleMode=t,this.resizeCallback())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showFrameRate",{get:function(){return this._showFrameRate},set:function(t){var e=this;t!=this._showFrameRate&&(this._showFrameRate=t,t?(this._fpsTextField=document.createElement("div"),this._fpsTextField.style.cssFloat="none",this._fpsTextField.style.backgroundColor="#000",this._fpsTextField.style.position="fixed",this._fpsTextField.style.top="5px",this._fpsTextField.style.width="100px",this._fpsTextField.style.height="20px",this._fpsTextField.style.right="5px",this._fpsTextField.style.textAlign="center",this._fpsTextField.style.color="#ffffff",this._fpsTextField.style.fontSize="16",this._fpsTextField.style.visibility="hidden",this._fpsTextField.innerHTML="",document.body.appendChild(this._fpsTextField),this._showFrameRateIntervalID=setInterval((function(){return e.updateFPS()}),1e3)):this._showFrameRateIntervalID&&(clearInterval(this._showFrameRateIntervalID),this._showFrameRateIntervalID=-1,document.body.removeChild(this._fpsTextField),this._fpsTextField=null))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageHeight",{get:function(){return this._stageHeight},set:function(t){this._stageHeight=t,this.resizeCallback()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageWidth",{get:function(){return this._stageWidth},set:function(t){this._stageWidth=t,this.resizeCallback()},enumerable:!0,configurable:!0}),e.runtimeStartTime=0,e._instance=null,e.forceINT=!1,e}(u),sf=[];function af(t,e){var i=void 0;return(e?sf.concat(e):sf).forEach((function(e){var n=e.test,r=e.resolve,o=e.supressErrors,s=void 0!==o&&o,a=e.supressLoad,l=void 0!==a&&a,u=!1;"function"==typeof n?u=n(t):n instanceof RegExp?u=n.test(t):"string"==typeof n&&(u=n===t),u&&(i&&console.warn("[LOADER] Duplicate redirect rules, latest rule would be used!"),i={url:t,supressErrors:s,supressLoad:l},"function"==typeof r?i.url=r(t):r instanceof RegExp?i.url=t.match(r)[0]:"string"==typeof r?i.url=r:"string"==typeof u&&(i.url=u),void 0===i.url&&(console.warn("[LOADER] Redirect url is null, would be used  original url!"),i.url=t))})),i}(function(t){function e(e,i,n){var r=t.call(this,i)||this;return r._symbol=e,r.dataClass=n,r.isGeneric=!0,r}i(e,t),Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._symbol=null},e.prototype.clone=function(){return new e(this._symbol,this.name,this.dataClass)},e.assetType="[asset Generic]"})(p),function(e){function n(t){void 0===t&&(t=null);var i=e.call(this,nt.ARRAY_BUFFER)||this;return i._awayUnresolvedSymbols={},i._isEncrypted=!1,i._currentEncrActionBlocks=[],i.soundExports={},i.externalDependenciesCount=0,i._factory=t,i}i(n,e),Object.defineProperty(n.prototype,"awayUnresolvedSymbols",{get:function(){return this._awayUnresolvedSymbols},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"awaySymbols",{get:function(){return this._symbolDecoder.awaySymbols},enumerable:!0,configurable:!0}),n.supportsType=function(t){return t=t.toLowerCase(),console.log("SWFParser supportsType extension: ",t,"result: ","swf"==t),"swf"==t},n.supportsData=function(t){return(67===t[0]||70===t[0]||90===t[0])&&87===t[1]&&83===t[2]},n.prototype._pProceedParsing=function(){var t=this._pGetByteData(),e=new Uint8Array(t.arraybytes);if(!n.supportsData(e)){var i=e.slice(0,3).reverse().reduce((function(t,e){return t+String.fromCharCode(e)}),"");return console.error("[SWF Parser] unknow file type:",i),this.parsingFailure=!0,!1}if(ef.rec("parser").begin(),this.initSWFLoading(e,e.length),ef.rec("ABCExtractor").rec("dump").begin(),this.abcBlocks.length){console.log("abcblocks:",this.abcBlocks);var r=[],o=0,s=0;this.abcBlocks.sort((function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}));for(var a=0;a<this.abcBlocks.length;a++){var l=this.abcBlocks[a].name.replace(/\//g,"."),u=l.lastIndexOf(".");u>=0&&(l=l.substring(0,u)+":"+l.substring(u+1)),r.push({name:this.abcBlocks[a].name,defs:[l],offset:o,length:this.abcBlocks[a].data.length}),o+=this.abcBlocks[a].data.length,s+=this.abcBlocks[a].data.length}o=0;var c=new Uint8Array(s);for(a=0;a<this.abcBlocks.length;a++)c.set(this.abcBlocks[a].data,o),o+=this.abcBlocks[a].data.length;console.log("jsonCatalog",r),console.log("allData",c);var h=document.createElement("a");h.style.display="none",document.body.appendChild(h);var p=new Blob([c.buffer],{type:"text/plain"}),d=URL.createObjectURL(p);h.href=d,h.href=URL.createObjectURL(p),h.download="playerglobal.abcs",h.click();var f=new Blob([JSON.stringify(r)],{type:"text/plain"}),_=URL.createObjectURL(p);h.href=_,h.href=URL.createObjectURL(f),h.download="catalog.json",h.click()}return ef.rec("ABCExtractor").rec("dump").end(),ef.rec("parser").end(),mt.PARSING_DONE},n.prototype._pStartParsing=function(t){e.prototype._pStartParsing.call(this,t)},n.prototype.dispose=function(){this.swfData=null,this._dataStream=null},n.prototype.updateTimers=function(t){},n.prototype.initSWFLoading=function(t,e){co(67===t[0]||70===t[0]||90===t[0],"Unsupported compression format: "+t[0]),co(87===t[1]),co(83===t[2]),co(t.length>=30,"At least the header must be complete here."),this.bytesTotal=e,this.abcBlocks=[],this.dictionary=[],this.fonts=[],this.symbolClassesMap=[],this.symbolClassesList=[],this.eagerlyParsedSymbolsMap=[],this.eagerlyParsedSymbolsList=[],this._jpegTables=null,this._currentFrameLabels=[],this._currentSoundStreamHead=null,this._currentSoundStreamBlock=null,this._currentControlTags=null,this._currentActionBlocks=null,this._currentInitActionBlocks=null,this._currentExports=null,this._endTagEncountered=!1,this._isEncrypted=!1,this._currentEncrActionBlocks=null,this.readHeaderAndInitialize(t)},n.prototype.finishLoading=function(){this.compression!==t.None&&(this._decompressor.close(),this._decompressor=null,this.scanLoadedData())},n.prototype.getParsedTag=function(t){this._dataStream.align(),this._dataStream.pos=t.byteOffset;var e=xd[t.tagCode],i=Math.min(t.byteOffset+t.byteLength,this._dataStream.end),n=e(this._dataStream,this.swfVersion,t.tagCode,i,this._jpegTables);return this._dataStream.pos!==i&&this.emitTagSlopWarning(t,i),function(t,e,i){var n;switch(t.code){case 6:case 21:case 35:case 90:n=Gd(t);break;case 20:case 36:n=Nd(t);break;case 7:case 34:n=Md(t,e);break;case 37:n=Bd(t);break;case 10:case 48:case 75:case 91:n=Pd(t,i._iFileName);break;case 46:case 84:case 2:case 22:case 32:case 83:n=wd(t,i);break;case 14:n=gp(t);break;case 60:return{type:"video",id:t.id,width:t.width,height:t.height,deblocking:t.deblocking,smoothing:t.smoothing,codec:t.codecId};case 39:return t;case 87:return{type:"binary",id:t.id,data:t.data};case 11:case 33:n=Qd(t);break;default:return t}return n}(n,this.dictionary,this)},n.prototype.readHeaderAndInitialize=function(e){var i,n=67===e[0],r=90===e[0];n?this.compression=t.Deflate:r&&(this.compression=t.LZMA),this.swfVersion=e[3],this._loadStarted=Date.now(),this._uncompressedLength=((i=e)[4]|i[5]<<8|i[6]<<16|i[7]<<24)>>>0,this.bytesLoaded=e.length,this.swfData=new Uint8Array(this.compression===t.None?this.bytesTotal:this._uncompressedLength),this._dataStream=new Hp(this.swfData.buffer),this._dataStream.pos=8,this._dataView=this._dataStream.view,n?(this.swfData.set(e.subarray(0,8)),this._uncompressedLoadedLength=8,this._decompressor=Uo.create(!0),this._decompressor.onData=this.processFirstBatchOfDecompressedData.bind(this),this._decompressor.onError=function(t){throw new Error(t)},this._decompressor.push(e.subarray(8))):r?(this.swfData.set(e.subarray(0,8)),this._uncompressedLoadedLength=8,this._decompressor=new ps(!0),this._decompressor.onData=this.processFirstBatchOfDecompressedData.bind(this),this._decompressor.onError=function(t){},this._decompressor.push(e)):(this.swfData.set(e),this._uncompressedLoadedLength=e.length,this._decompressor=null,this.parseHeaderContents()),this._lastScanPosition=this._dataStream.pos,this.scanLoadedData()},n.prototype.parseHeaderContents=function(){Cd(this._dataStream)},n.prototype.processFirstBatchOfDecompressedData=function(t){ef.rec("parser").rec("unzip").begin(),this.processDecompressedData(t),this.parseHeaderContents(),this._decompressor.onData=this.processDecompressedData.bind(this)},n.prototype.processDecompressedData=function(t){ef.rec("parser").rec("unzip").end();var e=Math.min(t.length,this._uncompressedLength-this._uncompressedLoadedLength);ho(this.swfData,t,this._uncompressedLoadedLength,0,e),this._uncompressedLoadedLength+=e},n.prototype.scanLoadedData=function(){this._dataStream.pos=this._lastScanPosition,ef.rec("parser").rec("scanTags").begin(),this.scanTagsToOffset(this._uncompressedLoadedLength,!0),ef.rec("parser").rec("scanTags").end(),this._lastScanPosition=this._dataStream.pos},n.prototype.scanTagsToOffset=function(t,e){for(var i,n=new wo(0,0,0);(i=this._dataStream.pos)<t-1&&this.parseNextTagHeader(n);){if(0===n.tagCode)return void(e&&(this._endTagEncountered=!0));var r=n.byteOffset+n.byteLength;if(r>t)return void(this._dataStream.pos=i);this.scanTag(n,e),this._dataStream.pos!==r&&this.emitTagSlopWarning(n,r)}},n.prototype.parseNextTagHeader=function(t){var e=this._dataStream.pos,i=this._dataView.getUint16(e,!0);e+=2,t.tagCode=i>>6;var n=63&i;if(63===n){if(e+4>this._uncompressedLoadedLength)return!1;n=this._dataView.getUint32(e,!0),e+=4}return this._dataStream.pos=e,t.byteOffset=e,t.byteLength=n,!0},n.prototype.Utf8ArrayToStr=function(t){var e,i,n,r,o,s;for(e="",n=t.length,i=0;i<n;)switch((r=t[i++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(r);break;case 12:case 13:o=t[i++],e+=String.fromCharCode((31&r)<<6|63&o);break;case 14:o=t[i++],s=t[i++],e+=String.fromCharCode((15&r)<<12|(63&o)<<6|(63&s)<<0)}return e},n.prototype.scanTag=function(t,e){var i,n,r=this._dataStream,o=r.pos;co(o===t.byteOffset);var s=t.tagCode,a=t.byteLength;if(39===s){this.addLazySymbol(s,o,a);var l=o+a;return r.pos+=4,this.scanTagsToOffset(l,!1),void(this._dataStream.pos!==l&&this.emitTagSlopWarning(t,l))}if(Gp[s]){var u=this.addLazySymbol(s,o,a);this.decodeEmbeddedImage(u)}else{if(14===s){u=this.addLazySymbol(s,o,a);var c=this.getParsedTag(u),h=new Eo(c.id,u,"sound",c);return this.eagerlyParsedSymbolsMap[h.id]=h,void this.eagerlyParsedSymbolsList.push(h)}if(Qp[s]){u=this.addLazySymbol(s,o,a);this.registerEmbeddedFont(u)}else{if(jp[s])return this.addLazySymbol(s,o,a),void this.jumpToNextTag(a);if(e||76===s||56===s)if(zp[s])this.addControlTag(s,o,a);else switch(s){case 69:this.setFileAttributes(a);break;case 86:this.setSceneAndFrameLabelData(a);break;case 9:break;case 8:this._jpegTables||(this._jpegTables=0===a?new Uint8Array(0):this.swfData.subarray(r.pos,r.pos+a-2)),this.jumpToNextTag(a);break;case 82:case 72:if(this.useAVM1)this.jumpToNextTag(a);else{var p=o+a,d=new xo;82===s?(d.flags=r.readUi32(),d.name=r.readString(-1)):(d.flags=0,d.name=""),d.data=this.swfData.subarray(r.pos,p),this.abcBlocks.push(d),r.pos=p}break;case 76:p=o+a;for(var f=r.readUi16();f--;){var _=r.readUi16(),m=r.readString(-1);this.symbolClassesMap[_]=m,this.symbolClassesList.push({id:_,className:m})}r.pos=p;break;case 59:if(this.useAVM1){var g=this._currentInitActionBlocks||(this._currentInitActionBlocks=[]),y=this._dataView.getUint16(r.pos,!0),A=this.swfData.subarray(o+2,o+a),v=this._isEncrypted?null===(i=this._currentEncrActionBlocks)||void 0===i?void 0:i.pop():void 0;g.push({spriteId:y,actionsData:A,encryptedData:v})}this.jumpToNextTag(a);break;case 12:if(this.useAVM1){var b=this._currentActionBlocks||(this._currentActionBlocks=[]);A=this.swfData.subarray(r.pos,r.pos+a),v=this._isEncrypted?null===(n=this._currentEncrActionBlocks)||void 0===n?void 0:n.pop():void 0;b.push({actionsData:A,precedence:r.pos,encryptedData:v})}this.jumpToNextTag(a);break;case 18:case 45:var x=hd(this._dataStream,o+a);this._currentSoundStreamHead=bp.FromTag(x);break;case 19:this._currentSoundStreamBlock=this.swfData.subarray(r.pos,r.pos+=a);break;case 43:p=r.pos+a;this._currentFrameLabels[this._currentFrameLabels.length]=r.readString(-1),r.pos=p;break;case 1:this.finishFrame();break;case 0:return;case 56:p=r.pos+a;for(var C=r.readUi16(),w=this._currentExports||(this._currentExports=[]);C--;){_=r.readUi16();var I=r.readString(-1);if(r.pos>p){r.pos=p;break}w.push(new Co(_,I))}r.pos=p;break;case 17:p=r.pos+a,r.readUi16();r.readUi16(),cd(r),r.pos=p;break;case 78:var E=this.getParsedTag(t);this.dictionary[E.symbolId].scalingGrid=E.splitter;break;case 23:case 13:case 62:case 57:case 71:this.jumpToNextTag(a);break;case 77:this.parseMetaData(a);break;case 74:case 73:case 65:case 66:case 58:case 64:case 63:case 88:case 40:case 41:case 24:case 25:case 93:case 55:case 49:this.jumpToNextTag(a);break;case 51:case 44:case 50:case 53:case 42:case 38:case 52:case 3:case 31:case 47:case 16:case 29:this.jumpToNextTag(a);break;case 255:console.log("Tag 255 present. SWF is encrypted"),this._isEncrypted=!0,this.jumpToNextTag(a);break;case 253:if(this._isEncrypted){var S=this._currentEncrActionBlocks||(this._currentEncrActionBlocks=[]),D=this.swfData.subarray(o+2,o+a);S.push({data:D,bytePos:o+2,size:a,rawTagId:s})}this.jumpToNextTag(a);break;default:s>100?console.log("Encountered undefined tag "+s+", probably used for AVM1 obfuscation. See http://ijs.mtasa.com/files/swfdecrypt.cpp."):console.log("Tag not handled by the parser: "+s+": "+Xp(s)),this.jumpToNextTag(a)}else this.jumpToNextTag(a)}}},n.prototype.parseSpriteTimeline=function(t){var e=this.swfData,i=this._dataStream,n=this._dataView,r={id:t.id,type:"sprite",frames:[]},o=t.byteOffset+t.byteLength,s=r.frames,a=[],l=[],u=null,c=null,h=null,p=null;i.pos=t.byteOffset+2,r.frameCount=n.getUint16(i.pos,!0),i.pos+=2;for(var d=new wo(0,0,0);i.pos<o;){this.parseNextTagHeader(d);var f=d.byteLength,_=d.tagCode;if(i.pos+f>o){console.log("DefineSprite child tags exceed DefineSprite tag length and are dropped");break}if(zp[_])l.push(new wo(_,i.pos,f)),i.pos+=f;else{switch(_){case 12:if(this.useAVM1){h||(h=[]);var m=e.subarray(i.pos,i.pos+f);h.push({actionsData:m,precedence:i.pos})}break;case 59:if(this.useAVM1){p||(p=[]);var g=n.getUint16(i.pos,!0);i.pos+=2;m=e.subarray(i.pos,i.pos+f);p.push({spriteId:g,actionsData:m})}break;case 43:var y=i.pos+f;a[a.length]=i.readString(-1),i.pos=y,f=0;break;case 1:s.push(new zd(l,a.concat(),u,c,h,p,null)),a.length=0,l=[],u=null,c=null,h=null,p=null;break;case 0:i.pos=o,f=0;break;case 18:case 45:var A=i.pos,v=hd(i,y=i.pos+f);u=bp.FromTag(v),i.pos=A;break;case 19:A=i.pos,y=i.pos+f;c=this.swfData.subarray(i.pos,y),i.pos=A}i.pos+=f,co(i.pos<=o)}}return r},n.prototype.parseMetaData=function(t){this._dataStream.pos+=t},n.prototype.jumpToNextTag=function(t){this._dataStream.pos+=t},n.prototype.emitTagSlopWarning=function(t,e){this._dataStream.pos,t.byteOffset;this._dataStream.pos=e},n.prototype.finishFrame=function(){},n.prototype.setFileAttributes=function(t){this.attributes&&this.jumpToNextTag(t);var e=this.swfData[this._dataStream.pos];this._dataStream.pos+=4,this.attributes={network:1&e,relativeUrls:2&e,noCrossDomainCaching:4&e,doAbc:8&e,hasMetadata:16&e,useGpu:32&e,useDirectBlit:64&e},this.useAVM1=!this.attributes.doAbc},n.prototype.setSceneAndFrameLabelData=function(t){this.jumpToNextTag(t)},n.prototype.addControlTag=function(t,e,i){(this._currentControlTags||(this._currentControlTags=[])).push(new wo(t,e,i)),this.jumpToNextTag(i)},n.prototype.addLazySymbol=function(t,e,i){var n=this._dataView.getUint16(this._dataStream.pos,!0),r=new Io(n,t,e,i);return this.dictionary[n]=r,r},n.prototype.decodeEmbeddedFont=function(t){var e=this.getParsedTag(t),i=new Eo(e.id,t,"font",e);this.eagerlyParsedSymbolsMap[i.id]=i,this.eagerlyParsedSymbolsList.push(i);var n=lf(e.bold,e.italic);this.fonts.push({name:e.name,id:e.id,style:n})},n.prototype.registerEmbeddedFont=function(t){var e,i,n=this._dataStream,r=this._dataView.getUint16(n.pos,!0);if(10===t.tagCode)i="__autofont__"+t.byteOffset,e="regular";else{var o=this.swfData[n.pos+2];e=lf(!!(1&o),!!(2&o));var s=this.swfData[n.pos+4];n.pos+=5,i=n.readString(s)}this.fonts.push({name:i,id:r,style:e}),n.pos=t.byteOffset+t.byteLength},n.prototype.decodeEmbeddedImage=function(t){var e=this.getParsedTag(t),i=new Eo(e.id,t,"image",e);this.eagerlyParsedSymbolsMap[i.id]=i,this.eagerlyParsedSymbolsList.push(i)},n.factory=null}(mt);function lf(t,e){return t&&e?"boldItalic":t?"bold":e?"italic":"regular"}var uf={instance:void 0};function cf(t){var e=Object.prototype.hasOwnProperty,i=[];for(var n in t)e.call(t,n)&&i.push([n,t[n]]);return i}function hf(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function pf(t,e){do{var i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Object.getPrototypeOf(t)}while(t);return null}function df(t,e,i){Object.defineProperty(t,e,{value:i,writable:!1,configurable:!0,enumerable:!1})}function ff(t,e,i,n,r){for(var o in void 0===i&&(i=null),void 0===n&&(n=!0),void 0===r&&(r=!1),e)if(hf(e,o)&&(!i||i(o))){var s=Object.getOwnPropertyDescriptor(e,o);if(!n&&hf(t,o))continue;try{r&&!1===s.writable&&(s.writable=!0),Object.defineProperty(t,o,s)}catch(t){np("Can't define: "+o)}}}function _f(t,e,i){for(var n=0;n<i.length;n++){var r=i[n];t[r]=e[r]}}function mf(t,e,i){Object.defineProperty(t,e,{value:i,writable:!0,configurable:!0,enumerable:!1})}var gf={boxValue:function(t){return Xh(t)||Gh(t)?t:Object(t)},toKeyValueArray:cf,isPrototypeWriteable:function(t){return Object.getOwnPropertyDescriptor(t,"prototype").writable},hasOwnProperty:hf,propertyIsEnumerable:function(t,e){return Object.prototype.propertyIsEnumerable.call(t,e)},getPropertyDescriptor:pf,hasOwnGetter:function(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return!(!i||!i.get)},getOwnGetter:function(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return i?i.get:null},hasOwnSetter:function(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return!(!i||!i.set)},createArrayMap:function(){return[]},createMap:function(){return Object.create(null)},defineReadOnlyProperty:df,copyProperties:function(t,e){for(var i in e)t[i]=e[i]},copyOwnProperties:function(t,e){for(var i in e)hf(e,i)&&(t[i]=e[i])},copyOwnPropertyDescriptors:ff,copyPropertiesByList:_f,defineNonEnumerableGetter:function(t,e,i){Object.defineProperty(t,e,{get:i,configurable:!0,enumerable:!1})},defineNonEnumerableProperty:mf};function yf(t,e,i){for(var n=e-1;n>=0;n--)i[n]=t.pop();i.length=e}function Af(t,e){for(var i=0;i<e.length;i++)t.push(e[i])}var vf={setClipboard:function(t){}},bf=(function(){function t(){this.isAS3TraceOn=!0,this._startTime=Date.now()}Object.defineProperty(t.prototype,"currentTimestamp",{get:function(){return Date.now()-this._startTime},enumerable:!0,configurable:!0}),t.prototype._writeLine=function(t){},t.prototype.writeAS3Trace=function(t){this.isAS3TraceOn&&this._writeLine(this.currentTimestamp+" AVMINF: "+t)}}(),new Uint8Array([7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21])),xf=new Int32Array([-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]);var Cf={_md5R:bf,_md5K:xf,hashBytesTo32BitsMD5:function(t,e,i){var n,r,o,s=bf,a=xf,l=1732584193,u=-271733879,c=-1732584194,h=271733878,p=i+72&-64,d=new Uint8Array(p);for(n=0;n<i;++n)d[n]=t[e++];for(d[n++]=128,o=p-8;n<o;)d[n++]=0;d[n++]=i<<3&255,d[n++]=i>>5&255,d[n++]=i>>13&255,d[n++]=i>>21&255,d[n++]=i>>>29&255,d[n++]=0,d[n++]=0,d[n++]=0;var f=new Int32Array(16);for(n=0;n<p;){for(r=0;r<16;++r,n+=4)f[r]=d[n]|d[n+1]<<8|d[n+2]<<16|d[n+3]<<24;var _,m,g=l,y=u,A=c,v=h;for(r=0;r<64;++r){r<16?(_=y&A|~y&v,m=r):r<32?(_=v&y|~v&A,m=5*r+1&15):r<48?(_=y^A^v,m=3*r+5&15):(_=A^(y|~v),m=7*r&15);var b=v,x=g+_+a[r]+f[m]|0,C=s[r];v=A,A=y,y=y+(x<<C|x>>>32-C)|0,g=b}l=l+g|0,u=u+y|0,c=c+A|0,h=h+v|0}return l},mixHash:function(t,e){return(31*t|0)+e|0}},wf=function t(e){var i;switch(typeof e){case"boolean":return e?"<true/>":"<false/>";case"number":return"<number>"+e+"</number>";case"object":if(null===e)return"<null/>";if("hasOwnProperty"in e&&e.hasOwnProperty("length")){i="<array>";for(var n=0;n<e.length;n++)i+='<property id="'+n+'">'+t(e[n])+"</property>";return i+"</array>"}for(var r in i="<object>",e)i+='<property id="'+r+'">'+t(e[r])+"</property>";return i+"</object>";case"string":return"<string>"+e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</string>";case"undefined":return"<undefined/>"}},If=function(){function t(){}return Object.defineProperty(t,"interfaceID",{get:function(){return t._interfaceID},set:function(e){t._interfaceID=e},enumerable:!0,configurable:!0}),t.ensureInit=function(){window[t._interfaceID]||(window[t._interfaceID]={}),window[t._interfaceID].__flash__toXML=wf},t.initJS=function(e){t.callback=e},t.registerCallback=function(e){t.ensureInit(),window[t._interfaceID][e]=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return t.callback(e,i)}},t.unregisterCallback=function(e){t.ensureInit(),delete window[t._interfaceID][e]},t.eval=function(t){try{return window.eval(t)}catch(e){console.warn("[ExternalInterfaceService] Eval crashed:\n",t,"\n"+e.message)}},t.call=function(t){},t.getId=function(){return null},t.enabled=!0,t._interfaceID="flash",t}();console.debug("AwayFL - SWF-Loader - 0.4.79");var Ef=function(t,e,i,n,r){this.flags=t,this.value=e,this.get=i,this.set=n,this.watcher=r},Sf=function(t){function e(e){var i=t.call(this)||this;i.initialDepth=0,i.scriptRefsToChilds={},i._avm1Context=e,i._ownProperties=Object.create(null),i.scriptRefsToChilds={},i._prototype=null,i._blockedByScript=!1,i._ctBlockedByScript=!1,i._visibilityByScript=!1;var n=i,r=new Ef(131,null,{alCall:function(t,e){return n.alPrototype}},{alCall:function(t,e){n.alPrototype=e[0]}});return i.alSetOwnProperty("__proto__",r),i}return i(e,t),Object.defineProperty(e.prototype,"eventObserver",{get:function(){return this._eventObserver},set:function(t){this._eventObserver=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){},e.prototype.updateFilters=function(t){},e.prototype.isBlockedByScript=function(){return this._blockedByScript},e.prototype.isColorTransformByScript=function(){return this._ctBlockedByScript},e.prototype.isVisibilityByScript=function(){return this._visibilityByScript},e.prototype.initAdapter=function(){},e.prototype.freeFromScript=function(){this.protoTypeChanged=!1,this._blockedByScript=!1,this._ctBlockedByScript=!1,this._visibilityByScript=!1},e.prototype.clone=function(){return new e(this._avm1Context)},Object.defineProperty(e.prototype,"context",{get:function(){return this._avm1Context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alPrototype",{get:function(){return this._prototype},set:function(t){for(var e=t;e;){if(e===this)return;e=e.alPrototype}this._prototype=t},enumerable:!0,configurable:!0}),e.prototype.alGetPrototypeProperty=function(){return this.alGet("prototype")},e.prototype.alSetOwnPrototypeProperty=function(t){this.alSetOwnProperty("prototype",new Ef(65,t))},e.prototype.alGetConstructorProperty=function(){return this.alGet("__constructor__")},e.prototype.alSetOwnConstructorProperty=function(t){this.alSetOwnProperty("__constructor__",new Ef(65,t))},e.prototype._debugEscapeProperty=function(t){var e=this.context,i=zm(e,t);return e.isPropertyCaseSensitive||(i=i.toLowerCase()),"$Bg"+i},e.prototype.alGetOwnProperty=function(t){return"string"!=typeof t||this.context.isPropertyCaseSensitive||(t=t.toLowerCase()),this._ownProperties[t]},e.prototype.alSetOwnProperty=function(t,e){var i=this.context.normalizeName(t);e.originalName||this.context.isPropertyCaseSensitive||(e.originalName=t),this._ownProperties[i]=e},e.prototype.alHasOwnProperty=function(t){var e=this.context.normalizeName(t);return!!this._ownProperties[e]},e.prototype.alDeleteOwnProperty=function(t){var e=this.context.normalizeName(t);delete this._ownProperties[e]},e.prototype.deleteOwnProperties=function(){for(var t=this.alGetOwnPropertiesKeys(),e=0;e<t.length;e++)this.alDeleteOwnProperty(t[e])},e.prototype.alGetOwnPropertiesKeys=function(){var t,e=[];if(this.context.isPropertyCaseSensitive)for(var i in this._ownProperties)1&(t=this._ownProperties[i]).flags||e.push(i);else for(var n in this._ownProperties)1&(t=this._ownProperties[n]).flags||e.push(t.originalName);return e},e.prototype.alGetProperty=function(t){var e=this.alGetOwnProperty(t);return e||(this._prototype?this._prototype.alGetProperty(t):void 0)},e.prototype.alGet=function(t){var e=this.context.normalizeName(t),i=this.alGetProperty(e);if(i){if(64&i.flags)return i.value&&i.value.nodeValue?i.value.nodeValue:i.value;var n=i.get;if(n)return n.alCall(this)}},e.prototype.alCanPut=function(t){var e=this.alGetOwnProperty(t);if(e)return 128&e.flags?!!e.set:!(4&e.flags);var i=this._prototype;return!i||i.alCanPut(t)},e.prototype.alPut=function(t,e){var i=t;if(t=this.context.normalizeName(t),e&&"object"==typeof e&&"symbol"===e.avmType&&"this"!=t&&"_parent"!=t&&!e.dynamicallyCreated&&e.adaptee&&e.adaptee.parent&&e.adaptee.parent.adapter&&e.adaptee.parent.adapter.scriptRefsToChilds&&(e.adaptee.parent.adapter.scriptRefsToChilds[e.adaptee.name]={obj:this,name:t}),this.alCanPut(t)){var n=this.alGetOwnProperty(t);if(n&&64&n.flags)return n.watcher&&(e=n.watcher.callback.alCall(this,[n.watcher.name,n.value,e,n.watcher.userData])),void(t in this._ownProperties?n.value=e:this.alSetOwnProperty(i,new Ef(n.flags,e)));if(void 0!==e||"_x"!=t&&"_y"!=t&&"_xscale"!=t&&"_yscale"!=t&&"_width"!=t&&"_height"!=t){var r=this.alGetProperty(t);if(r&&128&r.flags){if(r.watcher){var o=r.get?r.get.alCall(this):void 0;e=r.watcher.callback.alCall(this,[r.watcher.name,o,e,r.watcher.userData])}r.set.alCall(this,[e])}else if(r&&r.watcher&&(e=r.watcher.callback.alCall(this,[r.watcher.name,r.value,e,r.watcher.userData])),e&&e.isTextVar){e=e.value,(s=new Ef(r?r.flags:64,e)).isTextVar=!0,this.alSetOwnProperty(i,s)}else{var s=new Ef(r?r.flags:64,e);this.alSetOwnProperty(i,s)}}}},e.prototype.alHasProperty=function(t){return!!this.alGetProperty(t)},e.prototype.alDeleteProperty=function(t){var e=this.alGetOwnProperty(t);return!e||!(2&e.flags)&&(this.alDeleteOwnProperty(t),!0)},e.prototype.alAddPropertyWatcher=function(t,e,i){var n=this.alGetProperty(t);return!!n&&(n.watcher={name:t,callback:e,userData:i},!0)},e.prototype.alRemotePropertyWatcher=function(t){var e=this.alGetProperty(t);return!(!e||!e.watcher)&&(e.watcher=void 0,!0)},e.prototype.alDefaultValue=function(t){if(void 0===t&&(t=0),1===t){var e=this.alGet(this.context.normalizeName("toString"));if(Zm(e))return e.alCall(this);if(Zm(i=this.alGet(this.context.normalizeName("valueOf"))))return i.alCall(this)}else{var i;if(Zm(i=this.alGet(this.context.normalizeName("valueOf"))))return i.alCall(this);var n=this.alGet(this.context.normalizeName("toString"));if(Zm(n))return n.alCall(this)}return this},e.prototype.alGetKeys=function(){var t=this.alGetOwnPropertiesKeys(),e=this._prototype;if(!e)return t;var i=e.alGetKeys();if(0===t.length)return i;var n,r=this.context;if(r.isPropertyCaseSensitive){var o=Object.create(null),s=t.length;for(n=0;n<s;n++)o[t[n]]=!0;var a=i.length;for(n=0;n<a;n++)o[i[n]]=!0;return Object.getOwnPropertyNames(o)}var l=[t,i],u=Object.create(null),c=[],h=void 0,p=void 0,d=void 0;for(n=0;n<l.length;n++){h=l[n];for(var f=0;f<h.length;f++)p=h[f],u[d=r.normalizeName(p)]||(u[d]=!0,c.push(p))}return c},e}((function(){})),Df=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Function.alGetPrototypeProperty(),i.isOnEnter=!1,i}return i(e,t),e.prototype.alConstruct=function(t){throw new Error("not implemented AVM1Function.alConstruct")},e.prototype.alCall=function(t,e){throw new Error("not implemented AVM1Function.alCall")},e.prototype.toJSFunction=function(t){void 0===t&&(t=null);var e=this,i=this.context;return function(){var n=Array.prototype.slice.call(arguments,0);return i.executeFunction(e,t,n)}},e}(Sf);function Tf(t){if(!t)return new D(0,0);var e,i,n=t.context;return t instanceof Sf&&(e=Km(n,t.alGet("x")),i=Km(n,t.alGet("y"))),new D(e,i)}function Pf(t,e){e.alPut("x",t.x),e.alPut("y",t.y)}var Bf=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.alPrototype=e.globals.Point.alGetPrototypeProperty(),r.alPut("x",i),r.alPut("y",n),r}return i(e,t),e.fromAS3Point=function(t,i){return new e(t,i.x,i.y)},e}(Sf),Mf=function(t){function e(e){var i=t.call(this,e)||this;return rg(i,{prototype:{value:new Of(e,i)},distance:{value:i.distance,writable:!0},interpolate:{value:i.interpolate,writable:!0},polar:{value:i.polar,writable:!0}}),i}return i(e,t),e.prototype.alCall=function(t,e){return this.alConstruct(e)},e.prototype.alConstruct=function(t){return t&&t.length>0?new Bf(this.context,t[0],t[1]):new Bf(this.context,0,0)},e.prototype.distance=function(t,e){return D.distance(Tf(t),Tf(e))},e.prototype.interpolate=function(t,e,i){i=jm(this.context,i);var n=D.interpolate(Tf(t),Tf(e),i);return Bf.fromAS3Point(this.context,n)},e.prototype.polar=function(t,e){return t=jm(this.context,t),e=jm(this.context,e),Bf.fromAS3Point(this.context,D.polar(t,e))},e}(Df),Of=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(n,{constructor:{value:i,writable:!0},length:{get:n.getLength},add:{value:n.add,writable:!0},clone:{value:n.clone,writable:!0},equals:{value:n.equals,writable:!0},normalize:{value:n.normalize,writable:!0},offset:{value:n.offset,writable:!0},subtract:{value:n.subtract,writable:!0},toString:{value:n._toString,writable:!0}}),n}return i(e,t),e.prototype.getLength=function(){return Tf(this).length},e.prototype.add=function(t){return Bf.fromAS3Point(this.context,Tf(this).add(Tf(t)))},e.prototype.clone=function(){var t=new Bf(this.context);return this instanceof Sf&&(t.alPut("x",this.alGet("x")),t.alPut("y",this.alGet("y"))),t},e.prototype.equals=function(t){return Tf(this).equals(Tf(t))},e.prototype.normalize=function(t){t=jm(this.context,t);var e=Tf(this);e.normalize(t),Pf(e,this)},e.prototype.offset=function(t,e){t=jm(this.context,t),e=jm(this.context,e);var i=Tf(this);i.offset(t,e),Pf(i,this)},e.prototype.subtract=function(t){return Bf.fromAS3Point(this.context,Tf(this).subtract(Tf(t)))},e.prototype._toString=function(){return"(x="+this.alGet("x")+", y="+this.alGet("y")+")"},e}(Sf);function Lf(t){var e,i,n,r,o=t.context;return t instanceof Sf&&(e=Km(o,t.alGet("x")),i=Km(o,t.alGet("y")),n=Km(o,t.alGet("width")),r=Km(o,t.alGet("height"))),new Y(e,i,n,r)}function Rf(t,e){e.alPut("x",t.x),e.alPut("y",t.y),e.alPut("width",t.width),e.alPut("height",t.height)}var Nf=function(t){function e(e,i,n,r,o){var s=t.call(this,e)||this;return s.alPrototype=e.globals.Rectangle.alGetPrototypeProperty(),s.alPut("x",i),s.alPut("y",n),s.alPut("width",r),s.alPut("height",o),s}return i(e,t),e.fromAS3Rectangle=function(t,i){return new e(t,i.x,i.y,i.width,i.height)},e}(Sf),Ff=function(t){function e(e){var i=t.call(this,e)||this;return rg(i,{prototype:{value:new kf(e,i)}}),i}return i(e,t),e.prototype.alConstruct=function(t){return t&&t.length>0?new Nf(this.context,t[0],t[1],t[2],t[3]):new Nf(this.context,0,0,0,0)},e}(Df),kf=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(n,{constructor:{value:i,writable:!0},bottom:{get:n.getBottom,set:n.setBottom},bottomRight:{get:n.getBottomRight,set:n.setBottomRight},left:{get:n.getLeft,set:n.setLeft},right:{get:n.getRight,set:n.setRight},size:{get:n.getSize,set:n.setSize},top:{get:n.getTop,set:n.setTop},topLeft:{get:n.getTopLeft,set:n.setTopLeft},clone:{value:n.clone,writable:!0},contains:{value:n.contains,writable:!0},containsPoint:{value:n.containsPoint,writable:!0},containsRectangle:{value:n.containsRectangle,writable:!0},equals:{value:n.equals,writable:!0},inflate:{value:n.inflate,writable:!0},inflatePoint:{value:n.inflatePoint,writable:!0},intersection:{value:n.intersection,writable:!0},intersects:{value:n.intersects,writable:!0},isEmpty:{value:n.isEmpty,writable:!0},offset:{value:n.offset,writable:!0},offsetPoint:{value:n.offsetPoint,writable:!0},setEmpty:{value:n.setEmpty,writable:!0},toString:{value:n._toString,writable:!0},union:{value:n.union,writable:!0}}),n}return i(e,t),e.prototype.getBottom=function(){return jm(this.context,this.alGet("y"))+jm(this.context,this.alGet("height"))},e.prototype.setBottom=function(t){this.alPut("height",jm(this.context,t)-jm(this.context,this.alGet("y")))},e.prototype.getBottomRight=function(){return new Bf(this.context,e.prototype.getRight.call(this),e.prototype.getBottom.call(this))},e.prototype.setBottomRight=function(t){e.prototype.setRight.call(this,t.alGet("x")),e.prototype.setBottom.call(this,t.alGet("y"))},e.prototype.getLeft=function(){return jm(this.context,this.alGet("x"))},e.prototype.setLeft=function(t){this.alPut("x",jm(this.context,t))},e.prototype.getSize=function(){return new Bf(this.context,this.alGet("width"),this.alGet("height"))},e.prototype.setSize=function(t){this.alPut("width",t.alGet("x")),this.alPut("height",t.alGet("y"))},e.prototype.getRight=function(){return jm(this.context,this.alGet("x"))+jm(this.context,this.alGet("width"))},e.prototype.setRight=function(t){this.alPut("width",jm(this.context,t)-jm(this.context,this.alGet("x")))},e.prototype.getTop=function(){return jm(this.context,this.alGet("y"))},e.prototype.setTop=function(t){this.alPut("y",jm(this.context,t))},e.prototype.getTopLeft=function(){return new Bf(this.context,e.prototype.getLeft.call(this),e.prototype.getTop.call(this))},e.prototype.setTopLeft=function(t){e.prototype.setLeft.call(this,t.alGet("x")),e.prototype.setTop.call(this,t.alGet("y"))},e.prototype.clone=function(){var t=new Nf(this.context);return this instanceof Sf&&(t.alPut("x",this.alGet("x")),t.alPut("y",this.alGet("y")),t.alPut("width",this.alGet("width")),t.alPut("height",this.alGet("height"))),t},e.prototype.contains=function(t,e){return t=jm(this.context,t),e=jm(this.context,e),Lf(this).contains(t,e)},e.prototype.containsPoint=function(t){var e=Lf(this),i=Tf(t);return e.containsPoint(i)},e.prototype.containsRectangle=function(t){var e=Lf(this),i=Lf(t);return e.containsRect(i)},e.prototype.equals=function(t){var e=Lf(this),i=Lf(t);return e.equals(i)},e.prototype.inflate=function(t,e){t=jm(this.context,t),e=jm(this.context,e);var i=Lf(this);i.inflate(t,e),Rf(i,this)},e.prototype.inflatePoint=function(t){var e=Lf(this),i=Tf(t);e.inflatePoint(i),Rf(e,this)},e.prototype.intersection=function(t){var e=Lf(this),i=Lf(t);return Nf.fromAS3Rectangle(this.context,e.intersection(i))},e.prototype.intersects=function(t){var e=Lf(this),i=Lf(t);return e.intersects(i)},e.prototype.isEmpty=function(){return Lf(this).isEmpty()},e.prototype.offset=function(t,e){t=jm(this.context,t),e=jm(this.context,e);var i=Lf(this);i.offset(t,e),Rf(i,this)},e.prototype.offsetPoint=function(t){var e=Lf(this),i=Tf(t);e.offsetPoint(i),Rf(e,this)},e.prototype.setEmpty=function(){this.alPut("x",0),this.alPut("y",0),this.alPut("width",0),this.alPut("height",0)},e.prototype._toString=function(){return"(x="+this.alGet("x")+", y="+this.alGet("y")+", w="+this.alGet("width")+", h="+this.alGet("height")+")"},e.prototype.union=function(t){var e=Lf(this),i=Lf(t);return Nf.fromAS3Rectangle(this.context,e.union(i))},e}(Sf);function Vf(t,e){return void 0===t?e:t}function Uf(t){var e=t.context;return t instanceof jf?new I(Km(e,Vf(t._rawData[0],1)),Km(e,Vf(t._rawData[1],1)),Km(e,Vf(t._rawData[2],1)),Km(e,Vf(t._rawData[3],1)),Km(e,Vf(t._rawData[4],0)),Km(e,Vf(t._rawData[5],0)),Km(e,Vf(t._rawData[6],0)),Km(e,Vf(t._rawData[7],0))):new I(1,1,1,1,0,0,0,0)}var jf=function(t){function e(e,i,n,r,o,s,a,l,u){void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=1),void 0===s&&(s=0),void 0===a&&(a=0),void 0===l&&(l=0),void 0===u&&(u=0);var c=t.call(this,e)||this;return c._rawData=[i,n,r,o,s,a,l,u],c.alPrototype=e.globals.ColorTransform.alGetPrototypeProperty(),rg(c,{rgb:{get:c.getRgb,set:c.setRgb},ra:{get:c.getRM,set:c.setRM},ga:{get:c.getGM,set:c.setGM},ba:{get:c.getBM,set:c.setBM},aa:{get:c.getAM,set:c.setAM},rb:{get:c.getRO,set:c.setRO},gb:{get:c.getGO,set:c.setGO},bb:{get:c.getBO,set:c.setBO},ab:{get:c.getAO,set:c.setAO},redMultiplier:{get:c.getRedMultiplier,set:c.setRedMultiplier},greenMultiplier:{get:c.getGreenMultiplier,set:c.setGreenMultiplier},blueMultiplier:{get:c.getBlueMultiplier,set:c.setBlueMultiplier},alphaMultiplier:{get:c.getAlphaMultiplier,set:c.setAlphaMultiplier},redOffset:{get:c.getRedOffset,set:c.setRedOffset},greenOffset:{get:c.getGreenOffset,set:c.setGreenOffset},blueOffset:{get:c.getBlueOffset,set:c.setBlueOffset},alphaOffset:{get:c.getAlphaOffset,set:c.setAlphaOffset},concat:{value:c.concat,writable:!0},toString:{value:c._toString,writable:!0}}),c}return i(e,t),e.prototype.getRedMultiplier=function(){return this._rawData[0]},e.prototype.setRedMultiplier=function(t){this._rawData[0]=t},e.prototype.getGreenMultiplier=function(){return this._rawData[1]},e.prototype.setGreenMultiplier=function(t){this._rawData[1]=t},e.prototype.getBlueMultiplier=function(){return this._rawData[2]},e.prototype.setBlueMultiplier=function(t){this._rawData[2]=t},e.prototype.getAlphaMultiplier=function(){return this._rawData[3]},e.prototype.setAlphaMultiplier=function(t){this._rawData[3]=t},e.prototype.getRedOffset=function(){return this._rawData[4]},e.prototype.setRedOffset=function(t){this._rawData[4]=t},e.prototype.getGreenOffset=function(){return this._rawData[5]},e.prototype.setGreenOffset=function(t){this._rawData[5]=t},e.prototype.getBlueOffset=function(){return this._rawData[6]},e.prototype.setBlueOffset=function(t){this._rawData[6]=t},e.prototype.getAlphaOffset=function(){return this._rawData[7]},e.prototype.setAlphaOffset=function(t){this._rawData[7]=t},e.prototype.getRM=function(){return 100*this._rawData[0]},e.prototype.setRM=function(t){this._rawData[0]=t/100},e.prototype.getGM=function(){return 100*this._rawData[1]},e.prototype.setGM=function(t){this._rawData[1]=t/100},e.prototype.getBM=function(){return 100*this._rawData[2]},e.prototype.setBM=function(t){this._rawData[2]=t/100},e.prototype.getAM=function(){return 100*this._rawData[3]},e.prototype.setAM=function(t){this._rawData[3]=t/100},e.prototype.getRO=function(){return this._rawData[4]},e.prototype.setRO=function(t){this._rawData[4]=t},e.prototype.getGO=function(){return this._rawData[5]},e.prototype.setGO=function(t){this._rawData[5]=t},e.prototype.getBO=function(){return this._rawData[6]},e.prototype.setBO=function(t){this._rawData[6]=t},e.prototype.getAO=function(){return this._rawData[7]},e.prototype.setAO=function(t){this._rawData[7]=t},e.prototype.getRgb=function(){return this._rawData[4]<<16|this._rawData[5]<<8|this._rawData[6]},e.prototype.setRgb=function(t){var e=w.float32ColorToARGB(t);this._rawData[4]=e[1],this._rawData[5]=e[2],this._rawData[6]=e[3],this._rawData[0]=0,this._rawData[1]=0,this._rawData[2]=0},e.prototype.concat=function(t){console.warn("AVM1ColorTransform concat is not implemented")},e.prototype._toString=function(){return"[object Object]"},e.fromAwayColorTransform=function(t,i){return new e(t,i.redMultiplier,i.greenMultiplier,i.blueMultiplier,i.alphaMultiplier,i.redOffset,i.greenOffset,i.blueOffset,i.alphaOffset)},e}(Sf),Gf=function(t){function e(e){var i=t.call(this,e)||this;return rg(i,{prototype:{value:new Qf(e,i)}}),i}return i(e,t),e.prototype.alConstruct=function(t){var e=Object.create(jf.prototype);return t=t||[],jf.apply(e,[this.context].concat(t)),e},e}(Df),Qf=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(n,{constructor:{value:i,writable:!0}}),n}return i(e,t),e}(Sf);function zf(t){var e,i,n,r,o,s,a=t.context;return t instanceof Sf&&(e=Km(a,t.alGet("a")),i=Km(a,t.alGet("b")),n=Km(a,t.alGet("c")),r=Km(a,t.alGet("d")),o=Km(a,t.alGet("tx")),s=Km(a,t.alGet("ty"))),new T(e,i,n,r,o,s)}function Hf(t,e){e.alPut("a",t.a),e.alPut("b",t.b),e.alPut("c",t.c),e.alPut("d",t.d),e.alPut("tx",t.tx),e.alPut("ty",t.ty)}var Xf=function(t){function e(e,i,n,r,o,s,a){void 0===i&&(i=1),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=1),void 0===s&&(s=0),void 0===a&&(a=0);var l=t.call(this,e)||this;return l.alPrototype=e.globals.Matrix.alGetPrototypeProperty(),l.alPut("a",i),l.alPut("b",n),l.alPut("c",r),l.alPut("d",o),l.alPut("tx",s),l.alPut("ty",a),l}return i(e,t),e.fromAS3Matrix=function(t,i){return new e(t,i.a,i.b,i.c,i.d,i.tx,i.ty)},e}(Sf),qf=function(t){function e(e){var i=t.call(this,e)||this;return rg(i,{prototype:{value:new Yf(e,i)}}),i}return i(e,t),e.prototype.alConstruct=function(t){return t&&t.length>0?new Xf(this.context,t[0],t[1],t[2],t[3],t[4],t[5]):new Xf(this.context)},e}(Df),Yf=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(n,{constructor:{value:i,writable:!0},clone:{value:n.clone,writable:!0},concat:{value:n.concat,writable:!0},createBox:{value:n.createBox,writable:!0},createGradientBox:{value:n.createGradientBox,writable:!0},deltaTransformPoint:{value:n.deltaTransformPoint,writable:!0},identity:{value:n.identity,writable:!0},invert:{value:n.invert,writable:!0},rotate:{value:n.rotate,writable:!0},scale:{value:n.scale,writable:!0},toString:{value:n._toString,writable:!0},transformPoint:{value:n.transformPoint,writable:!0},translate:{value:n.translate,writable:!0}}),n}return i(e,t),e.prototype.clone=function(){var t=new Xf(this.context);return this instanceof Sf&&(t.alPut("a",this.alGet("a")),t.alPut("b",this.alGet("b")),t.alPut("c",this.alGet("c")),t.alPut("d",this.alGet("d")),t.alPut("tx",this.alGet("tx")),t.alPut("ty",this.alGet("ty"))),t},e.prototype.concat=function(t){var e=zf(this),i=zf(t);e.concat(i),Hf(e,this)},e.prototype.createBox=function(t,e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),t=Km(this.context,t),e=Km(this.context,e),i=Km(this.context,i),n=Km(this.context,n),r=Km(this.context,r);var o=zf(this);o.createBox(t,e,i,n,r),Hf(o,this)},e.prototype.createGradientBox=function(t,e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),t=Km(this.context,t),e=Km(this.context,e),i=Km(this.context,i),n=Km(this.context,n),r=Km(this.context,r);var o=zf(this);o.createGradientBox(t,e,i,n,r),Hf(o,this)},e.prototype.deltaTransformPoint=function(t){var e=Tf(t),i=zf(this);return Bf.fromAS3Point(this.context,i.deltaTransformPoint(e))},e.prototype.identity=function(){this.alPut("a",1),this.alPut("b",0),this.alPut("c",0),this.alPut("d",1),this.alPut("tx",0),this.alPut("ty",0)},e.prototype.invert=function(){var t=zf(this);t.invert(),Hf(t,this)},e.prototype.rotate=function(t){t=Km(this.context,t);var e=zf(this);e.rotate(t),Hf(e,this)},e.prototype.scale=function(t,e){t=Km(this.context,t),e=Km(this.context,e);var i=zf(this);i.scale(t,e),Hf(i,this)},e.prototype._toString=function(){return zf(this).toString()},e.prototype.transformPoint=function(t){var e=Tf(t),i=zf(this);return Bf.fromAS3Point(this.context,i.transformPoint(e))},e.prototype.translate=function(t,e){t=Km(this.context,t),e=Km(this.context,e);var i=zf(this);i.translate(t,e),Hf(i,this)},e}(Sf),Kf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){var i=new e(t);return fg(t,i,e.prototype,["align#","displayState#","fullScreenSourceRect#","height#","scaleMode#","showMenu#","width#"],!1),i},e.bindStage=function(t,i,n,r,o){i.avmStage=n,i.avm1Handler=r,e.avmStage=n},e.prototype.getAlign=function(){return this.avmStage.align},e.prototype.setAlign=function(t){this.avmStage.align=t},e.prototype.getDisplayState=function(){return this.avmStage.displayState},e.prototype.setDisplayState=function(t){this.avmStage.displayState=t},e.prototype.getFullScreenSourceRect=function(){return null},e.prototype.setFullScreenSourceRect=function(t){},e.prototype.getHeight=function(){return this.avmStage.stageHeight},e.prototype.getScaleMode=function(){return this.avmStage.scaleMode},e.prototype.setScaleMode=function(t){this.avmStage.scaleMode=t},e.prototype.getShowMenu=function(){return null},e.prototype.setShowMenu=function(t){},e.prototype.getWidth=function(){return this.avmStage.stageWidth},e}(Sf);var Wf,Jf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,["loadBitmap"],["height#","rectangle#","transparent#","width#","applyFilter","clone","colorTransform","compare","copyChannel","copyPixels","dispose","draw","fillRect","floodFill","generateFilterRect","getColorBoundsRect","getPixel","getPixel32","hitTest","merge","noise","paletteMap","perlinNoise","pixelDissolve","scroll","setPixel","setPixel32","threshold"],null,e.prototype.avm1Constructor)},Object.defineProperty(e.prototype,"as3BitmapData",{get:function(){return this.adaptee},enumerable:!0,configurable:!0}),e.prototype.avm1Constructor=function(t,e,i,n){t=jm(this.context,t),e=jm(this.context,e),i=arguments.length<3||Um(this.context,i),n=arguments.length<4?4294967295:Qm(this.context,n);var r=new mh(t,e,i,n,!1,Kf.avmStage.view.stage);this.adaptee=r},e.fromAS3BitmapData=function(t,i){var n=new e(t);return n.alPrototype=t.globals.BitmapData.alGetPrototypeProperty(),n.adaptee=i,n},e.loadBitmap=function(t,i){i=zm(t,i);for(var n,r=ht.getBundle(),o=0,s=Object.keys(r._assetDictionary);o<s.length;o++){var a=s[o];if(n=r.getAsset(i,a))break}if(n&&n.isAsset(hn)){var l=new e(t);return l.adaptee=n,l}return console.warn("[AVM1 BitmapData] Missing bitmap:",i),null},e.prototype.getHeight=function(){return this.adaptee.height},e.prototype.getRectangle=function(){var t=this.as3BitmapData;return new Nf(this.context,0,0,t.width,t.height)},e.prototype.getTransparent=function(){return this.adaptee.transparent},e.prototype.getWidth=function(){return this.adaptee.width},e.prototype.applyFilter=function(t,e,i,n){return console.warn("[avm1/AVM1BitmapData] - applyFilter not implemented"),0},e.prototype.clone=function(){var t=new e(this.context);return t.alPrototype=this.context.globals.BitmapData.alGetPrototypeProperty(),t.adaptee=this.adaptee.clone(),t},e.prototype.colorTransform=function(t,e){var i=Lf(t),n=Uf(e);this.adaptee.colorTransform(i,n)},e.prototype.compare=function(t){return t instanceof e&&(console.warn("[avm1/AVM1BitmapData] - compare not implemented"),!0)},e.prototype.copyChannel=function(t,e,i,n,r){var o=t.as3BitmapData,s=Lf(e),a=Tf(i);n=Km(this.context,n),r=Km(this.context,r),this.as3BitmapData.copyChannel(o,s,a,n,r)},e.prototype.copyPixels=function(t,e,i,n,r,o){if(t){var s=this.as3BitmapData,a=t.as3BitmapData,l=Lf(e),u=Tf(i),c=n?n.as3BitmapData:null,h=r?Tf(r):null;o=Um(this.context,o),s.copyPixels(a,l,u,c,h,o)}else console.warn("[AVM1BitmapData::copyPixels] Empty source!")},e.prototype.dispose=function(){this.as3BitmapData.dispose()},e.prototype.draw=function(t,e,i,n,r,o){if(t){var s=t;if("string"!=typeof t||(s=this.context.resolveTarget(t))){var a=s.adaptee,l=e?zf(e):null,u=i?Uf(i):null,c=r?Lf(r):null;n=(n="number"==typeof n?ug[n]:Ym(this.context,n))||null,o=Um(this.context,o),s._locked=!0,this.as3BitmapData.draw(a,l,u,n,c,o),s._locked=!1}else console.warn("[AVM1BitmapData::draw] Source "+t+"  not resolved!")}else console.warn("[AVM1BitmapData::draw] Empty source!")},e.prototype.fillRect=function(t,e){var i=Lf(t);e=Qm(this.context,e),this.as3BitmapData.fillRect(i,e)},e.prototype.floodFill=function(t,e,i){t=Km(this.context,t),e=Km(this.context,e),i=Qm(this.context,i),console.warn("[avm1/AVM1BitmapData] - floodFill not implemented")},e.prototype.generateFilterRect=function(t,e){console.warn("[avm1/AVM1BitmapData] - generateFilterRect not implemented")},e.prototype.getColorBoundsRect=function(t,e,i){var n;t=Qm(this.context,t)>>>0,e=Qm(this.context,e)>>>0,i=Um(this.context,i);var r=null===(n=this.as3BitmapData)||void 0===n?void 0:n.getColorBoundsRect(t,e,i);return r?new Nf(this.context,r.x,r.y,r.width,r.height):null},e.prototype.getPixel=function(t,e){return this.adaptee.getPixel(t,e)},e.prototype.getPixel32=function(t,e){return this.adaptee.getPixel32(t,e)},e.prototype.hitTest=function(t,e,i,n,r){return console.warn("[avm1/AVM1BitmapData] - hitTest not implemented"),!1},e.prototype.merge=function(t,e,i,n,r,o,s){var a=t.as3BitmapData,l=Lf(e),u=Tf(i);n=Qm(this.context,n),r=Qm(this.context,r),o=Qm(this.context,o),s=Qm(this.context,s),this.as3BitmapData.merge(a,l,u,n,r,o,s)},e.prototype.noise=function(t,e,i,n,r){t=Qm(this.context,t),e=arguments.length<2?0:Qm(this.context,e),i=arguments.length<3?255:Qm(this.context,i),n=arguments.length<4?7:Qm(this.context,n),r=!(arguments.length<5)&&Um(this.context,r),console.warn("[avm1/AVM1BitmapData] - noise not implemented")},e.prototype.paletteMap=function(t,e,i,n,r,o,s){console.warn("[avm1/AVM1BitmapData] - paletteMap not implemented")},e.prototype.perlinNoise=function(t,e,i,n,r,o,s,a,l){t=Km(this.context,t),e=Km(this.context,e),i=Km(this.context,i),n=Km(this.context,n),r=Um(this.context,r),o=Um(this.context,o),s=void 0===s?7:Km(this.context,s),a=Um(this.context,a),console.warn("[avm1/AVM1BitmapData] - perlinNoise not implemented")},e.prototype.pixelDissolve=function(t,e,i,n,r,o){var s=Lf(e);return n=arguments.length<4?0:Qm(this.context,n),r=arguments.length<5?s.width*s.height/30:Qm(this.context,r),o=arguments.length<6?0:Qm(this.context,o),console.warn("[avm1/AVM1BitmapData] - pixelDissolve not implemented"),0},e.prototype.scroll=function(t,e){if(t=0|Km(this.context,t),e=0|Km(this.context,e),t||e){var i=this.as3BitmapData;i.copyPixels(i,i.rect,new D(t,e),null,null,!1)}},e.prototype.setPixel=function(t,e,i){t=Km(this.context,t),e=Km(this.context,e),i=Qm(this.context,i),this.adaptee.setPixel(t,e,i)},e.prototype.setPixel32=function(t,e,i){t=Km(this.context,t),e=Km(this.context,e),i=Qm(this.context,i),this.adaptee.setPixel32(t,e,i)},e.prototype.threshold=function(t,e,i,n,r,o,s,a){var l=this.as3BitmapData,u=t.as3BitmapData;if(u){var c=Lf(e),h=Tf(i);return n=Ym(this.context,n),r=Qm(this.context,r)>>>0,o=arguments.length<6?0:Qm(this.context,o),s=arguments.length<7?4294967295:Qm(this.context,s),a=!(arguments.length<8)&&Um(this.context,a),o=0===o?65793:o,l.threshold(u,c,h,n,r,16711935,s,a),0}},e}(Sf);!function(t){t[t._x=0]="_x",t[t._y=1]="_y",t[t._xscale=2]="_xscale",t[t._yscale=3]="_yscale",t[t._currentframe=4]="_currentframe",t[t._totalframes=5]="_totalframes",t[t._alpha=6]="_alpha",t[t._visible=7]="_visible",t[t._width=8]="_width",t[t._height=9]="_height",t[t._rotation=10]="_rotation",t[t._target=11]="_target",t[t._framesloaded=12]="_framesloaded",t[t._name=13]="_name",t[t._droptarget=14]="_droptarget",t[t._url=15]="_url",t[t._highquality=16]="_highquality",t[t._focusrect=17]="_focusrect",t[t._soundbuftime=18]="_soundbuftime",t[t._quality=19]="_quality",t[t._xmouse=20]="_xmouse",t[t._ymouse=21]="_ymouse"}(Wf||(Wf={}));var Zf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){var i=["align#","blockIndent#","bold#","bullet#","color#","font#","getTextExtent","indent#","italic#","kerning#","leading#","leftMargin#","letterSpacing#","rightMargin#","size#","tabStops#","target#","adaptee#","underline#","url#"],n=_g(t,!0,e,[],i,null,e.prototype.avm1Constructor),r=n.alGetPrototypeProperty(),o=null;return i.forEach((function(t){"#"===t[t.length-1]&&(t=t.slice(0,-1)),(o=r.alGetOwnProperty(t)).flags&=-2,r.alSetOwnProperty(t,o)})),n},e.createFromNative=function(t,i){var n=t.globals.TextFormat,r=new e(t);return r.alPrototype=n.alGetPrototypeProperty(),r.adaptee=i,r},e.prototype.alPut=function(e,i){"font"==e&&this.setFont(i),t.prototype.alPut.call(this,e,i)},e.prototype.avm1Constructor=function(t,e,i,n,r,o,s,a,l,u,c,h,p){var d=this.context;t=null==t?null:zm(d,t),e=null==e?null:jm(d,e),i=null==i?null:jm(d,i),n=null==n?null:Um(d,n),r=null==r?null:Um(d,r),o=null==o?null:Um(d,o),s=null==s?null:zm(d,s),a=null==a?null:zm(d,a),l=null==l?null:zm(d,l),u=null==u?null:jm(d,u),c=null==c?null:jm(d,c),h=null==h?null:jm(d,h),p=null==p?null:jm(d,p);var f=new Pc(t,e,i,n,r,o,s,a,l,u,c,h,p);this.adaptee=f},e.alInitStatic=function(t){var e=new sh;e.multiline=!0,this._measureTextField=e},e.prototype.getAdaptee=function(){return this.adaptee.id},e.prototype.setAdaptee=function(t){},e.prototype.getAlign=function(){return this.adaptee.align},e.prototype.setAlign=function(t){var e=zm(this.context,t);""==e&&(e="center"),this.adaptee.align=e},e.prototype.getBlockIndent=function(){return this.adaptee.blockIndent},e.prototype.setBlockIndent=function(t){this.adaptee.blockIndent=jm(this.context,t)},e.prototype.getBold=function(){return this.adaptee.bold},e.prototype.setBold=function(t){this.adaptee.bold=Um(this.context,t)},e.prototype.getBullet=function(){return this.adaptee.bullet},e.prototype.setBullet=function(t){this.adaptee.bullet=Um(this.context,t)},e.prototype.getColor=function(){return this.adaptee.color},e.prototype.setColor=function(t){this.adaptee.color=jm(this.context,t)},e.prototype.getFont=function(){return this.adaptee.font_name},e.prototype.setFont=function(t){this.adaptee.font_name=zm(this.context,t)},e.prototype.getIndent=function(){return this.adaptee.indent},e.prototype.setIndent=function(t){this.adaptee.indent=jm(this.context,t)},e.prototype.getItalic=function(){return this.adaptee.italic},e.prototype.setItalic=function(t){this.adaptee.italic=Um(this.context,t)},e.prototype.getKerning=function(){return this.adaptee.kerning},e.prototype.setKerning=function(t){this.adaptee.kerning=Um(this.context,t)},e.prototype.getLeading=function(){return this.adaptee.leading},e.prototype.setLeading=function(t){this.adaptee.leading=jm(this.context,t)},e.prototype.getLeftMargin=function(){return this.adaptee.leftMargin},e.prototype.setLeftMargin=function(t){this.adaptee.leftMargin=jm(this.context,t)},e.prototype.getLetterSpacing=function(){return this.adaptee.letterSpacing},e.prototype.setLetterSpacing=function(t){this.adaptee.letterSpacing=jm(this.context,t)},e.prototype.getRightMargin=function(){return this.adaptee.rightMargin},e.prototype.setRightMargin=function(t){this.adaptee.rightMargin=jm(this.context,t)},e.prototype.getSize=function(){return this.adaptee.size},e.prototype.setSize=function(t){this.adaptee.size=jm(this.context,t)},e.prototype.getTabStops=function(){return new wm(this.context,this.adaptee.tabStops)},e.prototype.setTabStops=function(t){var e=this;this.adaptee.tabStops=wm.mapToJSArray(t,(function(t){return jm(e.context,t)}))},e.prototype.getTarget=function(){return""},e.prototype.setTarget=function(t){},e.prototype.getTextExtent=function(t,i){t=Ym(this.context,t),i=+i;var n=this.context.getStaticState(e)._measureTextField;!isNaN(i)&&i>0?(n.width=i+4,n.wordWrap=!0):n.wordWrap=!1,n.textFormat=this.adaptee,n.text=t;var r=Xm(this.context),o=n.textWidth,s=n.textHeight;return r.alPut("width",o),r.alPut("height",s),r.alPut("textFieldWidth",o+4),r.alPut("textFieldHeight",s+4),r},e.prototype.getUnderline=function(){return this.adaptee.underline},e.prototype.setUnderline=function(t){this.adaptee.underline=Um(this.context,t)},e.prototype.getUrl=function(){return this.adaptee.url},e.prototype.setUrl=function(t){this.adaptee.url=zm(this.context,t)},e}(Sf),$f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!1,e,["BACKSPACE","CAPSLOCK","CONTROL","DELETEKEY","DOWN","END","ENTER","ESCAPE","HOME","INSERT","LEFT","PGDN","PGUP","RIGHT","SHIFT","SPACE","TAB","UP","isDown","getCode"],[])},e.alInitStatic=function(t){this._keyStates=[],this._lastKeyCode=0},e.bindStage=function(t,i,n,r){e.keyDownDelegate&&r.removeEventListener("keydown",e.keyDownDelegate),e.keyUpDelegate&&r.removeEventListener("keyup",e.keyUpDelegate),e.keyDownDelegate=function(n){var r=t.getStaticState(e);r._lastKeyCode=n.keyCode,r._keyStates[n.keyCode]=1,$m(i,"broadcastMessage",["onKeyDown"])},e.keyUpDelegate=function(n){var r=t.getStaticState(e);r._lastKeyCode=n.keyCode,delete r._keyStates[n.keyCode],$m(i,"broadcastMessage",["onKeyUp"])},r.addEventListener("keydown",e.keyDownDelegate),r.addEventListener("keyup",e.keyUpDelegate)},e.isDown=function(t,i){return!!t.getStaticState(e)._keyStates[i]},e.getCode=function(t){return t.getStaticState(e)._lastKeyCode},e.BACKSPACE=8,e.CAPSLOCK=20,e.CONTROL=17,e.DELETEKEY=46,e.DOWN=40,e.END=35,e.ENTER=13,e.ESCAPE=27,e.HOME=36,e.INSERT=45,e.LEFT=37,e.PGDN=34,e.PGUP=33,e.RIGHT=39,e.SHIFT=16,e.SPACE=32,e.TAB=9,e.UP=38,e.keyDownDelegate=null,e.keyUpDelegate=null,e}(Sf),t_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["matrix#","concatenatedMatrix#","colorTransform#","pixelBounds#"],null,e.prototype.avm1Constructor)},Object.defineProperty(e.prototype,"as3Transform",{get:function(){return this._targetAwayObject.transform},enumerable:!0,configurable:!0}),e.prototype.avm1Constructor=function(t){this._target=this.context.resolveTarget(t),this._targetAwayObject=ag(this._target)},e.prototype.getMatrix=function(){var t=this._targetAwayObject.transform;return Xf.fromAS3Matrix(this.context,t.matrix)},e.prototype.setMatrix=function(t){this._targetAwayObject.transform.matrix=zf(t)},e.prototype.getConcatenatedMatrix=function(){var t=this._targetAwayObject.transform;return Xf.fromAS3Matrix(this.context,t.concatenatedMatrix)},e.prototype.getColorTransform=function(){var t=this._targetAwayObject.transform;return jf.fromAwayColorTransform(this.context,t.colorTransform)},e.prototype.setColorTransform=function(t){this._targetAwayObject.transform.colorTransform=Uf(t)},e.prototype.getPixelBounds=function(){var t=this._targetAwayObject.transform;return Nf.fromAS3Rectangle(this.context,t.pixelBounds)},e}(Sf),e_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasSwappedDepth=!1,e.dynamicallyCreated=!1,e.enabled=!0,e}return i(e,t),e.prototype.initAVM1SymbolInstance=function(t,e){this.constructorHasRun=!0,this.avmType="symbol",this.scriptRefsToChilds={},this._mouseListenerCount=0,this._avm1Context=t,this._ownProperties=Object.create(null),this._prototype=null;var i=this;this._onClipEventsListeners=[];var n=new Ef(131,null,{alCall:function(t,e){return i.alPrototype}},{alCall:function(t,e){i.alPrototype=e[0]}});this.alSetOwnProperty("__proto__",n),this.adaptee=e;var r=e.name,o=this.get_parent();r&&o&&o._addChildName(this,r)},e.prototype.bindEvents=function(t,e){this._events=t;var i=Object.create(null);this._eventsMap=i,this._eventsListeners=Object.create(null),this._eventHandlers=Object.create(null);var n=this,r=this.context;t.forEach((function(t){var e=t.propertyName=r.normalizeName(t.propertyName);i[e]=t,n._updateEvent(t)}))},e.prototype.unbindEvents=function(){var t=this._events,e=this,i=this.context;t.forEach((function(t){i.unregisterEventPropertyObserver(t.propertyName,e),e._removeEventListener(t)})),this._events=null,this._eventsMap=null,this._eventsListeners=null,this._eventHandlers=null},e.prototype._initEventsHandlers=function(){throw"AVM1SymbolBase _initEventsHandlers must be overwritten"},e.prototype.updateEventByPropName=function(t){this._eventsMap?this._eventsMap[t]&&this._updateEvent(this._eventsMap[t]):(this._initEventsHandlers(),console.log("no eventsmap set",this))},e.prototype.updateAllEvents=function(){this._events.forEach((function(t){this._updateEvent(t)}),this)},e.prototype._updateEvent=function(t){!function(t,e,i){if(e.alHasProperty(i)&&e.alGet(i)instanceof Df)return!0;if(e.alHasProperty(i)&&e._ownProperties[i]&&e._ownProperties[i].value)return!0;var n=e.alGet("_listeners");if(!(n instanceof wm))return!1;return n.value.some((function(t){return t instanceof Sf&&t.alHasProperty(i)}))}(this.context,this,t.propertyName)?this._removeEventListener(t):this._addEventListener(t)},e.prototype._addOnClipEventListener=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.propertyName=this.context.normalizeName(t.propertyName),this._onClipEventsListeners.push({event:t,callback:e}),!this.enabled&&t.allowDisable||this.addEventListenerOnAdapter(t,e,i)},e.prototype._addEventListener=function(t,e){void 0===e&&(e=null);var i=this.context.normalizeName(t.propertyName),n=this._eventsListeners[i],r=this;n||(n=e||function(){var t=null;"onchanged"==i.toLowerCase()&&(t=[r]),function(t,e,i,n){void 0===n&&(n=null);var r=e.alGet(i);r instanceof Df&&("onenterframe"==i.toLowerCase()&&(r.isOnEnter=!0),t.executeFunction(r,e,n));var o=e.alGet("_listeners");if(o instanceof wm){var s=null;o.value.forEach((function(r){r instanceof Sf&&(s=r.alGet(i))instanceof Df&&t.executeFunction(s,e,n)}))}}(this.context,this,i,t)}.bind(this),this._eventsListeners[i]=n,this._eventHandlers[i]=t),!this.enabled&&t.allowDisable||this.addEventListenerOnAdapter(t,n)},e.prototype.addEventListenerOnAdapter=function(t,e,i){(void 0===i&&(i=null),t.stageEvent)?this.context.globals.Stage.avm1Handler.addAVM1EventListener(this.adaptee,t.eventName,e,i):(this.adaptee.addEventListener(t.eventName,e),this._updateMouseEnabled(t,!0))},e.prototype.removeEventListenerOnAdapter=function(t,e){if(t.stageEvent){var i=this.context.globals.Stage.avm1Handler;i&&i.removeAVM1EventListener(this.adaptee,t.eventName,e)}else this.adaptee.removeEventListener(t.eventName,e),this._updateMouseEnabled(t,!1)},e.prototype._updateMouseEnabled=function(t,e){this.adaptee.isAVMScene||t.isMouse&&(e?(this._mouseListenerCount++,this.adaptee.mouseEnabled=!0,this.adaptee.mouseChildren=!1):(this._mouseListenerCount--,this._mouseListenerCount<=0&&(this._mouseListenerCount=0,this.adaptee.mouseEnabled=!1,this.adaptee.mouseChildren=!0)))},e.prototype.freeFromScript=function(){for(var e in t.prototype.freeFromScript.call(this),this.enabled=!0,this.adaptee.mouseEnabled=!1,this.adaptee.mouseChildren=!0,this._eventsListeners)this.removeEventListenerOnAdapter(this._eventHandlers[e],this._eventsListeners[e]);this._eventsListeners={};for(var i=this._onClipEventsListeners.length;i>0;)i--,this.removeEventListenerOnAdapter(this._onClipEventsListeners[i].event,this._onClipEventsListeners[i].callback);this._onClipEventsListeners=[],this._mouseListenerCount=0},e.prototype._removeEventListener=function(t){var e=this.context.normalizeName(t.propertyName),i=this._eventsListeners[e];i&&(this.removeEventListenerOnAdapter(t,i),delete this._eventsListeners[e])},e.prototype.onEventPropertyModified=function(t){t=this.context.normalizeName(t);var e=this._eventsMap[t];this._updateEvent(e)},e.prototype.getEnabled=function(){return this.enabled},e.prototype.setEnabled=function(t){t!=this.enabled&&(this.enabled=t,this.setEnabledListener(t))},e.prototype.setEnabledListener=function(t){if(!1!==t&&0!==t){for(var e in this._eventsListeners)this._eventHandlers[e].allowDisable&&this.addEventListenerOnAdapter(this._eventHandlers[e],this._eventsListeners[e]);for(var e in this._onClipEventsListeners)this._onClipEventsListeners[e].event.allowDisable&&this.addEventListenerOnAdapter(this._onClipEventsListeners[e].event,this._onClipEventsListeners[e].callback)}else{for(var e in this._eventsListeners)this._eventHandlers[e].allowDisable&&this.removeEventListenerOnAdapter(this._eventHandlers[e],this._eventsListeners[e]);for(var e in this._onClipEventsListeners)this._onClipEventsListeners[e].event.allowDisable&&this.removeEventListenerOnAdapter(this._onClipEventsListeners[e].event,this._onClipEventsListeners[e].callback)}},e.prototype.get_alpha=function(){return 100*this.adaptee.alpha},e.prototype.set_alpha=function(t){this._ctBlockedByScript=!0,t=jm(this.context,t),isNaN(t)||(this.adaptee.alpha=t/100)},e.prototype.getBlendMode=function(){return""},e.prototype.setBlendMode=function(t){},e.prototype.getCacheAsBitmap=function(){return this.adaptee.cacheAsBitmap},e.prototype.setCacheAsBitmap=function(t){t=Um(this.context,t),this.adaptee.cacheAsBitmap=t},e.prototype.getFilters=function(){return null},e.prototype.setFilters=function(t){},e.prototype.get_focusrect=function(){return!1},e.prototype.set_focusrect=function(t){},e.prototype.get_height=function(){var t=ce.getInstance(this.context.globals.Stage.avmStage.view).getBoundsPicker(this.adaptee.partition).getBoxBounds(this.adaptee.parent||Kf.avmStage.root);return null==t?0:mg(t.height)},e.prototype.set_height=function(t){t=mg(jm(this.context,t)),this._blockedByScript=!0,isNaN(t)||(ce.getInstance(this.context.globals.Stage.avmStage.view).getBoundsPicker(this.adaptee.partition).height=t)},e.prototype.get_highquality=function(){switch(this.get_quality()){case"BEST":return 2;case"HIGH":return 1;default:return 0}},e.prototype.set_highquality=function(t){var e;switch(Gm(this.context,t)){case 2:e="BEST";break;case 1:e="HIGH";break;default:e="LOW"}this.set_quality(e)},e.prototype.getMenu=function(){},e.prototype.setMenu=function(t){},e.prototype.get_name=function(){return this.adaptee?this.adaptee.name:void 0},e.prototype.set_name=function(t){t=Ym(this.context,t);var e=this.adaptee.name;this.adaptee.name=t;var i=this.get_parent();i&&(i.registerScriptObject(this.adaptee),i._updateChildName(this,e,t))},e.prototype.get_parent=function(){return dg(this.adaptee.parent,this.context)||void 0},e.prototype.set_parent=function(t){},e.prototype.getOpaqueBackground=function(){return 0},e.prototype.setOpaqueBackground=function(t){},e.prototype.get_quality=function(){return"HIGH"},e.prototype.set_quality=function(t){},e.prototype.set_root=function(t){},e.prototype.get_root=function(){for(var t=this.adaptee,e=null;t&&!t.isAVMScene;){if((e=dg(t,this.context))&&e.get_lockroot())return e;t=t.parent}if(t)return dg(t,this.context)},e.prototype.get_rotation=function(){for(var t=Math.round(this.adaptee.rotationZ);t>180;)t-=360;for(;t<-180;)t+=360;return t},e.prototype.set_rotation=function(t){t=jm(this.context,t),this._blockedByScript=!0,isNaN(t)||(this.adaptee.rotationZ=t)},e.prototype.getScale9Grid=function(){return Nf.fromAS3Rectangle(this.context,this.adaptee.scale9Grid)},e.prototype.setScale9Grid=function(t){this.adaptee.scale9Grid=Xh(t)?null:Lf(t)},e.prototype.getScrollRect=function(){return Nf.fromAS3Rectangle(this.context,this.adaptee.scrollRect)},e.prototype.setScrollRect=function(t){this.adaptee.scrollRect=Xh(t)?null:Lf(t)},e.prototype.get_soundbuftime=function(){return 0},e.prototype.set_soundbuftime=function(t){},e.prototype.getTabEnabled=function(){return!!this.adaptee&&this.adaptee.tabEnabled},e.prototype.setTabEnabled=function(t){this.adaptee&&(this.adaptee.tabEnabled=t)},e.prototype.getTabIndex=function(){return this.adaptee.tabIndex},e.prototype.setTabIndex=function(t){this.adaptee.tabIndex=t},e.prototype.get_target=function(){var t=this.adaptee;if(t===t.root)return"/";var e="";do{if(Xh(t))return;e="/"+t.name+e,t=t.parent}while(t&&!t.isAVMScene);return e},e.prototype.getTransform=function(){return this.context.swfVersion<8?this.transformPreFP8:(this._avmTransform||(this._avmTransform=this.context.globals.Transform.alConstruct([this])),this._avmTransform)},e.prototype.setTransform=function(t){this.context.swfVersion<8?this.transformPreFP8=t:t instanceof t_&&console.log("not implemented: AVM1SymbolBase.setTransform")},e.prototype.get_visible=function(){return this.adaptee.visible},e.prototype.set_visible=function(t){this._visibilityByScript=!0,t=Um(this.context,t),this.adaptee.visible=t},e.prototype.get_url=function(){return this.adaptee.assetNamespace},e.prototype.get_width=function(){var t=ce.getInstance(this.context.globals.Stage.avmStage.view).getBoundsPicker(this.adaptee.partition).getBoxBounds(this.adaptee.parent||Kf.avmStage.root);return null==t?0:gg(t.width)},e.prototype.set_width=function(t){t=gg(jm(this.context,t)),this._blockedByScript=!0,isNaN(t)||(ce.getInstance(this.context.globals.Stage.avmStage.view).getBoundsPicker(this.adaptee.partition).width=t)},e.prototype.get_x=function(){return mg(this.adaptee.x)},e.prototype.set_x=function(t){t=mg(jm(this.context,t)),this._blockedByScript=!0,isNaN(t)||(this.adaptee.x=t)},e.prototype.get_xmouse=function(){return mg(this.context.globals.Stage.avmStage.getLocalMouseX(this.adaptee))},e.prototype.get_xscale=function(){return 100*this.adaptee.scaleX},e.prototype.set_xscale=function(t){t=jm(this.context,t),this._blockedByScript=!0,isNaN(t)||(this.adaptee.scaleX=t/100)},e.prototype.get_y=function(){return mg(this.adaptee.y)},e.prototype.set_y=function(t){t=mg(jm(this.context,t)),this._blockedByScript=!0,isNaN(t)||(this.adaptee.y=t)},e.prototype.get_ymouse=function(){return mg(this.context.globals.Stage.avmStage.getLocalMouseY(this.adaptee))},e.prototype.get_yscale=function(){return 100*this.adaptee.scaleY},e.prototype.set_yscale=function(t){t=jm(this.context,t),this._blockedByScript=!0,isNaN(t)||(this.adaptee.scaleY=t/100)},e.prototype.getDepth=function(){return this.protoTypeChanged?null:Ag(this.adaptee._avmDepthID)},e.prototype.toString=function(){for(var t=this.adaptee,e=[];t;)t.isAVMScene?(e.push("_level0"),t=null):(e.push(t.name),t=t.parent);for(var i=e.length,n="";i>0;)n+=e[--i],i>0&&(n+=".");return n},e}(Sf),i_=function(t,e,i,n,r,o){this.propertyName=t,this.eventName=e,this.stageEvent=i,this.allowDisable=n,this.isMouse=r,this.isButton=o},n_=function(){},r_=[-1,37,39,36,35,45,46,-1,8,-1,-1,-1,-1,13,38,40,33,34,9,27],o_=Object.create(null),s_=o_,a_=i_;s_[262144]=!0,s_[512]=!0,s_[131072]=new a_("onKey",Mc.KEYDOWN,!0,!0,!1,!1),s_[1]=new a_("onLoad","load",!1,!1,!1,!1),s_[4]=new a_("onUnload","unload",!1,!1,!1,!1),s_[256]=new a_("onData","data",!1,!1,!1,!1),s_[2]=new a_("onEnterFrame","enterFrame",!1,!1,!1,!1),s_[64]=new a_("onKeyDown",Mc.KEYDOWN,!0,!0,!1,!1),s_[128]=new a_("onKeyUp",Mc.KEYUP,!0,!0,!1,!1),s_[8]=new a_("onMouseMove",tl.MOUSE_MOVE,!0,!0,!0,!1),s_[16]=new a_("onMouseDown",tl.MOUSE_DOWN,!0,!0,!0,!1),s_[32]=new a_("onMouseUp",tl.MOUSE_UP,!0,!0,!0,!1),s_[1024]=new a_("onPress",tl.MOUSE_DOWN,!1,!0,!0,!0),s_[2048]=new a_("onRelease",tl.MOUSE_UP,!1,!0,!0,!0),s_[4096]=new a_("onReleaseOutside",tl.MOUSE_UP_OUTSIDE,!1,!0,!0,!0),s_[8192]=new a_("onRollOver",tl.MOUSE_OVER,!1,!0,!0,!0),s_[16384]=new a_("onRollOut",tl.MOUSE_OUT,!1,!0,!0,!0),s_[32768]=new a_("onDragOver",tl.DRAG_OVER,!1,!0,!0,!0),s_[65536]=new a_("onDragOut",tl.DRAG_OUT,!1,!0,!0,!0);var l_=new a_("onSetFocus",Ma.FOCUS_IN,!1,!0,!1,!1),u_=new a_("onKillFocus",Ma.FOCUS_OUT,!1,!0,!1,!1),c_=new a_("onChanged",Oc.CHANGED,!1,!0,!1,!1),h_=[o_[1],o_[4],o_[256],o_[2],o_[64],o_[128],o_[8],o_[16],o_[32],o_[1024],o_[2048],o_[4096],o_[8192],o_[16384],o_[32768],o_[65536],o_[131072],l_,u_,c_],p_=[o_[1],o_[4],o_[256],o_[2],o_[64],o_[128],o_[1024],o_[2048],o_[4096],o_[8192],o_[16384],o_[32768],o_[65536],o_[131072],l_,u_,c_],d_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._prevTextVarContent="",e._textVarHolder=null,e._textVarPropName="",e}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["_alpha#","addListener","antiAliasType#","autoSize#","background#","backgroundColor#","border#","borderColor#","bottomScroll#","condenseWhite#","embedFonts#","filters#","getAwayJSID","getNewTextFormat","getTextFormat","gridFitType#","getDepth","_height#","_highquality#","hscroll#","html#","htmlText#","length#","maxChars#","maxhscroll#","maxscroll#","multiline#","_name#","_parent#","password#","_quality#","_rotation#","replaceSel","removeMovieClip","removeTextField","restrict#","scroll#","selectable#","setNewTextFormat","setTextFormat","_soundbuftime#","tabEnabled#","tabIndex#","_target#","toString","text#","textColor#","textHeight#","textWidth#","type#","_url#","variable#","_visible#","_width#","wordWrap#","_x#","_xmouse#","_xscale#","_y#","_ymouse#","_yscale#"])},e.prototype.dispatchKeyEvent=function(t,e,i,n){if(this.context.globals.Stage&&this.context.globals.Stage.avmStage&&this.context.globals.Stage.avmStage.mouseManager.useSoftkeyboard){var r=this.context.getStaticState($f);r._lastKeyCode=t,r._keyStates[t]=1,$m(lm.instance.Key,"broadcastMessage",["onKeyDown"]);var o=new Mc(Mc.KEYDOWN,"",t);o.isShift=e,o.isCTRL=i,o.isAlt=n,this.context.globals.Stage.avmStage.dispatchEvent(o),delete r._keyStates[t],$m(lm.instance.Key,"broadcastMessage",["onKeyUp"]),(o=new Mc(Mc.KEYUP,"",t)).isShift=e,o.isCTRL=i,o.isAlt=n,this.context.globals.Stage.avmStage.dispatchEvent(o)}},e.syncAllTextfields=function(){for(var t in e.allTextfields)e.allTextfields[t]?e.allTextfields[t].syncTextFieldValue():delete e.allTextfields[t]},e.syncQueedTextfields=function(){if(e.textFieldVars.length>0){for(var t=e.textFieldVars.length,i=0;i<t;i++)e.textFieldVars[i].syncTextFieldValue();e.textFieldVars.length=0}},e.prototype.getAwayJSID=function(){return this.adaptee.id},e.prototype.selectTextField=function(t){void 0===t&&(t=!1),lm.softKeyboardManager&&("dummy_txt"!=this.adaptee.name&&0!=this.adaptee.name.indexOf("temp")||(t=!0),lm.softKeyboardManager.openKeyboard(this.adaptee,t))},e.prototype.removeMovieClip=function(){this.adaptee.isAVMScene||this.adaptee.parent&&Ag(this.adaptee._avmDepthID)>=-1&&this.adaptee.parent.adapter.removeChildAtDepth(this.adaptee._avmDepthID)},e.prototype.alPut=function(e,i){t.prototype.alPut.call(this,e,i)},e.prototype.initAdapter=function(){var t=this;this.adaptee._symbol&&this.setVariable(this.adaptee._symbol.variableName||""),this.adaptee.addEventListener(Oc.CHANGED,(function(){t.updateVarFromText(),t.syncTextFieldValue()}))},e.prototype.initAVM1SymbolInstance=function(e,i){t.prototype.initAVM1SymbolInstance.call(this,e,i),this.adaptee=i,this._initEventsHandlers(),this._variable="",this._exitFrameHandler=null,this.adaptee=i},e.prototype.clone=function(){return dg(this.adaptee.clone(),this._avm1Context)},e.prototype.getAntiAliasType=function(){return""},e.prototype.setAntiAliasType=function(t){},e.prototype.get_width=function(){return this.syncTextFieldValue(),gg(this.adaptee.width)},e.prototype.get_height=function(){return this.syncTextFieldValue(),gg(this.adaptee.height)},e.prototype.set_width=function(t){t=gg(jm(this.context,t)),this._blockedByScript=!0,isNaN(t)||(this.adaptee.width=t)},e.prototype.set_height=function(t){t=gg(jm(this.context,t)),this._blockedByScript=!0,isNaN(t)||(this.adaptee.height=t)},e.prototype.get_x=function(){return this.syncTextFieldValue(),mg(this.adaptee.x+this.adaptee.scaleX*this.adaptee.textOffsetX)},e.prototype.get_y=function(){return this.syncTextFieldValue(),mg(this.adaptee.y+this.adaptee.scaleY*this.adaptee.textOffsetY)},e.prototype.set_x=function(t){this.syncTextFieldValue(),this.adaptee.x=mg(t-this.adaptee.scaleX*this.adaptee.textOffsetX)},e.prototype.set_y=function(t){this.syncTextFieldValue(),this.adaptee.y=mg(t-this.adaptee.scaleY*this.adaptee.textOffsetY)},e.prototype.getAutoSize=function(){return this.adaptee.autoSize},e.prototype.setAutoSize=function(t){!0===t?t="left":!1===t&&(t="none"),t=Ym(this.context,t),this.adaptee.autoSize=t},e.prototype.getBackground=function(){return this.adaptee.background},e.prototype.setBackground=function(t){t=Um(this.context,t),this.adaptee.background=t},e.prototype.getBackgroundColor=function(){return this.adaptee.backgroundColor},e.prototype.setBackgroundColor=function(t){t=Qm(this.context,t),this.adaptee.backgroundColor=t},e.prototype.getBorder=function(){return this.adaptee.border},e.prototype.setBorder=function(t){t=Um(this.context,t),this.adaptee.border=t},e.prototype.getBorderColor=function(){return this.adaptee.borderColor},e.prototype.setBorderColor=function(t){t=Qm(this.context,t),this.adaptee.borderColor=t},e.prototype.getBottomScroll=function(){return this.adaptee.bottomScrollV+1},e.prototype.getCondenseWhite=function(){return this.adaptee.condenseWhite},e.prototype.setCondenseWhite=function(t){t=Um(this.context,t),this.adaptee.condenseWhite=t},e.prototype.getEmbedFonts=function(){return this.adaptee.embedFonts},e.prototype.setEmbedFonts=function(t){t=Um(this.context,t),this.adaptee.embedFonts=t},e.prototype.getNewTextFormat=function(){return Zf.createFromNative(this.context,this.adaptee.textFormat)},e.prototype.getTextFormat=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=-1),t=Gm(this.context,t),e=Gm(this.context,e);var i=this.adaptee.getTextFormat(t,e);return Zf.createFromNative(this.context,i)},e.prototype.getGridFitType=function(){return""},e.prototype.setGridFitType=function(t){},e.prototype.getHscroll=function(){return this.adaptee.scrollH+1},e.prototype.setHscroll=function(t){(t=Km(this.context,t))<=0&&(t=1),this.adaptee.scrollH=t-1},e.prototype.getHtml=function(){return this.adaptee.html},e.prototype.setHtml=function(t){this.adaptee.html=!!t},e.prototype.getHtmlText=function(){return this.adaptee.html?this.adaptee.htmlText:this.adaptee.text},e.prototype.setHtmlText=function(t){t=void 0===t?"undefined":zm(this.context,t),this.adaptee.html?this.adaptee.htmlText=t:this.adaptee.text=t,this.updateVarFromText(),this.syncTextFieldValue()},e.prototype.getLength=function(){return this.adaptee.length},e.prototype.getMaxChars=function(){return 0==this.adaptee.maxChars?null:this.adaptee.maxChars},e.prototype.setMaxChars=function(t){t=Km(this.context,t),this.adaptee.maxChars=t},e.prototype.getRestrict=function(){return this.adaptee.restrict},e.prototype.setRestrict=function(t){t=Ym(this.context,t),this.adaptee.restrict=t},e.prototype.getMaxhscroll=function(){return this.adaptee.maxScrollH+1},e.prototype.getMaxscroll=function(){return this.adaptee.maxScrollV+1},e.prototype.getMultiline=function(){return this.adaptee.multiline},e.prototype.setMultiline=function(t){t=Um(this.context,t),this.adaptee.multiline=t},e.prototype.getPassword=function(){return this.adaptee.displayAsPassword},e.prototype.setPassword=function(t){t=Um(this.context,t),this.adaptee.displayAsPassword=t},e.prototype.getScroll=function(){return this.adaptee.scrollV+1},e.prototype.setScroll=function(t){(t=Km(this.context,t))<=0&&(t=1),this.adaptee.scrollV=t-1},e.prototype.getSelectable=function(){return this.adaptee.selectable},e.prototype.setSelectable=function(t){"false"==t&&(t=!1),(t=Um(this.context,t))||this.context.globals.Stage.avmStage.mouseManager.getFocus()!=this.adaptee||this.context.globals.Stage.avmStage.mouseManager.setFocus(null),this.adaptee.selectable=t},e.prototype.replaceSel=function(t){t=zm(this.context,t),this.adaptee.replaceSelectedText(t)},e.prototype.setNewTextFormat=function(t){var e;t instanceof Zf?(e=t.adaptee,this.adaptee.textFormat||(this.adaptee.textFormat=new Pc),this.adaptee.newTextFormat=e):console.log("AVM1Textfield.setNewtextFormat - trying to set something other than a TextFormat",t)},e.prototype.setTextFormat=function(){this._variable&&this.syncTextFieldValue();var t,e,i=-1,n=-1;switch(arguments.length){case 0:return;case 1:t=arguments[0];break;case 2:i=jm(this.context,arguments[0]),t=arguments[1];break;default:i=jm(this.context,arguments[0]),n=jm(this.context,arguments[1]),t=arguments[2]}i>=0&&-1==n&&(n=i),t instanceof Zf&&(e=t.adaptee,this.adaptee.setTextFormat(e,i,n))},e.prototype.getText=function(){return this._variable&&this.syncTextFieldValue(),this.adaptee.text},e.prototype.setText=function(t){t=void 0===t?"":zm(this.context,t);var e=this.context.utils;if(this.adaptee.parent){var i=dg(this.adaptee.parent,this.context);e.setProperty(i,this._variable,t)}this.adaptee.text=t,this._variable&&(this.updateVarFromText(),this.syncTextFieldValue())},e.prototype.getTextColor=function(){return this.adaptee.textColor},e.prototype.setTextColor=function(t){t=Qm(this.context,t),this.adaptee.textColor=t},e.prototype.getTextHeight=function(){return this._variable&&this.syncTextFieldValue(),this.adaptee.textHeight},e.prototype.setTextHeight=function(t){},e.prototype.getTextWidth=function(){return this._variable&&this.syncTextFieldValue(),this.adaptee.textWidth},e.prototype.setTextWidth=function(t){},e.prototype.getType=function(){return this.adaptee.type},e.prototype.setType=function(t){(t=Ym(this.context,t))&&(t=t.toLowerCase()),this.adaptee.type=t},e.prototype.getVariable=function(){return this._variable},e.prototype.setVariable=function(t){if((t=Ym(this.context,t))!==this._variable){var i=this.adaptee;e.allTextfields[i.id]=this,this._prevTextVarContent=this.adaptee.text,this._syncTextFieldValue(i,t),this._exitFrameHandler&&!t&&(i.removeEventListener("exitFrame",this._exitFrameHandler),this._exitFrameHandler=null),this._variable=t,!this._exitFrameHandler&&t&&(this._exitFrameHandler=this._onAS3ObjectExitFrame.bind(this),i.addEventListener("exitFrame",this._exitFrameHandler))}},e.prototype._onAS3ObjectExitFrame=function(){this._variable&&this._syncTextFieldValue(this.adaptee,this._variable)},e.prototype.syncTextFieldValue=function(){this._syncTextFieldValue(this.adaptee,this._variable)},e.prototype.updateVarFromText=function(){this._textVarHolder&&(this.context.utils.setProperty(this._textVarHolder,this._textVarPropName,this.adaptee.html?this.adaptee.htmlText:this.adaptee.text),this._prevTextVarContent=this.adaptee.text)},e.prototype._syncTextFieldValue=function(t,i){if(i&&""!=i){var n=this.context.utils;if(null==this._textVarHolder)if(i.indexOf(".")>=0||i.indexOf(":")>=0){var r=i.split(/[.:\/]/g);if(this._textVarPropName=r.pop(),"_root"==r[0]||"_level0"==r[0]||"_level"==r[0]||""===r[0]){var o=t.parent;for(this._textVarHolder=null;o;)o.isAVMScene?(this._textVarHolder=o.adapter,o=null):o=o.parent;if(null===this._textVarHolder)return;r.shift(),""===r[0]&&r.shift()}else if("_global"==r[0])r.shift(),this._textVarHolder=this.context.globals;else{if(!t.parent)return;this._textVarHolder=dg(t.parent,this.context)}for(var s=null;r.length>0;)if(s=r.shift(),this._textVarHolder=n.getProperty(this._textVarHolder,s),!this._textVarHolder)return}else if(this._textVarPropName=i,t.parent&&t.parent.parent){this._textVarHolder=dg(t.parent,this.context);for(var a=void 0,l=t.parent.parent,u=l.numChildren,c=0;c<u;c++)(a=l.getChildAt(c))!=t.parent&&a.name==t.parent.name&&n.hasProperty(a.adapter,this._textVarPropName)&&(this._textVarHolder=a.adapter)}if(!this._textVarHolder)return e.textFieldVars.push(this),t.html?this._prevTextVarContent=t.htmlText:void(this._prevTextVarContent=t.text);if(!n.hasProperty(this._textVarHolder,this._textVarPropName)){var h=void 0;return t.html?(h={isTextVar:!0,value:void 0},""!=t.htmlText&&(h.value=t.htmlText),n.setProperty(this._textVarHolder,this._textVarPropName,h),n.setProperty(this._textVarHolder,this._textVarPropName+"_internal_TF",this),void(this._prevTextVarContent=t.htmlText)):(h={isTextVar:!0,value:void 0},""!=t.text&&(h.value=t.text),n.setProperty(this._textVarHolder,this._textVarPropName,h),n.setProperty(this._textVarHolder,this._textVarPropName+"_internal_TF",this),void(this._prevTextVarContent=t.text))}n.hasProperty(this._textVarHolder,this._textVarPropName+"_internal_TF")||n.setProperty(this._textVarHolder,this._textVarPropName+"_internal_TF",this);var p=n.getProperty(this._textVarHolder,this._textVarPropName);if("string"!=typeof p&&(p=zm(this.context,p)),t.html){if(p!==this._prevTextVarContent)return t.htmlText=void 0===p?"":p,void(this._prevTextVarContent=p);t.htmlText===p||void 0===p&&""===t.htmlText||(t.htmlText=void 0===p?"":p)}else{if(p!==this._prevTextVarContent)return t.text=void 0===p?"":p,void(this._prevTextVarContent=p);t.text===p||void 0===p&&""===t.text||(t.text=void 0===p?"":p)}}},e.prototype.getWordWrap=function(){return this.adaptee.wordWrap},e.prototype.setWordWrap=function(t){t=Um(this.context,t),this.adaptee.wordWrap=t},e.prototype._initEventsHandlers=function(){this.bindEvents(h_)},e.allTextfields={},e.textFieldVars=[],e}(e_),f_=function(){function t(t){var e=this;this.result=new Kh,this._context=t,this._onAssetCompleteDelegate=function(t){return e.onAssetComplete(t)},this._onLoaderCompleteDelegate=function(t){return e.onLoaderComplete(t)},this._onLoadErrorDelegate=function(t){return e.onLoadError(t)},this._loader=new ut}return Object.defineProperty(t.prototype,"loader",{get:function(){return this._loader},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0}),t.prototype.onAssetComplete=function(t){var e=t.asset;if(e.isAsset(il)){if(e.assetNamespace!=this._url)return;e.isAVMScene&&(this._content=e,this.result.resolve(e),e.adapter.initAdapter())}},t.prototype.onLoaderComplete=function(t){t.url==this._url&&(ht.removeEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),ht.removeEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),ht.removeEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate))},t.prototype.onLoadError=function(t){ht.removeEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),ht.removeEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),ht.removeEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate),console.log("load error in loadMovie",t)},t.prototype._loadingCallback=function(t,e){var i=e.adaptee,n=t;i.isAVMScene=n.isAVMScene,i.timeline=n.timeline,i.assetNamespace=n.assetNamespace,i.reset(!0,!1)},t.prototype.loadMovieAt=function(e,i,n){var r=this;if(!n)throw new Error("Target can't be null");var o=t._loaderCache[e];return o?(this._loadingCallback(o,n),Promise.resolve(n)):this.load(e,i).then((function(){return(o=r.content)?(t._loaderCache[e]=o,r._loadingCallback(o,n),n):null}))},t.prototype.load=function(t,e){return this._url=t,this.result=new Kh,ht.addEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),ht.addEventListener(V.LOADER_COMPLETE,this._onLoaderCompleteDelegate),ht.addEventListener(Q.LOAD_ERROR,this._onLoadErrorDelegate),ht.load(new pt(t),null,t,new nf(lm._scenegraphFactory)),this.result.promise},t._loaderCache={},t}();function __(t,e){return t._avmDepthID-e._avmDepthID}function m_(t,e){var i=Xm(e);return i.alPut("xMin",t.left),i.alPut("yMin",t.top),i.alPut("xMax",t.right),i.alPut("yMax",t.bottom),i}var g_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._nextHighestDepth=0,e._tempSessionID=0,e._tempDepthID=0,e.executeConstructor=null,e._locked=!1,e.unregisteredColors={},e.isDragging=!1,e.startDragPoint=new D,e.startDragMCPosition=new D,e}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["$version#","_alpha#","getAwayJSID","attachAudio","attachBitmap","attachMovie","attachVideo","beginFill","beginBitmapFill","beginGradientFill","blendMode#","cacheAsBitmap#","_callFrame","clear","createEmptyMovieClip","createTextField","_currentframe#","curveTo","_droptarget#","duplicateMovieClip","enabled#","endFill","filters#","_framesloaded#","_focusrect#","forceSmoothing#","getBounds","getBytesLoaded","getBytesTotal","getDepth","getInstanceAtDepth","getNextHighestDepth","getRect","getSWFVersion","getTextSnapshot","getURL","globalToLocal","gotoAndPlay","gotoAndStop","_height#","_highquality#","hitArea#","hitTest","lineGradientStyle","lineStyle","lineTo","loadMovie","loadVariables","localToGlobal","_lockroot#","menu#","moveTo","_name#","nextFrame","opaqueBackground#","_parent#","play","prevFrame","_quality#","removeMovieClip","_root#","_rotation#","scale9Grid#","scrollRect#","setMask","_soundbuftime#","startDrag","stop","stopDrag","swapDepths","tabChildren#","tabEnabled#","tabIndex#","_target#","_totalframes#","trackAsMenu#","transform#","toString","unloadMovie","_url#","useHandCursor#","_visible#","_width#","_x#","_xmouse#","_xscale#","_y#","_ymouse#","_yscale#"])},e.prototype.getChildForDraw=function(t){return this._tempSessionID=t._sessionID,this._tempDepthID=t._avmDepthID,t._setParent(null),t},e.prototype.returnChildAfterDraw=function(t){t._sessionID=this._tempSessionID,t._avmDepthID=this._tempDepthID,t._setParent(this.adaptee)},e.prototype.addTimelineChildAtDepth=function(t,e){e-=16383,t.adapter!=t&&t.adapter.deleteOwnProperties&&t.adapter.deleteOwnProperties(),t.reset(),this.addChildAtDepth(t,e,!0)},e.prototype.removeTimelineChildAt=function(t){t-=16383,this.removeChildAtDepth(t)},e.prototype.removeAllTimelineChilds=function(){},e.prototype.getTimelineChildAtSessionID=function(t){return this.adaptee.getTimelineChildAtSessionID(t)},e.prototype.getDepthIndexInternal=function(t){return this._depth_childs[t]?this.adaptee._children.indexOf(this._depth_childs[t]):-1},e.prototype.removeChildAtDepth=function(t){var e=this.getDepthIndexInternal(t);e>=0&&this.removeChildAt(e)},e.prototype.removeChildAt=function(t){var e=this.adaptee._children.splice(t,1)[0];e._adapter&&e.adapter.freeFromScript(),this.unregisterScriptObject(e),e._setParent(null),delete this.adaptee._sessionID_childs[e._sessionID],delete this._depth_childs[e._avmDepthID],e._sessionID=-1,e._avmDepthID=-16384},e.prototype.addChildAtDepth=function(t,e,i){if(void 0===i&&(i=!1),null==t)throw"Parameter child cannot be null.";var n=this.getDepthIndexInternal(e);if(-1!=n){if(i)return console.log("depth is occupied"),null;this.removeChildAt(n)}return this.adaptee.isSlice9ScaledMC&&"[asset Sprite]"==t.assetType&&(t.isSlice9ScaledSprite=!0),this._nextHighestDepth<e+1&&(this._nextHighestDepth=e+1),this.adaptee._children.push(t),t._avmDepthID=e,this.adaptee._children.sort(__),t._setParent(this.adaptee),t.adapter!=t&&t.adapter.initAdapter(),this._depth_childs[e]=t,i&&(this.adaptee._sessionID_childs[t._sessionID]=t),dg(t,this._avm1Context)},e.prototype.sortVirtualSceneGraph=function(t,e){return t.depth-e.depth},e.prototype.queueFrameScripts=function(t,e,i){var n=t.get_script_for_frame(this.adaptee,e,!0);n&&(i?el.add_script_to_queue(this.adaptee,n):el.add_script_to_queue_pass2(this.adaptee,n))},e.prototype.constructFrame=function(t,e,i,n,r,o,s){for(var a,l,u={},c={},h=this.adaptee._children.length,p=0;p<h;p++){var d=this.adaptee._children[p];(n||-1==d._sessionID)&&(u[d._avmDepthID]={sessionID:d._sessionID,addedOnTargetFrame:!1,depth:d._avmDepthID,child:d}),d._sessionID>=0&&(c[d._sessionID]=d)}t._update_indices.length=0,t._update_frames.length=0;var f,_,m=0;for(l=e;l<=i;l++){var g=t.frame_command_indices[l],y=t.frame_recipe[l];if(2&y)for(_=(f=t.command_index_stream[g])+t.command_length_stream[g++],a=f;a<_;a++)delete u[t.remove_child_stream[a]-16383];if(4&y)if(_=(f=t.command_index_stream[g])+t.command_length_stream[g++],o)for(a=_-1;a>=f;a--)u[t.add_child_stream[3*a+1]-16383]||(u[t.add_child_stream[3*a+1]-16383]={sessionID:t.add_child_stream[3*a],symbolID:t.add_child_stream[3*a+2],addedOnTargetFrame:l==i,depth:t.add_child_stream[3*a+1]-16383});else for(a=f;a<_;a++)u[t.add_child_stream[3*a+1]-16383]||(u[t.add_child_stream[3*a+1]-16383]={sessionID:t.add_child_stream[3*a],symbolID:t.add_child_stream[3*a+2],addedOnTargetFrame:l==i,depth:t.add_child_stream[3*a+1]-16383});8&y&&(t._update_frames[m]=t.keyframe_firstframes[l],t._update_indices[m++]=g++),16&y&&l==i&&t.start_sounds(this.adaptee,g)}var A=[];for(var v in u)A[A.length]=u[v];A.sort(this.sortVirtualSceneGraph);var b,x=[],C=[],w=[];this._depth_childs={},this.adaptee._sessionID_childs={},this.adaptee.preventScript=!0,h=x.length=A.length;for(var I=0;I<h;I++)if(-1==(b=A[I]).sessionID&&b.child)x[I]=b.child;else if(c[b.sessionID]){var E=c[b.sessionID],S=b.depth;E._avmDepthID=S,this._depth_childs[S]=E,E._sessionID=b.sessionID,this.adaptee._sessionID_childs[b.sessionID]=E,x[I]=E,n||(x[I]._adapter?(x[I].adapter.isColorTransformByScript()||x[I].transform.clearColorTransform(),x[I].adapter.isBlockedByScript()||x[I].noTimelineUpdate||(x[I].transform.clearMatrix3D(),x[I].masks=null,x[I].maskMode=!1),x[I].adapter.isVisibilityByScript()||(x[I].visible=!0)):(x[I].transform.clearColorTransform(),x[I].transform.clearMatrix3D(),x[I].visible=!0,x[I].masks=null,x[I].maskMode=!1))}else{var D=t.getChildInstance(b.symbolID,b.sessionID);this.adaptee.isSlice9ScaledMC&&"[asset Sprite]"==x[I].assetType&&(D.isSlice9ScaledSprite=!0);S=D._avmDepthID=b.depth;this._depth_childs[S]=D,D._sessionID=b.sessionID,this.adaptee._sessionID_childs[b.sessionID]=D,x[I]=D,b.addedOnTargetFrame?w[w.length]=D:C[C.length]=D}h=this.adaptee._children.length;for(var T=0;T<h;T++)x.indexOf(this.adaptee._children[T])<0&&this.adaptee._children[T]._setParent(null);this.adaptee._children=x,this.adaptee.preventScript=!0,this.finalizeChildren(C),this.adaptee.preventScript=!1,s&&this.queueFrameScripts(t,r,!o),this.finalizeChildren(w)},e.prototype.finalizeChildren=function(t){for(var e=t.length,i=0;i<e;i++){var n=t[i];n.adapter!=n&&n.adapter.deleteOwnProperties&&n.adapter.deleteOwnProperties(),n._setParent(this.adaptee),n.reset(),n.adapter!=n&&n.adapter.initAdapter()}},e.prototype.removeMovieClip=function(){this.adaptee.isAVMScene||this.adaptee.parent&&Ag(this.adaptee._avmDepthID)>=-1&&this.adaptee.parent.adapter.removeChildAtDepth(this.adaptee._avmDepthID)},e.prototype._updateMouseEnabled=function(t,e){this.adaptee.isAVMScene||t.isMouse&&(e?(this._mouseListenerCount++,this.adaptee.mouseEnabled=!0,this.adaptee.mouseChildren=!1,t.isButton&&(this._mouseButtonListenerCount++,this.adaptee.buttonMode=!0)):(this._mouseListenerCount--,this._mouseListenerCount<=0&&(this._mouseListenerCount=0,this.adaptee.mouseEnabled=!1,this.adaptee.mouseChildren=!0),t.isButton&&(this._mouseButtonListenerCount--,this._mouseButtonListenerCount<=0&&(this._mouseButtonListenerCount=0,this.adaptee.buttonMode=!1)))),this.enabled||(this.adaptee.mouseChildren=!1)},Object.defineProperty(e.prototype,"_pickGroup",{get:function(){return ce.getInstance(Kf.avmStage.view)},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=dg(this.adaptee.clone(),this._avm1Context);if("piratefont"==this.adaptee.name){var e=t.adaptee.timeline,i=e;i.frame_command_indices=[e.frame_command_indices[0]],i.frame_recipe=[e.frame_recipe[0]],i.keyframe_constructframes=[e.keyframe_constructframes[0]],i.keyframe_durations=[e.keyframe_durations[0]],i.keyframe_firstframes=[e.keyframe_firstframes[0]],i.keyframe_indices=[e.keyframe_indices[0]]}return t},e.prototype.attachCustomConstructor=function(){if(this.adaptee){var t=this.adaptee.avm1Symbol;if(t){this.alPut("__proto__",t._ownProperties.prototype.value);var e=this;this.executeConstructor=function(){t.alCall(e),e.updateAllEvents()}}}},e.prototype.executeScript=function(t){if(e.currentMCAssetNameSpace=this.adaptee.assetNamespace,d_.syncQueedTextfields(),t){if(this.adaptee.parent)for(var i=0;i<t.length;i++){var n=t[i],r=function(t){this._avm1Context.executeActions(t,this)}.bind(this,n.data);r.precedence=n.precedence,r.context=this.adaptee,r.call(this.adaptee)}}else{var o=this.adaptee.name.replace(/[^\w]/g,"");window.alert("actionsBlocks is empty, can not execute framescript"+o+this.adaptee.currentFrameIndex)}},e.prototype.stopAllSounds=function(){var t,e,i=this.alGetKeys();for(t=0;t<i.length;t++){var n=this.alGetProperty(i[t]),r=n?n.value:null;r&&r._sound&&r._sound.isAsset&&r._sound.isAsset(x)&&r.stop()}for(t=this.adaptee.numChildren;t>0;)t--,(e=this.adaptee._children[t]).isAsset(il)&&e.adapter!=e&&e.adapter.freeFromScript()},e.prototype.freeFromScript=function(){this._locked||(this.hasSwappedDepth=!1,t.prototype.freeFromScript.call(this),this._mouseButtonListenerCount=0)},e.prototype.initAdapter=function(){for(var t in this._dropTarget="",this._mouseButtonListenerCount=0,e.currentMCAssetNameSpace=this.adaptee.assetNamespace,this.adaptee.timeline.avm1InitActions)this.executeScript(this.adaptee.timeline.symbolDecoder.prepareFrameScriptsForAVM1(this.adaptee.timeline.avm1InitActions[t],0,"initActionsData"+t,this.adaptee.id));this.initEvents&&function(t,e,i){var n=dg(t,e);i.variableName&&n.alPut("variable",i.variableName);var r,o,s,a,l,u,c=i.events;if(!c)return;for(var h=null,p=0;p<c.length;p++)for(var d in(r=c[p]).actionsBlock?(o=e.actionsDataFactory.createActionsData(r.actionsBlock,"s"+i.symbolId+"d"+i.depth+"e"+p),r.actionsBlock=null,r.compiled=o):o=r.compiled,s=vg.bind(null,o,n),a=r.flags,o_)l=parseInt(d),a&(0|(l|=0))&&(262144!=l?512!=l?1!=l?(u=o_[l],u.eventName?(r.keyCode&&((h=new n_).keyCode=r.keyCode,r.keyCode<32&&r_[r.keyCode]&&(h.keyCode=r_[r.keyCode])),n._addOnClipEventListener(u,s,h)):$h.warning("ClipEvent: "+l+" not implemented")):t.onLoaded=s:t.onInitialize=s:t.onConstruct=s)}(this.adaptee,this._avm1Context,this.initEvents),this.attachCustomConstructor(),this.initialDepth=this.adaptee._avmDepthID,(this.adaptee.onLoaded||this.adaptee.onConstruct||this.adaptee.onInitialize||this.executeConstructor)&&el.add_loaded_action_to_queue(this.adaptee)},e.prototype.registerScriptObject=function(t,e){void 0===e&&(e=!0),t.adapter!=t&&t.adapter.setEnabled(!0);var i=t.name;if(i){this.context.swfVersion<8&&(i=i.toLowerCase());var n=this.alHasOwnProperty(i);if(e&&n){if(!this.alGetOwnProperty(i).isTextVar)return;this.alPut(i,dg(t,this.context))}(!this._childrenByName[i]||this._childrenByName[i].adaptee&&null==this._childrenByName[i].adaptee.parent||this._childrenByName[i].adaptee&&this._childrenByName[i].adaptee._avmDepthID>t._avmDepthID)&&(this._childrenByName[i]=dg(t,this.context),e||this.alPut(i,this._childrenByName[i]))}},e.prototype.unregisterScriptObject=function(t){if(!t.adapter._locked){var e=t.name;if(e){this.context.swfVersion<8&&(e=e.toLowerCase());var i=this.alGetOwnProperty(e);if(i&&i.value instanceof e_&&this.alDeleteOwnProperty(e),this._childrenByName[e]&&this._childrenByName[e].adaptee.id==t.id){for(var n=this.adaptee._children,r=n.length,o=null,s=null,a=0;a<r;a++)(o=n[a])!=t&&o.name&&o.name.toLowerCase()==e&&(!s||s._avmDepthID>o._avmDepthID)&&(s=o);s?this._childrenByName[e]=dg(s,this.context):delete this._childrenByName[e]}}}},e.prototype.getLatestObjectForName=function(t){if(!this.alHasOwnProperty(t)){for(var e=this.adaptee._children,i=e.length,n=null,r=null,o=0;o<i;o++)(n=e[o]).name&&n.name.toLowerCase()==t&&(!r||r._avmDepthID>n._avmDepthID)&&(r=n);r&&(this._childrenByName[t]=dg(r,this.context),this.unregisteredColors[t]&&(this.unregisteredColors[t].changeTarget(r.adapter),this.unregisteredColors[t]=null))}},Object.defineProperty(e.prototype,"graphics",{get:function(){return this.adaptee.graphics},enumerable:!0,configurable:!0}),e.prototype.initAVM1SymbolInstance=function(e,i){var n=this;this._childrenByName=Object.create(null),this._depth_childs=Object.create(null),t.prototype.initAVM1SymbolInstance.call(this,e,i),this.dragListenerDelegate=function(t){return n.dragListener(t)},this.stopDragDelegate=function(t){return n.stopDrag(t)},this.dynamicallyCreated=!1,this.adaptee=i,this._initEventsHandlers()},e.prototype._lookupChildByName=function(t){return this._childrenByName[t]},e.prototype._lookupChildInAS3Object=function(t){return dg(this.adaptee.getChildByName(t),this.context)},Object.defineProperty(e.prototype,"__targetPath",{get:function(){var t=this.get_target(),e=this.adaptee.root,i="_level"+this.context.globals._getLevelForRoot(e);return"/"!=t?i+t.replace(/\//g,"."):i},enumerable:!0,configurable:!0}),e.prototype.getAwayJSID=function(){return this.adaptee.id},e.prototype.attachAudio=function(t){Xh(t)||!1!==t&&console.warn("[AVM1MovieClip] attachAudio not implemented")},e.prototype.attachBitmap=function(t,e,i,n){void 0===i&&(i="auto"),void 0===n&&(n=!1),i=Ym(this.context,i),n=Um(this.context,n);var r=t.as3BitmapData;r.transparent=!0;var o=new ac(r);o.alphaBlending=!0,o.useColorTransform=!0;var s=new za(o,i,n);this.addChildAtDepth(s,e)},e.prototype._constructMovieClipSymbol=function(t,e){t=zm(this.context,t),e=zm(this.context,e);var i=ht.getAsset(t,this.adaptee.assetNamespace);if(i){var n=i.adaptee.clone();return n.name=e,dg(n,this._avm1Context),n}},e.prototype.get$version=function(){return""},e.prototype.rgbaToArgb=function(t){return(255&t)<<24|(4278190080&t)>>>24<<16|(16711680&t)>>>16<<8|(65280&t)>>>8},e.prototype.attachMovie=function(t,e,i,n){if(this._constructMovieClipSymbol){e&&eg(this.context,e)&&(e=e.value[0]);var r=this._constructMovieClipSymbol(t,e);if(r){var o;r.name||(r.name=""),i=jm(this.context,i),e&&(o=this._childrenByName[e.toLowerCase()]),r.reset();var s=this.addChildAtDepth(r,yg(i));return n&&s._init(n),o&&o.avmColor&&o.avmColor.changeTarget(s),r.timeline&&r.timeline.isButton&&r.addButtonListeners(),s.dynamicallyCreated=!0,e&&this.registerScriptObject(r,!0),s}}},e.prototype.beginFill=function(t,e){t=Qm(this.context,t),void 0===e&&(2==arguments.length?e=0:arguments.length<=1&&(e=100)),e=jm(this.context,e),this.graphics.beginFill(t,e/100)},e.prototype.beginBitmapFill=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=!0),void 0===n&&(n=!1);var r,o=(r=t)instanceof Jf?r.as3BitmapData:null;if(o){var s=Xh(e)?null:zf(e);i=Um(this.context,i),n=Um(this.context,n),this.graphics.beginBitmapFill(o,s,i,n)}},e.prototype.beginGradientFill=function(t,e,i,n,r,o,s,a){void 0===o&&(o="pad"),void 0===s&&(s="rgb"),void 0===a&&(a=0);var l=this.context,u=wm.mapToJSArray(e,(function(t){return Qm(l,t)})),c=wm.mapToJSArray(i,(function(t){return jm(l,t)/100})),h=wm.mapToJSArray(n,(function(t){return jm(l,t)}));Xh(r)&&console.warn("[AVM1MovieClip] beginGradientFill not fully implemented"),o=zm(l,o),s=zm(l,s),a=jm(l,a),this.graphics.beginGradientFill(t,u,c,h,null,o,s,a)},e.prototype._callFrame=function(t){var e;"string"==typeof t?(t=t.toLowerCase(),e=this.adaptee.timeline.getScriptForLabel(this.adaptee,t,!0)):"number"==typeof t&&(e=this.adaptee.timeline.get_script_for_frame(this.adaptee,t-1,!0)),e&&this.executeScript(e)},e.prototype.clear=function(){this.graphics.clear()},e.prototype._updateChildName=function(t,e,i){e!==i&&(e&&this._removeChildName(t,e),i&&this._addChildName(t,i))},e.prototype._removeChildName=function(t,e){if(this.context.isPropertyCaseSensitive||(e=e.toLowerCase()),this._childrenByName&&this._childrenByName[e]&&this._childrenByName[e]===t){var i=this._lookupChildInAS3Object(e);i?this._childrenByName[e]=i:delete this._childrenByName[e]}},e.prototype._addChildName=function(t,e){this.context.isPropertyCaseSensitive||(e=e.toLowerCase());var i=this._childrenByName[e];(!i||i.getDepth()>t.getDepth())&&(this._childrenByName[e]=t)},e.prototype.createEmptyMovieClip=function(t,e){t=zm(this.context,t);var i=new il;i.name=t,i.assetNamespace=this.adaptee.assetNamespace,dg(i,this._avm1Context);var n=this.addChildAtDepth(i,yg(e));return n.dynamicallyCreated=!0,this.registerScriptObject(i,!1),i.mouseEnabled=!1,n},e.prototype.createTextField=function(t,e,i,n,r,o){t=zm(this.context,t);var s=new sh;s.name=t,s.textFormat=new Pc,dg(s,this._avm1Context);var a=this.addChildAtDepth(s,yg(e));return this.registerScriptObject(s,!1),s.x=i,s.y=n,s.width=r,s.height=o,a.dynamicallyCreated=!0,a},e.prototype.get_currentframe=function(){return this.adaptee.currentFrameIndex+1},e.prototype.curveTo=function(t,e,i,n){t=jm(this.context,t),e=jm(this.context,e),i=jm(this.context,i),n=jm(this.context,n),this.graphics.curveTo(t,e,i,n)},e.prototype.setDropTarget=function(t){if(t){for(var e=[];t;)t.isAVMScene?t=null:(null!=t.name&&e.push(t.name),t=t.parent);for(var i=e.length,n="";i>0;)""!=e[--i]&&(n+="/"),n+=e[i];this._dropTarget=n}else this._dropTarget=""},e.prototype.get_droptarget=function(){return this._dropTarget},e.prototype.duplicateMovieClip=function(t,e,i){if((t=zm(this.context,t))==this.adaptee.name)return this;var n,r=this.get_parent();r||(console.warn("[AVM1MovieClip] duplicateMovieClip could not get parent"),r=this.context.resolveTarget(null)),this.adaptee._symbol?console.warn("[AVM1MovieClip] duplicateMovieClip from symbol not implemented"):n=this.clone().adaptee,n.reset(),n.name=t,n.adapter.placeObjectTag=this.placeObjectTag,n.adapter.initEvents=this.initEvents;var o=r.addChildAtDepth(n,yg(e));o.dynamicallyCreated=!0,o._avm1Context=this._avm1Context,r.registerScriptObject(n,!1);var s=n.transform.matrix3D,a=this.adaptee.transform.matrix3D._rawData;return s._rawData[0]=a[0],s._rawData[1]=a[1],s._rawData[4]=a[4],s._rawData[5]=a[5],s._rawData[12]=a[12],s._rawData[13]=a[13],n.transform.invalidateComponents(),n.alpha=this.adaptee.alpha,n.blendMode=this.adaptee.blendMode,n.cacheAsBitmap=this.adaptee.cacheAsBitmap,i&&o._init(i),o},e.prototype.endFill=function(){this.graphics.endFill()},e.prototype.getForceSmoothing=function(){return console.warn("[AVM1MovieClip] getForceSmoothing"),!1},e.prototype.setForceSmoothing=function(t){t=Um(this.context,t),console.warn("[AVM1MovieClip] setForceSmoothing")},e.prototype.get_framesloaded=function(){return console.warn("[AVM1MovieClip] get_framesloaded"),0},e.prototype.getBounds=function(t){var e=ag(t);if(e)return m_(this._pickGroup.getBoundsPicker(this.adaptee.partition).getBoxBounds(e,!0,!0),this.context)},e.prototype.getBytesLoaded=function(){return this.adaptee.currentFrameIndex>=0?100:-1},e.prototype.getBytesTotal=function(){return 100},e.prototype.getInstanceAtDepth=function(t){var e=this._depth_childs[yg(t)];return e?e.isAsset(za)||e.isAsset(il)?this:dg(e,this.context):null},e.prototype.getNextHighestDepth=function(){return this.context.swfVersion<7?0:Ag(this._nextHighestDepth)},e.prototype.getRect=function(t){var e=ag(t);if(e)return m_(this._pickGroup.getBoundsPicker(this.adaptee.partition).getBoxBounds(e,!1,!0),this.context)},e.prototype.getSWFVersion=function(){return this.context.swfVersion},e.prototype.getTextSnapshot=function(){console.warn("[AVM1MovieClip] getTextSnapshot")},e.prototype.getURL=function(t,e,i){0!==(t=String(t)).toLowerCase().indexOf("fscommand:")?window.open(t,e):console.warn("[AVM1MovieClip] fsCommand not implemented ")},e.prototype.globalToLocal=function(t){if(t){var e=Tf(t);this.adaptee.transform.globalToLocal(e,e),Pf(e,t)}},e.prototype.gotoAndPlay=function(t){if(!this.protoTypeChanged&&null!=t){if(Array.isArray(t)){if(0==t.length)return;t=t[0]}if(t instanceof wm){if(!t.value||0==t.value.length)return;t=t.value[0]}if("string"==typeof t){var e=t.toLowerCase();if(null==this.adaptee.timeline._labels[e])return t=parseInt(t),void(isNaN(t)||(this.adaptee.currentFrameIndex=t-1,this.adaptee.play()))}"number"==typeof t&&t<=0||(this.adaptee.play(),this._gotoFrame(t))}},e.prototype.gotoAndStop=function(t){if(!this.protoTypeChanged&&null!=t){if(Array.isArray(t)){if(0==t.length)return;t=t[0]}if(t instanceof wm){if(!t.value||0==t.value.length)return;t=t.value[0]}"number"==typeof t&&t<=0||(this.adaptee.stop(),this._gotoFrame(t))}},e.prototype._gotoFrame=function(t){if("number"==typeof t&&t%1!=0&&(t=t.toString()),"string"==typeof t){var e=t.toLowerCase();if(null==this.adaptee.timeline._labels[e])return t=parseInt(t),void(isNaN(t)||(this.adaptee.currentFrameIndex=t-1));this.adaptee.jumpToLabel(e)}else this.adaptee.currentFrameIndex=t-1},e.prototype.getHitArea=function(){return this._hitArea},e.prototype.setHitArea=function(t){this._hitArea=t;var e=t?ag(t):null;e&&!e.isAsset(il)&&(e=null)},e.prototype.hitTest=function(t,e,i){if(arguments.length<=1){var n=t;return"string"==typeof n&&(n=this.context.resolveTarget(n)),!(Xh(n)||!sg(n))&&this._pickGroup.getBoundsPicker(this.adaptee.partition).hitTestObject(this._pickGroup.getBoundsPicker(ag(n).partition))}t=jm(this.context,t),e=jm(this.context,e);var r=this.get_root();return r?(t+=r.get_x(),e+=r.get_y(),i=Um(this.context,i),this._pickGroup.getBoundsPicker(this.adaptee.partition).hitTestPoint(t,e,i)):(console.warn("[AVM1MovieClip:: hitTest] Root return undef! Return false to prevent crash!"),!1)},e.prototype.lineGradientStyle=function(t,e,i,n,r,o,s,a){void 0===o&&(o="pad"),void 0===s&&(s="rgb"),void 0===a&&(a=0);var l=this.context,u=wm.mapToJSArray(e,(function(t){return Qm(l,t)})),c=wm.mapToJSArray(i,(function(t){return jm(l,t)/100})),h=wm.mapToJSArray(n,(function(t){return jm(l,t)}));o=zm(l,o),s=zm(l,s),a=jm(l,a),this.graphics.lineGradientStyle(t,u,c,h,null,o,s,a)},e.prototype.lineStyle=function(t,i,n,r,o,s,a,l){void 0===t&&(t=NaN),void 0===i&&(i=0),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===o&&(o="normal"),void 0===s&&(s="round"),void 0===a&&(a="round"),void 0===l&&(l=3),t=jm(this.context,t),i=Qm(this.context,i),r=Um(this.context,r),o=zm(this.context,o);var u=e.capStyleMapStringToInt[zm(this.context,s)],c=e.jointStyleMapStringToInt[zm(this.context,a)];l=jm(this.context,l),this.graphics.lineStyle(t,i,n/100,r,e.noScaleDictionary[o],u,c,l)},e.prototype.lineTo=function(t,e){t=mg(jm(this.context,t)),e=mg(jm(this.context,e)),this.graphics.lineTo(t,e)},e.prototype.loadMovie=function(t,e){new f_(this.context).loadMovieAt(t,e,this).then((function(t){}))},e.prototype.loadVariables=function(t,e){this.context.actions._loadVariables(this,t,e)},e.prototype.localToGlobal=function(t){if(t){var e=Tf(t);this.adaptee.transform.localToGlobal(e,e),Pf(e,t)}},e.prototype.get_lockroot=function(){return this._lockroot},e.prototype.set_lockroot=function(t){this._lockroot=Um(this.context,t)},e.prototype.moveTo=function(t,e){t=mg(jm(this.context,t)),e=mg(jm(this.context,e)),this.graphics.moveTo(t,e)},e.prototype.nextFrame=function(){this.adaptee.stop(),++this.adaptee.currentFrameIndex},e.prototype.nextScene=function(){console.warn("[AVM1MovieClip] nextScene not implemented")},e.prototype.play=function(){this.adaptee.play()},e.prototype.prevFrame=function(){this.adaptee.stop(),--this.adaptee.currentFrameIndex},e.prototype.prevScene=function(){console.warn("[AVM1MovieClip] prevScene not implemented")},e.prototype.setMask=function(t){if(null!=t){var e=this.context.resolveTarget(t);e&&(this.adaptee.mask=ag(e))}else this.adaptee.mask=null},e.prototype.startDrag=function(t,i,n,r,o){if(e.currentDraggedMC&&e.currentDraggedMC!=this&&e.currentDraggedMC.stopDrag(),e.currentDraggedMC=this,t=Um(this.context,t),this._dragBounds=null,i>r){var s=r;r=i,i=s}if(n>o){s=o;o=n,n=s}arguments.length>1&&(i=jm(this.context,i),n=jm(this.context,n),r=jm(this.context,r),o=jm(this.context,o),this._dragBounds=new Y(i,n,r-i,o-n)),this.isDragging||(this.isDragging=!0,this.startDragPoint=this.adaptee.parent.transform.globalToLocal(new D(Kf.avmStage.view.stage.screenX,Kf.avmStage.view.stage.screenY)),t&&(this.adaptee.x=this.startDragPoint.x,this.adaptee.y=this.startDragPoint.y),this._dragBounds&&this.checkBounds(),this.startDragMCPosition.x=this.adaptee.x,this.startDragMCPosition.y=this.adaptee.y,Kf.avmStage.view.stage.addEventListener(tl.MOUSE_MOVE,this.dragListenerDelegate),Kf.avmStage.mousePicker.dragEntity=this.adaptee,Kf.avmStage.mouseManager.startDragObject(this.adaptee.getAbstraction(Kf.avmStage.mousePicker.pickGroup).pickingCollision))},e.prototype.dragListener=function(t){if(this.adaptee.parent){var e=Kf.avmStage.view.stage,i=this.adaptee.parent.transform.globalToLocal(new D(e.screenX,e.screenY));this.adaptee.x=this.startDragMCPosition.x+(i.x-this.startDragPoint.x),this.adaptee.y=this.startDragMCPosition.y+(i.y-this.startDragPoint.y),this._dragBounds&&this.checkBounds()}},e.prototype.checkBounds=function(){this.adaptee.x<this._dragBounds.left&&(this.adaptee.x=this._dragBounds.left),this.adaptee.x>this._dragBounds.right&&(this.adaptee.x=this._dragBounds.right),this.adaptee.y<this._dragBounds.top&&(this.adaptee.y=this._dragBounds.top),this.adaptee.y>this._dragBounds.bottom&&(this.adaptee.y=this._dragBounds.bottom)},e.prototype.stop=function(){return this.adaptee.stop()},e.prototype.stopDrag=function(t){e.currentDraggedMC&&e.currentDraggedMC!=this&&e.currentDraggedMC.stopDrag(),this.isDragging=!1,e.currentDraggedMC=null,Kf.avmStage.mousePicker.dragEntity=null,Kf.avmStage.mouseManager.stopDragObject(),Kf.avmStage.removeEventListener(tl.MOUSE_MOVE,this.dragListenerDelegate)},e.prototype.swapChildrenToDepth=function(t,e,i,n){var r;e&&this._depth_childs[i]&&(e=this._depth_childs[i].adapter),delete this.adaptee._sessionID_childs[t.adaptee._sessionID],t.adaptee._avmDepthID=i,t.adaptee._sessionID=-1,t.adaptee._setParent(null),t.adaptee._setParent(this.adaptee),t.hasSwappedDepth=!0,this._depth_childs[i]=t.adaptee;var o=this.adaptee._children.indexOf(t.adaptee);if(e){var s=this.adaptee._children.indexOf(e.adaptee),a=this.adaptee._children;r=[a[s],a[o]],a[o]=r[0],a[s]=r[1],delete this.adaptee._sessionID_childs[e.adaptee._sessionID],this._depth_childs[n]=e.adaptee,e.adaptee._avmDepthID=n,e.adaptee._sessionID=-1,e.adaptee._setParent(null),e.adaptee._setParent(this.adaptee),e.hasSwappedDepth=!0}else delete this._depth_childs[n],this.adaptee._children.sort(__);this.adaptee.name&&parent&&(this.getLatestObjectForName(t.adaptee.name.toLowerCase()),e&&this.getLatestObjectForName(e.adaptee.name.toLowerCase()))},e.prototype.swapDepths=function(t){if(!this.adaptee.isAVMScene&&this.get_parent()){var e=this.get_parent(),i=null;if(e)if(void 0!==t){if("number"==typeof t){if(t=yg(t),this.adaptee._avmDepthID==t)return;(i=e._depth_childs[t])&&(i=i.adapter)}else if(t.adaptee){if(t.get_parent()!=e)return;t=(i=t).adaptee._avmDepthID}e.swapChildrenToDepth(this,i,t,this.adaptee._avmDepthID)}else console.warn("[AVM1MovieClip] swapDepth called with undefined as target depth");else console.warn("[AVM1MovieClip] swapDepth called for object with no parent")}},e.prototype.getTabChildren=function(){return lg(this).tabChildren},e.prototype.setTabChildren=function(t){lg(this).tabChildren=Um(this.context,t)},e.prototype.get_totalframes=function(){return this.adaptee.numFrames},e.prototype.getTrackAsMenu=function(){return console.warn("[AVM1MovieClip] getTrackAsMenu not implemented"),lg(this).trackAsMenu},e.prototype.setTrackAsMenu=function(t){console.warn("[AVM1MovieClip] setTrackAsMenu not implemented"),lg(this).trackAsMenu=Um(this.context,t)},e.prototype.unloadMovie=function(){var t=this.adaptee;this.adaptee.constructedKeyFrameIndex=0,this.adaptee.stop(),t.removeChildren(0,t.numChildren),(this.dynamicallyCreated||this.hasSwappedDepth)&&t.parent&&t.parent.adapter&&t.parent.adapter.unregisterScriptObject(t)},e.prototype.getUseHandCursor=function(){return this.adaptee.useHandCursor},e.prototype.setUseHandCursor=function(t){this.adaptee&&(this.adaptee.useHandCursor=t)},e.prototype.setParameters=function(t){for(var e in t)this.alHasProperty(e)||this.alPut(e,t[e])},e.prototype._resolveLevelNProperty=function(t){if("_level0"===t||"_level"===t)return this.context.resolveRoot();if("_root"===t)return this.context.resolveRoot();if(0===t.indexOf("_level")){var e=t.substring(6),i=0|e;if(i>0&&e==i)return this.context.resolveLevel(i)}return null},e.prototype._getCachedPropertyResult=function(t){return this._cachedPropertyResult?this._cachedPropertyResult.value=t:this._cachedPropertyResult={flags:65,value:t},this._cachedPropertyResult},e.prototype.alGetOwnProperty=function(e){var i=t.prototype.alGetOwnProperty.call(this,e);if(i)return i;if("_"===e[0])if("l"===e[1]&&0===e.indexOf("_level")||"r"===e[1]&&0===e.indexOf("_root")){var n=this._resolveLevelNProperty(e);if(n)return this._getCachedPropertyResult(n)}else if(e.toLowerCase()in Wf)return t.prototype.alGetOwnProperty.call(this,e.toLowerCase());if(sg(this)){var r=this._lookupChildByName(e);if(r)return this._getCachedPropertyResult(r)}},e.prototype.alGetOwnPropertiesKeys=function(){var e=t.prototype.alGetOwnPropertiesKeys.call(this);if(!sg(this))return e;var i=this.adaptee;if(0===i._children.length)return e;var n=Object.create(null),r=e.length,o=0;for(o=0;o<r;o++)n[e[o]]=!0;var s=i._children.length;for(o=0;o<s;o++)n[i._children[o].name]=!0;return Object.getOwnPropertyNames(n)},e.prototype._init=function(t){var e=this;t instanceof Sf&&Jm(t,(function(i){e.alPut(i,t.alGet(i))}),null)},e.prototype._initEventsHandlers=function(){this.bindEvents(h_)},e.currentMCAssetNameSpace="",e.currentDraggedMC=null,e.pokiSDKonStopActionChildName=null,e.pokiSDKonStopAction=null,e.capStyleMapStringToInt={none:0,round:1,square:2},e.jointStyleMapStringToInt={round:0,bevel:1,miter:2},e.noScaleDictionary={normal:Cs.NORMAL,none:Cs.NONE,vertical:Cs.VERTICAL,horizontal:Cs.HORIZONTAL},e}(e_);function y_(t){sg(t)&&t.updateAllEvents()}var A_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,["initialize"],[])},e.initialize=function(t,e){var i=new Ef(65,new wm(t,[]));e.alSetOwnProperty("_listeners",i),i=new Ef(65,new Nm(t,(function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var r=this.alGet("_listeners");r instanceof wm&&cg(t,this,e,i)}))),e.alSetOwnProperty("broadcastMessage",i),i=new Ef(65,new Nm(t,(function(t){var e=this.alGet("_listeners");return e instanceof wm&&(e.value.push(t),y_(this),!0)}))),e.alSetOwnProperty("addListener",i),i=new Ef(65,new Nm(t,(function(t){var e=this.alGet("_listeners");if(!(e instanceof wm))return!1;var i=e.value,n=i.indexOf(t);return!(n<0)&&(i.splice(n,1),y_(this),!0)}))),e.alSetOwnProperty("removeListener",i)},e}(Sf),v_=["avHardwareDisable","hasAccessibility","hasAudio","hasAudioEncoder","hasEmbeddedVideo","hasIME","hasMP3","hasPrinting","hasScreenBroadcast","hasScreenPlayback","hasStreamingAudio","hasStreamingVideo","hasVideoEncoder","isDebugger","language","localFileReadDisable","manufacturer","os","pixelAspectRatio","playerType","screenColor","screenDPI","screenResolutionX","screenResolutionY","serverString","version"],b_=function(t){function e(e){var i=t.call(this,e)||this;i.alPrototype=e.builtins.Object.alGetPrototypeProperty();var n=null;return v_.forEach((function(t){n=new Ef(131,null,{alCall:function(){return null}}),i.alSetOwnProperty(t,n)}),i),i}return i(e,t),e}(Sf),x_=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(i,{sandboxType:{get:i.getSandboxType},allowDomain:{value:i.allowDomain},allowInsecureDomain:{value:i.allowInsecureDomain},loadPolicyFile:{value:i.loadPolicyFile}}),i}return i(e,t),e.prototype.getSandboxType=function(){return null},e.prototype.allowDomain=function(t){t=Ym(this.context,t)},e.prototype.allowInsecureDomain=function(t){t=Ym(this.context,t)},e.prototype.loadPolicyFile=function(t){t=Ym(this.context,t)},e}(Sf),C_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.alInitStatic=function(t){this._capabilities=new b_(t),this._security=new x_(t)},e.createAVM1Class=function(t){return _g(t,!1,e,["capabilities#","security#"],[])},e.getCapabilities=function(t){return t.getStaticState(e)._capabilities},e.getSecurity=function(t){return t.getStaticState(e)._security},e}(Sf),w_=[-1,37,39,36,35,45,46,-1,8,-1,-1,-1,-1,13,38,40,33,34,9,27],I_={1:o_[8192],2:o_[16384],4:o_[1024],8:o_[2048],64:o_[4096],160:o_[32768],272:o_[65536]},E_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["$version#","_alpha#","getAwayJSID","attachAudio","attachBitmap","attachMovie","beginFill","beginBitmapFill","beginGradientFill","blendMode#","cacheAsBitmap#","_callFrame","clear","createEmptyMovieClip","createTextField","_currentframe#","curveTo","_droptarget#","duplicateMovieClip","enabled#","endFill","filters#","_framesloaded#","_focusrect#","forceSmoothing#","getBounds","getBytesLoaded","getBytesTotal","getDepth","getInstanceAtDepth","getNextHighestDepth","getRect","getSWFVersion","getTextSnapshot","getURL","globalToLocal","gotoAndPlay","gotoAndStop","_height#","_highquality#","hitArea#","hitTest","lineGradientStyle","lineStyle","lineTo","loadMovie","loadVariables","localToGlobal","_lockroot#","menu#","moveTo","_name#","nextFrame","opaqueBackground#","_parent#","play","prevFrame","_quality#","removeMovieClip","_root#","_rotation#","scale9Grid#","scrollRect#","setMask","_soundbuftime#","startDrag","stop","stopDrag","swapDepths","tabChildren#","tabEnabled#","tabIndex#","_target#","_totalframes#","trackAsMenu#","toString","unloadMovie","_url#","useHandCursor#","_visible#","_width#","_x#","_xmouse#","_xscale#","_y#","_ymouse#","_yscale#"])},e.prototype._updateMouseEnabled=function(t,e){this.adaptee.isAVMScene||t.isMouse&&(e?(this._mouseListenerCount++,this.adaptee.mouseEnabled=!0,this.adaptee.mouseChildren=!1,t.isButton&&(this._mouseButtonListenerCount++,this.adaptee.buttonMode=!0)):(this._mouseListenerCount--,this._mouseListenerCount<=0&&(this._mouseListenerCount=0,this.adaptee.mouseEnabled=!1,this.adaptee.mouseChildren=!1),t.isButton&&(this._mouseButtonListenerCount--,this._mouseButtonListenerCount<=0&&(this._mouseButtonListenerCount=0,this.adaptee.buttonMode=!1))))},e.prototype.initAVM1SymbolInstance=function(e,i){t.prototype.initAVM1SymbolInstance.call(this,e,i);for(var n=this.adaptee,r=this._requiredListeners=Object.create(null),o=this._actions=n.timeline.avm1ButtonActions,s=null,a=null,l=!1,u=o.length,c=0;c<u;c++)if((s=o[c]).actionsBlock||(s.actionsBlock=e.actionsDataFactory.createActionsData(s.actionsData,"s"+n.id+"e"+c)),s.keyCode,0!=s.stateTransitionFlags){for(var h in a=this._mouseEventHandler.bind(this,s.stateTransitionFlags),l=!1,I_)s.stateTransitionFlags&parseInt(h)&&(l=!0,r[I_[h].eventName]={handler:I_[h],boundListener:a});l||console.warn("unknown button event flag",s.stateTransitionFlags)}this.adaptee.addButtonListeners(),this._initEventsHandlers(),this._addListeners()},e.prototype.initAdapter=function(){t.prototype.initAdapter.call(this),this._addListeners()},e.prototype.stop=function(){return this.adaptee.stop()},e.prototype.getEnabled=function(){return this.enabled},e.prototype.setEnabled=function(t){this.adaptee.buttonEnabled=t,t!=this.enabled&&(this.enabled=t,this.setEnabledListener(t),this.adaptee.mouseEnabled=!0)},e.prototype.getTrackAsMenu=function(){return!1},e.prototype.setTrackAsMenu=function(t){},e.prototype._addListeners=function(){for(var t in this._requiredListeners)this._eventHandlers[t]=this._requiredListeners[t].handler,this._eventsListeners[t]=this._requiredListeners[t].boundListener;this.setEnabledListener(this.enabled)},e.prototype._removeListeners=function(){for(var t in this._requiredListeners)this.adaptee.removeEventListener(t,this._requiredListeners[t].boundListener)},e.prototype._keyDownHandler=function(t){for(var e=this._actions,i=e.length,n=0;n<i;n++){var r=e[n];r.keyCode&&((r.keyCode<32&&w_[r.keyCode]===t.axGetPublicProperty("keyCode")||r.keyCode===t.axGetPublicProperty("charCode"))&&this._runAction(r))}},e.prototype._mouseEventHandler=function(t){for(var e=this._actions,i=e.length,n=0;n<i;n++){var r=e[n];r.stateTransitionFlags===t&&this._runAction(r)}},e.prototype._runAction=function(t){var e=this._avm1Context;this.adaptee.parent&&e.executeActions(t.actionsBlock,dg(this.adaptee.parent,this.context))},e.prototype._initEventsHandlers=function(){this.bindEvents(p_)},e}(g_),S_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["getRGB","getTransform","setRGB","setTransform"],null,e.prototype.avm1Constructor)},e.prototype.avm1Constructor=function(t){t&&(this._target=this.context.resolveTarget(t),this._target&&this._target.adaptee&&!this._target.adaptee.isAVMScene&&(this._target.avmColor=this,this._targetAwayObject=ag(this._target)))},e.prototype.changeTarget=function(t){t&&t instanceof e_?(this._target=t,this._target.avmColor=this,this._target._ctBlockedByScript=!0,this._targetAwayObject=ag(this._target)):this._target=null},e.prototype.getRGB=function(){var t=e.prototype.getTransform.call(this);return t?t.getRgb():null},e.prototype.getTransform=function(){return this._targetAwayObject?jf.fromAwayColorTransform(this.context,this._targetAwayObject.transform.colorTransform):null},e.prototype.setRGB=function(t){var i=e.prototype.getTransform.call(this);i&&(i.setRgb(t),e.prototype.setTransform.call(this,i)),this._target&&(this._target._ctBlockedByScript=!0)},e.prototype.setTransform=function(t){if(this._targetAwayObject&&t){var e=t;t instanceof jf||t instanceof Sf&&(e=function(t){var e=t.context;if(!(t instanceof Sf))return new jf(e,1,1,1,1,0,0,0,0);var i=t.alGet("alphaOffset");null==i&&(i=t.alGet("ab"));var n=t.alGet("alphaMultiplier");null==n&&null!=(n=t.alGet("aa"))&&(n/=100);var r=t.alGet("redOffset");null==r&&(r=t.alGet("rb"));var o=t.alGet("redMultiplier");null==o&&null!=(o=t.alGet("ra"))&&(o/=100);var s=t.alGet("greenOffset");null==s&&(s=t.alGet("gb"));var a=t.alGet("greenMultiplier");null==a&&null!=(a=t.alGet("ga"))&&(a/=100);var l=t.alGet("blueOffset");null==l&&(l=t.alGet("bb"));var u=t.alGet("blueMultiplier");return null==u&&null!=(u=t.alGet("ba"))&&(u/=100),new jf(e,Km(e,Vf(o,1)),Km(e,Vf(a,1)),Km(e,Vf(u,1)),Km(e,Vf(n,1)),Km(e,Vf(r,0)),Km(e,Vf(s,0)),Km(e,Vf(l,0)),Km(e,Vf(i,0)))}(t)),e&&(this._targetAwayObject.transform.colorTransform._rawData[0]=e._rawData[0],this._targetAwayObject.transform.colorTransform._rawData[1]=e._rawData[1],this._targetAwayObject.transform.colorTransform._rawData[2]=e._rawData[2],this._targetAwayObject.transform.colorTransform._rawData[3]=e._rawData[3],this._targetAwayObject.transform.colorTransform._rawData[4]=e._rawData[4],this._targetAwayObject.transform.colorTransform._rawData[5]=e._rawData[5],this._targetAwayObject.transform.colorTransform._rawData[6]=e._rawData[6],this._targetAwayObject.transform.colorTransform._rawData[7]=e._rawData[7],this._targetAwayObject.transform.invalidateColorTransform(),this._targetAwayObject.invalidate(),this._targetAwayObject._invalidateHierarchicalProperties(Dt.COLOR_TRANSFORM))}this._target&&(this._target._ctBlockedByScript=!0)},e}(Sf),D_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!1,e,["show","hide"],[])},e.bindStage=function(t,i,n,r){var o=n.view.stage;e.mouseDownDelegate&&o.removeEventListener(tl.MOUSE_DOWN,e.mouseDownDelegate),e.mouseMoveDelegate&&o.removeEventListener(tl.MOUSE_MOVE,e.mouseMoveDelegate),e.mouseOutDelegate&&o.removeEventListener(tl.MOUSE_OUT,e.mouseOutDelegate),e.mouseUpDelegate&&o.removeEventListener(tl.MOUSE_UP,e.mouseUpDelegate),e.mouseDownDelegate=function(t){$m(i,"broadcastMessage",["onMouseDown"])},e.mouseMoveDelegate=function(t){$m(i,"broadcastMessage",["onMouseMove"])},e.mouseOutDelegate=function(t){$m(i,"broadcastMessage",["onMouseOut"])},e.mouseUpDelegate=function(t){$m(i,"broadcastMessage",["onMouseUp"])},o.addEventListener(tl.MOUSE_DOWN,e.mouseDownDelegate),o.addEventListener(tl.MOUSE_MOVE,e.mouseMoveDelegate),o.addEventListener(tl.MOUSE_OUT,e.mouseOutDelegate),o.addEventListener(tl.MOUSE_UP,e.mouseUpDelegate)},e.hide=function(){lm.instance.Stage.avmStage.mouseManager.showCursor=!1},e.show=function(){lm.instance.Stage.avmStage.mouseManager.showCursor=!0},e.mouseDownDelegate=null,e.mouseMoveDelegate=null,e.mouseOutDelegate=null,e.mouseUpDelegate=null,e.mouseMiddleDownDelegate=null,e.mouseMiddleUpDelegate=null,e.mouseMiddleDownClicked=!1,e}(Sf),T_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["loadClip","unloadClip","getProgress"],null,e.prototype.avm1Constructor)},e.prototype.avm1Constructor=function(){A_.initialize(this.context,this)},e.prototype.loadClip=function(t,e){var i=this;if("number"==typeof e){if(0===e)return!1}else if(!this.context.resolveTarget(e))return!1;var n=new f_(this.context);if(this._loaderHelper=n,this._target=null,!t)return!1;var r=e;return 0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&(t=this.context.globals.SWF_BASE_URL+t),n.loadMovieAt(t,"get",r).then((function(t){t?($m(i,"broadcastMessage",["onLoadComplete",e]),setTimeout((function(){$m(i,"broadcastMessage",["onLoadInit",e])}))):console.warn("load - content is null")})),!0},e.prototype.unloadClip=function(t){return!0},e.prototype.getProgress=function(t){return 0},e}(Sf);function P_(t,e,i,n,r,o){var s=new pt(e),a=s.url||"",l=a.replace(/\?.*$/,""),u=af(a,null);if(u){if(u.supressLoad)return void console.log("[LOADER] Load surpressed ",u.url);console.log("[LOADER] Override loading url:",u.url),s.url=u.url}else console.log("[LOADER] start loading the url:",l);i&&(s.method=i),r&&(s.data=r);var c=new st;c.dataFormat="text";var h=function(e){c.removeEventListener(Q.LOAD_COMPLETE,h),cg(t,o,"onData",[c.data])};c.addEventListener(Q.LOAD_COMPLETE,h),o._as3Loader=c,u&&u.supressErrors&&c.addEventListener(Q.LOAD_ERROR,(function(t){console.log("[LOADER] Error supressed by redirect rule as empty complete events!",t),c.dispatchEvent(new Q(Q.LOAD_COMPLETE,c))})),c.load(s)}var B_,M_=function(t){function e(e){var i=t.call(this,e)||this;return i.alSetOwnPrototypeProperty(new O_(e,i)),i}return i(e,t),e.prototype.alConstruct=function(t){var e=new Sf(this.context);return e.alPrototype=this.alGetPrototypeProperty(),e.isAVM1DataObject=!0,e},e.prototype.alCall=function(t,e){return this.alConstruct(e)},e}(Df),O_=function(t){function e(e,i){var n=t.call(this,e)||this;return rg(n,{constructor:{value:i,writable:!0},toString:{value:n._toString},load:{value:n.load},onData:{value:n.defaultOnData},decode:{value:n.decode},send:{value:n.load},sendAndload:{value:n.load}}),n}return i(e,t),e.prototype.getBytesLoaded=function(){if(this._as3Loader)return this._as3Loader.bytesLoaded},e.prototype.getBytesTotal=function(){if(this._as3Loader)return this._as3Loader.bytesTotal},e.prototype.load=function(t){return!!(t=Ym(this.context,t))&&(P_(this.context,t,null,0,null,this),!0)},e.prototype.defaultOnData=function(t){Xh(t)?cg(this.context,this,"onLoad",[!1]):(e.prototype.decode.call(this,t),this.alPut("loaded",!0),cg(this.context,this,"onLoad",[!0]))},e.prototype.decode=function(t){t=Ym(this.context,t)},e.prototype._toString=function(){return""},e.prototype.send=function(t,e,i){return t=Ym(this.context,t),i=Xh(i)?"POST":Ym(this.context,i),!1},e.prototype.sendAndLoad=function(t,e,i){if(t=Ym(this.context,t),i=Xh(i)?"POST":Ym(this.context,i),!(t&&e instanceof Sf))return!1;if(!e.isAVM1DataObject)return!1;var n=this.alGet("contentType");n=Xh(n)?"application/x-www-form-urlencoded":Ym(this.context,n);var r=zm(this.context,this);return P_(this.context,t,i,0,r,e),!0},e}(Sf),L_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loopsToPlay=0,e}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["attachSound","duration#","getBytesLoaded","getBytesTotal","loadSound","getPan","setPan","getTransform","setTransform","getVolume","setVolume","start","stop","onSoundComplete"],null,e.prototype.avm1Constructor)},e.prototype.avm1Constructor=function(t){this._target=this.context.resolveTarget(t),this._sound=null,this._channel=null,this._linkageID=null,this._playAfterLoading=!1,this._assetNameSpace=g_.currentMCAssetNameSpace},e.prototype.alPut=function(e,i){t.prototype.alPut.call(this,e,i),e&&"onsoundcomplete"==e.toLowerCase()&&this.onSoundComplete(i)},e.prototype.alDeleteProperty=function(e){return t.prototype.alDeleteProperty.call(this,e),e&&"onsoundcomplete"==e.toLowerCase()&&this.onSoundComplete(),!0},e.prototype.attachSound=function(t){var e=this;if("string"==typeof t||"number"==typeof t){var i=ht.getAsset(t,this._assetNameSpace);i&&(this._linkageID=t,this._sound=i.clone(),this._sound&&(this._sound.onSoundComplete=function(){return e.soundCompleteInternal()}))}},e.prototype.soundCompleteInternal=function(){this.loopsToPlay--,this.loopsToPlay>0?(this.stop(),this._sound.play(0,!1)):this._onCompleteCallback&&this._onCompleteCallback()},e.prototype.onSoundComplete=function(t){void 0===t&&(t=null);var e=this;this._onCompleteCallback=null,t&&(this._onCompleteCallback=function(){t.alCall(e)}),this._sound},e.prototype.loadSound=function(t,e){var i=this;e?(this._playAfterLoading=!0,console.warn("[AVM1Sound] - loadSound called with isStreaming=true, but streaming not implemented yet",t,e)):this._playAfterLoading=!1;var n=new ut;n.addEventListener(l.ASSET_COMPLETE,(function(t){return i.onAssetComplete(t)})),n.addEventListener(V.LOADER_COMPLETE,(function(t){return i.onLoadComplete(t)})),n.addEventListener(Q.LOAD_ERROR,(function(t){return i.onLoadError(t)})),n.load(new pt(t),null,t,new gt)},e.prototype.onAssetComplete=function(t){var e=t.asset;e.isAsset(x)&&(this._sound=e,this._playAfterLoading&&this._sound.play(0))},e.prototype.onLoadComplete=function(t){this._sound||console.warn("[AVM1Sound] - loadSound: Soundloading is complete, but no WaveAudio was created.")},e.prototype.onLoadError=function(t){console.warn("[AVM1Sound] - loadSound: onLoadError")},e.prototype.getBytesLoaded=function(){return console.warn("AVM1Sound.getBytesLoaded"),0},e.prototype.getBytesTotal=function(){return console.warn("AVM1Sound.getBytesTotal"),1},e.prototype.getDuration=function(){return console.warn("AVM1Sound.getDuration"),0},e.prototype.getPan=function(){return console.warn("AVM1Sound.getPan"),0},e.prototype.setPan=function(t){},e.prototype.getTransform=function(){return console.warn("AVM1Sound.getTransform"),null},e.prototype.setTransform=function(t){console.warn("AVM1Sound.setTransform")},e.prototype.getVolume=function(){return this._sound?100*this._sound.volume:(console.warn("AVM1Sound.getVolume called, but no WaveAudio set"),100)},e.prototype.setVolume=function(t){this._sound?(this._target&&this._target.adaptee&&(this._target.adaptee.soundVolume=t/100),this._sound.volume=t/100):console.warn("AVM1Sound.setVolume called, but no WaveAudio set")},e.prototype.start=function(t,e){this._sound&&(e=isNaN(e)||e<1?1:Math.floor(e),this.loopsToPlay=e,this._target&&this._target.adaptee&&this._target.adaptee.startSound(this._linkageID,this._sound,this.loopsToPlay))},e.prototype.stop=function(t){this._sound&&this._target&&this._target.adaptee&&this._target.adaptee.stopSounds(this._linkageID)},e}(Sf),R_=function(){function t(){this._values={},this._realStorage=null}return t.prototype.getItem=function(t){return this._realStorage&&(this._values[t]=this._realStorage.getItem(t)),this._values[t]},t.prototype.setItem=function(t,e){this._realStorage&&this._realStorage.setItem(t,e),this._values[t]=e},t.prototype.removeItem=function(t){this._realStorage&&this._realStorage.removeItem(t),delete this._values[t]},t}();function N_(){if(!B_&&(B_=new R_,"undefined"!=typeof Storage))try{B_._realStorage=window.localStorage}catch(t){console.warn("[Shared Storage] ",t)}return B_}var F_,k_=function(){function t(){}return t.decodedData=function(){var t=N_()._values,e={};for(var i in t)e[i]=JSON.parse(t[i]);return this._lastRawData=e,e},t.encodeAndApplyData=function(){if(!this._lastRawData)throw"Need call decode before encode for detecting a model";var t=N_();for(var e in this._lastRawData)t.setItem(e,JSON.stringify(this._lastRawData[e]));return t._values},t._lastRawData=null,t}(),V_=function(t){function e(e){var i=t.call(this,e)||this;return i._flushPending=0,rg(i,{data:{get:i.getData,enumerable:!0},clear:{value:i.clear,writable:!0},flush:{value:i.flush,writable:!0}}),i._bindedFlush=i.flush.bind(i),i}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,["getLocal"],["data#","flush","clear"])},e.prototype.setName=function(t){if(t=Ym(this.context,t),this._storage_name=t,"undefined"!=typeof Storage){var e=JSON.parse(N_().getItem(t));if(e)return void(this._data=this.getAVM1Value(e))}return this._data=Xm(this.context),console.log("no shared object found"),null},e.getLocal=function(t,i,n,r){(n||r)&&console.warn("SharedObject.getLocal: params 'localPath' and 'secure' not supported");var o=new e(t);return o.setName(i),o},e.prototype.applyDataHook=function(t){var e=this;return t.__alPutHookApplyed||(t.__alPutHookApplyed=!0,t.alPut=function(i,n){Sf.prototype.alPut.call(t,i,n),e.requestFlush()}),t},e.prototype.requestFlush=function(){clearTimeout(this._flushPending),this._flushPending=setTimeout(this._bindedFlush,100)},e.prototype.getData=function(){return this.applyDataHook(this._data)},e.prototype.clear=function(){N_().removeItem(this._storage_name)},e.prototype.getAVM1Value=function(t){if("number"==typeof t||"string"==typeof t||"boolean"==typeof t)return t;if(Array.isArray(t)){for(var e=0;e<t.length;e++)t[e]=this.getAVM1Value(t[e]);return new wm(this.context,t)}if("object"==typeof t){var i=Xm(this.context);for(var n in t)i.alSetOwnProperty(n,new Ef(64,this.getAVM1Value(t[n])));return i}},e.prototype.getJSValue=function(t){if("number"==typeof t||"string"==typeof t||"boolean"==typeof t)return t;if(eg(this.context,t)){console.log("array");var e=t.value,i=[];if(e)for(var n=e.length,r=0;r<n;r++)i[r]=this.getJSValue(e[r]);return i}if(t instanceof Sf){var o={};for(var s in t._ownProperties)"__proto__"!=s&&"__constructor__"!=s&&(o[s]=this.getJSValue(t._ownProperties[s].value));return o}console.log("unknown datatype")},e.prototype.flush=function(t){this._flushPending&&(clearTimeout(this._flushPending),this._flushPending=null);var e=this.getJSValue(this._data);return N_().setItem(this._storage_name,JSON.stringify(e)),!1},e}(Sf),U_=function(){function t(t,e){}return t.prototype.axCallPublicProperty=function(t,e){return null},t.prototype.axGetPublicProperty=function(t){return null},t.prototype.axSetPublicProperty=function(t,e){return null},t.prototype.removeChild=function(t){},Object.defineProperty(t.prototype,"attributes",{get:function(){return console.log("attributes not implemented yet in flash/XMLNode"),null},set:function(t){console.log("attributes not implemented yet in flash/XMLNode")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return console.log("childNodes not implemented yet in flash/XMLNode"),[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localName",{get:function(){return console.log("localName not implemented yet in flash/XMLNode"),""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return console.log("namespaceURI not implemented yet in flash/XMLNode"),""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prefix",{get:function(){return console.log("prefix not implemented yet in flash/XMLNode"),""},enumerable:!0,configurable:!0}),t.prototype.appendChild=function(t){console.log("appendChild not implemented yet in flash/XMLNode")},t.prototype.cloneNode=function(t){return console.log("cloneNode not implemented yet in flash/XMLNode"),null},t.prototype.getNamespaceForPrefix=function(t){return console.log("getNamespaceForPrefix not implemented yet in flash/XMLNode"),""},t.prototype.getPrefixForNamespace=function(t){return console.log("getPrefixForNamespace not implemented yet in flash/XMLNode"),""},t.prototype.hasChildNodes=function(){return console.log("hasChildNodes not implemented yet in flash/XMLNode"),!1},t.prototype.insertBefore=function(t,e){console.log("insertBefore not implemented yet in flash/XMLNode")},t.prototype.removeNode=function(){console.log("removeNode not implemented yet in flash/XMLNode")},t.prototype.toString=function(){return console.log("toString not implemented yet in flash/XMLNode"),""},t}();function j_(t){if(!(t instanceof Sf))return null;var e=t.context;return tg(e,t,e.globals.XMLNode)?t.as3XMLNode:null}function G_(t,e){if(!Xh(e)){var i=e._as2Node;return i||((i=new Sf(t)).alPrototype=t.globals.XMLNode.alGetPrototypeProperty(),X_.prototype.initializeFromAS3Node.call(i,e)),i}}!function(t){t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.TEXT_NODE=3]="TEXT_NODE"}(F_||(F_={}));var Q_=function(t){function e(e){var i=t.call(this,e)||this;return i.alSetOwnPrototypeProperty(new X_(e,i)),i}return i(e,t),e.prototype.alConstruct=function(t){if(!t&&t.length<2)$h.notImplemented("Unsupported amount of parameters for AVM1XMLNode constructor");else{var e=Km(this.context,t[0]),i=Ym(this.context,t[1]);if(e===F_.ELEMENT_NODE||e===F_.TEXT_NODE){var n=new Sf(this.context);return n.alPrototype=this.alGetPrototypeProperty(),X_.prototype.initializeNode.call(n,e,i),n}$h.notImplemented("Unsupported AVM1XMLNode type: "+e)}},e.prototype.alCall=function(t,e){return this.alConstruct(e)},e}(Df),z_=function(t){function e(e,i){var n=t.call(this,e)||this;return n._as3XMLNode=i,n._cachedNodePropertyDescriptor=new Ef(70,void 0),rg(n,{length:{get:n.getLength}}),n}return i(e,t),Object.defineProperty(e.prototype,"as3ChildNodes",{get:function(){return this._as3XMLNode.childNodes},enumerable:!0,configurable:!0}),e.prototype.getLength=function(){return this.as3ChildNodes.length},e.prototype.alGetOwnProperty=function(e){if(Wm(this.context,e)){var i=Gm(this.context,e);if(i>=0&&i<this.as3ChildNodes.length)return this._cachedNodePropertyDescriptor.value=G_(this.context,this.as3ChildNodes[i]),this._cachedNodePropertyDescriptor}return t.prototype.alGetOwnProperty.call(this,e)},e}(Sf),H_=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Object.alGetPrototypeProperty(),n._as3Attributes=i,n._cachedNodePropertyDescriptor=new Ef(64,void 0),n}return i(e,t),e.prototype.alGetOwnProperty=function(t){var e=Ym(this.context,t);if(this._as3Attributes.hasOwnProperty(e))return this._cachedNodePropertyDescriptor.value=this._as3Attributes[e],this._cachedNodePropertyDescriptor},e.prototype.alSetOwnProperty=function(t,e){var i=Ym(this.context,t);if(64&e.flags){var n=Ym(this.context,e.value);this._as3Attributes[i]=n}},e.prototype.alHasOwnProperty=function(t){var e=Ym(this.context,t);return this._as3Attributes.hasOwnProperty(e)},e.prototype.alDeleteOwnProperty=function(t){var e=Ym(this.context,t);delete this._as3Attributes[e]},e.prototype.alGetOwnPropertiesKeys=function(){var t=this;return Object.keys(this._as3Attributes).map((function(e){return Ym(t.context,t._as3Attributes[e].name)}))},e}(Sf),X_=function(t){function e(e,i){var n=t.call(this,e)||this;return rg(n,{constructor:{value:i,writable:!0},attributes:{get:n.getAttributes,set:n.setAttributes},childNodes:{get:n.getChildNodes},firstChild:{get:n.getFirstChild},lastChild:{get:n.getLastChild},localName:{get:n.getLocalName},namespaceURI:{get:n.getNamespaceURI},nextSibling:{get:n.getNextSibling},nodeName:{get:n.getNodeName,set:n.setNodeName},nodeType:{get:n.getNodeType},nodeValue:{get:n.getNodeValue,set:n.setNodeValue},parentNode:{get:n.getParentNode},prefix:{get:n.getPrefix},previousSibling:{get:n.getPreviousSibling},appendChild:{value:n.appendChild},cloneNode:{value:n.cloneNode},getNamespaceForPrefix:{value:n.getNamespaceForPrefix},getPrefixForNamespace:{value:n.getPrefixForNamespace},hasChildNodes:{value:n.hasChildNodes},insertBefore:{value:n.insertBefore},removeNode:{value:n.removeNode},toString:{value:n._toString}}),n}return i(e,t),e.prototype.initializeNode=function(t,i){this.as3XMLNode=new U_(t,i),this._attributes=void 0,this._childNodes=void 0,e.addMap(this.as3XMLNode,this)},e.prototype.initializeFromAS3Node=function(t){this.as3XMLNode=t,this._attributes=void 0,this._childNodes=void 0,e.addMap(this.as3XMLNode,this)},e.prototype._toString=function(){return(new XMLSerializer).serializeToString(this.as3XMLNode).replace(/\/>/g," />")},e.prototype.appendChild=function(t){this.as3XMLNode.appendChild(j_(t))},e.prototype.getAttributes=function(){var t=this.as3XMLNode.attributes;if(!Xh(t))return this._attributes||(this._attributes=new H_(this.context,t)),this._attributes},e.prototype.setAttributes=function(t){var e=this;if(Xh(t))this._attributes=void 0;else if(t instanceof H_)this._attributes=t;else{var i=this.context,n={};Jm(t,(function(t){var r=Ym(i,t),o=Ym(i,e.alGet(t));n[r]=o}),this),this._attributes=new H_(i,n)}},e.prototype.getChildNodes=function(){return this._childNodes||(this._childNodes=new z_(this.context,this.as3XMLNode)),this._childNodes},e.prototype.cloneNode=function(t){t=Um(this.context,t);var e=this.as3XMLNode.axCallPublicProperty("cloneNode",[t]);return G_(this.context,e)},e.prototype.getFirstChild=function(){return G_(this.context,this.as3XMLNode.firstChild)},e.prototype.getNamespaceForPrefix=function(t){return this.as3XMLNode.axCallPublicProperty("getNamespaceForPrefix",[t])},e.prototype.getPrefixForNamespace=function(t){return this.as3XMLNode.axCallPublicProperty("getNamespaceForPrefix",[t])},e.prototype.hasChildNodes=function(){return this.as3XMLNode.hasChildNodes()},e.prototype.insertBefore=function(t,e){this.as3XMLNode.axCallPublicProperty("insertBefore",[j_(t),j_(e)])},e.prototype.getLastChild=function(){return G_(this.context,this.as3XMLNode.lastChild)},e.prototype.getLocalName=function(){return this.as3XMLNode.localName},e.prototype.getNamespaceURI=function(){return this.as3XMLNode.namespaceURI},e.prototype.getNextSibling=function(){return G_(this.context,this.as3XMLNode.nextSibling)},e.prototype.getNodeName=function(){return this.as3XMLNode.nodeName},e.prototype.setNodeName=function(t){t=Ym(this.context,t),this.as3XMLNode.nodeName=t},e.prototype.getNodeType=function(){return this.as3XMLNode.nodeType},e.prototype.getNodeValue=function(){return this.as3XMLNode.nodeValue},e.prototype.setNodeValue=function(t){t=Ym(this.context,t),this.as3XMLNode.nodeValue=t},e.prototype.getParentNode=function(){return G_(this.context,this.as3XMLNode.parentNode)},e.prototype.getPrefix=function(){return this.as3XMLNode.prefix},e.prototype.getPreviousSibling=function(){return G_(this.context,this.as3XMLNode.previousSibling)},e.prototype.removeNode=function(){this.as3XMLNode.removeNode()},e.addMap=function(t,e){t._as2Node=e},e}(Sf),q_=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alSetOwnPrototypeProperty(new Y_(e,n,i)),n}return i(e,t),e.prototype.alConstruct=function(t){var e=t&&Ym(this.context,t[0]),i=new Sf(this.context);return i.alPrototype=this.alGetPrototypeProperty(),i.isAVM1DataObject=!0,e||(e=""),Y_.prototype.initializeDocument.call(i,e),i},e.prototype.alCall=function(t,e){return this.alConstruct(e)},e}(Df),Y_=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.alPrototype=n.alGetPrototypeProperty(),rg(r,{constructor:{value:i,writable:!0},addRequestHeader:{value:r.addRequestHeader},createElement:{value:r.createElement},createTextNode:{value:r.createTextNode},getBytesLoaded:{value:r.getBytesLoaded},getBytesTotal:{value:r.getBytesTotal},ignoreWhite:{value:!1,writable:!0},load:{value:r.load},parseXML:{value:r.parseXML},send:{value:r.send},sendAndLoad:{value:r.sendAndLoad},onData:{value:r.defaultOnData,writable:!0}}),r}return i(e,t),e.prototype.initializeDocument=function(t){t=Ym(this.context,t)||null;var e=(new DOMParser).parseFromString(t,"application/xml");X_.prototype.initializeFromAS3Node.call(this,e),this.as3XMLDocument=e},e.prototype.addRequestHeader=function(t,e){$h.notImplemented("AVM1XMLPrototype.addRequestHeader")},e.prototype.createElement=function(t){t=Ym(this.context,t);var e=this.as3XMLDocument.axCallPublicProperty("createElement",[t]);return G_(this.context,e)},e.prototype.createTextNode=function(t){t=Ym(this.context,t);var e=this.as3XMLDocument.axCallPublicProperty("createTextNode",[t]);return G_(this.context,e)},e.prototype.getBytesLoaded=function(){if(this._as3Loader)return this._as3Loader.bytesLoaded},e.prototype.getBytesTotal=function(){if(this._as3Loader)return this._as3Loader.bytesTotal},e.prototype.load=function(t){return!!(t=Ym(this.context,t))&&(P_(this.context,t,null,0,null,this),!0)},e.prototype.defaultOnData=function(t){Xh(t)?cg(this.context,this,"onLoad",[!1]):(e.prototype.parseXML.call(this,t),this.alPut("loaded",!0),cg(this.context,this,"onLoad",[!0]))},e.prototype.parseXML=function(t){t=Ym(this.context,t);var e=(new DOMParser).parseFromString(t,"application/xml");X_.prototype.initializeFromAS3Node.call(this,e),this.as3XMLDocument=e},e.prototype.send=function(t,e,i){return t=Ym(this.context,t),e=Xh(e)?void 0:Ym(this.context,e),i=Xh(i)?void 0:Ym(this.context,i),$h.notImplemented("AVM1XMLPrototype.send"),!1},e.prototype.sendAndLoad=function(t,e){if((t=Ym(this.context,t))&&e.isAVM1DataObject){$h.somewhatImplemented("AVM1XMLPrototype.send");var i=this.alGet("contentType");i=Xh(i)?void 0:Ym(this.context,i);var n=zm(this.context,this);P_(this.context,t,"POST",0,n,e)}},e}(Sf),K_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,["available#","addCallback","call"],[])},e.getAvailable=function(t){return!0},e.addCallback=function(t,e,i,n){if(e=Ym(t,e),!Zm(n))return!1;try{return window.flashObject||(window.flashObject={}),window.flashObject[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=i.alGet(e.toLowerCase());r&&Zm(r)?r.alCall(i,t):r&&r.value&&r.value.alCall(i,t)},!0}catch(t){console.warn("[AVM1ExternalInterface] - error in addCallback",t)}return!1},e.call=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var r=[],o=i.length,s=0;for(s=0;s<o;s++)r.push(i[s]);1==r.length&&(r=r[0]);try{var a=e.split("."),l=window;for(s=0;s<a.length;s++)l=l[a[s]];l(r);var u="";return u}catch(t){return}},e}(Sf),W_=function(t){function e(e){var i=t.call(this,e)||this;return i.alSetOwnPrototypeProperty(new J_(e,i)),i}return i(e,t),e.prototype.alConstruct=function(t){var e=new Sf(this.context);return e.alPrototype=this.alGetPrototypeProperty(),e},e}(Df),J_=function(t){function e(e,i){var n=t.call(this,e)||this;return rg(n,{constructor:{value:i,writable:!0},clone:{value:n.clone,writable:!0}}),n}return i(e,t),e.prototype.clone=function(){var t=new Sf(this.context);return t.alPrototype=this.alGetPrototypeProperty(),t},e}(Sf);function Z_(t,e,i,n,r){var o=i.alGetPrototypeProperty(),s=Object.create(J_.prototype);Sf.call(s,t),s.alPrototype=o;var a=Object.create(W_.prototype);Df.call(a,t),a.alSetOwnPrototypeProperty(s),a.alConstruct=function(e){var i=new Sf(t);if(i.alPrototype=s,e)for(var n=0;n<e.length;n++)i.alPut(r[n<<1],e[n]);return i},rg(s,{constructor:{value:a,writable:!0},clone:{value:function(){var e=new Sf(t);e.alPrototype=s;for(var i=0;i<r.length;i+=2)e.alPut(r[i],this.alGet(r[i]));return e},writable:!0}}),e.alPut(n,a)}var $_,tm=jc((function(t,e){function i(t,e){var i=[],n=[];return null==e&&(e=function(t,e){return i[0]===e?"[Circular ~]":"[Circular ~."+n.slice(0,i.indexOf(e)).join(".")+"]"}),function(r,o){if(i.length>0){var s=i.indexOf(this);~s?i.splice(s+1):i.push(this),~s?n.splice(s,1/0,r):n.push(r),~i.indexOf(o)&&(o=e.call(this,r,o))}else i.push(o);return null==t?o:t.call(this,r,o)}}(t.exports=function(t,e,n,r){return JSON.stringify(t,i(e,r),n)}).getSerialize=i})),em=(tm.getSerialize,function(){var t=4022871197;return function(e){if(e){e=e.toString();for(var i=0;i<e.length;i++){var n=.02519603282416938*(t+=e.charCodeAt(i));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)}t=4022871197}}),im=function(t){return function(){var e,i,n=48,r=1,o=n,s=new Array(n),a=0,l=new em;for(e=0;e<n;e++)s[e]=l(Math.random());var u=function(){++o>=n&&(o=0);var t=1768863*s[o]+2.3283064365386963e-10*r;return s[o]=t-(r=0|t)},c=function(t){return Math.floor(t*(u()+11102230246251565e-32*(2097152*u()|0)))};c.string=function(t){var e,i="";for(e=0;e<t;e++)i+=String.fromCharCode(33+c(94));return i};var h=function(){var t=Array.prototype.slice.call(arguments);for(e=0;e<t.length;e++)for(i=0;i<n;i++)s[i]-=l(t[e]),s[i]<0&&(s[i]+=1)};return c.cleanString=function(t){return t=(t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[\x00-\x1F]/gi,"")).replace(/\n /,"\n")},c.hashString=function(t){for(t=c.cleanString(t),l(t),e=0;e<t.length;e++)for(a=t.charCodeAt(e),i=0;i<n;i++)s[i]-=l(a),s[i]<0&&(s[i]+=1)},c.seed=function(t){null==t&&(t=Math.random()),"string"!=typeof t&&(t=tm(t,(function(t,e){return"function"==typeof e?e.toString():e}))),c.initState(),c.hashString(t)},c.addEntropy=function(){var t=[];for(e=0;e<arguments.length;e++)t.push(arguments[e]);h(a+++(new Date).getTime()+t.join("")+Math.random())},c.initState=function(){for(l(),e=0;e<n;e++)s[e]=l(" ");r=1,o=n},c.done=function(){l=null},void 0!==t&&c.seed(t),c.range=function(t){return c(t)},c.random=function(){return c(Number.MAX_VALUE-1)/Number.MAX_VALUE},c.floatBetween=function(t,e){return c.random()*(e-t)+t},c.intBetween=function(t,e){return Math.floor(c.random()*(e-t+1))+t},c}()},nm=im.create=function(t){return new im(t)},rm=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.url="",e.targetMC=null,e._queued_focus_value=null,e._queued_focus=!1,e.callbackName="",e.callbackTarget=null,e}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["addListener","getFocus","getBeginIndex","getEndIndex","removeListener","setFocus","setSelection","getCaretIndex"],null,e.prototype.avm1Constructor)},e.prototype.avm1Constructor=function(t,e){this.url=t,this.targetMC=e,this._queued_focus=!1},e.prototype.addListener=function(t){},e.prototype.removeListener=function(t){return!0},e.prototype.getBeginIndex=function(){var t=this.context.globals.Stage.avmStage.mouseManager.getFocus();return t&&t.isAsset(sh)?t.selectionBeginIndex:-1},e.prototype.getEndIndex=function(){var t=this.context.globals.Stage.avmStage.mouseManager.getFocus();return t&&t.isAsset(sh)?t.selectionEndIndex:-1},e.prototype.getCaretIndex=function(){var t=this.context.globals.Stage.avmStage.mouseManager.getFocus();return t&&t.isAsset(sh)?t.selectionBeginIndex:-1},e.prototype.getFocus=function(){var t=this.context.globals.Stage.avmStage.mouseManager.getFocus();if(t){for(var e=[];t;)t.isAVMScene?t=null:(e.push(t.name),t=t.parent);for(var i=e.length,n="";i>0;)n+=e[--i],i>0&&(n+=".");return n}return""},e.prototype.setFocus=function(t){var e;if(""!==t)return"string"==typeof t?(e=this.context.resolveTarget(t))&&e.adaptee||(e=this.context.resolveTarget(t+"_internal_TF"))&&e.adaptee?void this.context.globals.Stage.avmStage.mouseManager.setFocus(e.adaptee):void console.warn("AVM1Selection.setFocus - no object found for string "+t):((e=this.context.resolveTarget(t))&&e.adaptee?this.context.globals.Stage.avmStage.mouseManager.setFocus(e.adaptee):console.warn("AVM1Selection.setFocus - no object found '"+t.toString()+"'"),!0)},e.prototype.setSelection=function(t,e){var i=this.context.globals.Stage.avmStage.mouseManager.getFocus();i&&i.isAsset(sh)&&i.setSelection(t,e)},e}(Sf),om=vh.escape,sm=[],am=function(){function t(){}return t.ALL="all",t.NONE="none",t.IMPORTANT="important",t}(),lm=function(t){function e(e){var i=t.call(this,e)||this;return i.SWF_BASE_URL="",i.registeredLevels={},i.NaN=Number.NaN,i.Infinity=Number.POSITIVE_INFINITY,i.newline="\n",i.undefined=void 0,i._initBuiltins(e),i._initializeFlashObject(e),i.middleMouseButtonFunction=new Df(e),i.middleMouseButtonFunction.alCall=function(t,e){return!1},i}return i(e,t),e.generateRandomSeed=function(){for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",e=10+Math.round(10*Math.random()),i="",n=0;n<e;n++)i+=t[Math.floor(Math.random()*t.length)];return i},e.setRandom=function(t){return void 0===t&&(t=null),t?(t==e.GENERATE_SEED&&(t=e.generateRandomSeed()),e.randomProvider=nm(t),t):(e.randomProvider=null,null)},e.registerCustomClass=function(t,i){e._registeredCustomClasses[t]=i,e.instance&&e.instance.alPut(t,i)},e.registerCustomClassInstance=function(t,i){e._registeredCustomClassInstances[t]=i,e.instance&&e.instance.alPut(t,i)},e.createGlobalsObject=function(t){var i=new e(t);return fg(t,i,i,["flash","ASnative","ASSetPropFlags","BitmapData","clearInterval","clearTimeout","ExternalInterface","escape","unescape","setInterval","setTimeout","showRedrawRegions","trace","updateAfterEvent","myName","NaN","Infinity","isFinite","isNaN","parseFloat","parseInt","undefined","Object","Function","Array","Number","Math","Boolean","Date","Selection","String","Error","MovieClip","AsBroadcaster","System","Stage","Button","TextField","Color","Key","Mouse","MovieClipLoader","newline","XML","XMLNode","LoadVars","Sound","SharedObject","ContextMenu","ContextMenuItem","TextFormat"],!1),e.instance=i,i},e.prototype._getLevelForRoot=function(t){for(var e in this.registeredLevels)if(this.registeredLevels[e]===t)return+e;return-1},e.prototype._getRootForLevel=function(t){return this.registeredLevels[t]},e.prototype._addRoot=function(t,e){return this.registeredLevels[t]?this.registeredLevels[t]:(dg(e,this.context).adaptee,Kf.avmStage.root.addChildAt(e,t),e.adapter!=e&&e.adapter.initAdapter(),this.registeredLevels[t]=e,e)},e.prototype._removeRoot=function(t){this.registeredLevels[t]&&(Kf.avmStage.root.removeChild(this.registeredLevels[t]),delete this.registeredLevels[t])},e.prototype.ASnative=function(t,e){return 800===t&&2===e?this.middleMouseButtonFunction:(console.log("ASnatives",t,e),null)},e.prototype.ASSetPropFlags=function(t,e,i,n){},e.prototype.clearIntervals=function(){var t=0,e=sm.length;for(t=0;t<e;t++)el.clearInterval(sm[t]);sm.length=0},e.prototype.clearInterval=function(t){var e=sm[t-1];e&&(el.clearInterval(e),delete sm[t-1])},e.prototype.clearTimeout=function(t){var e=sm[t-1];e&&(el.clearTimeout(e),delete sm[t-1])},e.prototype.escape=function(t){return encodeURIComponent(t).replace(/!|'|\(|\)|\*|-|\.|_|~/g,(function(t){switch(t){case"*":return"%2A";case"-":return"%2D";case".":return"%2E";case"_":return"%5F";default:return om(t)}}))},e.prototype.unescape=function(t){return decodeURIComponent(t)},e.prototype.setInterval=function(){if(!(arguments.length<2)){var t,e=this.context,i=void 0,n=2;if(Zm(arguments[0]))t=arguments[0].toJSFunction(),i=arguments[1];else{if(arguments.length<3)return;var r=arguments[0],o=arguments[1];if(i=arguments[2],n=3,!(r instanceof Sf)||"string"!=typeof o)return;t=function(){var t=r.alGet(o);if(Zm(t)){var i=Array.prototype.slice.call(arguments,0);e.executeFunction(t,r,i)}}}if(void 0!==i){i=Gm(e,i);var s,a=Array.prototype.slice.call(arguments,n);if(t){var l=function(){t.apply(null,a)};s=el.setInterval(l,i)}return sm.push(s)}}},e.prototype.setTimeout=function(){if(!(arguments.length<2)&&Zm(arguments[0])){for(var t=arguments[0].toJSFunction(),e=Gm(this.context,arguments[1]),i=[],n=arguments.length,r=2;r<n;r++)i.push(arguments[r]);var o=function(){t.apply(null,i)},s=el.setTimeOut(o,e);return sm.push(s)}},e.prototype.showRedrawRegions=function(t,e){},e.prototype.trace=function(t){this&&this.context.actions.trace(t)},e.prototype.updateAfterEvent=function(){},e.prototype.isFinite=function(t){return isFinite(jm(this.context,t))},e.prototype.isNaN=function(t){return" "===t||isNaN(jm(this.context,t))},e.prototype.parseFloat=function(t){return parseFloat(zm(this.context,t))},e.prototype.parseInt=function(t,e){return parseInt(zm(this.context,t),Qm(this.context,e))},e.prototype._initBuiltins=function(t){var i=t.builtins;for(var n in this.Object=i.Object,this.Function=i.Function,this.Array=i.Array,this.Number=i.Number,this.Math=i.Math,this.Boolean=i.Boolean,this.Date=i.Date,this.String=i.String,this.Error=i.Error,this.Selection=rm.createAVM1Class(t)._ownProperties.prototype.value,this.ExternalInterface=K_.createAVM1Class(t),this.MovieClip=g_.createAVM1Class(t),this.AsBroadcaster=A_.createAVM1Class(t),this.System=C_.createAVM1Class(t),this.Stage=Kf.createAVM1Class(t),this.Button=E_.createAVM1Class(t),this.TextField=d_.createAVM1Class(t),this.Color=S_.createAVM1Class(t),this.Key=$f.createAVM1Class(t),this.Mouse=D_.createAVM1Class(t),this.MovieClipLoader=T_.createAVM1Class(t),this.LoadVars=new M_(t),this.Sound=L_.createAVM1Class(t),this.SharedObject=V_.createAVM1Class(t),this.ContextMenu=void 0,this.ContextMenuItem=void 0,this.TextFormat=Zf.createAVM1Class(t),this.XMLNode=new Q_(t),this.XML=new q_(t,this.XMLNode),this.BitmapData=Jf.createAVM1Class(t),this.Matrix=new qf(t),this.Point=new Mf(t),this.Rectangle=new Ff(t),this.Transform=t_.createAVM1Class(t),this.ColorTransform=new Gf(t),A_.initialize(t,this.Stage),A_.initialize(t,this.Key),A_.initialize(t,this.Mouse),e._registeredCustomClasses)this.alPut(n,e._registeredCustomClasses[n]);for(var n in e._registeredCustomClassInstances)this.alPut(n,e._registeredCustomClassInstances[n])},e.prototype._initializeFlashObject=function(t){this.flash=Xm(t);var e=Xm(t);e.alPut("BitmapData",this.BitmapData),this.flash.alPut("display",e);var i=Xm(t);i.alPut("ExternalInterface",K_.createAVM1Class(t)),this.flash.alPut("external",i);var n=function(t){var e=Xm(t),i=new W_(t);return e.alPut("BitmapFilter",i),Z_(t,e,i,"BevelFilter",["distance","Number","angle","Number","highlightColor","Number","highlightAlpha","Number","shadowColor","Number","shadowAlpha","Number","blurX","Number","blurY","Number","strength","Number","quality","Number","type","String","knockout","Boolean"]),Z_(t,e,i,"BlurFilter",["blurX","Number","blurY","Number","quality","Number"]),Z_(t,e,i,"ColorMatrixFilter",["matrix","Numbers"]),Z_(t,e,i,"ConvolutionFilter",["matrixX","Number","matrixY","Number","matrix","Numbers","divisor","Number","bias","Number","preserveAlpha","Boolean","clamp","Boolean","color","Number","alpha","Number"]),Z_(t,e,i,"DisplacementMapFilter",["mapBitmap","BitmapData","mapPoint","Point","componentX","Number","componentY","Number","scaleX","Number","scaleY","Number","mode","String","color","Number","alpha","Number"]),Z_(t,e,i,"DropShadowFilter",["distance","Number","angle","Number","color","Number","alpha","Number","blurX","Number","blurY","Number","strength","Number","quality","Number","inner","Boolean","knockout","Boolean","hideObject","Boolean"]),Z_(t,e,i,"GlowFilter",["color","Number","alpha","Number","blurX","Number","blurY","Number","strength","Number","quality","Number","inner","Boolean","knockout","Boolean"]),Z_(t,e,i,"GradientBevelFilter",["distance","Number","angle","Number","colors","Numbers","alphas","Numbers","ratios","Numbers","blurX","Number","blurY","Number","strength","Number","quality","Number","type","String","knockout","Boolean"]),Z_(t,e,i,"GradientGlowFilter",["distance","Number","angle","Number","colors","Numbers","alphas","Numbers","ratios","Numbers","blurX","Number","blurY","Number","strength","Number","quality","Number","type","String","knockout","Boolean"]),e}(t);this.flash.alPut("filters",n),this.filters=n;var r=Xm(t);r.alPut("ColorTransform",this.ColorTransform),r.alPut("Matrix",this.Matrix),r.alPut("Point",this.Point),r.alPut("Rectangle",this.Rectangle),r.alPut("Transform",this.Transform),this.flash.alPut("geom",r);var o=Xm(t);this.flash.alPut("text",o)},e.swfStartTime=Date.now(),e._registeredCustomClasses={},e._registeredCustomClassInstances={},e.GENERATE_SEED="GENERATE_SEED",e.tracelevel=am.NONE,e.toStringPrecision=-1,e}(Sf),um=function(){function t(t){this.context=t}return t.prototype.asfunction=function(t){},t.prototype.call=function(t){this.context.resolveTarget(null)._callFrame(t)},t.prototype.chr=function(t){return t=Gm(this.context,t),this.context.swfVersion<=5&&(t&=255),t?String.fromCharCode(t):""},t.prototype.duplicateMovieClip=function(t,e,i){var n=Km(this.context,i)-og;this.context.resolveTarget(t).duplicateMovieClip(e,n,null)},t.prototype.fscommand=function(t,e){},t.prototype.getTimer=function(){return Date.now()-lm.swfStartTime},t.prototype.getURL=function(t,e,i){t=String(t),"string"!=typeof e||0!==e.indexOf("_level")?0!==t.toLowerCase().indexOf("fscommand:")?window.open(t,e):console.log("fsCommand not implemented "):this.loadMovieNum(t,+e.substr(6),i)},t.prototype.gotoAndPlay=function(t,e){var i=this.context.resolveTarget(null);i.adaptee.play(),this._gotoFrame(i.adaptee,t,e)},t.prototype.gotoAndStop=function(t,e){var i=this.context.resolveTarget(null);"number"==typeof e&&e<=0||(i.adaptee.stop(),this._gotoFrame(i.adaptee,t,e))},t.prototype._gotoFrame=function(t,e,i){if(Array.isArray(e)){if(0==e.length)return;e=e[0]}if(e instanceof wm){if(!e.value||0==e.value.length)return;e=e.value[0]}if("number"==typeof e&&e%1!=0&&(e=e.toString()),"string"==typeof e){var n=e.toLowerCase();if(null===t.timeline._labels[n])return e=parseInt(e),void(isNaN(e)||(t.currentFrameIndex=e-1));t.jumpToLabel(n,i)}else t.currentFrameIndex=e-1},t.prototype.ifFrameLoaded=function(t,e){var i=this.context.resolveTarget(null),n=arguments.length<2?arguments[0]:arguments[1],r=i.alGet("_framesloaded"),o=i.alGet("_totalframes");return Math.min(n+1,o)<=r},t.prototype.length_=function(t){return(""+t).length},t.prototype.loadMovie=function(t,e,i){if(t&&0===t.toLowerCase().indexOf("fscommand:"))this.fscommand(t.substring("fscommand:".length),e);else if(""===t&&e)e.unloadMovie();else{""!=t&&0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&(t=this.context.globals.SWF_BASE_URL+t);var n,r="string"==typeof e&&0===e.indexOf("_level");if(r){var o=e.substr(6);r=(n=parseInt(o,10)).toString()===o}if(r)this.loadMovieNum(t,n,i);else this.context.resolveTarget(e).loadMovie(t,i)}},t.prototype.loadMovieNum=function(t,e,i){if(t=Ym(this.context,t),e=Gm(this.context,e),i=Ym(this.context,i),t&&0===t.toLowerCase().indexOf("fscommand:"))return this.fscommand(t.substring("fscommand:".length));if(""!=t){var n=this.context.globals._addRoot(e,new il);0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&(t=this.context.globals.SWF_BASE_URL+t),n.adapter.loadMovie(t,i)}else this.context.globals._removeRoot(e)},t.prototype.loadVariables=function(t,e,i){void 0===i&&(i=""),t=Ym(this.context,t),i=Ym(this.context,i);var n=this.context.resolveTarget(e);n&&this._loadVariables(n,t,i)},t.prototype.loadVariablesNum=function(t,e,i){void 0===i&&(i=""),t=Ym(this.context,t),e=Gm(this.context,e),i=Ym(this.context,i);var n=this.context.resolveLevel(e);n&&this._loadVariables(n,t,i)},t.prototype._loadVariables=function(t,e,i){var n=this.context,r=new pt(e);i&&(r.method=i);var o=new st;o.dataFormat="variables";var s=function(e){if(o.removeEventListener(Q.LOAD_COMPLETE,s),o.dataFormat==nt.VARIABLES)for(var i in o.data)n.utils.setProperty(t,i,o.data[i]);t instanceof g_&&cg(n,t,"onData")};o.addEventListener(Q.LOAD_COMPLETE,s),o.load(r)},t.prototype.mbchr=function(t){return(t=Gm(this.context,t))?String.fromCharCode(t):""},t.prototype.mblength=function(t){return(""+t).length},t.prototype.mbord=function(t){return(""+t).charCodeAt(0)},t.prototype.mbsubstring=function(t,e,i){return e!==(0|e)||i!==(0|i)?"":(i<0&&(i=void 0),(""+t).substr(e=e<1?0:e-1,i))},t.prototype.nextFrame=function(){var t=ag(this.context.resolveTarget(null));t.stop(),++t.currentFrameIndex},t.prototype.nextScene=function(){},t.prototype.ord=function(t){return(""+t).charCodeAt(0)},t.prototype.play=function(){this.context.resolveTarget(null).play()},t.prototype.prevFrame=function(){var t=ag(this.context.resolveTarget(null));--t.currentFrameIndex,t.stop()},t.prototype.prevScene=function(){},t.prototype.print=function(t,e){},t.prototype.printAsBitmap=function(t,e){},t.prototype.printAsBitmapNum=function(t,e){},t.prototype.printNum=function(t,e){},t.prototype.random=function(t){return lm.randomProvider?0|lm.randomProvider.random()*(0|t):0|Math.random()*(0|t)},t.prototype.removeMovieClip=function(t){if(t){var e=this.context.resolveTarget(t);e&&e.removeMovieClip()}},t.prototype.startDrag=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.context.resolveTarget(t);n&&n.startDrag.apply(n,e)},t.prototype.stop=function(){this.context.resolveTarget(null).stop()},t.prototype._stopSoundsOnObjectsRecursivly=function(t){if(t._children)for(var e=0;e<t._children.length;e++)t._children[e].isAsset(il)?t._children[e].stopSounds():this._stopSoundsOnObjectsRecursivly(t._children[e])},t.prototype.stopAllSounds=function(){b.stopAllSounds(),this._stopSoundsOnObjectsRecursivly(Kf.avmStage.root)},t.prototype.stopDrag=function(){g_.currentDraggedMC&&g_.currentDraggedMC.stopDrag()},t.prototype.substring=function(t,e,i){return this.mbsubstring(t,e,i)},t.prototype.toggleHighQuality=function(){},t.prototype.trace=function(t){if(lm.tracelevel!=am.NONE){var e,i=!1;switch(typeof t){case"undefined":e="undefined";break;case"string":i=(e=t).length>0&&"!"==e[0];break;default:e=zm(this.context,t)}(lm.tracelevel!=am.IMPORTANT||i)&&console.log("%cAVM1 trace: %c "+e+" ","color: #054996","background: #eee; color: #054996")}},t.prototype.unloadMovie=function(t){var e=this.context.resolveTarget(t);e&&e.unloadMovie()},t.prototype.unloadMovieNum=function(t){0!==(t=Qm(this.context,t))&&this.context.globals._removeRoot(t)},t}(),cm=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype._initializePrototype=function(){rg(this,{constructor:{value:this.context.builtins.Object,writable:!0},valueOf:{value:this._valueOf,writable:!0},toString:{value:this._toString,writable:!0},addProperty:{value:this.addProperty},hasOwnProperty:{value:this.hasOwnProperty},isPropertyEnumerable:{value:this.isPropertyEnumerable},isPrototypeOf:{value:this.isPrototypeOf},unwatch:{value:this.unwatch},watch:{value:this.watch}})},e.prototype._valueOf=function(){return this},e.prototype._toString=function(){return Zm(this)?"[type "+qm(this)+"]":"[object "+qm(this)+"]"},e.prototype.addProperty=function(t,e,i){if("string"!=typeof t||""===t)return!1;if(!Zm(e))return!1;if(!Zm(i)&&null!==i)return!1;var n=this.alGetOwnProperty(t);return!(n&&2&n.flags)&&(this.alSetOwnProperty(t,new Ef(128,null,e,i||void 0)),!0)},e.prototype.hasOwnProperty=function(t){return this.alHasOwnProperty(t)},e.prototype.isPropertyEnumerable=function(t){return!(1&this.alGetProperty(t).flags)},e.prototype.isPrototypeOf=function(t){return tg(this.context,this,t)},e.prototype.unwatch=function(t){return t=Ym(this.context,t),this.alRemotePropertyWatcher(t)},e.prototype.watch=function(t,e,i){return t=Ym(this.context,t),!!Zm(e)&&this.alAddPropertyWatcher(t,e,i)},e}(Sf),hm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Function.alGetPrototypeProperty(),rg(i,{prototype:{value:e.builtins.Object.alGetPrototypeProperty()},registerClass:{value:i.registerClass}}),i}return i(e,t),e.prototype.registerClass=function(t,e){this.context.registerClass(t,e)},e.prototype.alConstruct=function(t){if(t){var e=t[0];if(e instanceof Sf)return e;switch(typeof e){case"string":case"boolean":case"number":return Hm(this.context,e)}}return Xm(this.context)},e.prototype.alCall=function(t,e){return e&&null!==e[0]&&void 0!==e[0]?Hm(this.context,e[0]):Xm(this.context)},e}(Df),pm=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype._initializePrototype=function(){var t=this.context;this.alPrototype=t.builtins.Object.alGetPrototypeProperty(),rg(this,{constructor:{value:t.builtins.Function,writable:!0},call:this.call,apply:this.apply})},e.prototype.call=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=Rm(this,Df);return n.alCall(t,e)},e.prototype.apply=function(t,e){var i=Rm(this,Df),n=e?Rm(e,wm).value:void 0;return i.alCall(t,n)},e}(Sf),dm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Function.alGetPrototypeProperty(),rg(i,{prototype:{value:e.builtins.Function.alGetPrototypeProperty()}}),i}return i(e,t),e.prototype.alConstruct=function(t){return t?t[0]:void 0},e.prototype.alCall=function(t,e){return e?e[0]:void 0},e}(Df),fm=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Boolean.alGetPrototypeProperty(),n.alSetOwnConstructorProperty(e.builtins.Boolean),n.value=i,n}return i(e,t),e.prototype.valueOf=function(){return this.value},e}(Sf),_m=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(i,{constructor:{value:e.builtins.Boolean,writable:!0},valueOf:{value:i._valueOf,writable:!0},toString:{value:i._toString,writable:!0}}),i}return i(e,t),e.prototype._valueOf=function(){return Rm(this,fm).value},e.prototype._toString=function(){return Rm(this,fm).value?"true":"false"},e}(Sf),mm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Function.alGetPrototypeProperty(),rg(i,{prototype:{value:new _m(e)}}),i}return i(e,t),e.prototype.alConstruct=function(t){var e=!!t&&Um(this.context,t[0]);return new fm(this.context,e)},e.prototype.alCall=function(t,e){return!!e&&Um(this.context,e[0])},e}(Df),gm=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Number.alGetPrototypeProperty(),n.alSetOwnConstructorProperty(e.builtins.Number),n.value=i,n}return i(e,t),e.prototype.valueOf=function(){return this.value},e}(Sf),ym=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(i,{constructor:{value:e.builtins.Number,writable:!0},valueOf:{value:i._valueOf,writable:!0},toString:{value:i._toString,writable:!0}}),i}return i(e,t),e.prototype._valueOf=function(){return Rm(this,gm).value},e.prototype._toString=function(t){return Rm(this,gm).value.toString(t||10)},e}(Sf),Am=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Function.alGetPrototypeProperty(),rg(i,{prototype:{value:new ym(e)},MAX_VALUE:Number.MAX_VALUE,MIN_VALUE:Number.MIN_VALUE,NaN:Number.NaN,NEGATIVE_INFINITY:Number.NEGATIVE_INFINITY,POSITIVE_INFINITY:Number.POSITIVE_INFINITY}),i}return i(e,t),e.prototype.alConstruct=function(t){var e=t?jm(this.context,t[0]):0;return new gm(this.context,e)},e.prototype.alCall=function(t,e){return e?jm(this.context,e[0]):0},e}(Df),vm=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.String.alGetPrototypeProperty(),n.alSetOwnConstructorProperty(e.builtins.String),n.value=i,n}return i(e,t),e.prototype.toString=function(){return this.value},e}(Sf),bm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(i,{constructor:{value:e.builtins.String,writable:!0},valueOf:{value:i._valueOf,writable:!0},toString:{value:i._toString,writable:!0},length:{get:i.getLength},charAt:{value:i.charAt,writable:!0},charCodeAt:{value:i.charCodeAt,writable:!0},concat:{value:i.concat,writable:!0},indexOf:{value:i.indexOf,writable:!0},lastIndexOf:{value:i.lastIndexOf,writable:!0},slice:{value:i.slice,writable:!0},split:{value:i.split,writable:!0},substr:{value:i.substr,writable:!0},substring:{value:i.substring,writable:!0},toLowerCase:{value:i.toLowerCase,writable:!0},toUpperCase:{value:i.toUpperCase,writable:!0}}),i}return i(e,t),e.prototype._valueOf=function(){return Rm(this,vm).value},e.prototype._toString=function(){return Rm(this,vm).value},e.prototype.getLength=function(){return Rm(this,vm).value.length},e.prototype.charAt=function(t){return zm(this.context,this).charAt(Gm(this.context,t))},e.prototype.charCodeAt=function(t){return zm(this.context,this).charCodeAt(Gm(this.context,t))},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=[zm(this.context,this)],n=0;n<t.length;++n)i.push(zm(this.context,t[n]));return i.join("")},e.prototype.indexOf=function(t,e){var i=zm(this.context,this);return t=zm(this.context,t),e=Gm(this.context,e),i.indexOf(t,e)},e.prototype.lastIndexOf=function(t,e){var i=zm(this.context,this);return t=zm(this.context,t),(e=arguments.length<2?NaN:jm(this.context,e))<0?-1:i.lastIndexOf(t,isNaN(e)?void 0:e)},e.prototype.slice=function(t,e){if(0!==arguments.length){var i=zm(this.context,this);return t=Gm(this.context,t),e=void 0===e?void 0:Gm(this.context,e),i.slice(t,e)}},e.prototype.split=function(t,e){var i=zm(this.context,this);return void 0!==t?(t=zm(this.context,t),e=(void 0===e?-1:Qm(this.context,e))>>>0,new wm(this.context,i.split(t,e))):new wm(this.context,[i])},e.prototype.substr=function(t,e){var i=zm(this.context,this),n=i.length;if(t=Gm(this.context,t),e=void 0===e?n:Gm(this.context,e),t<0&&(t=Math.max(0,n+t)),e<0){if(-e<=t)return"";e=Math.max(0,n+e)}return i.substr(t,e)},e.prototype.substring=function(t,e){var i=zm(this.context,this);return(t=Gm(this.context,t))>=i.length?"":(e=void 0===e?void 0:Gm(this.context,e),i.substring(t,e))},e.prototype.toLowerCase=function(){return zm(this.context,this).toLowerCase()},e.prototype.toUpperCase=function(){return zm(this.context,this).toUpperCase()},e}(Sf),xm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Function.alGetPrototypeProperty(),rg(i,{prototype:{value:new bm(e)},fromCharCode:{value:i.fromCharCode}}),i}return i(e,t),e.prototype.alConstruct=function(t){var e=t?zm(this.context,t[0]):"";return new vm(this.context,e)},e.prototype.alCall=function(t,e){return e?zm(this.context,e[0]):""},e.prototype.fromCharCode=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return e=e.map((function(e){return 65535&Qm(t.context,e)})),String.fromCharCode.apply(String,e)},e}(Df),Cm=new Ef(64,void 0),wm=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Array.alGetPrototypeProperty(),n.alSetOwnConstructorProperty(e.builtins.Array),n.value=i,n}return i(e,t),e.prototype.alGetOwnProperty=function(e){if(Wm(this.context,e)){var i=Qm(this.context,e);if(Object.getOwnPropertyDescriptor(this.value,i))return Cm.value=this.value[i],Cm}return t.prototype.alGetOwnProperty.call(this,e)},e.prototype.alSetOwnProperty=function(e,i){if(Wm(this.context,e)){var n=Qm(this.context,e);if(!(64&i.flags)||1&i.flags||2&i.flags)throw new Error("Special property is non-supported for array");this.value[n]=i.value}else t.prototype.alSetOwnProperty.call(this,e,i)},e.prototype.alDeleteOwnProperty=function(e){if(Wm(this.context,e)){var i=Qm(this.context,e);delete this.value[i]}else t.prototype.alDeleteOwnProperty.call(this,e)},e.prototype.alGetOwnPropertiesKeys=function(){var e=t.prototype.alGetOwnPropertiesKeys.call(this),i=[];for(var n in this.value)i.push(n);return i.concat(e)},e.mapToJSArray=function(t,i,n){if(t instanceof e)return t.value.map(i,n);if(!ig(t.context,t))throw new Error("Invalid type");var r=[];return ng(t.context,t,(function(t,e){r.push(i.call(n,t,e))})),r},e}(Sf);!function(t){t[t.CASEINSENSITIVE=1]="CASEINSENSITIVE",t[t.DESCENDING=2]="DESCENDING",t[t.UNIQUESORT=4]="UNIQUESORT",t[t.RETURNINDEXEDARRAY=8]="RETURNINDEXEDARRAY",t[t.NUMERIC=16]="NUMERIC"}($_||($_={}));var Im=function(t,e){var i=Rm(t,wm).value;if(Zm(e)){var n=[void 0,void 0];i.sort((function(t,i){return n[0]=t,n[1]=i,e.alCall(null,n)}))}else{var r="number"==typeof e&&(e&$_.NUMERIC||-1==e),o="number"==typeof e&&e&$_.DESCENDING;if(r)i.sort((function(t,e){for(;t instanceof wm;)(t=Rm(t,wm).value)&&t.length>0&&(t=t[0]);for(;e instanceof wm;)(e=Rm(e,wm).value)&&e.length>0&&(e=e[0]);return t-e}));else{for(var s=i.length;s>0;)void 0!==i[--s]&&null!==i[s]||(i[s]="00000000000AwayInternal");for(i.sort((function(t,e){for(;t instanceof wm;)(t=Rm(t,wm).value)&&t.length>0&&(t=t[0]);for(;e instanceof wm;)(e=Rm(e,wm).value)&&e.length>0&&(e=e[0]);return t<e?-1:1})),s=i.length;s>0;)"00000000000AwayInternal"==i[--s]&&(i[s]=void 0)}o&&i.reverse()}return t},Em=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(i,{constructor:{value:e.builtins.Array,writable:!0},join:{value:i.join,writable:!0},length:{get:i.getLength,set:i.setLength},concat:{value:i.concat,writable:!0},pop:{value:i.pop,writable:!0},push:{value:i.push,writable:!0},reverse:{value:i.reverse,writable:!0},shift:{value:i.shift,writable:!0},slice:{value:i.slice,writable:!0},splice:{value:i.splice,writable:!0},sort:{value:i.sort,writable:!0},sortOn:{value:i.sortOn,writable:!0},toString:{value:i._toString,writable:!0},unshift:{value:i.unshift,writable:!0}}),i}return i(e,t),e.prototype._toString=function(){var t,e=this.alGet("length"),i=0,n="";for(i=0;i<e;i++)n+=void 0!==(t=this.alGet(i))?zm(this.context,t)+(i==e-1?"":","):i==e-1?"":",";return n},e.prototype.getLength=function(){return Rm(this,wm).value.length},e.prototype.setLength=function(t){(null===t&&(t=0),Hh(t))&&(t=Qm(this.context,t)>>>0,Rm(this,wm).value.length=t)},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this instanceof wm){for(var i=Rm(this,wm).value,n=0;n<t.length;n++)t[n]instanceof wm&&(t[n]=Rm(t[n],wm).value);return new wm(this.context,Array.prototype.concat.apply(i,t))}for(var r=[],o=this,s=ig(this.context,this),a=0;s?ng(this.context,o,(function(t){return r.push(t)})):r.push(zm(this.context,o)),!(a>=t.length);)o=t[a++],s=eg(this.context,o);return new wm(this.context,r)},e.prototype.join=function(t){if(t=void 0===t?",":Ym(this.context,t),this instanceof wm){var e=Rm(this,wm).value;if(0===e.length)return"";if(e.every((function(t){return!(t instanceof Sf)})))return e.join(t)}var i=this.context,n=Qm(i,this.alGet("length"))>>>0;if(0===n)return"";for(var r=[],o=0;o<n;o++){var s=this.alGet(o);r[o]=null==s?"":Ym(i,s)}return r.join(t)},e.prototype.pop=function(){if(this instanceof wm)return Rm(this,wm).value.pop();var t=Qm(this.context,this.alGet("length"))>>>0;if(0!==t){var e=t-1,i=this.alGet(e);return this.alDeleteProperty(e),this.alPut("length",e),i}},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this instanceof wm){var i=Rm(this,wm).value;return Array.prototype.push.apply(i,t)}for(var n=Qm(this.context,this.alGet("length"))>>>0,r=0;r<t.length;r++)this.alPut(n,t[r]),n++;return this.alPut("length",n),n},e.prototype.reverse=function(){var t=[],e=this.alGet("length"),i=0;for(i=0;i<e;i++)t[i]=this.alGet(i);for(i=e-1;i>=0;)this.alPut(e-1-i,t[i]),i--;return this.value},e.prototype.shift=function(){if(this instanceof wm)return Rm(this,wm).value.shift();var t=Qm(this.context,this.alGet("length"))>>>0;if(0!==t){for(var e=this.alGet(0),i=1;i<t;i++)this.alHasProperty(i)?this.alPut(i-1,this.alGet(i)):this.alDeleteProperty(i-1);return this.alDeleteProperty(t-1),this.alPut("length",t-1),e}},e.prototype.slice=function(t,e){if(t=Gm(this.context,t),e=void 0!==e?Gm(this.context,e):void 0,this instanceof wm){var i=Rm(this,wm).value;return new wm(this.context,i.slice(t,e))}var n=[],r=Qm(this.context,this.alGet("length"))>>>0;t=t<0?Math.max(r+t,0):Math.min(r,t),e=void 0===e?r:e<0?Math.max(r+e,0):Math.min(r,e);for(var o=t,s=0;o<e;o++,s++)this.alHasProperty(o)&&(n[s]=this.alGet(o));return new wm(this.context,n)},e.prototype.splice=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];t=Gm(this.context,t);var r=Qm(this.context,this.alGet("length"))>>>0;if(t=t<0?Math.max(r+t,0):Math.min(r,t),e=e||"number"==typeof e?Gm(this.context,e):r-t,this instanceof wm){var o=Rm(this,wm).value;return new wm(this.context,Array.prototype.splice.apply(o,[t,e].concat(i)))}for(var s=[],a=0;a<e;a++)this.alHasProperty(t+a)&&(s[a]=this.alGet(t+a));var l=i.length-e;if(l<0){for(a=t-l;a<r;a++)this.alHasProperty(a)?this.alPut(a+l,this.alGet(a)):this.alDeleteProperty(a+l);for(a=l;a<0;a++)this.alDeleteProperty(r+a)}else if(l>0)for(a=r-1;a>=t+l;a--)this.alHasProperty(a)?this.alPut(a+l,this.alGet(a)):this.alDeleteProperty(a+l);for(a=0;a<i.length;a++)this.alPut(t+a,i[a]);return this.alPut("length",r+l),new wm(this.context,s)},e.prototype.sort=function(t){return Im(this,t)},e.prototype.sortOn=function(t,e){var i=this.context,n=[],r=[];if("string"==typeof t)n=[zm(i,t)],r=[Qm(i,e)];else{if(!eg(i,t))return Im(this,e);n=[],r=[];var o=eg(i,e)?e:null,s=Gm(i,t.alGet("length"));o&&s!==Gm(i,o.alGet("length"))&&(o=null);for(var a=0;a<s;a++)n.push(zm(i,t.alGet(a))),r.push(o?Qm(i,o.alGet(a)):0)}r[0];return Rm(this,wm).value.sort((function(t,e){for(;t instanceof wm;)(t=Rm(t,wm).value)&&t.length>0&&(t=t[0]);for(;e instanceof wm;)(e=Rm(e,wm).value)&&e.length>0&&(e=e[0]);for(var o=Hm(i,t),s=Hm(i,e),a=0;a<n.length;a++){var l=o.alGet(n[a]),u=s.alGet(n[a]),c=void 0;if(r[a]&$_.NUMERIC){var h=jm(i,l),p=jm(i,u);c=h<p?-1:h>p?1:0}else{var d=zm(i,l),f=zm(i,u);r[a]&$_.CASEINSENSITIVE&&(d=d.toLowerCase(),f=f.toLowerCase()),c=d<f?-1:d>f?1:0}if(0!==c)return r[a]&$_.DESCENDING?-c:c}return 0})),this},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this instanceof wm){var i=Rm(this,wm).value;return Array.prototype.unshift.apply(i,t)}for(var n=Qm(this.context,this.alGet("length"))>>>0,r=t.length,o=n-1;o>=0;o--)this.alHasProperty(o)?this.alPut(o+r,this.alGet(o)):this.alDeleteProperty(o+r);for(o=0;o<t.length;o++)this.alPut(o,t[o]);return n+=r,this.alPut("length",n),n},e}(Sf),Sm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Function.alGetPrototypeProperty(),rg(i,{prototype:{value:new Em(e)}}),rg(i,{NUMERIC:{value:$_.NUMERIC}}),rg(i,{DESCENDING:{value:$_.DESCENDING}}),i}return i(e,t),e.prototype.alConstruct=function(t){if(!t)return new wm(this.context,[]);if(1===t.length&&"number"==typeof t[0]){var e=t[0];if(e>>>0!==e)throw new Error("Range error");return new wm(this.context,new Array(e))}return new wm(this.context,t)},e.prototype.alCall=function(t,e){return this.alConstruct.apply(this,e)},e}(Df),Dm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(i,{E:Math.E,LN10:Math.LN10,LN2:Math.LN2,LOG10E:Math.LOG10E,LOG2E:Math.LOG2E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,abs:i.abs,acos:i.acos,asin:i.asin,atan:i.atan,atan2:i.atan2,ceil:i.ceil,cos:i.cos,exp:i.exp,floor:i.floor,log:i.log,max:i.max,min:i.min,pow:i.pow,random:i.random,round:i.round,sin:i.sin,sqrt:i.sqrt,tan:i.tan}),i}return i(e,t),e.prototype.abs=function(t){return Math.abs(jm(this.context,t))},e.prototype.acos=function(t){return Math.acos(jm(this.context,t))},e.prototype.asin=function(t){return Math.asin(jm(this.context,t))},e.prototype.atan=function(t){return Math.atan(jm(this.context,t))},e.prototype.atan2=function(t,e){return Math.atan2(jm(this.context,t),jm(this.context,e))},e.prototype.ceil=function(t){return Math.ceil(jm(this.context,t))},e.prototype.cos=function(t){return Math.cos(jm(this.context,t))},e.prototype.exp=function(t){return Math.exp(jm(this.context,t))},e.prototype.floor=function(t){return Math.floor(jm(this.context,t))},e.prototype.log=function(t){return Math.log(jm(this.context,t))},e.prototype.max=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return e=e.map((function(e){return jm(t.context,e)})),Math.max.apply(null,e)},e.prototype.min=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return e=e.map((function(e){return jm(t.context,e)})),Math.min.apply(null,e)},e.prototype.pow=function(t,e){return Math.pow(jm(this.context,t),jm(this.context,e))},e.prototype.random=function(){return lm.randomProvider?lm.randomProvider.random():Math.random()},e.prototype.round=function(t){return Math.round(jm(this.context,t))},e.prototype.sin=function(t){return Math.sin(jm(this.context,t))},e.prototype.sqrt=function(t){return Math.sqrt(jm(this.context,t))},e.prototype.tan=function(t){return Math.tan(jm(this.context,t))},e}(Sf),Tm=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Date.alGetPrototypeProperty(),n.alSetOwnConstructorProperty(e.builtins.Date),n.value=i,n}return i(e,t),e.prototype.alDefaultValue=function(e){return void 0!==e?t.prototype.alDefaultValue.call(this,e):this.context.swfVersion>=6?t.prototype.alDefaultValue.call(this,1):t.prototype.alDefaultValue.call(this,0)},e}(Sf),Pm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(i,{constructor:{value:e.builtins.Date,writable:!0},valueOf:{value:i._valueOf,writable:!0},toString:{value:i._toString,writable:!0},toLocaleString:{value:i._toLocaleString,writable:!0},toDateString:{value:i.toDateString,writable:!0},toTimeString:{value:i.toTimeString,writable:!0},toLocaleDateString:{value:i.toLocaleDateString,writable:!0},toLocaleTimeString:{value:i.toLocaleTimeString,writable:!0},getTime:{value:i.getTime,writable:!0},getFullYear:{value:i.getFullYear,writable:!0},getUTCFullYear:{value:i.getUTCFullYear,writable:!0},getMonth:{value:i.getMonth,writable:!0},getUTCMonth:{value:i.getUTCMonth,writable:!0},getDate:{value:i.getDate,writable:!0},getUTCDate:{value:i.getUTCDate,writable:!0},getDay:{value:i.getDay,writable:!0},getUTCDay:{value:i.getUTCDay,writable:!0},getHours:{value:i.getHours,writable:!0},getUTCHours:{value:i.getUTCHours,writable:!0},getMinutes:{value:i.getMinutes,writable:!0},getUTCMinutes:{value:i.getUTCMinutes,writable:!0},getSeconds:{value:i.getSeconds,writable:!0},getUTCSeconds:{value:i.getUTCSeconds,writable:!0},getMilliseconds:{value:i.getMilliseconds,writable:!0},getUTCMilliseconds:{value:i.getUTCMilliseconds,writable:!0},getTimezoneOffset:{value:i.getTimezoneOffset,writable:!0},setTime:{value:i.setTime,writable:!0},setMilliseconds:{value:i.setMilliseconds,writable:!0},setUTCMilliseconds:{value:i.setUTCMilliseconds,writable:!0},setSeconds:{value:i.setSeconds,writable:!0},setUTCSeconds:{value:i.setUTCSeconds,writable:!0},setMinutes:{value:i.setMinutes,writable:!0},setUTCMinutes:{value:i.setUTCMinutes,writable:!0},setHours:{value:i.setHours,writable:!0},setUTCHours:{value:i.setUTCHours,writable:!0},setDate:{value:i.setDate,writable:!0},setUTCDate:{value:i.setUTCDate,writable:!0},setMonth:{value:i.setMonth,writable:!0},setUTCMonth:{value:i.setUTCMonth,writable:!0},setFullYear:{value:i.setFullYear,writable:!0},setUTCFullYear:{value:i.setUTCFullYear,writable:!0},toUTCString:{value:i.toUTCString,writable:!0}}),i}return i(e,t),e.prototype._valueOf=function(){return Rm(this,Tm).value.valueOf()},e.prototype._toString=function(){return Rm(this,Tm).value.toString()},e.prototype._toLocaleString=function(){return Rm(this,Tm).value.toLocaleString()},e.prototype.toDateString=function(){return Rm(this,Tm).value.toDateString()},e.prototype.toTimeString=function(){return Rm(this,Tm).value.toTimeString()},e.prototype.toLocaleDateString=function(){return Rm(this,Tm).value.toLocaleDateString()},e.prototype.toLocaleTimeString=function(){return Rm(this,Tm).value.toLocaleTimeString()},e.prototype.getTime=function(){return Rm(this,Tm).value.getTime()},e.prototype.getFullYear=function(){return Rm(this,Tm).value.getFullYear()},e.prototype.getUTCFullYear=function(){return Rm(this,Tm).value.getUTCFullYear()},e.prototype.getMonth=function(){return Rm(this,Tm).value.getMonth()},e.prototype.getUTCMonth=function(){return Rm(this,Tm).value.getUTCMonth()},e.prototype.getDate=function(){return Rm(this,Tm).value.getDate()},e.prototype.getUTCDate=function(){return Rm(this,Tm).value.getUTCDate()},e.prototype.getDay=function(){return Rm(this,Tm).value.getDay()},e.prototype.getUTCDay=function(){return Rm(this,Tm).value.getUTCDay()},e.prototype.getHours=function(){return Rm(this,Tm).value.getHours()},e.prototype.getUTCHours=function(){return Rm(this,Tm).value.getUTCHours()},e.prototype.getMinutes=function(){return Rm(this,Tm).value.getMinutes()},e.prototype.getUTCMinutes=function(){return Rm(this,Tm).value.getUTCMinutes()},e.prototype.getSeconds=function(){return Rm(this,Tm).value.getSeconds()},e.prototype.getUTCSeconds=function(){return Rm(this,Tm).value.getUTCSeconds()},e.prototype.getMilliseconds=function(){return Rm(this,Tm).value.getMilliseconds()},e.prototype.getUTCMilliseconds=function(){return Rm(this,Tm).value.getUTCMilliseconds()},e.prototype.getTimezoneOffset=function(){return Rm(this,Tm).value.getTimezoneOffset()},e.prototype.setTime=function(t){return t=jm(this.context,t),Rm(this,Tm).value.setTime(t)},e.prototype.setMilliseconds=function(t){return t=jm(this.context,t),Rm(this,Tm).value.setMilliseconds(t)},e.prototype.setUTCMilliseconds=function(t){return t=jm(this.context,t),Rm(this,Tm).value.setUTCMilliseconds(t)},e.prototype.setSeconds=function(t,e){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setSeconds(t):(e=jm(this.context,e),Rm(this,Tm).value.setSeconds(t,e))},e.prototype.setUTCSeconds=function(t,e){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setUTCSeconds(t):(e=jm(this.context,e),Rm(this,Tm).value.setUTCSeconds(t,e))},e.prototype.setMinutes=function(t,e,i){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setMinutes(t):(e=jm(this.context,e),arguments.length<=2?Rm(this,Tm).value.setMinutes(t,e):(i=jm(this.context,i),Rm(this,Tm).value.setMinutes(t,e,i)))},e.prototype.setUTCMinutes=function(t,e,i){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setUTCMinutes(t):(e=jm(this.context,e),arguments.length<=2?Rm(this,Tm).value.setUTCMinutes(t,e):(i=jm(this.context,i),Rm(this,Tm).value.setUTCMinutes(t,e,i)))},e.prototype.setHours=function(t,e,i,n){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setHours(t):(e=jm(this.context,e),arguments.length<=2?Rm(this,Tm).value.setHours(t,e):(i=jm(this.context,i),arguments.length<=3?Rm(this,Tm).value.setHours(t,e,i):(n=jm(this.context,n),Rm(this,Tm).value.setHours(t,e,i,n))))},e.prototype.setUTCHours=function(t,e,i,n){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setUTCHours(t):(e=jm(this.context,e),arguments.length<=2?Rm(this,Tm).value.setUTCHours(t,e):(i=jm(this.context,i),arguments.length<=3?Rm(this,Tm).value.setUTCHours(t,e,i):(n=jm(this.context,n),Rm(this,Tm).value.setUTCHours(t,e,i,n))))},e.prototype.setDate=function(t){return t=jm(this.context,t),Rm(this,Tm).value.setDate(t)},e.prototype.setUTCDate=function(t){return t=jm(this.context,t),Rm(this,Tm).value.setUTCDate(t)},e.prototype.setMonth=function(t,e){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setMonth(t):(e=jm(this.context,e),Rm(this,Tm).value.setMonth(t,e))},e.prototype.setUTCMonth=function(t,e){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setUTCMonth(t):(e=jm(this.context,e),Rm(this,Tm).value.setUTCMonth(t,e))},e.prototype.setFullYear=function(t,e,i){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setFullYear(t):(e=jm(this.context,e),arguments.length<=2?Rm(this,Tm).value.setFullYear(t,e):(i=jm(this.context,i),Rm(this,Tm).value.setFullYear(t,e,i)))},e.prototype.setUTCFullYear=function(t,e,i){return t=jm(this.context,t),arguments.length<=1?Rm(this,Tm).value.setUTCFullYear(t):(e=jm(this.context,e),arguments.length<=2?Rm(this,Tm).value.setUTCFullYear(t,e):(i=jm(this.context,i),Rm(this,Tm).value.setUTCFullYear(t,e,i)))},e.prototype.toUTCString=function(){return Rm(this,Tm).value.toUTCString()},e}(Sf),Bm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Function.alGetPrototypeProperty(),rg(i,{prototype:{value:new Pm(e)},UTC:{value:i._UTC,writable:!0}}),i}return i(e,t),e.prototype.alConstruct=function(t){var e,i=this.context;switch(t.length){case 0:e=new Date;break;case 1:e=new Date(Vm(i,t[0]));break;default:for(var n=[],r=0;r<t.length;r++)n.push(jm(i,t[r]));e=new Date(jm(i,t[0]),jm(i,t[1]),t.length>2?jm(i,t[2]):1,t.length>3?jm(i,t[3]):0,t.length>4?jm(i,t[4]):0,t.length>5?jm(i,t[5]):0,t.length>6?jm(i,t[6]):0)}return new Tm(i,e)},e.prototype.alCall=function(t,e){return $m(this.alConstruct.apply(this,e),"toString")},e.prototype._UTC=function(t,e,i,n,r,o){var s=this.context;return Date.UTC(jm(s,arguments[0]),jm(s,arguments[1]),arguments.length>2?jm(s,arguments[2]):1,arguments.length>3?jm(s,arguments[3]):0,arguments.length>4?jm(s,arguments[4]):0,arguments.length>5?jm(s,arguments[5]):0,arguments.length>6?jm(s,arguments[6]):0)},e}(Df),Mm=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alPrototype=e.builtins.Error.alGetPrototypeProperty(),n.alSetOwnConstructorProperty(e.builtins.Error),void 0!==i&&n.alPut("message",i),n}return i(e,t),e}(Sf),Om=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Object.alGetPrototypeProperty(),rg(i,{constructor:{value:e.builtins.Error,writable:!0},name:{value:"Error",writable:!0},message:{value:"Error",writable:!0},toString:{value:i._toString,writable:!0}}),i}return i(e,t),e.prototype._toString=function(){return this.alGet("message")},e}(Sf),Lm=function(t){function e(e){var i=t.call(this,e)||this;return i.alPrototype=e.builtins.Function.alGetPrototypeProperty(),rg(i,{prototype:{value:new Om(e)}}),i}return i(e,t),e.prototype.alConstruct=function(t){var e=t&&void 0!==t[0]?Ym(this.context,t[0]):void 0;return new Mm(this.context,e)},e.prototype.alCall=function(t,e){var i=e&&void 0!==e[0]?Ym(this.context,e[0]):void 0;return new Mm(this.context,i)},e}(Df);function Rm(t,e){if(t instanceof e)return t;throw new Error("Invalid type")}var Nm=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r._fn=i,n&&(r._ctor=n),r}return i(e,t),e.prototype.alConstruct=function(t){if(!this._ctor)throw new Error("not a constructor");return this._ctor.apply(this,t)},e.prototype.alCall=function(t,e){if(!this._fn)throw new Error("not callable");return this._fn.apply(t,e)},e}(Df),Fm=function(t){function e(e){var i=t.call(this,e)||this,n=new Sf(e);return n.alPrototype=e.builtins.Object.alGetPrototypeProperty(),n.alSetOwnProperty("constructor",new Ef(67)),i.alSetOwnPrototypeProperty(n),i}return i(e,t),e.prototype.alConstruct=function(t){var e=new Sf(this.context),i=this.alGetPrototypeProperty();i instanceof Sf||(i=this.context.builtins.Object.alGetPrototypeProperty()),e.alPrototype=i,e.alSetOwnConstructorProperty(this);var n=this.alCall(e,t);return n instanceof Sf?n:e},e}(Df);function km(t){}function Vm(t,e,i){var n=typeof e;if("string"===n||"number"===n||"undefined"===n)return e;if(!(e instanceof Sf))return e;var r=e;return void 0!==i?r.alDefaultValue(i):r.alDefaultValue()}function Um(t,e){var i=t.swfVersion>=7;switch(typeof e){case"undefined":return!1;case"object":return null!==e;case"boolean":return e;case"string":return i?!!e:!isNaN(+e)&&0!=+e;case"number":return!!e}}function jm(t,e){switch("object"==typeof e&&null!==e&&(e=Vm(0,e,0)),typeof e){case"undefined":return t.swfVersion>=7?NaN:0;case"object":return null===e?t.swfVersion>=7?NaN:0:void 0!==e.nodeValue?parseFloat(e.nodeValue):t.swfVersion>=5?NaN:0;case"boolean":return e?1:0;case"number":return e;case"string":return""===e&&t.swfVersion<5?0:""===e?NaN:+e}}function Gm(t,e){var i=jm(t,e);return isNaN(i)?0:0===i||i===Number.POSITIVE_INFINITY||i===Number.NEGATIVE_INFINITY?i:i<0?Math.ceil(i):Math.floor(i)}function Qm(t,e){return 0|jm(t,e)}function zm(t,e){switch("object"==typeof e&&null!==e&&(e=Vm(0,e,1)),typeof e){case"undefined":return t.swfVersion>=7?"undefined":"";case"object":if(null===e)return"null";if(e&&e instanceof Array){for(var i="",n=0;n<e.length;n++)i+=zm(t,e[n]),i+=n===e.length-1?"":",";return i}return"[type "+qm(e)+"]";case"boolean":return e?"true":"false";case"number":if((0|e)===e)return""+e;if(isFinite(e)){var r=Math.floor(Math.log10(Math.abs(+e)));if(Math.abs(r)<14){var o=Math.pow(10,14-r);e=Math.round(e*o)/o}}return""+e;case"string":return e}}function Hm(t,e){switch(typeof e){case"undefined":throw new km;case"object":if(null===e)throw new km;return Array.isArray(e)?new wm(t,e):e;case"boolean":return new fm(t,e);case"number":return new gm(t,e);case"string":return new vm(t,e)}}function Xm(t){var e=new Sf(t);return e.alPrototype=t.builtins.Object.alGetPrototypeProperty(),e.alSetOwnConstructorProperty(t.builtins.Object),e}function qm(t){return t instanceof Df?"Function":"Object"}function Ym(t,e){return e instanceof Sf?zm(t,e):"string"==typeof e?e:null==e?null:e+""}function Km(t,e){if(!Xh(e))return jm(t,e)}function Wm(t,e){return Hh(e instanceof Sf?zm(t,e):e)}function Jm(t,e,i){t.alGetKeys().forEach(e,i)}function Zm(t){return t instanceof Df}function $m(t,e,i){t.alGet(e).alCall(t,i)}function tg(t,e,i){if(!(e instanceof Sf))return!1;if(!(i instanceof Sf))return!1;for(var n=i.alGetPrototypeProperty(),r=e;r;r=r.alPrototype)if(r===n)return!0;return!1}function eg(t,e){return tg(0,e,t.builtins.Array)}function ig(t,e){if(!(e instanceof Sf))return!1;var i=Gm(t,e.alGet("length"));return!(isNaN(i)||i<0||i>=4294967296)}function ng(t,e,i,n){void 0===n&&(n=null);var r=Gm(t,e.alGet("length"));if(!(isNaN(r)||r>=4294967296))for(var o=0;o<r;o++)i.call(n,e.alGet(o),o)}function rg(t,e){var i=t.context;Object.getOwnPropertyNames(e).forEach((function(n){var r,o,s,a=e[n],l=0;"object"==typeof a?(a.get||a.set?(o=a.get?new Nm(i,a.get):void 0,s=a.set?new Nm(i,a.set):void 0,l|=128):("function"==typeof(r=a.value)&&(r=new Nm(i,r)),l|=64,a.writable||(l|=4)),a.enumerable||(l|=1),a.configurable||(l|=2)):("function"==typeof(r=a)&&(r=new Nm(i,r)),l|=71),t.alSetOwnProperty(n,new Ef(l,r,o,s))}))}km.prototype=Object.create(Error.prototype);var og=16384;function sg(t){return!!t.adaptee}function ag(t){return t.adaptee}function lg(t){if(t.adaptee)return t.adaptee;if(!t._as3ObjectTemplate){for(var e=void 0,i=t.alPrototype;i&&!i.initAVM1SymbolInstance&&!(e=i._as3ObjectTemplate);)i=i.alPrototype;t._as3ObjectTemplate=Object.create(e||null)}return t._as3ObjectTemplate}var ug=[void 0,"normal","layer","multiply","screen","lighten","darken","difference","add","subtract","invert","alpha","erase","overlay","hardlight"];function cg(t,e,i,n){void 0===n&&(n=null);var r=e.alGet(i);r instanceof Df&&r.alCall(e,n);var o=e.alGet("_listeners");if(o instanceof wm){var s=null;o.value.forEach((function(t){t instanceof Sf&&(s=t.alGet(i))instanceof Df&&s.alCall(t,n)}))}}var hg=0;function pg(t,e,i){for(var n,r=t.alGetPrototypeProperty();r&&!r.initAVM1SymbolInstance;)r._as3ObjectTemplate&&!n&&(n=r._as3ObjectTemplate),r=r.alPrototype;var o=Object.create(r);if(r.initAVM1SymbolInstance.call(o,i,e),o.alPrototype=t.alGetPrototypeProperty(),o.alSetOwnConstructorProperty(t),e._as2Object=o,t.alCall(o),o.aCount=hg++,n)for(var s in n)e[s]=n[s];return o}function dg(t,e){return t?t._as2Object?t._as2Object:(t.isAsset(il)?i=t.timeline.isButton?pg(e.globals.Button,t,e):pg(e.globals.MovieClip,t,e):t.isAsset(sh)&&(i=pg(e.globals.TextField,t,e)),i&&(t._as2Object=i,t.adapter=i,i.adaptee=t),t._as2Object=i,i):null;var i}function fg(t,e,i,n,r){function o(e){if(!Xh(e))return new Nm(t,r?function(){var i=Array.prototype.slice.call(arguments,0);return i.unshift(t),e.apply(this,i)}:e)}void 0===r&&(r=!1),n&&n.forEach((function(t){if("#"!==t[t.length-1]){var n=function(t){for(var e,n=i;n;n=Object.getPrototypeOf(n))if(e=Object.getOwnPropertyDescriptor(n,t))return e;return null}(t);if(n&&!n.get&&!n.set){var r=n.value;"function"==typeof r&&(r=o(r));var s=new Ef(67,r);e.alSetOwnProperty(t,s)}}else{var a="get"+t[0].toUpperCase()+t.slice(1,-1),l=i[a],u="set"+t[0].toUpperCase()+t.slice(1,-1),c=i[u],h=new Ef(131,null,o(l),o(c));e.alSetOwnProperty(t.slice(0,-1),h)}}))}function _g(t,e,i,n,r,o,s){var a=e?new Nm(t,o||function(){},(function(){var e=new i(t);return e.alPrototype=l,e.alSetOwnConstructorProperty(a),s&&s.apply(e,arguments),e})):new Sf(t);fg(t,a,i,n,!0);var l=new i(t);return l.alPrototype=t.builtins.Object.alGetPrototypeProperty(),fg(t,l,i.prototype,r,!1),rg(a,{prototype:{value:l}}),rg(l,{constructor:{value:a,writable:!0}}),a}function mg(t){var e=t<0?-1:1;t=Math.abs(t);var i=Math.floor(20*t)/20;return t>i&&t-i>.04&&(i+=.05,i=Math.round(20*i)/20),i*e}function gg(t){return Math.round(20*t)/20}function yg(t){return t+1}function Ag(t){return t-1}function vg(t,e){return e.context.executeActions(t,e)}var bg,xg=function(t){function e(i){var n=t.call(this)||this;return n.imageStore={},n.avm1Context=i,e._instance=n,n}return i(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||console.log("Error. A instance of AVM1SceneGraphFactory must be created manually \t\t\t\tbefore accessing the singleton AVM1SceneGraphFactory._instance"),e._instance},enumerable:!0,configurable:!0}),e.prototype.createSprite=function(t){return new ka},e.prototype.createDisplayObjectContainer=function(){return new Fa},e.prototype.createMovieClip=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new il(t||new ja);return dg(i,this.avm1Context),i._symbol=e,i},e.prototype.createTextField=function(){var t=new sh;return t.multiline=!0,t.wordWrap=!0,dg(t,this.avm1Context),t},e.prototype.createBillboard=function(t){return null},e.prototype.createImage2D=function(t,e,i,n,r){return void 0===i&&(i=!0),void 0===n&&(n=null),void 0===r&&(r=!0),new hn(t,e,i,n,r)},e.prototype.createFrameScripts=function(t,e,i,n){i=i.replace(/[^\w]/g,"");for(var r=[],o=0;o<t.length;o++){var s=t[o];s.data=this.avm1Context.actionsDataFactory.createActionsData(s,"script_"+name+"_"+n+"_frame_"+e+"_idx_"+o),r[r.length]=s}return r.length&&r.sort(this.compareAVM1FrameScripts),r},e.prototype.compareAVM1FrameScripts=function(t,e){if(!t.precedence)return e.precedence?-1:0;if(!e.precedence)return 1;for(var i=0;i<t.precedence.length&&i<e.precedence.length&&t.precedence[i]===e.precedence[i];)i++;return i>=t.precedence.length?t.precedence.length===e.precedence.length?0:-1:i>=e.precedence.length?1:t.precedence[i]-e.precedence[i]},e}(ah),Cg=Zh.register(new Wh("AVM1")),wg=Cg.register(new Jh("t1","traceAvm1","boolean",!1,"trace AVM1 execution")),Ig=Cg.register(new Jh("e1","errorsAvm1","boolean",!1,"fail on AVM1 warnings and errors")),Eg=Cg.register(new Jh("w1","warningsAvm1","boolean",!0,"Emit messages for AVM1 warnings and errors")),Sg=Cg.register(new Jh("ha1","nohangAvm1","boolean",!1,"disable fail on AVM1 hang")),Dg=Cg.register(new Jh("ca1","compileAvm1","boolean",!0,"compiles AVM1 code")),Tg=Cg.register(new Jh("da1","debugAvm1","boolean",!1,"allows AVM1 code debugging")),Pg=(Cg.register(new Jh("cw1","wellknownAvm1","boolean",!0,"Replaces well-known actions patterns instead of compilation")),function(t,e,i,n){void 0===i&&(i=null),this.bytes=t,this.id=e,this.parent=i,this.encryptedData=n,this.debugPath=this.id,this.ir=null,this.compiled=null}),Bg=function(){function t(){this._cache=new WeakMap}return t.prototype.createActionsData=function(t,e,i){void 0===i&&(i=null);var n=t instanceof Uint8Array,r=n?t:t.actionsData,o=n?void 0:t.encryptedData,s=this._cache.get(r);return s||(s=new Pg(r,e,i,o),this._cache.set(r,s)),s},t}(),Mg=function(){function t(t){this.swfVersion=t,this.globals=null,this.actionsDataFactory=new Bg,t>6?(this.isPropertyCaseSensitive=!0,this.normalizeName=this.normalizeNameCaseSensitive):(this.isPropertyCaseSensitive=!1,this._nameCache=Object.create(null),this.normalizeName=this.normalizeNameCaseInsensitive),this.builtins={},function(t){var e=t.builtins,i=new cm(t),n=new Sf(t);n.alSetOwnPrototypeProperty(i),e.Object=n;var r=new pm(t),o=new Sf(t);o.alSetOwnPrototypeProperty(r),e.Function=o,i._initializePrototype(),r._initializePrototype(),e.Object=new hm(t),e.Function=new dm(t),e.Boolean=new mm(t),e.Number=new Am(t),e.String=new xm(t),e.Array=new Sm(t),e.Date=new Bm(t),e.Math=new Dm(t),e.Error=new Lm(t)}(this),this.eventObservers=Object.create(null),this.assets={},this.assetsSymbols=[],this.assetsClasses=[],this.awayAssets={},this.staticStates=new WeakMap}return t.prototype.resolveTarget=function(t){},t.prototype.resolveRoot=function(){},t.prototype.checkTimeout=function(){},t.prototype.executeActions=function(t,e){},t.prototype.executeFunction=function(t,e,i){},t.prototype.normalizeNameCaseSensitive=function(t){switch(typeof t){case"number":case"string":return t;default:return zm(this,t)}},t.prototype.normalizeNameCaseInsensitive=function(t){switch(typeof t){case"number":return t.toString();case"string":break;default:t=zm(this,t)}var e=this._nameCache[t];return e||(e=t.toLowerCase(),this._nameCache[t]=e,e)},t.prototype._getEventPropertyObservers=function(t,e){this.isPropertyCaseSensitive||(t=t.toLowerCase());var i=this.eventObservers[t];return i||(e?(i=[],this.eventObservers[t]=i,i):null)},t.prototype.registerEventPropertyObserver=function(t,e){this._getEventPropertyObservers(t,!0).push(e)},t.prototype.unregisterEventPropertyObserver=function(t,e){var i=this._getEventPropertyObservers(t,!1);if(i){var n=i.indexOf(e);n<0||i.splice(n,1)}},t.prototype.broadcastEventPropertyChange=function(t){var e=this._getEventPropertyObservers(t,!1);e&&e.forEach((function(e){return e.onEventPropertyModified(t)}))},t.prototype.addAsset=function(t,e,i){this.assets[t.toLowerCase()]=e,this.assetsSymbols[e]=i,this.awayAssets[t.toLowerCase()]=i},t.prototype.registerClass=function(t,e){if(null!==(t=Ym(this,t))){var i=ht.getAsset(t,g_.currentMCAssetNameSpace);i&&i.adaptee?i.adaptee.avm1Symbol=e:console.warn("can not find symbol to register class "+t)}else this.utils.warn("Cannot register class for symbol: className is missing")},t.prototype.getSymbolClass=function(t){return this.assetsClasses[t]||null},t.prototype.getAsset=function(t){if(null!==(t=Ym(this,t))){var e=this.assets[t.toLowerCase()];if(void 0!==e){var i=this.awayAssets[t.toLowerCase()];return i||console.log("error in getAsset. not implemented to grab assets from loaderInfo"),{symbolId:e,symbolProps:i}}}},t.prototype.reset=function(){this.eventObservers=Object.create(null),this.assets={},this.assetsSymbols=[],this.assetsClasses=[],this.awayAssets={},this.staticStates=new WeakMap,Kf.bindStage(this,this.globals.Stage,null,null,null)},t.prototype.setStage=function(t,e,i){$f.bindStage(this,this.globals.Key,t,i),D_.bindStage(this,this.globals.Mouse,t,i),Kf.bindStage(this,this.globals.Stage,t,e,i)},t.prototype.getStaticState=function(t){var e=this.staticStates.get(t);if(!e){e=Object.create(null);var i=t.alInitStatic;i&&i.call(e,this),this.staticStates.set(t,e)}return e},t.prototype.resolveLevel=function(t){var e=this.globals._getRootForLevel(t);if(e)return dg(e,this);this.utils.warn("Unable to resolve level "+t+" root")},t}(),Og=function(){function t(){this.parentResults=null,this.registersLimit=0}return t.prototype.analyze=function(t){for(var e,i,n,r,o,s,a,l,u=[],c=[0],h=[!0],p=!1,d=null,f=[0];f.length>0;)if(e=f.shift(),!u[e])for(t.position=e;!t.eof&&!u[e]&&0!==(i=t.readNext()).actionCode;){switch(r={action:i,next:n=t.position,conditionalJumpTo:-1},o=0,s=!1,a=!1,i.actionCode){case 138:case 141:s=!0,l=138===i.actionCode?i.args[1]:i.args[0],t.skip(l),o=t.position,t.position=n;break;case 153:a=!0,s=!0,o=n+i.args[0];break;case 157:s=!0,o=n+i.args[0];break;case 42:case 62:case 0:a=!0,s=!0,o=t.length;break;case 136:if(p){d=null;break}p=!0,0===e&&(d=i.args[0])}if(s&&(a?r.next=o:r.conditionalJumpTo=o,h[o]||(c.push(o),f.push(o),h[o]=!0)),u[e]=r,a)break;e=n}var _,m,g=[];c.forEach((function(t){if(u[t]){var e;_=[],m=t;do{e=u[m],_.push(e),m=e.next}while(!h[m]&&u[m]);g.push({label:t,items:_,jump:m})}}));var y=null;return p?y=d:this.parentResults&&(y=this.parentResults.singleConstantPool),{actions:u,blocks:g,dataId:t.dataId,singleConstantPool:y,registersLimit:this.registersLimit}},t}(),Lg=function(){function t(t,e){this.array=t,this.position=0,this.end=t.length,this.readANSI=e<6;var i=new ArrayBuffer(4);if(new Int32Array(i)[0]=1,!new Uint8Array(i)[0])throw new Error("big-endian platform")}return t.prototype.readUI8=function(){return this.array[this.position++]},t.prototype.readUI16=function(){var t=this.position,e=this.array,i=e[t+1]<<8|e[t];return this.position=t+2,i},t.prototype.readSI16=function(){var t=this.position,e=this.array,i=e[t+1]<<8|e[t];return this.position=t+2,i<32768?i:i-65536},t.prototype.readInteger=function(){var t=this.position,e=this.array,i=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24;return this.position=t+4,i},t.prototype.readFloat=function(){var t=this.position,e=this.array,i=new ArrayBuffer(4),n=new Uint8Array(i);return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],this.position=t+4,new Float32Array(i)[0]},t.prototype.readDouble=function(){var t=this.position,e=this.array,i=new ArrayBuffer(8),n=new Uint8Array(i);return n[4]=e[t],n[5]=e[t+1],n[6]=e[t+2],n[7]=e[t+3],n[0]=e[t+4],n[1]=e[t+5],n[2]=e[t+6],n[3]=e[t+7],this.position=t+8,new Float64Array(i)[0]},t.prototype.readBoolean=function(){return!!this.readUI8()},t.prototype.readANSIString=function(){for(var t,e="";t=this.readUI8();)e+=String.fromCharCode(t);return e},t.prototype.readUTF8String=function(){for(var t,e="";t=this.readUI8();)if(t<128)e+=String.fromCharCode(t);else if(128!=(192&t)){var i=this.position-1,n=192,r=5;do{var o=n>>1|128;if((t&o)===n)break;n=o,--r}while(r>=0);for(var s=t&(1<<r)-1,a=5;a>=r;--a)if(128==(192&(t=this.readUI8())))s=s<<6|63&t;else{var l=this.position-1;for(this.position=i;this.position<l;)e+=String.fromCharCode(this.readUI8())}e+=s>=65536?String.fromCharCode(s-65536>>10&1023|55296,1023&s|56320):String.fromCharCode(s)}else e+=String.fromCharCode(t);return e},t.prototype.readString=function(){return this.readANSI?this.readANSIString():this.readUTF8String()},t.prototype.readBytes=function(t){var e=this.position,i=Math.max(this.end-e,0);i<t&&(t=i);var n=this.array.subarray(e,e+t);return this.position=e+t,n},t}(),Rg=/[^A-Za-z0-9_]+/g,Ng=function(t){this.registerNumber=t},Fg=function(t){this.constantIndex=t},kg=function(){function t(t,e){this.swfVersion=e,this._lastPushedValue=null,this._lastDefinedConstantPool=null,this._initialPosition=0,this._initialLen=0,this._actionsData=t,this.dataId=t.id;var i=t.bytes,n=new Uint8Array(i.buffer,0);this._initialPosition=i.byteOffset,this._initialLen=i.length,this._stream=new Lg(n,e),this._stream.position=this._initialPosition}return Object.defineProperty(t.prototype,"position",{get:function(){return this._stream.position-this._initialPosition},set:function(t){this._stream.position=t+this._initialPosition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eof",{get:function(){return this.position>=this._initialLen},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._initialLen},enumerable:!0,configurable:!0}),t.prototype.readNext=function(){var t=this._stream,e=t.position,i=t.readUI8(),n=i>=128?t.readUI16():0,r=t.position+n,o=null;switch(155!==i&&142!==i&&(this._lastPushedValue=null),0|i){case 129:var s=t.readUI16(),a=!1;6!==(l=t.readUI8())&&7!==l?t.position--:(r++,a=6===l),o=[s,a];break;case 131:o=[t.readString(),t.readString()];break;case 138:o=[s=t.readUI16(),p=t.readUI8()];break;case 139:o=[t.readString()];break;case 140:var l,u=t.readString();a=!1;6!==(l=t.readUI8())&&7!==l?t.position--:(r++,a=6===l),o=[u,a];break;case 150:var c,h;for(o=[];t.position<r;){switch(0|(c=t.readUI8())){case 0:h=t.readString(),this._lastPushedValue=h;break;case 1:h=t.readFloat();break;case 2:h=null;break;case 3:h=void 0;break;case 4:h=new Ng(t.readUI8());break;case 5:h=t.readBoolean();break;case 6:h=t.readDouble();break;case 7:h=t.readInteger();break;case 8:h=new Fg(t.readUI8());break;case 9:h=new Fg(t.readUI16());break;default:console.error("Unknown value type: "+c,t.position),t.position=r;continue}this._lastPushedValue=h,o.push(h)}break;case 153:case 157:o=[t.readSI16()];break;case 154:o=[A=t.readUI8()];break;case 159:o=[A=t.readUI8()],2&A&&o.push(t.readUI16());break;case 141:o=[p=t.readUI8()];break;case 136:for(var p=t.readUI16(),d=[],f=0;f<p;f++)d.push(t.readString());this._lastDefinedConstantPool=d,o=[d];break;case 155:var _=t.readString(),m=(p=t.readUI16(),[]);for(f=0;f<p;f++)m.push(t.readString());r+=w=t.readUI16(),o=[E=new Pg(t.readBytes(w),this.dataId+"_f"+t.position,this._actionsData),_,m];break;case 148:r+=w=t.readUI16(),o=[new Pg(t.readBytes(w),this.dataId+"_w"+t.position,this._actionsData)];break;case 135:o=[b=t.readUI8()];break;case 142:var g=null;this._lastPushedValue instanceof Fg&&this._lastDefinedConstantPool&&(g=this._lastDefinedConstantPool[this._lastPushedValue.constantIndex]),"string"==typeof this._lastPushedValue&&(g=this._lastPushedValue),g&&Rg.test(g)&&(g=null);_=t.readString(),p=t.readUI16();var y=t.readUI8(),A=t.readUI16(),v=[];for(m=[],f=0;f<p;f++){var b=t.readUI8(),x=t.readString();m.push(x),b&&(v[b]={type:1,name:x,index:f})}var C=1;1&A&&(v[C++]={type:2}),4&A&&(v[C++]={type:4}),16&A&&(v[C++]={type:8}),64&A&&(v[C++]={type:64}),128&A&&(v[C++]={type:32}),256&A&&(v[C++]={type:16});var w,I=0;2&A&&(I|=2),8&A&&(I|=4),32&A&&(I|=8),r+=w=t.readUI16();var E,S=this.dataId+"_f"+t.position;g&&(S=g+"__"+S),(E=new Pg(t.readBytes(w),S,this._actionsData)).debugPath=this.dataId+"/"+(g||"f"+t.position),o=[E,_,m,y,v,I];break;case 143:var D=!!(4&(A=t.readUI8())),T=!!(2&A),P=!!(1&A),B=t.readUI16(),M=t.readUI16(),O=t.readUI16(),L=D?t.readUI8():t.readString();r+=B+M+O;var R=this._actionsData.debugPath,N=new Pg(t.readBytes(B),this.dataId+"_t"+t.position,this._actionsData);R&&(N.debugPath=R+"/try_"+this._stream.position);var F=new Pg(t.readBytes(M),this.dataId+"_c"+t.position,this._actionsData);R&&(F.debugPath=R+"/catch_"+this._stream.position);var k=new Pg(t.readBytes(O),this.dataId+"_z"+t.position,this._actionsData);R&&(k.debugPath=R+"/finaly_"+this._stream.position),o=[D,L,N,P,F,T,k];break;case 137:o=[t.readUI8()]}return t.position=r,{position:e-this._initialPosition,actionCode:i,actionName:Vg[i],knownAction:!!Vg[i],args:o}},t.prototype.skip=function(t){for(var e=this._stream;t>0&&this.position<this._initialLen;){var i=e.readUI8()>=128?e.readUI16():0;e.position+=i,t--}},t}(),Vg={0:"EOA",4:"ActionNextFrame",5:"ActionPreviousFrame",6:"ActionPlay",7:"ActionStop",8:"ActionToggleQuality",9:"ActionStopSounds",10:"ActionAdd",11:"ActionSubtract",12:"ActionMultiply",13:"ActionDivide",14:"ActionEquals",15:"ActionLess",16:"ActionAnd",17:"ActionOr",18:"ActionNot",19:"ActionStringEquals",20:"ActionStringLength",21:"ActionStringExtract",23:"ActionPop",24:"ActionToInteger",28:"ActionGetVariable",29:"ActionSetVariable",32:"ActionSetTarget2",33:"ActionStringAdd",34:"ActionGetProperty",35:"ActionSetProperty",36:"ActionCloneSprite",37:"ActionRemoveSprite",38:"ActionTrace",39:"ActionStartDrag",40:"ActionEndDrag",41:"ActionStringLess",42:"ActionThrow",43:"ActionCastOp",44:"ActionImplementsOp",45:"ActionFSCommand2",48:"ActionRandomNumber",49:"ActionMBStringLength",50:"ActionCharToAscii",51:"ActionAsciiToChar",52:"ActionGetTime",53:"ActionMBStringExtract",54:"ActionMBCharToAscii",55:"ActionMBAsciiToChar",58:"ActionDelete",59:"ActionDelete2",60:"ActionDefineLocal",61:"ActionCallFunction",62:"ActionReturn",63:"ActionModulo",64:"ActionNewObject",65:"ActionDefineLocal2",66:"ActionInitArray",67:"ActionInitObject",68:"ActionTypeOf",69:"ActionTargetPath",70:"ActionEnumerate",71:"ActionAdd2",72:"ActionLess2",73:"ActionEquals2",74:"ActionToNumber",75:"ActionToString",76:"ActionPushDuplicate",77:"ActionStackSwap",78:"ActionGetMember",79:"ActionSetMember",80:"ActionIncrement",81:"ActionDecrement",82:"ActionCallMethod",83:"ActionNewMethod",84:"ActionInstanceOf",85:"ActionEnumerate2",96:"ActionBitAnd",97:"ActionBitOr",98:"ActionBitXor",99:"ActionBitLShift",100:"ActionBitRShift",101:"ActionBitURShift",102:"ActionStrictEquals",103:"ActionGreater",104:"ActionStringGreater",105:"ActionExtends",129:"ActionGotoFrame",131:"ActionGetURL",135:"ActionStoreRegister",136:"ActionConstantPool",137:"ActionStrictMode",138:"ActionWaitForFrame",139:"ActionSetTarget",140:"ActionGoToLabel",141:"ActionWaitForFrame2",142:"ActionDefineFunction2",143:"ActionTry",148:"ActionWith",150:"ActionPush",153:"ActionJump",154:"ActionGetURL2",155:"ActionDefineFunction",157:"ActionIf",158:"ActionCall",159:"ActionGotoFrame2"},Ug=/[^A-Za-z0-9_/]+/g,jg=null;function Gg(){return jg||(jg={ActionGotoFrame:Dy,ActionGetURL:Ty,ActionNextFrame:Py,ActionPreviousFrame:By,ActionPlay:My,ActionStop:Oy,ActionToggleQuality:Ly,ActionStopSounds:Ry,ActionWaitForFrame:Ny,ActionSetTarget:Fy,ActionGoToLabel:ky,ActionPush:Vy,ActionPop:Uy,ActionAdd:jy,ActionSubtract:Gy,ActionMultiply:Qy,ActionDivide:zy,ActionEquals:Hy,ActionLess:Xy,ActionAnd:qy,ActionOr:Yy,ActionNot:Ky,ActionStringEquals:Wy,ActionStringLength:Jy,ActionMBStringLength:Zy,ActionStringAdd:$y,ActionStringExtract:tA,ActionMBStringExtract:eA,ActionStringLess:iA,ActionToInteger:nA,ActionCharToAscii:rA,ActionMBCharToAscii:oA,ActionAsciiToChar:sA,ActionMBAsciiToChar:aA,ActionJump:lA,ActionIf:uA,ActionCall:cA,ActionGetVariable:hA,ActionSetVariable:pA,ActionGetURL2:dA,ActionGotoFrame2:fA,ActionSetTarget2:_A,ActionGetProperty:mA,ActionSetProperty:gA,ActionCloneSprite:yA,ActionRemoveSprite:AA,ActionStartDrag:vA,ActionEndDrag:bA,ActionWaitForFrame2:xA,ActionTrace:CA,ActionGetTime:wA,ActionRandomNumber:IA,ActionCallFunction:EA,ActionCallMethod:SA,ActionConstantPool:TA,ActionDefineFunction:PA,ActionDefineLocal:BA,ActionDefineLocal2:MA,ActionDelete:OA,ActionDelete2:LA,ActionEnumerate:RA,ActionEquals2:NA,ActionGetMember:FA,ActionInitArray:kA,ActionInitObject:VA,ActionNewMethod:UA,ActionNewObject:jA,ActionSetMember:GA,ActionTargetPath:QA,ActionWith:zA,ActionToNumber:HA,ActionToString:XA,ActionTypeOf:qA,ActionAdd2:YA,ActionLess2:KA,ActionModulo:WA,ActionBitAnd:JA,ActionBitLShift:ZA,ActionBitOr:$A,ActionBitRShift:tv,ActionBitURShift:ev,ActionBitXor:iv,ActionDecrement:nv,ActionIncrement:rv,ActionPushDuplicate:ov,ActionReturn:sv,ActionStackSwap:av,ActionStoreRegister:lv,ActionInstanceOf:uv,ActionEnumerate2:cv,ActionStrictEquals:hv,ActionGreater:pv,ActionStringGreater:dv,ActionDefineFunction2:fv,ActionExtends:_v,ActionCastOp:mv,ActionImplementsOp:gv,ActionTry:yv,ActionThrow:Av,ActionFSCommand2:vv,ActionStrictMode:bv}),jg}var Qg=function(t){void 0===t&&(t=!1),this.inlinePop=t},zg=((bg={})[78]={AllowReturnValue:!0,AllowStackToArgs:!0,AllowCallapsDouble:!0,ArgsCount:2},bg[79]={AllowStackToArgs:!0,ArgsCount:3},bg[71]={AllowStackToArgs:!0,AllowReturnValue:!0,PlainArgs:!0,ArgsCount:2},bg[103]={AllowStackToArgs:!0,AllowReturnValue:!0,ArgsCount:2},bg),Hg=function(){function t(){}return t.prototype.convertArgs=function(t,e,i,n){for(var r,o,s,a,l,u,c=[],h=t.length,p=0;p<h;p++)"object"!=typeof(r=t[p])||null===r||Array.isArray(r)?void 0===r?c.push("undefined"):c.push(JSON.stringify(r)):r instanceof Fg?n.singleConstantPool?(o=n.singleConstantPool[r.constantIndex],c.push(void 0===o?"undefined":JSON.stringify(o))):(s="",(a=i.constantPool)&&(s=(s=void 0===(o=a[r.constantIndex])?"undefined":JSON.stringify(o)).indexOf("*/")>=0?"":" /* "+s+" */"),c.push("constantPool["+r.constantIndex+"]"+s)):r instanceof Ng?(l=r.registerNumber)<0||l>=n.registersLimit?c.push("undefined"):c.push("registers["+l+"]"):r instanceof Pg?(i[u="code_"+e+"_"+p]=r,c.push("res."+u)):r instanceof Qg&&r.inlinePop&&c.push("stack.pop()");return c.join(",")},t.prototype.convertAction=function(t,e,i,n,r,o,s){var a,l,u=o[n-1],c=t.flags,h="";if((null===(a=c)||void 0===a?void 0:a.optimised)&&(h="  /* "+t.action.actionName+" optimised */\n"),null===(l=c)||void 0===l?void 0:l.killed)return"  /* "+t.action.actionName+" killed by optimiser */\n";if(!t.action.knownAction)return"  // unknown actionCode "+t.action.actionCode+" at "+t.action.position+"\n";switch(t.action.actionCode){case 153:case 62:return"";case 136:return i.constantPool=t.action.args[0],s.forward["constPool"+e]="["+this.convertArgs(t.action.args[0],e,i,r)+"]","  constantPool = ectx.constantPool = constPool"+e+";\n";case 150:return h+"  stack.push("+this.convertArgs(t.action.args,e,i,r)+");\n";case 135:var p=t.action.args[0];return p<0||p>=r.registersLimit?"":"  registers["+p+"] = stack[stack.length - 1];\n";case 138:case 141:var d=this.convertArgs(t.action.args,e,i,r);return"  if (calls."+t.action.actionName+"(ectx,["+d+"])) { position = "+t.conditionalJumpTo+"; checkTimeAfter -= "+(n+1)+"; break; }\n";case 157:return"  if (!!stack.pop()) { position = "+t.conditionalJumpTo+"; checkTimeAfter -= "+(n+1)+"; break; }\n";default:if((d=t.action.args?this.convertArgs(t.action.args,e,i,r):"")&&!c.PlainArgs&&(d="["+d+"]"),142===t.action.actionCode){var f="defFunArgs"+e;s.forward[f]=d,d=f}if(h+="  calls."+t.action.actionName+"(ectx"+(d?", "+d:"")+");\n","ActionCallMethod"==t.action.actionName&&(u||(h="// strange oppcode at "+t.action.position+"\n"+h),u&&150==u.action.actionCode)){var _=this.convertArgs(u.action.args,e-1,i,r);'"gotoAndStop"'!=_&&'"gotoAndPlay"'!=_||(h+="  if(ectx.scopeList && ectx.scopeList.scope && ectx.scopeList.scope.adaptee && !ectx.scopeList.scope.adaptee.parent){ ectx.framescriptmanager.execute_avm1_constructors(); return;}\n")}return h}},t.prototype.inlineStackOpt=function(t,e,i){if(!i.length)return!1;var n=e[t],r=n.flags,o=n.action.actionCode,s=e[i[0]];i.length=0;var a=zg[o];if(!a||!a.AllowStackToArgs)return!1;r.PlainArgs=a.PlainArgs;var l=s.action.args;if(l.length===a.ArgsCount)s.flags.killed=!0,n.action.args=l;else if(l.length>a.ArgsCount){var u=l.length-a.ArgsCount;n.action.args=l.slice(u),l.length=u,s.flags.optimised=!0}else{var c=a.ArgsCount-l.length;if(c>1)return!1;s.flags.killed=!0,n.action.args=l.slice();for(var h=0;h<c;h++)n.action.args.unshift(new Qg(!0))}return r.optimised=!0,!0},t.prototype.optimiser=function(t){for(var e,i,n=t.items,r=[],o=!0,s=0,a=n.length;s<a;s++){var l=n[s],u=l.action.actionCode;if(l.flags=l.flags||{},150!==u){if(r.length>1)for(var c=r[0],h=r[r.length-1],p=n[c].action,d=c+1;d<=h;d++)p.args=p.args.concat(n[d].action.args),n[d].flags.killed=!0;o=!!o&&this.inlineStackOpt(s,n,r),r.length=0}switch(u){case 150:r.push(s),o=!0;break;case 78:var f=l.action.args;if(!(null===(e=f)||void 0===e?void 0:e.length))break;var _=f[0];if(!(_ instanceof Qg&&_.inlinePop))break;for(var m=s-1;m>=0&&n[m].flags.killed;m--);if(m>=0){var g=n[m],y=g.action.args;if(78===g.action.actionCode&&(null===(i=y)||void 0===i?void 0:i.length)){g.flags.killed=!0,l.flags.optimised=!0,f.shift();for(var A=y.length-1;A>=0;A--)f.unshift(y[A])}}}}},t.prototype.generate=function(t,e){var i=this;void 0===e&&(e=null);var n=t.blocks,r={},o={forward:{},back:{}},s=t.dataId.replace(Ug,"_"),a="return function "+s+"(ectx) {\nvar position = 0;\nvar checkTimeAfter = 0;\nvar constantPool = ectx.constantPool, registers = ectx.registers, stack = ectx.stack;\n",l="",u="";Tg.value&&(u+="/* Running "+s+" */ if (Shumway.AVM1.Debugger.pause || Shumway.AVM1.Debugger.breakpoints."+s+") { debugger; }\n"),u+="while (!ectx.isEndOfActions) {\nif (checkTimeAfter <= 0) { checkTimeAfter = "+Yg+"; ectx.context.checkTimeout(); }\n\nswitch(position) {\n";var c=0;for(var h in n.forEach((function(e){u+=" case "+e.label+":\n",i.optimiser(e);var n=e.items.map((function(n,s){return i.convertAction(n,c++,r,s,t,e.items,o)}));u+=n.join(""),u+="  position = "+e.jump+";\n  checkTimeAfter -= "+e.items.length+";\n  break;\n"})),u+=" default: ectx.isEndOfActions = true; break;\n}\n}\nreturn stack.pop();};",l+="\n// hoisted vars\n",o.forward)l+="var "+h+" = "+o.forward[h]+";\n";u=(l+="\n")+a+u,u+="//# sourceURL=http://jit/"+(e&&!Ug.test(e)?e:s);try{return new Function("calls","res",u)(Gg(),r)}catch(t){throw t}},t}();function Xg(t,e,i,n,r){if(Ig.value)try{throw new Error(t)}catch(t){}Eg.value&&$h.warning.apply(console,arguments)}var qg,Yg=1e3;!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.TARGET=1]="TARGET",t[t.REPLACE_TARGET=2]="REPLACE_TARGET"}(qg||(qg={}));var Kg=function(t,e){this.scope=t,this.previousScopeItem=e,this.flags=qg.DEFAULT},Wg=function(t){function e(e,i){var n=t.call(this,e)||this;return n.alSetOwnProperty("this",new Ef(71,i)),n.alSetOwnProperty("_global",new Ef(71,e.globals)),n}return i(e,t),e}(Sf),Jg=function(){function t(t,e,i,n,r){this.previousFrame=t,this.currentThis=e,this.fn=i,this.args=n,this.ectx=r,this.inSequence=!!t&&(t.calleeThis===e&&t.calleeFn===i),this.resetCallee()}return t.prototype.setCallee=function(t,e,i,n){this.calleeThis=t,this.calleeSuper=e,this.calleeFn=i},t.prototype.resetCallee=function(){this.calleeThis=null,this.calleeSuper=null,this.calleeFn=null},t}(),Zg=function(){function t(t){this._context=t}return t.prototype.hasProperty=function(t,e){return function(t,e,i){var n=Hm(t,e);return i=t.normalizeName(i),n.alHasProperty(i)}(this._context,t,e)},t.prototype.getProperty=function(t,e){return ry(this._context,t,e)},t.prototype.setProperty=function(t,e,i){return oy(this._context,t,e,i)},t.prototype.warn=function(t){Xg.apply(null,arguments)},t}(),$g=function(t){function e(e){var i=t.call(this,e)||this;return i.globals=lm.createGlobalsObject(i),i.actions=new um(i),i.initialScope=new Kg(i.globals,null),i.utils=new Zg(i),i.isActive=!1,i.executionProhibited=!1,i.actionTracer=wg.value?new wv:null,i.abortExecutionAt=0,i.stackDepth=0,i.frame=null,i.isTryCatchListening=!1,i.errorsIgnored=0,i.deferScriptExecution=!0,i}return i(e,t),e.prototype._getExecutionContext=function(){return this.frame.ectx},e.prototype.resolveTarget=function(t){return Ey(this._getExecutionContext(),t,!0)},e.prototype.resolveRoot=function(){return Sy(this._getExecutionContext())},e.prototype.checkTimeout=function(){Date.now(),this.abortExecutionAt},e.prototype.pushCallFrame=function(t,e,i,n){var r=new Jg(this.frame,t,e,i,n);return this.frame=r,r},e.prototype.popCallFrame=function(){var t=this.frame.previousFrame;return this.frame=t,t},e.prototype.executeActions=function(t,e){if(!this.executionProhibited){var i,n=this.isActive;n||(this.isActive=!0,this.abortExecutionAt=Sg.value?Number.MAX_VALUE:Date.now()+1e3,this.errorsIgnored=0);try{!function(t,e,i){t.actionTracer;var n,r=new Kg(new Wg(t,i),t.initialScope),o=new Kg(i,r);o.flags|=qg.TARGET;var s=fy.create(t,o,[],4);t.pushCallFrame(i,null,null,s);try{Cv(s,e)}catch(t){n=ly(t)}s.dispose(),n instanceof ey&&(t.executionProhibited=!0,console.error("Disabling AVM1 execution"));if(t.popCallFrame(),n)throw n}(this,t,e)}catch(t){i=t}this.isActive=n,i&&console.error("error in framescripts",i)}},e.prototype.executeFunction=function(t,e,i){if(!this.executionProhibited){var n,r,o=this.isActive;o||(this.isActive=!0,this.abortExecutionAt=Sg.value?Number.MAX_VALUE:Date.now()+1e3,this.errorsIgnored=0);try{r=t.alCall(e,i)}catch(t){n=t}if(this.isActive=o,n)throw n;return r}},e}(Mg);Mg.create=function(t){return new $g(t)};var ty=function(t){this.error=t},ey=function(t){function e(e,i){var n=t.call(this,e)||this;return n.error=i,n}return i(e,t),e}(Error);function iy(t,e,i){var n=Vm(0,e),r=Vm(0,i);if("string"==typeof n&&"string"==typeof r)return zm(t,n)<zm(t,r);var o=jm(t,n),s=jm(t,r);return isNaN(o)||isNaN(s)?void 0:o<s}function ny(t,e){if(Xh(t)||Xh(e))return!1;var i=e.alGetPrototypeProperty();if(!i)return!1;for(var n=t;n;){if(n===i)return!0;n=n.alPrototype}return!1}function ry(t,e,i){var n=Hm(t,e);if(n)return n.alGet(i)}function oy(t,e,i,n){var r=Hm(t,e);if(r)if("__proto__"==i){if(n){for(var o=n.alGetKeys(),s=0;s<o.length;s++){var a=o[s];""!=a&&(r.alPut(a,n.alGet(a)),ay(t,a,r))}r.protoTypeChanged=!(n instanceof g_)}}else r.alPut(i,n),r.adaptee&&ay(t,i,r)}function sy(t,e,i){var n=Hm(t,e);i=t.normalizeName(i);var r=n.alDeleteProperty(i);return ay(t,i,n),r}function ay(t,e,i){void 0!==e&&(e=Ym(t,e),"o"===(e=t.normalizeName(e))[0]&&"n"===e[1]&&i&&i.updateEventByPropName&&i.updateEventByPropName(e))}function ly(t){return"undefined"!=typeof InternalError&&t instanceof InternalError&&"too much recursion"===t.message?new ey("long running script -- AVM1 recursion limit is reached"):t}function uy(t,e){if(Zm(t))return t.alConstruct(e)}function cy(t,e,i){"boolean"!=typeof t&&"string"!=typeof t&&"number"!=typeof t&&Jm(t,(function(n){var r,o;if("string"!=typeof n||-1==n.indexOf("_internal_TF")){var s=t.alGet(n);(null===(o=null===(r=s)||void 0===r?void 0:r.adaptee)||void 0===o?void 0:o.isAsset(sh))&&s.adaptee.isStatic||e.call(i,n)}}),i)}function hy(t,e,i){if(t.swfVersion<6)return null;var n=e.inSequence&&e.previousFrame.calleeSuper;if(!n){for(n=e.currentThis;n&&!n.alHasOwnProperty(i);)n=n.alPrototype;if(!n)return null}return n=n.alPrototype}var py=function(t){function e(e,i){var n=t.call(this,e)||this;return n.callFrame=i,n.alPrototype=e.builtins.Object.alGetPrototypeProperty(),n}return i(e,t),e}(Sf),dy=function(t){function e(e,i,n,r){var o=t.call(this,e,i)||this;return rg(o,{callee:{value:n},caller:{value:r}}),o}return i(e,t),e}(wm),fy=function(){function t(t,e,i,n){this.framescriptmanager=el,this.context=t,this.actions=t.actions,this.isSwfVersion5=t.swfVersion>=5,this.isSwfVersion7=t.swfVersion>=7,this.registers=[],this.stack=[],this.frame=null,this.recoveringFromError=!1,this.isEndOfActions=!1,this.reset(e,i,n)}return t.alInitStatic=function(){this.cache=[]},t.prototype.reset=function(t,e,i){this.scopeList=t,this.constantPool=e,this.registers.length=i},t.prototype.clean=function(){this.scopeList=null,this.constantPool=null,this.registers.length=0,this.stack.length=0,this.frame=null,this.recoveringFromError=!1,this.isEndOfActions=!1},t.prototype.pushScope=function(t){var e=Object.create(this);return e.stack=[],Xh(t)||(e.scopeList=t),e},t.prototype.dispose=function(){this.clean();var e=this.context.getStaticState(t);e.cache.length<t.MAX_CACHED_EXECUTIONCONTEXTS&&e.cache.push(this)},t.create=function(e,i,n,r){var o,s=e.getStaticState(t);return s.cache.length>0?(o=s.cache.pop()).reset(i,n,r):o=new t(e,i,n,r),o},t.MAX_CACHED_EXECUTIONCONTEXTS=20,t}(),_y=function(t){function e(e){var i=t.call(this,e)||this;return i.alPut("toString",new Nm(e,i._toString)),i}return i(e,t),e.prototype._toString=function(){return this},e}(Sf),my=function(t){function e(e,i,n,r,o,s,a,l){var u=t.call(this,e)||this;u.functionName=r,u.actionsData=n,u.parametersNames=o,u.registersAllocation=a,u.suppressArguments=l,u.scopeList=i.scopeList,u.constantPool=i.constantPool;for(var c=null,h=a?a.length:0,p=0;p<h;p++){var d=a[p];d&&1===d.type&&(c||(c=[]),c[a[p].index]=!0)}u.skipArguments=c;var f=Math.min(s,255);return f=Math.max(f,h+1),u.registersLength=f,u}return i(e,t),e.prototype.alCall=function(t,e){var i,n,r=this.context;if(!r.executionProhibited){var o=new _y(r),s=new Kg(o,this.scopeList),a=this.scopeList.scope;e=e||[];var l,u,c=fy.create(r,s,this.constantPool,this.registersLength),h=r.frame?r.frame.fn:void 0,p=r.pushCallFrame(t,this,e,c),d=this.suppressArguments;4&d||o.alPut("arguments",new dy(r,e,this,h)),2&d||o.alPut("this",t),8&d||(l=new py(r,p),o.alPut("super",l));var f=c.registers,_=this.registersAllocation,m=_?_.length:0;for(u=0;u<m;u++){var g=_[u];if(g)switch(g.type){case 1:f[u]=e[g.index];break;case 2:f[u]=t;break;case 4:f[u]=new dy(r,e,this,h);break;case 8:l=l||new py(r,p),f[u]=l;break;case 16:f[u]=r.globals;break;case 32:var y=null;if(a&&((y=a.alGet("_parent"))||(y=a.alGet("this"))&&(y=y.alGet("_parent"))),!y&&((y=t)&&(y=y.alGet("_parent")),y&&this.isOnEnter&&y.alGet("_parent")&&(y=y.alGet("_parent")),!y&&(null===(n=null===(i=this.scopeList)||void 0===i?void 0:i.previousScopeItem)||void 0===n?void 0:n.scope)))for(var A=this.scopeList.previousScopeItem;A;)A.scope&&A.scope instanceof g_?y=A.scope:A.scope&&(y=A.scope.alGet("this")),y&&(y=y.alGet("_parent")),A=A.previousScopeItem?A.previousScopeItem:null;y&&(f[u]=y);break;case 64:f[u]=Sy(c)}}var v,b,x=this.parametersNames,C=this.skipArguments;for(u=0;u<e.length||u<x.length;u++)C&&C[u]||o.alPut(x[u],e[u]);r.actionTracer;var w=this.actionsData;if(++r.stackDepth>=256)throw new ey("long running script -- AVM1 recursion limit is reached");try{v=Cv(c,w)}catch(t){b=t}if(r.stackDepth--,r.popCallFrame(),c.dispose(),b)throw b;return v}},e}(Fm);function gy(t,e){return isNaN(t)||t<0?(Xg("Invalid amount of arguments: "+t),0):(t|=0)>e?(Xg("Truncating amount of arguments: from "+t+" to "+e),e):t}function yy(t){var e=+t.pop();e=gy(e,t.length);for(var i=[],n=0;n<e;n++)i.push(t.pop());return i}function Ay(t,e){var i=null;if(e){if("string"==typeof e)for(;e.length&&"."==e[e.length-1];)e=e.substring(0,e.length-1);try{xy(i=Ey(t,e,!1))||(Xg("Invalid AVM1 target object: "+e),i=void 0)}catch(t){Xg("Unable to set target: "+t)}}i?(t.scopeList.flags|=qg.REPLACE_TARGET,t.scopeList.replaceTargetBy=i):(t.scopeList.flags&=~qg.REPLACE_TARGET,t.scopeList.replaceTargetBy=null)}function vy(t,e,i,n,r,o,s){return new my(t.context,t,e,i,n,r,o,s)}var by={scope:null,propertyName:null,value:void 0};function xy(t){return t instanceof Sf&&sg(t)}function Cy(t,e,i,n){var r;void 0===n&&(n=null);for(var o=by,s=t;s;s=s.previousScopeItem){if(!(s.flags&qg.REPLACE_TARGET)||64&i||r||(r=s.replaceTargetBy),s.flags&qg.TARGET){if(2&i)return o.scope=r||s.scope,o.propertyName=e,o.value=32&i?o.scope.alGet(e):void 0,o;if(1&i&&r){if(r.alHasProperty(e))return o.scope=r,o.propertyName=e,o.value=32&i?r.alGet(e):void 0,o;continue}}if(s.scope.alHasProperty(e)){var a=s.scope.alGet(e);if(n&&(!a||"object"!=typeof a||!a.alHasProperty||!a.alHasProperty(n)))continue;return o.scope=s.scope,o.propertyName=e,o.value=32&i?s.scope.alGet(e):void 0,o}}}function wy(t,e,i){var n,r,o,s=e.length,a=0,l=!0,u=null,c=null,h=void 0,p=e;if(!function(t){return t&&(t.indexOf(".")>=0||t.indexOf(":")>=0||t.indexOf("/")>=0)}(e))return"string"==typeof(e=t.context.normalizeName(e))&&e.startsWith("_level")?((n=by).scope=c,n.propertyName=e,n.value=t.context.resolveLevel(+e[6]),n):Cy(t.scopeList,e,i);if("."==e[e.length-1])return null;if("/"===e[0]?((n=Cy(t.scopeList,"_root",33))&&(u=n.propertyName,c=n.scope,h=n.value),a++,o=!1):(n=null,o=!0),a>=s)return n;for(var d=a;a<s;){if(!(o||h instanceof Sf))return Xg("Unable to resolve variable on invalid object "+e.substring(d,a-1)+" (expr "+e+")"),null;if(d=a,"."===e[a]&&"."===e[a+1])a+=2,u="_parent";else{for(;a<s&&"/"!==(r=e[a])&&"."!==r&&":"!==r;)a++;u=e.substring(d,a)}if(""===u&&a<s)a++;else{c=h;var f=!1;if(l){var _=h instanceof g_?h._lookupChildByName(u):void 0;_&&(f=!0,h=_)}if(!f)if(o){d=a+1;var m=a+1,g="";if("."===e[m]&&"."===e[m+1])m+=2,g="_parent";else{for(;m<s&&"/"!==(r=e[m])&&"."!==r&&":"!==r;)m++;g=e.substring(d,m)}""==g&&(g=null),!(n=Cy(t.scopeList,u,i,g))&&g&&(n=Cy(t.scopeList,u,i)),n&&(f=!0,u=n.propertyName,c=n.scope,h=n.value,a<s&&!h&&c&&(h=c)),o=!1}else h.alHasProperty(u)&&(h=h.alGet(u),f=!0);if(f||"_"!==u[0]||(u.startsWith("_level")?(h=t.context.resolveLevel(+u[6]),f=!0):"_root"===u&&(h=Sy(t),f=!0)),!(f||2&i))return Xg("Unable to resolve "+u+" on "+e.substring(d,a-1)+" (expr "+e+")"),null;if(a>=s)break;var y=e[a++];"/"!==y||":"!==(r=e[a])&&"."!==r||(y=e[a++]),l="/"===y}}return(n=by).scope=c,n.propertyName=p.substring(d,a),n.value=32&i?h:void 0,n}function Iy(t,e){for(var i=t.scopeList;i.previousScopeItem;i=i.previousScopeItem){if(i.flags&qg.REPLACE_TARGET&&e)return i.replaceTargetBy;if(i.flags&qg.TARGET)return i.scope}}function Ey(t,e,i){var n;if(xy(e))n=e;else if(e=Xh(e)?"":zm(this,e)){var r=zm(t.context,e),o=wy(t,r,161|(i?0:64));o&&xy(o.value)?n=o.value:(Xg("Invalid AVM1 target object: "+r),n=void 0)}else n=Iy(t,!0);return n}function Sy(t){return Iy(t,!0).get_root()}function Dy(t,e){var i=e[0];e[1]?t.actions.gotoAndPlay(i+1):t.actions.gotoAndStop(i+1)}function Ty(t,e){var i=e[0],n=e[1];t.actions.getURL(i,n)}function Py(t){t.actions.nextFrame()}function By(t){t.actions.prevFrame()}function My(t){t.actions.play()}function Oy(t){t.actions.stop()}function Ly(t){t.actions.toggleHighQuality()}function Ry(t){t.actions.stopAllSounds()}function Ny(t,e){var i=e[0];return!t.actions.ifFrameLoaded(i)}function Fy(t,e){Ay(t,e[0])}function ky(t,e){var i=e[0];e[1]?t.actions.gotoAndPlay(i):t.actions.gotoAndStop(i)}function Vy(t,e){var i=t.registers,n=t.constantPool,r=t.stack;e.forEach((function(t){if(t instanceof Fg)r.push(n[t.constantIndex]);else if(t instanceof Ng){var e=t.registerNumber;e<0||e>=i.length?r.push(void 0):r.push(i[e])}else r.push(t)}))}function Uy(t){t.stack.pop()}function jy(t){var e=t.stack,i=jm(t.context,e.pop()),n=jm(t.context,e.pop());t.isSwfVersion7||(void 0===i&&(i=0),void 0===n&&(n=0)),isFinite(i)&&isFinite(n)?null==n?e.push(NaN):e.push(i+n):i===-1/0&&n===-1/0?e.push(-1/0):isNaN(i)||isNaN(n)?e.push(NaN):i===n?e.push(1/0):isFinite(i)||isFinite(n)?isFinite(i)?isFinite(n)||e.push(n):e.push(i):e.push(NaN)}function Gy(t){var e=t.stack,i=e.pop(),n=e.pop();i=jm(t.context,i),n=jm(t.context,n),t.isSwfVersion7||(null==i&&(i=0),null==n&&(n=0)),isFinite(i)&&isFinite(n)?e.push(n-i):isNaN(i)||isNaN(n)||i===n?e.push(NaN):isFinite(i)?isFinite(n)||e.push(n):i===-1/0?e.push(1/0):e.push(-1/0)}function Qy(t){var e=t.stack,i=e.pop();i="\n"===i?NaN:jm(t.context,i);var n=e.pop();n="\n"===n?NaN:jm(t.context,n),t.isSwfVersion7||(null!=i&&void 0!==i||(i=0),null!=n&&void 0!==n||(n=0)),isFinite(i)&&isFinite(n)?e.push(i*n):isNaN(i)||isNaN(n)?e.push(NaN):i===n?e.push(1/0):isFinite(i)||isFinite(n)?isFinite(i)?isFinite(n)||(0==i?e.push(NaN):n>=0?i>=0?e.push(1/0):e.push(-1/0):i>=0?e.push(-1/0):e.push(1/0)):0==n?e.push(NaN):i>=0?n>=0?e.push(1/0):e.push(-1/0):n>=0?e.push(-1/0):e.push(1/0):e.push(-1/0)}function zy(t){var e=t.stack,i=e.pop(),n=e.pop(),r=typeof i,o=typeof n;t.isSwfVersion7||(null!==i&&"undefined"!==r||(i=0,r="number"),null!==n&&"undefined"!==o||(n=0,o="number")),"object"===r||"object"===o||"string"===r||"string"===o||"undefined"===r||"undefined"===o||isNaN(i)||isNaN(n)?e.push(NaN):(i="boolean"===r?+i:jm(t.context,i),n="boolean"===o?+n:jm(t.context,n),!isFinite(i)||!isFinite(n)||0==i&&0==n?0==i&&0==n||!isFinite(i)&&!isFinite(n)?e.push(NaN):0==i?e.push(n):0==n?e.push(0):isFinite(n)?isFinite(i)||(isNaN(i)?e.push(i):e.push(0)):n>=0?i>=0?e.push(1/0):e.push(-1/0):i>=0?e.push(-1/0):e.push(1/0):0==i?e.push(n>0?1/0:-1/0):e.push(n/i))}function Hy(t){var e=t.stack,i=t.isSwfVersion5,n=jm(t.context,e.pop()),r=jm(t.context,e.pop()),o=Math.abs(n),s=Math.abs(r),a=1e-6*(o>s?o:s),l=Math.abs(n-r)<=a;e.push(i?l:l?1:0)}function Xy(t){var e=t.stack,i=t.isSwfVersion5,n=jm(t.context,e.pop()),r=jm(t.context,e.pop())<n;e.push(i?r:r?1:0)}function qy(t){var e=t.stack,i=t.isSwfVersion5,n=Um(t.context,e.pop()),r=Um(t.context,e.pop()),o=n&&r;e.push(i?o:o?1:0)}function Yy(t){var e=t.stack,i=t.isSwfVersion5,n=Um(t.context,e.pop()),r=Um(t.context,e.pop()),o=n||r;e.push(i?o:o?1:0)}function Ky(t){var e=t.context,i=t.stack,n=!Um(e,i.pop());i.push(function(t,e){return t.swfVersion>=5?!!e:+e}(e,n))}function Wy(t){var e=t.stack,i=t.isSwfVersion5,n=zm(t.context,e.pop())==zm(t.context,e.pop());e.push(i?n:n?1:0)}function Jy(t){var e=t.stack,i=zm(t.context,e.pop());e.push(t.actions.length_(i))}function Zy(t){var e=t.stack,i=zm(t.context,e.pop());e.push(t.actions.length_(i))}function $y(t){var e=t.stack,i=zm(t.context,e.pop()),n=zm(t.context,e.pop());e.push(n+i)}function tA(t){var e=t.stack,i=e.pop(),n=e.pop(),r=zm(t.context,e.pop());e.push(t.actions.substring(r,n,i))}function eA(t){var e=t.stack,i=e.pop(),n=e.pop(),r=zm(t.context,e.pop());e.push(t.actions.mbsubstring(r,n,i))}function iA(t){var e=t.stack,i=t.isSwfVersion5,n=zm(t.context,e.pop()),r=zm(t.context,e.pop())<n;e.push(i?r:r?1:0)}function nA(t){var e=t.stack,i=Qm(t.context,e.pop());e.push(i)}function rA(t){var e=t.stack,i=e.pop(),n=t.actions.ord(i);e.push(n)}function oA(t){var e=t.stack,i=e.pop(),n=t.actions.mbord(i);e.push(n)}function sA(t){var e=t.stack,i=+e.pop(),n=t.actions.chr(i);e.push(n)}function aA(t){var e=t.stack,i=+e.pop(),n=t.actions.mbchr(i);e.push(n)}function lA(t,e){}function uA(t,e){return!!t.stack.pop()}function cA(t){var e=t.stack.pop();t.actions.call(e)}function hA(t){var e=t.stack,i=e.pop();i&&(i=zm(t.context,i));var n=e.length;e.push(void 0);var r=wy(t,"__get__"+i,33);if(r&&r.value){var o=DA(t,r.scope,r.propertyName,[]),s=o.result;if(o.called)return void(e[n]=s)}var a=wy(t,i,33);Xh(a)?"TRUE"==i?e[n]=!0:"FALSE"==i?e[n]=!1:i&&0==i.indexOf("this.")?(a=wy(t,i=i.replace("this.",""),33),e[n]=a?a.value:void 0):Eg.value&&Xg("AVM1 warning: cannot look up variable '"+i+"'"):e[n]=a?a.value:void 0}function pA(t){var e=t.stack,i=e.pop(),n=""+e.pop(),r=wy(t,"__set__"+n,33);if(r&&r.value&&DA(t,r.scope,r.propertyName,[i]).called)return;var o=wy(t,n,2);o?(o.scope.alPut(o.propertyName,i),ay(t.context,o.propertyName,o.scope)):Eg.value&&Xg("AVM1 warning: cannot look up variable '"+n+"'")}function dA(t,e){var i,n=t.stack,r=e[0],o=n.pop(),s=n.pop();1&r?i="GET":2&r&&(i="POST");var a=64&r;128&r?t.actions.loadVariables(s,o,i):a?t.actions.loadMovie(s,o,i):t.actions.getURL(s,o,i)}function fA(t,e){var i=t.stack,n=e[0],r=[i.pop()];2&n&&r.push(e[1]),(1&n?t.actions.gotoAndPlay:t.actions.gotoAndStop).apply(t.actions,r)}function _A(t){var e=t.stack;Ay(t,zm(t.context,e.pop()))}function mA(t){var e=t.stack,i=e.pop(),n=e.pop(),r=e.length;e.push(void 0);var o=Ey(t,n,!0),s=Wf[i];o&&s&&(e[r]=o.alGet(s))}function gA(t){var e=t.stack,i=e.pop(),n=e.pop(),r=Ey(t,e.pop(),!0),o=Wf[n];r&&o&&r.alPut(o,i)}function yA(t){var e=t.stack,i=e.pop(),n=e.pop(),r=e.pop();t.actions.duplicateMovieClip(r,n,i)}function AA(t){var e=t.stack.pop();t.actions.removeMovieClip(e)}function vA(t){var e=t.stack,i=t.actions.startDrag,n=e.pop(),r=e.pop();if(!!e.pop()){var o=e.pop(),s=e.pop(),a=e.pop(),l=e.pop();i.call(t.actions,n,r,l,a,s,o)}else i.call(t.actions,n,r)}function bA(t){t.actions.stopDrag()}function xA(t,e){var i=t.stack.pop();return!t.actions.ifFrameLoaded(i)}function CA(t){var e=t.stack.pop();t.actions.trace(e)}function wA(t){t.stack.push(t.actions.getTimer())}function IA(t){var e=t.stack;e.push(t.actions.random(e.pop()))}function EA(t){var e=t.stack,i=e.pop();eg(t.context,i)&&(i=i.value.join("."));var n=yy(e),r=e.length;e.push(void 0);var o=wy(t,i,33);if(Xh(o))Xg("AVM1 warning: cannot look up function '"+i+"'");else{var s=o.value;Zm(s)?("array"==i.toLowerCase()&&(n=[n]),e[r]=s.alCall(o.scope||null,n)):Xg("AVM1 warning: function '"+i+(s?"' is not callable":"' is undefined"))}}function SA(t){var e=t.stack,i=e.pop(),n=e.pop(),r=yy(e),o=e.length;e.push(void 0);var s=DA(t,n,i,r);s.called&&(e[o]=s.result)}function DA(t,e,i,n){if(Xh(e))return Xg("AVM1 warning: method '"+i+"' can't be called on undefined object"),{called:!1,result:void 0};var r,o,s,a,l=t.context.frame,u=!1;if(Xh(i)||""===i){if(e instanceof py){var c=e.callFrame;(r=hy(t.context,c,"__constructor__"))&&(o=r.alGet("__constructor__"),s=c.currentThis)}else o=e,s=e;return Zm(o)?(l.setCallee(s,r,o,n),a=o.alCall(s,n),u=!0,l.resetCallee()):Xg("AVM1 warning: obj '"+e+(e?"' is not callable":"' is undefined")),{result:a,called:u}}if(e instanceof py){c=e.callFrame;(r=hy(t.context,c,i))&&(o=r.alGet(i),s=c.currentThis)}else o=ry(t.context,e,i),s=Hm(t.context,e);return Zm(o)?(l.setCallee(s,r,o,n),"toString"==i&&"number"==typeof e?1==n.length&&16==n[0]?a=e.toString(16):(a=zm(t.context,e),u=!0):(a=o.alCall(s,n),u=!0),l.resetCallee(),{result:a,called:u}):("function"==typeof o?(a=o(n),u=!0):Xg("AVM1 warning: method '"+i+"' on object",e,Xh(o)?"is undefined":"is not callable"),{result:a,called:u})}function TA(t,e){var i=e[0];t.constantPool=i}function PA(t,e){var i=t.stack,n=e[0],r=e[1],o=vy(t,n,r,e[2],4,null,0);if(r){var s=t.scopeList.scope;s.alPut(r,o),ay(t.context,r,s)}else i.push(o)}function BA(t){var e=t.stack,i=t.scopeList.scope,n=e.pop(),r=e.pop();i.alPut(r,n)}function MA(t){var e=t.stack,i=t.scopeList.scope,n=e.pop();i.alHasProperty(n)||i.alPut(n,void 0)}function OA(t){var e=t.stack,i=e.pop(),n=e.pop();Xh(n)?Xg("AVM1 warning: cannot delete member '"+i+"' on undefined object"):e.push(sy(t.context,n,i))}function LA(t){var e=t.stack,i=e.pop(),n=wy(t,i,1);if(Xh(n))Xg("AVM1 warning: cannot look up variable '"+i+"'");else{var r=n.scope.alGetProperty(i);r&&r.value&&r.value.adaptee||e.push(sy(t.context,n.scope,i))}}function RA(t){var e=t.stack,i=e.pop();e.push(null);var n=wy(t,i,33);if(Xh(n))Xg("AVM1 warning: cannot look up variable '"+i+"'");else{var r=n.value;Xh(r)?Xg("AVM1 warning: cannot iterate over undefined object"):cy(r,(function(t){e.push(t)}),null)}}function NA(t){var e=t.stack,i=e.pop(),n=e.pop();e.push(function t(e,i,n){if(typeof i==typeof n){if("number"==typeof i){var r=Math.abs(i),o=Math.abs(n),s=1e-6*(r>o?r:o);return Math.abs(i-n)<=s}return i===n}return null==i&&null==n||("number"==typeof i&&"string"==typeof n?""!==n&&i===+n:"string"==typeof i&&"number"==typeof n?""!==i&&+i===n:"boolean"==typeof i&&(i=+i,"number"==typeof n||"string"==typeof n)?""!==n&&i===+n:"boolean"==typeof n&&(n=+n,"number"==typeof i||"string"==typeof i)?""!==i&&+i===n:"number"!=typeof i&&"string"!=typeof i||"object"!=typeof n||null===n?"object"==typeof i&&null!==i&&("number"==typeof n||"string"==typeof n)&&("object"!=typeof(i=Vm(0,i))&&t(e,i,n)):"object"!=typeof(n=Vm(0,n))&&t(e,i,n))}(t.context,i,n))}function FA(t,e){for(var i=t.stack,n=e?e[1]:i.pop(),r=e?e[0]:i.pop(),o=e?e.length-1:1,s=void 0,a=0;a<o;){if(null==r)return Xg("AVM1 warning: cannot get member '"+n+"' on undefined object"),i[i.length]=void 0;if(r instanceof py){var l=r.callFrame,u=hy(t.context,l,n);u&&(s=u.alGet(n))}else s=ry(t.context,r,n);if(a===o-1)return i[i.length]=s;r=s,n=e[a+2],a++}return i[i.length]=s}function kA(t){var e=t.stack,i=new wm(t.context,yy(e));e.push(i)}function VA(t){var e=t.stack,i=+e.pop();i=gy(i,e.length>>1);for(var n=Xm(t.context),r=0;r<i;r++){var o=e.pop(),s=e.pop();n.alPut(s,o)}e.push(n)}function UA(t){var e=t.stack,i=e.pop(),n=e.pop(),r=yy(e),o=e.length;if(e.push(void 0),Xh(n))Xg("AVM1 warning: method '"+i+"' can't be constructed on undefined object");else{var s=uy(Xh(i)||""===i?n:ry(t.context,n,i),r);void 0===s&&Xg("AVM1 warning: method '"+i+"' on object",n,"is not constructible"),e[o]=s}}function jA(t){var e=t.stack,i=e.pop(),n=yy(e),r=e.length;e.push(void 0);var o=wy(t,i,33);if(Xh(o))Xg("AVM1 warning: cannot look up object '"+i+"'");else{var s=o.value,a=function(t,e,i){var n=t.builtins,r=void 0;if(e!==n.Array&&e!==n.Object&&e!==n.Date&&e!==n.String&&e!==n.Function||(r=e.alConstruct(i)),e!==n.Boolean&&e!==n.Number||(r=e.alConstruct(i).value),r instanceof Sf){var o=new Ef(65,e);r.alSetOwnProperty("__constructor__",o)}return r}(t.context,s,n);void 0===a&&void 0===(a=uy(s,n))&&Xg("AVM1 warning: object '"+i+(s?"' is not constructible":"' is undefined")),e[r]=a}}function GA(t,e){var i=t.stack,n=e?e[2]:i.pop(),r=e?e[1]:i.pop(),o=e?e[0]:i.pop();Xh(o)?Xg("AVM1 warning: cannot set member '"+r+"' on undefined object"):o instanceof py?Xg("AVM1 warning: cannot set member '"+r+"' on super"):void 0!==r&&oy(t.context,o,r,n)}function QA(t){var e=t.stack,i=e.pop();e.push(function(t){return"object"==typeof t&&t&&t instanceof g_}(i)?i._target:void 0)}function zA(t,e){var i=t.stack,n=e[0];!function(t,e,i){if(Xh(e))Xg("The with statement object cannot be undefined.");else{var n=t.context,r=t.scopeList,o=new Kg(Hm(n,e),r);Cv(t.pushScope(o),i)}}(t,i.pop(),n)}function HA(t){var e=t.stack;e.push(jm(t.context,e.pop()))}function XA(t){var e=t.stack;e.push(zm(t.context,e.pop()))}function qA(t){var e=t.stack,i=function(t){if(null===t)return"null";if("object"==typeof t){if(t instanceof g_)return"movieclip";if(t instanceof Df)return"function"}return typeof t}(e.pop());e.push(i)}function YA(t,e,i){var n=t.stack;arguments.length>1?(i=Vm(t.context,i),e=Vm(t.context,e)):(i=Vm(t.context,n.pop()),e=Vm(t.context,n.pop()));var r=typeof e,o=typeof i,s="string"===r,a="string"===o;return s&&a?n[n.length]=e+i:s||a?n[n.length]=(s?e:zm(t.context,e))+(a?i:zm(t.context,i)):(t.isSwfVersion7||(null!==e&&"undefined"!==r||(e=0),null!==i&&"undefined"!==o||(i=0)),null==i||null==e?n.push(NaN):isFinite(e)&&isFinite(i)?n.push(e+i):e===-1/0&&i===-1/0?n.push(-1/0):isNaN(e)||isNaN(i)?n.push(NaN):e===i?n.push(1/0):isFinite(e)||isFinite(i)?isFinite(e)?isFinite(i)||n.push(i):n.push(e):n.push(NaN),n[n.length-1])}function KA(t){var e=t.stack,i=e.pop(),n=e.pop();e.push(iy(t.context,n,i))}function WA(t){var e=t.stack,i=e.pop(),n=e.pop();"string"!=typeof i&&"string"!=typeof n?(i=jm(t.context,i),n=jm(t.context,n),t.isSwfVersion7||(void 0===i&&(i=0),void 0===n&&(n=0)),!isFinite(i)||!isFinite(n)||0==i&&0==n?isNaN(i)||isNaN(n)||!isFinite(i)&&!isFinite(n)||isFinite(i)?e.push(NaN):e.push(n):e.push(n%i)):e.push(NaN)}function JA(t){var e=t.stack,i=Qm(t.context,e.pop()),n=Qm(t.context,e.pop());e.push(n&i)}function ZA(t){var e=t.stack,i=Qm(t.context,e.pop()),n=Qm(t.context,e.pop());e.push(n<<i)}function $A(t){var e=t.stack,i=Qm(t.context,e.pop()),n=Qm(t.context,e.pop());e.push(n|i)}function tv(t){var e=t.stack,i=Qm(t.context,e.pop()),n=Qm(t.context,e.pop());e.push(n>>i)}function ev(t){var e=t.stack,i=Qm(t.context,e.pop()),n=Qm(t.context,e.pop());e.push(n>>>i)}function iv(t){var e=t.stack,i=Qm(t.context,e.pop()),n=Qm(t.context,e.pop());e.push(n^i)}function nv(t){var e=t.stack,i=jm(t.context,e.pop());i--,e.push(i)}function rv(t){var e=t.stack,i=jm(t.context,e.pop());i++,e.push(i)}function ov(t){var e=t.stack;e.push(e[e.length-1])}function sv(t){t.isEndOfActions=!0}function av(t){var e=t.stack;e.push(e.pop(),e.pop())}function lv(t,e){var i=t.stack,n=t.registers,r=e[0];r<0||r>=n.length||(n[r]=i[i.length-1])}function uv(t){var e=t.stack,i=e.pop(),n=e.pop();e.push(ny(n,i))}function cv(t){var e=t.stack,i=e.pop();e.push(null),Xh(i)?Xg("AVM1 warning: cannot iterate over undefined object"):cy(i,(function(t){e.push(t)}),null)}function hv(t){var e=t.stack,i=e.pop(),n=e.pop();e.push(n===i)}function pv(t,e){var i=t.stack,n=e?e[1]:i.pop(),r=e?e[0]:i.pop();return i[i.length]=iy(t.context,n,r)}function dv(t){var e=t.stack,i=t.isSwfVersion5,n=zm(t.context,e.pop()),r=zm(t.context,e.pop())>n;e.push(i?r:r?1:0)}function fv(t,e){var i=t.stack,n=t.scopeList.scope,r=e[0],o=e[1],s=vy(t,r,o,e[2],e[3],e[4],e[5]);o?(n.alPut(o,s),ay(t.context,o,n)):i.push(s)}function _v(t){var e=t.stack,i=t.context,n=Hm(i,e.pop()),r=Hm(i,e.pop()).alGetPrototypeProperty(),o=n.alGetPrototypeProperty();r.alPrototype=o;var s=new Ef(65,n);r.alSetOwnProperty("__constructor__",s)}function mv(t){var e=t.stack,i=e.pop(),n=e.pop();e.push(ny(i,n)?i:null)}function gv(t){var e=t.stack,i=e.pop(),n=+e.pop();gy(n,e.length);for(var r=[],o=0;o<n;o++)r.push(e.pop());i._as2Interfaces=r}function yv(t,e){e[0];var i=e[1],n=e[2],r=e[3],o=e[4];!function(t,e,i,n,r,o,s,a){var l,u=t.context,c=t.scopeList,h=t.registers,p=u.isTryCatchListening;try{u.isTryCatchListening=!0,Cv(t.pushScope(),o)}catch(e){if(u.isTryCatchListening=p,n&&e instanceof ty){if("string"==typeof r)c.scope.alPut(r,e.error);else h[r]=e.error;Cv(t.pushScope(),s)}else l=e}if(u.isTryCatchListening=p,i&&Cv(t.pushScope(),a),l)throw l}(t,0,e[5],r,i,n,o,e[6])}function Av(t){var e=t.stack.pop();throw new ty(e)}function vv(t){var e=t.stack,i=yy(e),n=e.length;e.push(void 0);var r=t.actions.fscommand.apply(t.actions,i);e[n]=r}function bv(t,e){}function xv(t,e){var i,n;try{n=function(t,e){t.stack;var i=e.actionCode,n=e.args,r=(t.context.actionTracer,!1);switch(0|i){case 129:Dy(t,n);break;case 131:Ty(t,n);break;case 4:Py(t);break;case 5:By(t);break;case 6:My(t);break;case 7:Oy(t);break;case 8:Ly(t);break;case 9:Ry(t);break;case 138:r=Ny(t,n);break;case 139:Fy(t,n);break;case 140:ky(t,n);break;case 150:Vy(t,n);break;case 23:Uy(t);break;case 10:jy(t);break;case 11:Gy(t);break;case 12:Qy(t);break;case 13:zy(t);break;case 14:Hy(t);break;case 15:Xy(t);break;case 16:qy(t);break;case 17:Yy(t);break;case 18:Ky(t);break;case 19:Wy(t);break;case 20:Jy(t);break;case 49:Zy(t);break;case 33:$y(t);break;case 21:tA(t);break;case 53:eA(t);break;case 41:iA(t);break;case 24:nA(t);break;case 50:rA(t);break;case 54:oA(t);break;case 51:sA(t);break;case 55:aA(t);break;case 153:break;case 157:r=uA(t);break;case 158:cA(t);break;case 28:hA(t);break;case 29:pA(t);break;case 154:dA(t,n);break;case 159:fA(t,n);break;case 32:_A(t);break;case 34:mA(t);break;case 35:gA(t);break;case 36:yA(t);break;case 37:AA(t);break;case 39:vA(t);break;case 40:bA(t);break;case 141:r=xA(t);break;case 38:CA(t);break;case 52:wA(t);break;case 48:IA(t);break;case 61:EA(t);break;case 82:SA(t);break;case 136:TA(t,n);break;case 155:PA(t,n);break;case 60:BA(t);break;case 65:MA(t);break;case 58:OA(t);break;case 59:LA(t);break;case 70:RA(t);break;case 73:NA(t);break;case 78:FA(t);break;case 66:kA(t);break;case 67:VA(t);break;case 83:UA(t);break;case 64:jA(t);break;case 79:GA(t);break;case 69:QA(t);break;case 148:zA(t,n);break;case 74:HA(t);break;case 75:XA(t);break;case 68:qA(t);break;case 71:YA(t);break;case 72:KA(t);break;case 63:WA(t);break;case 96:JA(t);break;case 99:ZA(t);break;case 97:$A(t);break;case 100:tv(t);break;case 101:ev(t);break;case 98:iv(t);break;case 81:nv(t);break;case 80:rv(t);break;case 76:ov(t);break;case 62:sv(t);break;case 77:av(t);break;case 135:lv(t,n);break;case 84:uv(t);break;case 85:cv(t);break;case 102:hv(t);break;case 103:pv(t);break;case 104:dv(t);break;case 142:fv(t,n);break;case 105:_v(t);break;case 43:mv(t);break;case 44:gv(t);break;case 143:yv(t,n);break;case 42:Av(t);break;case 45:vv(t);break;case 137:break;case 0:t.isEndOfActions=!0;break;default:throw new Error("Unknown action code: "+i)}return r}(t,e),t.recoveringFromError=!1}catch(e){i=t.context;var r=ly(e);if(Ig.value&&!i.isTryCatchListening||r instanceof ey)throw r;if(r instanceof ty)throw r;if(uf.instance.reportTelemetry({topic:"error",error:1}),!t.recoveringFromError){if(i.errorsIgnored++>=1e3)throw new ey("long running script -- AVM1 errors limit is reached");console.error("AVM1 error: "+e),t.recoveringFromError=!0}}return n}function Cv(t,e){e.ir||e.compiled||function(t,e){var i,n=t.context,r=new kg(e,n.swfVersion),o=new Og;o.registersLimit=t.registers.length,o.parentResults=e.parent&&e.parent.ir;var s=o.analyze(r);e.ir=s,Dg.value&&(i=(new Hg).generate(s,e.debugPath),e.compiled=i)}(t,e);var i=t.context,n=t.scopeList.scope.adaptee;n&&n._deferScriptExecution&&(i.deferScriptExecution=!0),n&&(g_.currentMCAssetNameSpace=n.assetNamespace);var r=e.compiled;if(r)return r(t);for(var o=0,s=i.abortExecutionAt,a=e.ir,l=0,u=a.actions[l];u&&!t.isEndOfActions;){if(o++%Yg==0&&Date.now()>=s)throw new ey("long running script -- AVM1 instruction hang timeout");l=xv(t,u.action)?u.conditionalJumpTo:u.next,u=a.actions[l]}return t.stack.pop()}var wv=function(){function t(){this._indentation=0,this._indentStringCache=[]}return t.prototype._getIndentString=function(){return this._indentStringCache[this._indentation]||(this._indentStringCache[this._indentation]=new Array(this._indentation+1).join(".."))},t.prototype.print=function(t,e){for(var i=t.position,n=t.actionCode,r=t.actionName,o=[],s=0;s<e.length;s++){var a=e[s];if(a&&"object"==typeof a){var l=a.alGetConstructorProperty();o.push("["+(l?l.name:"Object")+"]")}else o.push(a)}console.log("AVM1 trace: "+this._getIndentString()+i+": "+r+"("+n.toString(16)+"), stack="+o)},t.prototype.indent=function(){this._indentation++},t.prototype.unindent=function(){this._indentation--},t.prototype.message=function(t){console.log("AVM1 trace: ------- "+t)},t}(),Iv=function(){function t(){}return t.CDATA_NODE=100,t.COMMENT_NODE=101,t.DOCUMENT_TYPE_NODE=102,t.ELEMENT_NODE=1,t.PROCESSING_INSTRUCTION_NODE=103,t.TEXT_NODE=3,t.XML_DECLARATION=104,t}(),Ev=function(t){function e(e){return t.call(this,Iv.DOCUMENT_TYPE_NODE,"null")||this}return i(e,t),e.prototype.axCallPublicProperty=function(t,e){return null},e.prototype.axGetPublicProperty=function(t){return null},e.prototype.axSetPublicProperty=function(t,e){return null},e.prototype.createElement=function(t){return console.log("createElement not implemented yet in flash/XMLDocument"),null},e.prototype.createTextNode=function(t){return console.log("createTextNode not implemented yet in flash/XMLDocument"),null},e.prototype.parseXML=function(t){console.log("parseXML not implemented yet in flash/XMLDocument")},e.prototype.toString=function(){return console.log("toString not implemented yet in flash/XMLDocument"),""},e}(U_),Sv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._getLevelForRoot=function(t){return 0},e.prototype._getRootForLevel=function(t){return null},e.prototype._addRoot=function(t,e){},e.prototype._removeRoot=function(t){},e}(Na),Dv=function(){},Tv=function(){},Pv=function(){},Bv=function(){},Mv=function(){},Ov=function(){},Lv=function(){},Rv=function(){},Nv=function(){},Fv=function(){},kv=function(){this.flash={display:{AVM1Movie:Sv,Stage:Kf},events:{Event:Event,KeyboardEvent:KeyboardEvent,MouseEvent:MouseEvent,ProgressEvent:ProgressEvent},external:{ExternalInterface:Ov},filters:{},system:{Capabilities:Mv,Security:Bv,fscommand:Pv},ui:{ContextMenu:Dv,ContextMenuItem:Tv,Mouse:Lv},media:{SoundChannel:Rv,SoundTransform:Nv,SoundMixer:Fv},xml:{XMLDocument:Ev}},this.player={}},Vv=function(){function t(){this.avmVersion="AVM1",this.enterEvent=new a("enterFrame"),this.exitEvent=new a("exitFrame"),this.avm1Listener={},this._collectedDispatcher=[]}return Object.defineProperty(t.prototype,"factory",{get:function(){if(!this._factory)throw"AVM1Handler - no factory set";return this._factory},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e,i){var n=this;if(el.useAVM1=!0,this._avmStage)i(!1);else{this._avmStage=t,this._avmStage.mouseManager.eventBubbling=!1,this._factory=new xg(new $g(e.swfVersion)),this._factory.avm1Context.sec=new kv,this._factory.avm1Context.setStage(this._avmStage,this,document),this._factory.avm1Context.swfVersion=e.swfVersion,this._avmStage.scaleMode=Bp.SHOW_ALL,this._avmStage.align=Mp.TOP,lm.tracelevel=am.ALL,lm._scenegraphFactory=this._factory,ht.enableParser(nf),this._factory.avm1Context.globals.SWF_BASE_URL=e.url.substring(0,e.url.lastIndexOf("/")+1),this.clearAllAVM1Listener();var r=this._avmStage.view.stage;r.addEventListener(tl.MOUSE_DOWN,(function(t){return n.onMouseEvent(t)})),r.addEventListener(tl.MOUSE_UP,(function(t){return n.onMouseEvent(t)})),r.addEventListener(tl.MOUSE_MOVE,(function(t){return n.onMouseEvent(t)})),r.addEventListener(Mc.KEYDOWN,(function(t){return n.onKeyEvent(t)})),r.addEventListener(Mc.KEYUP,(function(t){return n.onKeyEvent(t)})),this._avmStage.avmTestHandler&&(this._factory.avm1Context.actions.originalTrace=this._factory.avm1Context.actions.trace,this._factory.avm1Context.actions.trace=function(t){n._factory.avm1Context.actions.originalTrace(t),n._avmStage.avmTestHandler.addMessage(t)}),i(!0)}},t.prototype.executeEnterFrame=function(t,e){for(var i,n=t.numChildren;n>0;)n--,i=t.getChildAt(n),this.executeEnterFrame(i,e);t.isAsset(il)&&t.hasEventListener(this.enterEvent.type)&&e.push(t)},t.prototype.enterFrame=function(t){var e,i;this._avmStage.view.stage.clear(),el.execute_queue(),this._avmStage.root.advanceFrame(),el.execute_queue();var n=[];for(e=0;e<this._avmStage.root.numChildren;e++)i=this._avmStage.root.getChildAt(e),this.executeEnterFrame(i,n);for(e=0;e<n.length;e++)n[e].dispatchEvent(this.enterEvent);for(el.execute_queue(),el.execute_intervals(t),el.execute_queue(),e=0;e<this._avmStage.root.numChildren;e++)(i=this._avmStage.root.getChildAt(e)).isAsset(il)&&i.dispatchExitFrame(this.exitEvent);el.execute_queue()},t.prototype.onKeyEvent=function(t){if(this.avm1Listener[t.type]){this._collectedDispatcher.length=0;var e,i=0;for(i=0;i<this._avmStage.root.numChildren;i++)(e=this._avmStage.root.getChildAt(i)).isAsset(il)&&this.collectMousEvents(e);for(i=0;i<this._collectedDispatcher.length;i++)if(this.avm1Listener[t.type]&&this.avm1Listener[t.type][this._collectedDispatcher[i].id])for(var n=this.avm1Listener[t.type][this._collectedDispatcher[i].id],r=0;r<n.length;r++)"number"==typeof n[r].keyCode&&n[r].keyCode!=t.keyCode||n[r].callback();el.execute_queue()}},t.prototype.addAVM1EventListener=function(t,e,i,n){this.avm1Listener[e]||(this.avm1Listener[e]={}),this.avm1Listener[e][t.id]||(this.avm1Listener[e][t.id]=[]);var r=this.avm1Listener[e][t.id];r.push({type:e,callback:i}),n&&"number"==typeof n.keyCode&&(r[r.length-1].keyCode=n.keyCode)},t.prototype.removeAVM1EventListener=function(t,e,i){this.avm1Listener[e]&&delete this.avm1Listener[e][t.id]},t.prototype.clearAllAVM1Listener=function(){this.avm1Listener={}},t.prototype.collectMousEvents=function(t){for(var e,i=t.numChildren;i>0;)i--,e=t.getChildAt(i),this.collectMousEvents(e);t.isAsset(il)&&(this._collectedDispatcher[this._collectedDispatcher.length]=t)},t.prototype.onMouseEvent=function(t){if(this.avm1Listener[t.type]){this._collectedDispatcher.length=0;var e,i,n=0,r=this._avmStage.root.numChildren;for(n=0;n<r;n++)(e=this._avmStage.root.getChildAt(n)).isAsset(il)&&this.collectMousEvents(e);for(r=this._collectedDispatcher.length,n=0;n<r;n++){var o=this.avm1Listener[t.type];if(o&&o[this._collectedDispatcher[n].id]){i=o[this._collectedDispatcher[n].id].length;for(var s=0;s<i;s++){var a=o[this._collectedDispatcher[n].id];a&&a[s]&&a[s].callback()}}}el.execute_queue()}},t.prototype.resizeStage=function(){},t.prototype.addAsset=function(t,e){if(t.isAsset(il)&&e&&t.isAVMScene){var i=dg(t.clone(),this._factory.avm1Context);this._factory.avm1Context.globals._addRoot(0,i.adaptee)}},t}();console.debug("AwayFL - AVM1 - 0.2.96");var Uv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,["init","isAdBlocked","gameLoadingStart","gameLoadingFinished","commercialBreak","gameplayStart","gameplayStop"],[],null,e.prototype.avm1Constructor)},e.prototype.avm1Constructor=function(){},e.init=function(t,i,n){var r=function(t){};if(null!=i&&null!=n&&(r=function(t){var e=i.alGet(n.toLowerCase());e&&Zm(e)?e.alCall(i,[t]):e&&e.value&&e.value.alCall(i,[t])}),e.usePokiSDK){if(!PokiSDK||!PokiSDK.hasOwnProperty("adBlocked"))throw"POKISDK is not available";r(PokiSDK.adBlocked)}else r(!0)},e.isAdBlocked=function(){if(!e.usePokiSDK)return!0;if(!PokiSDK.hasOwnProperty("adBlocked"))throw"AS2 is trying to use the PokiSDK before it has been init";return PokiSDK.adBlocked},e.gameLoadingStart=function(){if(e.usePokiSDK){if(!PokiSDK.hasOwnProperty("adBlocked"))throw"AS2 is trying to use the PokiSDK before it has been init";PokiSDK.gameLoadingStart()}},e.gameLoadingFinished=function(){if(e.usePokiSDK){if(!PokiSDK.hasOwnProperty("adBlocked"))throw"AS2 is trying to use the PokiSDK before it has been init";PokiSDK.gameLoadingFinished()}},e.gameplayStart=function(){if(e.usePokiSDK){if(!PokiSDK.hasOwnProperty("adBlocked"))throw"AS2 is trying to use the PokiSDK before it has been init";PokiSDK.gameplayStart()}},e.gameplayStop=function(){if(e.usePokiSDK){if(!PokiSDK.hasOwnProperty("adBlocked"))throw"AS2 is trying to use the PokiSDK before it has been init";PokiSDK.gameplayStop()}},e.commercialBreak=function(t,i,n){var r=function(){};if(null!=i&&null!=n&&(r=function(){n.alCall(i)}),e.usePokiSDK){if(!PokiSDK.hasOwnProperty("adBlocked"))throw"AS2 is trying to use the PokiSDK before it has been init";b.setVolume(0),PokiSDK.commercialBreak().then((function(){b.setVolume(1),r()}))}else r()},e.happyTime=function(t,e){PokiSDK.happyTime(e)},e.usePokiSDK=!0,e}(Sf),jv=function(t){window.initPokiBridge=function(e){flash.Ready(),t&&!window.pokiAdBlock||flash.AdBlocked(),window.commercialBreak=function(){t?(of.instance().pause(),PokiSDK.commercialBreak().then((function(){of.instance().unPause(),flash.commercialBreakCompleted()}))):flash.commercialBreakCompleted()},window.rewardedBreak=function(){t?(of.instance().pause(),PokiSDK.rewardedBreak().then((function(t){of.instance().unPause(),flash.rewardedBreakCompleted(t)}))):flash.rewardedBreakCompleted(!0)}}};var Gv={},Qv=["Public","Protected","PackageInternal","Private","Explicit","StaticProtected"];var zv=new Uint8Array(100),Hv=function(){function t(t,e,i){this.type=t,this.uri=e,this.prefix=i,this.mangledName=null,co(void 0!==t),this.mangleName()}return t.prototype.toString=function(){return t=this.type,String(t)+(""!==this.uri?":"+this.uri:"");var t},t._hashNamespace=function(e,i,n){i+="",n+="";var r=t._knownNames.indexOf(i);if(r>=0)return e<<2|r;var o=1+i.length+n.length,s=o<101?zv:new Uint8Array(o),a=0;s[a++]=e;for(var l=0;l<i.length;l++)s[a++]=i.charCodeAt(l);for(l=0;l<n.length;l++)s[a++]=n.charCodeAt(l);return Cf.hashBytesTo32BitsMD5(s,0,a)},t.prototype.mangleName=function(){if(0!==this.type||""!==this.uri){var e=t._hashNamespace(this.type,this.uri,this.prefix);this.mangledName=Mh.variableLengthEncodeInt32(e)}else this.mangledName="Bg"},t.prototype.isPublic=function(){return 0===this.type},Object.defineProperty(t.prototype,"reflectedURI",{get:function(){return this.uri||(0===this.type?null:this.uri)},enumerable:!0,configurable:!0}),t._knownNames=[""],t}();function Xv(t,e){var i=t+e;return Gv[i]||(Gv[i]=new Hv(t,e,""))}function qv(t,e,i){var n=t+e+i,r=Gv[n];return r||(r=Gv[n]=new Hv(t,e,i)),r}function Yv(t){return"string"==typeof t?t:null==t?null:t+""}var Kv=function(){function t(e,i,n,r,o,s,a){void 0===s&&(s=null),void 0===a&&(a=!1),this.abc=e,this.index=i,this.kind=n,this.namespaces=r,this.name=o,this.parameterType=s,this.mutable=a,this.id=t._nextID++,this._mangledName=null,this.script=null,this.numeric=!1,this.numericValue=0,this.resolved={},this.scope=null,this.value=null,this._key=null}return t.prototype.set=function(t,e){var i="number"==typeof t||"string"==typeof t&&!t.includes(".")&&Number.isInteger(+t);this.namespaces=e?[e]:[],this.name=t,this.numeric=!1,i&&(this.numericValue=+t,this.numeric=!0)},t.prototype.drop=function(){this.mutable&&this.isRuntimeName&&(this.numeric=!1,this.name=void 0,this.namespaces=[],this.scope=null,this.numericValue=NaN,this.resolved={})},t.prototype.key=function(){if(this._key)return this._key;var t=this.toString();return this.mutable||(this._key=t),t},t.FromFQNString=function(e,i){var n=e.lastIndexOf("."),r=-1===n?"":e.substr(0,n),o=-1===n?e:e.substr(n+1);return new t(null,0,15,[Xv(i,r)],o)},t.prototype._nameToString=function(){return this.isAnyName()?"*":this.isRuntimeName()?"["+this.name+"]":this.name},t.prototype.isRuntime=function(){switch(this.kind){case 7:case 13:case 9:case 14:return!1}return!0},t.prototype.isRuntimeName=function(){switch(this.kind){case 17:case 18:case 27:case 28:return!0}return!1},t.prototype.isRuntimeNamespace=function(){switch(this.kind){case 15:case 16:case 17:case 18:return!0}return!1},t.prototype.isAnyName=function(){return null===this.name},t.prototype.isAnyNamespace=function(){return!(this.isRuntimeNamespace()||this.namespaces.length>1)&&(0===this.namespaces.length||""===this.namespaces[0].uri)},t.prototype.isQName=function(){var t=this.kind;return 29===t||7===t||13===t||t>=15&&t<=18},Object.defineProperty(t.prototype,"namespace",{get:function(){return this.namespaces[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uri",{get:function(){return this.namespaces[0].uri},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prefix",{get:function(){return this.namespaces[0].prefix},set:function(t){var e=this.namespaces[0];e.prefix!==t&&(this.namespaces[0]=qv(e.type,e.uri,t))},enumerable:!0,configurable:!0}),t.prototype.equalsQName=function(t){return this.name===t.name&&this.namespaces[0].uri===t.namespaces[0].uri},t.prototype.matches=function(t){var e=t.isAnyName();if(e&&!t.isQName())return!0;if(!e&&this.name!==t.name)return!1;var i=this.namespaces[0].uri;if(""==i||"default"==i)return!0;for(var n=t.namespaces.length;n--;)if(""==t.namespaces[n].uri||t.namespaces[n].uri===i)return!0;return!1},t.prototype.isAttribute=function(){switch(this.kind){case 13:case 16:case 18:case 14:case 27:case 28:return!0}return!1},t.prototype.getMangledName=function(){return this._mangledName||this._mangleName()},t.prototype._mangleName=function(){var t="$Bg"+Yv(this.name);return this.isRuntime()||(this._mangledName=t),t},t.prototype.getPublicMangledName=function(){return zh(this.name)?this.name:"$Bg"+Yv(this.name)},t.isPublicQualifiedName=function(t){return 0===t.indexOf("$Bg")},t.getPublicMangledName=function(t){return zh(t)?t:"$Bg"+t},t.prototype.toFQNString=function(t){var e=this.namespaces[0].uri;return e.length&&(e+=t?"::":"."),e+this.name},t.prototype.toString=function(){var t,e=(t=this.kind,String(t)+" ");(e+=this.isAttribute()?"@":"",this.isRuntimeNamespace())?e+="["+(this.namespaces?this.namespaces.map((function(t){return String(t)})).join(", "):null)+"]::"+this._nameToString():this.isQName()?(e+=this.namespaces[0]+"::",e+=this._nameToString()):this.namespaces?(e+="{"+this.namespaces.map((function(t){return String(t)})).join(", ")+"}",e+="::"+this._nameToString()):(e+="{"+this.namespaces+"}",e+="::"+this._nameToString());return this.parameterType&&(e+="<"+this.parameterType+">"),e},t.prototype.toFlashlogString=function(){var t=this.uri;return t?t+"::"+this.name:this.name},t.stripPublicMangledName=function(t){if(0===t.indexOf("$Bg"))return t.substring(3)},t.FromSimpleName=function(e){e._children&&1==e._children.length&&e._children[0]._value&&(e=e._children[0]._value);var i=e.lastIndexOf(".");i<=0&&(i=e.lastIndexOf(" "));var n,r="";return i>0&&i<e.length-1?(n=e.substring(i+1).trim(),r=e.substring(0,i).trim()):n=e,new t(null,0,15,[Xv(0,r)],n)},t._nextID=1,t}();function Wv(t,e,i){mf(t,e,t.sec.AXFunction.axBox(i))}function Jv(t){return this.classInfo.instanceInfo.getInterfaces(this.axClass).has(t)}var Zv=function(){function t(t,e,i){this.superTraits=t,this.protectedNs=e,this.protectedNsMappings=i,this.slots=[],this._nextSlotID=1,this.multinames={};var n=this._traits=Object.create(null);if(t){var r=t._traits;for(var o in r)n[o]=Object.create(r[o])}}return t.prototype.addTrait=function(t){var e=t.name,i=this._traits[e.name];i||(i=this._traits[e.name]=Object.create(null));var n=e.namespaces[0].mangledName,r=i[n];return i[n]=t,r},t.prototype.addSlotTrait=function(t){var e=t.slot;e?this._nextSlotID=e+1:e=t.slot=this._nextSlotID++,this.slots[e]=t},t.prototype.getTraitMultiname=function(t){return t.mutable?this.getTrait(t.namespaces,t.name):this.multinames[t.id]||(this.multinames[t.id]=this.getTrait(t.namespaces,t.name))},t.prototype.getTrait=function(t,e){var i,n=this._traits[e];if(!n)return null;for(var r=0;r<t.length;r++){var o=t[r];if(i=n[o.mangledName])return i;if(1===o.type)for(var s=this;s;){if(s.protectedNs===o&&(i=s.protectedNsMappings[e]))return i;s=s.superTraits}}return null},t.prototype.getTraitsList=function(){var t=[],e=this._traits;for(var i in e){var n=e[i];for(var r in n)t.push(n[r])}return t},t.prototype.getSlotPublicTraitNames=function(){for(var t=this.slots,e=[],i=1;i<t.length;i++){var n=t[i];n.name.namespace.isPublic()&&e.push(n.name.name)}return e},t.prototype.getSlot=function(t){return this.slots[t]},t}();function $v(){var t=this.hasOwnProperty("classInfo")?"Object":this.classInfo.instanceInfo.name.name;return Mh.concat3("[object ",t,"]")}function tb(t){return null==t||"number"==typeof t||"string"==typeof t||"boolean"==typeof t}var eb=Symbol("AX class marker");function ib(){return this.$BgtoString.axCall(this)}function nb(){return this}function rb(){return this.$BgvalueOf.axCall(this)}var ob=mf,sb=null;function ab(t){return sb.isPrototypeOf(t)||tb(t)}function lb(){if(!sb){var t=bb.prototype;sb=Object.create(null),ob(sb,"axHasPropertyInternal",t.axHasPropertyInternal),ob(sb,"axHasProperty",t.axHasProperty),ob(sb,"axSetProperty",t.axSetProperty),ob(sb,"axHasProperty",t.axHasProperty),ob(sb,"axHasPublicProperty",t.axHasPublicProperty),ob(sb,"axSetPublicProperty",t.axSetPublicProperty),ob(sb,"axGetPublicProperty",t.axGetPublicProperty),ob(sb,"axCallPublicProperty",t.axCallPublicProperty),ob(sb,"axDeletePublicProperty",t.axDeletePublicProperty),ob(sb,"axGetProperty",t.axGetProperty),ob(sb,"axDeleteProperty",t.axDeleteProperty),ob(sb,"axGetSuper",t.axGetSuper),ob(sb,"axSetSuper",t.axSetSuper),ob(sb,"axSetSlot",t.axSetSlot),ob(sb,"axGetSlot",t.axGetSlot),ob(sb,"axCallProperty",t.axCallProperty),ob(sb,"axCallSuper",t.axCallSuper),ob(sb,"axConstructProperty",t.axConstructProperty),ob(sb,"axResolveMultiname",t.axResolveMultiname),ob(sb,"axNextNameIndex",t.axNextNameIndex),ob(sb,"axNextName",t.axNextName),ob(sb,"axNextValue",t.axNextValue),ob(sb,"axGetEnumerableKeys",t.axGetEnumerableKeys),ob(sb,"axImplementsInterface",Jv),ob(sb,"traits",new Zv(null,null,Object.create(null))),ob(sb,"isPrototypeOf",Object.prototype.isPrototypeOf),ob(sb,"hasOwnProperty",Object.prototype.hasOwnProperty),ob(sb,eb,!0),sb.$BgtoString=$v,sb.toString=ib,sb.$BgvalueOf=nb,sb.valueOf=rb}}function ub(t,e){var i=new Kv(null,0,17,[],null);return i.set(t,e||Hv.PUBLIC),i}function cb(t){return Hh(t)?t:"$Bg"+t}function hb(t){return"string"==typeof t?t:null==t?"null":t.toString()}var pb=new Kv(null,0,17,[],null,null,!0),db={NotImplementedError:{code:1001,message:"The method %1 is not implemented."},InvalidPrecisionError:{code:1002,message:"Number.toPrecision has a range of 1 to 21. Number.toFixed and Number.toExponential have a range of 0 to 20. Specified value is not within expected range."},InvalidRadixError:{code:1003,message:"The radix argument must be between 2 and 36; got %1."},InvokeOnIncompatibleObjectError:{code:1004,message:"Method %1 was invoked on an incompatible object."},ArrayIndexNotIntegerError:{code:1005,message:"Array index is not a positive integer (%1)."},CallOfNonFunctionError:{code:1006,message:"%1 is not a function."},ConstructOfNonFunctionError:{code:1007,message:"Instantiation attempted on a non-constructor."},ConvertNullToObjectError:{code:1009,message:"Cannot access a property or method of a null object reference."},ConvertUndefinedToObjectError:{code:1010,message:"A term is undefined and has no properties."},ClassNotFoundError:{code:1014,message:"Class %1 could not be found."},DescendentsError:{code:1016,message:"Descendants operator (..) not supported on type %1."},StackOverflowError:{code:1023,message:"Stack overflow occurred."},CpoolIndexRangeError:{code:1032,message:"Cpool index %1 is out of range %2."},CpoolEntryWrongTypeError:{code:1033,message:"Cpool entry %1 is wrong type."},CheckTypeFailedError:{code:1034,message:"Type Coercion failed: cannot convert %1 to %2."},CannotAssignToMethodError:{code:1037,message:"Cannot assign to a method %1 on %2."},CantUseInstanceofOnNonObjectError:{code:1040,message:"The right-hand side of instanceof must be a class or function."},IsTypeMustBeClassError:{code:1041,message:"The right-hand side of operator must be a class."},InvalidMagicError:{code:1042,message:"Not an ABC file.  major_version=%1 minor_version=%2."},UnsupportedTraitsKindError:{code:1045,message:"Unsupported traits kind=%1."},PrototypeTypeError:{code:1049,message:"Prototype objects must be vanilla Objects."},ConvertToPrimitiveError:{code:1050,message:"Cannot convert %1 to primitive."},InvalidURIError:{code:1052,message:"Invalid URI passed to %1 function."},WriteSealedError:{code:1056,message:"Cannot create property %1 on %2."},WrongArgumentCountError:{code:1063,message:"Argument count mismatch on %1. Expected %2, got %3."},UndefinedVarError:{code:1065,message:"Variable %1 is not defined."},ReadSealedError:{code:1069,message:"Property %1 not found on %2 and there is no default value."},ConstWriteError:{code:1074,message:"Illegal write to read-only property %1 on %2."},XMLPrefixNotBound:{code:1083,message:'The prefix "%1" for element "%2" is not bound.'},XMLUnterminatedElementTag:{code:1085,message:'The element type "%1" must be terminated by the matching end-tag "</%2>".'},XMLOnlyWorksWithOneItemLists:{code:1086,message:"The %1 method only works on lists containing one item."},XMLAssignmentToIndexedXMLNotAllowed:{code:1087,message:"Assignment to indexed XML is not allowed."},XMLMarkupMustBeWellFormed:{code:1088,message:"The markup in the document following the root element must be well-formed."},XMLAssigmentOneItemLists:{code:1089,message:"Assignment to lists with more than one item is not supported."},XMLMalformedElement:{code:1090,message:"XML parser failure: element is malformed."},XMLUnterminatedCData:{code:1091,message:"XML parser failure: Unterminated CDATA section."},XMLUnterminatedXMLDecl:{code:1092,message:"XML parser failure: Unterminated XML declaration."},XMLUnterminatedDocTypeDecl:{code:1093,message:"XML parser failure: Unterminated DOCTYPE declaration."},XMLUnterminatedComment:{code:1094,message:"XML parser failure: Unterminated comment."},XMLUnterminatedElement:{code:1096,message:"XML parser failure: Unterminated element."},XMLNamespaceWithPrefixAndNoURI:{code:1098,message:"Illegal prefix %1 for no namespace."},RegExpFlagsArgumentError:{code:1100,message:"Cannot supply flags when constructing one RegExp from another."},InvalidBaseClassError:{code:1108,message:"The OP_newclass opcode was used with the incorrect base class."},XMLInvalidName:{code:1117,message:"Invalid XML name: %1."},XMLIllegalCyclicalLoop:{code:1118,message:"Illegal cyclical loop between nodes."},FilterError:{code:1123,message:"Filter operator not supported on type %1."},OutOfRangeError:{code:1125,message:"The index %1 is out of range %2."},VectorFixedError:{code:1126,message:"Cannot change the length of a fixed Vector."},TypeAppOfNonParamType:{code:1127,message:"Type application attempted on a non-parameterized type."},WrongTypeArgCountError:{code:1128,message:"Incorrect number of type parameters for %1. Expected %2, got %3."},JSONCyclicStructure:{code:1129,message:"Cyclic structure cannot be converted to JSON string."},JSONInvalidReplacer:{code:1131,message:"Replacer argument to JSON stringifier must be an array or a two parameter function."},JSONInvalidParseInput:{code:1132,message:"Invalid JSON parse input."},InvalidRangeError:{code:1506,message:"The specified range is invalid."},NullArgumentError:{code:1507,message:"Argument %1 cannot be null."},InvalidArgumentError:{code:1508,message:"The value specified for argument %1 is invalid."},ArrayFilterNonNullObjectError:{code:1510,message:"When the callback argument is a method of a class, the optional this argument must be null."},InvalidParamError:{code:2004,message:"One of the parameters is invalid."},ParamRangeError:{code:2006,message:"The supplied index is out of bounds."},NullPointerError:{code:2007,message:"Parameter %1 must be non-null."},InvalidEnumError:{code:2008,message:"Parameter %1 must be one of the accepted values."},CantInstantiateError:{code:2012,message:"%1 class cannot be instantiated."},InvalidBitmapData:{code:2015,message:"Invalid BitmapData."},EOFError:{code:2030,message:"End of file was encountered.",fqn:"flash.errors.EOFError"},CompressedDataError:{code:2058,message:"There was an error decompressing the data.",fqn:"flash.errors.IOError"},EmptyStringError:{code:2085,message:"Parameter %1 must be non-empty string."},ProxyGetPropertyError:{code:2088,message:"The Proxy class does not implement getProperty. It must be overridden by a subclass."},ProxySetPropertyError:{code:2089,message:"The Proxy class does not implement setProperty. It must be overridden by a subclass."},ProxyCallPropertyError:{code:2090,message:"The Proxy class does not implement callProperty. It must be overridden by a subclass."},ProxyHasPropertyError:{code:2091,message:"The Proxy class does not implement hasProperty. It must be overridden by a subclass."},ProxyDeletePropertyError:{code:2092,message:"The Proxy class does not implement deleteProperty. It must be overridden by a subclass."},ProxyGetDescendantsError:{code:2093,message:"The Proxy class does not implement getDescendants. It must be overridden by a subclass."},ProxyNextNameIndexError:{code:2105,message:"The Proxy class does not implement nextNameIndex. It must be overridden by a subclass."},ProxyNextNameError:{code:2106,message:"The Proxy class does not implement nextName. It must be overridden by a subclass."},ProxyNextValueError:{code:2107,message:"The Proxy class does not implement nextValue. It must be overridden by a subclass."},TooFewArgumentsError:{code:2001,message:"Too few arguments were specified; got %1, %2 expected."},ParamTypeError:{code:2005,message:"Parameter %1 is of the incorrect type. Should be type %2."},SocketConnectError:{code:2011,message:"Socket connection failed to %1:%2."},CantAddSelfError:{code:2024,message:"An object cannot be added as a child of itself."},NotAChildError:{code:2025,message:"The supplied DisplayObject must be a child of the caller."},UnhandledError:{code:2044,message:"Unhandled %1:."},AllowDomainArgumentError:{code:2052,message:"Only String arguments are permitted for allowDomain and allowInsecureDomain."},DelayRangeError:{code:2066,message:"The Timer delay specified is out of range."},ExternalInterfaceNotAvailableError:{code:2067,message:"The ExternalInterface is not available in this container. ExternalInterface requires Internet Explorer ActiveX, Firefox, Mozilla 1.7.5 and greater, or other browsers that support NPRuntime."},InvalidLoaderMethodError:{code:2069,message:"The Loader class does not implement this method."},InvalidStageMethodError:{code:2071,message:"The Stage class does not implement this property or method."},TimelineObjectNameSealedError:{code:2078,message:"The name property of a Timeline-placed object cannot be modified."},AlreadyConnectedError:{code:2082,message:"Connect failed because the object is already connected."},CloseNotConnectedError:{code:2083,message:"Close failed because the object is not connected."},ArgumentSizeError:{code:2084,message:"The AMF encoding of the arguments cannot exceed 40K."},AsyncError:{code:2095,message:"%1 was unable to invoke callback %2."},LoadingObjectNotSWFError:{code:2098,message:"The loading object is not a .swf file, you cannot request SWF properties from it."},LoadingObjectNotInitializedError:{code:2099,message:"The loading object is not sufficiently loaded to provide this information."},DecodeParamError:{code:2101,message:"The String passed to URLVariables.decode() must be a URL-encoded query string containing name/value pairs."},SceneNotFoundError:{code:2108,message:"Scene %1 was not found."},FrameLabelNotFoundError:{code:2109,message:"Frame label %1 not found in scene %2."},InvalidLoaderInfoMethodError:{code:2118,message:"The LoaderInfo class does not implement this method."},SecuritySwfNotAllowedError:{code:2121,message:"Security sandbox violation: %1: %2 cannot access %3. This may be worked around by calling Security.allowDomain."},UnknownFileTypeError:{code:2124,message:"Loaded file is an unknown type."},DefinitionNotFoundError:{code:2131,message:"Definition %1 cannot be found."},CantAddParentError:{code:2150,message:"An object cannot be added as a child to one of it's children (or children's children, etc.)."},Matrix3DRefCannontBeShared:{code:2189,message:"A Matrix3D can not be assigned to more than one DisplayObject."},ObjectWithStringsParamError:{code:2196,message:"Parameter %1 must be an Object with only String values."},AllowCodeImportError:{code:3226,message:"Cannot import a SWF file when LoaderContext.allowCodeImport is false."},PermissionDenied:{code:3315,message:"The current security context does not allow this operation."},InternalErrorIV:{code:3343,message:"Internal Error."}};for(var fb in db){var _b=db[fb];_b.typeName=fb,db[_b.code]=_b}function mb(t){var e="Error #"+t,i=db[t];return e+": "+(i&&i.message||"(unknown)")}function gb(t){return db[t]}function yb(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=t.message;return e.forEach((function(t,e){n=n.replace("%"+(e+1),t)})),"Error #"+t.code+": "+n}function Ab(t,e,i){e&&e.axApply||t.throwError("TypeError",db.CallOfNonFunctionError,e&&e.methodInfo?e.methodInfo.getName():"value"),e.methodInfo&&i<e.methodInfo.minArgs&&t.throwError("ArgumentError",db.WrongArgumentCountError,e.methodInfo.getName(),e.methodInfo.minArgs,i)}function vb(t,e,i){if(!e||!e.axConstruct){var n=e&&e.classInfo?e.classInfo.instanceInfo.getName().name:"value";t.throwError("TypeError",db.ConstructOfNonFunctionError,n)}var r=e.classInfo.getInitializer();i<r.minArgs&&t.throwError("ArgumentError",db.WrongArgumentCountError,e.classInfo.instanceInfo.getName().name,r.minArgs,i)}var bb=function(){function t(){}return t.classInitializer=function(){var e=this.dPrototype,i=t.prototype;Wv(e,"$BghasOwnProperty",i.native_hasOwnProperty),Wv(e,"$BgpropertyIsEnumerable",i.native_propertyIsEnumerable),Wv(e,"$BgsetPropertyIsEnumerable",i.native_setPropertyIsEnumerable),Wv(e,"$BgisPrototypeOf",i.native_isPrototypeOf),Wv(e,"$BgtoLocaleString",i.toString)},t._init=function(){},t.init=function(){},t.prototype.native_isPrototypeOf=function(t){return this.isPrototypeOf(this.sec.box(t))},t.prototype.native_hasOwnProperty=function(t){return this.axHasOwnProperty(ub(t))},t.prototype.native_propertyIsEnumerable=function(t){var e=Object.getOwnPropertyDescriptor(this,cb(Yv(t)));return!!e&&e.enumerable},t.prototype.native_setPropertyIsEnumerable=function(t,e){void 0===e&&(e=!0);var i=cb(Yv(t));e=!!e;var n,r=this.axClass.classInfo.instanceInfo;(r.isSealed()&&this!==this.axClass.dPrototype&&this.sec.throwError("ReferenceError",db.WriteSealedError,t,r.name.name),(n=Object.getOwnPropertyDescriptor(this.axClass.tPrototype,i))&&this!==this.axClass.dPrototype)||(n=Object.getOwnPropertyDescriptor(this,i))&&n.enumerable!==e&&(n.enumerable=e,Object.defineProperty(this,i,n))},t.prototype.axResolveMultiname=function(t){if(t.numeric)return t.numericValue;var e=t.name;if(t.mutable)return(n=this.traits.getTrait(t.namespaces,e))?n.name.getMangledName():"$Bg"+e;var i=t.resolved[this.axClassName];if(i)return i;var n,r=(n=this.traits.getTraitMultiname(t))?n.name.getMangledName():"$Bg"+e;return t.resolved[this.axClassName]=r,r},t.prototype.axHasProperty=function(t){return this.axHasPropertyInternal(t)},t.prototype.axHasPublicProperty=function(t){pb.set(t);var e=this.axHasProperty(pb);return pb.drop(),e},t.prototype.axSetProperty=function(t,e,i){var n=t.name;if("number"==typeof n||zh(n=hb(n)))this[+n]=e;else{var r=!1,o=this.traits.getTrait(t.namespaces,n);if(o){var s=o.name.getMangledName();switch(o.kind){case 1:this.sec.throwError("ReferenceError",db.CannotAssignToMethodError,n,this.axClass.name.name);case 2:this.sec.throwError("ReferenceError",db.ConstWriteError,n,this.axClass.name.name);case 4:case 6:104!==i&&this.sec.throwError("ReferenceError",db.ConstWriteError,n,this.axClass.name.name),r=!0}var a=o.getType();a&&(e=a.axCoerce(e))}else s="$Bg"+n;e&&e._children&&1==e._children.length&&e._children[0]._value&&(e=parseInt(e._children[0]._value)),this[s]=e,r&&Object.defineProperty(this,s,{writable:!1})}},t.prototype.axGetProperty=function(t){var e=this.axResolveMultiname(t),i=this[e];return"function"==typeof i?this.axGetMethod(e):(void 0===i&&"number"!=typeof e&&(i=this[e.replace("$Bg","")]),i)},t.prototype.axGetMethod=function(t){var e=this._methodClosureCache;e||(Object.defineProperty(this,"_methodClosureCache",{value:Object.create(null)}),e=this._methodClosureCache);var i=e[t];return i||(i=e[t]=this.sec.AXMethodClosure.Create(this,this[t])),i},t.prototype.axGetSuper=function(t,e){var i,n=hb(t.name),r=t.namespaces,o=e.parent.object.tPrototype.traits.getTrait(r,n);if(2===o.kind||7===o.kind)i=o.get.call(this);else{var s=o.name.getMangledName(),a=e.parent.object.tPrototype[s];if(a)return this.sec.AXMethodClosure.Create(this,a)}return i},t.prototype.axSetSuper=function(t,e,i){var n=hb(t.name),r=t.namespaces,o=e.parent.object.tPrototype.traits.getTrait(r,n),s=o.getType();s&&(i=s.axCoerce(i)),3===o.kind||7===o.kind?o.set.call(this,i):this[o.name.getMangledName()]=i},t.prototype.axDeleteProperty=function(t){var e=hb(t.name),i=t.namespaces;return!this.traits.getTrait(i,e)&&delete this[t.getPublicMangledName()]},t.prototype.axCallProperty=function(t,e,i){var n=this[this.axResolveMultiname(t)];return Ab(this.sec,n,e.length),n.axApply(i?null:this,e)},t.prototype.axCallSuper=function(t,e,i){var n=e.parent.object.tPrototype[this.axResolveMultiname(t)];return Ab(this.sec,n,i.length),n.axApply(this,i)},t.prototype.axConstructProperty=function(t,e){var i=this[this.axResolveMultiname(t)];return vb(this.sec,i,e.length),i.axConstruct(e)},t.prototype.axHasPropertyInternal=function(t){return this.axResolveMultiname(t)in this},t.prototype.axHasOwnProperty=function(t){var e=this.axResolveMultiname(t);return this.hasOwnProperty(e)||this.axClass.tPrototype.hasOwnProperty(e)},t.prototype.axGetEnumerableKeys=function(){if(this.sec.isPrimitive(this))return[];for(var t=Object.getPrototypeOf(this),e=Object.keys(this),i=[],n=0;n<e.length;n++){var r=e[n];if(zh(r))i.push(r);else{if(t.hasOwnProperty(r))continue;var o=Kv.stripPublicMangledName(r);void 0!==o&&i.push(o)}}return i},t.prototype.axGetPublicProperty=function(t){return this[Kv.getPublicMangledName(t)]},t.prototype.axSetPublicProperty=function(t,e){this[Kv.getPublicMangledName(t)]=e},t.prototype.axCallPublicProperty=function(t,e){return this[Kv.getPublicMangledName(t)].axApply(this,e)},t.prototype.axDeletePublicProperty=function(t){return delete this[Kv.getPublicMangledName(t)]},t.prototype.axGetSlot=function(t){return this[this.traits.getSlot(t).name.getMangledName()]},t.prototype.axSetSlot=function(t,e){var i=this.traits.getSlot(t),n=i.name.getMangledName(),r=i.getType();this[n]=r?r.axCoerce(e):e},t.prototype.axNextNameIndex=function(t){0===t&&mf(this,"axEnumerableKeys",this.axGetEnumerableKeys()),pb.drop();for(var e=this.axEnumerableKeys;t<e.length;){var i=e[t];if(pb.set(i),this.axHasPropertyInternal(pb))return t+1;t++}return 0},t.prototype.axNextName=function(t){return this.axEnumerableKeys[t-1]},t.prototype.axNextValue=function(t){return this.axGetPublicProperty(this.axNextName(t))},t.prototype.axSetNumericProperty=function(t,e){this.axSetPublicProperty(t,e)},t.prototype.axGetNumericProperty=function(t){return this.axGetPublicProperty(t)},t.forceNativeConstructor=!1,t.forceNativeMethods=!1,t.classSymbols=null,t.instanceSymbols=null,t}(),xb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.axCoerce=function(t){return t},Object.defineProperty(e.prototype,"prototype",{get:function(){return this.dPrototype},enumerable:!0,configurable:!0}),e.classInitializer=null,e}(bb),Cb=[];function wb(t,e,i){if(e&&"object"==typeof e)return e;var n=t.box(e);return n||(Cb.length?n=Cb[Cb.length-1].topScope().global.object:i.receiver&&(n=i.receiver.scope.global.object)),n}function Ib(t){if(!t||!t.sec)throw new TypeError("Conversion to Array failed");return t.sec.AXArray.axCoerce(t)}function Eb(t,e){if(1===e.length&&"number"==typeof e[0]){var i=e[0];try{return new Array(i)}catch(e){t.throwError("RangeError",db.ArrayIndexNotIntegerError,i)}}return Array.apply(Array,e)}function Sb(t,e){return String(t).localeCompare(String(e))}function Db(t,e,i,n,r){return 1&i&&(t=String(t).toLowerCase(),e=String(e).toLowerCase()),(16&i?(t=+t)<(e=+e)?-1:t>e?1:0:r(t,e))*n}function Tb(t,e,i,n){var r,o=0;for(r=0;r<i.length&&0===o;r++){var s=i[r],a=t[s],l=e[s],u=n[r];1&u&&(a=String(a).toLowerCase(),l=String(l).toLowerCase()),o=16&u?(a=+a)<(l=+l)?-1:a>l?1:0:String(a).localeCompare(String(l))}return 2&n[r-1]&&(o*=-1),o}var Pb,Bb=function(t){function e(){var e=t.call(this)||this;return e.value=Eb(e.sec,arguments),e}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;mf(this,"$BgCASEINSENSITIVE",1),mf(this,"$BgDESCENDING",2),mf(this,"$BgUNIQUESORT",4),mf(this,"$BgRETURNINDEXEDARRAY",8),mf(this,"$BgNUMERIC",16),Wv(t,"$Bgpush",i.generic_push),Wv(t,"$Bgpop",i.generic_pop),Wv(t,"$Bgshift",i.generic_shift),Wv(t,"$Bgunshift",i.generic_unshift),Wv(t,"$Bgreverse",i.generic_reverse),Wv(t,"$Bgconcat",i.generic_concat),Wv(t,"$Bgslice",i.generic_slice),Wv(t,"$Bgsplice",i.generic_splice),Wv(t,"$Bgjoin",i.generic_join),Wv(t,"$BgtoString",i.generic_toString),Wv(t,"$BgindexOf",i.generic_indexOf),Wv(t,"$BglastIndexOf",i.generic_lastIndexOf),Wv(t,"$Bgevery",i.generic_every),Wv(t,"$Bgsome",i.generic_some),Wv(t,"$BgforEach",i.generic_forEach),Wv(t,"$Bgmap",i.generic_map),Wv(t,"$Bgfilter",i.generic_filter),Wv(t,"$Bgsort",i.generic_sort),Wv(t,"$BgsortOn",i.generic_sortOn),Wv(t,"$BghasOwnProperty",i.native_hasOwnProperty),Wv(t,"$BgpropertyIsEnumerable",i.native_propertyIsEnumerable),Wv(t,"$BgtoLocaleString",i.generic_toString)},e.prototype.native_hasOwnProperty=function(t){return this.axHasOwnProperty(ub(t))},e.prototype.native_propertyIsEnumerable=function(e){if("number"==typeof e||zh(e=hb(e))){var i=Object.getOwnPropertyDescriptor(this.value,e);return!!i&&i.enumerable}t.prototype.native_propertyIsEnumerable.call(this,e)},e.axApply=function(t,e){return this.sec.createArrayUnsafe(Eb(this.sec,e))},e.axConstruct=function(t){return this.sec.createArrayUnsafe(Eb(this.sec,t))},e.prototype.push=function(){if(this.value.length+arguments.length>4294967295){for(var t=4294967295-this.value.length,e=0;e<t;e++)this.value.push(arguments[e]);return 4294967295}return this.value.push.apply(this.value,arguments)},e.prototype.generic_push=function(){if(this&&this.value instanceof Array)return this.push.apply(this,arguments);for(var t=this.axGetPublicProperty("length")>>>0,e=0;e<arguments.length;e++)this.axSetNumericProperty(t++,arguments[e]);return this.axSetPublicProperty("length",t),t},e.prototype.pop=function(){return this.value.pop()},e.prototype.generic_pop=function(){if(this&&this.value instanceof Array)return this.value.pop();var t=this.axGetPublicProperty("length")>>>0;if(t){var e=this.axGetNumericProperty(t-1);return pb.name=t-1,pb.namespaces=[Hv.PUBLIC],this.axDeleteProperty(pb),this.axSetPublicProperty("length",t-1),e}this.axSetPublicProperty("length",0)},e.prototype.shift=function(){return this.value.shift()},e.prototype.generic_shift=function(){return Ib(this).shift()},e.prototype.unshift=function(){return this.value.unshift.apply(this.value,arguments)},e.prototype.generic_unshift=function(){var t=Ib(this);return t.value.unshift.apply(t.value,arguments)},e.prototype.reverse=function(){return this.value.reverse(),this},e.prototype.generic_reverse=function(){return Ib(this).reverse()},e.prototype.concat=function(){for(var t=this.value.slice(),e=0;e<arguments.length;e++){var i=arguments[e];"object"==typeof i&&i&&i.sec&&Array.isArray(i.value)?t.push.apply(t,i.value):t.push(i)}return this.sec.createArrayUnsafe(t)},e.prototype.generic_concat=function(){return Ib(this).concat.apply(this,arguments)},e.prototype.slice=function(t,e){return this.sec.createArray(this.value.slice(t,e))},e.prototype.generic_slice=function(t,e){return Ib(this).slice(t,e)},e.prototype.splice=function(){var t=this.value;if(0!==arguments.length)return this.sec.createArray(t.splice.apply(t,arguments))},e.prototype.generic_splice=function(){return Ib(this).splice.apply(this,arguments)},e.prototype.join=function(t){return this.value.join(t)},e.prototype.generic_join=function(t){return Ib(this).join(t)},e.prototype.toString=function(){return this.value.join(",")},e.prototype.generic_toString=function(){return Ib(this).join(",")},e.prototype.indexOf=function(t,e){return this.value.indexOf(t,0|e)},e.prototype.generic_indexOf=function(t,e){return Ib(this).indexOf(t,0|e)},e.prototype.lastIndexOf=function(t,e){return this.value.lastIndexOf(t,arguments.length>1?e:2147483647)},e.prototype.generic_lastIndexOf=function(t,e){return Ib(this).lastIndexOf(t,arguments.length>1?e:2147483647)},e.prototype.every=function(t,e){if(!t||!t.value||"function"!=typeof t.value)return!0;e=wb(this.sec,e,t);for(var i=this.value,n=0;n<i.length;n++)if(!0!==t.value.call(e,i[n],n,this))return!1;return!0},e.prototype.generic_every=function(t,e){return Ib(this).every(t,e)},e.prototype.some=function(t,e){if(!t||!t.value||"function"!=typeof t.value)return!1;e=wb(this.sec,e,t);var i=this;return this.value.some((function(n,r,o){return t.value.call(e,n,r,i)}))},e.prototype.generic_some=function(t,e){return Ib(this).some(t,e)},e.prototype.forEach=function(t,e){if(t&&t.value&&"function"==typeof t.value){e=wb(this.sec,e,t);var i=this;this.value.forEach((function(n,r){t.value.call(e,n,r,i)}))}},e.prototype.generic_forEach=function(t,e){return Ib(this).forEach(t,e)},e.prototype.map=function(t,e){if(!t||!t.value||"function"!=typeof t.value)return this.sec.createArrayUnsafe([]);e=wb(this.sec,e,t);var i=this;return this.sec.createArrayUnsafe(this.value.map((function(n,r){return t.value.call(e,n,r,i)})))},e.prototype.generic_map=function(t,e){return Ib(this).map(t,e)},e.prototype.filter=function(t,e){if(!t||!t.value||"function"!=typeof t.value)return this.sec.createArrayUnsafe([]);e=wb(this.sec,e,t);for(var i=[],n=this.value,r=0;r<n.length;r++)!0===t.value.call(e,n[r],r,this)&&i.push(n[r]);return this.sec.createArrayUnsafe(i)},e.prototype.generic_filter=function(t,e){return Ib(this).filter(t,e)},e.prototype.toLocaleString=function(){for(var t=this.sec.AXArray.axCoerce(this).value,e="",i=0,n=t.length;i<n;i++){var r=t[i];null!=r&&(e+=r.toLocaleString()),i+1<n&&(e+=",")}return e},e.prototype.sort=function(){var t,e=this.value;if(0===arguments.length)return e.sort(),this;var i=0;if(this.sec.AXFunction.axIsInstanceOf(arguments[0])?t=arguments[0].value:Uh(arguments[0])&&(i=arguments[0]),Uh(arguments[1])&&(i=arguments[1]),!i)return e.sort(t),this;t||(t=Sb);var n=2&i?-1:1;return e.sort((function(e,r){return Db(e,r,i,n,t)})),this},e.prototype.generic_sort=function(){return Ib(this).sort.apply(this,arguments)},e.prototype.sortOn=function(t,e){0===arguments.length&&this.sec.throwError("ArgumentError",db.WrongArgumentCountError,"Array/http://adobe.com/AS3/2006/builtin::sortOn()","1","0");var i=this.value,n=[];if(Vh(t))t=[Kv.getPublicMangledName(t)],n=[0|e];else{if(!t||!Array.isArray(t.value))return this;t=t.value;for(var r=0;r<t.length;r++)t[r]=Kv.getPublicMangledName(t[r]);if(e&&Array.isArray(e.value))if((e=e.value).length===t.length)for(r=0;r<e.length;r++)n[r]=0|e[r];else for(r=0;r<t.length;r++)n[r]=0;else{var o=0|e;for(r=0;r<t.length;r++)n[r]=o}}o=n[0];return i.sort((function(e,i){return Tb(e,i,t,n)})),this},e.prototype.generic_sortOn=function(){return Ib(this).sortOn.apply(this,arguments)},Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length},set:function(t){this.value.length=t>>>0},enumerable:!0,configurable:!0}),e.prototype.axGetEnumerableKeys=function(){return Object.keys(this.value).concat(t.prototype.axGetEnumerableKeys.call(this))},e.prototype.axHasPropertyInternal=function(t){var e=t.name;return"number"==typeof e||zh(e=hb(e))?e in this.value:!!this.traits.getTrait(t.namespaces,e)||"$Bg"+e in this},e.prototype.axHasOwnProperty=function(t){var e=t.name;return"number"==typeof e||zh(e=hb(e))?this.value.hasOwnProperty(e):!!this.traits.getTrait(t.namespaces,e)||this.hasOwnProperty("$Bg"+e)},e.prototype.axGetProperty=function(e){var i,n=e.name;return"number"==typeof n||zh(n=hb(n))?null!=(i=this.value[n])?i:this[n]:t.prototype.axGetProperty.call(this,e)},e.prototype.axSetProperty=function(e,i,n){var r=e.name;"number"==typeof r||zh(r=hb(r))?this.value[r]=i:t.prototype.axSetProperty.call(this,e,i,n)},e.prototype.axDeleteProperty=function(t){var e=t.name;return"number"==typeof e||zh(e=hb(e))?delete this.value[e]:!this.traits.getTrait(t.namespaces,e)&&delete this["$Bg"+e]},e.prototype.axGetPublicProperty=function(t){return"number"==typeof t||zh(t=hb(t))?this.value[t]:this["$Bg"+t]},e.prototype.axSetPublicProperty=function(t,e){"number"==typeof t||zh(t=hb(t))?this.value[t]=e:this["$Bg"+t]=e},e}(bb),Mb=function(t){function e(e,i){var n=t.call(this)||this;return arguments.length<1&&(e=""),n.$Bgmessage=String(e),n._errorID=0|i,n}return i(e,t),e.throwError=function(t,e){for(var i=gb(e),n=[i],r=2;r<arguments.length;r++)n.push(arguments[r]);var o=yb.apply(null,n);throw t.axConstruct([o,e])},e.classInitializer=function(t){mf(this,"$Bglength",1),mf(this.dPrototype,"$Bgname",this.classInfo.instanceInfo.getName().name),t===e&&(mf(this.dPrototype,"$Bgmessage","Error"),mf(this.dPrototype,"$BgtoString",e.prototype.toString))},e.prototype.toString=function(){return""!==this.$Bgmessage?this.$Bgname+": "+this.$Bgmessage:this.$Bgname},Object.defineProperty(e.prototype,"errorID",{get:function(){return this._errorID},enumerable:!0,configurable:!0}),e.prototype.getStackTrace=function(){return null},e.getErrorMessage=mb,e}(bb),Ob=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Lb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Rb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Nb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Fb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),kb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Vb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Ub=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),jb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Gb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Qb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),zb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Hb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),Xb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb),qb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Mb);!function(t){t[t.None=0]="None",t[t.Runtime=1]="Runtime",t[t.Execution=2]="Execution",t[t.Interpreter=4]="Interpreter"}(Pb||(Pb={}));new Yh(!1,(function(t){var e;e=t,"undefined"!=typeof dump&&dump(e+"\n")}));function Yb(t,e){return Array.prototype.slice.call(t,e)}var Kb=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._prototypeInitialzed=!1,e}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;Wv(t,"$BgtoString",i.toString),Wv(t,"$Bgcall",i.call),Wv(t,"$Bgapply",i.apply),mf(t,"value",i.native_functionValue)},e.prototype.setReceiver=function(t){this.receiver=t},e.prototype.axConstruct=function(t){var e=this.prototype;mo(e)&&(e=this.sec.AXFunctionUndefinedPrototype);var i=Object.create(e);return i.__ctorFunction=this,this.value.apply(i,t),i},e.prototype.axIsInstanceOf=function(t){return t&&t.__ctorFunction===this},e.prototype.native_functionValue=function(){},Object.defineProperty(e.prototype,"prototype",{get:function(){return this._prototypeInitialzed||(this._prototype=Object.create(this.sec.AXObject.tPrototype),this._prototypeInitialzed=!0),this._prototype},set:function(t){mo(t)?t=void 0:("object"!=typeof t||this.sec.isPrimitive(t))&&this.sec.throwError("TypeError",db.PrototypeTypeError),this._prototypeInitialzed=!0,this._prototype=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.value.methodInfo?this.value.methodInfo.parameters.length:this.value.length},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return"function Function() {}"},e.prototype.call=function(t){return t=wb(this.sec,t,this),this.value.apply(t,Yb(arguments,1))},e.prototype.apply=function(t,e){return t=wb(this.sec,t,this),this.value.apply(t,e?e.value:void 0)},e.prototype.axCall=function(t){return this.value.apply(t,Yb(arguments,1))},e.prototype.axApply=function(t,e){return this.value.apply(t,e)},e}(bb),Wb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;mf(t,"$Bgcall",i.call),mf(t,"$Bgapply",i.apply)},e.Create=function(t,e){var i=Object.create(this.sec.AXMethodClosure.tPrototype);return i.receiver=t,i.value=e,i.methodInfo=e.methodInfo,i.axCall=i.call,i.axApply=i.apply,i},Object.defineProperty(e.prototype,"prototype",{get:function(){return null},set:function(t){this.sec.throwError("ReferenceError",db.ConstWriteError,"prototype","MethodClosure")},enumerable:!0,configurable:!0}),e.prototype.axCall=function(t){return this.value.apply(this.receiver,Yb(arguments,1))},e.prototype.axApply=function(t,e){return this.value.apply(this.receiver,e)},e.prototype.call=function(t){var e=arguments,i=e.length;return i<=6?this.value.call(this.receiver,e[1],e[2],e[3],e[4],e[5]):this.value.apply(this.receiver,Yb(arguments,1))},e.prototype.apply=function(t,e){return this.value.apply(this.receiver,e&&e.value?e.value:e)},e}(Kb),Jb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;Wv(t,"$BgtoString",i.toString),Wv(t,"$BgtoLocaleString",i.toString),Wv(t,"$BgvalueOf",i.valueOf),Wv(t,"$BgtoFixed",i.toFixed),Wv(t,"$BgtoExponential",i.toExponential),Wv(t,"$BgtoPrecision",i.toPrecision),mf(this,"$BgNaN",Number.NaN),mf(this,"$BgNEGATIVE_INFINITY",-1/0),mf(this,"$BgPOSITIVE_INFINITY",1/0),mf(this,"$BgMAX_VALUE",Number.MAX_VALUE),mf(this,"$BgMIN_VALUE",Number.MIN_VALUE),mf(this,"$BgE",Math.E),mf(this,"$BgLN10",Math.LN10),mf(this,"$BgLN2",Math.LN2),mf(this,"$BgLOG10E",Math.LOG10E),mf(this,"$BgLOG2E",Math.LOG2E),mf(this,"$BgPI",Math.PI),mf(this,"$BgSQRT1_2",Math.SQRT2),mf(this,"$BgSQRT2",Math.SQRT2)},e.prototype.toString=function(t){return 0===arguments.length?t=10:((t|=0)<2||t>36)&&this.sec.throwError("RangeError",db.InvalidRadixError,t),this.axClass!==this.sec.AXNumber&&this.sec.throwError("TypeError",db.InvokeOnIncompatibleObjectError,"Number.prototype.toString"),this.value.toString(t)},e.prototype.valueOf=function(){return this.axClass!==this.sec.AXNumber&&this.sec.throwError("TypeError",db.InvokeOnIncompatibleObjectError,"Number.prototype.valueOf"),this.value},e.prototype.toExponential=function(t){return((t|=0)<0||t>20)&&this.sec.throwError("RangeError",db.InvalidPrecisionError),this.axClass!==this.sec.AXNumber?"NaN":this.value.toExponential(t)},e.prototype.toPrecision=function(t){return t?t|=0:t=1,(t<1||t>21)&&this.sec.throwError("RangeError",db.InvalidPrecisionError),this.axClass!==this.sec.AXNumber?"NaN":this.value.toPrecision(t)},e.prototype.toFixed=function(t){return((t|=0)<0||t>20)&&this.sec.throwError("RangeError",db.InvalidPrecisionError),this.axClass!==this.sec.AXNumber?"NaN":this.value.toFixed(t)},e._minValue=function(){return Number.MIN_VALUE},e.convertStringToDouble=function(t){var e=t.indexOf(String.fromCharCode(0));return e>=0?+t.substring(0,e):+t},e.classNatives=[Math],e}(bb),Zb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;Wv(t,"$BgtoString",i.toString),Wv(t,"$BgtoLocaleString",i.toString),Wv(t,"$BgvalueOf",i.valueOf),mf(this,"$BgMAX_VALUE",2147483647),mf(this,"$BgMIN_VALUE",-2147483648)},e.prototype.toString=function(t){return 0===arguments.length?t=10:((t|=0)<2||t>36)&&this.sec.throwError("RangeError",db.InvalidRadixError,t),this.axClass!==this.sec.AXNumber&&this.sec.throwError("TypeError",db.InvokeOnIncompatibleObjectError,"Number.prototype.toString"),this.value.toString(t)},e.prototype.valueOf=function(){return this.axClass!==this.sec.AXNumber&&this.sec.throwError("TypeError",db.InvokeOnIncompatibleObjectError,"Number.prototype.valueOf"),this.value},e.staticNatives=[Math],e.instanceNatives=[Jb.prototype],e}(Jb);function $b(t,e){var i=t.createArray(e);return i.axSetPublicProperty("index",e.index),i.axSetPublicProperty("input",e.input),i}function tx(t){for(var e=null,i=0;i<t.length;i++){var n=t.charCodeAt(i);n>=4256&&n<=4293&&(e||(e=new Array(t.length)),e[i]=String.fromCharCode(n+48))}if(e){for(i=0;i<e.length;i++){e[i]||(e[i]=t.charAt(i).toLocaleString())}return e.join("")}return t.toLowerCase()}var ex=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;Wv(t,"$BgindexOf",i.generic_indexOf),Wv(t,"$BglastIndexOf",i.generic_lastIndexOf),Wv(t,"$BgcharAt",i.generic_charAt),Wv(t,"$BgcharCodeAt",i.generic_charCodeAt),Wv(t,"$Bgconcat",i.generic_concat),Wv(t,"$BglocaleCompare",i.generic_localeCompare),Wv(t,"$Bgmatch",i.generic_match),Wv(t,"$Bgreplace",i.generic_replace),Wv(t,"$Bgsearch",i.generic_search),Wv(t,"$Bgslice",i.generic_slice),Wv(t,"$Bgsplit",i.generic_split),Wv(t,"$Bgsubstring",i.generic_substring),Wv(t,"$Bgsubstr",i.generic_substr),Wv(t,"$BgtoLowerCase",i.generic_toLowerCase),Wv(t,"$BgtoLocaleLowerCase",i.generic_toLowerCase),Wv(t,"$BgtoUpperCase",i.generic_toUpperCase),Wv(t,"$BgtoLocaleUpperCase",i.generic_toUpperCase),Wv(t,"$BgtoString",i.toString),Wv(t,"$BgtoString",i.public_toString),Wv(t,"$BgvalueOf",i.public_valueOf),Wv(this,"$BgfromCharCode",e.fromCharCode)},e.fromCharCode=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return String.fromCharCode.apply(null,t)},e.prototype.indexOf=function(t,e){return this.value.indexOf(t,e)},e.prototype.lastIndexOf=function(t,e){return this.value.lastIndexOf(t,e)},e.prototype.charAt=function(t){return this.value.charAt(t)},e.prototype.charCodeAt=function(t){return this.value.charCodeAt(t)},e.prototype.concat=function(){return this.value.concat.apply(this.value,arguments)},e.prototype.localeCompare=function(t){arguments.length>1&&this.sec.throwError("ArgumentError",db.WrongArgumentCountError,"Function/<anonymous>()",0,2);var e=this.value;if((t=String(t))===e)return 0;for(var i=Math.min(e.length,t.length),n=0;n<i;n++)if(e[n]!==t[n])return e.charCodeAt(n)-t.charCodeAt(n);return e.length>t.length?1:-1},e.prototype.__getRegExp=function(t){return this.sec.AXRegExp.axIsType(t)?t:this.sec.AXRegExp.axConstruct([Yv(t)])},e.prototype.match=function(t){var e=this.__getRegExp(t).internalStringMatch(this.value);if(!e)return null;try{return $b(this.sec,e)}catch(t){return null}},e.prototype.replace=function(t,e){var i=this.__getRegExp(t);this.sec.AXFunction.axIsType(e)&&(e=e.value);try{return i.internalStringReplace(this.value,e)}catch(t){return this.value}},e.prototype.search=function(t){var e=this.__getRegExp(t);try{return e.internalStringSearch(this.value)}catch(t){return-1}},e.prototype.slice=function(t,e){return t=arguments.length<1?0:0|t,e=arguments.length<2?4294967295:0|e,this.value.slice(t,e)},e.prototype.split=function(t,e){t=this.sec.AXRegExp.axIsType(t)?t.value:Yv(t),e=void 0===e?-1:0|e;try{return this.sec.createArray(this.value.split(t,e))}catch(t){return this.sec.createArrayUnsafe([this.value])}},e.prototype.substring=function(t,e){return this.value.substring(t,e)},e.prototype.substr=function(t,e){return-1==e&&(e=this.value.length-t-1),this.value.substr(t,e)},e.prototype.toLocaleLowerCase=function(){return this.value.toLowerCase()},e.prototype.toLowerCase=function(){return tx(this.value)},e.prototype.toLocaleUpperCase=function(){return this.value.toUpperCase()},e.prototype.toUpperCase=function(){return this.value.toUpperCase()},e.prototype.generic_indexOf=function(t,e){var i=null==this?"":this;return String.prototype.indexOf.call(i,t,e)},e.prototype.generic_lastIndexOf=function(t,e){var i=null==this?"":this;return String.prototype.lastIndexOf.call(i,t,e)},e.prototype.generic_charAt=function(t){var e=null==this?"":this;return String.prototype.charAt.call(e,t)},e.prototype.generic_charCodeAt=function(t){var e=null==this?"":this;return String.prototype.charCodeAt.call(e,t)},e.prototype.generic_concat=function(){var t=null==this?"":this;return String.prototype.concat.apply(t,arguments)},e.prototype.generic_localeCompare=function(t){var e=this.sec.AXString.axBox(String(this));return e.localeCompare.apply(e,arguments)},e.prototype.generic_match=function(t){return this.sec.AXString.axBox(String(this)).match(t)},e.prototype.generic_replace=function(t,e){return this.sec.AXString.axBox(String(this)).replace(t,e)},e.prototype.generic_search=function(t){return this.sec.AXString.axBox(String(this)).search(t)},e.prototype.generic_slice=function(t,e){var i=null==this?"":this;return String.prototype.slice.call(i,t,e)},e.prototype.generic_split=function(t,e){return e=arguments.length<2?4294967295:0|e,this.sec.AXString.axBox(String(this)).split(t,e)},e.prototype.generic_substring=function(t,e){var i=null==this?"":this;return String.prototype.substring.call(i,t,e)},e.prototype.generic_substr=function(t,e){var i=null==this?"":this;return String.prototype.substr.call(i,t,e)},e.prototype.generic_toLowerCase=function(){return tx(String(null==this?"":this))},e.prototype.generic_toUpperCase=function(){var t=null==this?"":this;return String.prototype.toUpperCase.call(t)},e.prototype.toString=function(){return this.value.toString()},e.prototype.public_toString=function(){return this===this.sec.AXString.dPrototype?"":(this.axClass!==this.sec.AXString&&this.sec.throwError("TypeError",db.InvokeOnIncompatibleObjectError,"String.prototype.toString"),this.value.toString())},e.prototype.valueOf=function(){return this.value.valueOf()},e.prototype.public_valueOf=function(){return this===this.sec.AXString.dPrototype?"":(this.axClass!==this.sec.AXString&&this.sec.throwError("TypeError",db.InvokeOnIncompatibleObjectError,"String.prototype.valueOf"),this.value.valueOf())},Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length},enumerable:!0,configurable:!0}),e.classNatives=[String],e}(bb),ix=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;Wv(t,"$BgtoString",i.toString),Wv(t,"$BgtoLocaleString",i.toString),Wv(t,"$BgvalueOf",i.valueOf),mf(this,"$BgMAX_VALUE",4294967295),mf(this,"$BgMIN_VALUE",0)},e.prototype.toString=function(t){return 0===arguments.length?t=10:((t|=0)<2||t>36)&&this.sec.throwError("RangeError",db.InvalidRadixError,t),this.axClass!==this.sec.AXNumber&&this.sec.throwError("TypeError",db.InvokeOnIncompatibleObjectError,"Number.prototype.toString"),this.value.toString(t)},e.prototype.valueOf=function(){return this.axClass!==this.sec.AXNumber&&this.sec.throwError("TypeError",db.InvokeOnIncompatibleObjectError,"Number.prototype.valueOf"),this.value},e.staticNatives=[Math],e.instanceNatives=[Jb.prototype],e}(Jb),nx=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;Wv(t,"$BgtoString",i.toString),Wv(t,"$BgvalueOf",i.valueOf)},e.prototype.toString=function(){return this.value.toString()},e.prototype.valueOf=function(){return this.value.valueOf()},e}(bb);function rx(t){return t&&"function"==typeof t.axApply}function ox(t){return"string"==typeof t||t&&"object"==typeof t&&"string"==typeof(t=t.valueOf())?Jb.convertStringToDouble(t):+t}var sx=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.axGetProperty=function(e){var i=e.name;return(0|(i="number"==typeof i?i:hb(i)))===i||zh(i)?this.axGetNumericProperty("number"==typeof i?i:0|i):t.prototype.axGetProperty.call(this,e)},e.prototype.axSetProperty=function(e,i,n){var r=e.name;(0|(r="number"==typeof r?r:hb(r)))===r||zh(r)?this.axSetNumericProperty("number"==typeof r?r:0|r,i):t.prototype.axSetProperty.call(this,e,i,n)},e.prototype.axGetPublicProperty=function(t){return(0|(t="number"==typeof t?t:hb(t)))===t||zh(t)?this.axGetNumericProperty("number"==typeof t?t:0|t):this["$Bg"+t]},e.prototype.axSetPublicProperty=function(t,e){(0|(t="number"==typeof t?t:hb(t)))===t||zh(t)?this.axSetNumericProperty("number"==typeof t?t:0|t,e):this["$Bg"+t]=e},e.prototype.axNextName=function(t){return t-1},e.prototype.checkVectorMethodArgs=function(t,e){if(Xh(t))return!1;var i=this.sec;return rx(t)||i.throwError("TypeError",db.CheckTypeFailedError,t,"Function"),t.axClass!==i.AXMethodClosure||Xh(e)||i.throwError("TypeError",db.ArrayFilterNonNullObjectError),!0},e}(bb),ax=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.axIsType=function(t){return this.dPrototype.isPrototypeOf(t)||this.sec.Int32Vector.axClass.dPrototype.isPrototypeOf(t)||this.sec.Uint32Vector.axClass.dPrototype.isPrototypeOf(t)||this.sec.Float64Vector.axClass.dPrototype.isPrototypeOf(t)||this.sec.ObjectVector.axClass.dPrototype.isPrototypeOf(t)},e}(bb),lx=function(t){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=!1);var n=t.call(this)||this;return e>>>=0,i=!!i,n._fixed=!!i,n._buffer=new Array(e),n._fill(0,e,n.axClass.defaultValue),n}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=this.tPrototype;i.axGetProperty=t.axGetProperty,i.axGetNumericProperty=t.axGetNumericProperty,i.axSetProperty=t.axSetProperty,i.axSetNumericProperty=t.axSetNumericProperty,i.axHasPropertyInternal=t.axHasPropertyInternal,i.axNextName=t.axNextName,i.axNextNameIndex=t.axNextNameIndex,i.axNextValue=t.axNextValue,t.axGetProperty=bb.prototype.axGetProperty,t.axGetNumericProperty=bb.prototype.axGetNumericProperty,t.axSetProperty=bb.prototype.axSetProperty,t.axSetNumericProperty=bb.prototype.axSetNumericProperty,t.axHasPropertyInternal=bb.prototype.axHasPropertyInternal,t.axNextName=bb.prototype.axNextName,t.axNextNameIndex=bb.prototype.axNextNameIndex,t.axNextValue=bb.prototype.axNextValue;var n=e.prototype;mf(t,"$Bgjoin",n.join),mf(t,"$BgtoString",n.join),mf(t,"$BgtoLocaleString",n.toLocaleString),mf(t,"$Bgpop",n.pop),mf(t,"$Bgpush",n.push),mf(t,"$Bgreverse",n.reverse),mf(t,"$Bgconcat",n.concat),mf(t,"$Bgsplice",n.splice),mf(t,"$Bgslice",n.slice),mf(t,"$Bgshift",n.shift),mf(t,"$Bgunshift",n.unshift),mf(t,"$BgindexOf",n.indexOf),mf(t,"$BglastIndexOf",n.lastIndexOf),mf(t,"$BgforEach",n.forEach),mf(t,"$Bgmap",n.map),mf(t,"$Bgfilter",n.filter),mf(t,"$Bgsome",n.some),mf(t,"$Bgevery",n.every),mf(t,"$Bgsort",n.sort),mf(t,"checkVectorMethodArgs",n.checkVectorMethodArgs)},e.axApply=function(t,e){var i=e[0];if(this.axIsType(i))return i;var n=i.axGetPublicProperty("length");if(void 0!==n){for(var r=this.axConstruct([n,!1]),o=0;o<n;o++)r.axSetNumericProperty(o,i.axGetPublicProperty(o));return r}hp()},e.defaultCompareFunction=function(t,e){return String(t).localeCompare(String(e))},e.compare=function(t,i,n,r){var o=0;return r||(r=e.defaultCompareFunction),o=n&e.NUMERIC?(t=Qh(t))<(i=Qh(i))?-1:t>i?1:0:r(t,i),n&e.DESCENDING&&(o*=-1),o},e.prototype._fill=function(t,e,i){for(var n=0;n<e;n++)this._buffer[t+n]=i},e.prototype.toString=function(){for(var t=[],e=0;e<this._buffer.length;e++){var i=this._buffer[e];t.push(null===i?"null":i+"")}return t.join(",")},e.prototype.toLocaleString=function(){for(var t=[],e=0;e<this._buffer.length;e++){var i=this._buffer[e];i&&"object"==typeof i?t.push(i.$BgtoLocaleString()):t.push(i+"")}return t.join(",")},e.prototype.sort=function(t){if(void 0===t)return this._buffer.sort(),this;if(this.sec.AXFunction.axIsType(t)){var i=t.value,n=t.receiver;return this._buffer.sort(i.bind(n)),this}var r=0|t;return r&e.NUMERIC?r&e.DESCENDING?(this._buffer.sort((function(t,e){return ox(e)-ox(t)})),this):(this._buffer.sort((function(t,e){return ox(t)-ox(e)})),this):r&e.CASEINSENSITIVE?r&e.DESCENDING?(this._buffer.sort((function(t,e){return Yv(e).toLowerCase()-Yv(t).toLowerCase()})),this):(this._buffer.sort((function(t,e){return Yv(t).toLowerCase()-Yv(e).toLowerCase()})),this):r&e.DESCENDING?(this._buffer.sort((function(t,e){return e-t})),this):(this._buffer.sort(),this)},e.prototype.every=function(t,e){if(!this.checkVectorMethodArgs(t,e))return!0;for(var i=0;i<this._buffer.length;i++)if(!t.axCall(e,this.axGetNumericProperty(i),i,this))return!1;return!0},e.prototype.filter=function(t,e){var i=this.axClass.axConstruct([0,!1]);if(!this.checkVectorMethodArgs(t,e))return i;for(var n=0;n<this._buffer.length;n++)t.call(e,this.axGetNumericProperty(n),n,this)&&i.push(this.axGetNumericProperty(n));return i},e.prototype.map=function(t,e){var i=this.axClass.axConstruct([this.length,!1]);if(!this.checkVectorMethodArgs(t,e))return i;for(var n=0;n<this._buffer.length;n++)i.push(this._coerce(t.call(e,this.axGetNumericProperty(n),n,this)));return i},e.prototype.some=function(t,e){if(!this.checkVectorMethodArgs(t,e))return!1;for(var i=0;i<this._buffer.length;i++)if(t.call(e,this.axGetNumericProperty(i),i,this))return!0;return!1},e.prototype.forEach=function(t,e){if(this.checkVectorMethodArgs(t,e))for(var i=0;i<this._buffer.length;i++)t.call(e,this.axGetNumericProperty(i),i,this)},e.prototype.join=function(t){void 0===t&&(t=",");for(var e=this._buffer,i=this._buffer.length,n="",r=0;r<i-1;r++)n+=e[r]+t;return i>0&&(n+=e[i-1]),n},e.prototype.indexOf=function(t,e){return void 0===e&&(e=0),this._buffer.indexOf(t,e)},e.prototype.lastIndexOf=function(t,e){return void 0===e&&(e=2147483647),this._buffer.lastIndexOf(t,e)},e.prototype.push=function(t,e,i,n,r,o,s,a){this._checkFixed();for(var l=0;l<arguments.length;l++)this._buffer.push(this._coerce(arguments[l]))},e.prototype.pop=function(){if(this._checkFixed(),0!==this._buffer.length)return this._buffer.pop()},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]._buffer);var i=this._buffer.concat.apply(this._buffer,t),n=this.axClass.axConstruct([]);return n._buffer=i,n},e.prototype.reverse=function(){return this._buffer.reverse(),this},e.prototype._coerce=function(t){return this.axClass.type[eb]?this.axClass.type.axCoerce(t):t},e.prototype.shift=function(){if(this._checkFixed(),0!==this._buffer.length)return this._buffer.shift()},e.prototype.unshift=function(){if(arguments.length){this._checkFixed();for(var t=0;t<arguments.length;t++)this._buffer.unshift(this._coerce(arguments[t]))}},e.prototype.slice=function(t,e){void 0===t&&(t=0),void 0===e&&(e=2147483647);var i=this._buffer,n=i.length,r=Math.min(Math.max(t,0),n),o=Math.min(Math.max(e,r),n),s=this.axClass.axConstruct([o-r,this.fixed]);return s._buffer=i.slice(r,o),s},e.prototype.splice=function(t,e){var i=this._buffer,n=i.length,r=Math.min(Math.max(t,0),n),o=Math.min(Math.max(e,0),n-r),s=arguments.length-2;o!==s&&this._checkFixed();for(var a=[r,o],l=2;l<s+2;l++)a[l]=this._coerce(arguments[l]);var u=this.axClass.axConstruct([o,this.fixed]);return u._buffer=i.splice.apply(i,a),u},Object.defineProperty(e.prototype,"length",{get:function(){return this._buffer.length},set:function(t){if((t>>>=0)>this._buffer.length)for(var e=this._buffer.length;e<t;e++)this._buffer[e]=this.axClass.defaultValue;else this._buffer.length=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fixed",{get:function(){return this._fixed},set:function(t){this._fixed=!!t},enumerable:!0,configurable:!0}),e.prototype._checkFixed=function(){this._fixed&&this.sec.throwError("RangeError",db.VectorFixedError)},e.prototype.axGetNumericProperty=function(t){var e=0|t;return(e<0||e>=this._buffer.length||e!=t)&&this.sec.throwError("RangeError",db.OutOfRangeError,t,this._buffer.length),this._buffer[e]},e.prototype.axSetNumericProperty=function(t,e){var i=this._buffer.length,n=0|t;(n<0||n>i||n!=t||n===i&&this._fixed)&&this.sec.throwError("RangeError",db.OutOfRangeError,t,i),this._buffer[n]=this._coerce(e)},e.prototype.axHasPropertyInternal=function(t){if((0|t.name)===t.name)return t.name>=0&&t.name<this._buffer.length;var e=hb(t.name);if(t.isRuntimeName()&&Hh(e)){var i=e>>>0;return i>=0&&i<this._buffer.length}return this.axResolveMultiname(t)in this},e.prototype.axNextValue=function(t){return this._buffer[t-1]},e.prototype.axNextNameIndex=function(t){var e=t+1;return e<=this._buffer.length?e:0},e.CASEINSENSITIVE=1,e.DESCENDING=2,e.UNIQUESORT=4,e.RETURNINDEXEDARRAY=8,e.NUMERIC=16,e.defaultValue=null,e}(sx),ux=function(t){function e(i,n){void 0===i&&(i=0),void 0===n&&(n=!1);var r=t.call(this)||this;return i>>>=0,r._fixed=!!n,r._buffer=new Int32Array(Math.max(e.INITIAL_CAPACITY,i+e.EXTRA_CAPACITY)),r._offset=0,r._length=i,r}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=this.tPrototype;i.axGetProperty=t.axGetProperty,i.axGetNumericProperty=t.axGetNumericProperty,i.axSetProperty=t.axSetProperty,i.axSetNumericProperty=t.axSetNumericProperty,i.axHasPropertyInternal=t.axHasPropertyInternal,i.axNextName=t.axNextName,i.axNextNameIndex=t.axNextNameIndex,i.axNextValue=t.axNextValue,t.axGetProperty=bb.prototype.axGetProperty,t.axGetNumericProperty=bb.prototype.axGetNumericProperty,t.axSetProperty=bb.prototype.axSetProperty,t.axSetNumericProperty=bb.prototype.axSetNumericProperty,t.axHasPropertyInternal=bb.prototype.axHasPropertyInternal,t.axNextName=bb.prototype.axNextName,t.axNextNameIndex=bb.prototype.axNextNameIndex,t.axNextValue=bb.prototype.axNextValue;var n=e.prototype;mf(t,"$Bgjoin",n.join),mf(t,"$BgtoString",n.join),mf(t,"$BgtoLocaleString",n.toLocaleString),mf(t,"$Bgpop",n.pop),mf(t,"$Bgpush",n.push),mf(t,"$Bgreverse",n.reverse),mf(t,"$Bgconcat",n.concat),mf(t,"$Bgsplice",n.splice),mf(t,"$Bgslice",n.slice),mf(t,"$Bgshift",n.shift),mf(t,"$Bgunshift",n.unshift),mf(t,"$BgindexOf",n.indexOf),mf(t,"$BglastIndexOf",n.lastIndexOf),mf(t,"$BgforEach",n.forEach),mf(t,"$Bgmap",n.map),mf(t,"$Bgfilter",n.filter),mf(t,"$Bgsome",n.some),mf(t,"$Bgevery",n.every),mf(t,"$Bgsort",n.sort),mf(t,"checkVectorMethodArgs",n.checkVectorMethodArgs)},e.axApply=function(t,e){var i=e[0];if(this.axIsType(i))return i;var n=i.axGetPublicProperty("length");if(void 0!==n){for(var r=this.axConstruct([n,!1]),o=0;o<n;o++)r.axSetNumericProperty(o,i.axGetPublicProperty(o));return r}hp()},e.prototype.internalToString=function(){for(var t="",e=this._offset,i=e+this._length,n=0;n<this._buffer.length;n++)n===e&&(t+="["),n===i&&(t+="]"),t+=this._buffer[n],n<this._buffer.length-1&&(t+=",");return this._offset+this._length===this._buffer.length&&(t+="]"),t+": offset: "+this._offset+", length: "+this._length+", capacity: "+this._buffer.length},e.prototype.toString=function(){for(var t="",e=0;e<this._length;e++)t+=this._buffer[this._offset+e],e<this._length-1&&(t+=",");return t},e.prototype.toLocaleString=function(){for(var t="",e=0;e<this._length;e++)t+=this._buffer[this._offset+e],e<this._length-1&&(t+=",");return t},e.prototype._view=function(){return this._buffer.subarray(this._offset,this._offset+this._length)},e.prototype._ensureCapacity=function(t){var e=this._offset+t;if(!(e<this._buffer.length)){if(t<=this._buffer.length){var i=this._buffer.length-t>>2;return this._buffer.set(this._view(),i),void(this._offset=i)}var n=1+(3*this._buffer.length>>1);n<e&&(n=e);var r=new Int32Array(n);r.set(this._buffer,0),this._buffer=r}},e.prototype.concat=function(){for(var t=this._length,e=0;e<arguments.length;e++){(o=arguments[e])._buffer instanceof Int32Array||co(!1),t+=o._length}var i=new this.sec.Int32Vector(t),n=i._buffer;n.set(this._buffer);var r=this._length;for(e=0;e<arguments.length;e++){var o;r+(o=arguments[e])._buffer.length<o._buffer.length?n.set(o._buffer,r):n.set(o._buffer.subarray(0,o._length),r),r+=o._length}return i},e.prototype.every=function(t,e){if(!this.checkVectorMethodArgs(t,e))return!0;for(var i=0;i<this._length;i++)if(!t.call(e,this._buffer[this._offset+i],i,this))return!1;return!0},e.prototype.filter=function(t,e){var i=new this.sec.Int32Vector;if(!this.checkVectorMethodArgs(t,e))return i;for(var n=0;n<this._length;n++)t.call(e,this._buffer[this._offset+n],n,this)&&i.push(this._buffer[this._offset+n]);return i},e.prototype.map=function(t,e){var i=this.axClass.axConstruct([this.length,!1]);if(!this.checkVectorMethodArgs(t,e))return i;for(var n=0;n<this._length;n++)i[n]=t.call(e,this._buffer[this._offset+n],n,this);return i},e.prototype.some=function(t,e){if(!this.checkVectorMethodArgs(t,e))return!1;for(var i=0;i<this._length;i++)if(t.call(e,this._buffer[this._offset+i],i,this))return!0;return!1},e.prototype.forEach=function(t,e){if(this.checkVectorMethodArgs(t,e))for(var i=0;i<this._length;i++)t.call(e,this._buffer[this._offset+i],i,this)},e.prototype.join=function(t){void 0===t&&(t=",");for(var e=this.length,i=this._buffer,n=this._offset,r="",o=0;o<e-1;o++)r+=i[n+o]+t;return e>0&&(r+=i[n+e-1]),r},e.prototype.indexOf=function(t,e){void 0===e&&(e=0);var i=this._length,n=0|e;if(n<0)(n+=i)<0&&(n=0);else if(n>=i)return-1;for(var r=this._buffer,o=(i=this._length,this._offset),s=o+i,a=n+=o;a<s;a++)if(r[a]===t)return a-o;return-1},e.prototype.lastIndexOf=function(t,e){void 0===e&&(e=2147483647);var i=this._length,n=0|e;if(n<0){if((n+=i)<0)return-1}else n>=i&&(n=i);for(var r=this._buffer,o=this._offset,s=o,a=n+=o;a-- >s;)if(r[a]===t)return a-o;return-1},e.prototype.push=function(t,e,i,n,r,o,s,a){this._checkFixed(),this._ensureCapacity(this._length+arguments.length);for(var l=0;l<arguments.length;l++)this._buffer[this._offset+this._length++]=arguments[l]},e.prototype.pop=function(){return this._checkFixed(),0===this._length?e.DEFAULT_VALUE:(this._length--,this._buffer[this._offset+this._length])},e.prototype.reverse=function(){for(var t=this._offset,e=this._offset+this._length-1,i=this._buffer;t<e;){var n=i[t];i[t]=i[e],i[e]=n,t++,e--}return this},e.prototype.sort=function(t){if(0===arguments.length)return Array.prototype.sort.call(this._view()),this;if(this.sec.AXFunction.axIsType(t))return Array.prototype.sort.call(this._view(),t.value),this;var i=0|t;return i&e.DESCENDING?Array.prototype.sort.call(this._view(),(function(t,e){return e-t})):Array.prototype.sort.call(this._view(),(function(t,e){return t-e})),this},e.prototype.shift=function(){return this._checkFixed(),0===this._length?0:(this._length--,this._buffer[this._offset++])},e.prototype.unshift=function(){if(this._checkFixed(),arguments.length){this._ensureCapacity(this._length+arguments.length),this._slide(arguments.length),this._offset-=arguments.length,this._length+=arguments.length;for(var t=0;t<arguments.length;t++)this._buffer[this._offset+t]=arguments[t]}},e.prototype.slice=function(t,e){void 0===t&&(t=0),void 0===e&&(e=2147483647);var i=this._buffer,n=this._length,r=Math.min(Math.max(t,0),n),o=Math.min(Math.max(e,r),n),s=new this.sec.Int32Vector(o-r,this.fixed);return s._buffer.set(i.subarray(this._offset+r,this._offset+o),s._offset),s},e.prototype.splice=function(t,e){var i,n=this._buffer,r=this._length,o=Math.min(Math.max(t,0),r),s=this._offset+o,a=Math.min(Math.max(e,0),r-o),l=arguments.length-2,u=new this.sec.Int32Vector(a,this.fixed);a>0&&(i=n.subarray(s,s+a),u._buffer.set(i,u._offset)),this._ensureCapacity(r-a+l);var c=s+a,h=n.subarray(c,r);n.set(h,s+l),this._length+=l-a;for(var p=0;p<l;p++)n[s+p]=arguments[p+2];return u},e.prototype._slide=function(t){this._buffer.set(this._view(),this._offset+t),this._offset+=t},Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(t){if((t>>>=0)>this._length){this._ensureCapacity(t);for(var i=this._offset+this._length,n=this._offset+t;i<n;i++)this._buffer[i]=e.DEFAULT_VALUE}this._length=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fixed",{get:function(){return this._fixed},set:function(t){this._fixed=!!t},enumerable:!0,configurable:!0}),e.prototype._checkFixed=function(){this._fixed&&this.sec.throwError("RangeError",db.VectorFixedError)},e.prototype.axGetNumericProperty=function(t){var e=this._length,i=0|t;return(i<0||i>=e||i!=t)&&this.sec.throwError("RangeError",db.OutOfRangeError,t,e),this._buffer[this._offset+i]},e.prototype.axSetNumericProperty=function(t,e){var i=this._length,n=0|t;(n<0||n>i||n!=t||n===i&&this._fixed)&&this.sec.throwError("RangeError",db.OutOfRangeError,t,i),n===this._length&&(this._ensureCapacity(this._length+1),this._length++),this._buffer[this._offset+n]=e},e.prototype.axHasPropertyInternal=function(t){if((0|t.name)===t.name)return t.name>=0&&t.name<this._length;var e=hb(t.name);if(t.isRuntimeName()&&Hh(e)){var i=e>>>0;return i>=0&&i<this._length}return this.axResolveMultiname(t)in this},e.prototype.axNextValue=function(t){return this._buffer[this._offset+t-1]},e.prototype.axNextNameIndex=function(t){var e=t+1;return e<=this._length?e:0},e.EXTRA_CAPACITY=4,e.INITIAL_CAPACITY=10,e.DEFAULT_VALUE=0,e.DESCENDING=2,e.UNIQUESORT=4,e.RETURNINDEXEDARRAY=8,e}(sx),cx=function(t){function e(i,n){void 0===i&&(i=0),void 0===n&&(n=!1);var r=t.call(this)||this;return i>>>=0,r._fixed=!!n,r._buffer=new Uint32Array(Math.max(e.INITIAL_CAPACITY,i+e.EXTRA_CAPACITY)),r._offset=0,r._length=i,r}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=this.tPrototype;i.axGetProperty=t.axGetProperty,i.axGetNumericProperty=t.axGetNumericProperty,i.axSetProperty=t.axSetProperty,i.axSetNumericProperty=t.axSetNumericProperty,i.axHasPropertyInternal=t.axHasPropertyInternal,i.axNextName=t.axNextName,i.axNextNameIndex=t.axNextNameIndex,i.axNextValue=t.axNextValue,t.axGetProperty=bb.prototype.axGetProperty,t.axGetNumericProperty=bb.prototype.axGetNumericProperty,t.axSetProperty=bb.prototype.axSetProperty,t.axSetNumericProperty=bb.prototype.axSetNumericProperty,t.axHasPropertyInternal=bb.prototype.axHasPropertyInternal,t.axNextName=bb.prototype.axNextName,t.axNextNameIndex=bb.prototype.axNextNameIndex,t.axNextValue=bb.prototype.axNextValue;var n=e.prototype;mf(t,"$Bgjoin",n.join),mf(t,"$BgtoString",n.join),mf(t,"$BgtoLocaleString",n.toLocaleString),mf(t,"$Bgpop",n.pop),mf(t,"$Bgpush",n.push),mf(t,"$Bgreverse",n.reverse),mf(t,"$Bgconcat",n.concat),mf(t,"$Bgsplice",n.splice),mf(t,"$Bgslice",n.slice),mf(t,"$Bgshift",n.shift),mf(t,"$Bgunshift",n.unshift),mf(t,"$BgindexOf",n.indexOf),mf(t,"$BglastIndexOf",n.lastIndexOf),mf(t,"$BgforEach",n.forEach),mf(t,"$Bgmap",n.map),mf(t,"$Bgfilter",n.filter),mf(t,"$Bgsome",n.some),mf(t,"$Bgevery",n.every),mf(t,"$Bgsort",n.sort),mf(t,"checkVectorMethodArgs",n.checkVectorMethodArgs)},e.axApply=function(t,e){var i=e[0];if(this.axIsType(i))return i;var n=i.axGetPublicProperty("length");if(void 0!==n){for(var r=this.axConstruct([n,!1]),o=0;o<n;o++)r.axSetNumericProperty(o,i.axGetPublicProperty(o));return r}hp()},e.prototype.internalToString=function(){for(var t="",e=this._offset,i=e+this._length,n=0;n<this._buffer.length;n++)n===e&&(t+="["),n===i&&(t+="]"),t+=this._buffer[n],n<this._buffer.length-1&&(t+=",");return this._offset+this._length===this._buffer.length&&(t+="]"),t+": offset: "+this._offset+", length: "+this._length+", capacity: "+this._buffer.length},e.prototype.toString=function(){for(var t="",e=0;e<this._length;e++)t+=this._buffer[this._offset+e],e<this._length-1&&(t+=",");return t},e.prototype.toLocaleString=function(){for(var t="",e=0;e<this._length;e++)t+=this._buffer[this._offset+e],e<this._length-1&&(t+=",");return t},e.prototype._view=function(){return this._buffer.subarray(this._offset,this._offset+this._length)},e.prototype._ensureCapacity=function(t){var e=this._offset+t;if(!(e<this._buffer.length)){if(t<=this._buffer.length){var i=this._buffer.length-t>>2;return this._buffer.set(this._view(),i),void(this._offset=i)}var n=1+(3*this._buffer.length>>1);n<e&&(n=e);var r=new Uint32Array(n);r.set(this._buffer,0),this._buffer=r}},e.prototype.concat=function(){for(var t=this._length,e=0;e<arguments.length;e++){(o=arguments[e])._buffer instanceof Uint32Array||co(!1),t+=o._length}var i=new this.sec.Uint32Vector(t),n=i._buffer;n.set(this._buffer);var r=this._length;for(e=0;e<arguments.length;e++){var o;r+(o=arguments[e])._buffer.length<o._buffer.length?n.set(o._buffer,r):n.set(o._buffer.subarray(0,o._length),r),r+=o._length}return i},e.prototype.every=function(t,e){if(!this.checkVectorMethodArgs(t,e))return!0;for(var i=0;i<this._length;i++)if(!t.call(e,this._buffer[this._offset+i],i,this))return!1;return!0},e.prototype.filter=function(t,e){var i=new this.sec.Uint32Vector;if(!this.checkVectorMethodArgs(t,e))return i;for(var n=0;n<this._length;n++)t.call(e,this._buffer[this._offset+n],n,this)&&i.push(this._buffer[this._offset+n]);return i},e.prototype.map=function(t,e){var i=this.axClass.axConstruct([this.length,!1]);if(!this.checkVectorMethodArgs(t,e))return i;for(var n=0;n<this._length;n++)i[n]=t.call(e,this._buffer[this._offset+n],n,this);return i},e.prototype.some=function(t,e){if(!this.checkVectorMethodArgs(t,e))return!1;for(var i=0;i<this._length;i++)if(t.call(e,this._buffer[this._offset+i],i,this))return!0;return!1},e.prototype.forEach=function(t,e){if(this.checkVectorMethodArgs(t,e))for(var i=0;i<this._length;i++)t.call(e,this._buffer[this._offset+i],i,this)},e.prototype.join=function(t){void 0===t&&(t=",");for(var e=this.length,i=this._buffer,n=this._offset,r="",o=0;o<e-1;o++)r+=i[n+o]+t;return e>0&&(r+=i[n+e-1]),r},e.prototype.indexOf=function(t,e){void 0===e&&(e=0);var i=this._length,n=0|e;if(n<0)(n+=i)<0&&(n=0);else if(n>=i)return-1;for(var r=this._buffer,o=(i=this._length,this._offset),s=o+i,a=n+=o;a<s;a++)if(r[a]===t)return a-o;return-1},e.prototype.lastIndexOf=function(t,e){void 0===e&&(e=2147483647);var i=this._length,n=0|e;if(n<0){if((n+=i)<0)return-1}else n>=i&&(n=i);for(var r=this._buffer,o=this._offset,s=o,a=n+=o;a-- >s;)if(r[a]===t)return a-o;return-1},e.prototype.push=function(t,e,i,n,r,o,s,a){this._checkFixed(),this._ensureCapacity(this._length+arguments.length);for(var l=0;l<arguments.length;l++)this._buffer[this._offset+this._length++]=arguments[l]},e.prototype.pop=function(){return this._checkFixed(),0===this._length?e.DEFAULT_VALUE:(this._length--,this._buffer[this._offset+this._length])},e.prototype.reverse=function(){for(var t=this._offset,e=this._offset+this._length-1,i=this._buffer;t<e;){var n=i[t];i[t]=i[e],i[e]=n,t++,e--}return this},e.prototype.sort=function(t){if(0===arguments.length)return Array.prototype.sort.call(this._view()),this;if(this.sec.AXFunction.axIsType(t))return Array.prototype.sort.call(this._view(),t.value),this;var i=0|t;return i&e.DESCENDING?Array.prototype.sort.call(this._view(),(function(t,e){return e-t})):Array.prototype.sort.call(this._view(),(function(t,e){return t-e})),this},e.prototype.shift=function(){return this._checkFixed(),0===this._length?0:(this._length--,this._buffer[this._offset++])},e.prototype.unshift=function(){if(this._checkFixed(),arguments.length){this._ensureCapacity(this._length+arguments.length),this._slide(arguments.length),this._offset-=arguments.length,this._length+=arguments.length;for(var t=0;t<arguments.length;t++)this._buffer[this._offset+t]=arguments[t]}},e.prototype.slice=function(t,e){void 0===t&&(t=0),void 0===e&&(e=2147483647);var i=this._buffer,n=this._length,r=Math.min(Math.max(t,0),n),o=Math.min(Math.max(e,r),n),s=new this.sec.Uint32Vector(o-r,this.fixed);return s._buffer.set(i.subarray(this._offset+r,this._offset+o),s._offset),s},e.prototype.splice=function(t,e){var i,n=this._buffer,r=this._length,o=Math.min(Math.max(t,0),r),s=this._offset+o,a=Math.min(Math.max(e,0),r-o),l=arguments.length-2,u=new this.sec.Uint32Vector(a,this.fixed);a>0&&(i=n.subarray(s,s+a),u._buffer.set(i,u._offset)),this._ensureCapacity(r-a+l);var c=s+a,h=n.subarray(c,r);n.set(h,s+l),this._length+=l-a;for(var p=0;p<l;p++)n[s+p]=arguments[p+2];return u},e.prototype._slide=function(t){this._buffer.set(this._view(),this._offset+t),this._offset+=t},Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(t){if((t>>>=0)>this._length){this._ensureCapacity(t);for(var i=this._offset+this._length,n=this._offset+t;i<n;i++)this._buffer[i]=e.DEFAULT_VALUE}this._length=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fixed",{get:function(){return this._fixed},set:function(t){this._fixed=!!t},enumerable:!0,configurable:!0}),e.prototype._checkFixed=function(){this._fixed&&this.sec.throwError("RangeError",db.VectorFixedError)},e.prototype.axGetNumericProperty=function(t){var e=this._length,i=0|t;return(i<0||i>=e||i!=t)&&this.sec.throwError("RangeError",db.OutOfRangeError,t,e),this._buffer[this._offset+i]},e.prototype.axSetNumericProperty=function(t,e){var i=this._length,n=0|t;(n<0||n>i||n!=t||n===i&&this._fixed)&&this.sec.throwError("RangeError",db.OutOfRangeError,t,i),n===this._length&&(this._ensureCapacity(this._length+1),this._length++),this._buffer[this._offset+n]=e},e.prototype.axHasPropertyInternal=function(t){if((0|t.name)===t.name)return t.name>=0&&t.name<this._length;var e=hb(t.name);if(t.isRuntimeName()&&Hh(e)){var i=e>>>0;return i>=0&&i<this._length}return this.axResolveMultiname(t)in this},e.prototype.axNextValue=function(t){return this._buffer[this._offset+t-1]},e.prototype.axNextNameIndex=function(t){var e=t+1;return e<=this._length?e:0},e.EXTRA_CAPACITY=4,e.INITIAL_CAPACITY=10,e.DEFAULT_VALUE=0,e.DESCENDING=2,e.UNIQUESORT=4,e.RETURNINDEXEDARRAY=8,e}(sx),hx=function(t){function e(i,n){void 0===i&&(i=0),void 0===n&&(n=!1);var r=t.call(this)||this;return i>>>=0,r._fixed=!!n,r._buffer=new Float64Array(Math.max(e.INITIAL_CAPACITY,i+e.EXTRA_CAPACITY)),r._offset=0,r._length=i,r}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=this.tPrototype;i.axGetProperty=t.axGetProperty,i.axGetNumericProperty=t.axGetNumericProperty,i.axSetProperty=t.axSetProperty,i.axSetNumericProperty=t.axSetNumericProperty,i.axHasPropertyInternal=t.axHasPropertyInternal,i.axNextName=t.axNextName,i.axNextNameIndex=t.axNextNameIndex,i.axNextValue=t.axNextValue,t.axGetProperty=bb.prototype.axGetProperty,t.axGetNumericProperty=bb.prototype.axGetNumericProperty,t.axSetProperty=bb.prototype.axSetProperty,t.axSetNumericProperty=bb.prototype.axSetNumericProperty,t.axHasPropertyInternal=bb.prototype.axHasPropertyInternal,t.axNextName=bb.prototype.axNextName,t.axNextNameIndex=bb.prototype.axNextNameIndex,t.axNextValue=bb.prototype.axNextValue;var n=e.prototype;mf(t,"$Bgjoin",n.join),mf(t,"$BgtoString",n.join),mf(t,"$BgtoLocaleString",n.toLocaleString),mf(t,"$Bgpop",n.pop),mf(t,"$Bgpush",n.push),mf(t,"$Bgreverse",n.reverse),mf(t,"$Bgconcat",n.concat),mf(t,"$Bgsplice",n.splice),mf(t,"$Bgslice",n.slice),mf(t,"$Bgshift",n.shift),mf(t,"$Bgunshift",n.unshift),mf(t,"$BgindexOf",n.indexOf),mf(t,"$BglastIndexOf",n.lastIndexOf),mf(t,"$BgforEach",n.forEach),mf(t,"$Bgmap",n.map),mf(t,"$Bgfilter",n.filter),mf(t,"$Bgsome",n.some),mf(t,"$Bgevery",n.every),mf(t,"$Bgsort",n.sort),mf(t,"checkVectorMethodArgs",n.checkVectorMethodArgs)},e.axApply=function(t,e){var i=e[0];if(this.axIsType(i))return i;var n=i.axGetPublicProperty("length");if(void 0!==n){for(var r=this.axConstruct([n,!1]),o=0;o<n;o++)r.axSetNumericProperty(o,i.axGetPublicProperty(o));return r}hp()},e.prototype.internalToString=function(){for(var t="",e=this._offset,i=e+this._length,n=0;n<this._buffer.length;n++)n===e&&(t+="["),n===i&&(t+="]"),t+=this._buffer[n],n<this._buffer.length-1&&(t+=",");return this._offset+this._length===this._buffer.length&&(t+="]"),t+": offset: "+this._offset+", length: "+this._length+", capacity: "+this._buffer.length},e.prototype.toString=function(){for(var t="",e=0;e<this._length;e++)t+=this._buffer[this._offset+e],e<this._length-1&&(t+=",");return t},e.prototype.toLocaleString=function(){for(var t="",e=0;e<this._length;e++)t+=this._buffer[this._offset+e],e<this._length-1&&(t+=",");return t},e.prototype._view=function(){return this._buffer.subarray(this._offset,this._offset+this._length)},e.prototype._ensureCapacity=function(t){var e=this._offset+t;if(!(e<this._buffer.length)){if(t<=this._buffer.length){var i=this._buffer.length-t>>2;return this._buffer.set(this._view(),i),void(this._offset=i)}var n=1+(3*this._buffer.length>>1);n<e&&(n=e);var r=new Float64Array(n);r.set(this._buffer,0),this._buffer=r}},e.prototype.concat=function(){for(var t=this._length,e=0;e<arguments.length;e++){(o=arguments[e])._buffer instanceof Float64Array||co(!1),t+=o._length}var i=new this.sec.Float64Vector(t),n=i._buffer;n.set(this._buffer);var r=this._length;for(e=0;e<arguments.length;e++){var o;r+(o=arguments[e])._buffer.length<o._buffer.length?n.set(o._buffer,r):n.set(o._buffer.subarray(0,o._length),r),r+=o._length}return i},e.prototype.every=function(t,e){if(!this.checkVectorMethodArgs(t,e))return!0;for(var i=0;i<this._length;i++)if(!t.call(e,this._buffer[this._offset+i],i,this))return!1;return!0},e.prototype.filter=function(t,e){var i=new this.sec.Float64Vector;if(!this.checkVectorMethodArgs(t,e))return i;for(var n=0;n<this._length;n++)t.call(e,this._buffer[this._offset+n],n,this)&&i.push(this._buffer[this._offset+n]);return i},e.prototype.map=function(t,e){var i=this.axClass.axConstruct([this.length,!1]);if(!this.checkVectorMethodArgs(t,e))return i;for(var n=0;n<this._length;n++)i[n]=t.call(e,this._buffer[this._offset+n],n,this);return i},e.prototype.some=function(t,e){if(!this.checkVectorMethodArgs(t,e))return!1;for(var i=0;i<this._length;i++)if(t.call(e,this._buffer[this._offset+i],i,this))return!0;return!1},e.prototype.forEach=function(t,e){if(this.checkVectorMethodArgs(t,e))for(var i=0;i<this._length;i++)t.call(e,this._buffer[this._offset+i],i,this)},e.prototype.join=function(t){void 0===t&&(t=",");for(var e=this.length,i=this._buffer,n=this._offset,r="",o=0;o<e-1;o++)r+=i[n+o]+t;return e>0&&(r+=i[n+e-1]),r},e.prototype.indexOf=function(t,e){void 0===e&&(e=0);var i=this._length,n=0|e;if(n<0)(n+=i)<0&&(n=0);else if(n>=i)return-1;for(var r=this._buffer,o=(i=this._length,this._offset),s=o+i,a=n+=o;a<s;a++)if(r[a]===t)return a-o;return-1},e.prototype.lastIndexOf=function(t,e){void 0===e&&(e=2147483647);var i=this._length,n=0|e;if(n<0){if((n+=i)<0)return-1}else n>=i&&(n=i);for(var r=this._buffer,o=this._offset,s=o,a=n+=o;a-- >s;)if(r[a]===t)return a-o;return-1},e.prototype.push=function(t,e,i,n,r,o,s,a){this._checkFixed(),this._ensureCapacity(this._length+arguments.length);for(var l=0;l<arguments.length;l++)this._buffer[this._offset+this._length++]=arguments[l]},e.prototype.pop=function(){return this._checkFixed(),0===this._length?e.DEFAULT_VALUE:(this._length--,this._buffer[this._offset+this._length])},e.prototype.reverse=function(){for(var t=this._offset,e=this._offset+this._length-1,i=this._buffer;t<e;){var n=i[t];i[t]=i[e],i[e]=n,t++,e--}return this},e.prototype.sort=function(t){if(0===arguments.length)return Array.prototype.sort.call(this._view()),this;if(this.sec.AXFunction.axIsType(t))return Array.prototype.sort.call(this._view(),t.value),this;var i=0|t;return i&e.DESCENDING?Array.prototype.sort.call(this._view(),(function(t,e){return e-t})):Array.prototype.sort.call(this._view(),(function(t,e){return t-e})),this},e.prototype.shift=function(){return this._checkFixed(),0===this._length?0:(this._length--,this._buffer[this._offset++])},e.prototype.unshift=function(){if(this._checkFixed(),arguments.length){this._ensureCapacity(this._length+arguments.length),this._slide(arguments.length),this._offset-=arguments.length,this._length+=arguments.length;for(var t=0;t<arguments.length;t++)this._buffer[this._offset+t]=arguments[t]}},e.prototype.slice=function(t,e){void 0===t&&(t=0),void 0===e&&(e=2147483647);var i=this._buffer,n=this._length,r=Math.min(Math.max(t,0),n),o=Math.min(Math.max(e,r),n),s=new this.sec.Float64Vector(o-r,this.fixed);return s._buffer.set(i.subarray(this._offset+r,this._offset+o),s._offset),s},e.prototype.splice=function(t,e){var i,n=this._buffer,r=this._length,o=Math.min(Math.max(t,0),r),s=this._offset+o,a=Math.min(Math.max(e,0),r-o),l=arguments.length-2,u=new this.sec.Float64Vector(a,this.fixed);a>0&&(i=n.subarray(s,s+a),u._buffer.set(i,u._offset)),this._ensureCapacity(r-a+l);var c=s+a,h=n.subarray(c,r);n.set(h,s+l),this._length+=l-a;for(var p=0;p<l;p++)n[s+p]=arguments[p+2];return u},e.prototype._slide=function(t){this._buffer.set(this._view(),this._offset+t),this._offset+=t},Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(t){if((t>>>=0)>this._length){this._ensureCapacity(t);for(var i=this._offset+this._length,n=this._offset+t;i<n;i++)this._buffer[i]=e.DEFAULT_VALUE}this._length=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fixed",{get:function(){return this._fixed},set:function(t){this._fixed=!!t},enumerable:!0,configurable:!0}),e.prototype._checkFixed=function(){this._fixed&&this.sec.throwError("RangeError",db.VectorFixedError)},e.prototype.axGetNumericProperty=function(t){var e=this._length,i=0|t;return(i<0||i>=e||i!=t)&&this.sec.throwError("RangeError",db.OutOfRangeError,t,e),this._buffer[this._offset+i]},e.prototype.axSetNumericProperty=function(t,e){var i=this._length,n=0|t;(n<0||n>i||n!=t||n===i&&this._fixed)&&this.sec.throwError("RangeError",db.OutOfRangeError,t,i),n===this._length&&(this._ensureCapacity(this._length+1),this._length++),this._buffer[this._offset+n]=e},e.prototype.axHasPropertyInternal=function(t){if((0|t.name)===t.name)return t.name>=0&&t.name<this._length;var e=hb(t.name);if(t.isRuntimeName()&&Hh(e)){var i=e>>>0;return i>=0&&i<this._length}return this.axResolveMultiname(t)in this},e.prototype.axNextValue=function(t){return this._buffer[this._offset+t-1]},e.prototype.axNextNameIndex=function(t){var e=t+1;return e<=this._length?e:0},e.EXTRA_CAPACITY=4,e.INITIAL_CAPACITY=10,e.DEFAULT_VALUE=0,e.DESCENDING=2,e.UNIQUESORT=4,e.RETURNINDEXEDARRAY=8,e}(sx),px=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.classNatives=[Math],e.classInitializer=function(){mf(this,"$BgE",Math.E),mf(this,"$BgLN10",Math.LN10),mf(this,"$BgLN2",Math.LN2),mf(this,"$BgLOG10E",Math.LOG10E),mf(this,"$BgLOG2E",Math.LOG2E),mf(this,"$BgPI",Math.PI),mf(this,"$BgSQRT1_2",Math.SQRT2),mf(this,"$BgSQRT2",Math.SQRT2)},e}(bb),dx=jc((function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}}}));Uc(dx);var fx=function(t){return t&&t.Math==Math&&t},_x=fx("object"==typeof globalThis&&globalThis)||fx("object"==typeof window&&window)||fx("object"==typeof self&&self)||fx("object"==typeof Vc&&Vc)||function(){return this}()||Function("return this")(),mx=function(t){try{return!!t()}catch(t){return!0}},gx=!mx((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),yx={}.propertyIsEnumerable,Ax=Object.getOwnPropertyDescriptor,vx={f:Ax&&!yx.call({1:2},1)?function(t){var e=Ax(this,t);return!!e&&e.enumerable}:yx},bx=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},xx={}.toString,Cx=function(t){return xx.call(t).slice(8,-1)},wx="".split,Ix=mx((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==Cx(t)?wx.call(t,""):Object(t)}:Object,Ex=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},Sx=function(t){return Ix(Ex(t))},Dx=function(t){return"object"==typeof t?null!==t:"function"==typeof t},Tx=function(t,e){if(!Dx(t))return t;var i,n;if(e&&"function"==typeof(i=t.toString)&&!Dx(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!Dx(n=i.call(t)))return n;if(!e&&"function"==typeof(i=t.toString)&&!Dx(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")},Px={}.hasOwnProperty,Bx=function(t,e){return Px.call(t,e)},Mx=_x.document,Ox=Dx(Mx)&&Dx(Mx.createElement),Lx=function(t){return Ox?Mx.createElement(t):{}},Rx=!gx&&!mx((function(){return 7!=Object.defineProperty(Lx("div"),"a",{get:function(){return 7}}).a})),Nx=Object.getOwnPropertyDescriptor,Fx={f:gx?Nx:function(t,e){if(t=Sx(t),e=Tx(e,!0),Rx)try{return Nx(t,e)}catch(t){}if(Bx(t,e))return bx(!vx.f.call(t,e),t[e])}},kx=/#|\.prototype\./,Vx=function(t,e){var i=jx[Ux(t)];return i==Qx||i!=Gx&&("function"==typeof e?mx(e):!!e)},Ux=Vx.normalize=function(t){return String(t).replace(kx,".").toLowerCase()},jx=Vx.data={},Gx=Vx.NATIVE="N",Qx=Vx.POLYFILL="P",zx=Vx,Hx={},Xx=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},qx=function(t,e,i){if(Xx(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}},Yx=function(t){if(!Dx(t))throw TypeError(String(t)+" is not an object");return t},Kx=Object.defineProperty,Wx={f:gx?Kx:function(t,e,i){if(Yx(t),e=Tx(e,!0),Yx(i),Rx)try{return Kx(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},Jx=gx?function(t,e,i){return Wx.f(t,e,bx(1,i))}:function(t,e,i){return t[e]=i,t},Zx=Fx.f,$x=function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e},tC=function(t,e){var i,n,r,o,s,a,l,u,c=t.target,h=t.global,p=t.stat,d=t.proto,f=h?_x:p?_x[c]:(_x[c]||{}).prototype,_=h?Hx:Hx[c]||(Hx[c]={}),m=_.prototype;for(r in e)i=!zx(h?r:c+(p?".":"#")+r,t.forced)&&f&&Bx(f,r),s=_[r],i&&(a=t.noTargetGet?(u=Zx(f,r))&&u.value:f[r]),o=i&&a?a:e[r],i&&typeof s==typeof o||(l=t.bind&&i?qx(o,_x):t.wrap&&i?$x(o):d&&"function"==typeof o?qx(Function.call,o):o,(t.sham||o&&o.sham||s&&s.sham)&&Jx(l,"sham",!0),_[r]=l,d&&(Bx(Hx,n=c+"Prototype")||Jx(Hx,n,{}),Hx[n][r]=o,t.real&&m&&!m[r]&&Jx(m,r,o)))};tC({target:"Object",stat:!0,forced:!gx,sham:!gx},{defineProperty:Wx.f});var eC=jc((function(t){var e=Hx.Object,i=t.exports=function(t,i,n){return e.defineProperty(t,i,n)};e.defineProperty.sham&&(i.sham=!0)})),iC={},nC=_x["__core-js_shared__"]||function(t,e){try{Jx(_x,t,e)}catch(i){_x[t]=e}return e}("__core-js_shared__",{}),rC=Function.toString;"function"!=typeof nC.inspectSource&&(nC.inspectSource=function(t){return rC.call(t)});var oC,sC,aC,lC=nC.inspectSource,uC=_x.WeakMap,cC="function"==typeof uC&&/native code/.test(lC(uC)),hC=jc((function(t){(t.exports=function(t,e){return nC[t]||(nC[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.7.0",mode:"pure",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})})),pC=0,dC=Math.random(),fC=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++pC+dC).toString(36)},_C=hC("keys"),mC=function(t){return _C[t]||(_C[t]=fC(t))},gC={},yC=_x.WeakMap;if(cC){var AC=nC.state||(nC.state=new yC),vC=AC.get,bC=AC.has,xC=AC.set;oC=function(t,e){return e.facade=t,xC.call(AC,t,e),e},sC=function(t){return vC.call(AC,t)||{}},aC=function(t){return bC.call(AC,t)}}else{var CC=mC("state");gC[CC]=!0,oC=function(t,e){return e.facade=t,Jx(t,CC,e),e},sC=function(t){return Bx(t,CC)?t[CC]:{}},aC=function(t){return Bx(t,CC)}}var wC,IC,EC,SC={set:oC,get:sC,has:aC,enforce:function(t){return aC(t)?sC(t):oC(t,{})},getterFor:function(t){return function(e){var i;if(!Dx(e)||(i=sC(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}},DC=function(t){return Object(Ex(t))},TC=!mx((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),PC=mC("IE_PROTO"),BC=Object.prototype,MC=TC?Object.getPrototypeOf:function(t){return t=DC(t),Bx(t,PC)?t[PC]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?BC:null},OC=!!Object.getOwnPropertySymbols&&!mx((function(){return!String(Symbol())})),LC=OC&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,RC=hC("wks"),NC=_x.Symbol,FC=LC?NC:NC&&NC.withoutSetter||fC,kC=function(t){return Bx(RC,t)||(OC&&Bx(NC,t)?RC[t]=NC[t]:RC[t]=FC("Symbol."+t)),RC[t]},VC=(kC("iterator"),!1);[].keys&&("next"in(EC=[].keys())?(IC=MC(MC(EC)))!==Object.prototype&&(wC=IC):VC=!0),null==wC&&(wC={});var UC,jC={IteratorPrototype:wC,BUGGY_SAFARI_ITERATORS:VC},GC=Math.ceil,QC=Math.floor,zC=function(t){return isNaN(t=+t)?0:(t>0?QC:GC)(t)},HC=Math.min,XC=function(t){return t>0?HC(zC(t),9007199254740991):0},qC=Math.max,YC=Math.min,KC=function(t,e){var i=zC(t);return i<0?qC(i+e,0):YC(i,e)},WC=function(t){return function(e,i,n){var r,o=Sx(e),s=XC(o.length),a=KC(n,s);if(t&&i!=i){for(;s>a;)if((r=o[a++])!=r)return!0}else for(;s>a;a++)if((t||a in o)&&o[a]===i)return t||a||0;return!t&&-1}},JC={includes:WC(!0),indexOf:WC(!1)},ZC=JC.indexOf,$C=function(t,e){var i,n=Sx(t),r=0,o=[];for(i in n)!Bx(gC,i)&&Bx(n,i)&&o.push(i);for(;e.length>r;)Bx(n,i=e[r++])&&(~ZC(o,i)||o.push(i));return o},tw=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ew=Object.keys||function(t){return $C(t,tw)},iw=gx?Object.defineProperties:function(t,e){Yx(t);for(var i,n=ew(e),r=n.length,o=0;r>o;)Wx.f(t,i=n[o++],e[i]);return t},nw=function(t){return"function"==typeof t?t:void 0},rw=function(t,e){return arguments.length<2?nw(Hx[t])||nw(_x[t]):Hx[t]&&Hx[t][e]||_x[t]&&_x[t][e]},ow=rw("document","documentElement"),sw=mC("IE_PROTO"),aw=function(){},lw=function(t){return"<script>"+t+"<\/script>"},uw=function(){try{UC=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;uw=UC?function(t){t.write(lw("")),t.close();var e=t.parentWindow.Object;return t=null,e}(UC):((e=Lx("iframe")).style.display="none",ow.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(lw("document.F=Object")),t.close(),t.F);for(var i=tw.length;i--;)delete uw.prototype[tw[i]];return uw()};gC[sw]=!0;var cw=Object.create||function(t,e){var i;return null!==t?(aw.prototype=Yx(t),i=new aw,aw.prototype=null,i[sw]=t):i=uw(),void 0===e?i:iw(i,e)},hw={};hw[kC("toStringTag")]="z";var pw="[object z]"===String(hw),dw=kC("toStringTag"),fw="Arguments"==Cx(function(){return arguments}()),_w=pw?Cx:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),dw))?i:fw?Cx(e):"Object"==(n=Cx(e))&&"function"==typeof e.callee?"Arguments":n},mw=pw?{}.toString:function(){return"[object "+_w(this)+"]"},gw=Wx.f,yw=kC("toStringTag"),Aw=function(t,e,i,n){if(t){var r=i?t:t.prototype;Bx(r,yw)||gw(r,yw,{configurable:!0,value:e}),n&&!pw&&Jx(r,"toString",mw)}},vw=jC.IteratorPrototype,bw=function(){return this},xw=(Object.setPrototypeOf||"__proto__"in{}&&function(){var t,e=!1,i={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),e=i instanceof Array}catch(t){}}(),function(t,e,i,n){n&&n.enumerable?t[e]=i:Jx(t,e,i)}),Cw=jC.IteratorPrototype,ww=jC.BUGGY_SAFARI_ITERATORS,Iw=kC("iterator"),Ew=function(){return this},Sw=function(t,e,i,n,r,o,s){!function(t,e,i){var n=e+" Iterator";t.prototype=cw(vw,{next:bx(1,i)}),Aw(t,n,!1,!0),iC[n]=bw}(i,e,n);var a,l,u,c=function(t){if(t===r&&_)return _;if(!ww&&t in d)return d[t];switch(t){case"keys":case"values":case"entries":return function(){return new i(this,t)}}return function(){return new i(this)}},h=e+" Iterator",p=!1,d=t.prototype,f=d[Iw]||d["@@iterator"]||r&&d[r],_=!ww&&f||c(r),m="Array"==e&&d.entries||f;if(m&&(a=MC(m.call(new t)),Cw!==Object.prototype&&a.next&&(Aw(a,h,!0,!0),iC[h]=Ew)),"values"==r&&f&&"values"!==f.name&&(p=!0,_=function(){return f.call(this)}),s&&d[Iw]!==_&&Jx(d,Iw,_),iC[e]=_,r)if(l={values:c("values"),keys:o?_:c("keys"),entries:c("entries")},s)for(u in l)(ww||p||!(u in d))&&xw(d,u,l[u]);else tC({target:e,proto:!0,forced:ww||p},l);return l},Dw=SC.set,Tw=SC.getterFor("Array Iterator");Sw(Array,"Array",(function(t,e){Dw(this,{type:"Array Iterator",target:Sx(t),index:0,kind:e})}),(function(){var t=Tw(this),e=t.target,i=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:n,done:!1}:"values"==i?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}}),"values");iC.Arguments=iC.Array;var Pw=kC("toStringTag");for(var Bw in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Mw=_x[Bw],Ow=Mw&&Mw.prototype;Ow&&_w(Ow)!==Pw&&Jx(Ow,Pw,Bw),iC[Bw]=iC.Array}var Lw=function(t){return function(e,i){var n,r,o=String(Ex(e)),s=zC(i),a=o.length;return s<0||s>=a?t?"":void 0:(n=o.charCodeAt(s))<55296||n>56319||s+1===a||(r=o.charCodeAt(s+1))<56320||r>57343?t?o.charAt(s):n:t?o.slice(s,s+2):r-56320+(n-55296<<10)+65536}},Rw={codeAt:Lw(!1),charAt:Lw(!0)}.charAt,Nw=SC.set,Fw=SC.getterFor("String Iterator");Sw(String,"String",(function(t){Nw(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=Fw(this),i=e.string,n=e.index;return n>=i.length?{value:void 0,done:!0}:(t=Rw(i,n),e.index+=t.length,{value:t,done:!1})}));var kw=kC("iterator"),Vw=function(t){if(null!=t)return t[kw]||t["@@iterator"]||iC[_w(t)]},Uw=function(t){var e=Vw(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return Yx(e.call(t))},jw=Array.isArray||function(t){return"Array"==Cx(t)};tC({target:"Array",stat:!0},{isArray:jw});var Gw,Qw,zw=Hx.Array.isArray,Hw=zw,Xw=Vw,qw=function(t,e,i){var n=Tx(e);n in t?Wx.f(t,n,bx(0,i)):t[n]=i},Yw=kC("species"),Kw=function(t,e){var i;return jw(t)&&("function"!=typeof(i=t.constructor)||i!==Array&&!jw(i.prototype)?Dx(i)&&null===(i=i[Yw])&&(i=void 0):i=void 0),new(void 0===i?Array:i)(0===e?0:e)},Ww=rw("navigator","userAgent")||"",Jw=_x.process,Zw=Jw&&Jw.versions,$w=Zw&&Zw.v8;$w?Qw=(Gw=$w.split("."))[0]+Gw[1]:Ww&&(!(Gw=Ww.match(/Edge\/(\d+)/))||Gw[1]>=74)&&(Gw=Ww.match(/Chrome\/(\d+)/))&&(Qw=Gw[1]);var tI=Qw&&+Qw,eI=kC("species"),iI=function(t){return tI>=51||!mx((function(){var e=[];return(e.constructor={})[eI]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},nI=kC("isConcatSpreadable"),rI=tI>=51||!mx((function(){var t=[];return t[nI]=!1,t.concat()[0]!==t})),oI=iI("concat"),sI=function(t){if(!Dx(t))return!1;var e=t[nI];return void 0!==e?!!e:jw(t)};tC({target:"Array",proto:!0,forced:!rI||!oI},{concat:function(t){var e,i,n,r,o,s=DC(this),a=Kw(s,0),l=0;for(e=-1,n=arguments.length;e<n;e++)if(sI(o=-1===e?s:arguments[e])){if(l+(r=XC(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(i=0;i<r;i++,l++)i in o&&qw(a,l,o[i])}else{if(l>=9007199254740991)throw TypeError("Maximum allowed index exceeded");qw(a,l++,o)}return a.length=l,a}});var aI=tw.concat("length","prototype"),lI={f:Object.getOwnPropertyNames||function(t){return $C(t,aI)}},uI=lI.f,cI={}.toString,hI="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],pI={f:function(t){return hI&&"[object Window]"==cI.call(t)?function(t){try{return uI(t)}catch(t){return hI.slice()}}(t):uI(Sx(t))}},dI={f:Object.getOwnPropertySymbols},fI={f:kC},_I=Wx.f,mI=function(t){var e=Hx.Symbol||(Hx.Symbol={});Bx(e,t)||_I(e,t,{value:fI.f(t)})},gI=[].push,yI=function(t){var e=1==t,i=2==t,n=3==t,r=4==t,o=6==t,s=5==t||o;return function(a,l,u,c){for(var h,p,d=DC(a),f=Ix(d),_=qx(l,u,3),m=XC(f.length),g=0,y=c||Kw,A=e?y(a,m):i?y(a,0):void 0;m>g;g++)if((s||g in f)&&(p=_(h=f[g],g,d),t))if(e)A[g]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return g;case 2:gI.call(A,h)}else if(r)return!1;return o?-1:n||r?r:A}},AI={forEach:yI(0),map:yI(1),filter:yI(2),some:yI(3),every:yI(4),find:yI(5),findIndex:yI(6)},vI=AI.forEach,bI=mC("hidden"),xI=kC("toPrimitive"),CI=SC.set,wI=SC.getterFor("Symbol"),II=Object.prototype,EI=_x.Symbol,SI=rw("JSON","stringify"),DI=Fx.f,TI=Wx.f,PI=pI.f,BI=vx.f,MI=hC("symbols"),OI=hC("op-symbols"),LI=hC("string-to-symbol-registry"),RI=hC("symbol-to-string-registry"),NI=hC("wks"),FI=_x.QObject,kI=!FI||!FI.prototype||!FI.prototype.findChild,VI=gx&&mx((function(){return 7!=cw(TI({},"a",{get:function(){return TI(this,"a",{value:7}).a}})).a}))?function(t,e,i){var n=DI(II,e);n&&delete II[e],TI(t,e,i),n&&t!==II&&TI(II,e,n)}:TI,UI=function(t,e){var i=MI[t]=cw(EI.prototype);return CI(i,{type:"Symbol",tag:t,description:e}),gx||(i.description=e),i},jI=LC?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof EI},GI=function(t,e,i){t===II&&GI(OI,e,i),Yx(t);var n=Tx(e,!0);return Yx(i),Bx(MI,n)?(i.enumerable?(Bx(t,bI)&&t[bI][n]&&(t[bI][n]=!1),i=cw(i,{enumerable:bx(0,!1)})):(Bx(t,bI)||TI(t,bI,bx(1,{})),t[bI][n]=!0),VI(t,n,i)):TI(t,n,i)},QI=function(t,e){Yx(t);var i=Sx(e),n=ew(i).concat(qI(i));return vI(n,(function(e){gx&&!zI.call(i,e)||GI(t,e,i[e])})),t},zI=function(t){var e=Tx(t,!0),i=BI.call(this,e);return!(this===II&&Bx(MI,e)&&!Bx(OI,e))&&(!(i||!Bx(this,e)||!Bx(MI,e)||Bx(this,bI)&&this[bI][e])||i)},HI=function(t,e){var i=Sx(t),n=Tx(e,!0);if(i!==II||!Bx(MI,n)||Bx(OI,n)){var r=DI(i,n);return!r||!Bx(MI,n)||Bx(i,bI)&&i[bI][n]||(r.enumerable=!0),r}},XI=function(t){var e=PI(Sx(t)),i=[];return vI(e,(function(t){Bx(MI,t)||Bx(gC,t)||i.push(t)})),i},qI=function(t){var e=t===II,i=PI(e?OI:Sx(t)),n=[];return vI(i,(function(t){!Bx(MI,t)||e&&!Bx(II,t)||n.push(MI[t])})),n};if(OC||(xw((EI=function(){if(this instanceof EI)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=fC(t),i=function(t){this===II&&i.call(OI,t),Bx(this,bI)&&Bx(this[bI],e)&&(this[bI][e]=!1),VI(this,e,bx(1,t))};return gx&&kI&&VI(II,e,{configurable:!0,set:i}),UI(e,t)}).prototype,"toString",(function(){return wI(this).tag})),xw(EI,"withoutSetter",(function(t){return UI(fC(t),t)})),vx.f=zI,Wx.f=GI,Fx.f=HI,lI.f=pI.f=XI,dI.f=qI,fI.f=function(t){return UI(kC(t),t)},gx&&TI(EI.prototype,"description",{configurable:!0,get:function(){return wI(this).description}})),tC({global:!0,wrap:!0,forced:!OC,sham:!OC},{Symbol:EI}),vI(ew(NI),(function(t){mI(t)})),tC({target:"Symbol",stat:!0,forced:!OC},{for:function(t){var e=String(t);if(Bx(LI,e))return LI[e];var i=EI(e);return LI[e]=i,RI[i]=e,i},keyFor:function(t){if(!jI(t))throw TypeError(t+" is not a symbol");if(Bx(RI,t))return RI[t]},useSetter:function(){kI=!0},useSimple:function(){kI=!1}}),tC({target:"Object",stat:!0,forced:!OC,sham:!gx},{create:function(t,e){return void 0===e?cw(t):QI(cw(t),e)},defineProperty:GI,defineProperties:QI,getOwnPropertyDescriptor:HI}),tC({target:"Object",stat:!0,forced:!OC},{getOwnPropertyNames:XI,getOwnPropertySymbols:qI}),tC({target:"Object",stat:!0,forced:mx((function(){dI.f(1)}))},{getOwnPropertySymbols:function(t){return dI.f(DC(t))}}),SI){var YI=!OC||mx((function(){var t=EI();return"[null]"!=SI([t])||"{}"!=SI({a:t})||"{}"!=SI(Object(t))}));tC({target:"JSON",stat:!0,forced:YI},{stringify:function(t,e,i){for(var n,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);if(n=e,(Dx(e)||void 0!==t)&&!jI(t))return jw(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!jI(e))return e}),r[1]=e,SI.apply(null,r)}})}EI.prototype[xI]||Jx(EI.prototype,xI,EI.prototype.valueOf),Aw(EI,"Symbol"),gC[bI]=!0,mI("asyncIterator"),mI("hasInstance"),mI("isConcatSpreadable"),mI("iterator"),mI("match"),mI("matchAll"),mI("replace"),mI("search"),mI("species"),mI("split"),mI("toPrimitive"),mI("toStringTag"),mI("unscopables"),Aw(_x.JSON,"JSON",!0);var KI=Hx.Symbol,WI=KI,JI=function(t,e,i,n){try{return n?e(Yx(i)[0],i[1]):e(i)}catch(e){throw function(t){var e=t.return;if(void 0!==e)Yx(e.call(t)).value}(t),e}},ZI=kC("iterator"),$I=Array.prototype,tE=function(t){return void 0!==t&&(iC.Array===t||$I[ZI]===t)},eE=kC("iterator"),iE=!1;try{var nE=0,rE={next:function(){return{done:!!nE++}},return:function(){iE=!0}};rE[eE]=function(){return this},Array.from(rE,(function(){throw 2}))}catch(ip){}var oE=!function(t,e){if(!e&&!iE)return!1;var i=!1;try{var n={};n[eE]=function(){return{next:function(){return{done:i=!0}}}},t(n)}catch(t){}return i}((function(t){Array.from(t)}));tC({target:"Array",stat:!0,forced:oE},{from:function(t){var e,i,n,r,o,s,a=DC(t),l="function"==typeof this?this:Array,u=arguments.length,c=u>1?arguments[1]:void 0,h=void 0!==c,p=Vw(a),d=0;if(h&&(c=qx(c,u>2?arguments[2]:void 0,2)),null==p||l==Array&&tE(p))for(i=new l(e=XC(a.length));e>d;d++)s=h?c(a[d],d):a[d],qw(i,d,s);else for(o=(r=p.call(a)).next,i=new l;!(n=o.call(r)).done;d++)s=h?JI(r,c,[n.value,d],!0):n.value,qw(i,d,s);return i.length=d,i}});var sE=Hx.Array.from,aE=sE,lE=function(t){return Hx[t+"Prototype"]},uE=lE("Array").concat,cE=Array.prototype,hE=function(t){var e=t.concat;return t===cE||t instanceof Array&&e===cE.concat?uE:e},pE=function(t,e){var i=[][t];return!!i&&mx((function(){i.call(null,e||function(){throw 1},1)}))},dE=Object.defineProperty,fE={},_E=function(t){throw t},mE=function(t,e){if(Bx(fE,t))return fE[t];e||(e={});var i=[][t],n=!!Bx(e,"ACCESSORS")&&e.ACCESSORS,r=Bx(e,0)?e[0]:_E,o=Bx(e,1)?e[1]:void 0;return fE[t]=!!i&&!mx((function(){if(n&&!gx)return!0;var t={length:-1};n?dE(t,1,{enumerable:!0,get:_E}):t[1]=1,i.call(t,r,o)}))},gE=JC.indexOf,yE=[].indexOf,AE=!!yE&&1/[1].indexOf(1,-0)<0,vE=pE("indexOf"),bE=mE("indexOf",{ACCESSORS:!0,1:0});tC({target:"Array",proto:!0,forced:AE||!vE||!bE},{indexOf:function(t){return AE?yE.apply(this,arguments)||0:gE(this,t,arguments.length>1?arguments[1]:void 0)}});var xE=lE("Array").indexOf,CE=Array.prototype,wE=function(t){var e=t.indexOf;return t===CE||t instanceof Array&&e===CE.indexOf?xE:e};tC({target:"Object",stat:!0,sham:!gx},{create:cw});var IE=Hx.Object,EE=function(t,e){return IE.create(t,e)},SE=zw;var DE=function(t){if(SE(t))return t},TE=kC("iterator"),PE=function(t){var e=Object(t);return void 0!==e[TE]||"@@iterator"in e||iC.hasOwnProperty(_w(e))};mI("asyncDispose"),mI("dispose"),mI("observable"),mI("patternMatch"),mI("replaceAll");var BE=KI;var ME=function(t,e){if(void 0!==BE&&PE(Object(t))){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=Uw(t);!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return i}},OE=sE,LE=iI("slice"),RE=mE("slice",{ACCESSORS:!0,0:0,1:2}),NE=kC("species"),FE=[].slice,kE=Math.max;tC({target:"Array",proto:!0,forced:!LE||!RE},{slice:function(t,e){var i,n,r,o=Sx(this),s=XC(o.length),a=KC(t,s),l=KC(void 0===e?s:e,s);if(jw(o)&&("function"!=typeof(i=o.constructor)||i!==Array&&!jw(i.prototype)?Dx(i)&&null===(i=i[NE])&&(i=void 0):i=void 0,i===Array||void 0===i))return FE.call(o,a,l);for(n=new(void 0===i?Array:i)(kE(l-a,0)),r=0;a<l;a++,r++)a in o&&qw(n,r,o[a]);return n.length=r,n}});var VE=lE("Array").slice,UE=Array.prototype,jE=function(t){var e=t.slice;return t===UE||t instanceof Array&&e===UE.slice?VE:e},GE=jE;var QE=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n};var zE=function(t,e){var i;if(t){if("string"==typeof t)return QE(t,e);var n=GE(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?OE(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?QE(t,e):void 0}};var HE=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var XE=function(t,e){return DE(t)||ME(t,e)||zE(t,e)||HE()},qE=AI.forEach,YE=pE("forEach"),KE=mE("forEach"),WE=YE&&KE?[].forEach:function(t){return qE(this,t,arguments.length>1?arguments[1]:void 0)};tC({target:"Array",proto:!0,forced:[].forEach!=WE},{forEach:WE});var JE=lE("Array").forEach,ZE=Array.prototype,$E={DOMTokenList:!0,NodeList:!0},tS=function(t){var e=t.forEach;return t===ZE||t instanceof Array&&e===ZE.forEach||$E.hasOwnProperty(_w(t))?JE:e},eS=JC.includes,iS=mE("indexOf",{ACCESSORS:!0,1:0});tC({target:"Array",proto:!0,forced:!iS},{includes:function(t){return eS(this,t,arguments.length>1?arguments[1]:void 0)}});var nS=lE("Array").includes,rS=kC("match"),oS=function(t){if(function(t){var e;return Dx(t)&&(void 0!==(e=t[rS])?!!e:"RegExp"==Cx(t))}(t))throw TypeError("The method doesn't accept regular expressions");return t},sS=kC("match");tC({target:"String",proto:!0,forced:!function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[sS]=!1,"/./"[t](e)}catch(t){}}return!1}("includes")},{includes:function(t){return!!~String(Ex(this)).indexOf(oS(t),arguments.length>1?arguments[1]:void 0)}});var aS=lE("String").includes,lS=Array.prototype,uS=String.prototype,cS=function(t){var e=t.includes;return t===lS||t instanceof Array&&e===lS.includes?nS:"string"==typeof t||t===uS||t instanceof String&&e===uS.includes?aS:e},hS="\t\n\v\f\r                　\u2028\u2029\ufeff",pS="["+hS+"]",dS=RegExp("^"+pS+pS+"*"),fS=RegExp(pS+pS+"*$"),_S=function(t){return function(e){var i=String(Ex(e));return 1&t&&(i=i.replace(dS,"")),2&t&&(i=i.replace(fS,"")),i}},mS={start:_S(1),end:_S(2),trim:_S(3)}.trim,gS=_x.parseInt,yS=/^[+-]?0[Xx]/,AS=8!==gS(hS+"08")||22!==gS(hS+"0x16")?function(t,e){var i=mS(String(t));return gS(i,e>>>0||(yS.test(i)?16:10))}:gS;tC({global:!0,forced:parseInt!=AS},{parseInt:AS});var vS=Hx.parseInt,bS=jE,xS=[],CS=xS.sort,wS=mx((function(){xS.sort(void 0)})),IS=mx((function(){xS.sort(null)})),ES=pE("sort");tC({target:"Array",proto:!0,forced:wS||!IS||!ES},{sort:function(t){return void 0===t?CS.call(DC(this)):CS.call(DC(this),Xx(t))}});var SS=lE("Array").sort,DS=Array.prototype,TS=function(t){var e=t.sort;return t===DS||t instanceof Array&&e===DS.sort?SS:e},PS=function(){var t=Yx(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e},BS=function(t){return PS.call(t)},MS=RegExp.prototype,OS=function(t){return(t===MS||t instanceof RegExp)&&!("flags"in t)?BS(t):t.flags},LS=jc((function(t,e){eC(e,"__esModule",{value:!0}),e.default=void 0;var i=dx(Uw),n=dx(Hw),r=dx(Xw),o=dx(WI),s=dx(aE),a=dx(hE),l=dx(wE),u=dx(EE),c=dx(XE),h=dx(tS),p=dx(cS),d=dx(vS),f=dx(bS),_=dx(TS),m=dx(OS);function g(t,e){var a;if(void 0===o.default||null==(0,r.default)(t)){if((0,n.default)(t)||(a=function(t,e){var i;if(!t)return;if("string"==typeof t)return y(t,e);var n=(0,f.default)(i=Object.prototype.toString.call(t)).call(i,8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return(0,s.default)(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var l=0,u=function(){};return{s:u,n:function(){return l>=t.length?{done:!0}:{done:!1,value:t[l++]}},e:function(t){throw t},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,h=!0,p=!1;return{s:function(){a=(0,i.default)(t)},n:function(){var t=a.next();return h=t.done,t},e:function(t){p=!0,c=t},f:function(){try{h||null==a.return||a.return()}finally{if(p)throw c}}}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}
/*!
     * XRegExp 4.4.0
     * <xregexp.com>
     * Steven Levithan (c) 2007-present MIT License
     */var A={astral:!1,namespacing:!1},v={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},b={},x={},C={},w=[],I={default:/\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u(?:[\dA-Fa-f]{4}|{[\dA-Fa-f]+})|c[A-Za-z]|[\s\S])|\(\?(?:[:=!]|<[=!])|[?*+]\?|{\d+(?:,\d*)?}\??|[\s\S]/,class:/\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u(?:[\dA-Fa-f]{4}|{[\dA-Fa-f]+})|c[A-Za-z]|[\s\S])|[\s\S]/},E=/\$(?:{([\w$]+)}|<([\w$]+)>|(\d\d?|[\s\S]))/g,S=void 0===v.exec.call(/()??/,"")[1],D=void 0!==(0,m.default)(/x/),T={}.toString;function P(t){var e=!0;try{if(new RegExp("",t),"y"===t){".."===".a".replace(new RegExp("a","gy"),".")&&(e=!1)}}catch(t){e=!1}return e}var B=P("u"),M=P("y"),O={g:!0,i:!0,m:!0,u:B,y:M};function L(t,e,i,n,r){var o;if(t.xregexp={captureNames:e},r)return t;if(t.__proto__)t.__proto__=Y.prototype;else for(var s in Y.prototype)t[s]=Y.prototype[s];return t.xregexp.source=i,t.xregexp.flags=n?(0,_.default)(o=n.split("")).call(o).join(""):n,t}function R(t){return v.replace.call(t,/([\s\S])(?=[\s\S]*\1)/g,"")}function N(t,e){var i;if(!Y.isRegExp(t))throw new TypeError("Type RegExp expected");var n=t.xregexp||{},r=function(t){return D?(0,m.default)(t):v.exec.call(/\/([a-z]*)$/i,RegExp.prototype.toString.call(t))[1]}(t),o="",s="",a=null,l=null;return(e=e||{}).removeG&&(s+="g"),e.removeY&&(s+="y"),s&&(r=v.replace.call(r,new RegExp("[".concat(s,"]+"),"g"),"")),e.addG&&(o+="g"),e.addY&&(o+="y"),o&&(r=R(r+o)),e.isInternalOnly||(void 0!==n.source&&(a=n.source),null!=(0,m.default)(n)&&(l=o?R((0,m.default)(n)+o):(0,m.default)(n))),t=L(new RegExp(e.source||t.source,r),function(t){return!(!t.xregexp||!t.xregexp.captureNames)}(t)?(0,f.default)(i=n.captureNames).call(i,0):null,a,l,e.isInternalOnly)}function F(t){return(0,d.default)(t,16)}function k(t,e,i){return"("===t.input[t.index-1]||")"===t.input[t.index+t[0].length]||"|"===t.input[t.index-1]||"|"===t.input[t.index+t[0].length]||t.index<1||t.index+t[0].length>=t.input.length||v.test.call(/^\(\?[:=!]/,t.input.substr(t.index-3,3))||function(t,e,i){return v.test.call((0,p.default)(i).call(i,"x")?/^(?:\s|#[^#\n]*|\(\?#[^)]*\))*(?:[?*+]|{\d+(?:,\d*)?})/:/^(?:\(\?#[^)]*\))*(?:[?*+]|{\d+(?:,\d*)?})/,(0,f.default)(t).call(t,e))}(t.input,t.index+t[0].length,i)?"":"(?:)"}function V(t){return(0,d.default)(t,10).toString(16)}function U(t,e){return T.call(t)==="[object ".concat(e,"]")}function j(t){for(;t.length<4;)t="0".concat(t);return t}function G(t){var e={};return U(t,"String")?((0,h.default)(Y).call(Y,t,/[^\s,]+/,(function(t){e[t]=!0})),e):t}function Q(t){if(!/^[\w$]$/.test(t))throw new Error("Flag must be a single character A-Za-z0-9_$");O[t]=!0}function z(t,e,i,n,r){for(var o,s,a=w.length,l=t[i],u=null;a--;)if(!((s=w[a]).leadChar&&s.leadChar!==l||s.scope!==n&&"all"!==s.scope||s.flag&&!(0,p.default)(e).call(e,s.flag))&&(o=Y.exec(t,s.regex,i,"sticky"))){u={matchLength:o[0].length,output:s.handler.call(r,o,n,e),reparse:s.reparse};break}return u}function H(t){A.astral=t}function X(t){A.namespacing=t}function q(t){if(null==t)throw new TypeError("Cannot convert null or undefined to object");return t}function Y(t,e){if(Y.isRegExp(t)){if(void 0!==e)throw new TypeError("Cannot supply flags when copying a RegExp");return N(t)}if(t=void 0===t?"":String(t),e=void 0===e?"":String(e),Y.isInstalled("astral")&&!(0,p.default)(e).call(e,"A")&&(e+="A"),C[t]||(C[t]={}),!C[t][e]){for(var i,n={hasNamedCapture:!1,captureNames:[]},r="default",o="",s=0,a=function(t,e){if(R(e)!==e)throw new SyntaxError("Invalid duplicate regex flag ".concat(e));t=v.replace.call(t,/^\(\?([\w$]+)\)/,(function(t,i){if(v.test.call(/[gy]/,i))throw new SyntaxError("Cannot use flag g or y in mode modifier ".concat(t));return e=R(e+i),""}));var i,n=g(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!O[r])throw new SyntaxError("Unknown regex flag ".concat(r))}}catch(t){n.e(t)}finally{n.f()}return{pattern:t,flags:e}}(t,e),l=a.pattern,u=(0,m.default)(a);s<l.length;){do{(i=z(l,u,s,r,n))&&i.reparse&&(l=(0,f.default)(l).call(l,0,s)+i.output+(0,f.default)(l).call(l,s+i.matchLength))}while(i&&i.reparse);if(i)o+=i.output,s+=i.matchLength||1;else{var h=Y.exec(l,I[r],s,"sticky"),d=(0,c.default)(h,1)[0];o+=d,s+=d.length,"["===d&&"default"===r?r="class":"]"===d&&"class"===r&&(r="default")}}C[t][e]={pattern:v.replace.call(o,/(?:\(\?:\))+/g,"(?:)"),flags:v.replace.call(u,/[^gimuy]+/g,""),captures:n.hasNamedCapture?n.captureNames:null}}var _=C[t][e];return L(new RegExp(_.pattern,(0,m.default)(_)),_.captures,t,e)}Y.prototype=/(?:)/,Y.version="4.4.0",Y._clipDuplicates=R,Y._hasNativeFlag=P,Y._dec=F,Y._hex=V,Y._pad4=j,Y.addToken=function(t,e,i){var n=(i=i||{}).optionalFlags;if(i.flag&&Q(i.flag),n){var r,o=g(n=v.split.call(n,""));try{for(o.s();!(r=o.n()).done;){Q(r.value)}}catch(t){o.e(t)}finally{o.f()}}w.push({regex:N(t,{addG:!0,addY:M,isInternalOnly:!0}),handler:e,scope:i.scope||"default",flag:i.flag,reparse:i.reparse,leadChar:i.leadChar}),Y.cache.flush("patterns")},Y.cache=function(t,e){return x[t]||(x[t]={}),x[t][e]||(x[t][e]=Y(t,e))},Y.cache.flush=function(t){"patterns"===t?C={}:x={}},Y.escape=function(t){return v.replace.call(q(t),/[-\[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},Y.exec=function(t,e,i,n){var r,o,s="g",a=!1;(r=M&&!!(n||e.sticky&&!1!==n))?s+="y":n&&(a=!0,s+="FakeY"),e.xregexp=e.xregexp||{};var l=e.xregexp[s]||(e.xregexp[s]=N(e,{addG:!0,addY:r,source:a?"".concat(e.source,"|()"):void 0,removeY:!1===n,isInternalOnly:!0}));return i=i||0,l.lastIndex=i,o=b.exec.call(l,t),a&&o&&""===o.pop()&&(o=null),e.global&&(e.lastIndex=o?l.lastIndex:0),o},Y.forEach=function(t,e,i){for(var n,r=0,o=-1;n=Y.exec(t,e,r);)i(n,++o,t,e),r=n.index+(n[0].length||1)},Y.globalize=function(t){return N(t,{addG:!0})},Y.install=function(t){t=G(t),!A.astral&&t.astral&&H(!0),!A.namespacing&&t.namespacing&&X(!0)},Y.isInstalled=function(t){return!!A[t]},Y.isRegExp=function(t){return"[object RegExp]"===T.call(t)},Y.match=function(t,e,i){var n=e.global&&"one"!==i||"all"===i,r=(n?"g":"")+(e.sticky?"y":"")||"noGY";e.xregexp=e.xregexp||{};var o=e.xregexp[r]||(e.xregexp[r]=N(e,{addG:!!n,removeG:"one"===i,isInternalOnly:!0})),s=v.match.call(q(t),o);return e.global&&(e.lastIndex="one"===i&&s?s.index+s[0].length:0),n?s||[]:s&&s[0]},Y.matchChain=function(t,e){return function t(i,n){var r=e[n].regex?e[n]:{regex:e[n]},o=[];function s(t){if(r.backref){var e="Backreference to undefined group: ".concat(r.backref),i=isNaN(r.backref);if(i&&Y.isInstalled("namespacing")){if(!(r.backref in t.groups))throw new ReferenceError(e)}else if(!t.hasOwnProperty(r.backref))throw new ReferenceError(e);var n=i&&Y.isInstalled("namespacing")?t.groups[r.backref]:t[r.backref];o.push(n||"")}else o.push(t[0])}var a,l=g(i);try{for(l.s();!(a=l.n()).done;){var u=a.value;(0,h.default)(Y).call(Y,u,r.regex,s)}}catch(t){l.e(t)}finally{l.f()}return n!==e.length-1&&o.length?t(o,n+1):o}([t],0)},Y.replace=function(t,e,i,n){var r=Y.isRegExp(e),o=e.global&&"one"!==n||"all"===n,s=(o?"g":"")+(e.sticky?"y":"")||"noGY",a=e;r?(e.xregexp=e.xregexp||{},a=e.xregexp[s]||(e.xregexp[s]=N(e,{addG:!!o,removeG:"one"===n,isInternalOnly:!0}))):o&&(a=new RegExp(Y.escape(String(e)),"g"));var l=b.replace.call(q(t),a,i);return r&&e.global&&(e.lastIndex=0),l},Y.replaceEach=function(t,e){var i,n=g(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;t=Y.replace(t,r[0],r[1],r[2])}}catch(t){n.e(t)}finally{n.f()}return t},Y.split=function(t,e,i){return b.split.call(q(t),e,i)},Y.test=function(t,e,i,n){return!!Y.exec(t,e,i,n)},Y.uninstall=function(t){t=G(t),A.astral&&t.astral&&H(!1),A.namespacing&&t.namespacing&&X(!1)},Y.union=function(t,e,i){var n,r,o=(i=i||{}).conjunction||"or",s=0;function a(t,e,i){var o=r[s-n];if(e){if(++s,o)return"(?<".concat(o,">")}else if(i)return"\\".concat(+i+n);return t}if(!U(t,"Array")||!t.length)throw new TypeError("Must provide a nonempty array of patterns to merge");var l,u=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*\]/g,c=[],h=g(t);try{for(h.s();!(l=h.n()).done;){var p=l.value;Y.isRegExp(p)?(n=s,r=p.xregexp&&p.xregexp.captureNames||[],c.push(v.replace.call(Y(p.source).source,u,a))):c.push(Y.escape(p))}}catch(t){h.e(t)}finally{h.f()}var d="none"===o?"":"|";return Y(c.join(d),e)},b.exec=function(t){var e=this.lastIndex,i=v.exec.apply(this,arguments);if(i){if(!S&&i.length>1&&(0,p.default)(i).call(i,"")){var n,r=N(this,{removeG:!0,isInternalOnly:!0});v.replace.call((0,f.default)(n=String(t)).call(n,i.index),r,(function(){for(var t=arguments.length,e=1;e<t-2;++e)void 0===(e<0||arguments.length<=e?void 0:arguments[e])&&(i[e]=void 0)}))}var o=i;if(Y.isInstalled("namespacing")&&(i.groups=(0,u.default)(null),o=i.groups),this.xregexp&&this.xregexp.captureNames)for(var s=1;s<i.length;++s){var a=this.xregexp.captureNames[s-1];a&&(o[a]=i[s])}this.global&&!i[0].length&&this.lastIndex>i.index&&(this.lastIndex=i.index)}return this.global||(this.lastIndex=e),i},b.test=function(t){return!!b.exec.call(this,t)},b.match=function(t){if(Y.isRegExp(t)){if(t.global){var e=v.match.apply(this,arguments);return t.lastIndex=0,e}}else t=new RegExp(t);return b.exec.call(t,q(this))},b.replace=function(t,e){var i,n,r,o=Y.isRegExp(t);return o?(t.xregexp&&(n=t.xregexp.captureNames),i=t.lastIndex):t+="",r=U(e,"Function")?v.replace.call(String(this),t,(function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];if(n){var a;Y.isInstalled("namespacing")?(a=(0,u.default)(null),r.push(a)):(r[0]=new String(r[0]),a=r[0]);for(var l=0;l<n.length;++l)n[l]&&(a[n[l]]=r[l+1])}return o&&t.global&&(t.lastIndex=r[r.length-2]+r[0].length),e.apply(void 0,r)})):v.replace.call(null==this?this:String(this),t,(function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return v.replace.call(String(e),E,o);function o(t,e,r,o){if(e=e||r){var s=+e;if(s<=i.length-3)return i[s]||"";if((s=n?(0,l.default)(n).call(n,e):-1)<0)throw new SyntaxError("Backreference to undefined group ".concat(t));return i[s+1]||""}if("$"===o)return"$";if("&"===o||0==+o)return i[0];var a,u;if("`"===o)return(0,f.default)(a=i[i.length-1]).call(a,0,i[i.length-2]);if("'"===o)return(0,f.default)(u=i[i.length-1]).call(u,i[i.length-2]+i[0].length);if(o=+o,!isNaN(o)){if(o>i.length-3)throw new SyntaxError("Backreference to undefined group ".concat(t));return i[o]||""}throw new SyntaxError("Invalid token ".concat(t))}})),o&&(t.global?t.lastIndex=0:t.lastIndex=i),r},b.split=function(t,e){if(!Y.isRegExp(t))return v.split.apply(this,arguments);var i,n=String(this),r=[],o=t.lastIndex,s=0;return e=(void 0===e?-1:e)>>>0,(0,h.default)(Y).call(Y,n,t,(function(t){t.index+t[0].length>s&&(r.push((0,f.default)(n).call(n,s,t.index)),t.length>1&&t.index<n.length&&Array.prototype.push.apply(r,(0,f.default)(t).call(t,1)),i=t[0].length,s=t.index+i)})),s===n.length?v.test.call(t,"")&&!i||r.push(""):r.push((0,f.default)(n).call(n,s)),t.lastIndex=o,r.length>e?(0,f.default)(r).call(r,0,e):r},Y.addToken(/\\([ABCE-RTUVXYZaeg-mopqyz]|c(?![A-Za-z])|u(?![\dA-Fa-f]{4}|{[\dA-Fa-f]+})|x(?![\dA-Fa-f]{2}))/,(function(t,e){if("B"===t[1]&&"default"===e)return t[0];throw new SyntaxError("Invalid escape ".concat(t[0]))}),{scope:"all",leadChar:"\\"}),Y.addToken(/\\u{([\dA-Fa-f]+)}/,(function(t,e,i){var n=F(t[1]);if(n>1114111)throw new SyntaxError("Invalid Unicode code point ".concat(t[0]));if(n<=65535)return"\\u".concat(j(V(n)));if(B&&(0,p.default)(i).call(i,"u"))return t[0];throw new SyntaxError("Cannot use Unicode code point above \\u{FFFF} without flag u")}),{scope:"all",leadChar:"\\"}),Y.addToken(/\[(\^?)\]/,(function(t){return t[1]?"[\\s\\S]":"\\b\\B"}),{leadChar:"["}),Y.addToken(/\(\?#[^)]*\)/,k,{leadChar:"("}),Y.addToken(/\s+|#[^\n]*\n?/,k,{flag:"x"}),Y.addToken(/\./,(function(){return"[\\s\\S]"}),{flag:"s",leadChar:"."}),Y.addToken(/\\k<([\w$]+)>/,(function(t){var e,i,n=isNaN(t[1])?(0,l.default)(e=this.captureNames).call(e,t[1])+1:+t[1],r=t.index+t[0].length;if(!n||n>this.captureNames.length)throw new SyntaxError("Backreference to undefined group ".concat(t[0]));return(0,a.default)(i="\\".concat(n)).call(i,r===t.input.length||isNaN(t.input[r])?"":"(?:)")}),{leadChar:"\\"}),Y.addToken(/\\(\d+)/,(function(t,e){if(!("default"===e&&/^[1-9]/.test(t[1])&&+t[1]<=this.captureNames.length)&&"0"!==t[1])throw new SyntaxError("Cannot use octal escape or backreference to undefined group ".concat(t[0]));return t[0]}),{scope:"all",leadChar:"\\"}),Y.addToken(/\(\?P?<([\w$]+)>/,(function(t){var e;if(!isNaN(t[1]))throw new SyntaxError("Cannot use integer as capture name ".concat(t[0]));if(!Y.isInstalled("namespacing")&&("length"===t[1]||"__proto__"===t[1]))throw new SyntaxError("Cannot use reserved word as capture name ".concat(t[0]));if((0,p.default)(e=this.captureNames).call(e,t[1]))throw new SyntaxError("Cannot use same name for multiple groups ".concat(t[0]));return this.captureNames.push(t[1]),this.hasNamedCapture=!0,"("}),{leadChar:"("}),Y.addToken(/\((?!\?)/,(function(t,e,i){return(0,p.default)(i).call(i,"n")?"(?:":(this.captureNames.push(null),"(")}),{optionalFlags:"n",leadChar:"("});var K=Y;e.default=K,t.exports=e.default}));Uc(LS);var RS=AI.map,NS=iI("map"),FS=mE("map");tC({target:"Array",proto:!0,forced:!NS||!FS},{map:function(t){return RS(this,t,arguments.length>1?arguments[1]:void 0)}});var kS=lE("Array").map,VS=Array.prototype,US=function(t){var e=t.map;return t===VS||t instanceof Array&&e===VS.map?kS:e},jS=function(t){return function(e,i,n,r){Xx(i);var o=DC(e),s=Ix(o),a=XC(o.length),l=t?a-1:0,u=t?-1:1;if(n<2)for(;;){if(l in s){r=s[l],l+=u;break}if(l+=u,t?l<0:a<=l)throw TypeError("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=u)l in s&&(r=i(r,s[l],l,o));return r}},GS={left:jS(!1),right:jS(!0)},QS="process"==Cx(_x.process),zS=GS.left,HS=pE("reduce"),XS=mE("reduce",{1:0});tC({target:"Array",proto:!0,forced:!HS||!XS||!QS&&tI>79&&tI<83},{reduce:function(t){return zS(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var qS=lE("Array").reduce,YS=Array.prototype,KS=function(t){var e=t.reduce;return t===YS||t instanceof Array&&e===YS.reduce?qS:e},WS=jc((function(t,e){eC(e,"__esModule",{value:!0}),e.default=void 0;var i=dx(hE),n=dx(cS),r=dx(US),o=dx(KS);e.default=function(t){var e=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*\]/g,s=t.union([/\({{([\w$]+)}}\)|{{([\w$]+)}}/,e],"g",{conjunction:"or"});function a(t){var e=/^(?:\(\?:\))*\^/,i=/\$(?:\(\?:\))*$/;return e.test(t)&&i.test(t)&&i.test(t.replace(/\\[\s\S]/g,""))?t.replace(e,"").replace(i,""):t}function l(e,i){var n=i?"x":"";return t.isRegExp(e)?e.xregexp&&e.xregexp.captureNames?e:t(e.source,n):t(e,n)}function u(e){return e instanceof RegExp?e:t.escape(e)}function c(t,e,i){return t["subpattern".concat(i)]=e,t}function h(t,e,i){return t+(e<i.length-1?"{{subpattern".concat(e,"}}"):"")}t.tag=function(e){return function(i){for(var n,s,a=arguments.length,l=new Array(a>1?a-1:0),p=1;p<a;p++)l[p-1]=arguments[p];var d=(0,o.default)(n=(0,r.default)(l).call(l,u)).call(n,c,{}),f=(0,r.default)(s=i.raw).call(s,h).join("");return t.build(f,d,e)}},t.build=function(r,o,u){u=u||"";var c=(0,n.default)(u).call(u,"x"),h=/^\(\?([\w$]+)\)/.exec(r);h&&(u=t._clipDuplicates(u+h[1]));var p={};for(var d in o)if(o.hasOwnProperty(d)){var f=l(o[d],c);p[d]={pattern:a(f.source),names:f.xregexp.captureNames||[]}}var _,m=l(r,c),g=0,y=0,A=[0],v=m.xregexp.captureNames||[],b=m.source.replace(s,(function(t,n,r,o,s){var a,l,u,c=n||r;if(c){var h;if(!p.hasOwnProperty(c))throw new ReferenceError("Undefined property ".concat(t));n?(a=v[y],A[++y]=++g,l="(?<".concat(a||c,">")):l="(?:",_=g;var d=p[c].pattern.replace(e,(function(t,e,i){if(e){if(a=p[c].names[g-_],++g,a)return"(?<".concat(a,">")}else if(i)return u=+i-1,p[c].names[u]?"\\k<".concat(p[c].names[u],">"):"\\".concat(+i+_);return t}));return(0,i.default)(h="".concat(l)).call(h,d,")")}if(o){if(a=v[y],A[++y]=++g,a)return"(?<".concat(a,">")}else if(s)return v[u=+s-1]?"\\k<".concat(v[u],">"):"\\".concat(A[+s]);return t}));return t(b,u)}},t.exports=e.default}));Uc(WS);var JS=jc((function(t,e){eC(e,"__esModule",{value:!0}),e.default=void 0;var i=dx(bS),n=dx(hE),r=dx(cS);e.default=function(t){function e(t,e,i,n){return{name:t,value:e,start:i,end:n}}t.matchRecursive=function(o,s,a,l,u){l=l||"",u=u||{};var c,h,p,d,f,_=(0,r.default)(l).call(l,"g"),m=(0,r.default)(l).call(l,"y"),g=l.replace(/y/g,""),y=u.escapeChar,A=u.valueNames,v=[],b=0,x=0,C=0,w=0;if(s=t(s,g),a=t(a,g),y){var I,E;if(y.length>1)throw new Error("Cannot use more than one escape character");y=t.escape(y),f=new RegExp((0,n.default)(I=(0,n.default)(E="(?:".concat(y,"[\\S\\s]|(?:(?!")).call(E,t.union([s,a],"",{conjunction:"or"}).source,")[^")).call(I,y,"])+)+"),l.replace(/[^imu]+/g,""))}for(;;){if(y&&(C+=(t.exec(o,f,C,"sticky")||[""])[0].length),p=t.exec(o,s,C),d=t.exec(o,a,C),p&&d&&(p.index<=d.index?d=null:p=null),p||d)C=(x=(p||d).index)+(p||d)[0].length;else if(!b)break;if(m&&!b&&x>w)break;if(p)b||(c=x,h=C),++b;else{if(!d||!b)throw new Error("Unbalanced delimiter found in string");if(!--b&&(A?(A[0]&&c>w&&v.push(e(A[0],(0,i.default)(o).call(o,w,c),w,c)),A[1]&&v.push(e(A[1],(0,i.default)(o).call(o,c,h),c,h)),A[2]&&v.push(e(A[2],(0,i.default)(o).call(o,h,x),h,x)),A[3]&&v.push(e(A[3],(0,i.default)(o).call(o,x,C),x,C))):v.push((0,i.default)(o).call(o,h,x)),w=C,!_))break}x===C&&++C}return _&&!m&&A&&A[0]&&o.length>w&&v.push(e(A[0],(0,i.default)(o).call(o,w),w,o.length)),v}},t.exports=e.default}));Uc(JS);var ZS=jc((function(t,e){eC(e,"__esModule",{value:!0}),e.default=void 0;var i=dx(Uw),n=dx(Hw),r=dx(Xw),o=dx(WI),s=dx(aE),a=dx(bS),l=dx(cS),u=dx(hE),c=dx(tS);function h(t,e){var l;if(void 0===o.default||null==(0,r.default)(t)){if((0,n.default)(t)||(l=function(t,e){var i;if(!t)return;if("string"==typeof t)return p(t,e);var n=(0,a.default)(i=Object.prototype.toString.call(t)).call(i,8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return(0,s.default)(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){l&&(t=l);var u=0,c=function(){};return{s:c,n:function(){return u>=t.length?{done:!0}:{done:!1,value:t[u++]}},e:function(t){throw t},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h,d=!0,f=!1;return{s:function(){l=(0,i.default)(t)},n:function(){var t=l.next();return d=t.done,t},e:function(t){f=!0,h=t},f:function(){try{d||null==l.return||l.return()}finally{if(f)throw h}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}
/*!
     * XRegExp Unicode Base 4.4.0
     * <xregexp.com>
     * Steven Levithan (c) 2008-present MIT License
     */e.default=function(t){var e={},i=t._dec,n=t._hex,r=t._pad4;function o(t){return t.replace(/[- _]+/g,"").toLowerCase()}function s(t){var e=/^\\[xu](.+)/.exec(t);return e?i(e[1]):t.charCodeAt("\\"===t[0]?1:0)}function a(i){var o,a,l;return e[i]["b!"]||(e[i]["b!"]=(o=e[i].bmp,a="",l=-1,(0,c.default)(t).call(t,o,/(\\x..|\\u....|\\?[\s\S])(?:-(\\x..|\\u....|\\?[\s\S]))?/,(function(t){var e=s(t[1]);e>l+1&&(a+="\\u".concat(r(n(l+1))),e>l+2&&(a+="-\\u".concat(r(n(e-1))))),l=s(t[2]||t[1])})),l<65535&&(a+="\\u".concat(r(n(l+1))),l<65534&&(a+="-\\uFFFF")),a))}function p(t,i){var n=i?"a!":"a=";return e[t][n]||(e[t][n]=function(t,i){var n,r,o=e[t],s="";return o.bmp&&!o.isBmpLast&&(s=(0,u.default)(n="[".concat(o.bmp,"]")).call(n,o.astral?"|":"")),o.astral&&(s+=o.astral),o.isBmpLast&&o.bmp&&(s+=(0,u.default)(r="".concat(o.astral?"|":"","[")).call(r,o.bmp,"]")),i?"(?:(?!".concat(s,")(?:[\ud800-\udbff][\udc00-\udfff]|[\0-￿]))"):"(?:".concat(s,")")}(t,i))}t.addToken(/\\([pP])(?:{(\^?)([^}]*)}|([A-Za-z]))/,(function(t,i,n){var r="P"===t[1]||!!t[2],s=(0,l.default)(n).call(n,"A"),c=o(t[4]||t[3]),h=e[c];if("P"===t[1]&&t[2])throw new SyntaxError("Invalid double negation "+t[0]);if(!e.hasOwnProperty(c))throw new SyntaxError("Unknown Unicode token "+t[0]);if(h.inverseOf){var d;if(c=o(h.inverseOf),!e.hasOwnProperty(c))throw new ReferenceError((0,u.default)(d="".concat("Unicode token missing data "+t[0]," -> ")).call(d,h.inverseOf));h=e[c],r=!r}if(!h.bmp&&!s)throw new SyntaxError("Astral mode required for Unicode token "+t[0]);if(s){if("class"===i)throw new SyntaxError("Astral mode does not support Unicode tokens within character classes");return p(c,r)}return"class"===i?r?a(c):h.bmp:"".concat((r?"[^":"[")+h.bmp,"]")}),{scope:"all",optionalFlags:"A",leadChar:"\\"}),t.addUnicodeData=function(i){var n,r=h(i);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(!s.name)throw new Error("Unicode token requires name");if(!(s.inverseOf||s.bmp||s.astral))throw new Error("Unicode token has no character data "+s.name);e[o(s.name)]=s,s.alias&&(e[o(s.alias)]=s)}}catch(t){r.e(t)}finally{r.f()}t.cache.flush("patterns")},t._getUnicodeProperty=function(t){var i=o(t);return e[i]}},t.exports=e.default}));Uc(ZS);var $S=[{name:"InAdlam",astral:"\ud83a[\udd00-\udd5f]"},{name:"InAegean_Numbers",astral:"\ud800[\udd00-\udd3f]"},{name:"InAhom",astral:"\ud805[\udf00-\udf3f]"},{name:"InAlchemical_Symbols",astral:"\ud83d[\udf00-\udf7f]"},{name:"InAlphabetic_Presentation_Forms",bmp:"ﬀ-ﭏ"},{name:"InAnatolian_Hieroglyphs",astral:"\ud811[\udc00-\ude7f]"},{name:"InAncient_Greek_Musical_Notation",astral:"\ud834[\ude00-\ude4f]"},{name:"InAncient_Greek_Numbers",astral:"\ud800[\udd40-\udd8f]"},{name:"InAncient_Symbols",astral:"\ud800[\udd90-\uddcf]"},{name:"InArabic",bmp:"؀-ۿ"},{name:"InArabic_Extended_A",bmp:"ࢠ-ࣿ"},{name:"InArabic_Mathematical_Alphabetic_Symbols",astral:"\ud83b[\ude00-\udeff]"},{name:"InArabic_Presentation_Forms_A",bmp:"ﭐ-﷿"},{name:"InArabic_Presentation_Forms_B",bmp:"ﹰ-\ufeff"},{name:"InArabic_Supplement",bmp:"ݐ-ݿ"},{name:"InArmenian",bmp:"԰-֏"},{name:"InArrows",bmp:"←-⇿"},{name:"InAvestan",astral:"\ud802[\udf00-\udf3f]"},{name:"InBalinese",bmp:"ᬀ-᭿"},{name:"InBamum",bmp:"ꚠ-꛿"},{name:"InBamum_Supplement",astral:"\ud81a[\udc00-\ude3f]"},{name:"InBasic_Latin",bmp:"\0-"},{name:"InBassa_Vah",astral:"\ud81a[\uded0-\udeff]"},{name:"InBatak",bmp:"ᯀ-᯿"},{name:"InBengali",bmp:"ঀ-৿"},{name:"InBhaiksuki",astral:"\ud807[\udc00-\udc6f]"},{name:"InBlock_Elements",bmp:"▀-▟"},{name:"InBopomofo",bmp:"㄀-ㄯ"},{name:"InBopomofo_Extended",bmp:"ㆠ-ㆿ"},{name:"InBox_Drawing",bmp:"─-╿"},{name:"InBrahmi",astral:"\ud804[\udc00-\udc7f]"},{name:"InBraille_Patterns",bmp:"⠀-⣿"},{name:"InBuginese",bmp:"ᨀ-᨟"},{name:"InBuhid",bmp:"ᝀ-᝟"},{name:"InByzantine_Musical_Symbols",astral:"\ud834[\udc00-\udcff]"},{name:"InCJK_Compatibility",bmp:"㌀-㏿"},{name:"InCJK_Compatibility_Forms",bmp:"︰-﹏"},{name:"InCJK_Compatibility_Ideographs",bmp:"豈-﫿"},{name:"InCJK_Compatibility_Ideographs_Supplement",astral:"\ud87e[\udc00-\ude1f]"},{name:"InCJK_Radicals_Supplement",bmp:"⺀-⻿"},{name:"InCJK_Strokes",bmp:"㇀-㇯"},{name:"InCJK_Symbols_And_Punctuation",bmp:"　-〿"},{name:"InCJK_Unified_Ideographs",bmp:"一-鿿"},{name:"InCJK_Unified_Ideographs_Extension_A",bmp:"㐀-䶿"},{name:"InCJK_Unified_Ideographs_Extension_B",astral:"[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\udedf]"},{name:"InCJK_Unified_Ideographs_Extension_C",astral:"\ud869[\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf3f]"},{name:"InCJK_Unified_Ideographs_Extension_D",astral:"\ud86d[\udf40-\udfff]|\ud86e[\udc00-\udc1f]"},{name:"InCJK_Unified_Ideographs_Extension_E",astral:"\ud86e[\udc20-\udfff]|[\ud86f-\ud872][\udc00-\udfff]|\ud873[\udc00-\udeaf]"},{name:"InCJK_Unified_Ideographs_Extension_F",astral:"\ud873[\udeb0-\udfff]|[\ud874-\ud879][\udc00-\udfff]|\ud87a[\udc00-\udfef]"},{name:"InCarian",astral:"\ud800[\udea0-\udedf]"},{name:"InCaucasian_Albanian",astral:"\ud801[\udd30-\udd6f]"},{name:"InChakma",astral:"\ud804[\udd00-\udd4f]"},{name:"InCham",bmp:"ꨀ-꩟"},{name:"InCherokee",bmp:"Ꭰ-᏿"},{name:"InCherokee_Supplement",bmp:"ꭰ-ꮿ"},{name:"InChess_Symbols",astral:"\ud83e[\ude00-\ude6f]"},{name:"InCombining_Diacritical_Marks",bmp:"̀-ͯ"},{name:"InCombining_Diacritical_Marks_Extended",bmp:"᪰-᫿"},{name:"InCombining_Diacritical_Marks_For_Symbols",bmp:"⃐-⃿"},{name:"InCombining_Diacritical_Marks_Supplement",bmp:"᷀-᷿"},{name:"InCombining_Half_Marks",bmp:"︠-︯"},{name:"InCommon_Indic_Number_Forms",bmp:"꠰-꠿"},{name:"InControl_Pictures",bmp:"␀-␿"},{name:"InCoptic",bmp:"Ⲁ-⳿"},{name:"InCoptic_Epact_Numbers",astral:"\ud800[\udee0-\udeff]"},{name:"InCounting_Rod_Numerals",astral:"\ud834[\udf60-\udf7f]"},{name:"InCuneiform",astral:"\ud808[\udc00-\udfff]"},{name:"InCuneiform_Numbers_And_Punctuation",astral:"\ud809[\udc00-\udc7f]"},{name:"InCurrency_Symbols",bmp:"₠-⃏"},{name:"InCypriot_Syllabary",astral:"\ud802[\udc00-\udc3f]"},{name:"InCyrillic",bmp:"Ѐ-ӿ"},{name:"InCyrillic_Extended_A",bmp:"ⷠ-ⷿ"},{name:"InCyrillic_Extended_B",bmp:"Ꙁ-ꚟ"},{name:"InCyrillic_Extended_C",bmp:"ᲀ-᲏"},{name:"InCyrillic_Supplement",bmp:"Ԁ-ԯ"},{name:"InDeseret",astral:"\ud801[\udc00-\udc4f]"},{name:"InDevanagari",bmp:"ऀ-ॿ"},{name:"InDevanagari_Extended",bmp:"꣠-ꣿ"},{name:"InDingbats",bmp:"✀-➿"},{name:"InDogra",astral:"\ud806[\udc00-\udc4f]"},{name:"InDomino_Tiles",astral:"\ud83c[\udc30-\udc9f]"},{name:"InDuployan",astral:"\ud82f[\udc00-\udc9f]"},{name:"InEarly_Dynastic_Cuneiform",astral:"\ud809[\udc80-\udd4f]"},{name:"InEgyptian_Hieroglyphs",astral:"\ud80c[\udc00-\udfff]|\ud80d[\udc00-\udc2f]"},{name:"InElbasan",astral:"\ud801[\udd00-\udd2f]"},{name:"InEmoticons",astral:"\ud83d[\ude00-\ude4f]"},{name:"InEnclosed_Alphanumeric_Supplement",astral:"\ud83c[\udd00-\uddff]"},{name:"InEnclosed_Alphanumerics",bmp:"①-⓿"},{name:"InEnclosed_CJK_Letters_And_Months",bmp:"㈀-㋿"},{name:"InEnclosed_Ideographic_Supplement",astral:"\ud83c[\ude00-\udeff]"},{name:"InEthiopic",bmp:"ሀ-፿"},{name:"InEthiopic_Extended",bmp:"ⶀ-⷟"},{name:"InEthiopic_Extended_A",bmp:"꬀-꬯"},{name:"InEthiopic_Supplement",bmp:"ᎀ-᎟"},{name:"InGeneral_Punctuation",bmp:" -⁯"},{name:"InGeometric_Shapes",bmp:"■-◿"},{name:"InGeometric_Shapes_Extended",astral:"\ud83d[\udf80-\udfff]"},{name:"InGeorgian",bmp:"Ⴀ-ჿ"},{name:"InGeorgian_Extended",bmp:"Ა-Ჿ"},{name:"InGeorgian_Supplement",bmp:"ⴀ-⴯"},{name:"InGlagolitic",bmp:"Ⰰ-ⱟ"},{name:"InGlagolitic_Supplement",astral:"\ud838[\udc00-\udc2f]"},{name:"InGothic",astral:"\ud800[\udf30-\udf4f]"},{name:"InGrantha",astral:"\ud804[\udf00-\udf7f]"},{name:"InGreek_And_Coptic",bmp:"Ͱ-Ͽ"},{name:"InGreek_Extended",bmp:"ἀ-῿"},{name:"InGujarati",bmp:"઀-૿"},{name:"InGunjala_Gondi",astral:"\ud807[\udd60-\uddaf]"},{name:"InGurmukhi",bmp:"਀-੿"},{name:"InHalfwidth_And_Fullwidth_Forms",bmp:"＀-￯"},{name:"InHangul_Compatibility_Jamo",bmp:"㄰-㆏"},{name:"InHangul_Jamo",bmp:"ᄀ-ᇿ"},{name:"InHangul_Jamo_Extended_A",bmp:"ꥠ-꥿"},{name:"InHangul_Jamo_Extended_B",bmp:"ힰ-퟿"},{name:"InHangul_Syllables",bmp:"가-힯"},{name:"InHanifi_Rohingya",astral:"\ud803[\udd00-\udd3f]"},{name:"InHanunoo",bmp:"ᜠ-᜿"},{name:"InHatran",astral:"\ud802[\udce0-\udcff]"},{name:"InHebrew",bmp:"֐-׿"},{name:"InHigh_Private_Use_Surrogates",bmp:"\udb80-\udbff"},{name:"InHigh_Surrogates",bmp:"\ud800-\udb7f"},{name:"InHiragana",bmp:"぀-ゟ"},{name:"InIPA_Extensions",bmp:"ɐ-ʯ"},{name:"InIdeographic_Description_Characters",bmp:"⿰-⿿"},{name:"InIdeographic_Symbols_And_Punctuation",astral:"\ud81b[\udfe0-\udfff]"},{name:"InImperial_Aramaic",astral:"\ud802[\udc40-\udc5f]"},{name:"InIndic_Siyaq_Numbers",astral:"\ud83b[\udc70-\udcbf]"},{name:"InInscriptional_Pahlavi",astral:"\ud802[\udf60-\udf7f]"},{name:"InInscriptional_Parthian",astral:"\ud802[\udf40-\udf5f]"},{name:"InJavanese",bmp:"ꦀ-꧟"},{name:"InKaithi",astral:"\ud804[\udc80-\udccf]"},{name:"InKana_Extended_A",astral:"\ud82c[\udd00-\udd2f]"},{name:"InKana_Supplement",astral:"\ud82c[\udc00-\udcff]"},{name:"InKanbun",bmp:"㆐-㆟"},{name:"InKangxi_Radicals",bmp:"⼀-⿟"},{name:"InKannada",bmp:"ಀ-೿"},{name:"InKatakana",bmp:"゠-ヿ"},{name:"InKatakana_Phonetic_Extensions",bmp:"ㇰ-ㇿ"},{name:"InKayah_Li",bmp:"꤀-꤯"},{name:"InKharoshthi",astral:"\ud802[\ude00-\ude5f]"},{name:"InKhmer",bmp:"ក-៿"},{name:"InKhmer_Symbols",bmp:"᧠-᧿"},{name:"InKhojki",astral:"\ud804[\ude00-\ude4f]"},{name:"InKhudawadi",astral:"\ud804[\udeb0-\udeff]"},{name:"InLao",bmp:"຀-໿"},{name:"InLatin_1_Supplement",bmp:"-ÿ"},{name:"InLatin_Extended_A",bmp:"Ā-ſ"},{name:"InLatin_Extended_Additional",bmp:"Ḁ-ỿ"},{name:"InLatin_Extended_B",bmp:"ƀ-ɏ"},{name:"InLatin_Extended_C",bmp:"Ⱡ-Ɀ"},{name:"InLatin_Extended_D",bmp:"꜠-ꟿ"},{name:"InLatin_Extended_E",bmp:"ꬰ-꭯"},{name:"InLepcha",bmp:"ᰀ-ᱏ"},{name:"InLetterlike_Symbols",bmp:"℀-⅏"},{name:"InLimbu",bmp:"ᤀ-᥏"},{name:"InLinear_A",astral:"\ud801[\ude00-\udf7f]"},{name:"InLinear_B_Ideograms",astral:"\ud800[\udc80-\udcff]"},{name:"InLinear_B_Syllabary",astral:"\ud800[\udc00-\udc7f]"},{name:"InLisu",bmp:"ꓐ-꓿"},{name:"InLow_Surrogates",bmp:"\udc00-\udfff"},{name:"InLycian",astral:"\ud800[\ude80-\ude9f]"},{name:"InLydian",astral:"\ud802[\udd20-\udd3f]"},{name:"InMahajani",astral:"\ud804[\udd50-\udd7f]"},{name:"InMahjong_Tiles",astral:"\ud83c[\udc00-\udc2f]"},{name:"InMakasar",astral:"\ud807[\udee0-\udeff]"},{name:"InMalayalam",bmp:"ഀ-ൿ"},{name:"InMandaic",bmp:"ࡀ-࡟"},{name:"InManichaean",astral:"\ud802[\udec0-\udeff]"},{name:"InMarchen",astral:"\ud807[\udc70-\udcbf]"},{name:"InMasaram_Gondi",astral:"\ud807[\udd00-\udd5f]"},{name:"InMathematical_Alphanumeric_Symbols",astral:"\ud835[\udc00-\udfff]"},{name:"InMathematical_Operators",bmp:"∀-⋿"},{name:"InMayan_Numerals",astral:"\ud834[\udee0-\udeff]"},{name:"InMedefaidrin",astral:"\ud81b[\ude40-\ude9f]"},{name:"InMeetei_Mayek",bmp:"ꯀ-꯿"},{name:"InMeetei_Mayek_Extensions",bmp:"ꫠ-꫿"},{name:"InMende_Kikakui",astral:"\ud83a[\udc00-\udcdf]"},{name:"InMeroitic_Cursive",astral:"\ud802[\udda0-\uddff]"},{name:"InMeroitic_Hieroglyphs",astral:"\ud802[\udd80-\udd9f]"},{name:"InMiao",astral:"\ud81b[\udf00-\udf9f]"},{name:"InMiscellaneous_Mathematical_Symbols_A",bmp:"⟀-⟯"},{name:"InMiscellaneous_Mathematical_Symbols_B",bmp:"⦀-⧿"},{name:"InMiscellaneous_Symbols",bmp:"☀-⛿"},{name:"InMiscellaneous_Symbols_And_Arrows",bmp:"⬀-⯿"},{name:"InMiscellaneous_Symbols_And_Pictographs",astral:"\ud83c[\udf00-\udfff]|\ud83d[\udc00-\uddff]"},{name:"InMiscellaneous_Technical",bmp:"⌀-⏿"},{name:"InModi",astral:"\ud805[\ude00-\ude5f]"},{name:"InModifier_Tone_Letters",bmp:"꜀-ꜟ"},{name:"InMongolian",bmp:"᠀-᢯"},{name:"InMongolian_Supplement",astral:"\ud805[\ude60-\ude7f]"},{name:"InMro",astral:"\ud81a[\ude40-\ude6f]"},{name:"InMultani",astral:"\ud804[\ude80-\udeaf]"},{name:"InMusical_Symbols",astral:"\ud834[\udd00-\uddff]"},{name:"InMyanmar",bmp:"က-႟"},{name:"InMyanmar_Extended_A",bmp:"ꩠ-ꩿ"},{name:"InMyanmar_Extended_B",bmp:"ꧠ-꧿"},{name:"InNKo",bmp:"߀-߿"},{name:"InNabataean",astral:"\ud802[\udc80-\udcaf]"},{name:"InNew_Tai_Lue",bmp:"ᦀ-᧟"},{name:"InNewa",astral:"\ud805[\udc00-\udc7f]"},{name:"InNumber_Forms",bmp:"⅐-↏"},{name:"InNushu",astral:"\ud82c[\udd70-\udeff]"},{name:"InOgham",bmp:" -᚟"},{name:"InOl_Chiki",bmp:"᱐-᱿"},{name:"InOld_Hungarian",astral:"\ud803[\udc80-\udcff]"},{name:"InOld_Italic",astral:"\ud800[\udf00-\udf2f]"},{name:"InOld_North_Arabian",astral:"\ud802[\ude80-\ude9f]"},{name:"InOld_Permic",astral:"\ud800[\udf50-\udf7f]"},{name:"InOld_Persian",astral:"\ud800[\udfa0-\udfdf]"},{name:"InOld_Sogdian",astral:"\ud803[\udf00-\udf2f]"},{name:"InOld_South_Arabian",astral:"\ud802[\ude60-\ude7f]"},{name:"InOld_Turkic",astral:"\ud803[\udc00-\udc4f]"},{name:"InOptical_Character_Recognition",bmp:"⑀-⑟"},{name:"InOriya",bmp:"଀-୿"},{name:"InOrnamental_Dingbats",astral:"\ud83d[\ude50-\ude7f]"},{name:"InOsage",astral:"\ud801[\udcb0-\udcff]"},{name:"InOsmanya",astral:"\ud801[\udc80-\udcaf]"},{name:"InPahawh_Hmong",astral:"\ud81a[\udf00-\udf8f]"},{name:"InPalmyrene",astral:"\ud802[\udc60-\udc7f]"},{name:"InPau_Cin_Hau",astral:"\ud806[\udec0-\udeff]"},{name:"InPhags_Pa",bmp:"ꡀ-꡿"},{name:"InPhaistos_Disc",astral:"\ud800[\uddd0-\uddff]"},{name:"InPhoenician",astral:"\ud802[\udd00-\udd1f]"},{name:"InPhonetic_Extensions",bmp:"ᴀ-ᵿ"},{name:"InPhonetic_Extensions_Supplement",bmp:"ᶀ-ᶿ"},{name:"InPlaying_Cards",astral:"\ud83c[\udca0-\udcff]"},{name:"InPrivate_Use_Area",bmp:"-"},{name:"InPsalter_Pahlavi",astral:"\ud802[\udf80-\udfaf]"},{name:"InRejang",bmp:"ꤰ-꥟"},{name:"InRumi_Numeral_Symbols",astral:"\ud803[\ude60-\ude7f]"},{name:"InRunic",bmp:"ᚠ-᛿"},{name:"InSamaritan",bmp:"ࠀ-࠿"},{name:"InSaurashtra",bmp:"ꢀ-꣟"},{name:"InSharada",astral:"\ud804[\udd80-\udddf]"},{name:"InShavian",astral:"\ud801[\udc50-\udc7f]"},{name:"InShorthand_Format_Controls",astral:"\ud82f[\udca0-\udcaf]"},{name:"InSiddham",astral:"\ud805[\udd80-\uddff]"},{name:"InSinhala",bmp:"඀-෿"},{name:"InSinhala_Archaic_Numbers",astral:"\ud804[\udde0-\uddff]"},{name:"InSmall_Form_Variants",bmp:"﹐-﹯"},{name:"InSogdian",astral:"\ud803[\udf30-\udf6f]"},{name:"InSora_Sompeng",astral:"\ud804[\udcd0-\udcff]"},{name:"InSoyombo",astral:"\ud806[\ude50-\udeaf]"},{name:"InSpacing_Modifier_Letters",bmp:"ʰ-˿"},{name:"InSpecials",bmp:"￰-￿"},{name:"InSundanese",bmp:"ᮀ-ᮿ"},{name:"InSundanese_Supplement",bmp:"᳀-᳏"},{name:"InSuperscripts_And_Subscripts",bmp:"⁰-₟"},{name:"InSupplemental_Arrows_A",bmp:"⟰-⟿"},{name:"InSupplemental_Arrows_B",bmp:"⤀-⥿"},{name:"InSupplemental_Arrows_C",astral:"\ud83e[\udc00-\udcff]"},{name:"InSupplemental_Mathematical_Operators",bmp:"⨀-⫿"},{name:"InSupplemental_Punctuation",bmp:"⸀-⹿"},{name:"InSupplemental_Symbols_And_Pictographs",astral:"\ud83e[\udd00-\uddff]"},{name:"InSupplementary_Private_Use_Area_A",astral:"[\udb80-\udbbf][\udc00-\udfff]"},{name:"InSupplementary_Private_Use_Area_B",astral:"[\udbc0-\udbff][\udc00-\udfff]"},{name:"InSutton_SignWriting",astral:"\ud836[\udc00-\udeaf]"},{name:"InSyloti_Nagri",bmp:"ꠀ-꠯"},{name:"InSyriac",bmp:"܀-ݏ"},{name:"InSyriac_Supplement",bmp:"ࡠ-࡯"},{name:"InTagalog",bmp:"ᜀ-ᜟ"},{name:"InTagbanwa",bmp:"ᝠ-᝿"},{name:"InTags",astral:"\udb40[\udc00-\udc7f]"},{name:"InTai_Le",bmp:"ᥐ-᥿"},{name:"InTai_Tham",bmp:"ᨠ-᪯"},{name:"InTai_Viet",bmp:"ꪀ-꫟"},{name:"InTai_Xuan_Jing_Symbols",astral:"\ud834[\udf00-\udf5f]"},{name:"InTakri",astral:"\ud805[\ude80-\udecf]"},{name:"InTamil",bmp:"஀-௿"},{name:"InTangut",astral:"[\ud81c-\ud821][\udc00-\udfff]"},{name:"InTangut_Components",astral:"\ud822[\udc00-\udeff]"},{name:"InTelugu",bmp:"ఀ-౿"},{name:"InThaana",bmp:"ހ-޿"},{name:"InThai",bmp:"฀-๿"},{name:"InTibetan",bmp:"ༀ-࿿"},{name:"InTifinagh",bmp:"ⴰ-⵿"},{name:"InTirhuta",astral:"\ud805[\udc80-\udcdf]"},{name:"InTransport_And_Map_Symbols",astral:"\ud83d[\ude80-\udeff]"},{name:"InUgaritic",astral:"\ud800[\udf80-\udf9f]"},{name:"InUnified_Canadian_Aboriginal_Syllabics",bmp:"᐀-ᙿ"},{name:"InUnified_Canadian_Aboriginal_Syllabics_Extended",bmp:"ᢰ-᣿"},{name:"InVai",bmp:"ꔀ-꘿"},{name:"InVariation_Selectors",bmp:"︀-️"},{name:"InVariation_Selectors_Supplement",astral:"\udb40[\udd00-\uddef]"},{name:"InVedic_Extensions",bmp:"᳐-᳿"},{name:"InVertical_Forms",bmp:"︐-︟"},{name:"InWarang_Citi",astral:"\ud806[\udca0-\udcff]"},{name:"InYi_Radicals",bmp:"꒐-꓏"},{name:"InYi_Syllables",bmp:"ꀀ-꒏"},{name:"InYijing_Hexagram_Symbols",bmp:"䷀-䷿"},{name:"InZanabazar_Square",astral:"\ud806[\ude00-\ude4f]"},{name:"Inundefined",astral:"\ud803[\ude80-\udebf\udfb0-\udfff]|\ud806[\udd00-\udd5f\udda0-\uddff]|\ud807[\udfb0-\udfff]|\ud80d[\udc30-\udc3f]|\ud822[\udf00-\udfff]|\ud823[\udc00-\udd8f]|\ud82c[\udd30-\udd6f]|\ud838[\udd00-\udd4f\udec0-\udeff]|\ud83b[\udd00-\udd4f]|\ud83e[\ude70-\udfff]|[\ud880-\ud883][\udc00-\udfff]|\ud884[\udc00-\udf4f]"}],tD=jc((function(t,e){eC(e,"__esModule",{value:!0}),e.default=void 0;var i=dx($S);
/*!
     * XRegExp Unicode Blocks 4.4.0
     * <xregexp.com>
     * Steven Levithan (c) 2010-present MIT License
     * Unicode data by Mathias Bynens <mathiasbynens.be>
     */e.default=function(t){if(!t.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Blocks");t.addUnicodeData(i.default)},t.exports=e.default}));Uc(tD);var eD=[{name:"C",alias:"Other",isBmpLast:!0,bmp:"\0--­͸͹΀-΃΋΍΢԰՗՘֋֌֐׈-׏׫-׮׵-؅؜؝۝܎܏݋݌޲-޿߻߼࠮࠯࠿࡜࡝࡟࡫-࢟ࢵࣈ-࣒࣢঄঍঎঑঒঩঱঳-঵঺঻৅৆৉৊৏-৖৘-৛৞৤৥৿਀਄਋-਎਑਒਩਱਴਷਺਻਽੃-੆੉੊੎-੐੒-੘੝੟-੥੷-઀઄઎઒઩઱઴઺઻૆૊૎૏૑-૟૤૥૲-૸଀଄଍଎଑଒଩଱଴଺଻୅୆୉୊୎-୔୘-୛୞୤୥୸-஁஄஋-஍஑஖-஘஛஝஠-஢஥-஧஫-஭஺-஽௃-௅௉௎௏௑-௖௘-௥௻-௿఍఑఩఺-఼౅౉౎-౔౗౛-౟౤౥౰-౶಍಑಩಴಺಻೅೉೎-೔೗-ೝ೟೤೥೰ೳ-೿഍഑൅൉൐-൓൤൥඀඄඗-඙඲඼඾඿෇-෉෋-෎෕෗෠-෥෰෱෵-฀฻-฾๜-຀຃຅຋຤຦຾຿໅໇໎໏໚໛໠-໿཈཭-཰྘྽࿍࿛-࿿჆჈-჌჎჏቉቎቏቗቙቞቟኉኎኏኱኶኷኿዁዆዇዗጑጖጗፛፜፽-፿᎚-᎟᏶᏷᏾᏿᚝-᚟᛹-᛿ᜍ᜕-ᜟ᜷-᜿᝔-᝟᝭᝱᝴-᝿៞៟៪-៯៺-៿᠎᠏᠚-᠟᡹-᡿᢫-᢯᣶-᣿᤟᤬-᤯᤼-᤿᥁-᥃᥮᥯᥵-᥿᦬-᦯᧊-᧏᧛-᧝᨜᨝᩟᩽᩾᪊-᪏᪚-᪟᪮᪯᫁-᫿ᭌ-᭏᭽-᭿᯴-᯻᰸-᰺᱊-᱌Ᲊ-᲏᲻᲼᳈-᳏᳻-᳿᷺἖἗἞἟὆὇὎὏὘὚὜὞὾὿᾵῅῔῕῜῰῱῵῿​-‏‪-‮⁠-⁯⁲⁳₏₝-₟⃀-⃏⃱-⃿↌-↏␧-␿⑋-⑟⭴⭵⮖Ⱟⱟ⳴-⳸⴦⴨-⴬⴮⴯⵨-⵮⵱-⵾⶗-⶟⶧⶯⶷⶿⷇⷏⷗⷟⹓-⹿⺚⻴-⻿⿖-⿯⿼-⿿぀゗゘㄀-㄄㄰㆏㇤-㇯㈟鿽-鿿꒍-꒏꓇-꓏꘬-꘿꛸-꛿ꟀꟁꟋ-ꟴ꠭-꠯꠺-꠿꡸-꡿꣆-꣍꣚-꣟꥔-꥞꥽-꥿꧎꧚-꧝꧿꨷-꨿꩎꩏꩚꩛꫃-꫚꫷-꬀꬇꬈꬏꬐꬗-꬟꬧꬯꭬-꭯꯮꯯꯺-꯿힤-힯퟇-퟊퟼-﩮﩯﫚-﫿﬇-﬒﬘-﬜﬷﬽﬿﭂﭅﯂-﯒﵀-﵏﶐﶑﷈-﷯﷾﷿︚-︟﹓﹧﹬-﹯﹵﻽-＀﾿-￁￈￉￐￑￘￙￝-￟￧￯-￻￾￿",astral:"\ud800[\udc0c\udc27\udc3b\udc3e\udc4e\udc4f\udc5e-\udc7f\udcfb-\udcff\udd03-\udd06\udd34-\udd36\udd8f\udd9d-\udd9f\udda1-\uddcf\uddfe-\ude7f\ude9d-\ude9f\uded1-\udedf\udefc-\udeff\udf24-\udf2c\udf4b-\udf4f\udf7b-\udf7f\udf9e\udfc4-\udfc7\udfd6-\udfff]|\ud801[\udc9e\udc9f\udcaa-\udcaf\udcd4-\udcd7\udcfc-\udcff\udd28-\udd2f\udd64-\udd6e\udd70-\uddff\udf37-\udf3f\udf56-\udf5f\udf68-\udfff]|\ud802[\udc06\udc07\udc09\udc36\udc39-\udc3b\udc3d\udc3e\udc56\udc9f-\udca6\udcb0-\udcdf\udcf3\udcf6-\udcfa\udd1c-\udd1e\udd3a-\udd3e\udd40-\udd7f\uddb8-\uddbb\uddd0\uddd1\ude04\ude07-\ude0b\ude14\ude18\ude36\ude37\ude3b-\ude3e\ude49-\ude4f\ude59-\ude5f\udea0-\udebf\udee7-\udeea\udef7-\udeff\udf36-\udf38\udf56\udf57\udf73-\udf77\udf92-\udf98\udf9d-\udfa8\udfb0-\udfff]|\ud803[\udc49-\udc7f\udcb3-\udcbf\udcf3-\udcf9\udd28-\udd2f\udd3a-\ude5f\ude7f\udeaa\udeae\udeaf\udeb2-\udeff\udf28-\udf2f\udf5a-\udfaf\udfcc-\udfdf\udff7-\udfff]|\ud804[\udc4e-\udc51\udc70-\udc7e\udcbd\udcc2-\udccf\udce9-\udcef\udcfa-\udcff\udd35\udd48-\udd4f\udd77-\udd7f\udde0\uddf5-\uddff\ude12\ude3f-\ude7f\ude87\ude89\ude8e\ude9e\udeaa-\udeaf\udeeb-\udeef\udefa-\udeff\udf04\udf0d\udf0e\udf11\udf12\udf29\udf31\udf34\udf3a\udf45\udf46\udf49\udf4a\udf4e\udf4f\udf51-\udf56\udf58-\udf5c\udf64\udf65\udf6d-\udf6f\udf75-\udfff]|\ud805[\udc5c\udc62-\udc7f\udcc8-\udccf\udcda-\udd7f\uddb6\uddb7\uddde-\uddff\ude45-\ude4f\ude5a-\ude5f\ude6d-\ude7f\udeb9-\udebf\udeca-\udeff\udf1b\udf1c\udf2c-\udf2f\udf40-\udfff]|\ud806[\udc3c-\udc9f\udcf3-\udcfe\udd07\udd08\udd0a\udd0b\udd14\udd17\udd36\udd39\udd3a\udd47-\udd4f\udd5a-\udd9f\udda8\udda9\uddd8\uddd9\udde5-\uddff\ude48-\ude4f\udea3-\udebf\udef9-\udfff]|\ud807[\udc09\udc37\udc46-\udc4f\udc6d-\udc6f\udc90\udc91\udca8\udcb7-\udcff\udd07\udd0a\udd37-\udd39\udd3b\udd3e\udd48-\udd4f\udd5a-\udd5f\udd66\udd69\udd8f\udd92\udd99-\udd9f\uddaa-\udedf\udef9-\udfaf\udfb1-\udfbf\udff2-\udffe]|\ud808[\udf9a-\udfff]|\ud809[\udc6f\udc75-\udc7f\udd44-\udfff]|[\ud80a\ud80b\ud80e-\ud810\ud812-\ud819\ud824-\ud82b\ud82d\ud82e\ud830-\ud833\ud837\ud839\ud83f\ud87b-\ud87d\ud87f\ud885-\udb3f\udb41-\udbff][\udc00-\udfff]|\ud80d[\udc2f-\udfff]|\ud811[\ude47-\udfff]|\ud81a[\ude39-\ude3f\ude5f\ude6a-\ude6d\ude70-\udecf\udeee\udeef\udef6-\udeff\udf46-\udf4f\udf5a\udf62\udf78-\udf7c\udf90-\udfff]|\ud81b[\udc00-\ude3f\ude9b-\udeff\udf4b-\udf4e\udf88-\udf8e\udfa0-\udfdf\udfe5-\udfef\udff2-\udfff]|\ud821[\udff8-\udfff]|\ud823[\udcd6-\udcff\udd09-\udfff]|\ud82c[\udd1f-\udd4f\udd53-\udd63\udd68-\udd6f\udefc-\udfff]|\ud82f[\udc6b-\udc6f\udc7d-\udc7f\udc89-\udc8f\udc9a\udc9b\udca0-\udfff]|\ud834[\udcf6-\udcff\udd27\udd28\udd73-\udd7a\udde9-\uddff\ude46-\udedf\udef4-\udeff\udf57-\udf5f\udf79-\udfff]|\ud835[\udc55\udc9d\udca0\udca1\udca3\udca4\udca7\udca8\udcad\udcba\udcbc\udcc4\udd06\udd0b\udd0c\udd15\udd1d\udd3a\udd3f\udd45\udd47-\udd49\udd51\udea6\udea7\udfcc\udfcd]|\ud836[\ude8c-\ude9a\udea0\udeb0-\udfff]|\ud838[\udc07\udc19\udc1a\udc22\udc25\udc2b-\udcff\udd2d-\udd2f\udd3e\udd3f\udd4a-\udd4d\udd50-\udebf\udefa-\udefe\udf00-\udfff]|\ud83a[\udcc5\udcc6\udcd7-\udcff\udd4c-\udd4f\udd5a-\udd5d\udd60-\udfff]|\ud83b[\udc00-\udc70\udcb5-\udd00\udd3e-\uddff\ude04\ude20\ude23\ude25\ude26\ude28\ude33\ude38\ude3a\ude3c-\ude41\ude43-\ude46\ude48\ude4a\ude4c\ude50\ude53\ude55\ude56\ude58\ude5a\ude5c\ude5e\ude60\ude63\ude65\ude66\ude6b\ude73\ude78\ude7d\ude7f\ude8a\ude9c-\udea0\udea4\udeaa\udebc-\udeef\udef2-\udfff]|\ud83c[\udc2c-\udc2f\udc94-\udc9f\udcaf\udcb0\udcc0\udcd0\udcf6-\udcff\uddae-\udde5\ude03-\ude0f\ude3c-\ude3f\ude49-\ude4f\ude52-\ude5f\ude66-\udeff]|\ud83d[\uded8-\udedf\udeed-\udeef\udefd-\udeff\udf74-\udf7f\udfd9-\udfdf\udfec-\udfff]|\ud83e[\udc0c-\udc0f\udc48-\udc4f\udc5a-\udc5f\udc88-\udc8f\udcae\udcaf\udcb2-\udcff\udd79\uddcc\ude54-\ude5f\ude6e\ude6f\ude75-\ude77\ude7b-\ude7f\ude87-\ude8f\udea9-\udeaf\udeb7-\udebf\udec3-\udecf\uded7-\udeff\udf93\udfcb-\udfef\udffa-\udfff]|\ud869[\udede-\udeff]|\ud86d[\udf35-\udf3f]|\ud86e[\udc1e\udc1f]|\ud873[\udea2-\udeaf]|\ud87a[\udfe1-\udfff]|\ud87e[\ude1e-\udfff]|\ud884[\udf4b-\udfff]|\udb40[\udc00-\udcff\uddf0-\udfff]"},{name:"Cc",alias:"Control",bmp:"\0--"},{name:"Cf",alias:"Format",bmp:"­؀-؅؜۝܏࣢᠎​-‏‪-‮⁠-⁤⁦-⁯\ufeff￹-￻",astral:"\ud804[\udcbd\udccd]|\ud80d[\udc30-\udc38]|\ud82f[\udca0-\udca3]|\ud834[\udd73-\udd7a]|\udb40[\udc01\udc20-\udc7f]"},{name:"Cn",alias:"Unassigned",bmp:"͸͹΀-΃΋΍΢԰՗՘֋֌֐׈-׏׫-׮׵-׿؝܎݋݌޲-޿߻߼࠮࠯࠿࡜࡝࡟࡫-࢟ࢵࣈ-࣒঄঍঎঑঒঩঱঳-঵঺঻৅৆৉৊৏-৖৘-৛৞৤৥৿਀਄਋-਎਑਒਩਱਴਷਺਻਽੃-੆੉੊੎-੐੒-੘੝੟-੥੷-઀઄઎઒઩઱઴઺઻૆૊૎૏૑-૟૤૥૲-૸଀଄଍଎଑଒଩଱଴଺଻୅୆୉୊୎-୔୘-୛୞୤୥୸-஁஄஋-஍஑஖-஘஛஝஠-஢஥-஧஫-஭஺-஽௃-௅௉௎௏௑-௖௘-௥௻-௿఍఑఩఺-఼౅౉౎-౔౗౛-౟౤౥౰-౶಍಑಩಴಺಻೅೉೎-೔೗-ೝ೟೤೥೰ೳ-೿഍഑൅൉൐-൓൤൥඀඄඗-඙඲඼඾඿෇-෉෋-෎෕෗෠-෥෰෱෵-฀฻-฾๜-຀຃຅຋຤຦຾຿໅໇໎໏໚໛໠-໿཈཭-཰྘྽࿍࿛-࿿჆჈-჌჎჏቉቎቏቗቙቞቟኉኎኏኱኶኷኿዁዆዇዗጑጖጗፛፜፽-፿᎚-᎟᏶᏷᏾᏿᚝-᚟᛹-᛿ᜍ᜕-ᜟ᜷-᜿᝔-᝟᝭᝱᝴-᝿៞៟៪-៯៺-៿᠏᠚-᠟᡹-᡿᢫-᢯᣶-᣿᤟᤬-᤯᤼-᤿᥁-᥃᥮᥯᥵-᥿᦬-᦯᧊-᧏᧛-᧝᨜᨝᩟᩽᩾᪊-᪏᪚-᪟᪮᪯᫁-᫿ᭌ-᭏᭽-᭿᯴-᯻᰸-᰺᱊-᱌Ᲊ-᲏᲻᲼᳈-᳏᳻-᳿᷺἖἗἞἟὆὇὎὏὘὚὜὞὾὿᾵῅῔῕῜῰῱῵῿⁥⁲⁳₏₝-₟⃀-⃏⃱-⃿↌-↏␧-␿⑋-⑟⭴⭵⮖Ⱟⱟ⳴-⳸⴦⴨-⴬⴮⴯⵨-⵮⵱-⵾⶗-⶟⶧⶯⶷⶿⷇⷏⷗⷟⹓-⹿⺚⻴-⻿⿖-⿯⿼-⿿぀゗゘㄀-㄄㄰㆏㇤-㇯㈟鿽-鿿꒍-꒏꓇-꓏꘬-꘿꛸-꛿ꟀꟁꟋ-ꟴ꠭-꠯꠺-꠿꡸-꡿꣆-꣍꣚-꣟꥔-꥞꥽-꥿꧎꧚-꧝꧿꨷-꨿꩎꩏꩚꩛꫃-꫚꫷-꬀꬇꬈꬏꬐꬗-꬟꬧꬯꭬-꭯꯮꯯꯺-꯿힤-힯퟇-퟊퟼-퟿﩮﩯﫚-﫿﬇-﬒﬘-﬜﬷﬽﬿﭂﭅﯂-﯒﵀-﵏﶐﶑﷈-﷯﷾﷿︚-︟﹓﹧﹬-﹯﹵﻽﻾＀﾿-￁￈￉￐￑￘￙￝-￟￧￯-￸￾￿",astral:"\ud800[\udc0c\udc27\udc3b\udc3e\udc4e\udc4f\udc5e-\udc7f\udcfb-\udcff\udd03-\udd06\udd34-\udd36\udd8f\udd9d-\udd9f\udda1-\uddcf\uddfe-\ude7f\ude9d-\ude9f\uded1-\udedf\udefc-\udeff\udf24-\udf2c\udf4b-\udf4f\udf7b-\udf7f\udf9e\udfc4-\udfc7\udfd6-\udfff]|\ud801[\udc9e\udc9f\udcaa-\udcaf\udcd4-\udcd7\udcfc-\udcff\udd28-\udd2f\udd64-\udd6e\udd70-\uddff\udf37-\udf3f\udf56-\udf5f\udf68-\udfff]|\ud802[\udc06\udc07\udc09\udc36\udc39-\udc3b\udc3d\udc3e\udc56\udc9f-\udca6\udcb0-\udcdf\udcf3\udcf6-\udcfa\udd1c-\udd1e\udd3a-\udd3e\udd40-\udd7f\uddb8-\uddbb\uddd0\uddd1\ude04\ude07-\ude0b\ude14\ude18\ude36\ude37\ude3b-\ude3e\ude49-\ude4f\ude59-\ude5f\udea0-\udebf\udee7-\udeea\udef7-\udeff\udf36-\udf38\udf56\udf57\udf73-\udf77\udf92-\udf98\udf9d-\udfa8\udfb0-\udfff]|\ud803[\udc49-\udc7f\udcb3-\udcbf\udcf3-\udcf9\udd28-\udd2f\udd3a-\ude5f\ude7f\udeaa\udeae\udeaf\udeb2-\udeff\udf28-\udf2f\udf5a-\udfaf\udfcc-\udfdf\udff7-\udfff]|\ud804[\udc4e-\udc51\udc70-\udc7e\udcc2-\udccc\udcce\udccf\udce9-\udcef\udcfa-\udcff\udd35\udd48-\udd4f\udd77-\udd7f\udde0\uddf5-\uddff\ude12\ude3f-\ude7f\ude87\ude89\ude8e\ude9e\udeaa-\udeaf\udeeb-\udeef\udefa-\udeff\udf04\udf0d\udf0e\udf11\udf12\udf29\udf31\udf34\udf3a\udf45\udf46\udf49\udf4a\udf4e\udf4f\udf51-\udf56\udf58-\udf5c\udf64\udf65\udf6d-\udf6f\udf75-\udfff]|\ud805[\udc5c\udc62-\udc7f\udcc8-\udccf\udcda-\udd7f\uddb6\uddb7\uddde-\uddff\ude45-\ude4f\ude5a-\ude5f\ude6d-\ude7f\udeb9-\udebf\udeca-\udeff\udf1b\udf1c\udf2c-\udf2f\udf40-\udfff]|\ud806[\udc3c-\udc9f\udcf3-\udcfe\udd07\udd08\udd0a\udd0b\udd14\udd17\udd36\udd39\udd3a\udd47-\udd4f\udd5a-\udd9f\udda8\udda9\uddd8\uddd9\udde5-\uddff\ude48-\ude4f\udea3-\udebf\udef9-\udfff]|\ud807[\udc09\udc37\udc46-\udc4f\udc6d-\udc6f\udc90\udc91\udca8\udcb7-\udcff\udd07\udd0a\udd37-\udd39\udd3b\udd3e\udd48-\udd4f\udd5a-\udd5f\udd66\udd69\udd8f\udd92\udd99-\udd9f\uddaa-\udedf\udef9-\udfaf\udfb1-\udfbf\udff2-\udffe]|\ud808[\udf9a-\udfff]|\ud809[\udc6f\udc75-\udc7f\udd44-\udfff]|[\ud80a\ud80b\ud80e-\ud810\ud812-\ud819\ud824-\ud82b\ud82d\ud82e\ud830-\ud833\ud837\ud839\ud83f\ud87b-\ud87d\ud87f\ud885-\udb3f\udb41-\udb7f][\udc00-\udfff]|\ud80d[\udc2f\udc39-\udfff]|\ud811[\ude47-\udfff]|\ud81a[\ude39-\ude3f\ude5f\ude6a-\ude6d\ude70-\udecf\udeee\udeef\udef6-\udeff\udf46-\udf4f\udf5a\udf62\udf78-\udf7c\udf90-\udfff]|\ud81b[\udc00-\ude3f\ude9b-\udeff\udf4b-\udf4e\udf88-\udf8e\udfa0-\udfdf\udfe5-\udfef\udff2-\udfff]|\ud821[\udff8-\udfff]|\ud823[\udcd6-\udcff\udd09-\udfff]|\ud82c[\udd1f-\udd4f\udd53-\udd63\udd68-\udd6f\udefc-\udfff]|\ud82f[\udc6b-\udc6f\udc7d-\udc7f\udc89-\udc8f\udc9a\udc9b\udca4-\udfff]|\ud834[\udcf6-\udcff\udd27\udd28\udde9-\uddff\ude46-\udedf\udef4-\udeff\udf57-\udf5f\udf79-\udfff]|\ud835[\udc55\udc9d\udca0\udca1\udca3\udca4\udca7\udca8\udcad\udcba\udcbc\udcc4\udd06\udd0b\udd0c\udd15\udd1d\udd3a\udd3f\udd45\udd47-\udd49\udd51\udea6\udea7\udfcc\udfcd]|\ud836[\ude8c-\ude9a\udea0\udeb0-\udfff]|\ud838[\udc07\udc19\udc1a\udc22\udc25\udc2b-\udcff\udd2d-\udd2f\udd3e\udd3f\udd4a-\udd4d\udd50-\udebf\udefa-\udefe\udf00-\udfff]|\ud83a[\udcc5\udcc6\udcd7-\udcff\udd4c-\udd4f\udd5a-\udd5d\udd60-\udfff]|\ud83b[\udc00-\udc70\udcb5-\udd00\udd3e-\uddff\ude04\ude20\ude23\ude25\ude26\ude28\ude33\ude38\ude3a\ude3c-\ude41\ude43-\ude46\ude48\ude4a\ude4c\ude50\ude53\ude55\ude56\ude58\ude5a\ude5c\ude5e\ude60\ude63\ude65\ude66\ude6b\ude73\ude78\ude7d\ude7f\ude8a\ude9c-\udea0\udea4\udeaa\udebc-\udeef\udef2-\udfff]|\ud83c[\udc2c-\udc2f\udc94-\udc9f\udcaf\udcb0\udcc0\udcd0\udcf6-\udcff\uddae-\udde5\ude03-\ude0f\ude3c-\ude3f\ude49-\ude4f\ude52-\ude5f\ude66-\udeff]|\ud83d[\uded8-\udedf\udeed-\udeef\udefd-\udeff\udf74-\udf7f\udfd9-\udfdf\udfec-\udfff]|\ud83e[\udc0c-\udc0f\udc48-\udc4f\udc5a-\udc5f\udc88-\udc8f\udcae\udcaf\udcb2-\udcff\udd79\uddcc\ude54-\ude5f\ude6e\ude6f\ude75-\ude77\ude7b-\ude7f\ude87-\ude8f\udea9-\udeaf\udeb7-\udebf\udec3-\udecf\uded7-\udeff\udf93\udfcb-\udfef\udffa-\udfff]|\ud869[\udede-\udeff]|\ud86d[\udf35-\udf3f]|\ud86e[\udc1e\udc1f]|\ud873[\udea2-\udeaf]|\ud87a[\udfe1-\udfff]|\ud87e[\ude1e-\udfff]|\ud884[\udf4b-\udfff]|\udb40[\udc00\udc02-\udc1f\udc80-\udcff\uddf0-\udfff]|[\udbbf\udbff][\udffe\udfff]"},{name:"Co",alias:"Private_Use",bmp:"-",astral:"[\udb80-\udbbe\udbc0-\udbfe][\udc00-\udfff]|[\udbbf\udbff][\udc00-\udffd]"},{name:"Cs",alias:"Surrogate",bmp:"\ud800-\udfff"},{name:"L",alias:"Letter",bmp:"A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࢠ-ࢴࢶ-ࣇऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-鿼ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞿꟂ-ꟊꟵ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",astral:"\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa\ude80-\ude9c\udea0-\uded0\udf00-\udf1f\udf2d-\udf40\udf42-\udf49\udf50-\udf75\udf80-\udf9d\udfa0-\udfc3\udfc8-\udfcf]|\ud801[\udc00-\udc9d\udcb0-\udcd3\udcd8-\udcfb\udd00-\udd27\udd30-\udd63\ude00-\udf36\udf40-\udf55\udf60-\udf67]|\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f-\udc55\udc60-\udc76\udc80-\udc9e\udce0-\udcf2\udcf4\udcf5\udd00-\udd15\udd20-\udd39\udd80-\uddb7\uddbe\uddbf\ude00\ude10-\ude13\ude15-\ude17\ude19-\ude35\ude60-\ude7c\ude80-\ude9c\udec0-\udec7\udec9-\udee4\udf00-\udf35\udf40-\udf55\udf60-\udf72\udf80-\udf91]|\ud803[\udc00-\udc48\udc80-\udcb2\udcc0-\udcf2\udd00-\udd23\ude80-\udea9\udeb0\udeb1\udf00-\udf1c\udf27\udf30-\udf45\udfb0-\udfc4\udfe0-\udff6]|\ud804[\udc03-\udc37\udc83-\udcaf\udcd0-\udce8\udd03-\udd26\udd44\udd47\udd50-\udd72\udd76\udd83-\uddb2\uddc1-\uddc4\uddda\udddc\ude00-\ude11\ude13-\ude2b\ude80-\ude86\ude88\ude8a-\ude8d\ude8f-\ude9d\ude9f-\udea8\udeb0-\udede\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3d\udf50\udf5d-\udf61]|\ud805[\udc00-\udc34\udc47-\udc4a\udc5f-\udc61\udc80-\udcaf\udcc4\udcc5\udcc7\udd80-\uddae\uddd8-\udddb\ude00-\ude2f\ude44\ude80-\udeaa\udeb8\udf00-\udf1a]|\ud806[\udc00-\udc2b\udca0-\udcdf\udcff-\udd06\udd09\udd0c-\udd13\udd15\udd16\udd18-\udd2f\udd3f\udd41\udda0-\udda7\uddaa-\uddd0\udde1\udde3\ude00\ude0b-\ude32\ude3a\ude50\ude5c-\ude89\ude9d\udec0-\udef8]|\ud807[\udc00-\udc08\udc0a-\udc2e\udc40\udc72-\udc8f\udd00-\udd06\udd08\udd09\udd0b-\udd30\udd46\udd60-\udd65\udd67\udd68\udd6a-\udd89\udd98\udee0-\udef2\udfb0]|\ud808[\udc00-\udf99]|\ud809[\udc80-\udd43]|[\ud80c\ud81c-\ud820\ud822\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872\ud874-\ud879\ud880-\ud883][\udc00-\udfff]|\ud80d[\udc00-\udc2e]|\ud811[\udc00-\ude46]|\ud81a[\udc00-\ude38\ude40-\ude5e\uded0-\udeed\udf00-\udf2f\udf40-\udf43\udf63-\udf77\udf7d-\udf8f]|\ud81b[\ude40-\ude7f\udf00-\udf4a\udf50\udf93-\udf9f\udfe0\udfe1\udfe3]|\ud821[\udc00-\udff7]|\ud823[\udc00-\udcd5\udd00-\udd08]|\ud82c[\udc00-\udd1e\udd50-\udd52\udd64-\udd67\udd70-\udefb]|\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udec0\udec2-\udeda\udedc-\udefa\udefc-\udf14\udf16-\udf34\udf36-\udf4e\udf50-\udf6e\udf70-\udf88\udf8a-\udfa8\udfaa-\udfc2\udfc4-\udfcb]|\ud838[\udd00-\udd2c\udd37-\udd3d\udd4e\udec0-\udeeb]|\ud83a[\udc00-\udcc4\udd00-\udd43\udd4b]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb]|\ud869[\udc00-\udedd\udf00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d\udc20-\udfff]|\ud873[\udc00-\udea1\udeb0-\udfff]|\ud87a[\udc00-\udfe0]|\ud87e[\udc00-\ude1d]|\ud884[\udc00-\udf4a]"},{name:"LC",alias:"Cased_Letter",bmp:"A-Za-zµÀ-ÖØ-öø-ƺƼ-ƿǄ-ʓʕ-ʯͰ-ͳͶͷͻ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՠ-ֈႠ-ჅჇჍა-ჺჽ-ჿᎠ-Ᏽᏸ-ᏽᲀ-ᲈᲐ-ᲺᲽ-Ჿᴀ-ᴫᵫ-ᵷᵹ-ᶚḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℴℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⱻⱾ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭꙀ-ꙭꚀ-ꚛꜢ-ꝯꝱ-ꞇꞋ-ꞎꞐ-ꞿꟂ-ꟊꟵꟶꟺꬰ-ꭚꭠ-ꭨꭰ-ꮿﬀ-ﬆﬓ-ﬗＡ-Ｚａ-ｚ",astral:"\ud801[\udc00-\udc4f\udcb0-\udcd3\udcd8-\udcfb]|\ud803[\udc80-\udcb2\udcc0-\udcf2]|\ud806[\udca0-\udcdf]|\ud81b[\ude40-\ude7f]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udec0\udec2-\udeda\udedc-\udefa\udefc-\udf14\udf16-\udf34\udf36-\udf4e\udf50-\udf6e\udf70-\udf88\udf8a-\udfa8\udfaa-\udfc2\udfc4-\udfcb]|\ud83a[\udd00-\udd43]"},{name:"Ll",alias:"Lowercase_Letter",bmp:"a-zµß-öø-ÿāăąćĉċčďđēĕėęěĝğġģĥħĩīĭįıĳĵķĸĺļľŀłńņňŉŋōŏőœŕŗřśŝşšţťŧũūŭůűųŵŷźżž-ƀƃƅƈƌƍƒƕƙ-ƛƞơƣƥƨƪƫƭưƴƶƹƺƽ-ƿǆǉǌǎǐǒǔǖǘǚǜǝǟǡǣǥǧǩǫǭǯǰǳǵǹǻǽǿȁȃȅȇȉȋȍȏȑȓȕȗșțȝȟȡȣȥȧȩȫȭȯȱȳ-ȹȼȿɀɂɇɉɋɍɏ-ʓʕ-ʯͱͳͷͻ-ͽΐά-ώϐϑϕ-ϗϙϛϝϟϡϣϥϧϩϫϭϯ-ϳϵϸϻϼа-џѡѣѥѧѩѫѭѯѱѳѵѷѹѻѽѿҁҋҍҏґғҕҗҙқҝҟҡңҥҧҩҫҭүұҳҵҷҹһҽҿӂӄӆӈӊӌӎӏӑӓӕӗәӛӝӟӡӣӥӧөӫӭӯӱӳӵӷӹӻӽӿԁԃԅԇԉԋԍԏԑԓԕԗԙԛԝԟԡԣԥԧԩԫԭԯՠ-ֈა-ჺჽ-ჿᏸ-ᏽᲀ-ᲈᴀ-ᴫᵫ-ᵷᵹ-ᶚḁḃḅḇḉḋḍḏḑḓḕḗḙḛḝḟḡḣḥḧḩḫḭḯḱḳḵḷḹḻḽḿṁṃṅṇṉṋṍṏṑṓṕṗṙṛṝṟṡṣṥṧṩṫṭṯṱṳṵṷṹṻṽṿẁẃẅẇẉẋẍẏẑẓẕ-ẝẟạảấầẩẫậắằẳẵặẹẻẽếềểễệỉịọỏốồổỗộớờởỡợụủứừửữựỳỵỷỹỻỽỿ-ἇἐ-ἕἠ-ἧἰ-ἷὀ-ὅὐ-ὗὠ-ὧὰ-ώᾀ-ᾇᾐ-ᾗᾠ-ᾧᾰ-ᾴᾶᾷιῂ-ῄῆῇῐ-ΐῖῗῠ-ῧῲ-ῴῶῷℊℎℏℓℯℴℹℼℽⅆ-ⅉⅎↄⰰ-ⱞⱡⱥⱦⱨⱪⱬⱱⱳⱴⱶ-ⱻⲁⲃⲅⲇⲉⲋⲍⲏⲑⲓⲕⲗⲙⲛⲝⲟⲡⲣⲥⲧⲩⲫⲭⲯⲱⲳⲵⲷⲹⲻⲽⲿⳁⳃⳅⳇⳉⳋⳍⳏⳑⳓⳕⳗⳙⳛⳝⳟⳡⳣⳤⳬⳮⳳⴀ-ⴥⴧⴭꙁꙃꙅꙇꙉꙋꙍꙏꙑꙓꙕꙗꙙꙛꙝꙟꙡꙣꙥꙧꙩꙫꙭꚁꚃꚅꚇꚉꚋꚍꚏꚑꚓꚕꚗꚙꚛꜣꜥꜧꜩꜫꜭꜯ-ꜱꜳꜵꜷꜹꜻꜽꜿꝁꝃꝅꝇꝉꝋꝍꝏꝑꝓꝕꝗꝙꝛꝝꝟꝡꝣꝥꝧꝩꝫꝭꝯꝱ-ꝸꝺꝼꝿꞁꞃꞅꞇꞌꞎꞑꞓ-ꞕꞗꞙꞛꞝꞟꞡꞣꞥꞧꞩꞯꞵꞷꞹꞻꞽꞿꟃꟈꟊꟶꟺꬰ-ꭚꭠ-ꭨꭰ-ꮿﬀ-ﬆﬓ-ﬗａ-ｚ",astral:"\ud801[\udc28-\udc4f\udcd8-\udcfb]|\ud803[\udcc0-\udcf2]|\ud806[\udcc0-\udcdf]|\ud81b[\ude60-\ude7f]|\ud835[\udc1a-\udc33\udc4e-\udc54\udc56-\udc67\udc82-\udc9b\udcb6-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udccf\udcea-\udd03\udd1e-\udd37\udd52-\udd6b\udd86-\udd9f\uddba-\uddd3\uddee-\ude07\ude22-\ude3b\ude56-\ude6f\ude8a-\udea5\udec2-\udeda\udedc-\udee1\udefc-\udf14\udf16-\udf1b\udf36-\udf4e\udf50-\udf55\udf70-\udf88\udf8a-\udf8f\udfaa-\udfc2\udfc4-\udfc9\udfcb]|\ud83a[\udd22-\udd43]"},{name:"Lm",alias:"Modifier_Letter",bmp:"ʰ-ˁˆ-ˑˠ-ˤˬˮʹͺՙـۥۦߴߵߺࠚࠤࠨॱๆໆჼៗᡃᪧᱸ-ᱽᴬ-ᵪᵸᶛ-ᶿⁱⁿₐ-ₜⱼⱽⵯⸯ々〱-〵〻ゝゞー-ヾꀕꓸ-ꓽꘌꙿꚜꚝꜗ-ꜟꝰꞈꟸꟹꧏꧦꩰꫝꫳꫴꭜ-ꭟꭩｰﾞﾟ",astral:"\ud81a[\udf40-\udf43]|\ud81b[\udf93-\udf9f\udfe0\udfe1\udfe3]|\ud838[\udd37-\udd3d]|𞥋"},{name:"Lo",alias:"Other_Letter",bmp:"ªºƻǀ-ǃʔא-תׯ-ײؠ-ؿف-يٮٯٱ-ۓەۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪࠀ-ࠕࡀ-ࡘࡠ-ࡪࢠ-ࢴࢶ-ࣇऄ-हऽॐक़-ॡॲ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๅກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎᄀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៜᠠ-ᡂᡄ-ᡸᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱷᳩ-ᳬᳮ-ᳳᳵᳶᳺℵ-ℸⴰ-ⵧⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ〆〼ぁ-ゖゟァ-ヺヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-鿼ꀀ-ꀔꀖ-ꒌꓐ-ꓷꔀ-ꘋꘐ-ꘟꘪꘫꙮꚠ-ꛥꞏꟷꟻ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧠ-ꧤꧧ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩯꩱ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛꫜꫠ-ꫪꫲꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎יִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼｦ-ｯｱ-ﾝﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",astral:"\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa\ude80-\ude9c\udea0-\uded0\udf00-\udf1f\udf2d-\udf40\udf42-\udf49\udf50-\udf75\udf80-\udf9d\udfa0-\udfc3\udfc8-\udfcf]|\ud801[\udc50-\udc9d\udd00-\udd27\udd30-\udd63\ude00-\udf36\udf40-\udf55\udf60-\udf67]|\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f-\udc55\udc60-\udc76\udc80-\udc9e\udce0-\udcf2\udcf4\udcf5\udd00-\udd15\udd20-\udd39\udd80-\uddb7\uddbe\uddbf\ude00\ude10-\ude13\ude15-\ude17\ude19-\ude35\ude60-\ude7c\ude80-\ude9c\udec0-\udec7\udec9-\udee4\udf00-\udf35\udf40-\udf55\udf60-\udf72\udf80-\udf91]|\ud803[\udc00-\udc48\udd00-\udd23\ude80-\udea9\udeb0\udeb1\udf00-\udf1c\udf27\udf30-\udf45\udfb0-\udfc4\udfe0-\udff6]|\ud804[\udc03-\udc37\udc83-\udcaf\udcd0-\udce8\udd03-\udd26\udd44\udd47\udd50-\udd72\udd76\udd83-\uddb2\uddc1-\uddc4\uddda\udddc\ude00-\ude11\ude13-\ude2b\ude80-\ude86\ude88\ude8a-\ude8d\ude8f-\ude9d\ude9f-\udea8\udeb0-\udede\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3d\udf50\udf5d-\udf61]|\ud805[\udc00-\udc34\udc47-\udc4a\udc5f-\udc61\udc80-\udcaf\udcc4\udcc5\udcc7\udd80-\uddae\uddd8-\udddb\ude00-\ude2f\ude44\ude80-\udeaa\udeb8\udf00-\udf1a]|\ud806[\udc00-\udc2b\udcff-\udd06\udd09\udd0c-\udd13\udd15\udd16\udd18-\udd2f\udd3f\udd41\udda0-\udda7\uddaa-\uddd0\udde1\udde3\ude00\ude0b-\ude32\ude3a\ude50\ude5c-\ude89\ude9d\udec0-\udef8]|\ud807[\udc00-\udc08\udc0a-\udc2e\udc40\udc72-\udc8f\udd00-\udd06\udd08\udd09\udd0b-\udd30\udd46\udd60-\udd65\udd67\udd68\udd6a-\udd89\udd98\udee0-\udef2\udfb0]|\ud808[\udc00-\udf99]|\ud809[\udc80-\udd43]|[\ud80c\ud81c-\ud820\ud822\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872\ud874-\ud879\ud880-\ud883][\udc00-\udfff]|\ud80d[\udc00-\udc2e]|\ud811[\udc00-\ude46]|\ud81a[\udc00-\ude38\ude40-\ude5e\uded0-\udeed\udf00-\udf2f\udf63-\udf77\udf7d-\udf8f]|\ud81b[\udf00-\udf4a\udf50]|\ud821[\udc00-\udff7]|\ud823[\udc00-\udcd5\udd00-\udd08]|\ud82c[\udc00-\udd1e\udd50-\udd52\udd64-\udd67\udd70-\udefb]|\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99]|\ud838[\udd00-\udd2c\udd4e\udec0-\udeeb]|\ud83a[\udc00-\udcc4]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb]|\ud869[\udc00-\udedd\udf00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d\udc20-\udfff]|\ud873[\udc00-\udea1\udeb0-\udfff]|\ud87a[\udc00-\udfe0]|\ud87e[\udc00-\ude1d]|\ud884[\udc00-\udf4a]"},{name:"Lt",alias:"Titlecase_Letter",bmp:"ǅǈǋǲᾈ-ᾏᾘ-ᾟᾨ-ᾯᾼῌῼ"},{name:"Lu",alias:"Uppercase_Letter",bmp:"A-ZÀ-ÖØ-ÞĀĂĄĆĈĊČĎĐĒĔĖĘĚĜĞĠĢĤĦĨĪĬĮİĲĴĶĹĻĽĿŁŃŅŇŊŌŎŐŒŔŖŘŚŜŞŠŢŤŦŨŪŬŮŰŲŴŶŸŹŻŽƁƂƄƆƇƉ-ƋƎ-ƑƓƔƖ-ƘƜƝƟƠƢƤƦƧƩƬƮƯƱ-ƳƵƷƸƼǄǇǊǍǏǑǓǕǗǙǛǞǠǢǤǦǨǪǬǮǱǴǶ-ǸǺǼǾȀȂȄȆȈȊȌȎȐȒȔȖȘȚȜȞȠȢȤȦȨȪȬȮȰȲȺȻȽȾɁɃ-ɆɈɊɌɎͰͲͶͿΆΈ-ΊΌΎΏΑ-ΡΣ-ΫϏϒ-ϔϘϚϜϞϠϢϤϦϨϪϬϮϴϷϹϺϽ-ЯѠѢѤѦѨѪѬѮѰѲѴѶѸѺѼѾҀҊҌҎҐҒҔҖҘҚҜҞҠҢҤҦҨҪҬҮҰҲҴҶҸҺҼҾӀӁӃӅӇӉӋӍӐӒӔӖӘӚӜӞӠӢӤӦӨӪӬӮӰӲӴӶӸӺӼӾԀԂԄԆԈԊԌԎԐԒԔԖԘԚԜԞԠԢԤԦԨԪԬԮԱ-ՖႠ-ჅჇჍᎠ-ᏵᲐ-ᲺᲽ-ᲿḀḂḄḆḈḊḌḎḐḒḔḖḘḚḜḞḠḢḤḦḨḪḬḮḰḲḴḶḸḺḼḾṀṂṄṆṈṊṌṎṐṒṔṖṘṚṜṞṠṢṤṦṨṪṬṮṰṲṴṶṸṺṼṾẀẂẄẆẈẊẌẎẐẒẔẞẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼẾỀỂỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪỬỮỰỲỴỶỸỺỼỾἈ-ἏἘ-ἝἨ-ἯἸ-ἿὈ-ὍὙὛὝὟὨ-ὯᾸ-ΆῈ-ΉῘ-ΊῨ-ῬῸ-Ώℂℇℋ-ℍℐ-ℒℕℙ-ℝℤΩℨK-ℭℰ-ℳℾℿⅅↃⰀ-ⰮⱠⱢ-ⱤⱧⱩⱫⱭ-ⱰⱲⱵⱾ-ⲀⲂⲄⲆⲈⲊⲌⲎⲐⲒⲔⲖⲘⲚⲜⲞⲠⲢⲤⲦⲨⲪⲬⲮⲰⲲⲴⲶⲸⲺⲼⲾⳀⳂⳄⳆⳈⳊⳌⳎⳐⳒⳔⳖⳘⳚⳜⳞⳠⳢⳫⳭⳲꙀꙂꙄꙆꙈꙊꙌꙎꙐꙒꙔꙖꙘꙚꙜꙞꙠꙢꙤꙦꙨꙪꙬꚀꚂꚄꚆꚈꚊꚌꚎꚐꚒꚔꚖꚘꚚꜢꜤꜦꜨꜪꜬꜮꜲꜴꜶꜸꜺꜼꜾꝀꝂꝄꝆꝈꝊꝌꝎꝐꝒꝔꝖꝘꝚꝜꝞꝠꝢꝤꝦꝨꝪꝬꝮꝹꝻꝽꝾꞀꞂꞄꞆꞋꞍꞐꞒꞖꞘꞚꞜꞞꞠꞢꞤꞦꞨꞪ-ꞮꞰ-ꞴꞶꞸꞺꞼꞾꟂꟄ-ꟇꟉꟵＡ-Ｚ",astral:"\ud801[\udc00-\udc27\udcb0-\udcd3]|\ud803[\udc80-\udcb2]|\ud806[\udca0-\udcbf]|\ud81b[\ude40-\ude5f]|\ud835[\udc00-\udc19\udc34-\udc4d\udc68-\udc81\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb5\udcd0-\udce9\udd04\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd38\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd6c-\udd85\udda0-\uddb9\uddd4-\udded\ude08-\ude21\ude3c-\ude55\ude70-\ude89\udea8-\udec0\udee2-\udefa\udf1c-\udf34\udf56-\udf6e\udf90-\udfa8\udfca]|\ud83a[\udd00-\udd21]"},{name:"M",alias:"Mark",bmp:"̀-ͯ҃-҉֑-ׇֽֿׁׂׅׄؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ܑۭܰ-݊ަ-ް߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࣓-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣঁ-ঃ়া-ৄেৈো-্ৗৢৣ৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑੰੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣஂா-ூெ-ைொ-்ௗఀ-ఄా-ౄె-ైొ-్ౕౖౢౣಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣඁ-ඃ්ා-ුූෘ-ෟෲෳัิ-ฺ็-๎ັິ-ຼ່-ໍ༹༘༙༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏႚ-ႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝᠋-᠍ᢅᢆᢩᤠ-ᤫᤰ-᤻ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼᪰-ᫀᬀ-ᬄ᬴-᭄᭫-᭳ᮀ-ᮂᮡ-ᮭ᯦-᯳ᰤ-᰷᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷹᷻-᷿⃐-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꙯-꙲ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣠-꣱ꣿꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀ꧥꨩ-ꨶꩃꩌꩍꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭ﬞ︀-️︠-︯",astral:"\ud800[\uddfd\udee0\udf76-\udf7a]|\ud802[\ude01-\ude03\ude05\ude06\ude0c-\ude0f\ude38-\ude3a\ude3f\udee5\udee6]|\ud803[\udd24-\udd27\udeab\udeac\udf46-\udf50]|\ud804[\udc00-\udc02\udc38-\udc46\udc7f-\udc82\udcb0-\udcba\udd00-\udd02\udd27-\udd34\udd45\udd46\udd73\udd80-\udd82\uddb3-\uddc0\uddc9-\uddcc\uddce\uddcf\ude2c-\ude37\ude3e\udedf-\udeea\udf00-\udf03\udf3b\udf3c\udf3e-\udf44\udf47\udf48\udf4b-\udf4d\udf57\udf62\udf63\udf66-\udf6c\udf70-\udf74]|\ud805[\udc35-\udc46\udc5e\udcb0-\udcc3\uddaf-\uddb5\uddb8-\uddc0\udddc\udddd\ude30-\ude40\udeab-\udeb7\udf1d-\udf2b]|\ud806[\udc2c-\udc3a\udd30-\udd35\udd37\udd38\udd3b-\udd3e\udd40\udd42\udd43\uddd1-\uddd7\uddda-\udde0\udde4\ude01-\ude0a\ude33-\ude39\ude3b-\ude3e\ude47\ude51-\ude5b\ude8a-\ude99]|\ud807[\udc2f-\udc36\udc38-\udc3f\udc92-\udca7\udca9-\udcb6\udd31-\udd36\udd3a\udd3c\udd3d\udd3f-\udd45\udd47\udd8a-\udd8e\udd90\udd91\udd93-\udd97\udef3-\udef6]|\ud81a[\udef0-\udef4\udf30-\udf36]|\ud81b[\udf4f\udf51-\udf87\udf8f-\udf92\udfe4\udff0\udff1]|\ud82f[\udc9d\udc9e]|\ud834[\udd65-\udd69\udd6d-\udd72\udd7b-\udd82\udd85-\udd8b\uddaa-\uddad\ude42-\ude44]|\ud836[\ude00-\ude36\ude3b-\ude6c\ude75\ude84\ude9b-\ude9f\udea1-\udeaf]|\ud838[\udc00-\udc06\udc08-\udc18\udc1b-\udc21\udc23\udc24\udc26-\udc2a\udd30-\udd36\udeec-\udeef]|\ud83a[\udcd0-\udcd6\udd44-\udd4a]|\udb40[\udd00-\uddef]"},{name:"Mc",alias:"Spacing_Mark",bmp:"ःऻा-ीॉ-ौॎॏংঃা-ীেৈোৌৗਃਾ-ੀઃા-ીૉોૌଂଃାୀେୈୋୌୗாிுூெ-ைொ-ௌௗఁ-ఃు-ౄಂಃಾೀ-ೄೇೈೊೋೕೖംഃാ-ീെ-ൈൊ-ൌൗංඃා-ෑෘ-ෟෲෳ༾༿ཿါာေးျြၖၗၢ-ၤၧ-ၭႃႄႇ-ႌႏႚ-ႜាើ-ៅះៈᤣ-ᤦᤩ-ᤫᤰᤱᤳ-ᤸᨙᨚᩕᩗᩡᩣᩤᩭ-ᩲᬄᬵᬻᬽ-ᭁᭃ᭄ᮂᮡᮦᮧ᮪ᯧᯪ-ᯬᯮ᯲᯳ᰤ-ᰫᰴᰵ᳡᳷〮〯ꠣꠤꠧꢀꢁꢴ-ꣃꥒ꥓ꦃꦴꦵꦺꦻꦾ-꧀ꨯꨰꨳꨴꩍꩻꩽꫫꫮꫯꫵꯣꯤꯦꯧꯩꯪ꯬",astral:"\ud804[\udc00\udc02\udc82\udcb0-\udcb2\udcb7\udcb8\udd2c\udd45\udd46\udd82\uddb3-\uddb5\uddbf\uddc0\uddce\ude2c-\ude2e\ude32\ude33\ude35\udee0-\udee2\udf02\udf03\udf3e\udf3f\udf41-\udf44\udf47\udf48\udf4b-\udf4d\udf57\udf62\udf63]|\ud805[\udc35-\udc37\udc40\udc41\udc45\udcb0-\udcb2\udcb9\udcbb-\udcbe\udcc1\uddaf-\uddb1\uddb8-\uddbb\uddbe\ude30-\ude32\ude3b\ude3c\ude3e\udeac\udeae\udeaf\udeb6\udf20\udf21\udf26]|\ud806[\udc2c-\udc2e\udc38\udd30-\udd35\udd37\udd38\udd3d\udd40\udd42\uddd1-\uddd3\udddc-\udddf\udde4\ude39\ude57\ude58\ude97]|\ud807[\udc2f\udc3e\udca9\udcb1\udcb4\udd8a-\udd8e\udd93\udd94\udd96\udef5\udef6]|\ud81b[\udf51-\udf87\udff0\udff1]|\ud834[\udd65\udd66\udd6d-\udd72]"},{name:"Me",alias:"Enclosing_Mark",bmp:"҈҉᪾⃝-⃠⃢-⃤꙰-꙲"},{name:"Mn",alias:"Nonspacing_Mark",bmp:"̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ܑۭܰ-݊ަ-ް߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࣓-ࣣ࣡-ंऺ़ु-ै्॑-ॗॢॣঁ়ু-ৄ্ৢৣ৾ਁਂ਼ੁੂੇੈੋ-੍ੑੰੱੵઁં઼ુ-ૅેૈ્ૢૣૺ-૿ଁ଼ିୁ-ୄ୍୕ୖୢୣஂீ்ఀఄా-ీె-ైొ-్ౕౖౢౣಁ಼ಿೆೌ್ೢೣഀഁ഻഼ു-ൄ്ൢൣඁ්ි-ුූัิ-ฺ็-๎ັິ-ຼ່-ໍཱ༹༘༙༵༷-ཾྀ-྄྆྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္်ွှၘၙၞ-ၠၱ-ၴႂႅႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴឵ិ-ួំ៉-៓៝᠋-᠍ᢅᢆᢩᤠ-ᤢᤧᤨᤲ᤹-᤻ᨘᨗᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽ᪿᫀᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀᮁᮢ-ᮥᮨᮩ᮫-ᮭ᯦ᯨᯩᯭᯯ-ᯱᰬ-ᰳᰶ᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸᳹᷀-᷹᷻-᷿⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〭꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠥꠦ꠬꣄ꣅ꣠-꣱ꣿꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꦽꧥꨩ-ꨮꨱꨲꨵꨶꩃꩌꩼꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫬꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯",astral:"\ud800[\uddfd\udee0\udf76-\udf7a]|\ud802[\ude01-\ude03\ude05\ude06\ude0c-\ude0f\ude38-\ude3a\ude3f\udee5\udee6]|\ud803[\udd24-\udd27\udeab\udeac\udf46-\udf50]|\ud804[\udc01\udc38-\udc46\udc7f-\udc81\udcb3-\udcb6\udcb9\udcba\udd00-\udd02\udd27-\udd2b\udd2d-\udd34\udd73\udd80\udd81\uddb6-\uddbe\uddc9-\uddcc\uddcf\ude2f-\ude31\ude34\ude36\ude37\ude3e\udedf\udee3-\udeea\udf00\udf01\udf3b\udf3c\udf40\udf66-\udf6c\udf70-\udf74]|\ud805[\udc38-\udc3f\udc42-\udc44\udc46\udc5e\udcb3-\udcb8\udcba\udcbf\udcc0\udcc2\udcc3\uddb2-\uddb5\uddbc\uddbd\uddbf\uddc0\udddc\udddd\ude33-\ude3a\ude3d\ude3f\ude40\udeab\udead\udeb0-\udeb5\udeb7\udf1d-\udf1f\udf22-\udf25\udf27-\udf2b]|\ud806[\udc2f-\udc37\udc39\udc3a\udd3b\udd3c\udd3e\udd43\uddd4-\uddd7\uddda\udddb\udde0\ude01-\ude0a\ude33-\ude38\ude3b-\ude3e\ude47\ude51-\ude56\ude59-\ude5b\ude8a-\ude96\ude98\ude99]|\ud807[\udc30-\udc36\udc38-\udc3d\udc3f\udc92-\udca7\udcaa-\udcb0\udcb2\udcb3\udcb5\udcb6\udd31-\udd36\udd3a\udd3c\udd3d\udd3f-\udd45\udd47\udd90\udd91\udd95\udd97\udef3\udef4]|\ud81a[\udef0-\udef4\udf30-\udf36]|\ud81b[\udf4f\udf8f-\udf92\udfe4]|\ud82f[\udc9d\udc9e]|\ud834[\udd67-\udd69\udd7b-\udd82\udd85-\udd8b\uddaa-\uddad\ude42-\ude44]|\ud836[\ude00-\ude36\ude3b-\ude6c\ude75\ude84\ude9b-\ude9f\udea1-\udeaf]|\ud838[\udc00-\udc06\udc08-\udc18\udc1b-\udc21\udc23\udc24\udc26-\udc2a\udd30-\udd36\udeec-\udeef]|\ud83a[\udcd0-\udcd6\udd44-\udd4a]|\udb40[\udd00-\uddef]"},{name:"N",alias:"Number",bmp:"0-9²³¹¼-¾٠-٩۰-۹߀-߉०-९০-৯৴-৹੦-੯૦-૯୦-୯୲-୷௦-௲౦-౯౸-౾೦-೯൘-൞൦-൸෦-෯๐-๙໐-໙༠-༳၀-၉႐-႙፩-፼ᛮ-ᛰ០-៩៰-៹᠐-᠙᥆-᥏᧐-᧚᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙⁰⁴-⁹₀-₉⅐-ↂↅ-↉①-⒛⓪-⓿❶-➓⳽〇〡-〩〸-〺㆒-㆕㈠-㈩㉈-㉏㉑-㉟㊀-㊉㊱-㊿꘠-꘩ꛦ-ꛯ꠰-꠵꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",astral:"\ud800[\udd07-\udd33\udd40-\udd78\udd8a\udd8b\udee1-\udefb\udf20-\udf23\udf41\udf4a\udfd1-\udfd5]|\ud801[\udca0-\udca9]|\ud802[\udc58-\udc5f\udc79-\udc7f\udca7-\udcaf\udcfb-\udcff\udd16-\udd1b\uddbc\uddbd\uddc0-\uddcf\uddd2-\uddff\ude40-\ude48\ude7d\ude7e\ude9d-\ude9f\udeeb-\udeef\udf58-\udf5f\udf78-\udf7f\udfa9-\udfaf]|\ud803[\udcfa-\udcff\udd30-\udd39\ude60-\ude7e\udf1d-\udf26\udf51-\udf54\udfc5-\udfcb]|\ud804[\udc52-\udc6f\udcf0-\udcf9\udd36-\udd3f\uddd0-\uddd9\udde1-\uddf4\udef0-\udef9]|\ud805[\udc50-\udc59\udcd0-\udcd9\ude50-\ude59\udec0-\udec9\udf30-\udf3b]|\ud806[\udce0-\udcf2\udd50-\udd59]|\ud807[\udc50-\udc6c\udd50-\udd59\udda0-\udda9\udfc0-\udfd4]|\ud809[\udc00-\udc6e]|\ud81a[\ude60-\ude69\udf50-\udf59\udf5b-\udf61]|\ud81b[\ude80-\ude96]|\ud834[\udee0-\udef3\udf60-\udf78]|\ud835[\udfce-\udfff]|\ud838[\udd40-\udd49\udef0-\udef9]|\ud83a[\udcc7-\udccf\udd50-\udd59]|\ud83b[\udc71-\udcab\udcad-\udcaf\udcb1-\udcb4\udd01-\udd2d\udd2f-\udd3d]|\ud83c[\udd00-\udd0c]|\ud83e[\udff0-\udff9]"},{name:"Nd",alias:"Decimal_Number",bmp:"0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",astral:"\ud801[\udca0-\udca9]|\ud803[\udd30-\udd39]|\ud804[\udc66-\udc6f\udcf0-\udcf9\udd36-\udd3f\uddd0-\uddd9\udef0-\udef9]|\ud805[\udc50-\udc59\udcd0-\udcd9\ude50-\ude59\udec0-\udec9\udf30-\udf39]|\ud806[\udce0-\udce9\udd50-\udd59]|\ud807[\udc50-\udc59\udd50-\udd59\udda0-\udda9]|\ud81a[\ude60-\ude69\udf50-\udf59]|\ud835[\udfce-\udfff]|\ud838[\udd40-\udd49\udef0-\udef9]|\ud83a[\udd50-\udd59]|\ud83e[\udff0-\udff9]"},{name:"Nl",alias:"Letter_Number",bmp:"ᛮ-ᛰⅠ-ↂↅ-ↈ〇〡-〩〸-〺ꛦ-ꛯ",astral:"\ud800[\udd40-\udd74\udf41\udf4a\udfd1-\udfd5]|\ud809[\udc00-\udc6e]"},{name:"No",alias:"Other_Number",bmp:"²³¹¼-¾৴-৹୲-୷௰-௲౸-౾൘-൞൰-൸༪-༳፩-፼៰-៹᧚⁰⁴-⁹₀-₉⅐-⅟↉①-⒛⓪-⓿❶-➓⳽㆒-㆕㈠-㈩㉈-㉏㉑-㉟㊀-㊉㊱-㊿꠰-꠵",astral:"\ud800[\udd07-\udd33\udd75-\udd78\udd8a\udd8b\udee1-\udefb\udf20-\udf23]|\ud802[\udc58-\udc5f\udc79-\udc7f\udca7-\udcaf\udcfb-\udcff\udd16-\udd1b\uddbc\uddbd\uddc0-\uddcf\uddd2-\uddff\ude40-\ude48\ude7d\ude7e\ude9d-\ude9f\udeeb-\udeef\udf58-\udf5f\udf78-\udf7f\udfa9-\udfaf]|\ud803[\udcfa-\udcff\ude60-\ude7e\udf1d-\udf26\udf51-\udf54\udfc5-\udfcb]|\ud804[\udc52-\udc65\udde1-\uddf4]|\ud805[\udf3a\udf3b]|\ud806[\udcea-\udcf2]|\ud807[\udc5a-\udc6c\udfc0-\udfd4]|\ud81a[\udf5b-\udf61]|\ud81b[\ude80-\ude96]|\ud834[\udee0-\udef3\udf60-\udf78]|\ud83a[\udcc7-\udccf]|\ud83b[\udc71-\udcab\udcad-\udcaf\udcb1-\udcb4\udd01-\udd2d\udd2f-\udd3d]|\ud83c[\udd00-\udd0c]"},{name:"P",alias:"Punctuation",bmp:"!-#%-\\*,-\\/:;\\?@\\[-\\]_\\{\\}¡§«¶·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰৽੶૰౷಄෴๏๚๛༄-༒༔༺-༽྅࿐-࿔࿙࿚၊-၏჻፠-፨᐀᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳀-᳇᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎⌈-⌋〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰-⹏⹒、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꣼꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꫰꫱꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･",astral:"\ud800[\udd00-\udd02\udf9f\udfd0]|𐕯|\ud802[\udc57\udd1f\udd3f\ude50-\ude58\ude7f\udef0-\udef6\udf39-\udf3f\udf99-\udf9c]|\ud803[\udead\udf55-\udf59]|\ud804[\udc47-\udc4d\udcbb\udcbc\udcbe-\udcc1\udd40-\udd43\udd74\udd75\uddc5-\uddc8\uddcd\udddb\udddd-\udddf\ude38-\ude3d\udea9]|\ud805[\udc4b-\udc4f\udc5a\udc5b\udc5d\udcc6\uddc1-\uddd7\ude41-\ude43\ude60-\ude6c\udf3c-\udf3e]|\ud806[\udc3b\udd44-\udd46\udde2\ude3f-\ude46\ude9a-\ude9c\ude9e-\udea2]|\ud807[\udc41-\udc45\udc70\udc71\udef7\udef8\udfff]|\ud809[\udc70-\udc74]|\ud81a[\ude6e\ude6f\udef5\udf37-\udf3b\udf44]|\ud81b[\ude97-\ude9a\udfe2]|𛲟|\ud836[\ude87-\ude8b]|\ud83a[\udd5e\udd5f]"},{name:"Pc",alias:"Connector_Punctuation",bmp:"_‿⁀⁔︳︴﹍-﹏＿"},{name:"Pd",alias:"Dash_Punctuation",bmp:"\\-֊־᐀᠆‐-―⸗⸚⸺⸻⹀〜〰゠︱︲﹘﹣－",astral:"𐺭"},{name:"Pe",alias:"Close_Punctuation",bmp:"\\)\\]\\}༻༽᚜⁆⁾₎⌉⌋〉❩❫❭❯❱❳❵⟆⟧⟩⟫⟭⟯⦄⦆⦈⦊⦌⦎⦐⦒⦔⦖⦘⧙⧛⧽⸣⸥⸧⸩〉》」』】〕〗〙〛〞〟﴾︘︶︸︺︼︾﹀﹂﹄﹈﹚﹜﹞）］｝｠｣"},{name:"Pf",alias:"Final_Punctuation",bmp:"»’”›⸃⸅⸊⸍⸝⸡"},{name:"Pi",alias:"Initial_Punctuation",bmp:"«‘‛“‟‹⸂⸄⸉⸌⸜⸠"},{name:"Po",alias:"Other_Punctuation",bmp:"!-#%-'\\*,\\.\\/:;\\?@\\¡§¶·¿;·՚-՟։׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰৽੶૰౷಄෴๏๚๛༄-༒༔྅࿐-࿔࿙࿚၊-၏჻፠-፨᙮᛫-᛭᜵᜶។-៖៘-៚᠀-᠅᠇-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳀-᳇᳓‖‗†-‧‰-‸※-‾⁁-⁃⁇-⁑⁓⁕-⁞⳹-⳼⳾⳿⵰⸀⸁⸆-⸈⸋⸎-⸖⸘⸙⸛⸞⸟⸪-⸮⸰-⸹⸼-⸿⹁⹃-⹏⹒、-〃〽・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꣼꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꫰꫱꯫︐-︖︙︰﹅﹆﹉-﹌﹐-﹒﹔-﹗﹟-﹡﹨﹪﹫！-＃％-＇＊，．／：；？＠＼｡､･",astral:"\ud800[\udd00-\udd02\udf9f\udfd0]|𐕯|\ud802[\udc57\udd1f\udd3f\ude50-\ude58\ude7f\udef0-\udef6\udf39-\udf3f\udf99-\udf9c]|\ud803[\udf55-\udf59]|\ud804[\udc47-\udc4d\udcbb\udcbc\udcbe-\udcc1\udd40-\udd43\udd74\udd75\uddc5-\uddc8\uddcd\udddb\udddd-\udddf\ude38-\ude3d\udea9]|\ud805[\udc4b-\udc4f\udc5a\udc5b\udc5d\udcc6\uddc1-\uddd7\ude41-\ude43\ude60-\ude6c\udf3c-\udf3e]|\ud806[\udc3b\udd44-\udd46\udde2\ude3f-\ude46\ude9a-\ude9c\ude9e-\udea2]|\ud807[\udc41-\udc45\udc70\udc71\udef7\udef8\udfff]|\ud809[\udc70-\udc74]|\ud81a[\ude6e\ude6f\udef5\udf37-\udf3b\udf44]|\ud81b[\ude97-\ude9a\udfe2]|𛲟|\ud836[\ude87-\ude8b]|\ud83a[\udd5e\udd5f]"},{name:"Ps",alias:"Open_Punctuation",bmp:"\\(\\[\\{༺༼᚛‚„⁅⁽₍⌈⌊〈❨❪❬❮❰❲❴⟅⟦⟨⟪⟬⟮⦃⦅⦇⦉⦋⦍⦏⦑⦓⦕⦗⧘⧚⧼⸢⸤⸦⸨⹂〈《「『【〔〖〘〚〝﴿︗︵︷︹︻︽︿﹁﹃﹇﹙﹛﹝（［｛｟｢"},{name:"S",alias:"Symbol",bmp:"\\$\\+<->\\^`\\|~¢-¦¨©¬®-±´¸×÷˂-˅˒-˟˥-˫˭˯-˿͵΄΅϶҂֍-֏؆-؈؋؎؏۞۩۽۾߶߾߿৲৳৺৻૱୰௳-௺౿൏൹฿༁-༃༓༕-༗༚-༟༴༶༸྾-࿅࿇-࿌࿎࿏࿕-࿘႞႟᎐-᎙᙭៛᥀᧞-᧿᭡-᭪᭴-᭼᾽᾿-῁῍-῏῝-῟῭-`´῾⁄⁒⁺-⁼₊-₌₠-₿℀℁℃-℆℈℉℔№-℘℞-℣℥℧℩℮℺℻⅀-⅄⅊-⅍⅏↊↋←-⌇⌌-⌨⌫-␦⑀-⑊⒜-ⓩ─-❧➔-⟄⟇-⟥⟰-⦂⦙-⧗⧜-⧻⧾-⭳⭶-⮕⮗-⯿⳥-⳪⹐⹑⺀-⺙⺛-⻳⼀-⿕⿰-⿻〄〒〓〠〶〷〾〿゛゜㆐㆑㆖-㆟㇀-㇣㈀-㈞㈪-㉇㉐㉠-㉿㊊-㊰㋀-㏿䷀-䷿꒐-꓆꜀-꜖꜠꜡꞉꞊꠨-꠫꠶-꠹꩷-꩹꭛꭪꭫﬩﮲-﯁﷼﷽﹢﹤-﹦﹩＄＋＜-＞＾｀｜～￠-￦￨-￮￼�",astral:"\ud800[\udd37-\udd3f\udd79-\udd89\udd8c-\udd8e\udd90-\udd9c\udda0\uddd0-\uddfc]|\ud802[\udc77\udc78\udec8]|𑜿|\ud807[\udfd5-\udff1]|\ud81a[\udf3c-\udf3f\udf45]|𛲜|\ud834[\udc00-\udcf5\udd00-\udd26\udd29-\udd64\udd6a-\udd6c\udd83\udd84\udd8c-\udda9\uddae-\udde8\ude00-\ude41\ude45\udf00-\udf56]|\ud835[\udec1\udedb\udefb\udf15\udf35\udf4f\udf6f\udf89\udfa9\udfc3]|\ud836[\udc00-\uddff\ude37-\ude3a\ude6d-\ude74\ude76-\ude83\ude85\ude86]|\ud838[\udd4f\udeff]|\ud83b[\udcac\udcb0\udd2e\udef0\udef1]|\ud83c[\udc00-\udc2b\udc30-\udc93\udca0-\udcae\udcb1-\udcbf\udcc1-\udccf\udcd1-\udcf5\udd0d-\uddad\udde6-\ude02\ude10-\ude3b\ude40-\ude48\ude50\ude51\ude60-\ude65\udf00-\udfff]|\ud83d[\udc00-\uded7\udee0-\udeec\udef0-\udefc\udf00-\udf73\udf80-\udfd8\udfe0-\udfeb]|\ud83e[\udc00-\udc0b\udc10-\udc47\udc50-\udc59\udc60-\udc87\udc90-\udcad\udcb0\udcb1\udd00-\udd78\udd7a-\uddcb\uddcd-\ude53\ude60-\ude6d\ude70-\ude74\ude78-\ude7a\ude80-\ude86\ude90-\udea8\udeb0-\udeb6\udec0-\udec2\uded0-\uded6\udf00-\udf92\udf94-\udfca]"},{name:"Sc",alias:"Currency_Symbol",bmp:"\\$¢-¥֏؋߾߿৲৳৻૱௹฿៛₠-₿꠸﷼﹩＄￠￡￥￦",astral:"\ud807[\udfdd-\udfe0]|𞋿|𞲰"},{name:"Sk",alias:"Modifier_Symbol",bmp:"\\^`¨¯´¸˂-˅˒-˟˥-˫˭˯-˿͵΄΅᾽᾿-῁῍-῏῝-῟῭-`´῾゛゜꜀-꜖꜠꜡꞉꞊꭛꭪꭫﮲-﯁＾｀￣",astral:"\ud83c[\udffb-\udfff]"},{name:"Sm",alias:"Math_Symbol",bmp:"\\+<->\\|~¬±×÷϶؆-؈⁄⁒⁺-⁼₊-₌℘⅀-⅄⅋←-↔↚↛↠↣↦↮⇎⇏⇒⇔⇴-⋿⌠⌡⍼⎛-⎳⏜-⏡▷◁◸-◿♯⟀-⟄⟇-⟥⟰-⟿⤀-⦂⦙-⧗⧜-⧻⧾-⫿⬰-⭄⭇-⭌﬩﹢﹤-﹦＋＜-＞｜～￢￩-￬",astral:"\ud835[\udec1\udedb\udefb\udf15\udf35\udf4f\udf6f\udf89\udfa9\udfc3]|\ud83b[\udef0\udef1]"},{name:"So",alias:"Other_Symbol",bmp:"¦©®°҂֍֎؎؏۞۩۽۾߶৺୰௳-௸௺౿൏൹༁-༃༓༕-༗༚-༟༴༶༸྾-࿅࿇-࿌࿎࿏࿕-࿘႞႟᎐-᎙᙭᥀᧞-᧿᭡-᭪᭴-᭼℀℁℃-℆℈℉℔№℗℞-℣℥℧℩℮℺℻⅊⅌⅍⅏↊↋↕-↙↜-↟↡↢↤↥↧-↭↯-⇍⇐⇑⇓⇕-⇳⌀-⌇⌌-⌟⌢-⌨⌫-⍻⍽-⎚⎴-⏛⏢-␦⑀-⑊⒜-ⓩ─-▶▸-◀◂-◷☀-♮♰-❧➔-➿⠀-⣿⬀-⬯⭅⭆⭍-⭳⭶-⮕⮗-⯿⳥-⳪⹐⹑⺀-⺙⺛-⻳⼀-⿕⿰-⿻〄〒〓〠〶〷〾〿㆐㆑㆖-㆟㇀-㇣㈀-㈞㈪-㉇㉐㉠-㉿㊊-㊰㋀-㏿䷀-䷿꒐-꓆꠨-꠫꠶꠷꠹꩷-꩹﷽￤￨￭￮￼�",astral:"\ud800[\udd37-\udd3f\udd79-\udd89\udd8c-\udd8e\udd90-\udd9c\udda0\uddd0-\uddfc]|\ud802[\udc77\udc78\udec8]|𑜿|\ud807[\udfd5-\udfdc\udfe1-\udff1]|\ud81a[\udf3c-\udf3f\udf45]|𛲜|\ud834[\udc00-\udcf5\udd00-\udd26\udd29-\udd64\udd6a-\udd6c\udd83\udd84\udd8c-\udda9\uddae-\udde8\ude00-\ude41\ude45\udf00-\udf56]|\ud836[\udc00-\uddff\ude37-\ude3a\ude6d-\ude74\ude76-\ude83\ude85\ude86]|𞅏|\ud83b[\udcac\udd2e]|\ud83c[\udc00-\udc2b\udc30-\udc93\udca0-\udcae\udcb1-\udcbf\udcc1-\udccf\udcd1-\udcf5\udd0d-\uddad\udde6-\ude02\ude10-\ude3b\ude40-\ude48\ude50\ude51\ude60-\ude65\udf00-\udffa]|\ud83d[\udc00-\uded7\udee0-\udeec\udef0-\udefc\udf00-\udf73\udf80-\udfd8\udfe0-\udfeb]|\ud83e[\udc00-\udc0b\udc10-\udc47\udc50-\udc59\udc60-\udc87\udc90-\udcad\udcb0\udcb1\udd00-\udd78\udd7a-\uddcb\uddcd-\ude53\ude60-\ude6d\ude70-\ude74\ude78-\ude7a\ude80-\ude86\ude90-\udea8\udeb0-\udeb6\udec0-\udec2\uded0-\uded6\udf00-\udf92\udf94-\udfca]"},{name:"Z",alias:"Separator",bmp:"    - \u2028\u2029  　"},{name:"Zl",alias:"Line_Separator",bmp:"\u2028"},{name:"Zp",alias:"Paragraph_Separator",bmp:"\u2029"},{name:"Zs",alias:"Space_Separator",bmp:"    -   　"}],iD=jc((function(t,e){eC(e,"__esModule",{value:!0}),e.default=void 0;var i=dx(eD);
/*!
     * XRegExp Unicode Categories 4.4.0
     * <xregexp.com>
     * Steven Levithan (c) 2010-present MIT License
     * Unicode data by Mathias Bynens <mathiasbynens.be>
     */e.default=function(t){if(!t.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Categories");t.addUnicodeData(i.default)},t.exports=e.default}));Uc(iD);var nD=[{name:"ASCII",bmp:"\0-"},{name:"Alphabetic",bmp:"A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͅͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈְ-ׇֽֿׁׂׅׄא-תׯ-ײؐ-ؚؠ-ٗٙ-ٟٮ-ۓە-ۜۡ-ۭۨ-ۯۺ-ۼۿܐ-ܿݍ-ޱߊ-ߪߴߵߺࠀ-ࠗࠚ-ࠬࡀ-ࡘࡠ-ࡪࢠ-ࢴࢶ-ࣇࣔ-ࣣࣟ-ࣰࣩ-ऻऽ-ौॎ-ॐॕ-ॣॱ-ঃঅ-ঌএঐও-নপ-রলশ-হঽ-ৄেৈোৌৎৗড়ঢ়য়-ৣৰৱৼਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਾ-ੂੇੈੋੌੑਖ਼-ੜਫ਼ੰ-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽ-ૅે-ૉોૌૐૠ-ૣૹ-ૼଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽ-ୄେୈୋୌୖୗଡ଼ଢ଼ୟ-ୣୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-ௌௐௗఀ-ఃఅ-ఌఎ-ఐఒ-నప-హఽ-ౄె-ైొ-ౌౕౖౘ-ౚౠ-ౣಀ-ಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽ-ೄೆ-ೈೊ-ೌೕೖೞೠ-ೣೱೲഀ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൌൎൔ-ൗൟ-ൣൺ-ൿඁ-ඃඅ-ඖක-නඳ-රලව-ෆා-ුූෘ-ෟෲෳก-ฺเ-ๆํກຂຄຆ-ຊຌ-ຣລວ-ູົ-ຽເ-ໄໆໍໜ-ໟༀཀ-ཇཉ-ཬཱ-ཱྀྈ-ྗྙ-ྼက-ံးျ-ဿၐ-ႏႚ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜓᜠ-ᜳᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-ឳា-ៈៗៜᠠ-ᡸᢀ-ᢪᢰ-ᣵᤀ-ᤞᤠ-ᤫᤰ-ᤸᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨛᨠ-ᩞᩡ-ᩴᪧᪿᫀᬀ-ᬳᬵ-ᭃᭅ-ᭋᮀ-ᮩᮬ-ᮯᮺ-ᯥᯧ-ᯱᰀ-ᰶᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿᷧ-ᷴḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⒶ-ⓩⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-鿼ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙴ-ꙻꙿ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞿꟂ-ꟊꟵ-ꠅꠇ-ꠧꡀ-ꡳꢀ-ꣃꣅꣲ-ꣷꣻꣽ-ꣿꤊ-ꤪꤰ-ꥒꥠ-ꥼꦀ-ꦲꦴ-ꦿꧏꧠ-ꧯꧺ-ꧾꨀ-ꨶꩀ-ꩍꩠ-ꩶꩺ-ꪾꫀꫂꫛ-ꫝꫠ-ꫯꫲ-ꫵꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯪ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",astral:"\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa\udd40-\udd74\ude80-\ude9c\udea0-\uded0\udf00-\udf1f\udf2d-\udf4a\udf50-\udf7a\udf80-\udf9d\udfa0-\udfc3\udfc8-\udfcf\udfd1-\udfd5]|\ud801[\udc00-\udc9d\udcb0-\udcd3\udcd8-\udcfb\udd00-\udd27\udd30-\udd63\ude00-\udf36\udf40-\udf55\udf60-\udf67]|\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f-\udc55\udc60-\udc76\udc80-\udc9e\udce0-\udcf2\udcf4\udcf5\udd00-\udd15\udd20-\udd39\udd80-\uddb7\uddbe\uddbf\ude00-\ude03\ude05\ude06\ude0c-\ude13\ude15-\ude17\ude19-\ude35\ude60-\ude7c\ude80-\ude9c\udec0-\udec7\udec9-\udee4\udf00-\udf35\udf40-\udf55\udf60-\udf72\udf80-\udf91]|\ud803[\udc00-\udc48\udc80-\udcb2\udcc0-\udcf2\udd00-\udd27\ude80-\udea9\udeab\udeac\udeb0\udeb1\udf00-\udf1c\udf27\udf30-\udf45\udfb0-\udfc4\udfe0-\udff6]|\ud804[\udc00-\udc45\udc82-\udcb8\udcd0-\udce8\udd00-\udd32\udd44-\udd47\udd50-\udd72\udd76\udd80-\uddbf\uddc1-\uddc4\uddce\uddcf\uddda\udddc\ude00-\ude11\ude13-\ude34\ude37\ude3e\ude80-\ude86\ude88\ude8a-\ude8d\ude8f-\ude9d\ude9f-\udea8\udeb0-\udee8\udf00-\udf03\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3d-\udf44\udf47\udf48\udf4b\udf4c\udf50\udf57\udf5d-\udf63]|\ud805[\udc00-\udc41\udc43-\udc45\udc47-\udc4a\udc5f-\udc61\udc80-\udcc1\udcc4\udcc5\udcc7\udd80-\uddb5\uddb8-\uddbe\uddd8-\udddd\ude00-\ude3e\ude40\ude44\ude80-\udeb5\udeb8\udf00-\udf1a\udf1d-\udf2a]|\ud806[\udc00-\udc38\udca0-\udcdf\udcff-\udd06\udd09\udd0c-\udd13\udd15\udd16\udd18-\udd35\udd37\udd38\udd3b\udd3c\udd3f-\udd42\udda0-\udda7\uddaa-\uddd7\uddda-\udddf\udde1\udde3\udde4\ude00-\ude32\ude35-\ude3e\ude50-\ude97\ude9d\udec0-\udef8]|\ud807[\udc00-\udc08\udc0a-\udc36\udc38-\udc3e\udc40\udc72-\udc8f\udc92-\udca7\udca9-\udcb6\udd00-\udd06\udd08\udd09\udd0b-\udd36\udd3a\udd3c\udd3d\udd3f-\udd41\udd43\udd46\udd47\udd60-\udd65\udd67\udd68\udd6a-\udd8e\udd90\udd91\udd93-\udd96\udd98\udee0-\udef6\udfb0]|\ud808[\udc00-\udf99]|\ud809[\udc00-\udc6e\udc80-\udd43]|[\ud80c\ud81c-\ud820\ud822\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872\ud874-\ud879\ud880-\ud883][\udc00-\udfff]|\ud80d[\udc00-\udc2e]|\ud811[\udc00-\ude46]|\ud81a[\udc00-\ude38\ude40-\ude5e\uded0-\udeed\udf00-\udf2f\udf40-\udf43\udf63-\udf77\udf7d-\udf8f]|\ud81b[\ude40-\ude7f\udf00-\udf4a\udf4f-\udf87\udf8f-\udf9f\udfe0\udfe1\udfe3\udff0\udff1]|\ud821[\udc00-\udff7]|\ud823[\udc00-\udcd5\udd00-\udd08]|\ud82c[\udc00-\udd1e\udd50-\udd52\udd64-\udd67\udd70-\udefb]|\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99\udc9e]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udec0\udec2-\udeda\udedc-\udefa\udefc-\udf14\udf16-\udf34\udf36-\udf4e\udf50-\udf6e\udf70-\udf88\udf8a-\udfa8\udfaa-\udfc2\udfc4-\udfcb]|\ud838[\udc00-\udc06\udc08-\udc18\udc1b-\udc21\udc23\udc24\udc26-\udc2a\udd00-\udd2c\udd37-\udd3d\udd4e\udec0-\udeeb]|\ud83a[\udc00-\udcc4\udd00-\udd43\udd47\udd4b]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb]|\ud83c[\udd30-\udd49\udd50-\udd69\udd70-\udd89]|\ud869[\udc00-\udedd\udf00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d\udc20-\udfff]|\ud873[\udc00-\udea1\udeb0-\udfff]|\ud87a[\udc00-\udfe0]|\ud87e[\udc00-\ude1d]|\ud884[\udc00-\udf4a]"},{name:"Any",isBmpLast:!0,bmp:"\0-￿",astral:"[\ud800-\udbff][\udc00-\udfff]"},{name:"Default_Ignorable_Code_Point",bmp:"­͏؜ᅟᅠ឴឵᠋-᠎​-‏‪-‮⁠-⁯ㅤ︀-️\ufeffﾠ￰-￸",astral:"\ud82f[\udca0-\udca3]|\ud834[\udd73-\udd7a]|[\udb40-\udb43][\udc00-\udfff]"},{name:"Lowercase",bmp:"a-zªµºß-öø-ÿāăąćĉċčďđēĕėęěĝğġģĥħĩīĭįıĳĵķĸĺļľŀłńņňŉŋōŏőœŕŗřśŝşšţťŧũūŭůűųŵŷźżž-ƀƃƅƈƌƍƒƕƙ-ƛƞơƣƥƨƪƫƭưƴƶƹƺƽ-ƿǆǉǌǎǐǒǔǖǘǚǜǝǟǡǣǥǧǩǫǭǯǰǳǵǹǻǽǿȁȃȅȇȉȋȍȏȑȓȕȗșțȝȟȡȣȥȧȩȫȭȯȱȳ-ȹȼȿɀɂɇɉɋɍɏ-ʓʕ-ʸˀˁˠ-ˤͅͱͳͷͺ-ͽΐά-ώϐϑϕ-ϗϙϛϝϟϡϣϥϧϩϫϭϯ-ϳϵϸϻϼа-џѡѣѥѧѩѫѭѯѱѳѵѷѹѻѽѿҁҋҍҏґғҕҗҙқҝҟҡңҥҧҩҫҭүұҳҵҷҹһҽҿӂӄӆӈӊӌӎӏӑӓӕӗәӛӝӟӡӣӥӧөӫӭӯӱӳӵӷӹӻӽӿԁԃԅԇԉԋԍԏԑԓԕԗԙԛԝԟԡԣԥԧԩԫԭԯՠ-ֈა-ჺჽ-ჿᏸ-ᏽᲀ-ᲈᴀ-ᶿḁḃḅḇḉḋḍḏḑḓḕḗḙḛḝḟḡḣḥḧḩḫḭḯḱḳḵḷḹḻḽḿṁṃṅṇṉṋṍṏṑṓṕṗṙṛṝṟṡṣṥṧṩṫṭṯṱṳṵṷṹṻṽṿẁẃẅẇẉẋẍẏẑẓẕ-ẝẟạảấầẩẫậắằẳẵặẹẻẽếềểễệỉịọỏốồổỗộớờởỡợụủứừửữựỳỵỷỹỻỽỿ-ἇἐ-ἕἠ-ἧἰ-ἷὀ-ὅὐ-ὗὠ-ὧὰ-ώᾀ-ᾇᾐ-ᾗᾠ-ᾧᾰ-ᾴᾶᾷιῂ-ῄῆῇῐ-ΐῖῗῠ-ῧῲ-ῴῶῷⁱⁿₐ-ₜℊℎℏℓℯℴℹℼℽⅆ-ⅉⅎⅰ-ⅿↄⓐ-ⓩⰰ-ⱞⱡⱥⱦⱨⱪⱬⱱⱳⱴⱶ-ⱽⲁⲃⲅⲇⲉⲋⲍⲏⲑⲓⲕⲗⲙⲛⲝⲟⲡⲣⲥⲧⲩⲫⲭⲯⲱⲳⲵⲷⲹⲻⲽⲿⳁⳃⳅⳇⳉⳋⳍⳏⳑⳓⳕⳗⳙⳛⳝⳟⳡⳣⳤⳬⳮⳳⴀ-ⴥⴧⴭꙁꙃꙅꙇꙉꙋꙍꙏꙑꙓꙕꙗꙙꙛꙝꙟꙡꙣꙥꙧꙩꙫꙭꚁꚃꚅꚇꚉꚋꚍꚏꚑꚓꚕꚗꚙꚛ-ꚝꜣꜥꜧꜩꜫꜭꜯ-ꜱꜳꜵꜷꜹꜻꜽꜿꝁꝃꝅꝇꝉꝋꝍꝏꝑꝓꝕꝗꝙꝛꝝꝟꝡꝣꝥꝧꝩꝫꝭꝯ-ꝸꝺꝼꝿꞁꞃꞅꞇꞌꞎꞑꞓ-ꞕꞗꞙꞛꞝꞟꞡꞣꞥꞧꞩꞯꞵꞷꞹꞻꞽꞿꟃꟈꟊꟶꟸ-ꟺꬰ-ꭚꭜ-ꭨꭰ-ꮿﬀ-ﬆﬓ-ﬗａ-ｚ",astral:"\ud801[\udc28-\udc4f\udcd8-\udcfb]|\ud803[\udcc0-\udcf2]|\ud806[\udcc0-\udcdf]|\ud81b[\ude60-\ude7f]|\ud835[\udc1a-\udc33\udc4e-\udc54\udc56-\udc67\udc82-\udc9b\udcb6-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udccf\udcea-\udd03\udd1e-\udd37\udd52-\udd6b\udd86-\udd9f\uddba-\uddd3\uddee-\ude07\ude22-\ude3b\ude56-\ude6f\ude8a-\udea5\udec2-\udeda\udedc-\udee1\udefc-\udf14\udf16-\udf1b\udf36-\udf4e\udf50-\udf55\udf70-\udf88\udf8a-\udf8f\udfaa-\udfc2\udfc4-\udfc9\udfcb]|\ud83a[\udd22-\udd43]"},{name:"Noncharacter_Code_Point",bmp:"﷐-﷯￾￿",astral:"[\ud83f\ud87f\ud8bf\ud8ff\ud93f\ud97f\ud9bf\ud9ff\uda3f\uda7f\udabf\udaff\udb3f\udb7f\udbbf\udbff][\udffe\udfff]"},{name:"Uppercase",bmp:"A-ZÀ-ÖØ-ÞĀĂĄĆĈĊČĎĐĒĔĖĘĚĜĞĠĢĤĦĨĪĬĮİĲĴĶĹĻĽĿŁŃŅŇŊŌŎŐŒŔŖŘŚŜŞŠŢŤŦŨŪŬŮŰŲŴŶŸŹŻŽƁƂƄƆƇƉ-ƋƎ-ƑƓƔƖ-ƘƜƝƟƠƢƤƦƧƩƬƮƯƱ-ƳƵƷƸƼǄǇǊǍǏǑǓǕǗǙǛǞǠǢǤǦǨǪǬǮǱǴǶ-ǸǺǼǾȀȂȄȆȈȊȌȎȐȒȔȖȘȚȜȞȠȢȤȦȨȪȬȮȰȲȺȻȽȾɁɃ-ɆɈɊɌɎͰͲͶͿΆΈ-ΊΌΎΏΑ-ΡΣ-ΫϏϒ-ϔϘϚϜϞϠϢϤϦϨϪϬϮϴϷϹϺϽ-ЯѠѢѤѦѨѪѬѮѰѲѴѶѸѺѼѾҀҊҌҎҐҒҔҖҘҚҜҞҠҢҤҦҨҪҬҮҰҲҴҶҸҺҼҾӀӁӃӅӇӉӋӍӐӒӔӖӘӚӜӞӠӢӤӦӨӪӬӮӰӲӴӶӸӺӼӾԀԂԄԆԈԊԌԎԐԒԔԖԘԚԜԞԠԢԤԦԨԪԬԮԱ-ՖႠ-ჅჇჍᎠ-ᏵᲐ-ᲺᲽ-ᲿḀḂḄḆḈḊḌḎḐḒḔḖḘḚḜḞḠḢḤḦḨḪḬḮḰḲḴḶḸḺḼḾṀṂṄṆṈṊṌṎṐṒṔṖṘṚṜṞṠṢṤṦṨṪṬṮṰṲṴṶṸṺṼṾẀẂẄẆẈẊẌẎẐẒẔẞẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼẾỀỂỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪỬỮỰỲỴỶỸỺỼỾἈ-ἏἘ-ἝἨ-ἯἸ-ἿὈ-ὍὙὛὝὟὨ-ὯᾸ-ΆῈ-ΉῘ-ΊῨ-ῬῸ-Ώℂℇℋ-ℍℐ-ℒℕℙ-ℝℤΩℨK-ℭℰ-ℳℾℿⅅⅠ-ⅯↃⒶ-ⓏⰀ-ⰮⱠⱢ-ⱤⱧⱩⱫⱭ-ⱰⱲⱵⱾ-ⲀⲂⲄⲆⲈⲊⲌⲎⲐⲒⲔⲖⲘⲚⲜⲞⲠⲢⲤⲦⲨⲪⲬⲮⲰⲲⲴⲶⲸⲺⲼⲾⳀⳂⳄⳆⳈⳊⳌⳎⳐⳒⳔⳖⳘⳚⳜⳞⳠⳢⳫⳭⳲꙀꙂꙄꙆꙈꙊꙌꙎꙐꙒꙔꙖꙘꙚꙜꙞꙠꙢꙤꙦꙨꙪꙬꚀꚂꚄꚆꚈꚊꚌꚎꚐꚒꚔꚖꚘꚚꜢꜤꜦꜨꜪꜬꜮꜲꜴꜶꜸꜺꜼꜾꝀꝂꝄꝆꝈꝊꝌꝎꝐꝒꝔꝖꝘꝚꝜꝞꝠꝢꝤꝦꝨꝪꝬꝮꝹꝻꝽꝾꞀꞂꞄꞆꞋꞍꞐꞒꞖꞘꞚꞜꞞꞠꞢꞤꞦꞨꞪ-ꞮꞰ-ꞴꞶꞸꞺꞼꞾꟂꟄ-ꟇꟉꟵＡ-Ｚ",astral:"\ud801[\udc00-\udc27\udcb0-\udcd3]|\ud803[\udc80-\udcb2]|\ud806[\udca0-\udcbf]|\ud81b[\ude40-\ude5f]|\ud835[\udc00-\udc19\udc34-\udc4d\udc68-\udc81\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb5\udcd0-\udce9\udd04\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd38\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd6c-\udd85\udda0-\uddb9\uddd4-\udded\ude08-\ude21\ude3c-\ude55\ude70-\ude89\udea8-\udec0\udee2-\udefa\udf1c-\udf34\udf56-\udf6e\udf90-\udfa8\udfca]|\ud83a[\udd00-\udd21]|\ud83c[\udd30-\udd49\udd50-\udd69\udd70-\udd89]"},{name:"White_Space",bmp:"\t-\r    - \u2028\u2029  　"}],rD=jc((function(t,e){eC(e,"__esModule",{value:!0}),e.default=void 0;var i=dx(nD);
/*!
     * XRegExp Unicode Properties 4.4.0
     * <xregexp.com>
     * Steven Levithan (c) 2012-present MIT License
     * Unicode data by Mathias Bynens <mathiasbynens.be>
     */e.default=function(t){if(!t.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Properties");var e=i.default;e.push({name:"Assigned",inverseOf:"Cn"}),t.addUnicodeData(e)},t.exports=e.default}));Uc(rD);var oD=[{name:"Adlam",astral:"\ud83a[\udd00-\udd4b\udd50-\udd59\udd5e\udd5f]"},{name:"Ahom",astral:"\ud805[\udf00-\udf1a\udf1d-\udf2b\udf30-\udf3f]"},{name:"Anatolian_Hieroglyphs",astral:"\ud811[\udc00-\ude46]"},{name:"Arabic",bmp:"؀-؄؆-؋؍-ؚ؜؞ؠ-ؿف-يٖ-ٯٱ-ۜ۞-ۿݐ-ݿࢠ-ࢴࢶ-ࣇ࣓-ࣣ࣡-ࣿﭐ-﯁ﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-﷽ﹰ-ﹴﹶ-ﻼ",astral:"\ud803[\ude60-\ude7e]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb\udef0\udef1]"},{name:"Armenian",bmp:"Ա-Ֆՙ-֊֍-֏ﬓ-ﬗ"},{name:"Avestan",astral:"\ud802[\udf00-\udf35\udf39-\udf3f]"},{name:"Balinese",bmp:"ᬀ-ᭋ᭐-᭼"},{name:"Bamum",bmp:"ꚠ-꛷",astral:"\ud81a[\udc00-\ude38]"},{name:"Bassa_Vah",astral:"\ud81a[\uded0-\udeed\udef0-\udef5]"},{name:"Batak",bmp:"ᯀ-᯳᯼-᯿"},{name:"Bengali",bmp:"ঀ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-৾"},{name:"Bhaiksuki",astral:"\ud807[\udc00-\udc08\udc0a-\udc36\udc38-\udc45\udc50-\udc6c]"},{name:"Bopomofo",bmp:"˪˫ㄅ-ㄯㆠ-ㆿ"},{name:"Brahmi",astral:"\ud804[\udc00-\udc4d\udc52-\udc6f\udc7f]"},{name:"Braille",bmp:"⠀-⣿"},{name:"Buginese",bmp:"ᨀ-ᨛ᨞᨟"},{name:"Buhid",bmp:"ᝀ-ᝓ"},{name:"Canadian_Aboriginal",bmp:"᐀-ᙿᢰ-ᣵ"},{name:"Carian",astral:"\ud800[\udea0-\uded0]"},{name:"Caucasian_Albanian",astral:"\ud801[\udd30-\udd63\udd6f]"},{name:"Chakma",astral:"\ud804[\udd00-\udd34\udd36-\udd47]"},{name:"Cham",bmp:"ꨀ-ꨶꩀ-ꩍ꩐-꩙꩜-꩟"},{name:"Cherokee",bmp:"Ꭰ-Ᏽᏸ-ᏽꭰ-ꮿ"},{name:"Chorasmian",astral:"\ud803[\udfb0-\udfcb]"},{name:"Common",bmp:"\0-@\\[-`\\{-©«-¹»-¿×÷ʹ-˟˥-˩ˬ-˿ʹ;΅·؅،؛؟ـ۝࣢।॥฿࿕-࿘჻᛫-᛭᜵᜶᠂᠃᠅᳓᳡ᳩ-ᳬᳮ-ᳳᳵ-᳷ᳺ -​‎-⁤⁦-⁰⁴-⁾₀-₎₠-₿℀-℥℧-℩ℬ-ℱℳ-⅍⅏-⅟↉-↋←-␦⑀-⑊①-⟿⤀-⭳⭶-⮕⮗-⯿⸀-⹒⿰-⿻　-〄〆〈-〠〰-〷〼-〿゛゜゠・ー㆐-㆟㇀-㇣㈠-㉟㉿-㋏㋿㍘-㏿䷀-䷿꜀-꜡ꞈ-꞊꠰-꠹꤮ꧏ꭛꭪꭫﴾﴿︐-︙︰-﹒﹔-﹦﹨-﹫\ufeff！-＠［-｀｛-･ｰﾞﾟ￠-￦￨-￮￹-�",astral:"\ud800[\udd00-\udd02\udd07-\udd33\udd37-\udd3f\udd90-\udd9c\uddd0-\uddfc\udee1-\udefb]|\ud81b[\udfe2\udfe3]|\ud82f[\udca0-\udca3]|\ud834[\udc00-\udcf5\udd00-\udd26\udd29-\udd66\udd6a-\udd7a\udd83\udd84\udd8c-\udda9\uddae-\udde8\udee0-\udef3\udf00-\udf56\udf60-\udf78]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udfcb\udfce-\udfff]|\ud83b[\udc71-\udcb4\udd01-\udd3d]|\ud83c[\udc00-\udc2b\udc30-\udc93\udca0-\udcae\udcb1-\udcbf\udcc1-\udccf\udcd1-\udcf5\udd00-\uddad\udde6-\uddff\ude01\ude02\ude10-\ude3b\ude40-\ude48\ude50\ude51\ude60-\ude65\udf00-\udfff]|\ud83d[\udc00-\uded7\udee0-\udeec\udef0-\udefc\udf00-\udf73\udf80-\udfd8\udfe0-\udfeb]|\ud83e[\udc00-\udc0b\udc10-\udc47\udc50-\udc59\udc60-\udc87\udc90-\udcad\udcb0\udcb1\udd00-\udd78\udd7a-\uddcb\uddcd-\ude53\ude60-\ude6d\ude70-\ude74\ude78-\ude7a\ude80-\ude86\ude90-\udea8\udeb0-\udeb6\udec0-\udec2\uded0-\uded6\udf00-\udf92\udf94-\udfca\udff0-\udff9]|\udb40[\udc01\udc20-\udc7f]"},{name:"Coptic",bmp:"Ϣ-ϯⲀ-ⳳ⳹-⳿"},{name:"Cuneiform",astral:"\ud808[\udc00-\udf99]|\ud809[\udc00-\udc6e\udc70-\udc74\udc80-\udd43]"},{name:"Cypriot",astral:"\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f]"},{name:"Cyrillic",bmp:"Ѐ-҄҇-ԯᲀ-ᲈᴫᵸⷠ-ⷿꙀ-ꚟ︮︯"},{name:"Deseret",astral:"\ud801[\udc00-\udc4f]"},{name:"Devanagari",bmp:"ऀ-ॐॕ-ॣ०-ॿ꣠-ꣿ"},{name:"Dives_Akuru",astral:"\ud806[\udd00-\udd06\udd09\udd0c-\udd13\udd15\udd16\udd18-\udd35\udd37\udd38\udd3b-\udd46\udd50-\udd59]"},{name:"Dogra",astral:"\ud806[\udc00-\udc3b]"},{name:"Duployan",astral:"\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99\udc9c-\udc9f]"},{name:"Egyptian_Hieroglyphs",astral:"\ud80c[\udc00-\udfff]|\ud80d[\udc00-\udc2e\udc30-\udc38]"},{name:"Elbasan",astral:"\ud801[\udd00-\udd27]"},{name:"Elymaic",astral:"\ud803[\udfe0-\udff6]"},{name:"Ethiopic",bmp:"ሀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፼ᎀ-᎙ⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮ"},{name:"Georgian",bmp:"Ⴀ-ჅჇჍა-ჺჼ-ჿᲐ-ᲺᲽ-Ჿⴀ-ⴥⴧⴭ"},{name:"Glagolitic",bmp:"Ⰰ-Ⱞⰰ-ⱞ",astral:"\ud838[\udc00-\udc06\udc08-\udc18\udc1b-\udc21\udc23\udc24\udc26-\udc2a]"},{name:"Gothic",astral:"\ud800[\udf30-\udf4a]"},{name:"Grantha",astral:"\ud804[\udf00-\udf03\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3c-\udf44\udf47\udf48\udf4b-\udf4d\udf50\udf57\udf5d-\udf63\udf66-\udf6c\udf70-\udf74]"},{name:"Greek",bmp:"Ͱ-ͳ͵-ͷͺ-ͽͿ΄ΆΈ-ΊΌΎ-ΡΣ-ϡϰ-Ͽᴦ-ᴪᵝ-ᵡᵦ-ᵪᶿἀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ῄῆ-ΐῖ-Ί῝-`ῲ-ῴῶ-῾Ωꭥ",astral:"\ud800[\udd40-\udd8e\udda0]|\ud834[\ude00-\ude45]"},{name:"Gujarati",bmp:"ઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૱ૹ-૿"},{name:"Gunjala_Gondi",astral:"\ud807[\udd60-\udd65\udd67\udd68\udd6a-\udd8e\udd90\udd91\udd93-\udd98\udda0-\udda9]"},{name:"Gurmukhi",bmp:"ਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-੶"},{name:"Han",bmp:"⺀-⺙⺛-⻳⼀-⿕々〇〡-〩〸-〻㐀-䶿一-鿼豈-舘並-龎",astral:"\ud81b[\udff0\udff1]|[\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872\ud874-\ud879\ud880-\ud883][\udc00-\udfff]|\ud869[\udc00-\udedd\udf00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d\udc20-\udfff]|\ud873[\udc00-\udea1\udeb0-\udfff]|\ud87a[\udc00-\udfe0]|\ud87e[\udc00-\ude1d]|\ud884[\udc00-\udf4a]"},{name:"Hangul",bmp:"ᄀ-ᇿ〮〯ㄱ-ㆎ㈀-㈞㉠-㉾ꥠ-ꥼ가-힣ힰ-ퟆퟋ-ퟻﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ"},{name:"Hanifi_Rohingya",astral:"\ud803[\udd00-\udd27\udd30-\udd39]"},{name:"Hanunoo",bmp:"ᜠ-᜴"},{name:"Hatran",astral:"\ud802[\udce0-\udcf2\udcf4\udcf5\udcfb-\udcff]"},{name:"Hebrew",bmp:"֑-ׇא-תׯ-״יִ-זּטּ-לּמּנּסּףּפּצּ-ﭏ"},{name:"Hiragana",bmp:"ぁ-ゖゝ-ゟ",astral:"\ud82c[\udc01-\udd1e\udd50-\udd52]|🈀"},{name:"Imperial_Aramaic",astral:"\ud802[\udc40-\udc55\udc57-\udc5f]"},{name:"Inherited",bmp:"̀-ًͯ҅҆-ٰٕ॑-॔᪰-ᫀ᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸᳹᷀-᷹᷻-᷿‌‍⃐-〪⃰-゙゚〭︀-️︠-︭",astral:"\ud800[\uddfd\udee0]|𑌻|\ud834[\udd67-\udd69\udd7b-\udd82\udd85-\udd8b\uddaa-\uddad]|\udb40[\udd00-\uddef]"},{name:"Inscriptional_Pahlavi",astral:"\ud802[\udf60-\udf72\udf78-\udf7f]"},{name:"Inscriptional_Parthian",astral:"\ud802[\udf40-\udf55\udf58-\udf5f]"},{name:"Javanese",bmp:"ꦀ-꧍꧐-꧙꧞꧟"},{name:"Kaithi",astral:"\ud804[\udc80-\udcc1\udccd]"},{name:"Kannada",bmp:"ಀ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲ"},{name:"Katakana",bmp:"ァ-ヺヽ-ヿㇰ-ㇿ㋐-㋾㌀-㍗ｦ-ｯｱ-ﾝ",astral:"\ud82c[\udc00\udd64-\udd67]"},{name:"Kayah_Li",bmp:"꤀-꤭꤯"},{name:"Kharoshthi",astral:"\ud802[\ude00-\ude03\ude05\ude06\ude0c-\ude13\ude15-\ude17\ude19-\ude35\ude38-\ude3a\ude3f-\ude48\ude50-\ude58]"},{name:"Khitan_Small_Script",astral:"𖿤|\ud822[\udf00-\udfff]|\ud823[\udc00-\udcd5]"},{name:"Khmer",bmp:"ក-៝០-៩៰-៹᧠-᧿"},{name:"Khojki",astral:"\ud804[\ude00-\ude11\ude13-\ude3e]"},{name:"Khudawadi",astral:"\ud804[\udeb0-\udeea\udef0-\udef9]"},{name:"Lao",bmp:"ກຂຄຆ-ຊຌ-ຣລວ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟ"},{name:"Latin",bmp:"A-Za-zªºÀ-ÖØ-öø-ʸˠ-ˤᴀ-ᴥᴬ-ᵜᵢ-ᵥᵫ-ᵷᵹ-ᶾḀ-ỿⁱⁿₐ-ₜKÅℲⅎⅠ-ↈⱠ-ⱿꜢ-ꞇꞋ-ꞿꟂ-ꟊꟵ-ꟿꬰ-ꭚꭜ-ꭤꭦ-ꭩﬀ-ﬆＡ-Ｚａ-ｚ"},{name:"Lepcha",bmp:"ᰀ-᰷᰻-᱉ᱍ-ᱏ"},{name:"Limbu",bmp:"ᤀ-ᤞᤠ-ᤫᤰ-᤻᥀᥄-᥏"},{name:"Linear_A",astral:"\ud801[\ude00-\udf36\udf40-\udf55\udf60-\udf67]"},{name:"Linear_B",astral:"\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa]"},{name:"Lisu",bmp:"ꓐ-꓿",astral:"𑾰"},{name:"Lycian",astral:"\ud800[\ude80-\ude9c]"},{name:"Lydian",astral:"\ud802[\udd20-\udd39\udd3f]"},{name:"Mahajani",astral:"\ud804[\udd50-\udd76]"},{name:"Makasar",astral:"\ud807[\udee0-\udef8]"},{name:"Malayalam",bmp:"ഀ-ഌഎ-ഐഒ-ൄെ-ൈൊ-൏ൔ-ൣ൦-ൿ"},{name:"Mandaic",bmp:"ࡀ-࡛࡞"},{name:"Manichaean",astral:"\ud802[\udec0-\udee6\udeeb-\udef6]"},{name:"Marchen",astral:"\ud807[\udc70-\udc8f\udc92-\udca7\udca9-\udcb6]"},{name:"Masaram_Gondi",astral:"\ud807[\udd00-\udd06\udd08\udd09\udd0b-\udd36\udd3a\udd3c\udd3d\udd3f-\udd47\udd50-\udd59]"},{name:"Medefaidrin",astral:"\ud81b[\ude40-\ude9a]"},{name:"Meetei_Mayek",bmp:"ꫠ-꫶ꯀ-꯭꯰-꯹"},{name:"Mende_Kikakui",astral:"\ud83a[\udc00-\udcc4\udcc7-\udcd6]"},{name:"Meroitic_Cursive",astral:"\ud802[\udda0-\uddb7\uddbc-\uddcf\uddd2-\uddff]"},{name:"Meroitic_Hieroglyphs",astral:"\ud802[\udd80-\udd9f]"},{name:"Miao",astral:"\ud81b[\udf00-\udf4a\udf4f-\udf87\udf8f-\udf9f]"},{name:"Modi",astral:"\ud805[\ude00-\ude44\ude50-\ude59]"},{name:"Mongolian",bmp:"᠀᠁᠄᠆-᠎᠐-᠙ᠠ-ᡸᢀ-ᢪ",astral:"\ud805[\ude60-\ude6c]"},{name:"Mro",astral:"\ud81a[\ude40-\ude5e\ude60-\ude69\ude6e\ude6f]"},{name:"Multani",astral:"\ud804[\ude80-\ude86\ude88\ude8a-\ude8d\ude8f-\ude9d\ude9f-\udea9]"},{name:"Myanmar",bmp:"က-႟ꧠ-ꧾꩠ-ꩿ"},{name:"Nabataean",astral:"\ud802[\udc80-\udc9e\udca7-\udcaf]"},{name:"Nandinagari",astral:"\ud806[\udda0-\udda7\uddaa-\uddd7\uddda-\udde4]"},{name:"New_Tai_Lue",bmp:"ᦀ-ᦫᦰ-ᧉ᧐-᧚᧞᧟"},{name:"Newa",astral:"\ud805[\udc00-\udc5b\udc5d-\udc61]"},{name:"Nko",bmp:"߀-ߺ߽-߿"},{name:"Nushu",astral:"𖿡|\ud82c[\udd70-\udefb]"},{name:"Nyiakeng_Puachue_Hmong",astral:"\ud838[\udd00-\udd2c\udd30-\udd3d\udd40-\udd49\udd4e\udd4f]"},{name:"Ogham",bmp:" -᚜"},{name:"Ol_Chiki",bmp:"᱐-᱿"},{name:"Old_Hungarian",astral:"\ud803[\udc80-\udcb2\udcc0-\udcf2\udcfa-\udcff]"},{name:"Old_Italic",astral:"\ud800[\udf00-\udf23\udf2d-\udf2f]"},{name:"Old_North_Arabian",astral:"\ud802[\ude80-\ude9f]"},{name:"Old_Permic",astral:"\ud800[\udf50-\udf7a]"},{name:"Old_Persian",astral:"\ud800[\udfa0-\udfc3\udfc8-\udfd5]"},{name:"Old_Sogdian",astral:"\ud803[\udf00-\udf27]"},{name:"Old_South_Arabian",astral:"\ud802[\ude60-\ude7f]"},{name:"Old_Turkic",astral:"\ud803[\udc00-\udc48]"},{name:"Oriya",bmp:"ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍୕-ୗଡ଼ଢ଼ୟ-ୣ୦-୷"},{name:"Osage",astral:"\ud801[\udcb0-\udcd3\udcd8-\udcfb]"},{name:"Osmanya",astral:"\ud801[\udc80-\udc9d\udca0-\udca9]"},{name:"Pahawh_Hmong",astral:"\ud81a[\udf00-\udf45\udf50-\udf59\udf5b-\udf61\udf63-\udf77\udf7d-\udf8f]"},{name:"Palmyrene",astral:"\ud802[\udc60-\udc7f]"},{name:"Pau_Cin_Hau",astral:"\ud806[\udec0-\udef8]"},{name:"Phags_Pa",bmp:"ꡀ-꡷"},{name:"Phoenician",astral:"\ud802[\udd00-\udd1b\udd1f]"},{name:"Psalter_Pahlavi",astral:"\ud802[\udf80-\udf91\udf99-\udf9c\udfa9-\udfaf]"},{name:"Rejang",bmp:"ꤰ-꥓꥟"},{name:"Runic",bmp:"ᚠ-ᛪᛮ-ᛸ"},{name:"Samaritan",bmp:"ࠀ-࠭࠰-࠾"},{name:"Saurashtra",bmp:"ꢀ-ꣅ꣎-꣙"},{name:"Sharada",astral:"\ud804[\udd80-\udddf]"},{name:"Shavian",astral:"\ud801[\udc50-\udc7f]"},{name:"Siddham",astral:"\ud805[\udd80-\uddb5\uddb8-\udddd]"},{name:"SignWriting",astral:"\ud836[\udc00-\ude8b\ude9b-\ude9f\udea1-\udeaf]"},{name:"Sinhala",bmp:"ඁ-ඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟ෦-෯ෲ-෴",astral:"\ud804[\udde1-\uddf4]"},{name:"Sogdian",astral:"\ud803[\udf30-\udf59]"},{name:"Sora_Sompeng",astral:"\ud804[\udcd0-\udce8\udcf0-\udcf9]"},{name:"Soyombo",astral:"\ud806[\ude50-\udea2]"},{name:"Sundanese",bmp:"ᮀ-ᮿ᳀-᳇"},{name:"Syloti_Nagri",bmp:"ꠀ-꠬"},{name:"Syriac",bmp:"܀-܍܏-݊ݍ-ݏࡠ-ࡪ"},{name:"Tagalog",bmp:"ᜀ-ᜌᜎ-᜔"},{name:"Tagbanwa",bmp:"ᝠ-ᝬᝮ-ᝰᝲᝳ"},{name:"Tai_Le",bmp:"ᥐ-ᥭᥰ-ᥴ"},{name:"Tai_Tham",bmp:"ᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪠-᪭"},{name:"Tai_Viet",bmp:"ꪀ-ꫂꫛ-꫟"},{name:"Takri",astral:"\ud805[\ude80-\udeb8\udec0-\udec9]"},{name:"Tamil",bmp:"ஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௺",astral:"\ud807[\udfc0-\udff1\udfff]"},{name:"Tangut",astral:"𖿠|[\ud81c-\ud820][\udc00-\udfff]|\ud821[\udc00-\udff7]|\ud822[\udc00-\udeff]|\ud823[\udd00-\udd08]"},{name:"Telugu",bmp:"ఀ-ఌఎ-ఐఒ-నప-హఽ-ౄె-ైొ-్ౕౖౘ-ౚౠ-ౣ౦-౯౷-౿"},{name:"Thaana",bmp:"ހ-ޱ"},{name:"Thai",bmp:"ก-ฺเ-๛"},{name:"Tibetan",bmp:"ༀ-ཇཉ-ཬཱ-ྗྙ-ྼ྾-࿌࿎-࿔࿙࿚"},{name:"Tifinagh",bmp:"ⴰ-ⵧⵯ⵰⵿"},{name:"Tirhuta",astral:"\ud805[\udc80-\udcc7\udcd0-\udcd9]"},{name:"Ugaritic",astral:"\ud800[\udf80-\udf9d\udf9f]"},{name:"Vai",bmp:"ꔀ-ꘫ"},{name:"Wancho",astral:"\ud838[\udec0-\udef9\udeff]"},{name:"Warang_Citi",astral:"\ud806[\udca0-\udcf2\udcff]"},{name:"Yezidi",astral:"\ud803[\ude80-\udea9\udeab-\udead\udeb0\udeb1]"},{name:"Yi",bmp:"ꀀ-ꒌ꒐-꓆"},{name:"Zanabazar_Square",astral:"\ud806[\ude00-\ude47]"}],sD=jc((function(t,e){eC(e,"__esModule",{value:!0}),e.default=void 0;var i=dx(oD);
/*!
     * XRegExp Unicode Scripts 4.4.0
     * <xregexp.com>
     * Steven Levithan (c) 2010-present MIT License
     * Unicode data by Mathias Bynens <mathiasbynens.be>
     */e.default=function(t){if(!t.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Scripts");t.addUnicodeData(i.default)},t.exports=e.default}));Uc(sD);var aD=Uc(jc((function(t,e){eC(e,"__esModule",{value:!0}),e.default=void 0;var i=dx(LS),n=dx(WS),r=dx(JS),o=dx(ZS),s=dx(tD),a=dx(iD),l=dx(rD),u=dx(sD);(0,n.default)(i.default),(0,r.default)(i.default),(0,o.default)(i.default),(0,s.default)(i.default),(0,a.default)(i.default),(0,l.default)(i.default),(0,u.default)(i.default);var c=i.default;e.default=c,t.exports=e.default})));!function(t){function e(e,i){var n,r,o;if(i=i||"",e=e.replace(/^\(\?([\w$]+)\)/,(function(t,e){return i+=e,""})),!(n=/^\(\?<([=!])/.exec(e)))throw new Error("lookbehind not at start of pattern");return r=t.matchRecursive(e,/\((?:[^()[\\]|\\.|\[(?:[^\\\]]|\\.)*])*/.source,"\\)","s",{valueNames:[null,null,null,"right"],escapeChar:"\\"})[0].end,o=e.slice("(?<=".length,r-1),{lb:t("(?:"+o+")$(?!\\s)",i.replace(/[gy]/g,"")),lbType:"="===n[1],main:t(e.slice(("(?<=)"+o).length),i)}}t.execLb=function(i,n,r){for(var o,s,a=0,l=e(n,r);o=t.exec(i,l.main,a);){if(s=i.slice(0,o.index),l.lbType===l.lb.test(s))return o;a=o.index+1}return null},t.testLb=function(e,i,n){return!!t.execLb(e,i,n)},t.searchLb=function(e,i,n){var r=t.execLb(e,i,n);return r?r.index:-1},t.matchAllLb=function(i,n,r){for(var o,s,a=[],l=0,u=e(n,r);o=t.exec(i,u.main,l);)s=i.slice(0,o.index),u.lbType===u.lb.test(s)?(a.push(o[0]),l=o.index+(o[0].length||1)):l=o.index+1;return a},t.replaceLb=function(i,n,r,o){for(var s,a,l="",u=0,c=0,h=e(n,o);s=t.exec(i,h.main,u);)if(a=i.slice(0,s.index),h.lbType===h.lb.test(a)){if(l+=i.slice(c,s.index)+t.replace(s[0],h.main,r),c=s.index+s[0].length,!h.main.global)break;u=s.index+(s[0].length||1)}else u=s.index+1;return l+i.slice(c)}}(aD);var lD=aD,uD={},cD=function(){try{return new RegExp("(?<=)"),!0}catch(t){return!1}}(),hD=function(t){function e(e,i){var n,r=t.call(this)||this;if(r._flags="",r._useFallback=!1,r._dotall=!1,r._extended=!1,r._captureNames=[],void 0===e)e=n="";else if(r.sec.AXRegExp.axIsType(e))i&&r.sec.throwError("TypeError",db.RegExpFlagsArgumentError),i=e._flags,n=e.source,e=e.value;else{if(n=(e=String(e)).replace(/(^|^[/]|(?:\\\\)+)\//g,"$1\\/"),i){var o=i;i="";for(var s=0;s<o.length;s++){var a=o[s];switch(a){case"s":r._dotall=!0;break;case"x":r._extended=!0;break;case"g":case"i":case"m":i+=a}}}r._flags=i,e=r._parse(n)}try{r.value=new RegExp(e,i)}catch(t){console.log("Unsupported RegExp pattern:"+e),r._useFallback=!0}return r._source=n,r}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;Wv(t,"$BgtoString",i.ecmaToString),Wv(t,"$Bgexec",i.exec),Wv(t,"$Bgtest",i.test)},e.prototype._parse=function(t){if(t.includes("(?<=")||t.includes("(?<!")&&!this._extended)return cD?(uD.lookbehind||console.warn("[ASRegExp] Pattern include a lookbehind, we will use a native .\n",t),uD.lookbehind=!0,t):(uD.lookbehind||console.warn("[ASRegExp] Pattern include a lookbehind, we should use XRegExp polyfill for Safari.\n",t),uD.lookbehind=!0,this._useFallback=!0,t);for(var i="",n=this._captureNames,r=[],o=0,s=0;s<t.length;s++){var a=t[s];switch(a){case"(":if(i+=a,r.push(o>1?o-1:o),o=0,"?"===t[s+1])switch(t[s+2]){case":":case"=":case"!":i+="?"+t[s+2],s+=2;break;default:if(!/\(\?P<([\w$]+)>/.exec(t.substr(s)))return e.UNMATCHABLE_PATTERN;var l=RegExp.$1;"length"!==l&&n.push(l),n.indexOf(l),s+=RegExp.lastMatch.length-1}else n.push(null);if(n.length>406)return e.UNMATCHABLE_PATTERN;break;case")":if(!r.length)return e.UNMATCHABLE_PATTERN;i+=a,o=r.pop()+1;break;case"|":i+=a;break;case"\\":i+=a,/\\|c[A-Z]|x[0-9,a-z,A-Z]{2}|u[0-9,a-z,A-Z]{4}|./.exec(t.substr(s+1))&&(i+=RegExp.lastMatch,s+=RegExp.lastMatch.length),o<=1&&o++;break;case"[":if(!/\[[^\]]*\]/.exec(t.substr(s)))return e.UNMATCHABLE_PATTERN;i+=RegExp.lastMatch,s+=RegExp.lastMatch.length-1,o<=1&&o++;break;case"{":if(!/\{[^{]*?(?:,[^{]*?)?\}/.exec(t.substr(s)))return e.UNMATCHABLE_PATTERN;i+=RegExp.lastMatch,s+=RegExp.lastMatch.length-1;break;case".":this._dotall?i+="[\\s\\S]":i+=a,o<=1&&o++;break;case"?":case"*":case"+":if(!o)return e.UNMATCHABLE_PATTERN;i+=a,"?"===t[s+1]&&(s++,i+="?");break;case" ":if(this._extended)break;i+=a,o<=1&&o++;break;default:i+=a,o<=1&&o++}if(i.length>32767)return e.UNMATCHABLE_PATTERN}return r.length?e.UNMATCHABLE_PATTERN:i},e.prototype.ecmaToString=function(){var t="/"+this._source+"/";return this.value.global&&(t+="g"),this.value.ignoreCase&&(t+="i"),this.value.multiline&&(t+="m"),this._dotall&&(t+="s"),this._extended&&(t+="x"),t},e.prototype.axCall=function(t){return this.exec.apply(this,arguments)},e.prototype.axApply=function(t,e){return this.exec.apply(this,e)},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"global",{get:function(){return this.value.global},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignoreCase",{get:function(){return this.value.ignoreCase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiline",{get:function(){return this.value.multiline},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastIndex",{get:function(){return this.value.lastIndex},set:function(t){this.value.lastIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dotall",{get:function(){return this._dotall},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extended",{get:function(){return this._extended},enumerable:!0,configurable:!0}),e.prototype.internalStringSearch=function(t){return this._useFallback?lD.searchLb(t,this._source,this._flags):t.search(this.value)},e.prototype.internalStringReplace=function(t,e){return this._useFallback?lD.replaceLb(t,this._source,e,this._flags):t.replace(this.value,e)},e.prototype.internalStringMatch=function(t){if(!this._useFallback)return t.match(this.value);var e=lD.matchAllLb(t,this._source,this._flags);if(e.length>0){var i=[e[0]];return i.index=0,i.input=t,i}return null},e.prototype.exec=function(t){var e;if(void 0===t&&(t=""),!(e=this._useFallback?lD.execLb(t,this._source,this._flags):this.value.exec(t)))return null;var i=$b(this.sec,e),n=this._captureNames;if(n){for(var r=0;r<n.length;r++){var o=n[r];if(null!==o){var s=e[r+1]||"";e[o]=s,i.axSetPublicProperty(o,s)}}return i}},e.prototype.test=function(t){return void 0===t&&(t=""),null!==this.exec(t)},e.UNMATCHABLE_PATTERN="^(?!)$",e}(bb);function pD(t,e,i){if("object"!=typeof e)return e;if(mo(e))return e;if(Array.isArray(e)){for(var n=[],r=0;r<e.length;r++){var o=e[r],s=i?pD(t,o,!0):o;n.push(s)}return t.createArray(n)}return t.createObjectFromJS(e,i)}function dD(t,e,i,n,r){if(void 0===n&&(n=null),void 0===r&&(r=null),n&&(e=n(r,e)),"object"!=typeof e||mo(e))return e;if(mo(e))return e;if(t.AXArray.axIsType(e)){for(var o=[],s=Array.isArray(e)?e:e.value,a=0;a<s.length;a++){var l=s[a],u=i?dD(t,l,!0,n,a.toString()):l;o.push(u)}return o}if(t.ObjectVector.axClass.axIsType(e)){for(o=[],s=e._buffer,a=0;a<s.length;a++){l=s[a],u=i?dD(t,l,!0,n,a.toString()):l;o.push(u)}return o}var c=Object.keys(e),h={};for(a=0;a<c.length;a++){var p=c[a];if("__scope__"!=p){var d=p;zh(p)||(d=p.substr(3));var f=e[p];i&&(f=dD(t,f,!0,n,d)),h[d]=f}}return h}var fD=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.parse=function(t,e){var i;void 0===e&&(e=null),t=Yv(t),null===e||rx(e)||this.sec.throwError("TypeError",db.CheckTypeFailedError,e,"Function"),null===t&&this.sec.throwError("SyntaxError",db.JSONInvalidParseInput);try{i=pD(this.sec,JSON.parse(t),!0)}catch(t){this.sec.throwError("SyntaxError",db.JSONInvalidParseInput)}return null===e?i:function t(e,i,n,r){var o=i[n];if(Array.isArray(o))for(var s=o,a=0,l=s.length;a<l;a++){void 0===(c=t(e,s,Yv(a),r))?delete s[a]:s[a]=c}else if(null!==o&&"boolean"!=typeof o&&"number"!=typeof o&&"string"!=typeof o)for(var u in o){if(!o.hasOwnProperty(u)||!Kv.isPublicQualifiedName(u))break;var c;void 0===(c=t(e,o,u,r))?delete o[u]:o[u]=c}return r.call(i,n,o)}(this.sec,{"":i},"",e.value)},e.stringify=function(t,e,i){var n;void 0===e&&(e=null),void 0===i&&(i=null);var r,o="object"==typeof e?null===(n=e)||void 0===n?void 0:n.sec:null;return null!==e&&(o&&(o.AXFunction.axIsType(e)||o.AXArray.axIsType(e))||this.sec.throwError("TypeError",db.JSONInvalidReplacer)),r="string"==typeof i?i.length>10?i.substring(0,10):i:"number"==typeof i?"          ".substring(0,Math.min(10,0|i)):"",null===e?this.stringifySpecializedToString(t,null,null,r):o.AXArray.axIsType(e)?this.stringifySpecializedToString(t,this.computePropertyList(e.value),null,r):this.stringifySpecializedToString(t,null,e.value,r)},e.computePropertyList=function(t){for(var e=[],i=Object.create(null),n=0,r=t.length;n<r;n++)if(t.hasOwnProperty(n)){var o=t[n],s=null;"string"==typeof o?s=o:"number"==typeof o&&(s=Yv(o)),null===s||i[s]||(i[s]=!0,e.push(s))}return e},e.stringifySpecializedToString=function(t,e,i,n){if(void 0===t)return"null";var r=dD(this.sec,t,!0,i);try{return JSON.stringify(r,null,n)}catch(t){this.sec.throwError("TypeError",db.JSONCyclicStructure)}},e}(bb);function _D(){return 0===Cb.length?null:Cb[Cb.length-1].topScope().global.object.scriptInfo.abc}function mD(t,e,i){null==e&&t.throwError("TypeError",db.NullPointerError,"request"),t.flash.net.URLRequest.axClass.axIsType(e)||t.throwError("TypeError",db.CheckTypeFailedError,e,"flash.net.URLRequest");var n=e.url;(mo(n)&&t.throwError("TypeError",db.NullPointerError,"url"),0!==n.toLowerCase().indexOf("fscommand:"))?window.open(e.url,"_blank"):(0,t.flash.system.fscommand.value)(t,n.substring("fscommand:".length),i)}function gD(t){return function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return t.apply(vh,i)}}var yD=gf.createMap(),AD=function(t){function e(e,i,n,r,o,s,a){void 0===n&&(n=1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0);var l=t.call(this)||this;switch(arguments.length){case 0:l.value=new Date;break;case 1:l.value=new Date(e);break;case 2:l.value=new Date(e,i);break;case 3:l.value=new Date(e,i,n);break;case 4:l.value=new Date(e,i,n,r);break;case 5:l.value=new Date(e,i,n,r,o);break;case 6:l.value=new Date(e,i,n,r,o,s);break;default:l.value=new Date(e,i,n,r,o,s,a)}return l}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;Wv(t,"$BgtoString",i.toString),Wv(t,"$BgtoLocaleString",i.toString),Wv(t,"$BgvalueOf",i.valueOf),Wv(t,"$BgtoDateString",i.toDateString),Wv(t,"$BgtoTimeString",i.toTimeString),Wv(t,"$BgtoLocaleString",i.toLocaleString),Wv(t,"$BgtoLocaleDateString",i.toLocaleDateString),Wv(t,"$BgtoLocaleTimeString",i.toLocaleTimeString),Wv(t,"$BgtoUTCString",i.toUTCString),Wv(t,"$BgtoJSON",i.toJSON),Wv(t,"$BggetUTCFullYear",i.getUTCFullYear),Wv(t,"$BggetUTCMonth",i.getUTCMonth),Wv(t,"$BggetUTCDate",i.getUTCDate),Wv(t,"$BggetUTCDay",i.getUTCDay),Wv(t,"$BggetUTCHours",i.getUTCHours),Wv(t,"$BggetUTCMinutes",i.getUTCMinutes),Wv(t,"$BggetUTCSeconds",i.getUTCSeconds),Wv(t,"$BggetUTCMilliseconds",i.getUTCMilliseconds),Wv(t,"$BggetFullYear",i.getFullYear),Wv(t,"$BggetMonth",i.getMonth),Wv(t,"$BggetDate",i.getDate),Wv(t,"$BggetDay",i.getDay),Wv(t,"$BggetHours",i.getHours),Wv(t,"$BggetMinutes",i.getMinutes),Wv(t,"$BggetSeconds",i.getSeconds),Wv(t,"$BggetMilliseconds",i.getMilliseconds),Wv(t,"$BggetTimezoneOffset",i.getTimezoneOffset),Wv(t,"$BggetTime",i.getTime),Wv(t,"$BgsetFullYear",i.setFullYear),Wv(t,"$BgsetMonth",i.setMonth),Wv(t,"$BgsetDate",i.setDate),Wv(t,"$BgsetHours",t.setHours),Wv(t,"$BgsetMinutes",i.setMinutes),Wv(t,"$BgsetSeconds",i.setSeconds),Wv(t,"$BgsetMilliseconds",i.setMilliseconds),Wv(t,"$BgsetUTCFullYear",i.setUTCFullYear),Wv(t,"$BgsetUTCMonth",i.setUTCMonth),Wv(t,"$BgsetUTCDate",i.setUTCDate),Wv(t,"$BgsetUTCHours",i.setUTCHours),Wv(t,"$BgsetUTCMinutes",i.setUTCMinutes),Wv(t,"$BgsetUTCSeconds",i.setUTCSeconds),Wv(t,"$BgsetUTCMilliseconds",i.setUTCMilliseconds)},e.parse=function(t){return Date.parse(t)},e.UTC=function(t,e,i,n,r,o,s){return void 0===i&&(i=1),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),Date.parse.apply(null,arguments)},e.axCoerce=function(t){return this.axConstruct([t])},e.prototype.toString=function(){if(!(this.value instanceof Date))return"Invalid Date";var t=this.value.toString().split(" ");return t.length<4?"Invalid Date":(t.length=6,t.push(t.splice(3,1)[0]),"0"===t[2][0]&&(t[2]=t[2][1]),t.join(" "))},e.prototype.toDateString=function(){if(!(this.value instanceof Date))return"Invalid Date";var t=this.value.toDateString().split(" ");return t.length<4?"Invalid Date":("0"===t[2][0]&&(t[2]=t[2][1]),t.join(" "))},e.prototype.toJSON=function(){return this.value instanceof Date?this.value.toString():"Invalid Date"},e.prototype.valueOf=function(){return this.value instanceof Date?this.value.valueOf():NaN},e.prototype.setTime=function(t){return void 0===t&&(t=0),this.value instanceof Date?this.value.setTime(t):NaN},e.prototype.toTimeString=function(){return this.value instanceof Date?this.value.toTimeString():"Invalid Date"},e.prototype.toLocaleString=function(){return this.value instanceof Date?this.value.toLocaleString():"Invalid Date"},e.prototype.toLocaleDateString=function(){return this.value instanceof Date?this.value.toLocaleDateString():"Invalid Date"},e.prototype.toLocaleTimeString=function(){return this.value instanceof Date?this.value.toLocaleTimeString():"Invalid Date"},e.prototype.toUTCString=function(){return this.value instanceof Date?this.value.toUTCString():"Invalid Date"},e.prototype.getUTCFullYear=function(){return this.value instanceof Date?this.value.getUTCFullYear():NaN},e.prototype.getUTCMonth=function(){return this.value instanceof Date?this.value.getUTCMonth():NaN},e.prototype.getUTCDate=function(){return this.value instanceof Date?this.value.getUTCDate():NaN},e.prototype.getUTCDay=function(){return this.value instanceof Date?this.value.getUTCDay():NaN},e.prototype.getUTCHours=function(){return this.value instanceof Date?this.value.getUTCHours():NaN},e.prototype.getUTCMinutes=function(){return this.value instanceof Date?this.value.getUTCMinutes():NaN},e.prototype.getUTCSeconds=function(){return this.value instanceof Date?this.value.getUTCSeconds():NaN},e.prototype.getUTCMilliseconds=function(){return this.value instanceof Date?this.value.getUTCMilliseconds():NaN},e.prototype.getFullYear=function(){return this.value instanceof Date?this.value.getFullYear():NaN},e.prototype.getMonth=function(){return this.value instanceof Date?this.value.getMonth():NaN},e.prototype.getDate=function(){return this.value instanceof Date?this.value.getDate():NaN},e.prototype.getDay=function(){return this.value instanceof Date?this.value.getDay():NaN},e.prototype.getHours=function(){return this.value instanceof Date?this.value.getHours():NaN},e.prototype.getMinutes=function(){return this.value instanceof Date?this.value.getMinutes():NaN},e.prototype.getSeconds=function(){return this.value instanceof Date?this.value.getSeconds():NaN},e.prototype.getMilliseconds=function(){return this.value instanceof Date?this.value.getMilliseconds():NaN},e.prototype.getTimezoneOffset=function(){return this.value instanceof Date?this.value.getTimezoneOffset():NaN},e.prototype.getTime=function(){return this.value instanceof Date?this.value.getTime():NaN},e.prototype.setFullYear=function(t,e,i){return this.value instanceof Date?this.value.setFullYear.apply(this.value,arguments):NaN},e.prototype.setMonth=function(t,e){return this.value instanceof Date?this.value.setMonth.apply(this.value,arguments):NaN},e.prototype.setDate=function(t){return this.value instanceof Date?this.value.setDate.apply(this.value,arguments):NaN},e.prototype.setHours=function(t,e,i,n){return this.value instanceof Date?this.value.setHours.apply(this.value,arguments):NaN},e.prototype.setMinutes=function(t,e,i){return this.value instanceof Date?this.value.setMinutes.apply(this.value,arguments):NaN},e.prototype.setSeconds=function(t,e){return this.value instanceof Date?this.value.setSeconds.apply(this.value,arguments):NaN},e.prototype.setMilliseconds=function(t){return this.value instanceof Date?this.value.setMilliseconds.apply(this.value,arguments):NaN},e.prototype.setUTCFullYear=function(t,e,i){return this.value instanceof Date?this.value.setUTCFullYear.apply(this.value,arguments):NaN},e.prototype.setUTCMonth=function(t,e){return this.value instanceof Date?this.value.setUTCMonth.apply(this.value,arguments):NaN},e.prototype.setUTCDate=function(t){return this.value instanceof Date?this.value.setUTCDate.apply(this.value,arguments):NaN},e.prototype.setUTCHours=function(t,e,i,n){return this.value instanceof Date?this.value.setUTCHours.apply(this.value,arguments):NaN},e.prototype.setUTCMinutes=function(t,e,i){return this.value instanceof Date?this.value.setUTCMinutes.apply(this.value,arguments):NaN},e.prototype.setUTCSeconds=function(t,e){return this.value instanceof Date?this.value.setUTCSeconds.apply(this.value,arguments):NaN},e.prototype.setUTCMilliseconds=function(t){return this.value instanceof Date?this.value.setUTCMilliseconds.apply(this.value,arguments):NaN},Object.defineProperty(e.prototype,"fullYear",{get:function(){return this.value.getFullYear()},set:function(t){this.value.setFullYear(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"month",{get:function(){return this.value.getMonth()},set:function(t){this.value.setMonth(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"date",{get:function(){return this.value.getDate()},set:function(t){this.value.setDate(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hours",{get:function(){return this.value.getHours()},set:function(t){this.value.setHours(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minutes",{get:function(){return this.value.getMinutes()},set:function(t){this.value.setMinutes(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seconds",{get:function(){return this.value.getSeconds()},set:function(t){this.value.setSeconds(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"milliseconds",{get:function(){return this.value.getMilliseconds()},set:function(t){this.value.setMilliseconds(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullYearUTC",{get:function(){return this.value.getUTCFullYear()},set:function(t){this.value.setUTCFullYear(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"monthUTC",{get:function(){return this.value.getUTCMonth()},set:function(t){this.value.setUTCMonth(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateUTC",{get:function(){return this.value.getUTCDate()},set:function(t){this.value.setUTCDate(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hoursUTC",{get:function(){return this.value.getUTCHours()},set:function(t){this.value.setUTCHours(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minutesUTC",{get:function(){return this.value.getUTCMinutes()},set:function(t){this.value.setUTCMinutes(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondsUTC",{get:function(){return this.value.getUTCSeconds()},set:function(t){this.value.setUTCSeconds(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"millisecondsUTC",{get:function(){return this.value.getUTCMilliseconds()},set:function(t){this.value.setUTCMilliseconds(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return this.value.getTime()},set:function(t){this.value.setTime(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timezoneOffset",{get:function(){return this.value.getTimezoneOffset()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"day",{get:function(){return this.value.getDay()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dayUTC",{get:function(){return this.value.getUTCDay()},enumerable:!0,configurable:!0}),e}(bb),vD="$"+Xv(0,"http://www.adobe.com/2006/actionscript/flash/proxy").mangledName,bD=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.classInitializer=function(){var t=this.dPrototype,i=e.prototype;mf(t,vD+"getProperty",i.native_getProperty),mf(t,vD+"setProperty",i.native_setProperty),mf(t,vD+"callProperty",i.native_callProperty),mf(t,vD+"hasProperty",i.native_hasProperty),mf(t,vD+"deleteProperty",i.native_deleteProperty),mf(t,vD+"getDescendants",i.native_getDescendants),mf(t,vD+"nextNameIndex",i.native_nextNameIndex),mf(t,vD+"nextName",i.native_nextName),mf(t,vD+"nextValue",i.native_nextValue)},e.prototype.native_getProperty=function(){this.sec.throwError("flash.errors.IllegalOperationError",db.ProxyGetPropertyError)},e.prototype.native_setProperty=function(){this.sec.throwError("flash.errors.IllegalOperationError",db.ProxySetPropertyError)},e.prototype.native_callProperty=function(){this.sec.throwError("flash.errors.IllegalOperationError",db.ProxyCallPropertyError)},e.prototype.native_hasProperty=function(){this.sec.throwError("flash.errors.IllegalOperationError",db.ProxyHasPropertyError)},e.prototype.native_deleteProperty=function(){this.sec.throwError("flash.errors.IllegalOperationError",db.ProxyDeletePropertyError)},e.prototype.native_getDescendants=function(){this.sec.throwError("flash.errors.IllegalOperationError",db.ProxyGetDescendantsError)},e.prototype.native_nextNameIndex=function(){this!==this.axClass.dPrototype&&this.sec.throwError("flash.errors.IllegalOperationError",db.ProxyNextNameIndexError)},e.prototype.native_nextName=function(){this.sec.throwError("flash.errors.IllegalOperationError",db.ProxyNextNameError)},e.prototype.native_nextValue=function(){this.sec.throwError("flash.errors.IllegalOperationError",db.ProxyNextValueError)},e.prototype.axGetProperty=function(t){var e,i="string"==typeof t.name?this.traits.getTrait(t.namespaces,t.name):null;if(i){var n=i.name.getMangledName();if("function"==typeof(e=this[n]))return this.axGetMethod(n)}else e=this[vD+"getProperty"](this.sec.AXQName.FromMultiname(t));return e},e.prototype.axGetNumericProperty=function(t){return this[vD+"getProperty"](+t+"")},e.prototype.axSetNumericProperty=function(t,e){this[vD+"setProperty"](+t+"",e)},e.prototype.axSetProperty=function(e,i,n){("string"==typeof e.name?this.traits.getTrait(e.namespaces,e.name):null)?t.prototype.axSetProperty.call(this,e,i,n):this[vD+"setProperty"](this.sec.AXQName.FromMultiname(e),i)},e.prototype.axCallProperty=function(e,i,n){if("string"==typeof e.name?this.traits.getTrait(e.namespaces,e.name):null)return t.prototype.axCallProperty.call(this,e,i,n);var r=[this.sec.AXQName.FromMultiname(e)].concat(i);return this[vD+"callProperty"].apply(this,r)},e.prototype.axHasProperty=function(t){return this.axHasOwnProperty(t)},e.prototype.axHasPublicProperty=function(t){return xD.name=t,!!this.axHasPropertyInternal(xD)||this[vD+"hasProperty"](t)},e.prototype.axHasOwnProperty=function(t){return!!("string"==typeof t.name?this.traits.getTrait(t.namespaces,t.name):null)||this[vD+"hasProperty"](this.sec.AXQName.FromMultiname(t))},e.prototype.axDeleteProperty=function(t){var e="string"==typeof t.name?this.traits.getTrait(t.namespaces,t.name):null;return e?delete this[e.name.getMangledName()]:this[vD+"deleteProperty"](this.sec.AXQName.FromMultiname(t))},e.prototype.axNextName=function(t){return this[vD+"nextName"](t)},e.prototype.axNextValue=function(t){return this[vD+"nextValue"](t)},e.prototype.axNextNameIndex=function(t){return this[vD+"nextNameIndex"](t)},e}(bb),xD=new Kv(null,0,17,[],null,null,!0),CD=function(t){function e(e){void 0===e&&(e=!1);var i=t.call(this)||this;return i.map=new WeakMap,i.keys=null,i.weakKeys=!!e,e||(i.keys=[]),i.primitiveMap=Object.create(null),i}return i(e,t),e.makePrimitiveKey=function(t){if("string"==typeof t||"number"==typeof t)return t},e.prototype.toJSON=function(){return"Dictionary"},e.prototype.axGetProperty=function(i){if(this===this.axClass.dPrototype)return t.prototype.axGetProperty.call(this,i);var n=e.makePrimitiveKey(i.name);return void 0!==n?this.primitiveMap[n]:this.map.get(Object(i.name))},e.prototype.axSetProperty=function(i,n,r){if(this!==this.axClass.dPrototype){var o=e.makePrimitiveKey(i.name);void 0===o?(this.map.set(Object(i.name),n),!this.weakKeys&&this.keys.indexOf(i.name)<0&&this.keys.push(i.name)):this.primitiveMap[o]=n}else t.prototype.axSetProperty.call(this,i,n,r)},e.prototype.axHasPropertyInternal=function(i){if(this===this.axClass.dPrototype)return t.prototype.axHasProperty.call(this,i);var n=e.makePrimitiveKey(i.name);return void 0!==n?n in this.primitiveMap:this.map.has(Object(i.name))},e.prototype.axDeleteProperty=function(i){if(this===this.axClass.dPrototype)return t.prototype.axDeleteProperty.call(this,i);var n,r=e.makePrimitiveKey(i.name);return void 0!==r&&delete this.primitiveMap[r],this.map.delete(Object(i.name)),!this.weakKeys&&(n=this.keys.indexOf(i.name))>=0&&this.keys.splice(n,1),!0},e.prototype.axGetPublicProperty=function(i){if(this===this.axClass.dPrototype)return t.prototype.axGetPublicProperty.call(this,i);var n=e.makePrimitiveKey(i);return void 0!==n?this.primitiveMap[n]:this.map.get(Object(i))},e.prototype.axGetEnumerableKeys=function(){if(this===this.axClass.dPrototype)return t.prototype.axGetEnumerableKeys.call(this);var e=[];for(var i in this.primitiveMap)e.push(i);return this.weakKeys?e:this.keys?e.concat(this.keys):e.slice()},e.classInitializer=function(){Wv(this.dPrototype,"$BgtoJSON",e.prototype.toJSON)},e}(bb);function wD(t,e,i){for(var n=t.axGetEnumerableKeys(),r=0;r<n.length;r++){var o=n[r],s=t.axGetPublicProperty(o);e.call(i,o,s)}}var ID=function(){this.strings=[],this.objects=[],this.traits=[],this.traitNames=[]},ED=function(){function t(){this._classMap=new WeakMap,this._nameMap=Object.create(null)}return t.prototype.getAliasByClass=function(t){return this._classMap.get(t)},t.prototype.getClassByAlias=function(t){return this._nameMap[t]},t.prototype.registerClassAlias=function(t,e){this._classMap.set(e,t),this._nameMap[t]=e},t}();function SD(t,e){if(e.length>65535)throw"AMF short string exceeded";if(!e.length)return t.writeByte(0),void t.writeByte(0);var i=Mh.utf8decode(e);t.writeByte(i.length>>8&255),t.writeByte(255&i.length);for(var n=0;n<i.length;n++)t.writeByte(i[n])}function DD(t){var e=t.readByte()<<8|t.readByte();if(!e)return"";for(var i=new Uint8Array(e),n=0;n<e;n++)i[n]=t.readByte();return Mh.utf8encode(i)}function TD(t,e){var i=new ArrayBuffer(8),n=new DataView(i);n.setFloat64(0,e,!1);for(var r=0;r<i.byteLength;r++)t.writeByte(n.getUint8(r))}function PD(t){for(var e=new ArrayBuffer(8),i=new DataView(e),n=0;n<e.byteLength;n++)i.setUint8(n,t.readByte());return i.getFloat64(0,!1)}var BD=function(){function t(){}return t.write=function(t,e){switch(typeof e){case"boolean":t.writeByte(1),t.writeByte(e?1:0);break;case"number":t.writeByte(0),TD(t,e);break;case"undefined":t.writeByte(6);break;case"string":t.writeByte(2),SD(t,e);break;case"object":var i=e;if(null===i)t.writeByte(5);else if(t.sec.AXArray.axIsType(i)){var n=i.value;t.writeByte(8),t.writeByte(n.length>>>24&255),t.writeByte(n.length>>16&255),t.writeByte(n.length>>8&255),t.writeByte(255&n.length),wD(i,(function(e,i){SD(t,e),this.write(t,i)}),this),t.writeByte(0),t.writeByte(0),t.writeByte(9)}else t.writeByte(3),wD(i,(function(e,i){SD(t,e),this.write(t,i)}),this),t.writeByte(0),t.writeByte(0),t.writeByte(9);return}},t.read=function(t){var e=t.readByte();switch(e){case 0:return PD(t);case 1:return!!t.readByte();case 2:return DD(t);case 3:for(var i=t.sec.createObject();;){if(!(n=DD(t)).length)break;i.axSetPublicProperty(n,this.read(t))}if(9!==t.readByte())throw"AMF0 End marker is not found";return i;case 5:return null;case 6:return;case 8:for((r=t.sec.createArray([])).length=t.readByte()<<24|t.readByte()<<16|t.readByte()<<8|t.readByte();;){var n;if(!(n=DD(t)).length)break;r.axSetPublicProperty(n,this.read(t))}if(9!==t.readByte())throw"AMF0 End marker is not found";return r;case 10:for(var r,o=(r=t.sec.createArray([])).length=t.readByte()<<24|t.readByte()<<16|t.readByte()<<8|t.readByte(),s=0;s<o;s++)r.axSetPublicProperty(s,this.read(t));return r;case 17:return ND(t,new ID);default:throw"AMF0 Unknown marker "+e}},t}();function MD(t){var e=t.readByte();if(0==(128&e))return e;var i=t.readByte();if(0==(128&i))return(127&e)<<7|i;var n=t.readByte();if(0==(128&n))return(127&e)<<14|(127&i)<<7|n;var r=(127&e)<<22|(127&i)<<15|(127&n)<<8|t.readByte();return 0!=(268435456&r)&&(r|=3758096384),r}function OD(t,e){if(e<-268435456||e>=268435456)throw"AMF3 U29 range";0==(4294967168&e)?t.writeByte(127&e):0==(4294950912&e)?(t.writeByte(128|e>>7&127),t.writeByte(127&e)):0==(4292870144&e)?(t.writeByte(128|e>>14&127),t.writeByte(128|e>>7&127),t.writeByte(127&e)):(t.writeByte(128|e>>22&127),t.writeByte(128|e>>15&127),t.writeByte(128|e>>8&127),t.writeByte(255&e))}function LD(t,e){var i=MD(t);if(1===i)return"";var n=e.strings;if(0==(1&i))return n[i>>1];for(var r=i>>1,o=new Uint8Array(r),s=0;s<r;s++)o[s]=t.readByte();var a=Mh.utf8encode(o);return n.push(a),a}function RD(t,e,i){if(""!==e){var n=i.strings,r=n.indexOf(e);if(r>=0)OD(t,r<<1);else{n.push(e);var o=Mh.utf8decode(e);OD(t,1|o.length<<1);for(var s=0;s<o.length;s++)t.writeByte(o[s])}}else t.writeByte(1)}function ND(t,e){var i=t.readByte();switch(i){case 1:return null;case 0:return;case 2:return!1;case 3:return!0;case 4:return MD(t);case 5:return PD(t);case 6:return LD(t,e);case 8:var n=MD(t);return t.sec.AXDate.axConstruct([PD(t)]);case 10:var r,o;if(0==(1&(n=MD(t))))return e.objects[n>>1];if(0!=(4&n))throw"AMF3 Traits-Ext is not supported";var s,a=!0;if(0==(2&n))o=e.traits[n>>2],s=e.traitNames[n>>2];else{var l=LD(t,e);l&&(o=r=t.sec.classAliases.getClassByAlias(l)),a=0!=(8&n),s=[];for(var u=0,c=n>>4;u<c;u++)s.push(LD(t,e));e.traits.push(o),e.traitNames.push(s)}var h=r?r.axConstruct([]):t.sec.createObject();e.objects.push(h);for(u=0;u<s.length;u++){var p=ND(t,e);h.axSetPublicProperty(s[u],p)}if(a)for(;;){if(""===(_=LD(t,e)))break;p=ND(t,e);h.axSetPublicProperty(_,p)}return h;case 9:if(0==(1&(n=MD(t))))return e.objects[n>>1];var d=t.sec.createArray([]);e.objects.push(d);for(var f=n>>1;;){var _;if(!(_=LD(t,e)).length)break;p=ND(t,e);d.axSetPublicProperty(_,p)}for(u=0;u<f;u++){p=ND(t,e);d.axSetPublicProperty(u,p)}return d;default:throw"AMF3 Unknown marker "+i}}function FD(t,e,i){var n=i.objects,r=n.indexOf(e);return r<0?(n.push(e),!1):(OD(t,r<<1),!0)}var kD,VD=function(){function t(){}return t.write=function(t,e){!function t(e,i,n){switch(typeof i){case"boolean":e.writeByte(i?3:2);break;case"number":var r=i===(0|i);r&&(i>268435455||i<-268435456)&&(r=!1),r?(e.writeByte(4),OD(e,i)):(e.writeByte(5),TD(e,i));break;case"undefined":e.writeByte(0);break;case"string":e.writeByte(6),RD(e,i,n);break;case"object":if(null===i)e.writeByte(1);else if(e.sec.AXArray.axIsType(i)){var o=i;if(e.writeByte(9),FD(e,o,n))break;for(var s=0;o.axHasPublicProperty(s);)++s;OD(e,s<<1|1),wD(o,(function(i,r){zh(i)&&i>=0&&i<s||(RD(e,i,n),t(e,r,n))})),RD(e,"",n);for(var a=0;a<s;a++)t(e,o.axGetPublicProperty(a),n)}else if(e.sec.AXDate.axIsType(i)){if(e.writeByte(8),FD(e,i,n))break;OD(e,1),TD(e,i.valueOf())}else{var l=i;if(e.writeByte(10),FD(e,l,n))break;var u=!0,c=l.axClass;if(c){var h=c.classInfo;u=!h.instanceInfo.isSealed();var p=e.sec.classAliases.getAliasByClass(c)||"",d=n.traits.indexOf(c),f=null;if(d<0){f=h.instanceInfo.runtimeTraits.getSlotPublicTraitNames(),n.traits.push(c),n.traitNames.push(f),OD(e,(u?11:3)+(f.length<<4)),RD(e,p,n);for(var _=0;_<f.length;_++)RD(e,f[_],n)}else f=n.traitNames[d],OD(e,1+(d<<2));for(_=0;_<f.length;_++)t(e,l.axGetPublicProperty(f[_]),n)}else OD(e,11),RD(e,"",n);u&&(wD(l,(function(i,r){RD(e,i,n),t(e,r,n)})),RD(e,"",n))}return}}(t,e,new ID)},t.read=function(t){return ND(t,new ID)},t}();!function(t){t[t.AMF0=0]="AMF0",t[t.AMF3=3]="AMF3",t[t.DEFAULT=3]="DEFAULT"}(kD||(kD={}));var UD=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e,"dynamicPropertyWriter",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),e.AMF0=kD.AMF0,e.AMF3=kD.AMF3,e.DEFAULT=kD.DEFAULT,e}(bb),jD=function(){},GD=function(t){function e(i){var n,r=t.call(this)||this;jD.symbolForConstructor&&(i=jD.symbolForConstructor,jD.symbolForConstructor=null);var o=0;if(i){if(i instanceof ArrayBuffer)n=i.slice(0);else if(Array.isArray(i))n=new Uint8Array(i).buffer;else if("buffer"in i)if(i.buffer instanceof ArrayBuffer)n=new Uint8Array(i.buffer).buffer;else if(i.buffer instanceof Uint8Array){var s=i.buffer.byteOffset;n=i.buffer.buffer.slice(s,s+i.buffer.length)}else n=i.buffer.slice();else hp("Source type.");o=n.byteLength}else n=new ArrayBuffer(e.INITIAL_SIZE);return r._buffer=n,r._length=o,r._position=0,r._resetViews(),r._objectEncoding=e.defaultObjectEncoding,r._littleEndian=!1,r._bitBuffer=0,r._bitLength=0,r}return i(e,t),e.classInitializer=function(){var t=vs.prototype;gf.defineNonEnumerableProperty(t,"$BgtoJSON",t.toJSON)},Object.defineProperty(e,"defaultObjectEncoding",{get:function(){return this._defaultObjectEncoding},set:function(t){t>>>=0,this._defaultObjectEncoding=t},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return"ByteArray"},e.prototype.readObject=function(){switch(this._objectEncoding){case UD.AMF0:return BD.read(this);case UD.AMF3:return VD.read(this);default:hp("Object Encoding")}},e.prototype.writeObject=function(t){switch(this._objectEncoding){case UD.AMF0:return BD.write(this,t);case UD.AMF3:return VD.write(this,t);default:hp("Object Encoding")}},e.prototype.axGetPublicProperty=function(t){return"number"==typeof t||zh(t=hb(t))?this.axGetNumericProperty(t):this["$Bg"+t]},e.prototype.axGetNumericProperty=function(t){return this.getValue(t)},e.prototype.axSetPublicProperty=function(t,e){"number"==typeof t||zh(t=hb(t))?this.axSetNumericProperty(t,e):this["$Bg"+t]=e},e.prototype.axSetNumericProperty=function(t,e){this.setValue(t,e)},e.prototype.axGetProperty=function(e){var i=e.name;return"number"==typeof i||zh(i=hb(i))?this.getValue(+i):t.prototype.axGetProperty.call(this,e)},e.prototype.axSetProperty=function(e,i,n){var r=e.name;"number"==typeof r||zh(r=hb(r))?this.setValue(+r,i):t.prototype.axSetProperty.call(this,e,i,n)},e.classNatives=[vs],e.instanceNatives=[vs.prototype],e.INITIAL_SIZE=128,e._defaultObjectEncoding=UD.DEFAULT,e}(bb),QD=(function(t){function e(){return t.call(this)||this}i(e,t),Object.defineProperty(e,"enabled",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"conversionMode",{get:function(){return"UNKNOWN"},set:function(t){},enumerable:!0,configurable:!0}),e.setCompositionString=function(t){},e.doConversion=function(){},e.compositionSelectionChanged=function(t,e){},e.compositionAbandoned=function(){},Object.defineProperty(e,"isSupported",{get:function(){return!1},enumerable:!0,configurable:!0})}(bb),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.classInitializer=function(){mf(this,"$Bgargv",this.sec.createArray([]))},Object.defineProperty(e,"ime",{get:function(){return null},enumerable:!0,configurable:!0}),e.setClipboard=function(t){t=Yv(t),null!==vf&&vf.setClipboard(t)},Object.defineProperty(e,"totalMemoryNumber",{get:function(){return 2097152},enumerable:!0,configurable:!0}),Object.defineProperty(e,"freeMemory",{get:function(){return 1048576},enumerable:!0,configurable:!0}),Object.defineProperty(e,"privateMemory",{get:function(){return 1048576},enumerable:!0,configurable:!0}),Object.defineProperty(e,"useCodePage",{get:function(){return this._useCodePage},set:function(t){this._useCodePage=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"vmVersion",{get:function(){return"1.0 Shumway - Mozilla Research"},enumerable:!0,configurable:!0}),e.pause=function(){},e.resume=function(){},e.exit=function(t){},e.gc=function(){},e.pauseForGCIfCollectionImminent=function(t){},e.disposeXML=function(t){},Object.defineProperty(e,"swfVersion",{get:function(){return 19},enumerable:!0,configurable:!0}),Object.defineProperty(e,"apiVersion",{get:function(){return 26},enumerable:!0,configurable:!0}),e.getArgv=function(){return[]},e.getRunmode=function(){return"mixed"},e._useCodePage=!1,e}(bb));function zD(){HD.Object=bb,HD.Class=xb,HD.Function=Kb,HD.Boolean=nx,HD["builtin.as$0.MethodClosure"]=Wb,HD.Number=Jb,HD.int=Zb,HD.uint=ix,HD.String=ex,HD.Array=Bb,HD["__AS3__.vec.Vector"]=ax,HD["__AS3__.vec.Vector$object"]=lx,HD["__AS3__.vec.Vector$int"]=ux,HD["__AS3__.vec.Vector$uint"]=cx,HD["__AS3__.vec.Vector$double"]=hx,HD.Namespace=yT,HD.QName=AT,HD.XML=bT,HD.XMLList=wT,HD["flash.xml.XMLNode"]=IT,HD["flash.xml.XMLDocument"]=ET,HD["flash.xml.XMLParser"]=PT,HD["flash.xml.XMLTag"]=ST,HD["flash.xml.XMLNodeType"]=DT,HD.Math=px,HD.Date=AD,HD.RegExp=hD,HD.JSON=fD,HD["flash.utils.Proxy"]=bD,HD["flash.utils.Dictionary"]=CD,HD["flash.utils.ByteArray"]=GD,HD["avmplus.System"]=QD,HD["avmplus.File"]=BT,HD.Error=Mb,HD.DefinitionError=Ob,HD.EvalError=Lb,HD.RangeError=Rb,HD.ReferenceError=Nb,HD.SecurityError=Fb,HD.SyntaxError=kb,HD.TypeError=Vb,HD.URIError=Ub,HD.VerifyError=jb,HD.UninitializedError=Gb,HD.ArgumentError=Qb,HD["flash.errors.IOError"]=zb,HD["flash.errors.EOFError"]=Hb,HD["flash.errors.MemoryError"]=Xb,HD["flash.errors.IllegalOperationError"]=qb}var HD=gf.createMap(),XD=gf.createMap(),qD=[];function YD(t,e){return"object"==typeof t&&t&&(t.axClass===e.AXXML||t.axClass===e.AXXMLList||t.axClass===e.AXQName||t.axClass===e.AXNamespace)}function KD(t,e){return"object"==typeof e&&e&&(e.axClass===t.AXXML||e.axClass===t.AXXMLList)}function WD(t,e){if(!t||t.axClass!==e.AXXML)return Yv(t);switch(t._kind){case 3:case 2:return t._value;default:if(t.hasSimpleContent()){for(var i="",n=0;n<t._children.length;n++){var r=t._children[n];4!==r._kind&&5!==r._kind&&(i+=WD(r,e))}return i}return oT(e,t)}}function JD(t,e){if(KD(t,e))return e.toXMLString();e=Yv(e);for(var i,n=0;n<e.length&&"&"!==(i=e[n])&&"<"!==i&&">"!==i;)n++;if(n>=e.length)return e;for(var r=e.substring(0,n);n<e.length;)switch(i=e[n++]){case"&":r+="&amp;";break;case"<":r+="&lt;";break;case">":r+="&gt;";break;default:r+=i}return r}function ZD(t){t=String(t);for(var e,i=0;i<t.length&&"&"!==(e=t[i])&&"<"!==e&&'"'!==e&&"\n"!==e&&"\r"!==e&&"\t"!==e;)i++;if(i>=t.length)return t;for(var n=t.substring(0,i);i<t.length;)switch(e=t[i++]){case"&":n+="&amp;";break;case"<":n+="&lt;";break;case'"':n+="&quot;";break;case"\n":n+="&#xA;";break;case"\r":n+="&#xD;";break;case"\t":n+="&#x9;";break;default:n+=e}return n}function $D(t,e){var i=t[e];return" "===i||"\n"===i||"\r"===i||"\t"===i}function tT(t){for(var e=0;e<t.length;e++){var i=t[e];if(" "!==i&&"\n"!==i&&"\r"!==i&&"\t"!==i)return!1}return!0}function eT(t){for(var e=0;e<t.length&&$D(t,e);)e++;if(e>=t.length)return"";for(var i=t.length-1;$D(t,i);)i--;return 0===e&&i===t.length-1?t:t.substring(e,i+1)}var iT=[];function nT(t){if(t>0){if(void 0!==iT[t])return iT[t];for(var e="",i=0;i<t;i++)e+=" ";return iT[t]=e,e}return""}function rT(t){for(var e,i=1;;){if(e="_ns"+i,!t.some((function(t){return t.prefix===e})))return e;i++}}function oT(t,e){if(null==e)throw new TypeError;return JD(t,e)}function sT(t,e){if(null===t&&e.throwError("TypeError",db.ConvertNullToObjectError),void 0===t&&e.throwError("TypeError",db.ConvertUndefinedToObjectError),t.axClass===e.AXXML)return t;if(t.axClass===e.AXXMLList)return 1!==t._children.length&&e.throwError("TypeError",db.XMLMarkupMustBeWellFormed),t._children[0];var i=e.xmlParser.parseFromString(Yv(t)),n=i._children.length;return 0===n?xT(e,3):1===n?(i._children[0]._parent=null,i._children[0]):2===n?(i._children[1]._parent=null,i._children[1]):void e.throwError("TypeError",db.XMLMarkupMustBeWellFormed)}function aT(t,e){if(null===t&&e.sec.throwError("TypeError",db.ConvertNullToObjectError),void 0===t&&e.sec.throwError("TypeError",db.ConvertUndefinedToObjectError),t.axClass!==e.sec.AXXML){var i=sT('<parent xmlns="'+ZD(cT(e.sec).uri)+'">'+t+"</parent>",e.sec)._children;if(i)for(var n=0;n<i.length;n++){var r=i[n];r._parent=null,e.append(r)}}else e.append(t)}function lT(t,e){if(void 0===t)return _T;var i;if("object"==typeof t&&null!==t){if(t instanceof Kv)return t;if(t.axClass===e.AXQName)return t.name;i=String(t)}else"number"==typeof t?i=t+"":"string"==typeof t?i="*"===t?null:t:e.throwError("TypeError",db.XMLInvalidName,t);return i&&"@"===i[0]?("*"===(i=i.substr(1))&&(i=null),new Kv(null,0,13,[Hv.PUBLIC],i)):new Kv(null,0,7,[Hv.PUBLIC],i)}function uT(t,e){var i=fT;if(i.kind=t.kind,t.name&&t.name.axClass===e.AXQName&&(t=t.name.name),t.isQName())i.name=t.name,i.namespaces=t.namespaces;else if(t.isAnyNamespace())i.namespaces=t.namespaces;else{for(var n=cT(e),r=t.namespaces,o=!1,s=0;s<r.length;s++){var a=r[s];if(a.uri===n.uri&&a.prefix===n.prefix&&a.type===n.type){o=!0;break}}i.namespaces=o?t.namespaces:t.namespaces.concat(n)}var l=t.name;return t.isAnyName()||"*"===l||null===l?i.name=null:l.length>1&&"@"===l[0]?i.isAttribute()?i.name=l:(i.name="@*"===l?null:l.substr(1),i.kind=1===i.namespaces.length?13:14):i.name=l,i}function cT(t){for(var e=0===Cb.length?null:Cb[Cb.length-1].topScope();e;){if(e.defaultNamespace)return e.defaultNamespace;e=e.parent}return t.AXNamespace.defaultNamespace||(t.AXNamespace.defaultNamespace=new Hv(0,"default","")),t.AXNamespace.defaultNamespace}function hT(t,e){for(var i=t.uri,n=0;e&&n<e.length;n++)if(i===e[n].uri)return e[n];return t.namespaces[0]}function pT(t,e){try{e.AXQName.Create(t)}catch(t){return!1}return!0}var dT,fT=new Kv(null,0,7,[],null,null,!0),_T=new Kv(null,0,7,[],null,null,!0),mT=function(){function t(){}return t.prototype.resolveEntities=function(t){return t.replace(/&([^;]+);/g,(function(t,e){if("#x"===e.substring(0,2))return String.fromCharCode(parseInt(e.substring(2),16));if("#"===e.substring(0,1))return String.fromCharCode(parseInt(e.substring(1),10));switch(e){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"'}return t}))},t.prototype.parseContent=function(t,e){var i,n=e,r=[];function o(){for(;n<t.length&&$D(t,n);)++n}for(;n<t.length&&!$D(t,n)&&">"!==t[n]&&"/"!==t[n];)++n;for(i=t.substring(e,n),o();n<t.length&&">"!==t[n]&&"/"!==t[n]&&"?"!==t[n];){o();for(var s,a="";n<t.length&&!$D(t,n)&&"="!==t[n];)a+=t[n],++n;if(o(),"="!==t[n])return null;++n,o();var l=t[n];if('"'!==l&&"'"!==l)return null;var u=t.indexOf(l,++n);if(u<0)return null;s=t.substring(n,u),r.push({name:a,value:this.resolveEntities(s)}),n=u+1,o()}return{name:i,attributes:r,parsed:n-e}},t.prototype.parseProcessingInstruction=function(t,e){var i,n=e;for(;n<t.length&&!$D(t,n)&&">"!==t[n]&&"/"!==t[n];)++n;i=t.substring(e,n),function(){for(;n<t.length&&$D(t,n);)++n}();for(var r=n;n<t.length&&("?"!==t[n]||">"!=t[n+1]);)++n;return{name:i,value:t.substring(r,n),parsed:n-e}},t.prototype.parseXml=function(t){for(var e=0;e<t.length;){var i=e;if("<"===t[e]){var n;switch(t[++i]){case"/":if(++i,(n=t.indexOf(">",i))<0)return void this.onError(-9);this.onEndElement(t.substring(i,n)),i=n+1;break;case"?":++i;var r=this.parseProcessingInstruction(t,i);if("?>"!=t.substring(i+r.parsed,i+r.parsed+2))return void this.onError(-3);this.onPi(r.name,r.value),i+=r.parsed+2;break;case"!":if("--"===t.substring(i+1,i+3)){if((n=t.indexOf("--\x3e",i+3))<0)return void this.onError(-5);this.onComment(t.substring(i+3,n)),i=n+3}else if("[CDATA["===t.substring(i+1,i+8)){if((n=t.indexOf("]]>",i+8))<0)return void this.onError(-2);this.onCdata(t.substring(i+8,n)),i=n+3}else{if("DOCTYPE"!==t.substring(i+1,i+8))return void this.onError(-6);var o=t.indexOf("[",i+8),s=!1;if((n=t.indexOf(">",i+8))<0)return void this.onError(-4);if(o>0&&n>o){if((n=t.indexOf("]>",i+8))<0)return void this.onError(-4);s=!0}var a=t.substring(i+8,n+(s?1:0));this.onDoctype(a),i=n+(s?2:1)}break;default:var l=this.parseContent(t,i);if(null===l)return void this.onError(-6);var u=!1;if("/>"===t.substring(i+l.parsed,i+l.parsed+2))u=!0;else if(">"!==t.substring(i+l.parsed,i+l.parsed+1))return void this.onError(-9);this.onBeginElement(l.name,l.attributes,u),i+=l.parsed+(u?2:1)}}else{do{}while(i++<t.length&&"<"!==t[i]);var c=t.substring(e,i);this.onText(this.resolveEntities(c))}e=i}},t.prototype.onPi=function(t,e){},t.prototype.onComment=function(t){},t.prototype.onCdata=function(t){},t.prototype.onDoctype=function(t){},t.prototype.onText=function(t){},t.prototype.onBeginElement=function(t,e,i){},t.prototype.onEndElement=function(t){},t.prototype.onError=function(t){},t}(),gT=function(t){function e(e){var i=t.call(this)||this;return i.sec=e,i.scopes=[],i}return i(e,t),e.prototype.isWhitespacePreserved=function(){for(var t=this.scopes,e=t.length-1;e>=0;--e)if("preserve"===t[e].space)return!0;return!1},e.prototype.lookupDefaultNs=function(){for(var t=this.scopes,e=t.length-1;e>=0;--e)if("xmlns"in t[e])return t[e].xmlns;return""},e.prototype.lookupNs=function(t){for(var e=this.scopes,i=e.length-1;i>=0;--i)if(t in e[i].lookup)return e[i].lookup[t]},e.prototype.getName=function(t,e){var i=t.indexOf(":");if(i>=0){var n=t.substring(0,i),r=t.substring(i+1),o=this.lookupNs(n);return void 0===o&&this.sec.throwError("TypeError",db.XMLPrefixNotBound,n,r),{name:o+"::"+r,localName:r,prefix:n,namespace:o}}return e?{name:t,localName:t,prefix:"",namespace:this.lookupDefaultNs()}:{name:t,localName:t,prefix:"",namespace:""}},e.prototype.onError=function(t){switch(t){case-6:return void this.sec.throwError("TypeError",db.XMLMalformedElement);case-9:return void this.sec.throwError("TypeError",db.XMLUnterminatedElement);case-4:return void this.sec.throwError("TypeError",db.XMLUnterminatedDocTypeDecl);case-2:return void this.sec.throwError("TypeError",db.XMLUnterminatedCData);case-5:return void this.sec.throwError("TypeError",db.XMLUnterminatedComment);case-3:return void this.sec.throwError("TypeError",db.XMLUnterminatedXMLDecl)}},e.prototype.onPi=function(t,e){this.pi(t,e)},e.prototype.onComment=function(t){this.comment(t)},e.prototype.onCdata=function(t){this.cdata(t)},e.prototype.onDoctype=function(t){this.doctype(t)},e.prototype.onText=function(t){this.text(t,this.isWhitespacePreserved())},e.prototype.onBeginElement=function(t,e,i){for(var n=this.scopes,r={namespaces:[],lookup:Object.create(null),inScopes:null},o=0;o<e.length;++o){var s=e[o],a=s.name;if("xmlns:"===a.substring(0,6)){var l=a.substring(6),u=s.value;if(this.lookupNs(l)!==u){r.lookup[l]=eT(u);var c=qv(0,u,l);r.namespaces.push(c)}e[o]=null}else if("xmlns"===a){u=s.value;if(this.lookupDefaultNs()!==u){r.xmlns=eT(u);c=Xv(0,u);r.namespaces.push(c)}e[o]=null}else if("xml:"===a.substring(0,4)){var h=a.substring(4);r[h]=eT(s.value)}}var p=[];r.namespaces.forEach((function(t){t.prefix&&r.lookup[t.prefix]!==t.uri||p.push(t)})),n[n.length-1].inScopes.forEach((function(t){(t.prefix&&!(t.prefix in r.lookup)||!t.prefix&&!("xmlns"in r))&&p.push(t)})),r.inScopes=p,n.push(r);var d=[];for(o=0;o<e.length;++o)(s=e[o])&&d.push({name:this.getName(s.name,!1),value:s.value});this.beginElement(this.getName(t,!0),d,p,i),i&&n.pop()},e.prototype.onEndElement=function(t){this.endElement(this.getName(t,!0)),this.scopes.pop()},e.prototype.beginElement=function(t,e,i,n){var r=this.currentElement;this.elementsStack.push(r),this.currentElement=xT(this.sec,1,t.namespace,t.localName,t.prefix);for(var o=0;o<e.length;++o){var s=e[o],a=xT(this.sec,2,s.name.namespace,s.name.localName,s.name.prefix);a._value=s.value,a._parent=this.currentElement,this.currentElement._attributes.push(a)}for(o=0;o<i.length;++o)this.currentElement._inScopeNamespaces.push(i[o]);r.insert(r._children.length,this.currentElement),n&&(this.currentElement=this.elementsStack.pop())},e.prototype.endElement=function(t){this.currentElement=this.elementsStack.pop()},e.prototype.text=function(t,e){if(this.sec.AXXML.ignoreWhitespace&&(t=eT(t)),!(0===t.length||e&&this.sec.AXXML.ignoreWhitespace)){var i=xT(this.sec);i._value=t,this.currentElement.insert(this.currentElement._children.length,i)}},e.prototype.cdata=function(t){var e=xT(this.sec);e._value=t,this.currentElement.insert(this.currentElement._children.length,e)},e.prototype.comment=function(t){if(!this.sec.AXXML.ignoreComments){var e=xT(this.sec,4,"","");e._value=t,this.currentElement.insert(this.currentElement._children.length,e)}},e.prototype.pi=function(t,e){if(!this.sec.AXXML.ignoreProcessingInstructions){var i=xT(this.sec,5,"",t);i._value=e,this.currentElement.insert(this.currentElement._children.length,i)}},e.prototype.doctype=function(t){},e.prototype.parseFromString=function(t,e){var i=this.currentElement=xT(this.sec,1,"","","");this.elementsStack=[];var n=cT(this.sec),r=[{namespaces:[],lookup:{xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace"},inScopes:[n],space:"default",xmlns:n.uri}];if(this.scopes=r,this.parseXml(t),this.currentElement=null,this.elementsStack.length>0){var o=this.elementsStack.pop()._name.name;this.sec.throwError("TypeError",db.XMLUnterminatedElementTag,o,o)}return this.elementsStack=null,i},e}(mT),yT=function(t){function e(e,i){var n=t.call(this)||this,r="",o="";if(0===arguments.length);else if(1===arguments.length){if((a=e)instanceof Hv)return n._ns=a,n;if(a&&"object"==typeof a)if(a.axClass===n.sec.AXNamespace){var s=a;o=s.prefix,r=s.uri}else a.axClass===n.sec.AXQName&&null!==a.uri&&(r=a.uri);else o=""===(r=WD(a,n.sec))?"":void 0}else{var a,l=e;""===(r=Gh(a=i)&&a.axClass===n.sec.AXQName&&null!==a.uri?a.uri:WD(a,n.sec))?void 0===l||""===WD(l,n.sec)?o="":n.sec.throwError("TypeError",db.XMLNamespaceWithPrefixAndNoURI,l):o=void 0===l||!1===pT(l,n.sec)?void 0:WD(l,n.sec)}return n._ns=qv(0,r,o),n}return i(e,t),e.classInitializer=function(){mf(this,"$Bglength",2),mf(this.dPrototype,"$BgtoString",e.prototype.toString)},e.axApply=function(t,e){var i=e[0],n=e[1];if(1===e.length&&Gh(i)&&i.axClass===this.sec.AXNamespace)return i;switch(e.length){case 0:return this.sec.AXNamespace.Create();case 1:return this.sec.AXNamespace.Create(i);default:return this.sec.AXNamespace.Create(i,n)}},e.Create=function(t,e){var i=Object.create(this.sec.AXNamespace.tPrototype);return i.axInitializer.apply(i,arguments),i},e.FromNamespace=function(t){var e=Object.create(this.sec.AXNamespace.tPrototype);return e._ns=t,e},e.prototype.equals=function(t){return t&&t.axClass===this.axClass&&t._ns.uri===this._ns.uri||"string"==typeof t&&this._ns.uri===t},Object.defineProperty(e.prototype,"prefix",{get:function(){return this._ns.prefix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uri",{get:function(){return this._ns.uri},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this===this.axClass.dPrototype?"":this._ns.uri},e.prototype.valueOf=function(){return this===this.axClass.dPrototype?"":this._ns.uri},e.instanceConstructor=e,e.defaultNamespace=Hv.PUBLIC,e}(bb),AT=function(t){function e(e,i){var n,r,o=t.call(this)||this;if(0===arguments.length?n="":1===arguments.length?n=e:(r=e,n=i),n&&n.axClass===o.sec.AXQName){if(arguments.length<2)return o.name=n.name,o;n=n.localName}n=void 0===n?"":WD(n,o.sec),void 0===r&&(r="*"===n?null:cT(o.sec));var s=n,a=null;return null!==r&&(r.axClass!==o.sec.AXNamespace&&(r=o.sec.AXNamespace.Create(r)),a=r._ns),o.name=new Kv(null,0,7,[a],s),o}return i(e,t),e.classInitializer=function(){mf(this,"$Bglength",2),mf(this.dPrototype,"$BgtoString",e.prototype.ecmaToString)},e.Create=function(t,e,i){var n=Object.create(this.sec.AXQName.tPrototype);return n.axInitializer.apply(n,arguments),n},e.FromMultiname=function(t){var e=Object.create(this.sec.AXQName.tPrototype);return e.name=t,e},e.axApply=function(t,e){var i=e[0],n=e[1];if(1===e.length&&i&&i.axClass===this.sec.AXQName)return i;switch(e.length){case 0:return this.sec.AXQName.Create();case 1:return this.sec.AXQName.Create(i);default:return this.sec.AXQName.Create(i,n)}},e.prototype.equals=function(t){return t&&t.axClass===this.sec.AXQName&&t.uri===this.uri&&t.name.name===this.name.name||"string"==typeof t&&this.toString()===t},Object.defineProperty(e.prototype,"localName",{get:function(){return""!=this.name.name?this.name.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uri",{get:function(){var t=this.name.namespaces;return t.length>1?"":t[0]?t[0].uri:null},enumerable:!0,configurable:!0}),e.prototype.ecmaToString=function(){return this&&this===this.sec.AXQName.dPrototype?"":(this&&this.axClass===this.sec.AXQName||this.sec.throwError("TypeError",db.InvokeOnIncompatibleObjectError,"QName.prototype.toString"),this.toString())},e.prototype.toString=function(){var t=this.uri;if(""===t)return this.name.name;if(null===t)return"*::"+this.name.name;var e=(t+="").charCodeAt(t.length-1);return e>=57344&&e<=63743&&t.substr(0,t.length-1),this.name.name},e.prototype.valueOf=function(){return this},Object.defineProperty(e.prototype,"prefix",{get:function(){return this.name.namespaces[0]?this.name.namespaces[0].prefix:null},enumerable:!0,configurable:!0}),e}(bb);!function(t){t[t.FLAG_IGNORE_COMMENTS=1]="FLAG_IGNORE_COMMENTS",t[t.FLAG_IGNORE_PROCESSING_INSTRUCTIONS=2]="FLAG_IGNORE_PROCESSING_INSTRUCTIONS",t[t.FLAG_IGNORE_WHITESPACE=4]="FLAG_IGNORE_WHITESPACE",t[t.FLAG_PRETTY_PRINTING=8]="FLAG_PRETTY_PRINTING",t[t.ALL=15]="ALL"}(dT||(dT={}));var vT=[null,"element","attribute","text","comment","processing-instruction"],bT=function(t){function e(e){var i=t.call(this)||this;if(i._parent=null,Xh(e)&&(e=""),"string"==typeof e&&0===e.length)return i._kind=3,i._value="",i;var n=sT(e,i.sec);YD(e,i.sec)&&(n=n._deepCopy()),i._kind=n._kind,i._name=n._name,i._value=n._value,i._attributes=n._attributes,i._inScopeNamespaces=n._inScopeNamespaces;var r=n._children;if(i._children=r,r)for(var o=0;o<r.length;o++){r[o]._parent=i}return i}return i(e,t),e.classInitializer=function(){mf(this,"$Bglength",1);var t=this.dPrototype,i=e.prototype;Wv(t,"$BgvalueOf",i.valueOf),mf(t,"$BghasOwnProperty",i.native_hasOwnProperty),mf(t,"$BgpropertyIsEnumerable",i.native_propertyIsEnumerable),Wv(this,"$Bgsettings",e.native_settings),Wv(this,"$BgsetSettings",e.native_setSettings),Wv(this,"$BgdefaultSettings",e.native_defaultSettings),Wv(t,"$BgtoString",i.toString),Wv(t,"$BgaddNamespace",i.addNamespace),Wv(t,"$BgappendChild",i.appendChild),Wv(t,"$Bgattribute",i.attribute),Wv(t,"$Bgattributes",i.attributes),Wv(t,"$Bgchild",i.child),Wv(t,"$BgchildIndex",i.childIndex),Wv(t,"$Bgchildren",i.children),Wv(t,"$Bgcomments",i.comments),Wv(t,"$Bgcontains",i.contains),Wv(t,"$Bgcopy",i.copy),Wv(t,"$Bgdescendants",i.descendants),Wv(t,"$Bgelements",i.elements),Wv(t,"$BghasComplexContent",i.hasComplexContent),Wv(t,"$BghasSimpleContent",i.hasSimpleContent),Wv(t,"$BginScopeNamespaces",i.inScopeNamespaces),Wv(t,"$BginsertChildAfter",i.insertChildAfter),Wv(t,"$BginsertChildBefore",i.insertChildBefore),Wv(t,"$Bglength",i.length),Wv(t,"$BglocalName",i.localName),Wv(t,"$Bgname",i.name),Wv(t,"$Bgnamespace",i.namespace),Wv(t,"$BgnamespaceDeclarations",i.namespaceDeclarations),Wv(t,"$BgnodeKind",i.nodeKind),Wv(t,"$Bgnormalize",i.normalize),Wv(t,"$Bgparent",i.parent),Wv(t,"$BgprocessingInstructions",i.processingInstructions),Wv(t,"$BgprependChild",i.prependChild),Wv(t,"$BgremoveNamespace",i.removeNamespace),Wv(t,"$Bgreplace",i.replace),Wv(t,"$BgsetChildren",i.setChildren),Wv(t,"$BgsetLocalName",i.setLocalName),Wv(t,"$BgsetName",i.setName),Wv(t,"$BgsetNamespace",i.setNamespace),Wv(t,"$Bgtext",i.text),Wv(t,"$BgtoXMLString",i.toXMLString),Wv(t,"$BgtoJSON",i.toJSON)},e.Create=function(t){var e=Object.create(this.sec.AXXML.tPrototype);return e.axInitializer(t),e},e.resetSettings=function(){this._flags=dT.ALL},e.native_settings=function(){var t=Object.create(this.sec.AXObject.tPrototype);return t.$BgignoreComments=this.ignoreComments,t.$BgignoreProcessingInstructions=this.ignoreProcessingInstructions,t.$BgignoreWhitespace=this.ignoreWhitespace,t.$BgprettyPrinting=this.prettyPrinting,t.$BgprettyIndent=this.prettyIndent,t},e.native_setSettings=function(t){if(Xh(t))return this.ignoreComments=!0,this.ignoreProcessingInstructions=!0,this.ignoreWhitespace=!0,this.prettyPrinting=!0,void(this.prettyIndent=2);"boolean"==typeof t.$BgignoreComments&&(this.ignoreComments=t.$BgignoreComments),"boolean"==typeof t.$BgignoreProcessingInstructions&&(this.ignoreProcessingInstructions=t.$BgignoreProcessingInstructions),"boolean"==typeof t.$BgignoreWhitespace&&(this.ignoreWhitespace=t.$BgignoreWhitespace),"boolean"===t.$BgprettyPrinting&&(this.prettyPrinting=t.$BgprettyPrinting),"number"===t.$BgprettyIndent&&(this.prettyIndent=t.$BgprettyIndent)},e.native_defaultSettings=function(){return{__proto__:this.sec.AXObject.tPrototype,$BgignoreComments:!0,$BgignoreProcessingInstructions:!0,$BgignoreWhitespace:!0,$BgprettyPrinting:!0,$BgprettyIndent:2}},e.axApply=function(t,e){var i=e[0];return Xh(i)&&(i=""),sT(i,this.sec)},e.prototype.valueOf=function(){return this},e.prototype.equals=function(t){if(t&&t.axClass===this.sec.AXXMLList)return t.equals(this);if(t&&t.axClass===this.sec.AXXML){var e=t;return(3===this._kind||2===this._kind)&&e.hasSimpleContent()||(3===e._kind||2===e._kind)&&this.hasSimpleContent()?this.toString()===t.toString():this._deepEquals(t)}return this.hasSimpleContent()&&this.toString()===Yv(t)},e.prototype.init=function(t,e){switch(this._name=e,this._kind=t,this._parent=null,t){case 1:this._inScopeNamespaces=[],this._attributes=[],this._children=[];break;case 4:case 5:case 2:case 3:this._value=""}return this},e.prototype._deepEquals=function(t){if(!t||t.axClass!==this.sec.AXXML)return!1;var e=t;if(this._kind!==e._kind)return!1;if(!!this._name!=!!e._name||this._name&&!this._name.equalsQName(e._name))return!1;if(1!==this._kind)return this._value===e._value;var i=this._attributes,n=e._attributes;if(i.length!==n.length)return!1;var r=this._children,o=e._children;if(r.length!==o.length)return!1;t:for(var s=0;s<i.length;s++){for(var a=i[s],l=0;l<n.length;l++){var u=n[l];if(u._name.equalsQName(a._name)&&u._value===a._value)continue t}return!1}for(s=0;s<r.length;s++)if(!r[s].equals(o[s]))return!1;return!0},e.prototype._deepCopy=function(){var t=this._kind,e=this.sec.AXXML.Create();switch(e._kind=t,e._name=this._name,t){case 1:e._inScopeNamespaces=this._inScopeNamespaces.slice(),e._attributes=this._attributes.map((function(t){return(t=t._deepCopy())._parent=e,t})),e._children=this._children.map((function(t){return(t=t._deepCopy())._parent=e,t}));break;case 4:case 5:case 2:case 3:e._value=this._value}return e},e.prototype.resolveValue=function(){return this},e.prototype._addInScopeNamespace=function(t){this._inScopeNamespaces.some((function(e){return e.uri===t.uri&&e.prefix===t.prefix}))||this._inScopeNamespaces.push(t)},Object.defineProperty(e,"ignoreComments",{get:function(){return!!(this._flags&dT.FLAG_IGNORE_COMMENTS)},set:function(t){(t=!!t)?this._flags|=dT.FLAG_IGNORE_COMMENTS:this._flags&=~dT.FLAG_IGNORE_COMMENTS},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ignoreProcessingInstructions",{get:function(){return!!(this._flags&dT.FLAG_IGNORE_PROCESSING_INSTRUCTIONS)},set:function(t){(t=!!t)?this._flags|=dT.FLAG_IGNORE_PROCESSING_INSTRUCTIONS:this._flags&=~dT.FLAG_IGNORE_PROCESSING_INSTRUCTIONS},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ignoreWhitespace",{get:function(){return!!(this._flags&dT.FLAG_IGNORE_WHITESPACE)},set:function(t){(t=!!t)?this._flags|=dT.FLAG_IGNORE_WHITESPACE:this._flags&=~dT.FLAG_IGNORE_WHITESPACE},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prettyPrinting",{get:function(){return!!(this._flags&dT.FLAG_PRETTY_PRINTING)},set:function(t){(t=!!t)?this._flags|=dT.FLAG_PRETTY_PRINTING:this._flags&=~dT.FLAG_PRETTY_PRINTING},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prettyIndent",{get:function(){return this._prettyIndent},set:function(t){t|=0,this._prettyIndent=t},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this===this.axClass.dPrototype?"":this.hasComplexContent()?this.toXMLString():WD(this,this.sec)},e.prototype.native_hasOwnProperty=function(t){if(this===this.axClass.dPrototype)return bb.prototype.native_hasOwnProperty.call(this,t);var e=lT(t,this.sec);return!!this.hasProperty(e)||this.axHasOwnProperty(e)},e.prototype.native_propertyIsEnumerable=function(t){return void 0===t&&(t=void 0),"0"===String(t)},e.prototype.addNamespace=function(t){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),this._addInScopeNamespace(t),this},e.prototype.appendChild=function(t){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),this.insert(this._children.length,t),this},e.prototype.attribute=function(t){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),Xh(t)&&arguments.length>0&&this.sec.throwError("TypeError",db.ConvertUndefinedToObjectError),t&&t.axClass===this.sec.AXQName?this.getProperty(t.name):("*"!==(t=Yv(t))&&0!==arguments.length||(t=null),fT.name=t,fT.namespaces=[Hv.PUBLIC],fT.kind=13,this.getProperty(fT))},e.prototype.attributes=function(){this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML");var t=this.sec.AXXMLList.CreateList(this,this._name);return Array.prototype.push.apply(t._children,this._attributes),t},e.prototype.child=function(t){if(this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),Hh(t)){var e=this.sec.AXXMLList.CreateList(null,null);return this._children&&t<this._children.length&&e.append(this._children[0|t]),e}var i;return t&&t.axClass===this.sec.AXQName?i=t.name:((i=fT).kind=7,i.name=WD(t,this.sec)),this.getProperty(i)},e.prototype.childIndex=function(){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),this._parent&&2!==this._kind?this._parent._children.indexOf(this):-1},e.prototype.children=function(){this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML");var t=this.sec.AXXMLList.CreateList(this,this._name);return t._children=this._children.concat(),t},e.prototype.comments=function(){this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML");var t=this.sec.AXXMLList.CreateList(this,this._name);return this._children&&this._children.forEach((function(e,i){4===e._kind&&t.append(e)})),t},e.prototype.contains=function(t){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),this===t},e.prototype.copy=function(){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),this._deepCopy()},e.prototype.descendants=function(t){this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML");var e=this.sec.AXXMLList.CreateList(this,this._name);return this.descendantsInto(lT(t,this.sec),e)},e.prototype.elements=function(t){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),this.getProperty(lT(t,this.sec))},e.prototype.hasComplexContent=function(){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),2!==this._kind&&4!==this._kind&&5!==this._kind&&3!==this._kind&&this._children.some((function(t){return 1===t._kind}))},e.prototype.hasSimpleContent=function(){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),4!==this._kind&&5!==this._kind&&(1!==this._kind||(!this._children&&0===this._children.length||this._children.every((function(t){return 1!==t._kind}))))},e.prototype.inScopeNamespaces=function(){this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML");for(var t=this._inScopeNamespacesImpl(),e=[],i=0;i<t.length;i++){var n=this.sec.AXNamespace;e[i]=n.FromNamespace(t[i])}return this.sec.AXArray.axBox(e)},e.prototype._inScopeNamespacesImpl=function(){for(var t=this,e=[],i=e;null!==t;){for(var n=t._inScopeNamespaces,r=0;n&&r<n.length;r++){var o=n[r];i[o.prefix]||(i[o.prefix]=o,e.push(o))}t=t._parent}return e},e.prototype.insertChildAfter=function(t,e){if(this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),!(this._kind>1)){if(null==t)return this.insert(0,e),this;if(t.axClass===this.sec.AXXMLList&&1===t._children.length&&(t=t._children[0]),t.axClass===this.sec.AXXML)for(var i=0;i<this._children.length;i++){if(this._children[i]===t)return this.insert(i+1,e),this}}},e.prototype.insertChildBefore=function(t,e){if(this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),!(this._kind>1)){if(null==t)return this.insert(this._children.length,e),this;if(t.axClass===this.sec.AXXMLList&&1===t._children.length&&(t=t._children[0]),t.axClass===this.sec.AXXML)for(var i=0;i<this._children.length;i++){if(this._children[i]===t)return this.insert(i,e),this}}},e.prototype.length=function(){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),this._children?this._children.length:0},e.prototype.localName=function(){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),""!=this._name.name?this._name.name:null},e.prototype.name=function(){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),this.sec.AXQName.FromMultiname(this._name)},e.prototype.namespace=function(t){if(this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),0===arguments.length&&this._kind>=3)return null;var e=this._inScopeNamespacesImpl();if(0===arguments.length)return this.sec.AXNamespace.FromNamespace(hT(this._name,e));t=Yv(t);for(var i=0;i<e.length;i++){var n=e[i];if(n.prefix===t)return this.sec.AXNamespace.FromNamespace(n)}},e.prototype.namespaceDeclarations=function(){this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML")},e.prototype.nodeKind=function(){return this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML"),vT[this._kind]},e.prototype.normalize=function(){this&&this.axClass===this.sec.AXXML||this.sec.throwError("TypeError",db.CheckTypeFailedError,this,"XML");for(var t=0;t<this._children.length;){var e=this._children[t];if(1===e._kind)e.normalize(),t++;else if(3===e._kind){for(;t+1<this._children.length;){var i=this._children[t+1];if(3!==i._kind)break;e._value+=i._value,this.removeByIndex(t+1)}0===e._value.length||tT(e._value)?this.removeByIndex(t):t++}else t++}return this},e.prototype.removeByIndex=function(t){this._children[t]._parent=null,this._children.splice(t,1)},e.prototype.parent=function(){return this._parent||void 0},e.prototype.processingInstructions=function(t){var e=this.sec.AXXMLList.CreateList(this,this._name);return e._targetObject=this,e._targetProperty=null,this.processingInstructionsInto(lT(t,this.sec),e)},e.prototype.processingInstructionsInto=function(t,e){var i=t||"*",n=this._children;if(!n)return e;for(var r=0;r<n.length;r++){var o=n[r];5!==o._kind||"*"!==i&&o._name.name!==i||e._children.push(o)}return e},e.prototype.prependChild=function(t){return this.insert(0,t),this},e.prototype.removeNamespace=function(t){},e.prototype.replace=function(t,e){if(1===this._kind){var i;i=!e||e.axClass!==this.axClass&&e.axClass!==this.sec.AXXMLList?Yv(e):e._deepCopy();var n=lT(t,this.sec);if(Hh(n.name))return this._replaceByIndex(0|n.name,i),this;for(var r=n.isAnyName(),o=-1,s=this._children,a=s.length;a--;){var l=s[a];(r||1===l._kind&&l._name.matches(n))&&(-1!==o&&this.deleteByIndex(o),o=a)}return-1===o||this._replaceByIndex(o,i),this}},e.prototype._replaceByIndex=function(t,e){if(this._kind>1)return this;var i=this._children;if(t>i.length&&(t=i.length),e&&e.axClass===this.axClass&&2!==e._kind){if(1===e._kind)for(var n=this;n;)n===e&&this.sec.throwError("Error",db.XMLIllegalCyclicalLoop),n=n._parent;e._parent=this,i[t]&&(i[t]._parent=null),i[t]=e}else if(e&&e.axClass===this.sec.AXXMLList)if(0===e._children.length)this.deleteByIndex(t);else{var r=e._children.length;if(t<i.length){i[t]._parent=null;for(var o=i.length-1;o>t;o--)i[o+r]=i[o]}for(o=0;o<r;o++){var s=e._children[o];s._parent=this,i[o+t]=s}}else{var a=Yv(e),l=this.axClass.Create();l._kind=3,l._value=a,l._parent=this,i[t]&&(i[t]._parent=null),i[t]=l}},e.prototype.setChildren=function(t){return this.setProperty(_T,t),this},e.prototype.setLocalName=function(t){var e;3!==this._kind&&4!==this._kind&&(e=t&&t.axClass===this.sec.AXQName?t.localName:Yv(t),this._name.name=e)},e.prototype.setName=function(t){if(3!==this._kind&&4!==this._kind){t&&t.axClass===this.sec.AXQName&&null===t.uri&&(t=t.localName);var e=this.sec.AXQName.Create(t).name;5===this._kind&&(e.namespaces[0]=Hv.PUBLIC),this._name=e;var i=this;if(2===this._kind){if(null===this._parent)return;i=this._parent}i.addInScopeNamespace(e.namespaces[0])}},e.prototype.setNamespace=function(t){if(3!==this._kind&&4!==this._kind&&5!==this._kind){var e=this.sec.AXNamespace.Create(t)._ns;this._name.namespaces=[e],2===this._kind?this._parent&&this._parent.addInScopeNamespace(e):1===this._kind&&this.addInScopeNamespace(e)}},e.prototype.text=function(){var t=this.sec.AXXMLList.CreateList(this,this._name);return this._children&&this._children.forEach((function(e,i){3===e._kind&&t.append(e)})),t},e.prototype.toXMLString=function(){return this.toXMLStringImpl()},e.prototype.toXMLStringImpl=function(t,e){var i=this.sec,n=i.AXXML.prettyPrinting;e|=0;var r=n?nT(e):"";switch(this._kind){case 3:return n?r+JD(i,eT(this._value)):JD(i,this._value);case 2:return r+ZD(this._value);case 4:return r+"\x3c!--"+this._value+"--\x3e";case 5:return r+"<?"+this._name.name+" "+this._value+"?>"}t=t||[];for(var o=[],s=0;this._inScopeNamespaces&&s<this._inScopeNamespaces.length;s++){var a=this._inScopeNamespaces[s];t.every((function(t){return t.uri!==a.uri||t.prefix!==a.prefix}))&&o.push(a)}var l=t.concat(o);if(void 0===(p=hT(this._name,l)).prefix){var u=rT(l),c=qv(0,p.uri,u);o.push(c),l.push(c)}var h=(p.prefix?p.prefix+":":"")+this._name.name;r+="<"+h,this._attributes&&this._attributes.forEach((function(t){var e=hT(t._name,l);if(void 0===e.prefix){var i=rT(l),n=qv(0,e.uri,i);o.push(n),l.push(n)}}));for(s=0;s<o.length;s++){var p;if(""!==(p=o[s]).uri&&"default"!==p.uri){var d=p.prefix?"xmlns:"+p.prefix:"xmlns";r+=" "+d+'="'+ZD(p.uri)+'"'}}if(this._attributes&&this._attributes.forEach((function(e){var i=e._name,n=hT(i,t),o=n.prefix?n.prefix+":"+i.name:i.name;r+=" "+o+'="'+ZD(e._value)+'"'})),0===this._children.length)return r+="/>";r+=">";var f=this._children.length>1||1===this._children.length&&3!==this._children[0]._kind,_=n&&f?e+i.AXXML._prettyIndent:0;return this._children.forEach((function(t,e){n&&f&&(r+="\n"),r+=t.toXMLStringImpl(l,_)})),n&&f&&(r+="\n"+nT(e)),r+="</"+h+">"},e.prototype.toJSON=function(t){return"XML"},e.prototype.axGetEnumerableKeys=function(){if(this===this.axClass.dPrototype)return t.prototype.axGetEnumerableKeys.call(this);for(var e=[],i=0;i<this._children.length;i++)e.push(this._children[i]._name.name);return e},e.prototype.setProperty=function(t,e){var i,n=this.sec;if(t.isAnyName()||t.isAttribute()||t.name!==t.name>>>0||n.throwError("TypeError",db.XMLAssignmentToIndexedXMLNotAllowed),3!==this._kind&&4!==this._kind&&5!==this._kind&&2!==this._kind)if(i=YD(e,n)&&3!==e._kind&&2!==e._kind?e._deepCopy():WD(e,n),t.isAttribute()){if(i&&i.axClass===n.AXXMLList)if(0===i._children.length)i="";else{for(var r=WD(i._children[0],n),o=1;o<i._children.length;o++)r+=" "+WD(i._children[o],n);i=r}else i=Yv(i);var s=null,a=this._attributes,l=this._attributes=[];for(o=0;a&&o<a.length;o++){var u=a[o];if(u._name.matches(t)){if(s){u._parent=null;continue}s=u}l.push(u)}if(!s){if(t.isAnyName())return;var c="";1===t.namespaces.length&&t.namespaces[0]&&(c=t.namespaces[0].uri),(s=xT(n,2,c,t.name))._parent=this,l.push(s)}s._value=i}else{for(var h,p=t.isAnyName(),d=!YD(i,n)&&!p&&"*"!==t.name,f=t.isAnyNamespace(),_=this._children.length-1;_>=0;_--)(p||1===this._children[_]._kind&&this._children[_]._name.name===t.name)&&(f||1===this._children[_]._kind&&this._children[_]._name.matches(t))&&(void 0!==h&&this.deleteByIndex(h),h=_);if(void 0===h&&(h=this._children.length,d)){c=null;var m=void 0;if(null!==(A=t.namespaces[0]).uri&&(c=A.uri,m=A.prefix),null===c){var g=cT(n);c=g.uri,m=g.prefix}var y=xT(n,1,c,t.name,m);y._parent=this,this._replaceByIndex(h,y);var A=y._name.namespace;y.addInScopeNamespace(A)}if(d){var v=this._children[h]._children;for(o=v.length;o--;)v[o]._parent=null;v.length=0,""!==(r=WD(i,n))&&this._children[h]._replaceByIndex(0,r)}else this._replaceByIndex(h,i)}},e.prototype.axSetProperty=function(t,e,i){this!==this.axClass.dPrototype?this.setProperty(uT(t,this.sec),e):this[this.axResolveMultiname(t)]=e},e.prototype.getProperty=function(t){var e=t.name;if(Hh(e))return 0==(0|e)?this:null;var i=this.sec.AXXMLList.CreateList(this,t),n=0,r=t.isAnyName(),o=t.isAnyNamespace();if(t.isAttribute()){for(var s=0;this._attributes&&s<this._attributes.length;s++){var a=this._attributes[s];!r&&a._name.name!==e||!o&&!a._name.matches(t)||(i._children[n++]=a,co(i._children[0]))}return i}for(s=0;this._children&&s<this._children.length;s++){a=this._children[s];(r||1===a._kind&&a._name.name===e)&&(o||a._name.matches(t))&&(i._children[n++]=a,co(i._children[0]))}return i},e.prototype.axGetProperty=function(t){return this===this.axClass.dPrototype?this[this.axResolveMultiname(t)]:this.getProperty(uT(t,this.sec))},e.prototype.hasProperty=function(t){if(Hh(t.name))return 0==(0|t.name);var e=lT(t,this.sec),i=e.isAnyName(),n=e.isAnyNamespace();if(t.isAttribute()){for(var r=0;this._attributes&&r<this._attributes.length;r++){var o=this._attributes[r];if(i||o._name.matches(e))return!0}return!1}for(r=0;this._children&&r<this._children.length;r++){o=this._children[r];if((i||1===o._kind&&o._name.name===e.name)&&(n||1===o._kind&&o._name.matches(e)))return!0}return!1},e.prototype.deleteProperty=function(t){if(Hh(t.name))return!0;var e=lT(t,this.sec),i=e.name,n=t.isAnyName(),r=t.isAnyNamespace();if(t.isAttribute()){var o=this._attributes;if(o)for(var s=this._attributes=[],a=0;a<o.length;a++){var l=o[a],u=l._name;!n&&u.name!==i||!r&&!u.matches(e)?s.push(l):l._parent=null}}else if(this._children.some((function(t,i){return(n||1===t._kind&&t._name.name===e.name)&&(r||1===t._kind&&t._name.matches(e))})))return!0},e.prototype.axHasProperty=function(e){return this===this.axClass.dPrototype?t.prototype.axHasPropertyInternal.call(this,e):this.axHasPropertyInternal(e)},e.prototype.axHasPropertyInternal=function(t){return!!this.hasProperty(t)||!!this[this.axResolveMultiname(t)]},e.prototype.axDeleteProperty=function(t){return!!this.deleteProperty(t)||delete this[this.axResolveMultiname(t)]},e.prototype.axCallProperty=function(t,e){var i=this[this.axResolveMultiname(t)];return i||(i=this["$Bg"+t.name]),i?(Ab(this.sec,i,e.length),i.axApply(this,e)):this.hasSimpleContent()?this.sec.box(WD(this,this.sec)).axCallProperty(t,e):void this.sec.throwError("TypeError",db.CallOfNonFunctionError,"value")},e.prototype._delete=function(t,e){},e.prototype.deleteByIndex=function(t){if(String(t>>>0)!==String(t))throw"TypeError in XML.prototype.deleteByIndex(): invalid index "+t;var e=this._children;t<e.length&&e[t]&&(e[t]._parent=null,e.splice(t,1))},e.prototype.insert=function(t,e){if(!(this._kind>1)){var i=t;if(e&&e.axClass===this.axClass)for(var n=this;n;)n===e&&this.sec.throwError("TypeError",db.XMLIllegalCyclicalLoop),n=n._parent;var r=1;if(!e||e.axClass!==this.sec.AXXMLList||0!==(r=e._children.length)){for(var o=this._children,s=o.length-1;s>=i;s--)o[s+r]=o[s],co(o[0]);if(e&&e.axClass===this.sec.AXXMLList){r=e._children.length;for(s=0;s<r;s++)e._children[s]._parent=this,o[i+s]=e._children[s]}else e&&e.axClass===this.axClass||(e=this.sec.AXXML.Create(e)),e._parent=this,o||(this._children=o=[]),o[i]=e,co(o[0])}}},e.prototype.addInScopeNamespace=function(t){if(3!==this._kind&&4!==this._kind&&5!==this._kind&&2!==this._kind){var e=t.prefix;if(void 0!==e){if(""===e&&""===this._name.uri)return;var i=null;this._inScopeNamespaces.forEach((function(t,n){t.prefix===e&&(i=t)})),null!==i&&i.uri!==t.uri&&this._inScopeNamespaces.forEach((function(e,n){e.prefix===i.prefix&&(this._inScopeNamespaces[n]=t)})),this._name.prefix===e&&(this._name.prefix=void 0),this._attributes.forEach((function(t,i){t._name.prefix===e&&(t._name.prefix=void 0)}))}}},e.prototype.descendantsInto=function(t,e){if(1!==this._kind)return e;var i=e._children.length,n=t.isAnyName();return t.isAttribute()?this._attributes.forEach((function(r,o){(n||r._name.matches(t))&&(e._children[i++]=r,co(e._children[0]))})):this._children.forEach((function(r,o){(n||r._name.matches(t))&&(e._children[i++]=r,co(e._children[0]))})),this._children.forEach((function(i,n){i.descendantsInto(t,e)})),e},e.instanceConstructor=e,e._flags=dT.ALL,e._prettyIndent=2,e}(bb);function xT(t,e,i,n,r){void 0===e&&(e=3),void 0===i&&(i=""),void 0===n&&(n="");var o=t.AXXML.Create(),s=qv(0,i,r||""),a=new Kv(null,0,2===e?13:7,[s],n,null);return o.init(e,a),o}var CT,wT=function(t){function e(e){var i=t.call(this)||this;if(i._children=[],Xh(e)&&(e=""),!e)return i;if(e&&e.axClass===i.sec.AXXMLList)for(var n=e._children,r=0;r<n.length;r++){var o=n[r];i._children[r]=o,co(i._children[0])}else aT(e,i);return i}return i(e,t),e.classInitializer=function(){mf(this,"$Bglength",1);var t=this.dPrototype,i=e.prototype;mf(t,"$BgvalueOf",Object.prototype.$BgvalueOf),mf(t,"$BghasOwnProperty",i.native_hasOwnProperty),mf(t,"$BgpropertyIsEnumerable",i.native_propertyIsEnumerable),Wv(t,"$BgtoString",i.toString),Wv(t,"$BgaddNamespace",i.addNamespace),Wv(t,"$BgappendChild",i.appendChild),Wv(t,"$Bgattribute",i.attribute),Wv(t,"$Bgattributes",i.attributes),Wv(t,"$Bgchild",i.child),Wv(t,"$BgchildIndex",i.childIndex),Wv(t,"$Bgchildren",i.children),Wv(t,"$Bgcomments",i.comments),Wv(t,"$Bgcontains",i.contains),Wv(t,"$Bgcopy",i.copy),Wv(t,"$Bgdescendants",i.descendants),Wv(t,"$Bgelements",i.elements),Wv(t,"$BghasComplexContent",i.hasComplexContent),Wv(t,"$BghasSimpleContent",i.hasSimpleContent),Wv(t,"$BginScopeNamespaces",i.inScopeNamespaces),Wv(t,"$BginsertChildAfter",i.insertChildAfter),Wv(t,"$BginsertChildBefore",i.insertChildBefore),Wv(t,"$Bglength",i.length),Wv(t,"$BglocalName",i.localName),Wv(t,"$Bgname",i.name),Wv(t,"$Bgnamespace",i.namespace),Wv(t,"$BgnamespaceDeclarations",i.namespaceDeclarations),Wv(t,"$BgnodeKind",i.nodeKind),Wv(t,"$Bgnormalize",i.normalize),Wv(t,"$Bgparent",i.parent),Wv(t,"$BgprocessingInstructions",i.processingInstructions),Wv(t,"$BgprependChild",i.prependChild),Wv(t,"$BgremoveNamespace",i.removeNamespace),Wv(t,"$Bgreplace",i.replace),Wv(t,"$BgsetChildren",i.setChildren),Wv(t,"$BgsetLocalName",i.setLocalName),Wv(t,"$BgsetName",i.setName),Wv(t,"$BgsetNamespace",i.setNamespace),Wv(t,"$Bgtext",i.text),Wv(t,"$BgtoXMLString",i.toXMLString),Wv(t,"$BgtoJSON",i.toJSON)},e.axApply=function(t,e){var i=e[0];if(Xh(i)&&(i=""),i&&i.axClass===this.sec.AXXMLList)return i;var n=this.sec.AXXMLList.Create();return aT(i,n),n},e.addXML=function(t,e){var i;return t.axClass===t.sec.AXXML?(i=t.sec.AXXMLList.Create()).append(t):i=t,i.append(e),i},e.Create=function(t){var e=Object.create(this.sec.AXXMLList.tPrototype);return e.axInitializer(t),e},e.CreateList=function(t,e){var i=this.Create();return i._targetObject=t,i._targetProperty=e,i},e.prototype.valueOf=function(){return this},e.prototype.equals=function(t){var e=this._children;if(void 0===t&&0===e.length)return!0;if(t&&t.axClass===this.sec.AXXMLList){var i=t._children;if(i.length!==e.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].equals(i[n]))return!1;return!0}return 1===e.length&&e[0].equals(t)},e.prototype.toString=function(){if(this.hasComplexContent())return this.toXMLString();for(var t="",e=0;e<this._children.length;e++)t+=WD(this._children[e],this.sec);return t},e.prototype._deepCopy=function(){for(var t=this.sec.AXXMLList.CreateList(this._targetObject,this._targetProperty),e=this._children.length,i=0;i<e;i++)t._children[i]=this._children[i]._deepCopy(),co(t._children[0]);return t},e.prototype._shallowCopy=function(){for(var t=this.sec.AXXMLList.CreateList(this._targetObject,this._targetProperty),e=this._children.length,i=0;i<e;i++)t._children[i]=this._children[i],co(t._children[0]);return t},e.prototype.native_hasOwnProperty=function(t){if(t=Yv(t),this===this.sec.AXXMLList.dPrototype)return bb.prototype.native_hasOwnProperty.call(this,t);if(Hh(t))return(0|t)<this._children.length;for(var e=lT(t,this.sec),i=this._children,n=0;n<i.length;n++){var r=i[n];if(1===r._kind&&r.hasProperty(e))return!0}return!1},e.prototype.native_propertyIsEnumerable=function(t){return Hh(t)&&(0|t)<this._children.length},e.prototype.attribute=function(t){return Xh(t)&&arguments.length>0&&this.sec.throwError("TypeError",db.ConvertUndefinedToObjectError),t&&t.axClass===this.sec.AXQName?this.getProperty(t.name):("*"!==(t=Yv(t))&&0!==arguments.length||(t=null),fT.name=t,fT.namespaces=[Hv.PUBLIC],fT.kind=13,this.getProperty(fT))},e.prototype.attributes=function(){return fT.name=null,fT.namespaces=[],fT.kind=13,this.getProperty(fT)},e.prototype.child=function(t){if(Hh(t)){var e=this.sec.AXXMLList.CreateList(this._targetObject,this._targetProperty);return(0|t)<this._children.length&&(e._children[0]=this._children[0|t]._deepCopy(),co(e._children[0])),e}return this.getProperty(lT(t,this.sec))},e.prototype.children=function(){return this.getProperty(_T)},e.prototype.descendants=function(t){for(var e=lT(t,this.sec),i=this.sec.AXXMLList.CreateList(this._targetObject,this._targetProperty),n=0;n<this._children.length;n++){var r=this._children[n];1===r._kind&&r.descendantsInto(e,i)}return i},e.prototype.comments=function(){var t=this.sec.AXXMLList.CreateList(this._targetObject,this._targetProperty);return this._children.forEach((function(e){if(1===e._kind){var i=e.comments();Array.prototype.push.apply(t._children,i._children)}})),t},e.prototype.contains=function(t){for(var e=this._children,i=0;i<e.length;i++){if(e[i].equals(t))return!0}return!1},e.prototype.copy=function(){return this._deepCopy()},e.prototype.elements=function(t){var e=lT(t,this.sec),i=this.sec.AXXMLList.CreateList(this._targetObject,e);return this._children.forEach((function(t){if(1===t._kind){var n=t.elements(e);Array.prototype.push.apply(i._children,n._children)}})),i},e.prototype.hasComplexContent=function(){switch(this._children.length){case 0:return!1;case 1:return this._children[0].hasComplexContent();default:return this._children.some((function(t){return 1===t._kind}))}},e.prototype.hasSimpleContent=function(){switch(this._children.length){case 0:return!0;case 1:return this._children[0].hasSimpleContent();default:return this._children.every((function(t){return 1!==t._kind}))}},e.prototype.length=function(){return this._children.length},e.prototype.name=function(){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"name"),this._children[0].name()},e.prototype.normalize=function(){for(var t=0;t<this._children.length;){var e=this._children[t];if(1===e._kind)e.normalize(),t++;else if(3===e._kind){for(t++;t<this._children.length;){var i=this._children[t];if(3!==i._kind)break;e._value+=i._value,this.removeByIndex(t)}0===e._value.length?this.removeByIndex(t):t++}else t++}return this},e.prototype.parent=function(){var t=this._children;if(0!==t.length){for(var e=t[0]._parent,i=1;i<t.length;i++)if(t[i]._parent!==e)return;return e}},e.prototype.processingInstructions=function(t){var e=lT(t,this.sec),i=this.sec.AXXMLList.CreateList(this._targetObject,this._targetProperty);i._targetObject=this,i._targetProperty=null;for(var n=this._children,r=0;r<n.length;r++)n[r].processingInstructionsInto(e,i);return i},e.prototype.text=function(){var t=this.sec.AXXMLList.CreateList(this._targetObject,this._targetProperty);return this._children.forEach((function(e,i){if(1===e._kind){var n=e.text();n._children.length>0&&t._children.push(n)}})),t},e.prototype.toXMLString=function(){var t=this.sec;return this._children.map((function(e){return oT(t,e)})).join(t.AXXML.prettyPrinting?"\n":"")},e.prototype.toJSON=function(t){return"XMLList"},e.prototype.addNamespace=function(t){1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"addNamespace");var e=this._children[0];return e.addNamespace(t),e},e.prototype.appendChild=function(t){1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"appendChild");var e=this._children[0];return e.appendChild(t),e},e.prototype.append=function(t){var e=this._children,i=e.length;if(t&&t.axClass===this.sec.AXXMLList){this._targetObject=t._targetObject,this._targetProperty=t._targetProperty;var n=t._children;if(0===n.length)return;for(var r=0;r<n.length;r++)e[i+r]=n[r]}else e[i]=t},e.prototype.childIndex=function(){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"childIndex"),this._children[0].childIndex()},e.prototype.inScopeNamespaces=function(){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"inScopeNamespaces"),this._children[0].inScopeNamespaces()},e.prototype.insertChildAfter=function(t,e){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"insertChildAfter"),this._children[0].insertChildAfter(t,e)},e.prototype.insertChildBefore=function(t,e){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"insertChildBefore"),this._children[0].insertChildBefore(t,e)},e.prototype.nodeKind=function(){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"nodeKind"),this._children[0].nodeKind()},e.prototype.namespace=function(t){1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"namespace");var e=this._children[0];return arguments.length?e.namespace(t):e.namespace()},e.prototype.localName=function(){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"localName"),this._children[0].localName()},e.prototype.namespaceDeclarations=function(){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"namespaceDeclarations"),this._children[0].namespaceDeclarations()},e.prototype.prependChild=function(t){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"prependChild"),this._children[0].prependChild(t)},e.prototype.removeNamespace=function(t){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"removeNamespace"),this._children[0].removeNamespace(t)},e.prototype.replace=function(t,e){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"replace"),this._children[0].replace(t,e)},e.prototype.setChildren=function(t){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"setChildren"),this._children[0].setChildren(t)},e.prototype.setLocalName=function(t){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"setLocalName"),this._children[0].setLocalName(t)},e.prototype.setName=function(t){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"setName"),this._children[0].setName(t)},e.prototype.setNamespace=function(t){return 1!==this._children.length&&this.sec.throwError("TypeError",db.XMLOnlyWorksWithOneItemLists,"setNamespace"),this._children[0].setNamespace(t)},e.prototype.axGetEnumerableKeys=function(){return this===this.axClass.dPrototype?t.prototype.axGetEnumerableKeys.call(this):Object.keys(this._children)},e.prototype.getProperty=function(t){var e=t.name;if(Hh(e))return this._children[0|e];for(var i=null===e||"*"===e,n=t.isAnyNamespace(),r=t.isAttribute(),o=this.sec.AXXMLList.CreateList(this._targetObject,t),s=this._children,a=0;a<s.length;a++){if(1===(c=s[a])._kind)if(r)for(var l=c._attributes,u=0;l&&u<l.length;u++){var c=l[u];!i&&c._name.name!==e||!n&&!c._name.matches(t)||o._children.push(c)}else{var h=c._children;for(u=0;h&&u<h.length;u++){c=h[u];(i||1===c._kind&&c._name.name===e)&&(n||c._name.matches(t))&&o._children.push(c)}}}return o},e.prototype.axGetProperty=function(t){return this===this.axClass.dPrototype?this[this.axResolveMultiname(t)]:this.getProperty(uT(t,this.sec))},e.prototype.axGetPublicProperty=function(t){return this===this.axClass.dPrototype?this[Kv.getPublicMangledName(t)]:Hh(t)?this._children[0|t]:(fT.name=t,fT.namespaces=[Hv.PUBLIC],fT.kind=7,this.getProperty(fT))},e.prototype.hasProperty=function(t){return!Hh(t.name)||Number(t.name)<this._children.length},e.prototype.axHasProperty=function(t){return this.hasProperty(t)},e.prototype.axHasPropertyInternal=function(t){return this.hasProperty(t)},e.prototype.resolveValue=function(){return this},e.prototype.setProperty=function(t,e){if(Hh(t.name)){var i=0|t.name,n=null;if(this._targetObject&&null===(n=this._targetObject.resolveValue()))return;var r=this._children.length;if(i>=r){if(n&&n.axClass===this.sec.AXXMLList){if(1!==n._children.length)return;n=n._children[0]}if(n&&1!==n._kind)return;var o=this.sec.AXXML.Create();o._parent=n;var s=this._targetProperty,a=3;if(this._targetProperty&&this._targetProperty.isAttribute()){if(n.hasProperty(this._targetProperty))return;a=2}else this._targetProperty&&null!==this._targetProperty.name?a=1:(s=null,a=3);if(o.init(a,s),i=r,2!==o._kind){if(null!==n){if(i>0){var l=this._children[i-1],u=n._children.length-1;for(g=0;g<u&&n._children[g]!==l;g++);}else g=n._children.length-1;n._children[g+1]=o,co(n._children[0]),o._parent=n}e&&e.axClass===this.sec.AXXML?o._name=e._name:e&&e.axClass===this.sec.AXXMLList&&(o._name=e._targetProperty),this.append(o)}}YD(e,this.sec)&&3!==e._kind&&2!==e._kind||(e+="");var c=this._children[i],h=c._kind,p=c._parent;if(2===h){var d=p._children.indexOf(c);return p.setProperty(c._name,!1),this._children[i]=p._children[d],void co(this._children[0])}if(e&&e.axClass===this.sec.AXXMLList){var f=e._shallowCopy(),_=f._children.length;if(null!==p){var m=p._children.indexOf(c);p._replaceByIndex(m,f);for(var g=0;g<_;g++)f._children[g]=p._children[m+g]}if(0===_){for(g=i+1;g<r;g++)this._children[g-1]=this._children[g],co(this._children[0]);this._children.length--}else for(g=r-1;g>i;g--)this._children[g+_-1]=this._children[g],co(this._children[0]);for(g=0;g<_;g++)this._children[i+g]=f._children[g],co(this._children[0]);return}if(h>=3||e&&e.axClass===this.sec.AXXML){if(null!==p){m=p._children.indexOf(c);p._replaceByIndex(m,e),e=p._children[m]}if("string"==typeof e){var y=this.sec.AXXML.Create(e);this._children[i]=y,co(this._children[0])}else this._children[i]=e,co(this._children[0]);return}c.setProperty(_T,e)}else{if(0===this._children.length){if(null===(n=this.resolveValue())||1!==n._children.length)return;this.append(n._children[0])}1!==this._children.length?this.sec.throwError("TypeError",db.XMLAssigmentOneItemLists):this._children[0].setProperty(t,e)}},e.prototype.axSetProperty=function(t,e,i){this!==this.axClass.dPrototype?this.setProperty(uT(t,this.sec),e):this[this.axResolveMultiname(t)]=e},e.prototype.axDeleteProperty=function(t){var e=t.name;if(Hh(e))return(i=0|e)>=this._children.length||this.removeByIndex(i),!0;for(var i=0;i<this._children.length;i++){var n=this._children[i];1===n._kind&&n.deleteProperty(t)}return!0},e.prototype.removeByIndex=function(t){var e=this._children[t],i=e._parent;i&&(e._parent=null,i._children.splice(i._children.indexOf(e),1)),this._children.splice(t,1)},e.prototype.axCallProperty=function(t,e){var i=this[this.axResolveMultiname(t)];return i?(Ab(this.sec,i,e.length),i.axApply(this,e)):1===this._children.length?this._children[0].axCallProperty(t,e):void this.sec.throwError("TypeError",db.CallOfNonFunctionError,"value")},e.instanceConstructor=e,e}(bb);!function(t){t[t.APOS=39]="APOS",t[t.AMP=38]="AMP",t[t.QUOT=34]="QUOT",t[t.LT=60]="LT",t[t.GT=62]="GT"}(CT||(CT={}));var IT=function(t){function e(e,i){return t.call(this)||this}return i(e,t),e.escapeXML=function(t){for(var e,i=0,n=(t=Yv(t)).length;i<n&&(e=t.charCodeAt(i))!==CT.APOS&&e!==CT.AMP&&e!==CT.QUOT&&e!==CT.LT&&e!==CT.GT;)i++;if(i>=n)return t;for(var r=[t.substring(0,i)];i<n;){switch(e){case CT.APOS:r.push("&apos;");break;case CT.AMP:r.push("&amp;");break;case CT.QUOT:r.push("&quot;");break;case CT.LT:r.push("&lt;");break;case CT.GT:r.push("&gt;")}for(var o=++i;i<n&&(e=t.charCodeAt(i))!==CT.APOS&&e!==CT.AMP&&e!==CT.QUOT&&e!==CT.LT&&e!==CT.GT;)i++;o<i&&r.push(t.substring(o,i))}return r.join("")},e}(bb),ET=function(t){function e(e){return t.call(this,1,"")||this}return i(e,t),e}(IT),ST=function(t){function e(){var e=t.call(this)||this;return e._type=0,e._value=null,e._empty=!1,e._attrs=null,e}return i(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){t>>>=0,this._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._empty},set:function(t){t=!!t,this._empty=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){t=Yv(t),this._value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrs",{get:function(){return this._attrs},set:function(t){this._attrs=t},enumerable:!0,configurable:!0}),e}(bb),DT=function(t){function e(){return t.call(this)||this}return i(e,t),e}(bb);var TT=function(t){function e(e){var i=t.call(this)||this;return i.sec=e,i.queue=[],i.ignoreWhitespace=!1,i}return i(e,t),e.prototype.onError=function(t){this.queue.push(t)},e.prototype.onPi=function(t,e){},e.prototype.onComment=function(t){},e.prototype.onCdata=function(t){this.queue.push({type:4,value:t})},e.prototype.onDoctype=function(t){},e.prototype.onBeginElement=function(t,e,i){var n=this.sec.createObject();e.forEach((function(t){n.axSetPublicProperty(t.name,t.value)})),this.queue.push({type:1,value:t,empty:i,attrs:n})},e.prototype.onEndElement=function(t){this.queue.push({type:1,value:"/"+t})},e.prototype.onText=function(t){this.ignoreWhitespace&&function(t){for(var e=0;e<t.length;e++){var i=t[e];if(" "!==i&&"\n"!==i&&"\r"!==i&&"\t"!==i)return!1}return!0}(t)||this.queue.push({type:3,value:t})},e}(mT),PT=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.startParse=function(t,e){t=Yv(t),e=!!e;var i=new TT(this.sec);i.ignoreWhitespace=e,i.parseXml(t),this.queue=i.queue},e.prototype.getNext=function(t){if(0===this.queue.length)return-1;var e=this.queue.shift();if("number"==typeof e)return e;var i=e;return t.type=i.type,t.value=i.value,t.empty=i.empty||!1,t.attrs=i.attrs||null,0},e}(bb),BT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.exists=function(){},e.read=function(){},e.write=function(){},e.readByteArray=function(){},e.writeByteArray=function(){},e}(bb);function MT(t,e,i,n){void 0===i&&(i=t),void 0===n&&(n=0),XD[t]=e,qD.push({name:t,alias:i,nsType:n})}function OT(t,e){yD[t]=e}function LT(t){return"string"==typeof t}function RT(t,e){var i=Object.create(e.tPrototype);return i._symbol||(i._symbol=t),i.applySmybol&&i.applySymbol(),i[eb]=!0,i}MT("__AS3__.vec.Vector$object",lx,"ObjectVector",2),MT("__AS3__.vec.Vector$int",ux,"Int32Vector",2),MT("__AS3__.vec.Vector$uint",cx,"Uint32Vector",2),MT("__AS3__.vec.Vector$double",hx,"Float64Vector",2),OT("FlashUtilScript::getDefinitionByName",(function(t,e){var i=String(e).replace("::",".");return _D().env.app.getClass(Kv.FromFQNString(i,0))})),OT("FlashUtilScript::getTimer",(function(t){return Date.now()-of.runtimeStartTime})),OT("FlashUtilScript::navigateToURL",mD),OT("FlashNetScript::navigateToURL",mD),OT("FlashNetScript::sendToURL",(function(t,e){mo(e)&&t.throwError("TypeError",db.NullPointerError,"request"),t.flash.net.URLRequest.axClass.axIsType(e)||t.throwError("TypeError",db.CheckTypeFailedError,e,"flash.net.URLRequest"),console.log("TODO: FlashNetScript_sendToURL: FileLoadingService")})),OT("FlashUtilScript::escapeMultiByte",gD(vh.escape)),OT("FlashUtilScript::unescapeMultiByte",gD(vh.unescape)),OT("Toplevel::registerClassAlias",(function(t,e,i){(e=Yv(e))||t.throwError("TypeError",db.NullPointerError,"aliasName"),i||t.throwError("TypeError",db.NullPointerError,"classObject"),t.classAliases.registerClassAlias(e,i)})),OT("Toplevel::getClassByAlias",(function(t,e){(e=Yv(e))||t.throwError("TypeError",db.NullPointerError,"aliasName");var i=t.classAliases.getClassByAlias(e);return i||t.throwError("ReferenceError",db.ClassNotFoundError,e),i}));var NT=function(){function t(e,i,n){void 0===n&&(n=!1),t.ID++,this[eb]=!0,this.init(e,i,n)}return t.prototype.toString=function(){return this.parent+" => "+this.object+" "+this.isWith},t.prototype.init=function(t,e,i){void 0===i&&(i=!1),this.parent=t,this.object=e,this.global=t?t.global:this,this.isWith=i,this.cache=[],this.defaultNamespace=null,e.__scope__=this},Object.defineProperty(t.prototype,"superConstructor",{get:function(){var t=this.object.superClass;if(!t)return null;var e=t[eb]?t.tPrototype.axInitializer:t;return Object.defineProperty(this,"superConstructor",{value:e}),e},enumerable:!0,configurable:!0}),t.prototype.extend=function(e){if(e===this.object)return this;var i=e.__scope__;return i&&i.parent==this?i:new t(this,e,!1)},t.prototype.findDepth=function(t){for(var e=this,i=0;e;){if(e.object===t)return i;i++,e=e.parent}return-1},t.prototype.getScopeObjects=function(){for(var t=[],e=this;e;)t.unshift(e.object),e=e.parent;return t},t.prototype.getScopeProperty=function(t,e,i){return this.findScopeProperty(t,e,i).axGetProperty(t)},t.prototype.findScopeProperty=function(t,e,i){if(t.mutable||i)return this._findScopeProperty(t,e,i);if(t.scope===this.object&&!this.isWith)return t.value;var n=this._findScopeProperty(t,e,i);return this.isWith||(t.value=n,t.scope=this.object),n},t.prototype._findScopeProperty=function(t,e,i){if(null===t.name&&this.global.object.sec.throwError("ReferenceError",db.UndefinedVarError,"*"),n=this.cache[t.id])return n;if(this.object&&this.object[eb]&&(this.isWith?this.object.axHasPropertyInternal(t):this.object.traits.getTrait(t.namespaces,t.name)))return this.isWith||t.isRuntime()?this.object:this.cache[t.id]=this.object;if(this.parent){var n=this.parent.findScopeProperty(t,e,i);return 7===t.kind&&(this.cache[t.id]=n),n}if(i)return null;t.isAttribute()&&this.object.sec.throwError("ReferenceError",db.UndefinedVarError,t.name);var r=this.global.object;return(n=r.applicationDomain.findProperty(t,e,!0))?n:(e&&(t.getPublicMangledName()in r||this.global.object.sec.throwError("ReferenceError",db.UndefinedVarError,t.name)),r)},t.ID=0,t}();function FT(t){var e=t.axClass;if(!e||e===e.sec.AXObject)return null;var i=e.dPrototype;return i===t&&(i=e.superClass.dPrototype),i}var kT=function(){function t(t,e){this.object=t,this.index=e}return t.prototype.next=function(t,e){if(Xh(t))return this.index=0,void(this.object=null);this.object=t,this.index=e;var i=t.axNextNameIndex(this.index);if(i>0)this.index=i;else for(;;){if(!(t=FT(t)))return this.index=0,void(this.object=null);if((i=t.axNextNameIndex(0))>0)return this.index=i,void(this.object=t)}},t}();function VT(t,e,i){return YD(t,i)?t.equals(e):YD(e,i)?e.equals(t):t==e}function UT(t,e){return e.AXXML.dPrototype.isPrototypeOf(t)||e.AXXMLList.dPrototype.isPrototypeOf(t)}function jT(t,e,i){return UT(t,i)||i.throwError("TypeError",db.DescendentsError,t),t.descendants(e)}function GT(t,e){if(!e||!KD(t,e)){var i=e&&e.axClass?e.axClass.name.toFQNString(!1):"[unknown]";t.throwError("TypeError",db.FilterError,i)}return e}function QT(t){return"string"==typeof t?t:t+""}function zT(t,e,i){return"string"==typeof t||"string"==typeof e?String(t)+String(e):KD(i,t)&&KD(i,e)?wT.addXML(t,e):t+e}function HT(t,e){if(t){if(t.value)return typeof t.value;if(UT(t,e))return"xml"}return typeof t}function XT(t){return"Bytecode: "+t}var qT=new Uint32Array(256),YT=new Array(256);function KT(t,e,i){void 0===i&&(i=0);e.length;qT[t]=i,YT[t]=e}KT(1,""),KT(2,""),KT(3,""),KT(4,"e"),KT(5,"e"),KT(6,"e"),KT(7,""),KT(8,"e"),KT(9,""),KT(10,""),KT(11,""),KT(12,"d"),KT(13,"d"),KT(14,"d"),KT(15,"d"),KT(16,"d"),KT(17,"d"),KT(18,"d"),KT(19,"d"),KT(20,"d"),KT(21,"d"),KT(22,"d"),KT(23,"d"),KT(24,"d"),KT(25,"d"),KT(26,"d"),KT(27,""),KT(28,""),KT(29,""),KT(30,""),KT(31,""),KT(32,""),KT(33,""),KT(35,""),KT(36,"b"),KT(37,"c"),KT(38,""),KT(39,""),KT(40,""),KT(41,""),KT(42,""),KT(43,""),KT(44,"e"),KT(45,"e"),KT(46,"e"),KT(47,"e"),KT(48,""),KT(49,"e"),KT(50,"ee"),KT(53,""),KT(54,""),KT(55,""),KT(56,""),KT(57,""),KT(58,""),KT(59,""),KT(60,""),KT(61,""),KT(62,""),KT(64,"e"),KT(65,"e"),KT(66,"e"),KT(67,"ee"),KT(68,"ee"),KT(69,"ee"),KT(70,"ee"),KT(71,""),KT(72,""),KT(73,"e"),KT(74,"ee"),KT(75,""),KT(76,"ee"),KT(77,""),KT(78,"ee"),KT(79,"ee"),KT(80,""),KT(81,""),KT(82,""),KT(83,"e"),KT(84,""),KT(85,"e"),KT(86,"e"),KT(87,""),KT(88,"e"),KT(89,"e"),KT(90,"e"),KT(93,"e"),KT(94,"e"),KT(95,""),KT(96,"e"),KT(97,"e"),KT(98,"e"),KT(99,"e"),KT(100,""),KT(101,"e"),KT(102,"e"),KT(103,""),KT(104,"e"),KT(106,"e"),KT(108,"e"),KT(109,"e"),KT(110,"e"),KT(111,"e"),KT(112,""),KT(113,""),KT(114,""),KT(115,""),KT(116,""),KT(117,""),KT(118,""),KT(119,""),KT(120,""),KT(121,""),KT(122,""),KT(123,""),KT(128,"e"),KT(129,""),KT(130,""),KT(131,""),KT(132,""),KT(133,""),KT(134,"e"),KT(135,""),KT(136,""),KT(137,""),KT(144,""),KT(145,""),KT(146,"e"),KT(147,""),KT(148,"e"),KT(149,""),KT(150,""),KT(151,""),KT(160,""),KT(161,""),KT(162,""),KT(163,""),KT(164,""),KT(165,""),KT(166,""),KT(167,""),KT(168,""),KT(169,""),KT(170,""),KT(171,""),KT(172,""),KT(173,""),KT(174,""),KT(175,""),KT(176,""),KT(177,""),KT(178,"e"),KT(179,""),KT(180,""),KT(192,""),KT(193,""),KT(194,"e"),KT(195,"e"),KT(196,""),KT(197,""),KT(198,""),KT(199,""),KT(208,""),KT(209,""),KT(210,""),KT(211,""),KT(212,""),KT(213,""),KT(214,""),KT(215,""),KT(237,""),KT(239,"aeae"),KT(240,"e"),KT(241,"e"),KT(242,"e"),KT(243,"");var WT=function(){function t(){}return t.u8=function(t,e){return t[e]},t.s32=function(t,e){var i=t[e];return 128&i&&16384&(i=127&i|t[e+1]<<7)&&2097152&(i=16383&i|t[e+2]<<14)&&268435456&(i=2097151&i|t[e+3]<<21)&&(i=268435455&i|t[e+4]<<28,i&=4294967295),i},t.u32=function(e,i){return t.s32(e,i)>>>0},t.u30=function(e,i){return t.u32(e,i)},t.s32Length=function(t,e){var i=t[e];return 128&i?16384&(i=127&i|t[e+1]<<7)?2097152&(i=16383&i|t[e+2]<<14)?268435456&(i=2097151&i|t[e+3]<<21)?5:4:3:2:1},t}();var JT,ZT=function(){function t(t){this._code=t,this.setBCI(0)}return t.prototype.next=function(){this.setBCI(this._nextBCI)},t.prototype.endBCI=function(){return this._code.length},Object.defineProperty(t.prototype,"nextBCI",{get:function(){return this._nextBCI},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentBCI",{get:function(){return this._currentBCI},enumerable:!0,configurable:!0}),t.prototype.currentBytecode=function(){return this._bytecode},t.prototype.nextBC=function(){return WT.u8(this._code,this._nextBCI)},t.prototype.setBCI=function(t){if(this._currentBCI=t,this._currentBCI<this._code.length){this._bytecode=WT.u8(this._code,t);var e=function(t,e){var i=1,n=t[e];if(27===n){i+=3;var r=WT.u30(t,e+i)+1;return i+=WT.s32Length(t,e+i),i+=3*r}var o=YT[n];if(""===o)return i;co(o,"OP: "+XT(n));for(var s=0;s<o.length;s++){switch(o[s].charCodeAt(0)-97){case 0:case 1:i+=1;continue;case 3:i+=3;continue;case 2:case 4:case 5:i+=WT.s32Length(t,e+i);continue}}return i}(this._code,t);this._nextBCI=t+e}else this._bytecode=255,this._nextBCI=this._currentBCI},t}();!function(t){t[t.BKPT=1]="BKPT",t[t.NOP=2]="NOP",t[t.THROW=3]="THROW",t[t.GETSUPER=4]="GETSUPER",t[t.GETSUPER_DYN=260]="GETSUPER_DYN",t[t.SETSUPER=5]="SETSUPER",t[t.SETSUPER_DYN=261]="SETSUPER_DYN",t[t.DXNS=6]="DXNS",t[t.DXNSLATE=7]="DXNSLATE",t[t.KILL=8]="KILL",t[t.LABEL=9]="LABEL",t[t.LF32X4=10]="LF32X4",t[t.SF32X4=11]="SF32X4",t[t.IFNLT=12]="IFNLT",t[t.IFNLE=13]="IFNLE",t[t.IFNGT=14]="IFNGT",t[t.IFNGE=15]="IFNGE",t[t.JUMP=16]="JUMP",t[t.IFTRUE=17]="IFTRUE",t[t.IFFALSE=18]="IFFALSE",t[t.IFEQ=19]="IFEQ",t[t.IFNE=20]="IFNE",t[t.IFLT=21]="IFLT",t[t.IFLE=22]="IFLE",t[t.IFGT=23]="IFGT",t[t.IFGE=24]="IFGE",t[t.IFSTRICTEQ=25]="IFSTRICTEQ",t[t.IFSTRICTNE=26]="IFSTRICTNE",t[t.LOOKUPSWITCH=27]="LOOKUPSWITCH",t[t.PUSHWITH=28]="PUSHWITH",t[t.POPSCOPE=29]="POPSCOPE",t[t.NEXTNAME=30]="NEXTNAME",t[t.HASNEXT=31]="HASNEXT",t[t.PUSHNULL=32]="PUSHNULL",t[t.PUSHUNDEFINED=33]="PUSHUNDEFINED",t[t.PUSHFLOAT=34]="PUSHFLOAT",t[t.NEXTVALUE=35]="NEXTVALUE",t[t.PUSHBYTE=36]="PUSHBYTE",t[t.PUSHSHORT=37]="PUSHSHORT",t[t.PUSHTRUE=38]="PUSHTRUE",t[t.PUSHFALSE=39]="PUSHFALSE",t[t.PUSHNAN=40]="PUSHNAN",t[t.POP=41]="POP",t[t.DUP=42]="DUP",t[t.SWAP=43]="SWAP",t[t.PUSHSTRING=44]="PUSHSTRING",t[t.PUSHINT=45]="PUSHINT",t[t.PUSHUINT=46]="PUSHUINT",t[t.PUSHDOUBLE=47]="PUSHDOUBLE",t[t.PUSHSCOPE=48]="PUSHSCOPE",t[t.PUSHNAMESPACE=49]="PUSHNAMESPACE",t[t.HASNEXT2=50]="HASNEXT2",t[t.LI8=53]="LI8",t[t.LI16=54]="LI16",t[t.LI32=55]="LI32",t[t.LF32=56]="LF32",t[t.LF64=57]="LF64",t[t.SI8=58]="SI8",t[t.SI16=59]="SI16",t[t.SI32=60]="SI32",t[t.SF32=61]="SF32",t[t.SF64=62]="SF64",t[t.NEWFUNCTION=64]="NEWFUNCTION",t[t.CALL=65]="CALL",t[t.CONSTRUCT=66]="CONSTRUCT",t[t.CALLMETHOD=67]="CALLMETHOD",t[t.CALLSTATIC=68]="CALLSTATIC",t[t.CALLSUPER=69]="CALLSUPER",t[t.CALLSUPER_DYN=325]="CALLSUPER_DYN",t[t.CALLPROPERTY=70]="CALLPROPERTY",t[t.CALLPROPERTY_DYN=326]="CALLPROPERTY_DYN",t[t.RETURNVOID=71]="RETURNVOID",t[t.RETURNVALUE=72]="RETURNVALUE",t[t.CONSTRUCTSUPER=73]="CONSTRUCTSUPER",t[t.CONSTRUCTSUPER_DYN=329]="CONSTRUCTSUPER_DYN",t[t.CONSTRUCTPROP=74]="CONSTRUCTPROP",t[t.CONSTRUCTPROP_DYN=330]="CONSTRUCTPROP_DYN",t[t.CALLSUPERID=75]="CALLSUPERID",t[t.CALLPROPLEX=76]="CALLPROPLEX",t[t.CALLPROPLEX_DYN=332]="CALLPROPLEX_DYN",t[t.CALLINTERFACE=77]="CALLINTERFACE",t[t.CALLSUPERVOID=78]="CALLSUPERVOID",t[t.CALLSUPERVOID_DYN=334]="CALLSUPERVOID_DYN",t[t.CALLPROPVOID=79]="CALLPROPVOID",t[t.SXI1=80]="SXI1",t[t.SXI8=81]="SXI8",t[t.SXI16=82]="SXI16",t[t.APPLYTYPE=83]="APPLYTYPE",t[t.PUSHFLOAT4=84]="PUSHFLOAT4",t[t.NEWOBJECT=85]="NEWOBJECT",t[t.NEWARRAY=86]="NEWARRAY",t[t.NEWACTIVATION=87]="NEWACTIVATION",t[t.NEWCLASS=88]="NEWCLASS",t[t.GETDESCENDANTS=89]="GETDESCENDANTS",t[t.NEWCATCH=90]="NEWCATCH",t[t.FINDPROPSTRICT=93]="FINDPROPSTRICT",t[t.FINDPROPSTRICT_DYN=349]="FINDPROPSTRICT_DYN",t[t.FINDPROPERTY=94]="FINDPROPERTY",t[t.FINDPROPERTY_DYN=350]="FINDPROPERTY_DYN",t[t.FINDDEF=95]="FINDDEF",t[t.GETLEX=96]="GETLEX",t[t.GETLEX_DYN=352]="GETLEX_DYN",t[t.SETPROPERTY=97]="SETPROPERTY",t[t.SETPROPERTY_DYN=353]="SETPROPERTY_DYN",t[t.GETLOCAL=98]="GETLOCAL",t[t.SETLOCAL=99]="SETLOCAL",t[t.GETGLOBALSCOPE=100]="GETGLOBALSCOPE",t[t.GETSCOPEOBJECT=101]="GETSCOPEOBJECT",t[t.GETPROPERTY=102]="GETPROPERTY",t[t.GETPROPERTY_DYN=358]="GETPROPERTY_DYN",t[t.GETOUTERSCOPE=103]="GETOUTERSCOPE",t[t.INITPROPERTY=104]="INITPROPERTY",t[t.UNUSED_69=105]="UNUSED_69",t[t.DELETEPROPERTY=106]="DELETEPROPERTY",t[t.DELETEPROPERTY_DYN=362]="DELETEPROPERTY_DYN",t[t.UNUSED_6B=107]="UNUSED_6B",t[t.GETSLOT=108]="GETSLOT",t[t.SETSLOT=109]="SETSLOT",t[t.GETGLOBALSLOT=110]="GETGLOBALSLOT",t[t.SETGLOBALSLOT=111]="SETGLOBALSLOT",t[t.CONVERT_S=112]="CONVERT_S",t[t.ESC_XELEM=113]="ESC_XELEM",t[t.ESC_XATTR=114]="ESC_XATTR",t[t.CONVERT_I=115]="CONVERT_I",t[t.CONVERT_U=116]="CONVERT_U",t[t.CONVERT_D=117]="CONVERT_D",t[t.CONVERT_B=118]="CONVERT_B",t[t.CONVERT_O=119]="CONVERT_O",t[t.CHECKFILTER=120]="CHECKFILTER",t[t.CONVERT_F=121]="CONVERT_F",t[t.UNPLUS=122]="UNPLUS",t[t.CONVERT_F4=123]="CONVERT_F4",t[t.BC_7C=124]="BC_7C",t[t.BC_7D=125]="BC_7D",t[t.BC_7E=126]="BC_7E",t[t.BC_7F=127]="BC_7F",t[t.COERCE=128]="COERCE",t[t.COERCE_DYN=384]="COERCE_DYN",t[t.COERCE_B=129]="COERCE_B",t[t.COERCE_A=130]="COERCE_A",t[t.COERCE_I=131]="COERCE_I",t[t.COERCE_D=132]="COERCE_D",t[t.COERCE_S=133]="COERCE_S",t[t.ASTYPE=134]="ASTYPE",t[t.ASTYPELATE=135]="ASTYPELATE",t[t.COERCE_U=136]="COERCE_U",t[t.COERCE_O=137]="COERCE_O",t[t.NEGATE=144]="NEGATE",t[t.INCREMENT=145]="INCREMENT",t[t.INCLOCAL=146]="INCLOCAL",t[t.DECREMENT=147]="DECREMENT",t[t.DECLOCAL=148]="DECLOCAL",t[t.TYPEOF=149]="TYPEOF",t[t.NOT=150]="NOT",t[t.BITNOT=151]="BITNOT",t[t.UNUSED_98=152]="UNUSED_98",t[t.UNUSED_99=153]="UNUSED_99",t[t.UNUSED_9A=154]="UNUSED_9A",t[t.UNUSED_9B=155]="UNUSED_9B",t[t.UNUSED_9C=156]="UNUSED_9C",t[t.UNUSED_9D=157]="UNUSED_9D",t[t.UNUSED_9E=158]="UNUSED_9E",t[t.UNUSED_9F=159]="UNUSED_9F",t[t.ADD=160]="ADD",t[t.SUBTRACT=161]="SUBTRACT",t[t.MULTIPLY=162]="MULTIPLY",t[t.DIVIDE=163]="DIVIDE",t[t.MODULO=164]="MODULO",t[t.LSHIFT=165]="LSHIFT",t[t.RSHIFT=166]="RSHIFT",t[t.URSHIFT=167]="URSHIFT",t[t.BITAND=168]="BITAND",t[t.BITOR=169]="BITOR",t[t.BITXOR=170]="BITXOR",t[t.EQUALS=171]="EQUALS",t[t.STRICTEQUALS=172]="STRICTEQUALS",t[t.LESSTHAN=173]="LESSTHAN",t[t.LESSEQUALS=174]="LESSEQUALS",t[t.GREATERTHAN=175]="GREATERTHAN",t[t.GREATEREQUALS=176]="GREATEREQUALS",t[t.INSTANCEOF=177]="INSTANCEOF",t[t.ISTYPE=178]="ISTYPE",t[t.ISTYPELATE=179]="ISTYPELATE",t[t.IN=180]="IN",t[t.UNUSED_B5=181]="UNUSED_B5",t[t.UNUSED_B6=182]="UNUSED_B6",t[t.UNUSED_B7=183]="UNUSED_B7",t[t.UNUSED_B8=184]="UNUSED_B8",t[t.UNUSED_B9=185]="UNUSED_B9",t[t.UNUSED_BA=186]="UNUSED_BA",t[t.UNUSED_BB=187]="UNUSED_BB",t[t.UNUSED_BC=188]="UNUSED_BC",t[t.UNUSED_BD=189]="UNUSED_BD",t[t.UNUSED_BE=190]="UNUSED_BE",t[t.UNUSED_BF=191]="UNUSED_BF",t[t.INCREMENT_I=192]="INCREMENT_I",t[t.DECREMENT_I=193]="DECREMENT_I",t[t.INCLOCAL_I=194]="INCLOCAL_I",t[t.DECLOCAL_I=195]="DECLOCAL_I",t[t.NEGATE_I=196]="NEGATE_I",t[t.ADD_I=197]="ADD_I",t[t.SUBTRACT_I=198]="SUBTRACT_I",t[t.MULTIPLY_I=199]="MULTIPLY_I",t[t.UNUSED_C8=200]="UNUSED_C8",t[t.UNUSED_C9=201]="UNUSED_C9",t[t.UNUSED_CA=202]="UNUSED_CA",t[t.UNUSED_CB=203]="UNUSED_CB",t[t.UNUSED_CC=204]="UNUSED_CC",t[t.UNUSED_CD=205]="UNUSED_CD",t[t.UNUSED_CE=206]="UNUSED_CE",t[t.UNUSED_CF=207]="UNUSED_CF",t[t.GETLOCAL0=208]="GETLOCAL0",t[t.GETLOCAL1=209]="GETLOCAL1",t[t.GETLOCAL2=210]="GETLOCAL2",t[t.GETLOCAL3=211]="GETLOCAL3",t[t.SETLOCAL0=212]="SETLOCAL0",t[t.SETLOCAL1=213]="SETLOCAL1",t[t.SETLOCAL2=214]="SETLOCAL2",t[t.SETLOCAL3=215]="SETLOCAL3",t[t.UNUSED_D8=216]="UNUSED_D8",t[t.UNUSED_D9=217]="UNUSED_D9",t[t.UNUSED_DA=218]="UNUSED_DA",t[t.UNUSED_DB=219]="UNUSED_DB",t[t.UNUSED_DC=220]="UNUSED_DC",t[t.UNUSED_DD=221]="UNUSED_DD",t[t.UNUSED_DE=222]="UNUSED_DE",t[t.UNUSED_DF=223]="UNUSED_DF",t[t.UNUSED_E0=224]="UNUSED_E0",t[t.UNUSED_E1=225]="UNUSED_E1",t[t.UNUSED_E2=226]="UNUSED_E2",t[t.UNUSED_E3=227]="UNUSED_E3",t[t.UNUSED_E4=228]="UNUSED_E4",t[t.UNUSED_E5=229]="UNUSED_E5",t[t.UNUSED_E6=230]="UNUSED_E6",t[t.UNUSED_E7=231]="UNUSED_E7",t[t.UNUSED_E8=232]="UNUSED_E8",t[t.UNUSED_E9=233]="UNUSED_E9",t[t.UNUSED_EA=234]="UNUSED_EA",t[t.UNUSED_EB=235]="UNUSED_EB",t[t.UNUSED_EC=236]="UNUSED_EC",t[t.UNUSED_ED=237]="UNUSED_ED",t[t.UNUSED_EE=238]="UNUSED_EE",t[t.INVALID=237]="INVALID",t[t.DEBUG=239]="DEBUG",t[t.DEBUGLINE=240]="DEBUGLINE",t[t.DEBUGFILE=241]="DEBUGFILE",t[t.BKPTLINE=242]="BKPTLINE",t[t.TIMESTAMP=243]="TIMESTAMP",t[t.RESTARGC=244]="RESTARGC",t[t.RESTARG=245]="RESTARG",t[t.UNUSED_F6=246]="UNUSED_F6",t[t.UNUSED_F7=247]="UNUSED_F7",t[t.UNUSED_F8=248]="UNUSED_F8",t[t.UNUSED_F9=249]="UNUSED_F9",t[t.UNUSED_FA=250]="UNUSED_FA",t[t.UNUSED_FB=251]="UNUSED_FB",t[t.UNUSED_FC=252]="UNUSED_FC",t[t.UNUSED_FD=253]="UNUSED_FD",t[t.UNUSED_FE=254]="UNUSED_FE",t[t.END=255]="END"}(JT||(JT={}));var $T=function(){},tP=function(t){function e(e,i,n,r,o,s,a,l){var u=t.call(this)||this;return u.abc=e,u.name=i,u.superName=n,u.flags=r,u.protectedNs=o,u.interfaceNameIndices=s,u.initializer=a,u.traits=l,u.classInfo=null,u.runtimeTraits=null,u._interfaces=null,u}return i(e,t),e.prototype.getInitializer=function(){return"number"==typeof this.initializer&&(this.initializer=this.abc.getMethodInfo(this.initializer),this.initializer.instanceInfo=this,this.initializer.isConstructor=!0),this.initializer},e.prototype.getName=function(){return"number"==typeof this.name&&(this.name=this.abc.getMultiname(this.name)),this.name},e.prototype.getClassName=function(){var t=this.getName();return t.namespaces[0].uri?t.namespaces[0].uri+"."+t.name:t.name},e.prototype.getSuperName=function(){return"number"==typeof this.superName&&(this.superName=this.abc.getMultiname(this.superName)),this.superName},e.prototype.getInterfaces=function(t){if(this._interfaces)return this._interfaces;var e,i=t.superClass;i&&(e=i.classInfo.instanceInfo.getInterfaces(i));for(var n=Set,r=this._interfaces=new n(e),o=0;o<this.interfaceNameIndices.length;o++){var s=this.abc.getMultiname(this.interfaceNameIndices[o]),a=this.abc.applicationDomain.getClass(s);r.add(a),a.classInfo.instanceInfo.getInterfaces(a).forEach((function(t){return r.add(t)}))}return r},e.prototype.toString=function(){return"InstanceInfo "+this.getName().name},e.prototype.toFlashlogString=function(){return this.getName().toFlashlogString()},e.prototype.trace=function(t){t.enter("InstanceInfo: "+this.getName()),this.superName&&t.writeLn("Super: "+this.getSuperName()),this.traits.trace(t),t.outdent()},e.prototype.isInterface=function(){return!!(4&this.flags)},e.prototype.isSealed=function(){return!!(1&this.flags)},e.prototype.isFinal=function(){return!!(2&this.flags)},e}($T),eP=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.abc=e,o.instanceInfo=i,o.initializer=n,o.traits=r,o.trait=null,o.runtimeTraits=null,o}return i(e,t),e.prototype.getNativeMetadata=function(){if(!this.trait)return null;var t=this.trait.getMetadata();if(!t)return null;for(var e=0;e<t.length;e++)if("native"===t[e].getName())return t[e];return null},e.prototype.getInitializer=function(){return"number"==typeof this.initializer&&(this.initializer=this.abc.getMethodInfo(this.initializer),this.initializer.classInfo=this),this.initializer},e.prototype.toString=function(){return"ClassInfo "+this.instanceInfo.getName()},e.prototype.trace=function(t){t.enter("ClassInfo"),this.traits.trace(t),t.outdent()},e}($T);var iP=function(){function t(t,e,i){this.abc=t,this.kind=e,this.name=i,this.metadata=null,this.holder=null}return t.prototype.getMetadata=function(){if(!this.metadata)return null;if(this.metadata instanceof Uint32Array){for(var t=new Array(this.metadata.length),e=0;e<this.metadata.length;e++)t[e]=this.abc.getMetadataInfo(this.metadata[e]);this.metadata=t}return this.metadata},t.prototype.getName=function(){return this.name},t.prototype.resolve=function(){"number"==typeof this.name&&(this.name=this.abc.getMultiname(this.name))},t.prototype.toString=function(){return t=this.kind,String(t)+" "+this.name;var t},t.prototype.toFlashlogString=function(){return this.resolve(),this.getName().toFlashlogString()},t.prototype.isConst=function(){return 6===this.kind},t.prototype.isSlot=function(){return 0===this.kind},t.prototype.isMethod=function(){return 1===this.kind},t.prototype.isGetter=function(){return 2===this.kind},t.prototype.isSetter=function(){return 3===this.kind},t.prototype.isAccessor=function(){return 2===this.kind||3===this.kind},t.prototype.isMethodOrAccessor=function(){return this.isAccessor()||1===this.kind},t}(),nP=function(t){function e(e,i,n,r){var o=t.call(this,e,i,n)||this;return o.methodInfo=r,o.method=null,o}return i(e,t),e.prototype.getMethodInfo=function(){return this.methodInfo},e.prototype.resolve=function(){t.prototype.resolve.call(this),"number"==typeof this.methodInfo&&(this.methodInfo=this.abc.getMethodInfo(this.methodInfo))},e}(iP),rP=JT,oP=function(){function t(t,e,i,n,r,o,s){void 0===i&&(i=[]),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=!1),void 0===s&&(s=[]),this.position=t,this.name=e,this.params=i,this.delta=n,this.deltaScope=r,this.terminal=o,this.refs=s,this.stack=-1024,this.scope=-1024,this.catchStart=!1,this.catchEnd=!1,this.returnTypeId=-1,this.childs=[]}return t.prototype.toString=function(){return"Instruction("+this.position+", "+rP[this.name]+" ("+this.name+"), ["+this.params+"], "+this.stack+" -> "+(this.stack+this.delta)+", "+this.scope+" -> "+(this.scope+this.deltaScope)+", "+this.terminal+", ["+this.refs+"])"},t}();function sP(t,e,i){for(var n=e,r=i.length,o=e,s=0;s<r;s++)if(i[s].position>=t){if(i[s].stack>=0)return o;i[s].stack=n,(n+=i[s].delta)<o&&(o=n);for(var a=0;a<i[s].refs.length;a++){var l=sP(i[s].refs[a],n,i);l<o&&(o=l)}if(i[s].terminal)return o}return o}function aP(t,e,i){for(var n=e,r=i.length,o=0;o<r;o++)if(i[o].position>=t){if(i[o].scope>=0)return;i[o].scope=n,n+=i[o].deltaScope;for(var s=0;s<i[o].refs.length;s++)aP(i[o].refs[s],n,i);if(i[o].terminal)return}}function lP(t){for(var e,i,n,r,o,s,a,l,u,c=t.abc,h=t.getBody(),p=h.code,d=[],f=0,_=0,m=function(t){var h,m,g,y,A,v,b,x,C,w,I,E,S,D,T,P,B,M=function(){var e=p[t++];return 128&e&&16384&(e=127&e|p[t++]<<7)&&2097152&(e=16383&e|p[t++]<<14)&&268435456&(e=2097151&e|p[t++]<<21)&&(e=268435455&e|p[t++]<<28,e&=4294967295),e>>>0},O=function(){var t=M(),e=c.getMultiname(t);return e.isRuntimeName()||e.isRuntimeNamespace()?[t,256,e.isRuntimeName()&&e.isRuntimeNamespace()?-2:-1]:[t,0,0]},L=function(){return(p[t++]|p[t++]<<8|p[t++]<<16)<<8>>8},R=function(){return p[t++]<<24>>24},N=t,F=p[t++],k=void 0;switch(F){case JT.LABEL:k=new oP(N,F);break;case JT.DXNSLATE:k=new oP(N,F,[0],-1);break;case JT.DEBUGFILE:case JT.DEBUGLINE:k=new oP(N,F,[M()]);break;case JT.DEBUG:k=new oP(N,F,[R(),M(),R(),M()]);break;case JT.THROW:k=new oP(N,F,[],-1,0,!0);break;case JT.PUSHSCOPE:(k=new oP(N,F,[],-1,1)).returnTypeId=_=++f;break;case JT.PUSHWITH:k=new oP(N,F,[],-1,1);break;case JT.POPSCOPE:k=new oP(N,F,[],0,-1);break;case JT.GETSCOPEOBJECT:(k=new oP(N,F,[R()],1,0)).returnTypeId=_=++f;break;case JT.GETGLOBALSCOPE:(k=new oP(N,F,[],1)).returnTypeId=_=++f;break;case JT.GETSLOT:(k=new oP(N,F,[M()],0)).returnTypeId=_=++f;break;case JT.SETSLOT:k=new oP(N,F,[M()],-2);break;case JT.NEXTNAME:case JT.NEXTVALUE:(k=new oP(N,F,[],-1)).returnTypeId=_=++f;break;case JT.HASNEXT:(k=new oP(N,F,[],-1)).returnTypeId=_=-2;break;case JT.HASNEXT2:(k=new oP(N,F,[M(),M()],1)).returnTypeId=_=-2;break;case JT.IN:(k=new oP(N,F,[],-1)).returnTypeId=_=-2;break;case JT.DUP:(k=new oP(N,F,[],1)).returnTypeId=_=f;break;case JT.POP:(k=new oP(N,F,[],-1)).returnTypeId=_=f;break;case JT.SWAP:k=new oP(N,F,[],0);break;case JT.PUSHTRUE:case JT.PUSHFALSE:(k=new oP(N,F,[],1)).returnTypeId=_=-2;break;case JT.PUSHBYTE:(k=new oP(N,F,[R()],1)).returnTypeId=_=-3;break;case JT.PUSHSHORT:(k=new oP(N,F,[M()<<16>>16],1)).returnTypeId=_=-3;break;case JT.PUSHINT:case JT.PUSHUINT:case JT.PUSHDOUBLE:(k=new oP(N,F,[M()],1)).returnTypeId=_=-3;break;case JT.PUSHNAN:(k=new oP(N,F,[],1)).returnTypeId=_=-3;break;case JT.PUSHNULL:(k=new oP(N,F,[],1)).returnTypeId=_=-6;break;case JT.PUSHUNDEFINED:(k=new oP(N,F,[],1)).returnTypeId=_=-5;break;case JT.PUSHSTRING:(k=new oP(N,F,[M()],1)).returnTypeId=_=-4;break;case JT.IFEQ:case JT.IFNE:case JT.IFSTRICTEQ:case JT.IFSTRICTNE:r=L(),k=new oP(N,F,[t+r],-2,0,!1,[t+r]);break;case JT.IFGT:case JT.IFNLE:r=L(),k=new oP(N,JT.IFGT,[t+r],-2,0,!1,[t+r]);break;case JT.IFGE:case JT.IFNLT:r=L(),k=new oP(N,JT.IFGE,[t+r],-2,0,!1,[t+r]);break;case JT.IFLT:case JT.IFNGE:r=L(),k=new oP(N,JT.IFLT,[t+r],-2,0,!1,[t+r]);break;case JT.IFLE:case JT.IFNGT:r=L(),k=new oP(N,JT.IFLE,[t+r],-2,0,!1,[t+r]);break;case JT.IFTRUE:case JT.IFFALSE:r=L(),k=new oP(N,F,[t+r],-1,0,!1,[t+r]);break;case JT.LOOKUPSWITCH:e=N+L(),i=M(),n=[e];for(var V=0;V<=i;V++)n.push(N+L());k=new oP(N,F,n,-1,0,!0,n);break;case JT.JUMP:r=L(),k=new oP(N,F,[t+r],0,0,!0,[t+r]);break;case JT.RETURNVALUE:k=new oP(N,F,[],-1,0,!0);break;case JT.RETURNVOID:k=new oP(N,F,[],0,0,!0);break;case JT.NOT:(k=new oP(N,F,[],0)).returnTypeId=_=-2;break;case JT.BITNOT:case JT.NEGATE:case JT.INCREMENT:case JT.DECREMENT:(k=new oP(N,F,[],0)).returnTypeId=_=-3;break;case JT.INCLOCAL:case JT.DECLOCAL:(k=new oP(N,F,[M()],0)).returnTypeId=_=-3;break;case JT.INCREMENT_I:case JT.DECREMENT_I:(k=new oP(N,F,[],0)).returnTypeId=_=-3;break;case JT.INCLOCAL_I:case JT.DECLOCAL_I:(k=new oP(N,F,[M()],0)).returnTypeId=_=-3;break;case JT.NEGATE_I:(k=new oP(N,F,[],0)).returnTypeId=_=-3;break;case JT.ADD_I:case JT.SUBTRACT_I:case JT.MULTIPLY_I:case JT.ADD:case JT.SUBTRACT:case JT.MULTIPLY:case JT.DIVIDE:case JT.MODULO:case JT.LSHIFT:case JT.RSHIFT:case JT.URSHIFT:case JT.BITAND:case JT.BITOR:case JT.BITXOR:(k=new oP(N,F,[],-1)).returnTypeId=_=-3;break;case JT.EQUALS:case JT.STRICTEQUALS:case JT.GREATERTHAN:case JT.GREATEREQUALS:case JT.LESSTHAN:case JT.LESSEQUALS:(k=new oP(N,F,[],-1)).returnTypeId=_=-2;break;case JT.TYPEOF:(k=new oP(N,F,[],0)).returnTypeId=_=++f;break;case JT.INSTANCEOF:(k=new oP(N,F,[],-1)).returnTypeId=_=-2;break;case JT.ISTYPE:h=O(),s=h[0],a=h[1],l=h[2],(k=new oP(N,F,[s],0+l)).returnTypeId=_=-2;break;case JT.ISTYPELATE:(k=new oP(N,F,[],-1)).returnTypeId=_=-2;break;case JT.ASTYPELATE:k=new oP(N,F,[],-1);break;case JT.ASTYPE:m=O(),s=m[0],a=m[1],l=m[2],k=new oP(N,F,[s],0+l);break;case JT.CALL:o=M(),k=new oP(N,F,[o],-o-1);break;case JT.CONSTRUCT:o=M(),(k=new oP(N,F,[o,s],-o)).returnTypeId=_=++f;break;case JT.CALLPROPERTY:g=O(),s=g[0],a=g[1],l=g[2],o=M(),(k=new oP(N,F+a,[o,s],-o+l)).returnTypeId=_=++f;break;case JT.CALLPROPLEX:y=O(),s=y[0],a=y[1],l=y[2],o=M(),(k=new oP(N,F+a,[o,s],-o+l)).returnTypeId=_=++f;break;case JT.CALLPROPVOID:A=O(),s=A[0],a=A[1],l=A[2],o=M(),k=new oP(N,F+a,[o,s],-(o+1)+l);break;case JT.APPLYTYPE:o=M(),(k=new oP(N,F,[o],-o)).returnTypeId=_=f;break;case JT.FINDPROPSTRICT:v=O(),s=v[0],a=v[1],l=v[2],(k=new oP(N,F+a,[s],1+l)).returnTypeId=_=++f;break;case JT.FINDPROPERTY:b=O(),s=b[0],a=b[1],l=b[2],(k=new oP(N,F+a,[s],1+l)).returnTypeId=_=++f;break;case JT.NEWFUNCTION:(k=new oP(N,F,[M()],1)).returnTypeId=_=++f;break;case JT.NEWCLASS:case JT.GETDESCENDANTS:(k=new oP(N,F,[M()],0)).returnTypeId=_=++f;break;case JT.NEWARRAY:o=M(),(k=new oP(N,F,[o],1-o)).returnTypeId=_=++f;break;case JT.NEWOBJECT:o=M(),(k=new oP(N,F,[o],-2*o+1)).returnTypeId=_=++f;break;case JT.NEWACTIVATION:(k=new oP(N,F,[],1)).returnTypeId=_=++f;break;case JT.NEWCATCH:k=new oP(N,F,[M()],1);break;case JT.CONSTRUCTSUPER:o=M(),k=new oP(N,F,[o],-(o+1));break;case JT.CALLSUPER:x=O(),s=x[0],a=x[1],l=x[2],o=M(),k=new oP(N,F+a,[o,s],-o+l);break;case JT.CALLSUPERVOID:C=O(),s=C[0],a=C[1],l=C[2],o=M(),k=new oP(N,F+a,[o,s],-(o+1)+l);break;case JT.CONSTRUCTPROP:w=O(),s=w[0],a=w[1],l=w[2],o=M(),(k=new oP(N,F+a,[o,s],-o+l)).returnTypeId=_=++f;break;case JT.GETPROPERTY:I=O(),s=I[0],a=I[1],l=I[2],(k=new oP(N,JT.GETPROPERTY+a,[s],0+l)).returnTypeId=_=++f;break;case JT.INITPROPERTY:case JT.SETPROPERTY:E=O(),s=E[0],a=E[1],l=E[2],k=new oP(N,JT.SETPROPERTY+a,[s],-2+l);break;case JT.DELETEPROPERTY:S=O(),s=S[0],a=S[1],l=S[2],k=new oP(N,F+a,[s],0+l);break;case JT.GETSUPER:D=O(),s=D[0],a=D[1],l=D[2],(k=new oP(N,F+a,[s],0+l)).returnTypeId=_=++f;break;case JT.SETSUPER:T=O(),s=T[0],a=T[1],l=T[2],k=new oP(N,F+a,[s],-2+l);break;case JT.COERCE:P=O(),s=P[0],a=P[1],l=P[2],(k=new oP(N,F+a,[s],0+l)).returnTypeId=_;break;case JT.COERCE_A:(k=new oP(N,F,[],0)).returnTypeId=_;break;case JT.COERCE_S:(k=new oP(N,F,[],0)).returnTypeId=-4;break;case JT.ESC_XATTR:case JT.ESC_XELEM:case JT.CONVERT_I:case JT.CONVERT_D:case JT.CONVERT_B:case JT.CONVERT_U:case JT.CONVERT_S:case JT.CONVERT_O:case JT.CHECKFILTER:k=new oP(N,F,[],0);break;case JT.GETLOCAL:(k=new oP(N,JT.GETLOCAL,[M()],1)).returnTypeId=_;break;case JT.GETLOCAL0:(k=new oP(N,JT.GETLOCAL,[0],1)).returnTypeId=_;break;case JT.GETLOCAL1:(k=new oP(N,JT.GETLOCAL,[1],1)).returnTypeId=_;break;case JT.GETLOCAL2:(k=new oP(N,JT.GETLOCAL,[2],1)).returnTypeId=_;break;case JT.GETLOCAL3:(k=new oP(N,JT.GETLOCAL,[3],1)).returnTypeId=_;break;case JT.SETLOCAL:(k=new oP(N,JT.SETLOCAL,[M()],-1)).returnTypeId=_;break;case JT.SETLOCAL0:(k=new oP(N,JT.SETLOCAL,[0],-1)).returnTypeId=_;break;case JT.SETLOCAL1:(k=new oP(N,JT.SETLOCAL,[1],-1)).returnTypeId=_;break;case JT.SETLOCAL2:(k=new oP(N,JT.SETLOCAL,[2],-1)).returnTypeId=_;break;case JT.SETLOCAL3:(k=new oP(N,JT.SETLOCAL,[3],-1)).returnTypeId=_;break;case JT.KILL:k=new oP(N,F,[M()],0);break;case JT.GETLEX:B=O(),s=B[0],a=B[1],l=B[2],(k=new oP(N,F+a,[s],1+l)).returnTypeId=_=++f;break;case JT.SI8:case JT.SI16:case JT.SI32:case JT.SF32:case JT.SF64:k=new oP(N,F,[],-2);break;case JT.LI8:case JT.LI16:case JT.LI32:case JT.LF32:case JT.LF64:(k=new oP(N,F,[],0)).returnTypeId=_=-3;break;default:return{value:{error:{message:"UNKNOWN BYTECODE "+p[t-1].toString(16)+" "+rP[p[t-1]]+" at "+N,reason:"unknow_bytecode"}}}}d.push(k),u=t},g=0;g<p.length;){var y=m(g);if(g=u,"object"==typeof y)return y.value}var A=sP(0,0,d);aP(0,0,d);var v,b,x=[0];for(g=0;g<d.length;g++)for(var C=0;C<d[g].refs.length;C++)x.push(d[g].refs[C]);if(h.catchBlocks.length){v={},b={};for(g=0;g<h.catchBlocks.length;g++){for(var w=h.catchBlocks[g],I=0,E=-1,S=-1,D=0,T=0;T<d.length;T++){if((P=d[T].position)>w.start){E=P;break}I=d[T].stack,D=d[T].scope}for(T=d.length-1;T>=0;T--){var P;if((P=d[T].position)<=w.end){S=P;break}}v[E]||(v[E]=[]),v[E].push(w),b[S]||(b[S]=[]),b[S].push(w);var B=sP(w.target,I+1,d);B<A&&(A=B),aP(w.target,D,d),x.push(w.target)}}return function(t,e){var i={},n=[];i[0]=0;for(var r=t.length,o=1;o<r;o++){var s=t[o];e.indexOf(s.position)>-1&&(i[s.position]=o),s.name>=JT.IFNLT&&s.name<=JT.LOOKUPSWITCH&&n.push(s)}for(var a=0,l=n;a<l.length;a++){var u=l[a];if(u.name!==JT.LOOKUPSWITCH)u.name!==JT.JUMP?u.childs.push(i[u.params[0]]):u.childs=[i[u.params[0]]];else{var c=u.params;u.childs=[];for(o=0;o<c.length-1;o++)u.childs.push(i[o])}}}(d,x),{set:d,jumps:x,catchStart:v,catchEnd:b,error:A<0?{message:"Stack underrun while preprocess, stack:"+A,reason:"underrun"}:null}}var uP=function(){function t(){}return t.prototype.test=function(t){if(!t.isConstructor)return!1;if(t.parameters.length>0)return!1;var e=t.getBody();return!(e.maxStack>1)&&(!(e.localCount>1)&&(!(e.maxScopeDepth-e.initScopeDepth>1)&&!(e.code.length>6)))},t.prototype.getBody=function(t){return this.test(t)?function(t){return function(){t.savedScope.superConstructor.call(this)}}:null},t}(),cP=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.test=function(t){var e;return t.namespaces&&(null===(e=t.namespace)||void 0===e?void 0:e.uri)&&t.namespace.uri.includes("TweenLite")},e}(function(){function t(){this._block=null,this._used=!1,this._needSafe=!1}return t.prototype.test=function(t){return!1},t.prototype.markToSafe=function(t){return this._needSafe=this.test(t)},t.prototype.drop=function(){this._used||(this._needSafe=!1,this._block=void 0)},t.prototype.safe=function(t){return this._block={alias:t},this._used=!1,!0},t.prototype.needSafe=function(t){return this._needSafe&&this._block&&this._block.alias===t},t.prototype.beginSafeBlock=function(t){return this.needSafe(t)?(this._used=!0,"if("+this._block.alias+" != undefined) {"):""},t.prototype.endSafeBlock=function(t){if(!this._used)return"";var e=t?"} else { "+this._block.alias+" = "+t+"; }":"}";return this._used=!1,this._block=void 0,e},t.prototype.reset=function(){this._block=null,this._needSafe=!1,this._used=!1},t}()),hP=function(){function t(t,e){void 0===e&&(e=null),this.lexer=t,this.scope=e,this.safeIntrDistance=20,this._active={},this._imports=[]}return t.prototype.checkNameToCall=function(t,e,i){if(void 0===i&&(i=!1),!this.scope)return!1;var n=this.scope.findScopeProperty(t,!0,!1);return i?n&&n[t.getMangledName()]&&"function"==typeof n[t.getMangledName()][e]:n&&"function"==typeof n[e]},t.prototype.mark=function(t,e,i,n,r){void 0===n&&(n=null),void 0===r&&(r=!1),this._active[t]={alias:t,index:e,name:n,isMangled:i,fromLex:r}},t.prototype.sureThatFast=function(t,e){var i=this._active[t];return!i||e&&!i.name?null:(e&&this.checkNameToCall(i.name,e,i.fromLex)&&(i.isFunc=!0),i)},t.prototype.getMethodAlias=function(t,e){var i=this._active[t];if(!i||!i.isFunc||!i.name)return null;var n=this.lexer.findAliases(i.name,!1)[0];if(!n)return null;var r=n.alias,o=r+"_"+e,s=this._imports.find((function(t){return t.methodAlias===o}));return s?s.methodAlias:(i.methodAlias=o,i.methodImport=r+"."+e,this._imports.push(i),o)},t.prototype.kill=function(t){delete this._active[t]},t.prototype.killFar=function(t){for(var e=0,i=Object.keys(this._active);e<i.length;e++){var n=i[e];t-this._active[n].index>=this.safeIntrDistance&&delete this._active[n]}},t.prototype.genHeader=function(t){for(var e=[t+" /* "+this.constructor.name+" */"],i=0,n=this._imports;i<n.length;i++){var r=n[i];e.push(t+" const "+r.methodAlias+" = "+r.methodImport+";")}return e.push("\n"),e.join("\n")},t.prototype.genBody=function(){return""},t.prototype.drop=function(){this._active={}},t.prototype.reset=function(){this._active={},this._imports=[]},t}(),pP=function(){function t(){}return t.begin=function(t){var e=performance.now();this._currentTask={name:t,start:e,droped:!1},this._firstCompilerRun<0&&(this._firstCompilerRun=e)},t.drop=function(){this._currentTask&&(this._currentTask.droped=!0,this.end())},t.end=function(){if(this._currentTask){var t=performance.now(),e=t-this._currentTask.start,i=this.statRecords;t-this._lastCompilerStop<this.TASK_DELAY?this._taskBathTime+=e:this._taskBathTime=0,i.runs++,i.drops+=+this._currentTask.droped,i.totalCompileTime+=e,i.minCompileTime=i.minCompileTime>e?e:i.minCompileTime,i.maxCompileTime=i.minCompileTime<e?e:i.minCompileTime,i.overhead=100*i.totalCompileTime/(this._lastCompilerStop-this._firstCompilerRun),i.maxCompilerBatchTime=this._taskBathTime>i.maxCompilerBatchTime?this._taskBathTime:i.maxCompilerBatchTime,this._lastCompilerStop=t,this._currentTask=null}},t.reset=function(){Object.assign(this.statRecords,{compiled:0,droped:0,minCompileTime:Number.MAX_VALUE,maxCompileTime:-Number.MAX_VALUE,totalCompileTime:-0,maxCompilerTaskTime:-Number.MAX_VALUE,overhead:0}),this._currentTask=null,this._taskBathTime=0},t.TASK_DELAY=10,t.statRecords={runs:0,drops:0,minCompileTime:Number.MAX_VALUE,maxCompileTime:-Number.MAX_VALUE,totalCompileTime:-0,maxCompilerBatchTime:-Number.MAX_VALUE,overhead:0},t._firstCompilerRun=-1,t._lastCompilerStop=-1,t._taskBathTime=0,t}();window.AWAY_COMPILER_STAT=pP;var dP=function(){function t(t,e,i){if(void 0===t&&(t=0),void 0===e&&(e=null),void 0===i&&(i=null),this.col1=new _P,this.col2=new _P,null!=e&&null!=i)this.col1.SetV(e),this.col2.SetV(i);else{var n=Math.cos(t),r=Math.sin(t);this.col1.x=n,this.col2.x=-r,this.col1.y=r,this.col2.y=n}}return t.prototype.Set=function(t){var e=Math.cos(t),i=Math.sin(t);this.col1.x=e,this.col2.x=-i,this.col1.y=i,this.col2.y=e},t.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},t.prototype.Copy=function(){return new t(0,this.col1,this.col2)},t.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},t.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},t.prototype.Invert=function(t){var e=this.col1.x,i=this.col2.x,n=this.col1.y,r=this.col2.y,o=e*r-i*n;return o=1/o,t.col1.x=o*r,t.col2.x=-o*i,t.col1.y=-o*n,t.col2.y=o*e,t},t.prototype.Solve=function(t,e,i){var n=this.col1.x,r=this.col2.x,o=this.col1.y,s=this.col2.y,a=n*s-r*o;return a=1/a,t.x=a*(s*e-r*i),t.y=a*(n*i-o*e),t},t.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},t}(),fP=function(){function t(){this.__fast__=!0,this.localCenter=new _P,this.c0=new _P,this.c=new _P}return t.prototype.GetXForm=function(t,e){if(1-this.t0>Number.MIN_VALUE){var i=(e-this.t0)/(1-this.t0);t.position.x=(1-i)*this.c0.x+i*this.c.x,t.position.y=(1-i)*this.c0.y+i*this.c.y;var n=(1-i)*this.a0+i*this.a;t.R.Set(n)}else t.position.SetV(this.c),t.R.Set(this.a);var r=t.R;t.position.x-=r.col1.x*this.localCenter.x+r.col2.x*this.localCenter.y,t.position.y-=r.col1.y*this.localCenter.x+r.col2.y*this.localCenter.y},t.prototype.Advance=function(t){if(this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}},t}(),_P=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.__fast__=!0,this.x=t,this.y=e}return t.prototype.SetZero=function(){this.x=0,this.y=0},t.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},t.prototype.SetV=function(t){this.x=t.x,this.y=t.y},t.prototype.Negative=function(){return new t(-this.x,-this.y)},t.Make=function(e,i){return new t(e,i)},t.prototype.Copy=function(){return new t(this.x,this.y)},t.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},t.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},t.prototype.Multiply=function(t){this.x*=t,this.y*=t},t.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y,this.y=t.col1.y*e+t.col2.y*this.y},t.prototype.MulTM=function(t){var e=gP.b2Dot(this,t.col1);this.y=gP.b2Dot(this,t.col2),this.x=e},t.prototype.CrossVF=function(t){var e=this.x;this.x=t*this.y,this.y=-t*e},t.prototype.CrossFV=function(t){var e=this.x;this.x=-t*this.y,this.y=t*e},t.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},t.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},t.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},t.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},t.prototype.IsValid=function(){return gP.b2IsValid(this.x)&&gP.b2IsValid(this.y)},t}(),mP=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.position=new _P,this.R=new dP,t&&(this.position.SetV(t),this.R.SetM(e))}return t.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},t.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},t.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},t}(),gP=function(){function t(){}return t.b2IsValid=function(t){return isFinite(t)},t.b2Dot=function(t,e){return t.x*e.x+t.y*e.y},t.b2CrossVV=function(t,e){return t.x*e.y-t.y*e.x},t.b2CrossVF=function(t,e){return new _P(e*t.y,-e*t.x)},t.b2CrossFV=function(t,e){return new _P(-t*e.y,t*e.x)},t.b2MulMV=function(t,e){return new _P(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y)},t.b2MulTMV=function(t,e){return new _P(this.b2Dot(e,t.col1),this.b2Dot(e,t.col2))},t.b2MulX=function(t,e){var i=this.b2MulMV(t.R,e);return i.x+=t.position.x,i.y+=t.position.y,i},t.b2MulXT=function(t,e){var i=this.SubtractVV(e,t.position),n=i.x*t.R.col1.x+i.y*t.R.col1.y;return i.y=i.x*t.R.col2.x+i.y*t.R.col2.y,i.x=n,i},t.AddVV=function(t,e){return new _P(t.x+e.x,t.y+e.y)},t.SubtractVV=function(t,e){return new _P(t.x-e.x,t.y-e.y)},t.b2Distance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},t.b2DistanceSquared=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},t.MulFV=function(t,e){return new _P(t*e.x,t*e.y)},t.AddMM=function(t,e){return new dP(0,this.AddVV(t.col1,e.col1),this.AddVV(t.col2,e.col2))},t.b2MulMM=function(t,e){return new dP(0,this.b2MulMV(t,e.col1),this.b2MulMV(t,e.col2))},t.b2MulTMM=function(t,e){var i=new _P(this.b2Dot(t.col1,e.col1),this.b2Dot(t.col2,e.col1)),n=new _P(this.b2Dot(t.col1,e.col2),this.b2Dot(t.col2,e.col2));return new dP(0,i,n)},t.b2Abs=function(t){return t>0?t:-t},t.b2AbsV=function(t){return new _P(this.b2Abs(t.x),this.b2Abs(t.y))},t.b2AbsM=function(t){return new dP(0,this.b2AbsV(t.col1),this.b2AbsV(t.col2))},t.b2Min=function(t,e){return t<e?t:e},t.b2MinV=function(t,e){return new _P(this.b2Min(t.x,e.x),this.b2Min(t.y,e.y))},t.b2Max=function(t,e){return t>e?t:e},t.b2MaxV=function(t,e){return new _P(this.b2Max(t.x,e.x),this.b2Max(t.y,e.y))},t.b2Clamp=function(t,e,i){return this.b2Max(e,this.b2Min(t,i))},t.b2ClampV=function(t,e,i){return this.b2MaxV(e,this.b2MinV(t,i))},t.b2Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},t.b2Random=function(){return 2*Math.random()-1},t.b2RandomRange=function(t,e){var i=Math.random();return i=(e-t)*i+t},t.b2NextPowerOfTwo=function(t){return t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,(t|=t>>16&65535)+1},t.b2IsPowerOfTwo=function(t){return t>0&&0==(t&t-1)},t.b2Vec2_zero=new _P(0,0),t.b2Mat22_identity=new dP(0,new _P(1,0),new _P(0,1)),t.b2XForm_identity=new mP(t.b2Vec2_zero,t.b2Mat22_identity),t}(),yP=function(){function t(){}return t.b2Assert=function(t){if(!t){(void 0).x++}},t.USHRT_MAX=65535,t.b2_pi=Math.PI,t.b2_maxManifoldPoints=2,t.b2_maxPolygonVertices=8,t.b2_maxProxies=512,t.b2_maxPairs=8*t.b2_maxProxies,t.b2_linearSlop=.005,t.b2_angularSlop=2/180*t.b2_pi,t.b2_toiSlop=8*t.b2_linearSlop,t.b2_maxTOIContactsPerIsland=32,t.b2_velocityThreshold=1,t.b2_maxLinearCorrection=.2,t.b2_maxAngularCorrection=8/180*t.b2_pi,t.b2_maxLinearVelocity=200,t.b2_maxLinearVelocitySquared=t.b2_maxLinearVelocity*t.b2_maxLinearVelocity,t.b2_maxAngularVelocity=250,t.b2_maxAngularVelocitySquared=t.b2_maxAngularVelocity*t.b2_maxAngularVelocity,t.b2_contactBaumgarte=.2,t.b2_timeToSleep=.5,t.b2_linearSleepTolerance=.01,t.b2_angularSleepTolerance=2/180,t}(),AP=function(){function t(){this.userData=null}return t.prototype.SetBuffered=function(){this.status|=t.e_pairBuffered},t.prototype.ClearBuffered=function(){this.status&=~t.e_pairBuffered},t.prototype.IsBuffered=function(){return(this.status&t.e_pairBuffered)==t.e_pairBuffered},t.prototype.SetRemoved=function(){this.status|=t.e_pairRemoved},t.prototype.ClearRemoved=function(){this.status&=~t.e_pairRemoved},t.prototype.IsRemoved=function(){return(this.status&t.e_pairRemoved)==t.e_pairRemoved},t.prototype.SetFinal=function(){this.status|=t.e_pairFinal},t.prototype.IsFinal=function(){return(this.status&t.e_pairFinal)==t.e_pairFinal},t.b2_nullPair=yP.USHRT_MAX,t.b2_nullProxy=yP.USHRT_MAX,t.b2_tableCapacity=yP.b2_maxPairs,t.b2_tableMask=t.b2_tableCapacity-1,t.e_pairBuffered=1,t.e_pairRemoved=2,t.e_pairFinal=4,t}(),vP=function(){function t(){this.lowerBound=new _P,this.upperBound=new _P}return t.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,i=t>=0&&e>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},t}(),bP=function(){function t(t){this.__fast__=!0,this.m_userData=t.userData,this.m_friction=t.friction,this.m_restitution=t.restitution,this.m_density=t.density,this.m_body=null,this.m_sweepRadius=0,this.m_next=null,this.m_proxyId=AP.b2_nullProxy,this.m_filter=t.filter.Copy(),this.m_isSensor=t.isSensor}return t.prototype.GetType=function(){return this.m_type},t.prototype.IsSensor=function(){return this.m_isSensor},t.prototype.SetFilterData=function(t){this.m_filter=t.Copy()},t.prototype.GetFilterData=function(){return this.m_filter.Copy()},t.prototype.GetBody=function(){return this.m_body},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.prototype.TestPoint=function(t,e){return!1},t.prototype.TestSegment=function(t,e,i,n,r){return!1},t.prototype.ComputeAABB=function(t,e){},t.prototype.ComputeSweptAABB=function(t,e,i){},t.prototype.ComputeMass=function(t){},t.prototype.GetSweepRadius=function(){return this.m_sweepRadius},t.prototype.GetFriction=function(){return this.m_friction},t.prototype.GetRestitution=function(){return this.m_restitution},t.Destroy=function(t,e){},t.prototype.CreateProxy=function(e,i){var n=t.s_proxyAABB;this.ComputeAABB(n,i);var r=e.InRange(n);this.m_proxyId=r?e.CreateProxy(n,this):AP.b2_nullProxy},t.prototype.DestroyProxy=function(t){this.m_proxyId!=AP.b2_nullProxy&&(t.DestroyProxy(this.m_proxyId),this.m_proxyId=AP.b2_nullProxy)},t.prototype.Synchronize=function(e,i,n){if(this.m_proxyId==AP.b2_nullProxy)return!1;var r=t.s_syncAABB;return this.ComputeSweptAABB(r,i,n),!!e.InRange(r)&&(e.MoveProxy(this.m_proxyId,r),!0)},t.prototype.RefilterProxy=function(e,i){if(this.m_proxyId!=AP.b2_nullProxy){e.DestroyProxy(this.m_proxyId);var n=t.s_resetAABB;this.ComputeAABB(n,i);var r=e.InRange(n);this.m_proxyId=r?e.CreateProxy(n,this):AP.b2_nullProxy}},t.prototype.UpdateSweepRadius=function(t){},t.s_proxyAABB=new vP,t.s_syncAABB=new vP,t.s_resetAABB=new vP,t.e_unknownShape=-1,t.e_circleShape=0,t.e_polygonShape=1,t.e_shapeTypeCount=2,t}(),xP=function(){function t(){this.__fast__=!0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return t.prototype.Copy=function(){var e=new t;return e.categoryBits=this.categoryBits,e.maskBits=this.maskBits,e.groupIndex=this.groupIndex,e},t}(),CP=function(){this.type=bP.e_unknownShape,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter=new xP},wP=function(t){function e(){var e=t.call(this)||this;return e.localPosition=new _P(0,0),e.type=bP.e_circleShape,e.radius=1,e}return i(e,t),e}(CP),IP=function(t){function e(i){var n=t.call(this,i)||this;n.m_localPosition=new _P;var r=i;return n.m_type=e.e_circleShape,n.m_localPosition.SetV(r.localPosition),n.m_radius=r.radius,n}return i(e,t),e.prototype.TestPoint=function(t,e){var i=t.R,n=t.position.x+(i.col1.x*this.m_localPosition.x+i.col2.x*this.m_localPosition.y),r=t.position.y+(i.col1.y*this.m_localPosition.x+i.col2.y*this.m_localPosition.y);return(n=e.x-n)*n+(r=e.y-r)*r<=this.m_radius*this.m_radius},e.prototype.TestSegment=function(t,e,i,n,r){var o=t.R,s=t.position.x+(o.col1.x*this.m_localPosition.x+o.col2.x*this.m_localPosition.y),a=t.position.x+(o.col1.y*this.m_localPosition.x+o.col2.y*this.m_localPosition.y),l=n.p1.x-s,u=n.p1.y-a,c=l*l+u*u-this.m_radius*this.m_radius;if(c<0)return!1;var h=n.p2.x-n.p1.x,p=n.p2.y-n.p1.y,d=l*h+u*p,f=h*h+p*p,_=d*d-f*c;if(_<0||f<Number.MIN_VALUE)return!1;var m=-(d+Math.sqrt(_));return 0<=m&&m<=r*f&&(m/=f,e[0]=m,i.x=l+m*h,i.y=u+m*p,i.Normalize(),!0)},e.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_localPosition.x+i.col2.x*this.m_localPosition.y),r=e.position.y+(i.col1.y*this.m_localPosition.x+i.col2.y*this.m_localPosition.y);t.lowerBound.Set(n-this.m_radius,r-this.m_radius),t.upperBound.Set(n+this.m_radius,r+this.m_radius)},e.prototype.ComputeSweptAABB=function(t,e,i){var n;n=e.R;var r=e.position.x+(n.col1.x*this.m_localPosition.x+n.col2.x*this.m_localPosition.y),o=e.position.y+(n.col1.y*this.m_localPosition.x+n.col2.y*this.m_localPosition.y);n=i.R;var s=i.position.x+(n.col1.x*this.m_localPosition.x+n.col2.x*this.m_localPosition.y),a=i.position.y+(n.col1.y*this.m_localPosition.x+n.col2.y*this.m_localPosition.y);t.lowerBound.Set((r<s?r:s)-this.m_radius,(o<a?o:a)-this.m_radius),t.upperBound.Set((r>s?r:s)+this.m_radius,(o>a?o:a)+this.m_radius)},e.prototype.ComputeMass=function(t){t.mass=this.m_density*yP.b2_pi*this.m_radius*this.m_radius,t.center.SetV(this.m_localPosition),t.I=t.mass*(.5*this.m_radius*this.m_radius+(this.m_localPosition.x*this.m_localPosition.x+this.m_localPosition.y*this.m_localPosition.y))},e.prototype.GetLocalPosition=function(){return this.m_localPosition},e.prototype.GetRadius=function(){return this.m_radius},e.prototype.UpdateSweepRadius=function(t){var e=this.m_localPosition.x-t.x,i=this.m_localPosition.y-t.y;e=Math.sqrt(e*e+i*i),this.m_sweepRadius=e+this.m_radius-yP.b2_toiSlop},e}(bP),EP=function(){this.mass=0,this.center=new _P(0,0),this.I=0},SP=function(t){function e(){var e=t.call(this)||this;e.vertices=new Array(yP.b2_maxPolygonVertices),e.type=bP.e_polygonShape,e.vertexCount=0;for(var i=0;i<yP.b2_maxPolygonVertices;i++)e.vertices[i]=new _P;return e}return i(e,t),e.prototype.SetAsBox=function(t,e){this.vertexCount=4,this.vertices[0].Set(-t,-e),this.vertices[1].Set(t,-e),this.vertices[2].Set(t,e),this.vertices[3].Set(-t,e)},e.prototype.SetAsOrientedBox=function(t,i,n,r){if(void 0===n&&(n=null),void 0===r&&(r=0),this.vertexCount=4,this.vertices[0].Set(-t,-i),this.vertices[1].Set(t,-i),this.vertices[2].Set(t,i),this.vertices[3].Set(-t,i),n){var o=n,s=e.s_mat;s.Set(r);for(var a=0;a<this.vertexCount;++a)n=this.vertices[a],t=o.x+(s.col1.x*n.x+s.col2.x*n.y),n.y=o.y+(s.col1.y*n.x+s.col2.y*n.y),n.x=t}},e.s_mat=new dP,e}(CP),DP=function(){this.R=new dP,this.center=new _P,this.extents=new _P},TP=function(t){function e(i){var n=t.call(this,i)||this;n.s_supportVec=new _P,n.m_obb=new DP,n.m_vertices=new Array(yP.b2_maxPolygonVertices),n.m_normals=new Array(yP.b2_maxPolygonVertices),n.m_coreVertices=new Array(yP.b2_maxPolygonVertices),n.m_type=e.e_polygonShape;var r=i;n.m_vertexCount=r.vertexCount;var o=0,s=o,a=o,l=r.vertices;if(!l)return console.error("[B2D] Try create polygon shape from def",i),n;for(void 0!==l.traits&&(l=l.value),o=0;o<n.m_vertexCount;++o)n.m_vertices[o]=l[o].Copy();for(o=0;o<n.m_vertexCount;++o){s=o,a=o+1<n.m_vertexCount?o+1:0;var u=n.m_vertices[a].x-n.m_vertices[s].x,c=n.m_vertices[a].y-n.m_vertices[s].y,h=Math.sqrt(u*u+c*c);n.m_normals[o]=new _P(c/h,-u/h)}for(n.m_centroid=e.ComputeCentroid(l,r.vertexCount),e.ComputeOBB(n.m_obb,n.m_vertices,n.m_vertexCount),o=0;o<n.m_vertexCount;++o){s=o-1>=0?o-1:n.m_vertexCount-1,a=o;var p=n.m_normals[s].x,d=n.m_normals[s].y,f=n.m_normals[a].x,_=n.m_normals[a].y,m=n.m_vertices[o].x-n.m_centroid.x,g=n.m_vertices[o].y-n.m_centroid.y,y=p*m+d*g-yP.b2_toiSlop,A=f*m+_*g-yP.b2_toiSlop,v=1/(p*_-d*f);n.m_coreVertices[o]=new _P(v*(_*y-d*A)+n.m_centroid.x,v*(p*A-f*y)+n.m_centroid.y)}return n}return i(e,t),e.prototype.TestPoint=function(t,e){for(var i,n=t.R,r=e.x-t.position.x,o=e.y-t.position.y,s=r*n.col1.x+o*n.col1.y,a=r*n.col2.x+o*n.col2.y,l=0;l<this.m_vertexCount;++l){if(r=s-(i=this.m_vertices[l]).x,o=a-i.y,(i=this.m_normals[l]).x*r+i.y*o>0)return!1}return!0},e.prototype.TestSegment=function(t,e,i,n,r){var o,s,a,l,u=0,c=r;o=n.p1.x-t.position.x,s=n.p1.y-t.position.y;var h=o*(a=t.R).col1.x+s*a.col1.y,p=o*a.col2.x+s*a.col2.y;o=n.p2.x-t.position.x,s=n.p2.y-t.position.y;for(var d=o*(a=t.R).col1.x+s*a.col1.y-h,f=o*a.col2.x+s*a.col2.y-p,_=-1,m=0;m<this.m_vertexCount;++m){o=(l=this.m_vertices[m]).x-h,s=l.y-p;var g=(l=this.m_normals[m]).x*o+l.y*s,y=l.x*d+l.y*f;if(y<0&&g<u*y?(u=g/y,_=m):y>0&&g<c*y&&(c=g/y),c<u)return!1}return _>=0&&(e[0]=u,a=t.R,l=this.m_normals[_],i.x=a.col1.x*l.x+a.col2.x*l.y,i.y=a.col1.y*l.x+a.col2.y*l.y,!0)},e.prototype.ComputeAABB=function(t,i){var n,r,o=e.s_computeMat;n=i.R,r=this.m_obb.R.col1,o.col1.x=n.col1.x*r.x+n.col2.x*r.y,o.col1.y=n.col1.y*r.x+n.col2.y*r.y,r=this.m_obb.R.col2,o.col2.x=n.col1.x*r.x+n.col2.x*r.y,o.col2.y=n.col1.y*r.x+n.col2.y*r.y,o.Abs();var s=o;r=this.m_obb.extents;var a=s.col1.x*r.x+s.col2.x*r.y,l=s.col1.y*r.x+s.col2.y*r.y;n=i.R,r=this.m_obb.center;var u=i.position.x+(n.col1.x*r.x+n.col2.x*r.y),c=i.position.y+(n.col1.y*r.x+n.col2.y*r.y);t.lowerBound.Set(u-a,c-l),t.upperBound.Set(u+a,c+l)},e.prototype.ComputeSweptAABB=function(t,i,n){var r=e.s_sweptAABB1,o=e.s_sweptAABB2;this.ComputeAABB(r,i),this.ComputeAABB(o,n),t.lowerBound.Set(r.lowerBound.x<o.lowerBound.x?r.lowerBound.x:o.lowerBound.x,r.lowerBound.y<o.lowerBound.y?r.lowerBound.y:o.lowerBound.y),t.upperBound.Set(r.upperBound.x>o.upperBound.x?r.upperBound.x:o.upperBound.x,r.upperBound.y>o.upperBound.y?r.upperBound.y:o.upperBound.y)},e.prototype.ComputeMass=function(t){for(var e=0,i=0,n=0,r=0,o=0;o<this.m_vertexCount;++o){var s=this.m_vertices[o],a=o+1<this.m_vertexCount?this.m_vertices[o+1]:this.m_vertices[0],l=s.x-0,u=s.y-0,c=a.x-0,h=a.y-0,p=l*h-u*c,d=.5*p;n+=d,e+=d*(1/3)*(0+s.x+a.x),i+=d*(1/3)*(0+s.y+a.y);r+=p*(1/3*(.25*(l*l+c*l+c*c)+(0*l+0*c))+0+(1/3*(.25*(u*u+h*u+h*h)+(0*u+0*h))+0))}t.mass=this.m_density*n,e*=1/n,i*=1/n,t.center.Set(e,i),t.I=this.m_density*r},e.prototype.GetOBB=function(){return this.m_obb},e.prototype.GetCentroid=function(){return this.m_centroid},e.prototype.GetVertexCount=function(){return this.m_vertexCount},e.prototype.GetVertices=function(){return this.m_vertices},e.prototype.GetCoreVertices=function(){return this.m_coreVertices},e.prototype.GetNormals=function(){return this.m_normals},e.prototype.GetFirstVertex=function(t){return gP.b2MulX(t,this.m_coreVertices[0])},e.prototype.Centroid=function(t){return gP.b2MulX(t,this.m_centroid)},e.prototype.Support=function(t,e,i){for(var n,r,o=e*(r=t.R).col1.x+i*r.col1.y,s=e*r.col2.x+i*r.col2.y,a=0,l=(n=this.m_coreVertices[0]).x*o+n.y*s,u=1;u<this.m_vertexCount;++u){var c=(n=this.m_coreVertices[u]).x*o+n.y*s;c>l&&(a=u,l=c)}return r=t.R,n=this.m_coreVertices[a],this.s_supportVec.x=t.position.x+(r.col1.x*n.x+r.col2.x*n.y),this.s_supportVec.y=t.position.y+(r.col1.y*n.x+r.col2.y*n.y),this.s_supportVec},e.prototype.UpdateSweepRadius=function(t){var e;this.m_sweepRadius=0;for(var i=0;i<this.m_vertexCount;++i){var n=(e=this.m_coreVertices[i]).x-t.x,r=e.y-t.y;(n=Math.sqrt(n*n+r*r))>this.m_sweepRadius&&(this.m_sweepRadius=n)}},e.ComputeCentroid=function(t,e){for(var i=new _P,n=0,r=0;r<e;++r){var o=t[r],s=r+1<e?t[r+1]:t[0],a=o.x-0,l=o.y-0,u=s.x-0,c=.5*(a*(s.y-0)-l*u);n+=c,i.x+=c*(1/3)*(0+o.x+s.x),i.y+=c*(1/3)*(0+o.y+s.y)}return i.x*=1/n,i.y*=1/n,i},e.ComputeOBB=function(t,e,i){var n,r=new Array(yP.b2_maxPolygonVertices+1);for(n=0;n<i;++n)r[n]=e[n];r[i]=r[0];var o=Number.MAX_VALUE;for(n=1;n<=i;++n){for(var s=r[n-1],a=r[n].x-s.x,l=r[n].y-s.y,u=Math.sqrt(a*a+l*l),c=-(l/=u),h=a/=u,p=Number.MAX_VALUE,d=Number.MAX_VALUE,f=-Number.MAX_VALUE,_=-Number.MAX_VALUE,m=0;m<i;++m){var g=r[m].x-s.x,y=r[m].y-s.y,A=a*g+l*y,v=c*g+h*y;A<p&&(p=A),v<d&&(d=v),A>f&&(f=A),v>_&&(_=v)}var b=(f-p)*(_-d);if(b<.95*o){o=b,t.R.col1.x=a,t.R.col1.y=l,t.R.col2.x=c,t.R.col2.y=h;var x=.5*(p+f),C=.5*(d+_),w=t.R;t.center.x=s.x+(w.col1.x*x+w.col2.x*C),t.center.y=s.y+(w.col1.y*x+w.col2.y*C),t.extents.x=.5*(f-p),t.extents.y=.5*(_-d)}}},e.s_computeMat=new dP,e.s_sweptAABB1=new vP,e.s_sweptAABB2=new vP,e}(bP),PP=function(){function t(){}return t.prototype.IsLower=function(){return 0==(1&this.value)},t.prototype.IsUpper=function(){return 1==(1&this.value)},t.prototype.Swap=function(t){var e=this.value,i=this.proxyId,n=this.stabbingCount;this.value=t.value,this.proxyId=t.proxyId,this.stabbingCount=t.stabbingCount,t.value=e,t.proxyId=i,t.stabbingCount=n},t}(),BP=function(){this.lowerValues=[0,0],this.upperValues=[0,0]},MP=function(){function t(){this.lowerBounds=[0,0],this.upperBounds=[0,0],this.userData=null}return t.prototype.GetNext=function(){return this.lowerBounds[0]},t.prototype.SetNext=function(t){this.lowerBounds[0]=65535&t},t.prototype.IsValid=function(){return this.overlapCount!=RP.b2_invalid},t}(),OP=function(){},LP=function(){function t(){var t;for(this.m_freePair=0,this.m_hashTable=new Array(AP.b2_tableCapacity),t=0;t<AP.b2_tableCapacity;++t)this.m_hashTable[t]=AP.b2_nullPair;for(this.m_pairs=new Array(yP.b2_maxPairs),t=0;t<yP.b2_maxPairs;++t)this.m_pairs[t]=new AP;for(this.m_pairBuffer=new Array(yP.b2_maxPairs),t=0;t<yP.b2_maxPairs;++t)this.m_pairBuffer[t]=new OP;for(t=0;t<yP.b2_maxPairs;++t)this.m_pairs[t].proxyId1=AP.b2_nullProxy,this.m_pairs[t].proxyId2=AP.b2_nullProxy,this.m_pairs[t].userData=null,this.m_pairs[t].status=0,this.m_pairs[t].next=t+1;this.m_pairs[yP.b2_maxPairs-1].next=AP.b2_nullPair,this.m_pairCount=0,this.m_pairBufferCount=0}return t.prototype.Initialize=function(t,e){this.m_broadPhase=t,this.m_callback=e},t.prototype.AddBufferedPair=function(t,e){var i,n=this.AddPair(t,e);0==n.IsBuffered()&&(n.SetBuffered(),(i=this.m_pairBuffer[this.m_pairBufferCount]).proxyId1=n.proxyId1,i.proxyId2=n.proxyId2,++this.m_pairBufferCount),n.ClearRemoved(),RP.s_validate&&this.ValidateBuffer()},t.prototype.RemoveBufferedPair=function(t,e){var i,n=this.Find(t,e);null!=n&&(0==n.IsBuffered()&&(n.SetBuffered(),(i=this.m_pairBuffer[this.m_pairBufferCount]).proxyId1=n.proxyId1,i.proxyId2=n.proxyId2,++this.m_pairBufferCount),n.SetRemoved(),RP.s_validate&&this.ValidateBuffer())},t.prototype.Commit=function(){var t,e,i=0,n=this.m_broadPhase.m_proxyPool;for(e=0;e<this.m_pairBufferCount;++e){t=this.m_pairBuffer[e];var r=this.Find(t.proxyId1,t.proxyId2);r.ClearBuffered();var o=n[r.proxyId1],s=n[r.proxyId2];r.IsRemoved()?(1==r.IsFinal()&&this.m_callback.PairRemoved(o.userData,s.userData,r.userData),(t=this.m_pairBuffer[i]).proxyId1=r.proxyId1,t.proxyId2=r.proxyId2,++i):0==r.IsFinal()&&(r.userData=this.m_callback.PairAdded(o.userData,s.userData),r.SetFinal())}for(e=0;e<i;++e)t=this.m_pairBuffer[e],this.RemovePair(t.proxyId1,t.proxyId2);this.m_pairBufferCount=0,RP.s_validate&&this.ValidateTable()},t.prototype.AddPair=function(e,i){if(e>i){var n=e;e=i,i=n}var r=t.Hash(e,i)&AP.b2_tableMask,o=o=this.FindHash(e,i,r);if(null!=o)return o;var s=this.m_freePair;return o=this.m_pairs[s],this.m_freePair=o.next,o.proxyId1=e,o.proxyId2=i,o.status=0,o.userData=null,o.next=this.m_hashTable[r],this.m_hashTable[r]=s,++this.m_pairCount,o},t.prototype.RemovePair=function(e,i){var n;if(e>i){var r=e;e=i,i=r}for(var o=t.Hash(e,i)&AP.b2_tableMask,s=this.m_hashTable[o],a=null;s!=AP.b2_nullPair;){if(t.Equals(this.m_pairs[s],e,i)){var l=s;n=this.m_pairs[s],a?a.next=n.next:this.m_hashTable[o]=n.next;var u=(n=this.m_pairs[l]).userData;return n.next=this.m_freePair,n.proxyId1=AP.b2_nullProxy,n.proxyId2=AP.b2_nullProxy,n.userData=null,n.status=0,this.m_freePair=l,--this.m_pairCount,u}s=(a=this.m_pairs[s]).next}return null},t.prototype.Find=function(e,i){if(e>i){var n=e;e=i,i=n}var r=t.Hash(e,i)&AP.b2_tableMask;return this.FindHash(e,i,r)},t.prototype.FindHash=function(e,i,n){var r,o=this.m_hashTable[n];for(r=this.m_pairs[o];o!=AP.b2_nullPair&&0==t.Equals(r,e,i);)o=r.next,r=this.m_pairs[o];return o==AP.b2_nullPair?null:r},t.prototype.ValidateBuffer=function(){},t.prototype.ValidateTable=function(){},t.Hash=function(t,e){var i=e<<16&4294901760|t;return i=~i+(i<<15&4294934528),i^=i>>12&1048575,i+=i<<2&4294967292,i^=i>>4&268435455,i*=2057,i^=i>>16&65535},t.Equals=function(t,e,i){return t.proxyId1==e&&t.proxyId2==i},t.EqualsPair=function(t,e){return t.proxyId1==e.proxyId1&&t.proxyId2==e.proxyId2},t}(),RP=function(){function t(e,i){var n;for(this.m_pairManager=new LP,this.m_proxyPool=new Array(yP.b2_maxPairs),this.m_bounds=new Array(2*yP.b2_maxProxies),this.m_queryResults=new Array(yP.b2_maxProxies),this.m_quantizationFactor=new _P,this.m_pairManager.Initialize(this,i),this.m_worldAABB=e,this.m_proxyCount=0,n=0;n<yP.b2_maxProxies;n++)this.m_queryResults[n]=0;for(this.m_bounds=new Array(2),n=0;n<2;n++){this.m_bounds[n]=new Array(2*yP.b2_maxProxies);for(var r=0;r<2*yP.b2_maxProxies;r++)this.m_bounds[n][r]=new PP}var o,s=e.upperBound.x-e.lowerBound.x,a=e.upperBound.y-e.lowerBound.y;for(this.m_quantizationFactor.x=yP.USHRT_MAX/s,this.m_quantizationFactor.y=yP.USHRT_MAX/a,n=0;n<yP.b2_maxProxies-1;++n)o=new MP,this.m_proxyPool[n]=o,o.SetNext(n+1),o.timeStamp=0,o.overlapCount=t.b2_invalid,o.userData=null;o=new MP,this.m_proxyPool[yP.b2_maxProxies-1]=o,o.SetNext(AP.b2_nullProxy),o.timeStamp=0,o.overlapCount=t.b2_invalid,o.userData=null,this.m_freeProxy=0,this.m_timeStamp=1,this.m_queryResultCount=0}return t.prototype.InRange=function(t){var e,i,n,r;return e=t.lowerBound.x,i=t.lowerBound.y,e-=this.m_worldAABB.upperBound.x,i-=this.m_worldAABB.upperBound.y,n=this.m_worldAABB.lowerBound.x,r=this.m_worldAABB.lowerBound.y,n-=t.upperBound.x,r-=t.upperBound.y,e=gP.b2Max(e,n),i=gP.b2Max(i,r),gP.b2Max(e,i)<0},t.prototype.GetProxy=function(t){var e=this.m_proxyPool[t];return t==AP.b2_nullProxy||0==e.IsValid()?null:e},t.prototype.CreateProxy=function(t,e){var i,n,r=this.m_freeProxy;n=this.m_proxyPool[r],this.m_freeProxy=n.GetNext(),n.overlapCount=0,n.userData=e;var o=2*this.m_proxyCount,s=[],a=[];this.ComputeBounds(s,a,t);for(var l=0;l<2;++l){var u=this.m_bounds[l],c=0,h=0,p=[c],d=[h];this.Query(p,d,s[l],a[l],u,o,l),c=p[0];var f,_,m,g,y=[],A=o-(h=d[0]);for(f=0;f<A;f++)y[f]=new PP,_=y[f],m=u[h+f],_.value=m.value,_.proxyId=m.proxyId,_.stabbingCount=m.stabbingCount;A=y.length;var v=h+2;for(f=0;f<A;f++)m=y[f],(_=u[v+f]).value=m.value,_.proxyId=m.proxyId,_.stabbingCount=m.stabbingCount;for(y=new Array,A=h-c,f=0;f<A;f++)y[f]=new PP,_=y[f],m=u[c+f],_.value=m.value,_.proxyId=m.proxyId,_.stabbingCount=m.stabbingCount;for(A=y.length,v=c+1,f=0;f<A;f++)m=y[f],(_=u[v+f]).value=m.value,_.proxyId=m.proxyId,_.stabbingCount=m.stabbingCount;for(++h,_=u[c],m=u[h],_.value=s[l],_.proxyId=r,m.value=a[l],m.proxyId=r,g=u[c-1],_.stabbingCount=0==c?0:g.stabbingCount,g=u[h-1],m.stabbingCount=g.stabbingCount,i=c;i<h;++i)(g=u[i]).stabbingCount++;for(i=c;i<o+2;++i){_=u[i];var b=this.m_proxyPool[_.proxyId];_.IsLower()?b.lowerBounds[l]=i:b.upperBounds[l]=i}}++this.m_proxyCount;for(var x=0;x<this.m_queryResultCount;++x)this.m_pairManager.AddBufferedPair(r,this.m_queryResults[x]);return this.m_pairManager.Commit(),this.m_queryResultCount=0,this.IncrementTimeStamp(),r},t.prototype.DestroyProxy=function(e){for(var i,n,r=this.m_proxyPool[e],o=2*this.m_proxyCount,s=0;s<2;++s){var a,l=this.m_bounds[s],u=r.lowerBounds[s],c=r.upperBounds[s],h=(i=l[u]).value,p=(n=l[c]).value,d=new Array,f=c-u-1;for(a=0;a<f;a++)d[a]=new PP,i=d[a],n=l[u+1+a],i.value=n.value,i.proxyId=n.proxyId,i.stabbingCount=n.stabbingCount;f=d.length;var _=u;for(a=0;a<f;a++)n=d[a],(i=l[_+a]).value=n.value,i.proxyId=n.proxyId,i.stabbingCount=n.stabbingCount;for(d=new Array,f=o-c-1,a=0;a<f;a++)d[a]=new PP,i=d[a],n=l[c+1+a],i.value=n.value,i.proxyId=n.proxyId,i.stabbingCount=n.stabbingCount;for(f=d.length,_=c-1,a=0;a<f;a++)n=d[a],(i=l[_+a]).value=n.value,i.proxyId=n.proxyId,i.stabbingCount=n.stabbingCount;f=o-2;for(var m=u;m<f;++m){i=l[m];var g=this.m_proxyPool[i.proxyId];i.IsLower()?g.lowerBounds[s]=m:g.upperBounds[s]=m}f=c-1;for(var y=u;y<f;++y)(i=l[y]).stabbingCount--;this.Query([0],[0],h,p,l,o-2,s)}for(var A=0;A<this.m_queryResultCount;++A)this.m_pairManager.RemoveBufferedPair(e,this.m_queryResults[A]);this.m_pairManager.Commit(),this.m_queryResultCount=0,this.IncrementTimeStamp(),r.userData=null,r.overlapCount=t.b2_invalid,r.lowerBounds[0]=t.b2_invalid,r.lowerBounds[1]=t.b2_invalid,r.upperBounds[0]=t.b2_invalid,r.upperBounds[1]=t.b2_invalid,r.SetNext(this.m_freeProxy),this.m_freeProxy=e,--this.m_proxyCount},t.prototype.MoveProxy=function(t,e){var i,n,r,o,s,a,l,u,c;if(!(t==AP.b2_nullProxy||yP.b2_maxProxies<=t)&&0!=e.IsValid()){var h=2*this.m_proxyCount,p=this.m_proxyPool[t],d=new BP;this.ComputeBounds(d.lowerValues,d.upperValues,e);var f=new BP;for(r=0;r<2;++r)s=this.m_bounds[r][p.lowerBounds[r]],f.lowerValues[r]=s.value,s=this.m_bounds[r][p.upperBounds[r]],f.upperValues[r]=s.value;for(r=0;r<2;++r){var _=this.m_bounds[r],m=p.lowerBounds[r],g=p.upperBounds[r],y=d.lowerValues[r],A=d.upperValues[r],v=y-(s=_[m]).value;s.value=y;var b=A-(s=_[g]).value;if(s.value=A,v<0)for(o=m;o>0&&y<_[o-1].value;){s=_[o];var x=(a=_[o-1]).proxyId,C=this.m_proxyPool[a.proxyId];a.stabbingCount++,1==a.IsUpper()?(this.TestOverlap(d,C)&&this.m_pairManager.AddBufferedPair(t,x),n=(i=C.upperBounds)[r],n++,i[r]=n,s.stabbingCount++):(n=(i=C.lowerBounds)[r],n++,i[r]=n,s.stabbingCount--),n=(i=p.lowerBounds)[r],n--,i[r]=n,s.Swap(a),--o}if(b>0)for(o=g;o<h-1&&_[o+1].value<=A;)s=_[o],u=(l=_[o+1]).proxyId,c=this.m_proxyPool[u],l.stabbingCount++,1==l.IsLower()?(this.TestOverlap(d,c)&&this.m_pairManager.AddBufferedPair(t,u),n=(i=c.lowerBounds)[r],n--,i[r]=n,s.stabbingCount++):(n=(i=c.upperBounds)[r],n--,i[r]=n,s.stabbingCount--),n=(i=p.upperBounds)[r],n++,i[r]=n,s.Swap(l),o++;if(v>0)for(o=m;o<h-1&&_[o+1].value<=y;)s=_[o],u=(l=_[o+1]).proxyId,c=this.m_proxyPool[u],l.stabbingCount--,l.IsUpper()?(this.TestOverlap(f,c)&&this.m_pairManager.RemoveBufferedPair(t,u),n=(i=c.upperBounds)[r],n--,i[r]=n,s.stabbingCount--):(n=(i=c.lowerBounds)[r],n--,i[r]=n,s.stabbingCount++),n=(i=p.lowerBounds)[r],n++,i[r]=n,s.Swap(l),o++;if(b<0)for(o=g;o>0&&A<_[o-1].value;)s=_[o],x=(a=_[o-1]).proxyId,C=this.m_proxyPool[x],a.stabbingCount--,1==a.IsLower()?(this.TestOverlap(f,C)&&this.m_pairManager.RemoveBufferedPair(t,x),n=(i=C.lowerBounds)[r],n++,i[r]=n,s.stabbingCount--):(n=(i=C.upperBounds)[r],n++,i[r]=n,s.stabbingCount++),n=(i=p.upperBounds)[r],n--,i[r]=n,s.Swap(a),o--}}},t.prototype.Commit=function(){this.m_pairManager.Commit()},t.prototype.QueryAABB=function(t,e,i){var n=new Array,r=new Array;this.ComputeBounds(n,r,t);var o=[0],s=[0];this.Query(o,s,n[0],r[0],this.m_bounds[0],2*this.m_proxyCount,0),this.Query(o,s,n[1],r[1],this.m_bounds[1],2*this.m_proxyCount,1);for(var a=0,l=0;l<this.m_queryResultCount&&a<i;++l,++a){var u=this.m_proxyPool[this.m_queryResults[l]];e[l]=u.userData}return this.m_queryResultCount=0,this.IncrementTimeStamp(),a},t.prototype.Validate=function(){for(var t=0;t<2;++t)for(var e=this.m_bounds[t],i=2*this.m_proxyCount,n=0;n<i;++n){e[n].IsLower()}},t.prototype.ComputeBounds=function(t,e,i){var n=i.lowerBound.x,r=i.lowerBound.y;n=gP.b2Min(n,this.m_worldAABB.upperBound.x),r=gP.b2Min(r,this.m_worldAABB.upperBound.y),n=gP.b2Max(n,this.m_worldAABB.lowerBound.x),r=gP.b2Max(r,this.m_worldAABB.lowerBound.y);var o=i.upperBound.x,s=i.upperBound.y;o=gP.b2Min(o,this.m_worldAABB.upperBound.x),s=gP.b2Min(s,this.m_worldAABB.upperBound.y),o=gP.b2Max(o,this.m_worldAABB.lowerBound.x),s=gP.b2Max(s,this.m_worldAABB.lowerBound.y),t[0]=this.m_quantizationFactor.x*(n-this.m_worldAABB.lowerBound.x)>>>0&yP.USHRT_MAX-1,e[0]=this.m_quantizationFactor.x*(o-this.m_worldAABB.lowerBound.x)>>>0&65535|1,t[1]=this.m_quantizationFactor.y*(r-this.m_worldAABB.lowerBound.y)>>>0&yP.USHRT_MAX-1,e[1]=this.m_quantizationFactor.y*(s-this.m_worldAABB.lowerBound.y)>>>0&65535|1},t.prototype.TestOverlapValidate=function(t,e){for(var i=0;i<2;++i){var n=this.m_bounds[i],r=n[t.lowerBounds[i]],o=n[e.upperBounds[i]];if(r.value>o.value)return!1;if(r=n[t.upperBounds[i]],o=n[e.lowerBounds[i]],r.value<o.value)return!1}return!0},t.prototype.TestOverlap=function(t,e){for(var i=0;i<2;++i){var n=this.m_bounds[i],r=n[e.upperBounds[i]];if(t.lowerValues[i]>r.value)return!1;if(r=n[e.lowerBounds[i]],t.upperValues[i]<r.value)return!1}return!0},t.prototype.Query=function(e,i,n,r,o,s,a){for(var l,u=t.BinarySearch(o,s,n),c=t.BinarySearch(o,s,r),h=u;h<c;++h)(l=o[h]).IsLower()&&this.IncrementOverlapCount(l.proxyId);if(u>0)for(var p=u-1,d=(l=o[p]).stabbingCount;d;){if((l=o[p]).IsLower())u<=this.m_proxyPool[l.proxyId].upperBounds[a]&&(this.IncrementOverlapCount(l.proxyId),--d);--p}e[0]=u,i[0]=c},t.prototype.IncrementOverlapCount=function(t){var e=this.m_proxyPool[t];e.timeStamp<this.m_timeStamp?(e.timeStamp=this.m_timeStamp,e.overlapCount=1):(e.overlapCount=2,this.m_queryResults[this.m_queryResultCount]=t,++this.m_queryResultCount)},t.prototype.IncrementTimeStamp=function(){if(this.m_timeStamp==yP.USHRT_MAX){for(var t=0;t<yP.b2_maxProxies;++t)this.m_proxyPool[t].timeStamp=0;this.m_timeStamp=1}else++this.m_timeStamp},t.BinarySearch=function(t,e,i){for(var n=0,r=e-1;n<=r;){var o=(n+r)/2|0,s=t[o];if(s.value>i)r=o-1;else{if(!(s.value<i))return o>>>0;n=o+1}}return n>>>0},t.s_validate=!1,t.b2_invalid=yP.USHRT_MAX,t.b2_nullEdge=yP.USHRT_MAX,t}(),NP=function(){function t(){}return Object.defineProperty(t.prototype,"referenceEdge",{get:function(){return this._referenceEdge},set:function(t){this._referenceEdge=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"incidentEdge",{get:function(){return this._incidentEdge},set:function(t){this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"incidentVertex",{get:function(){return this._incidentVertex},set:function(t){this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"flip",{get:function(){return this._flip},set:function(t){this._flip=t,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080},enumerable:!0,configurable:!0}),t}(),FP=function(){function t(){this.features=new NP,this.features._m_id=this}return t.prototype.Set=function(t){this.key=t._key},t.prototype.Copy=function(){var e=new t;return e.key=this.key,e},Object.defineProperty(t.prototype,"key",{get:function(){return this._key},set:function(t){this._key=t,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255},enumerable:!0,configurable:!0}),t}(),kP=function(){this.v=new _P,this.id=new FP},VP=function(){function t(){}return t.ClipSegmentToLine=function(t,e,i,n){var r,o=0,s=(r=e[0]).v,a=(r=e[1]).v,l=gP.b2Dot(i,s)-n,u=gP.b2Dot(i,a)-n;if(l<=0&&(t[o++]=e[0]),u<=0&&(t[o++]=e[1]),l*u<0){var c=l/(l-u),h=(r=t[o]).v;h.x=s.x+c*(a.x-s.x),h.y=s.y+c*(a.y-s.y),r=t[o];var p=void 0;l>0?(p=e[0],r.id=p.id):(p=e[1],r.id=p.id),++o}return o},t.EdgeSeparation=function(t,e,i,n,r){t.m_vertexCount;var o,s,a=t.m_vertices,l=t.m_normals,u=n.m_vertexCount,c=n.m_vertices;o=e.R,s=l[i];for(var h=o.col1.x*s.x+o.col2.x*s.y,p=o.col1.y*s.x+o.col2.y*s.y,d=(o=r.R).col1.x*h+o.col1.y*p,f=o.col2.x*h+o.col2.y*p,_=0,m=Number.MAX_VALUE,g=0;g<u;++g){var y=(s=c[g]).x*d+s.y*f;y<m&&(m=y,_=g)}s=a[i],o=e.R;var A=e.position.x+(o.col1.x*s.x+o.col2.x*s.y),v=e.position.y+(o.col1.y*s.x+o.col2.y*s.y);s=c[_],o=r.R;var b=r.position.x+(o.col1.x*s.x+o.col2.x*s.y),x=r.position.y+(o.col1.y*s.x+o.col2.y*s.y);return(b-=A)*h+(x-=v)*p},t.FindMaxSeparation=function(t,e,i,n,r){var o,s,a=e.m_vertexCount,l=e.m_normals;s=r.R,o=n.m_centroid;var u=r.position.x+(s.col1.x*o.x+s.col2.x*o.y),c=r.position.y+(s.col1.y*o.x+s.col2.y*o.y);s=i.R,o=e.m_centroid,u-=i.position.x+(s.col1.x*o.x+s.col2.x*o.y),c-=i.position.y+(s.col1.y*o.x+s.col2.y*o.y);for(var h=u*i.R.col1.x+c*i.R.col1.y,p=u*i.R.col2.x+c*i.R.col2.y,d=0,f=-Number.MAX_VALUE,_=0;_<a;++_){var m=(o=l[_]).x*h+o.y*p;m>f&&(f=m,d=_)}var g=this.EdgeSeparation(e,i,d,n,r);if(g>0)return g;var y=d-1>=0?d-1:a-1,A=this.EdgeSeparation(e,i,y,n,r);if(A>0)return A;var v,b,x,C=d+1<a?d+1:0,w=this.EdgeSeparation(e,i,C,n,r);if(w>0)return w;if(A>g&&A>w)x=-1,v=y,b=A;else{if(!(w>g))return t[0]=d,g;x=1,v=C,b=w}for(;;){if(d=-1==x?v-1>=0?v-1:a-1:v+1<a?v+1:0,(g=this.EdgeSeparation(e,i,d,n,r))>0)return g;if(!(g>b))break;v=d,b=g}return t[0]=v,b},t.FindIncidentEdge=function(t,e,i,n,r,o){e.m_vertexCount;var s,a,l=e.m_normals,u=r.m_vertexCount,c=r.m_vertices,h=r.m_normals;s=i.R,a=l[n];var p=s.col1.x*a.x+s.col2.x*a.y,d=s.col1.y*a.x+s.col2.y*a.y,f=(s=o.R).col1.x*p+s.col1.y*d;d=s.col2.x*p+s.col2.y*d,p=f;for(var _,m=0,g=Number.MAX_VALUE,y=0;y<u;++y){var A=p*(a=h[y]).x+d*a.y;A<g&&(g=A,m=y)}var v=m,b=v+1<u?v+1:0;_=t[0],a=c[v],s=o.R,_.v.x=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),_.v.y=o.position.y+(s.col1.y*a.x+s.col2.y*a.y),_.id.features.referenceEdge=n,_.id.features.incidentEdge=v,_.id.features.incidentVertex=0,_=t[1],a=c[b],s=o.R,_.v.x=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),_.v.y=o.position.y+(s.col1.y*a.x+s.col2.y*a.y),_.id.features.referenceEdge=n,_.id.features.incidentEdge=b,_.id.features.incidentVertex=1},t.b2CollidePolygons=function(t,e,i,n,r){var o;t.pointCount=0;var s=0,a=[s],l=this.FindMaxSeparation(a,e,i,n,r);if(s=a[0],!(l>0)){var u=0,c=[u],h=this.FindMaxSeparation(c,n,r,e,i);if(u=c[0],!(h>0)){var p,d,f,_,m=new mP,g=new mP;h>.98*l+.001?(p=n,d=e,m.Set(r),g.Set(i),f=u,_=1):(p=e,d=n,m.Set(i),g.Set(r),f=s,_=0);var y=[new kP,new kP];this.FindIncidentEdge(y,p,m,f,d,g);var A=p.m_vertexCount,v=p.m_vertices,b=v[f],x=b.Copy();if(f+1<A)var C=(b=v[f+1]).Copy();else C=(b=v[0]).Copy();gP.SubtractVV(C,x);var w=gP.b2MulMV(m.R,gP.SubtractVV(C,x));w.Normalize();var I=gP.b2CrossVF(w,1);x=gP.b2MulX(m,x),C=gP.b2MulX(m,C);var E=gP.b2Dot(I,x),S=-gP.b2Dot(w,x),D=gP.b2Dot(w,C),T=[new kP,new kP],P=[new kP,new kP];if(!(this.ClipSegmentToLine(T,y,w.Negative(),S)<2||this.ClipSegmentToLine(P,T,w,D)<2)){t.normal=_?I.Negative():I.Copy();for(var B=0,M=0;M<yP.b2_maxManifoldPoints;++M){o=P[M];var O=gP.b2Dot(I,o.v)-E;if(O<=0){var L=t.points[B];L.separation=O,L.localPoint1=gP.b2MulXT(i,o.v),L.localPoint2=gP.b2MulXT(r,o.v),L.id.key=o.id._key,L.id.features.flip=_,++B}}t.pointCount=B}}}},t.b2CollideCircles=function(t,e,i,n,r){var o,s;t.pointCount=0,o=i.R,s=e.m_localPosition;var a=i.position.x+(o.col1.x*s.x+o.col2.x*s.y),l=i.position.y+(o.col1.y*s.x+o.col2.y*s.y);o=r.R,s=n.m_localPosition;var u=r.position.x+(o.col1.x*s.x+o.col2.x*s.y),c=r.position.y+(o.col1.y*s.x+o.col2.y*s.y),h=u-a,p=c-l,d=h*h+p*p,f=e.m_radius,_=n.m_radius,m=f+_;if(!(d>m*m)){var g;if(d<Number.MIN_VALUE)g=-m,t.normal.Set(0,1);else{var y=Math.sqrt(d);g=y-m;var A=1/y;t.normal.x=A*h,t.normal.y=A*p}t.pointCount=1;var v=t.points[0];v.id.key=0,v.separation=g,a+=f*t.normal.x,l+=f*t.normal.y;var b=.5*(a+(u-=_*t.normal.x)),x=.5*(l+(c-=_*t.normal.y)),C=b-i.position.x,w=x-i.position.y;v.localPoint1.x=C*i.R.col1.x+w*i.R.col1.y,v.localPoint1.y=C*i.R.col2.x+w*i.R.col2.y,C=b-r.position.x,w=x-r.position.y,v.localPoint2.x=C*r.R.col1.x+w*r.R.col1.y,v.localPoint2.y=C*r.R.col2.x+w*r.R.col2.y}},t.b2CollidePolygonAndCircle=function(e,i,n,r,o){var s,a,l,u,c,h,p;e.pointCount=0,p=o.R,h=r.m_localPosition;var d=o.position.x+(p.col1.x*h.x+p.col2.x*h.y),f=o.position.y+(p.col1.y*h.x+p.col2.y*h.y);a=d-n.position.x,l=f-n.position.y;for(var _,m=a*(p=n.R).col1.x+l*p.col1.y,g=a*p.col2.x+l*p.col2.y,y=0,A=-Number.MAX_VALUE,v=r.m_radius,b=i.m_vertexCount,x=i.m_vertices,C=i.m_normals,w=0;w<b;++w){a=m-(h=x[w]).x,l=g-h.y;var I=(h=C[w]).x*a+h.y*l;if(I>v)return;I>A&&(A=I,y=w)}if(A<Number.MIN_VALUE)return e.pointCount=1,h=C[y],p=n.R,e.normal.x=p.col1.x*h.x+p.col2.x*h.y,e.normal.y=p.col1.y*h.x+p.col2.y*h.y,(s=e.points[0]).id.features.incidentEdge=y,s.id.features.incidentVertex=t.b2_nullFeature,s.id.features.referenceEdge=0,s.id.features.flip=0,u=d-v*e.normal.x,c=f-v*e.normal.y,a=u-n.position.x,l=c-n.position.y,p=n.R,s.localPoint1.x=a*p.col1.x+l*p.col1.y,s.localPoint1.y=a*p.col2.x+l*p.col2.y,a=u-o.position.x,l=c-o.position.y,p=o.R,s.localPoint2.x=a*p.col1.x+l*p.col1.y,s.localPoint2.y=a*p.col2.x+l*p.col2.y,void(s.separation=A-v);var E=y,S=E+1<b?E+1:0;h=x[E];var D=x[S],T=D.x-h.x,P=D.y-h.y,B=Math.sqrt(T*T+P*P);T/=B,P/=B;var M,O,L=(a=m-h.x)*T+(l=g-h.y)*P;s=e.points[0],L<=0?(M=h.x,O=h.y,s.id.features.incidentEdge=t.b2_nullFeature,s.id.features.incidentVertex=E):L>=B?(M=D.x,O=D.y,s.id.features.incidentEdge=t.b2_nullFeature,s.id.features.incidentVertex=S):(M=T*L+h.x,O=P*L+h.y,s.id.features.incidentEdge=y,s.id.features.incidentVertex=0),a=m-M,l=g-O,a/=_=Math.sqrt(a*a+l*l),l/=_,_>v||(e.pointCount=1,p=n.R,e.normal.x=p.col1.x*a+p.col2.x*l,e.normal.y=p.col1.y*a+p.col2.y*l,u=d-v*e.normal.x,c=f-v*e.normal.y,a=u-n.position.x,l=c-n.position.y,p=n.R,s.localPoint1.x=a*p.col1.x+l*p.col1.y,s.localPoint1.y=a*p.col2.x+l*p.col2.y,a=u-o.position.x,l=c-o.position.y,p=o.R,s.localPoint2.x=a*p.col1.x+l*p.col1.y,s.localPoint2.y=a*p.col2.x+l*p.col2.y,s.separation=_-v,s.id.features.referenceEdge=0,s.id.features.flip=0)},t.b2TestOverlap=function(t,e){var i=e.lowerBound,n=t.upperBound,r=i.x-n.x,o=i.y-n.y;i=t.lowerBound,n=e.upperBound;var s=i.x-n.x,a=i.y-n.y;return!(r>0||o>0)&&!(s>0||a>0)},t.b2_nullFeature=255,t.b2CollidePolyTempVec=new _P,t}(),UP=function(){this.__fast__=!0,this.position=new _P,this.velocity=new _P,this.normal=new _P,this.id=new FP},jP=function(){function t(){this.p=new _P}return t.prototype.Support=function(t,e,i){return this.p},t.prototype.GetFirstVertex=function(t){return this.p},t}(),GP=function(){function t(){}return t.ProcessTwo=function(t,e,i,n,r){var o=r[0],s=r[1],a=i[0],l=i[1],u=n[0],c=n[1],h=-s.x,p=-s.y,d=o.x-s.x,f=o.y-s.y,_=Math.sqrt(d*d+f*f),m=h*(d/=_)+p*(f/=_);return m<=0||_<Number.MIN_VALUE?(t.SetV(l),e.SetV(c),a.SetV(l),u.SetV(c),o.SetV(s),1):(m/=_,t.x=l.x+m*(a.x-l.x),t.y=l.y+m*(a.y-l.y),e.x=c.x+m*(u.x-c.x),e.y=c.y+m*(u.y-c.y),2)},t.ProcessThree=function(t,e,i,n,r){var o=r[0],s=r[1],a=r[2],l=i[0],u=i[1],c=i[2],h=n[0],p=n[1],d=n[2],f=o.x,_=o.y,m=s.x,g=s.y,y=a.x,A=a.y,v=m-f,b=g-_,x=y-f,C=A-_,w=y-m,I=A-g,E=-(f*x+_*C),S=y*x+A*C,D=-(m*w+g*I),T=y*w+A*I;if(S<=0&&T<=0)return t.SetV(c),e.SetV(d),l.SetV(c),h.SetV(d),o.SetV(a),1;var P,B=v*C-b*x,M=B*(f*g-_*m),O=B*(m*A-g*y);if(O<=0&&D>=0&&T>=0&&D+T>0)return P=D/(D+T),t.x=u.x+P*(c.x-u.x),t.y=u.y+P*(c.y-u.y),e.x=p.x+P*(d.x-p.x),e.y=p.y+P*(d.y-p.y),l.SetV(c),h.SetV(d),o.SetV(a),2;var L=B*(y*_-A*f);if(L<=0&&E>=0&&S>=0&&E+S>0)return P=E/(E+S),t.x=l.x+P*(c.x-l.x),t.y=l.y+P*(c.y-l.y),e.x=h.x+P*(d.x-h.x),e.y=h.y+P*(d.y-h.y),u.SetV(c),p.SetV(d),s.SetV(a),2;var R=O+L+M,N=O*(R=1/R),F=L*R,k=1-N-F;return t.x=N*l.x+F*u.x+k*c.x,t.y=N*l.y+F*u.y+k*c.y,e.x=N*h.x+F*p.x+k*d.x,e.y=N*h.y+F*p.y+k*d.y,3},t.InPoints=function(t,e,i){for(var n=100*Number.MIN_VALUE,r=0;r<i;++r){var o=e[r],s=Math.abs(t.x-o.x),a=Math.abs(t.y-o.y),l=Math.max(Math.abs(t.x),Math.abs(o.x)),u=Math.max(Math.abs(t.y),Math.abs(o.y));if(s<n*(l+1)&&a<n*(u+1))return!0}return!1},t.DistanceGeneric=function(t,e,i,n,r,o){var s,a=this.s_p1s,l=this.s_p2s,u=this.s_points,c=0;t.SetV(i.GetFirstVertex(n)),e.SetV(r.GetFirstVertex(o));for(var h=0,p=0;p<20;++p){var d=e.x-t.x,f=e.y-t.y,_=i.Support(n,d,f),m=r.Support(o,-d,-f);h=d*d+f*f;var g=m.x-_.x,y=m.y-_.y;if(h-(d*g+f*y)<=.01*h)return 0==c&&(t.SetV(_),e.SetV(m)),this.g_GJK_Iterations=p,Math.sqrt(h);switch(c){case 0:(s=a[0]).SetV(_),(s=l[0]).SetV(m),(s=u[0]).x=g,s.y=y,t.SetV(a[0]),e.SetV(l[0]),++c;break;case 1:(s=a[1]).SetV(_),(s=l[1]).SetV(m),(s=u[1]).x=g,s.y=y,c=this.ProcessTwo(t,e,a,l,u);break;case 2:(s=a[2]).SetV(_),(s=l[2]).SetV(m),(s=u[2]).x=g,s.y=y,c=this.ProcessThree(t,e,a,l,u)}if(3==c)return this.g_GJK_Iterations=p,0;for(var A=-Number.MAX_VALUE,v=0;v<c;++v)s=u[v],A=gP.b2Max(A,s.x*s.x+s.y*s.y);if(3==c||h<=100*Number.MIN_VALUE*A)return this.g_GJK_Iterations=p,h=(d=e.x-t.x)*d+(f=e.y-t.y)*f,Math.sqrt(h)}return this.g_GJK_Iterations=20,Math.sqrt(h)},t.DistanceCC=function(t,e,i,n,r,o){var s,a;s=n.R,a=i.m_localPosition;var l=n.position.x+(s.col1.x*a.x+s.col2.x*a.y),u=n.position.y+(s.col1.y*a.x+s.col2.y*a.y);s=o.R,a=r.m_localPosition;var c=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),h=o.position.y+(s.col1.y*a.x+s.col2.y*a.y),p=c-l,d=h-u,f=p*p+d*d,_=i.m_radius-yP.b2_toiSlop,m=r.m_radius-yP.b2_toiSlop,g=_+m;if(f>g*g){var y=Math.sqrt(p*p+d*d);p/=y,d/=y;var A=y-g;return t.x=l+_*p,t.y=u+_*d,e.x=c-m*p,e.y=h-m*d,A}return f>Number.MIN_VALUE*Number.MIN_VALUE?(p/=y=Math.sqrt(p*p+d*d),d/=y,t.x=l+_*p,t.y=u+_*d,e.x=t.x,e.y=t.y,0):(t.x=l,t.y=u,e.x=t.x,e.y=t.y,0)},t.DistancePC=function(t,e,i,n,r,o){var s,a,l=this.gPoint;a=r.m_localPosition,s=o.R,l.p.x=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),l.p.y=o.position.y+(s.col1.y*a.x+s.col2.y*a.y);var u=this.DistanceGeneric(t,e,i,n,l,gP.b2XForm_identity),c=r.m_radius-yP.b2_toiSlop;if(u>c){u-=c;var h=e.x-t.x,p=e.y-t.y,d=Math.sqrt(h*h+p*p);h/=d,p/=d,e.x-=c*h,e.y-=c*p}else u=0,e.x=t.x,e.y=t.y;return u},t.Distance=function(t,e,i,n,r,o){var s=i.m_type,a=r.m_type;return s==bP.e_circleShape&&a==bP.e_circleShape?this.DistanceCC(t,e,i,n,r,o):s==bP.e_polygonShape&&a==bP.e_circleShape?this.DistancePC(t,e,i,n,r,o):s==bP.e_circleShape&&a==bP.e_polygonShape?this.DistancePC(e,t,r,o,i,n):s==bP.e_polygonShape&&a==bP.e_polygonShape?this.DistanceGeneric(t,e,i,n,r,o):0},t.s_p1s=[new _P,new _P,new _P],t.s_p2s=[new _P,new _P,new _P],t.s_points=[new _P,new _P,new _P],t.gPoint=new jP,t.g_GJK_Iterations=0,t}(),QP=function(){function t(){this.localPoint1=new _P,this.localPoint2=new _P,this.id=new FP}return t.prototype.Reset=function(){this.localPoint1.SetZero(),this.localPoint2.SetZero(),this.separation=0,this.normalImpulse=0,this.tangentImpulse=0,this.id.key=0},t.prototype.Set=function(t){this.localPoint1.SetV(t.localPoint1),this.localPoint2.SetV(t.localPoint2),this.separation=t.separation,this.normalImpulse=t.normalImpulse,this.tangentImpulse=t.tangentImpulse,this.id.key=t.id.key},t}(),zP=function(){function t(){this.__fast__=!0,this.pointCount=0,this.points=new Array(yP.b2_maxManifoldPoints);for(var t=0;t<yP.b2_maxManifoldPoints;t++)this.points[t]=new QP;this.normal=new _P}return t.prototype.Reset=function(){for(var t=0;t<yP.b2_maxManifoldPoints;t++)this.points[t].Reset();this.normal.SetZero(),this.pointCount=0},t.prototype.Set=function(t){this.pointCount=t.pointCount;for(var e=0;e<yP.b2_maxManifoldPoints;e++)this.points[e].Set(t.points[e]);this.normal.SetV(t.normal)},t}(),HP=function(){function t(){}return t.prototype.PairAdded=function(t,e){return null},t.prototype.PairRemoved=function(t,e,i){},t}(),XP=function(){function t(){this.p1=new _P,this.p2=new _P}return t.prototype.TestSegment=function(t,e,i,n){var r=i.p1,o=i.p2.x-r.x,s=i.p2.y-r.y,a=this.p2.x-this.p1.x,l=this.p2.y-this.p1.y,u=-a,c=100*Number.MIN_VALUE,h=-(o*l+s*u);if(h>c){var p=r.x-this.p1.x,d=r.y-this.p1.y,f=p*l+d*u;if(0<=f&&f<=n*h){var _=-s*d+s*p;if(-c*h<=_&&_<=h*(1+c)){f/=h;var m=Math.sqrt(l*l+u*u);return l/=m,u/=m,t[0]=f,e.Set(l,u),!0}}}return!1},t}(),qP=function(){function t(){}return t.TimeOfImpact=function(t,e,i,n){for(var r,o,s=t.m_sweepRadius,a=i.m_sweepRadius,l=e.t0,u=e.c.x-e.c0.x,c=e.c.y-e.c0.y,h=n.c.x-n.c0.x,p=n.c.y-n.c0.y,d=e.a-e.a0,f=n.a-n.a0,_=0,m=this.s_p1,g=this.s_p2,y=0,A=0,v=0,b=0,x=0;;){var C=(1-_)*l+_,w=this.s_xf1,I=this.s_xf2;if(e.GetXForm(w,C),n.GetXForm(I,C),b=GP.Distance(m,g,t,w,i,I),0==y&&(x=b>2*yP.b2_toiSlop?1.5*yP.b2_toiSlop:(r=.05*yP.b2_toiSlop)>(o=b-.5*yP.b2_toiSlop)?r:o),b-x<.05*yP.b2_toiSlop||20==y)break;A=g.x-m.x,v=g.y-m.y;var E=Math.sqrt(A*A+v*v),S=(A/=E)*(u-h)+(v/=E)*(c-p)+(d<0?-d:d)*s+(f<0?-f:f)*a;if(0==S){_=1;break}var D=_+(b-x)/S;if(D<0||1<D){_=1;break}if(D<(1+100*Number.MIN_VALUE)*_)break;_=D,++y}return _},t.s_p1=new _P,t.s_p2=new _P,t.s_xf1=new mP,t.s_xf2=new mP,t}(),YP=function(){function t(t,e,i){this._r=0,this._g=0,this._b=0,this._r=255*gP.b2Clamp(t,0,1)>>>0,this._g=255*gP.b2Clamp(e,0,1)>>>0,this._b=255*gP.b2Clamp(i,0,1)>>>0}return t.prototype.Set=function(t,e,i){this._r=255*gP.b2Clamp(t,0,1)>>>0,this._g=255*gP.b2Clamp(e,0,1)>>>0,this._b=255*gP.b2Clamp(i,0,1)>>>0},Object.defineProperty(t.prototype,"r",{set:function(t){this._r=255*gP.b2Clamp(t,0,1)>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"g",{set:function(t){this._g=255*gP.b2Clamp(t,0,1)>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{set:function(t){this._b=255*gP.b2Clamp(t,0,1)>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._r|this._g<<8|this._b<<16},enumerable:!0,configurable:!0}),t}(),KP=function(){},WP=function(){function t(e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),this.__fast__=!0,this.m_node1=new KP,this.m_node2=new KP,this.m_flags=0,!e||!i)return this.m_shape1=null,void(this.m_shape2=null);(e.IsSensor()||i.IsSensor())&&(this.m_flags|=t.e_nonSolidFlag),this.m_shape1=e,this.m_shape2=i,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=gP.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null}return t.prototype.GetManifolds=function(){return null},t.prototype.GetManifoldCount=function(){return this.m_manifoldCount},t.prototype.IsSolid=function(){return 0==(this.m_flags&t.e_nonSolidFlag)},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetShape1=function(){return this.m_shape1},t.prototype.GetShape2=function(){return this.m_shape2},t.AddType=function(e,i,n,r){t.s_registers[n][r].createFcn=e,t.s_registers[n][r].destroyFcn=i,t.s_registers[n][r].primary=!0,n!=r&&(t.s_registers[r][n].createFcn=e,t.s_registers[r][n].destroyFcn=i,t.s_registers[r][n].primary=!1)},t.prototype.Update=function(e){var i=this.m_manifoldCount;this.Evaluate(e);var n=this.m_manifoldCount,r=this.m_shape1.m_body,o=this.m_shape2.m_body;0==n&&i>0&&(r.WakeUp(),o.WakeUp()),r.IsStatic()||r.IsBullet()||o.IsStatic()||o.IsBullet()?this.m_flags&=~t.e_slowFlag:this.m_flags|=t.e_slowFlag},t.prototype.Evaluate=function(t){},t.e_nonSolidFlag=1,t.e_slowFlag=2,t.e_islandFlag=4,t.e_toiFlag=8,t.s_initialized=!1,t}(),JP=function(t){function e(e,i){var n=t.call(this,e,i)||this;n.m_manifolds=[new zP],n.m0=new zP,n.m_manifold=n.m_manifolds[0],n.m_manifold.pointCount=0;var r=n.m_manifold.points[0];return r.normalImpulse=0,r.tangentImpulse=0,n}return i(e,t),e.Create=function(t,i,n){return new e(t,i)},e.Destroy=function(t,e){},e.prototype.Evaluate=function(t){var i,n,r,o=this.m_shape1.m_body,s=this.m_shape2.m_body;this.m0.Set(this.m_manifold),VP.b2CollideCircles(this.m_manifold,this.m_shape1,o.m_xf,this.m_shape2,s.m_xf);var a=e.s_evalCP;if(a.shape1=this.m_shape1,a.shape2=this.m_shape2,a.friction=this.m_friction,a.restitution=this.m_restitution,this.m_manifold.pointCount>0){this.m_manifoldCount=1;var l=this.m_manifold.points[0];0==this.m0.pointCount?(l.normalImpulse=0,l.tangentImpulse=0,t&&(a.position=o.GetWorldPoint(l.localPoint1),i=o.GetLinearVelocityFromLocalPoint(l.localPoint1),n=s.GetLinearVelocityFromLocalPoint(l.localPoint2),a.velocity.Set(n.x-i.x,n.y-i.y),a.normal.SetV(this.m_manifold.normal),a.separation=l.separation,a.id.key=l.id._key,t.Add(a))):(r=this.m0.points[0],l.normalImpulse=r.normalImpulse,l.tangentImpulse=r.tangentImpulse,t&&(a.position=o.GetWorldPoint(l.localPoint1),i=o.GetLinearVelocityFromLocalPoint(l.localPoint1),n=s.GetLinearVelocityFromLocalPoint(l.localPoint2),a.velocity.Set(n.x-i.x,n.y-i.y),a.normal.SetV(this.m_manifold.normal),a.separation=l.separation,a.id.key=l.id._key,t.Persist(a)))}else this.m_manifoldCount=0,this.m0.pointCount>0&&t&&(r=this.m0.points[0],a.position=o.GetWorldPoint(r.localPoint1),i=o.GetLinearVelocityFromLocalPoint(r.localPoint1),n=s.GetLinearVelocityFromLocalPoint(r.localPoint2),a.velocity.Set(n.x-i.x,n.y-i.y),a.normal.SetV(this.m0.normal),a.separation=r.separation,a.id.key=r.id._key,t.Remove(a))},e.prototype.GetManifolds=function(){return this.m_manifolds},e.s_evalCP=new UP,e}(WP),ZP=function(){this.localAnchor1=new _P,this.localAnchor2=new _P,this.r1=new _P,this.r2=new _P},$P=function(){this.normal=new _P,this.points=new Array(yP.b2_maxManifoldPoints);for(var t=0;t<yP.b2_maxManifoldPoints;t++)this.points[t]=new ZP},tB=function(){},eB=function(){this.position=new _P,this.normal=new _P,this.id=new FP},iB=function(){},nB=function(){function t(t,e,i,n){var r,o,s;for(this.m_step=new iB,this.m_constraints=[],this.m_step.dt=t.dt,this.m_step.inv_dt=t.inv_dt,this.m_step.maxIterations=t.maxIterations,this.m_allocator=n,this.m_constraintCount=0,o=0;o<i;++o)r=e[o],this.m_constraintCount+=r.m_manifoldCount;for(o=0;o<this.m_constraintCount;o++)this.m_constraints[o]=new $P;var a=0;for(o=0;o<i;++o)for(var l=(r=e[o]).m_shape1.m_body,u=r.m_shape2.m_body,c=r.m_manifoldCount,h=r.GetManifolds(),p=r.m_friction,d=r.m_restitution,f=l.m_linearVelocity.x,_=l.m_linearVelocity.y,m=u.m_linearVelocity.x,g=u.m_linearVelocity.y,y=l.m_angularVelocity,A=u.m_angularVelocity,v=0;v<c;++v){var b=h[v],x=b.normal.x,C=b.normal.y,w=this.m_constraints[a];w.body1=l,w.body2=u,w.manifold=b,w.normal.x=x,w.normal.y=C,w.pointCount=b.pointCount,w.friction=p,w.restitution=d;for(var I=0;I<w.pointCount;++I){var E,S,D=b.points[I],T=w.points[I];T.normalImpulse=D.normalImpulse,T.tangentImpulse=D.tangentImpulse,T.separation=D.separation,T.positionImpulse=0,T.localAnchor1.SetV(D.localPoint1),T.localAnchor2.SetV(D.localPoint2),s=l.m_xf.R;var P=D.localPoint1.x-l.m_sweep.localCenter.x,B=D.localPoint1.y-l.m_sweep.localCenter.y;E=s.col1.x*P+s.col2.x*B,B=s.col1.y*P+s.col2.y*B,P=E,T.r1.Set(P,B),s=u.m_xf.R;var M=D.localPoint2.x-u.m_sweep.localCenter.x,O=D.localPoint2.y-u.m_sweep.localCenter.y;E=s.col1.x*M+s.col2.x*O,O=s.col1.y*M+s.col2.y*O,M=E,T.r2.Set(M,O);var L=P*P+B*B,R=M*M+O*O,N=P*x+B*C,F=M*x+O*C,k=l.m_invMass+u.m_invMass;k+=l.m_invI*(L-N*N)+u.m_invI*(R-F*F),T.normalMass=1/k;var V=l.m_mass*l.m_invMass+u.m_mass*u.m_invMass;V+=l.m_mass*l.m_invI*(L-N*N)+u.m_mass*u.m_invI*(R-F*F),T.equalizedMass=1/V;var U=-x,j=P*C+B*U,G=M*C+O*U,Q=l.m_invMass+u.m_invMass;Q+=l.m_invI*(L-j*j)+u.m_invI*(R-G*G),T.tangentMass=1/Q,T.velocityBias=0,T.separation>0&&(T.velocityBias=-60*T.separation),E=m+-A*O-f- -y*B,S=g+A*M-_-y*P;var z=w.normal.x*E+w.normal.y*S;z<-yP.b2_velocityThreshold&&(T.velocityBias+=-w.restitution*z)}++a}}return t.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_constraintCount;++e){var i,n,r=this.m_constraints[e],o=r.body1,s=r.body2,a=o.m_invMass,l=o.m_invI,u=s.m_invMass,c=s.m_invI,h=r.normal.x,p=r.normal.y,d=p,f=-h;if(t.warmStarting)for(n=r.pointCount,i=0;i<n;++i){var _=r.points[i];_.normalImpulse*=t.dtRatio,_.tangentImpulse*=t.dtRatio;var m=_.normalImpulse*h+_.tangentImpulse*d,g=_.normalImpulse*p+_.tangentImpulse*f;o.m_angularVelocity-=l*(_.r1.x*g-_.r1.y*m),o.m_linearVelocity.x-=a*m,o.m_linearVelocity.y-=a*g,s.m_angularVelocity+=c*(_.r2.x*g-_.r2.y*m),s.m_linearVelocity.x+=u*m,s.m_linearVelocity.y+=u*g}else for(n=r.pointCount,i=0;i<n;++i){var y=r.points[i];y.normalImpulse=0,y.tangentImpulse=0}}},t.prototype.SolveVelocityConstraints=function(){for(var t,e,i,n,r,o,s,a,l,u,c,h,p=0;p<this.m_constraintCount;++p){var d=this.m_constraints[p],f=d.body1,_=d.body2,m=f.m_angularVelocity,g=_.m_angularVelocity,y=f.m_linearVelocity,A=_.m_linearVelocity,v=f.m_invMass,b=f.m_invI,x=_.m_invMass,C=_.m_invI,w=d.normal.x,I=d.normal.y,E=I,S=-w,D=d.friction,T=d.pointCount;for(t=0;t<T;++t){e=d.points[t],r=(i=A.x+-g*e.r2.y-y.x- -m*e.r1.y)*w+(n=A.y+g*e.r2.x-y.y-m*e.r1.x)*I,s=-e.normalMass*(r-e.velocityBias),o=i*E+n*S,a=e.tangentMass*-o,s=(l=gP.b2Max(e.normalImpulse+s,0))-e.normalImpulse;var P=D*e.normalImpulse;c=s*w+(a=(u=gP.b2Clamp(e.tangentImpulse+a,-P,P))-e.tangentImpulse)*E,h=s*I+a*S,y.x-=v*c,y.y-=v*h,m-=b*(e.r1.x*h-e.r1.y*c),A.x+=x*c,A.y+=x*h,g+=C*(e.r2.x*h-e.r2.y*c),e.normalImpulse=l,e.tangentImpulse=u}f.m_angularVelocity=m,_.m_angularVelocity=g}},t.prototype.FinalizeVelocityConstraints=function(){for(var t=0;t<this.m_constraintCount;++t)for(var e=this.m_constraints[t],i=e.manifold,n=0;n<e.pointCount;++n){var r=i.points[n],o=e.points[n];r.normalImpulse=o.normalImpulse,r.tangentImpulse=o.tangentImpulse}},t.prototype.SolvePositionConstraints=function(t){for(var e,i,n=0,r=0;r<this.m_constraintCount;++r)for(var o=this.m_constraints[r],s=o.body1,a=o.body2,l=s.m_sweep.c,u=s.m_sweep.a,c=a.m_sweep.c,h=a.m_sweep.a,p=s.m_mass*s.m_invMass,d=s.m_mass*s.m_invI,f=a.m_mass*a.m_invMass,_=a.m_mass*a.m_invI,m=o.normal.x,g=o.normal.y,y=o.pointCount,A=0;A<y;++A){var v=o.points[A];e=s.m_xf.R,i=s.m_sweep.localCenter;var b=v.localAnchor1.x-i.x,x=v.localAnchor1.y-i.y;I=e.col1.x*b+e.col2.x*x,x=e.col1.y*b+e.col2.y*x,b=I,e=a.m_xf.R,i=a.m_sweep.localCenter;var C=v.localAnchor2.x-i.x,w=v.localAnchor2.y-i.y,I=e.col1.x*C+e.col2.x*w;w=e.col1.y*C+e.col2.y*w,C=I;var E=l.x+b,S=l.y+x,D=(c.x+C-E)*m+(c.y+w-S)*g+v.separation;n=gP.b2Min(n,D);var T=t*gP.b2Clamp(D+yP.b2_linearSlop,-yP.b2_maxLinearCorrection,0),P=-v.equalizedMass*T,B=v.positionImpulse;v.positionImpulse=gP.b2Max(B+P,0);var M=(P=v.positionImpulse-B)*m,O=P*g;l.x-=p*M,l.y-=p*O,u-=d*(b*O-x*M),s.m_sweep.a=u,s.SynchronizeTransform(),c.x+=f*M,c.y+=f*O,h+=_*(C*O-w*M),a.m_sweep.a=h,a.SynchronizeTransform()}return n>=-1.5*yP.b2_linearSlop},t}(),rB=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.b2NullContact=function(){},e.prototype.Evaluate=function(t){},e.prototype.GetManifolds=function(){return null},e}(WP),oB=function(t){function e(e,i){var n=t.call(this,e,i)||this;n.m_manifolds=[new zP],n.m0=new zP,n.m_manifold=n.m_manifolds[0],yP.b2Assert(n.m_shape1.m_type==bP.e_polygonShape),yP.b2Assert(n.m_shape2.m_type==bP.e_circleShape),n.m_manifold.pointCount=0;var r=n.m_manifold.points[0];return r.normalImpulse=0,r.tangentImpulse=0,n}return i(e,t),e.Create=function(t,i,n){return new e(t,i)},e.Destroy=function(t,e){},e.prototype.Evaluate=function(t){var i,n,r,o,s=this.m_shape1.m_body,a=this.m_shape2.m_body;this.m0.Set(this.m_manifold),VP.b2CollidePolygonAndCircle(this.m_manifold,this.m_shape1,s.m_xf,this.m_shape2,a.m_xf);var l=[!1,!1],u=e.s_evalCP;if(u.shape1=this.m_shape1,u.shape2=this.m_shape2,u.friction=this.m_friction,u.restitution=this.m_restitution,this.m_manifold.pointCount>0){for(i=0;i<this.m_manifold.pointCount;++i){var c=this.m_manifold.points[i];c.normalImpulse=0,c.tangentImpulse=0;for(var h=!1,p=c.id._key,d=0;d<this.m0.pointCount;++d)if(1!=l[d]&&(o=this.m0.points[d]).id._key==p){l[d]=!0,c.normalImpulse=o.normalImpulse,c.tangentImpulse=o.tangentImpulse,h=!0,null!=t&&(u.position=s.GetWorldPoint(c.localPoint1),n=s.GetLinearVelocityFromLocalPoint(c.localPoint1),r=a.GetLinearVelocityFromLocalPoint(c.localPoint2),u.velocity.Set(r.x-n.x,r.y-n.y),u.normal.SetV(this.m_manifold.normal),u.separation=c.separation,u.id.key=p,t.Persist(u));break}0==h&&null!=t&&(u.position=s.GetWorldPoint(c.localPoint1),n=s.GetLinearVelocityFromLocalPoint(c.localPoint1),r=a.GetLinearVelocityFromLocalPoint(c.localPoint2),u.velocity.Set(r.x-n.x,r.y-n.y),u.normal.SetV(this.m_manifold.normal),u.separation=c.separation,u.id.key=p,t.Add(u))}this.m_manifoldCount=1}else this.m_manifoldCount=0;if(null!=t)for(i=0;i<this.m0.pointCount;++i)l[i]||(o=this.m0.points[i],u.position=s.GetWorldPoint(o.localPoint1),n=s.GetLinearVelocityFromLocalPoint(o.localPoint1),r=a.GetLinearVelocityFromLocalPoint(o.localPoint2),u.velocity.Set(r.x-n.x,r.y-n.y),u.normal.SetV(this.m0.normal),u.separation=o.separation,u.id.key=o.id._key,t.Remove(u))},e.prototype.GetManifolds=function(){return this.m_manifolds},e.s_evalCP=new UP,e}(WP),sB=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.m0=new zP,n.m_manifolds=[new zP],n.m_manifold=n.m_manifolds[0],n.m_manifold.pointCount=0,n}return i(e,t),e.Create=function(t,i,n){return new e(t,i)},e.Destroy=function(t,e){},e.prototype.Evaluate=function(t){var i,n,r,o,s,a=this.m_shape1.m_body,l=this.m_shape2.m_body;this.m0.Set(this.m_manifold),VP.b2CollidePolygons(this.m_manifold,this.m_shape1,a.m_xf,this.m_shape2,l.m_xf);var u=[!1,!1];if((o=e.s_evalCP).shape1=this.m_shape1,o.shape2=this.m_shape2,o.friction=this.m_friction,o.restitution=this.m_restitution,this.m_manifold.pointCount>0){for(s=0;s<this.m_manifold.pointCount;++s){var c=this.m_manifold.points[s];c.normalImpulse=0,c.tangentImpulse=0;for(var h=!1,p=c.id._key,d=0;d<this.m0.pointCount;++d)if(1!=u[d]&&(r=this.m0.points[d]).id._key==p){u[d]=!0,c.normalImpulse=r.normalImpulse,c.tangentImpulse=r.tangentImpulse,h=!0,null!=t&&(o.position=a.GetWorldPoint(c.localPoint1),i=a.GetLinearVelocityFromLocalPoint(c.localPoint1),n=l.GetLinearVelocityFromLocalPoint(c.localPoint2),o.velocity.Set(n.x-i.x,n.y-i.y),o.normal.SetV(this.m_manifold.normal),o.separation=c.separation,o.id.key=p,t.Persist(o));break}0==h&&null!=t&&(o.position=a.GetWorldPoint(c.localPoint1),i=a.GetLinearVelocityFromLocalPoint(c.localPoint1),n=l.GetLinearVelocityFromLocalPoint(c.localPoint2),o.velocity.Set(n.x-i.x,n.y-i.y),o.normal.SetV(this.m_manifold.normal),o.separation=c.separation,o.id.key=p,t.Add(o))}this.m_manifoldCount=1}else this.m_manifoldCount=0;if(null!=t)for(s=0;s<this.m0.pointCount;++s)u[s]||(r=this.m0.points[s],o.position=a.GetWorldPoint(r.localPoint1),i=a.GetLinearVelocityFromLocalPoint(r.localPoint1),n=l.GetLinearVelocityFromLocalPoint(r.localPoint2),o.velocity.Set(n.x-i.x,n.y-i.y),o.normal.SetV(this.m0.normal),o.separation=r.separation,o.id.key=r.id._key,t.Remove(o))},e.prototype.GetManifolds=function(){return this.m_manifolds},e.s_evalCP=new UP,e}(WP),aB=function(){function t(t){this.__fast__=!0,this.m_node1=new dB,this.m_node2=new dB,this.m_type=t.type,this.m_prev=null,this.m_next=null,this.m_body1=t.body1,this.m_body2=t.body2,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData}return t.prototype.GetType=function(){return this.m_type},t.prototype.GetAnchor1=function(){return null},t.prototype.GetAnchor2=function(){return null},t.prototype.GetReactionForce=function(){return null},t.prototype.GetReactionTorque=function(){return 0},t.prototype.GetBody1=function(){return this.m_body1},t.prototype.GetBody2=function(){return this.m_body2},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.Create=function(e,i){var n=null;switch(e.type){case t.e_distanceJoint:n=new xB(e);break;case t.e_mouseJoint:n=new fB(e);break;case t.e_prismaticJoint:n=new mB(e);break;case t.e_revoluteJoint:n=new vB(e);break;case t.e_pulleyJoint:n=new yB(e);break;case t.e_gearJoint:n=new hB(e)}return n},t.Destroy=function(t,e){},t.prototype.InitVelocityConstraints=function(t){},t.prototype.SolveVelocityConstraints=function(t){},t.prototype.InitPositionConstraints=function(){},t.prototype.SolvePositionConstraints=function(){return!1},t.e_unknownJoint=0,t.e_revoluteJoint=1,t.e_prismaticJoint=2,t.e_distanceJoint=3,t.e_pulleyJoint=4,t.e_mouseJoint=5,t.e_gearJoint=6,t.e_inactiveLimit=0,t.e_atLowerLimit=1,t.e_atUpperLimit=2,t.e_equalLimits=3,t}(),lB=function(){this.type=aB.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1},uB=function(t){function e(){var e=t.call(this)||this;return e.localAnchor1=new _P,e.localAnchor2=new _P,e.type=aB.e_distanceJoint,e.length=1,e.frequencyHz=0,e.dampingRatio=0,e}return i(e,t),e.prototype.Initialize=function(t,e,i,n){this.body1=t,this.body2=e,this.localAnchor1.SetV(this.body1.GetLocalPoint(i)),this.localAnchor2.SetV(this.body2.GetLocalPoint(n));var r=n.x-i.x,o=n.y-i.y;this.length=Math.sqrt(r*r+o*o),this.frequencyHz=0,this.dampingRatio=0},e}(lB),cB=function(){function t(){this.linear1=new _P,this.linear2=new _P}return t.prototype.SetZero=function(){this.linear1.SetZero(),this.angular1=0,this.linear2.SetZero(),this.angular2=0},t.prototype.Set=function(t,e,i,n){this.linear1.SetV(t),this.angular1=e,this.linear2.SetV(i),this.angular2=n},t.prototype.Compute=function(t,e,i,n){return this.linear1.x*t.x+this.linear1.y*t.y+this.angular1*e+(this.linear2.x*i.x+this.linear2.y*i.y)+this.angular2*n},t}(),hB=function(t){function e(e){var i=t.call(this,e)||this;i.m_groundAnchor1=new _P,i.m_groundAnchor2=new _P,i.m_localAnchor1=new _P,i.m_localAnchor2=new _P,i.m_J=new cB;var n,r,o=e.joint1.m_type,s=e.joint2.m_type;return i.m_revolute1=null,i.m_prismatic1=null,i.m_revolute2=null,i.m_prismatic2=null,i.m_ground1=e.joint1.m_body1,i.m_body1=e.joint1.m_body2,o==aB.e_revoluteJoint?(i.m_revolute1=e.joint1,i.m_groundAnchor1.SetV(i.m_revolute1.m_localAnchor1),i.m_localAnchor1.SetV(i.m_revolute1.m_localAnchor2),n=i.m_revolute1.GetJointAngle()):(i.m_prismatic1=e.joint1,i.m_groundAnchor1.SetV(i.m_prismatic1.m_localAnchor1),i.m_localAnchor1.SetV(i.m_prismatic1.m_localAnchor2),n=i.m_prismatic1.GetJointTranslation()),i.m_ground2=e.joint2.m_body1,i.m_body2=e.joint2.m_body2,s==aB.e_revoluteJoint?(i.m_revolute2=e.joint2,i.m_groundAnchor2.SetV(i.m_revolute2.m_localAnchor1),i.m_localAnchor2.SetV(i.m_revolute2.m_localAnchor2),r=i.m_revolute2.GetJointAngle()):(i.m_prismatic2=e.joint2,i.m_groundAnchor2.SetV(i.m_prismatic2.m_localAnchor1),i.m_localAnchor2.SetV(i.m_prismatic2.m_localAnchor2),r=i.m_prismatic2.GetJointTranslation()),i.m_ratio=e.ratio,i.m_constant=n+i.m_ratio*r,i.m_force=0,i}return i(e,t),e.prototype.GetAnchor1=function(){return this.m_body1.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchor2=function(){return this.m_body2.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(){return new _P(this.m_force*this.m_J.linear2.x,this.m_force*this.m_J.linear2.y)},e.prototype.GetReactionTorque=function(){var t=this.m_body2.m_xf.R,e=this.m_localAnchor1.x-this.m_body2.m_sweep.localCenter.x,i=this.m_localAnchor1.y-this.m_body2.m_sweep.localCenter.y,n=t.col1.x*e+t.col2.x*i;return i=t.col1.y*e+t.col2.y*i,e=n,n=this.m_force*this.m_J.angular2-(e*(this.m_force*this.m_J.linear2.y)-i*(this.m_force*this.m_J.linear2.x))},e.prototype.GetRatio=function(){return this.m_ratio},e.prototype.InitVelocityConstraints=function(t){var e,i,n,r,o,s,a,l,u=this.m_ground1,c=this.m_ground2,h=this.m_body1,p=this.m_body2,d=0;if(this.m_J.SetZero(),this.m_revolute1?(this.m_J.angular1=-1,d+=h.m_invI):(o=u.m_xf.R,s=this.m_prismatic1.m_localXAxis1,e=o.col1.x*s.x+o.col2.x*s.y,i=o.col1.y*s.x+o.col2.y*s.y,o=h.m_xf.R,n=this.m_localAnchor1.x-h.m_sweep.localCenter.x,r=this.m_localAnchor1.y-h.m_sweep.localCenter.y,l=o.col1.x*n+o.col2.x*r,r=o.col1.y*n+o.col2.y*r,a=(n=l)*i-r*e,this.m_J.linear1.Set(-e,-i),this.m_J.angular1=-a,d+=h.m_invMass+h.m_invI*a*a),this.m_revolute2?(this.m_J.angular2=-this.m_ratio,d+=this.m_ratio*this.m_ratio*p.m_invI):(o=c.m_xf.R,s=this.m_prismatic2.m_localXAxis1,e=o.col1.x*s.x+o.col2.x*s.y,i=o.col1.y*s.x+o.col2.y*s.y,o=p.m_xf.R,n=this.m_localAnchor2.x-p.m_sweep.localCenter.x,r=this.m_localAnchor2.y-p.m_sweep.localCenter.y,l=o.col1.x*n+o.col2.x*r,r=o.col1.y*n+o.col2.y*r,a=(n=l)*i-r*e,this.m_J.linear2.Set(-this.m_ratio*e,-this.m_ratio*i),this.m_J.angular2=-this.m_ratio*a,d+=this.m_ratio*this.m_ratio*(p.m_invMass+p.m_invI*a*a)),this.m_mass=1/d,t.warmStarting){var f=t.dt*this.m_force;h.m_linearVelocity.x+=h.m_invMass*f*this.m_J.linear1.x,h.m_linearVelocity.y+=h.m_invMass*f*this.m_J.linear1.y,h.m_angularVelocity+=h.m_invI*f*this.m_J.angular1,p.m_linearVelocity.x+=p.m_invMass*f*this.m_J.linear2.x,p.m_linearVelocity.y+=p.m_invMass*f*this.m_J.linear2.y,p.m_angularVelocity+=p.m_invI*f*this.m_J.angular2}else this.m_force=0},e.prototype.SolveVelocityConstraints=function(t){var e=this.m_body1,i=this.m_body2,n=this.m_J.Compute(e.m_linearVelocity,e.m_angularVelocity,i.m_linearVelocity,i.m_angularVelocity),r=-t.inv_dt*this.m_mass*n;this.m_force+=r;var o=t.dt*r;e.m_linearVelocity.x+=e.m_invMass*o*this.m_J.linear1.x,e.m_linearVelocity.y+=e.m_invMass*o*this.m_J.linear1.y,e.m_angularVelocity+=e.m_invI*o*this.m_J.angular1,i.m_linearVelocity.x+=i.m_invMass*o*this.m_J.linear2.x,i.m_linearVelocity.y+=i.m_invMass*o*this.m_J.linear2.y,i.m_angularVelocity+=i.m_invI*o*this.m_J.angular2},e.prototype.SolvePositionConstraints=function(){var t,e,i=this.m_body1,n=this.m_body2;t=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),e=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var r=this.m_constant-(t+this.m_ratio*e),o=-this.m_mass*r;return i.m_sweep.c.x+=i.m_invMass*o*this.m_J.linear1.x,i.m_sweep.c.y+=i.m_invMass*o*this.m_J.linear1.y,i.m_sweep.a+=i.m_invI*o*this.m_J.angular1,n.m_sweep.c.x+=n.m_invMass*o*this.m_J.linear2.x,n.m_sweep.c.y+=n.m_invMass*o*this.m_J.linear2.y,n.m_sweep.a+=n.m_invI*o*this.m_J.angular2,i.SynchronizeTransform(),n.SynchronizeTransform(),0<yP.b2_linearSlop},e}(aB),pB=function(t){function e(){var e=t.call(this)||this;return e.type=aB.e_gearJoint,e.joint1=null,e.joint2=null,e.ratio=1,e}return i(e,t),e}(lB),dB=function(){},fB=function(t){function e(e){var i=t.call(this,e)||this;i.K=new dP,i.K1=new dP,i.K2=new dP,i.m_localAnchor=new _P,i.m_target=new _P,i.m_impulse=new _P,i.m_mass=new dP,i.m_C=new _P,i.m_target.SetV(e.target);var n=i.m_target.x-i.m_body2.m_xf.position.x,r=i.m_target.y-i.m_body2.m_xf.position.y,o=i.m_body2.m_xf.R;i.m_localAnchor.x=n*o.col1.x+r*o.col1.y,i.m_localAnchor.y=n*o.col2.x+r*o.col2.y,i.m_maxForce=e.maxForce,i.m_impulse.SetZero();var s=i.m_body2.m_mass,a=2*yP.b2_pi*e.frequencyHz,l=2*s*e.dampingRatio*a,u=e.timeStep*s*(a*a);return i.m_gamma=1/(l+u),i.m_beta=u/(l+u),i}return i(e,t),e.prototype.GetAnchor1=function(){return this.m_target},e.prototype.GetAnchor2=function(){return this.m_body2.GetWorldPoint(this.m_localAnchor)},e.prototype.GetReactionForce=function(){return this.m_impulse},e.prototype.GetReactionTorque=function(){return 0},e.prototype.SetTarget=function(t){this.m_body2.IsSleeping()&&this.m_body2.WakeUp(),this.m_target=t},e.prototype.InitVelocityConstraints=function(t){var e,i=this.m_body2;e=i.m_xf.R;var n=this.m_localAnchor.x-i.m_sweep.localCenter.x,r=this.m_localAnchor.y-i.m_sweep.localCenter.y,o=e.col1.x*n+e.col2.x*r;r=e.col1.y*n+e.col2.y*r,n=o;var s=i.m_invMass,a=i.m_invI;this.K1.col1.x=s,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=s,this.K2.col1.x=a*r*r,this.K2.col2.x=-a*n*r,this.K2.col1.y=-a*n*r,this.K2.col2.y=a*n*n,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.Invert(this.m_mass),this.m_C.x=i.m_sweep.c.x+n-this.m_target.x,this.m_C.y=i.m_sweep.c.y+r-this.m_target.y,i.m_angularVelocity*=.98;var l=t.dt*this.m_impulse.x,u=t.dt*this.m_impulse.y;i.m_linearVelocity.x+=s*l,i.m_linearVelocity.y+=s*u,i.m_angularVelocity+=a*(n*u-r*l)},e.prototype.SolveVelocityConstraints=function(t){var e,i,n,r=this.m_body2;e=r.m_xf.R;var o=this.m_localAnchor.x-r.m_sweep.localCenter.x,s=this.m_localAnchor.y-r.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i;var a=r.m_linearVelocity.x+-r.m_angularVelocity*s,l=r.m_linearVelocity.y+r.m_angularVelocity*o;e=this.m_mass,i=a+this.m_beta*t.inv_dt*this.m_C.x+this.m_gamma*t.dt*this.m_impulse.x,n=l+this.m_beta*t.inv_dt*this.m_C.y+this.m_gamma*t.dt*this.m_impulse.y;var u=-t.inv_dt*(e.col1.x*i+e.col2.x*n),c=-t.inv_dt*(e.col1.y*i+e.col2.y*n),h=this.m_impulse.x,p=this.m_impulse.y;this.m_impulse.x+=u,this.m_impulse.y+=c;var d=this.m_impulse.Length();d>this.m_maxForce&&this.m_impulse.Multiply(this.m_maxForce/d),u=this.m_impulse.x-h,c=this.m_impulse.y-p;var f=t.dt*u,_=t.dt*c;r.m_linearVelocity.x+=r.m_invMass*f,r.m_linearVelocity.y+=r.m_invMass*_,r.m_angularVelocity+=r.m_invI*(o*_-s*f)},e.prototype.SolvePositionConstraints=function(){return!0},e}(aB),_B=function(t){function e(){var e=t.call(this)||this;return e.target=new _P,e.type=aB.e_mouseJoint,e.maxForce=0,e.frequencyHz=5,e.dampingRatio=.7,e.timeStep=1/60,e}return i(e,t),e}(lB),mB=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchor1=new _P,i.m_localAnchor2=new _P,i.m_localXAxis1=new _P,i.m_localYAxis1=new _P,i.m_linearJacobian=new cB,i.m_motorJacobian=new cB,i.m_localAnchor1.SetV(e.localAnchor1),i.m_localAnchor2.SetV(e.localAnchor2),i.m_localXAxis1.SetV(e.localAxis1),i.m_localYAxis1.x=-i.m_localXAxis1.y,i.m_localYAxis1.y=i.m_localXAxis1.x,i.m_refAngle=e.referenceAngle,i.m_linearJacobian.SetZero(),i.m_linearMass=0,i.m_force=0,i.m_angularMass=0,i.m_torque=0,i.m_motorJacobian.SetZero(),i.m_motorMass=0,i.m_motorForce=0,i.m_limitForce=0,i.m_limitPositionImpulse=0,i.m_lowerTranslation=e.lowerTranslation,i.m_upperTranslation=e.upperTranslation,i.m_maxMotorForce=e.maxMotorForce,i.m_motorSpeed=e.motorSpeed,i.m_enableLimit=e.enableLimit,i.m_enableMotor=e.enableMotor,i}return i(e,t),e.prototype.GetAnchor1=function(){return this.m_body1.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchor2=function(){return this.m_body2.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(){var t=this.m_body1.m_xf.R,e=this.m_limitForce*(t.col1.x*this.m_localXAxis1.x+t.col2.x*this.m_localXAxis1.y),i=this.m_limitForce*(t.col1.y*this.m_localXAxis1.x+t.col2.y*this.m_localXAxis1.y),n=this.m_force*(t.col1.x*this.m_localYAxis1.x+t.col2.x*this.m_localYAxis1.y),r=this.m_force*(t.col1.y*this.m_localYAxis1.x+t.col2.y*this.m_localYAxis1.y);return new _P(this.m_limitForce*e+this.m_force*n,this.m_limitForce*i+this.m_force*r)},e.prototype.GetReactionTorque=function(){return this.m_torque},e.prototype.GetJointTranslation=function(){var t=this.m_body1,e=this.m_body2,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),r=n.x-i.x,o=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*r+s.y*o},e.prototype.GetJointSpeed=function(){var t,e=this.m_body1,i=this.m_body2;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=o;var l=e.m_sweep.c.x+n,u=e.m_sweep.c.y+r,c=i.m_sweep.c.x+s-l,h=i.m_sweep.c.y+a-u,p=e.GetWorldVector(this.m_localXAxis1),d=e.m_linearVelocity,f=i.m_linearVelocity,_=e.m_angularVelocity,m=i.m_angularVelocity;return c*(-_*p.y)+h*(_*p.x)+(p.x*(f.x+-m*a-d.x- -_*r)+p.y*(f.y+m*s-d.y-_*n))},e.prototype.IsLimitEnabled=function(){return this.m_enableLimit},e.prototype.EnableLimit=function(t){this.m_enableLimit=t},e.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},e.prototype.GetUpperLimit=function(){return this.m_upperTranslation},e.prototype.SetLimits=function(t,e){this.m_lowerTranslation=t,this.m_upperTranslation=e},e.prototype.IsMotorEnabled=function(){return this.m_enableMotor},e.prototype.EnableMotor=function(t){this.m_enableMotor=t},e.prototype.SetMotorSpeed=function(t){this.m_motorSpeed=t},e.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},e.prototype.SetMaxMotorForce=function(t){this.m_maxMotorForce=t},e.prototype.GetMotorForce=function(){return this.m_motorForce},e.prototype.InitVelocityConstraints=function(t){var i,n,r=this.m_body1,o=this.m_body2;i=r.m_xf.R;var s=this.m_localAnchor1.x-r.m_sweep.localCenter.x,a=this.m_localAnchor1.y-r.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=o.m_xf.R;var l=this.m_localAnchor2.x-o.m_sweep.localCenter.x,u=this.m_localAnchor2.y-o.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*u,u=i.col1.y*l+i.col2.y*u,l=n;var c=r.m_invMass,h=o.m_invMass,p=r.m_invI,d=o.m_invI,f=(i=r.m_xf.R).col1.x*this.m_localYAxis1.x+i.col2.x*this.m_localYAxis1.y,_=i.col1.y*this.m_localYAxis1.x+i.col2.y*this.m_localYAxis1.y,m=o.m_sweep.c.x+l-r.m_sweep.c.x,g=o.m_sweep.c.y+u-r.m_sweep.c.y;if(this.m_linearJacobian.linear1.x=-f,this.m_linearJacobian.linear1.y=-_,this.m_linearJacobian.linear2.x=f,this.m_linearJacobian.linear2.y=_,this.m_linearJacobian.angular1=-(m*_-g*f),this.m_linearJacobian.angular2=l*_-u*f,this.m_linearMass=c+p*this.m_linearJacobian.angular1*this.m_linearJacobian.angular1+h+d*this.m_linearJacobian.angular2*this.m_linearJacobian.angular2,this.m_linearMass=1/this.m_linearMass,this.m_angularMass=p+d,this.m_angularMass>Number.MIN_VALUE&&(this.m_angularMass=1/this.m_angularMass),this.m_enableLimit||this.m_enableMotor){var y=(i=r.m_xf.R).col1.x*this.m_localXAxis1.x+i.col2.x*this.m_localXAxis1.y,A=i.col1.y*this.m_localXAxis1.x+i.col2.y*this.m_localXAxis1.y;if(this.m_motorJacobian.linear1.x=-y,this.m_motorJacobian.linear1.y=-A,this.m_motorJacobian.linear2.x=y,this.m_motorJacobian.linear2.y=A,this.m_motorJacobian.angular1=-(m*A-g*y),this.m_motorJacobian.angular2=l*A-u*y,this.m_motorMass=c+p*this.m_motorJacobian.angular1*this.m_motorJacobian.angular1+h+d*this.m_motorJacobian.angular2*this.m_motorJacobian.angular2,this.m_motorMass=1/this.m_motorMass,this.m_enableLimit){var v=y*(m-s)+A*(g-a);gP.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*yP.b2_linearSlop?this.m_limitState=e.e_equalLimits:v<=this.m_lowerTranslation?(this.m_limitState!=e.e_atLowerLimit&&(this.m_limitForce=0),this.m_limitState=e.e_atLowerLimit):v>=this.m_upperTranslation?(this.m_limitState!=e.e_atUpperLimit&&(this.m_limitForce=0),this.m_limitState=e.e_atUpperLimit):(this.m_limitState=e.e_inactiveLimit,this.m_limitForce=0)}}if(0==this.m_enableMotor&&(this.m_motorForce=0),0==this.m_enableLimit&&(this.m_limitForce=0),t.warmStarting){var b=t.dt*(this.m_force*this.m_linearJacobian.linear1.x+(this.m_motorForce+this.m_limitForce)*this.m_motorJacobian.linear1.x),x=t.dt*(this.m_force*this.m_linearJacobian.linear1.y+(this.m_motorForce+this.m_limitForce)*this.m_motorJacobian.linear1.y),C=t.dt*(this.m_force*this.m_linearJacobian.linear2.x+(this.m_motorForce+this.m_limitForce)*this.m_motorJacobian.linear2.x),w=t.dt*(this.m_force*this.m_linearJacobian.linear2.y+(this.m_motorForce+this.m_limitForce)*this.m_motorJacobian.linear2.y),I=t.dt*(this.m_force*this.m_linearJacobian.angular1-this.m_torque+(this.m_motorForce+this.m_limitForce)*this.m_motorJacobian.angular1),E=t.dt*(this.m_force*this.m_linearJacobian.angular2+this.m_torque+(this.m_motorForce+this.m_limitForce)*this.m_motorJacobian.angular2);r.m_linearVelocity.x+=c*b,r.m_linearVelocity.y+=c*x,r.m_angularVelocity+=p*I,o.m_linearVelocity.x+=h*C,o.m_linearVelocity.y+=h*w,o.m_angularVelocity+=d*E}else this.m_force=0,this.m_torque=0,this.m_limitForce=0,this.m_motorForce=0;this.m_limitPositionImpulse=0},e.prototype.SolveVelocityConstraints=function(t){var i,n=this.m_body1,r=this.m_body2,o=n.m_invMass,s=r.m_invMass,a=n.m_invI,l=r.m_invI,u=this.m_linearJacobian.Compute(n.m_linearVelocity,n.m_angularVelocity,r.m_linearVelocity,r.m_angularVelocity),c=-t.inv_dt*this.m_linearMass*u;this.m_force+=c;var h=t.dt*c;n.m_linearVelocity.x+=o*h*this.m_linearJacobian.linear1.x,n.m_linearVelocity.y+=o*h*this.m_linearJacobian.linear1.y,n.m_angularVelocity+=a*h*this.m_linearJacobian.angular1,r.m_linearVelocity.x+=s*h*this.m_linearJacobian.linear2.x,r.m_linearVelocity.y+=s*h*this.m_linearJacobian.linear2.y,r.m_angularVelocity+=l*h*this.m_linearJacobian.angular2;var p=r.m_angularVelocity-n.m_angularVelocity,d=-t.inv_dt*this.m_angularMass*p;this.m_torque+=d;var f=t.dt*d;if(n.m_angularVelocity-=a*f,r.m_angularVelocity+=l*f,this.m_enableMotor&&this.m_limitState!=e.e_equalLimits){var _=this.m_motorJacobian.Compute(n.m_linearVelocity,n.m_angularVelocity,r.m_linearVelocity,r.m_angularVelocity)-this.m_motorSpeed,m=-t.inv_dt*this.m_motorMass*_,g=this.m_motorForce;this.m_motorForce=gP.b2Clamp(this.m_motorForce+m,-this.m_maxMotorForce,this.m_maxMotorForce),m=this.m_motorForce-g,h=t.dt*m,n.m_linearVelocity.x+=o*h*this.m_motorJacobian.linear1.x,n.m_linearVelocity.y+=o*h*this.m_motorJacobian.linear1.y,n.m_angularVelocity+=a*h*this.m_motorJacobian.angular1,r.m_linearVelocity.x+=s*h*this.m_motorJacobian.linear2.x,r.m_linearVelocity.y+=s*h*this.m_motorJacobian.linear2.y,r.m_angularVelocity+=l*h*this.m_motorJacobian.angular2}if(this.m_enableLimit&&this.m_limitState!=e.e_inactiveLimit){var y=this.m_motorJacobian.Compute(n.m_linearVelocity,n.m_angularVelocity,r.m_linearVelocity,r.m_angularVelocity),A=-t.inv_dt*this.m_motorMass*y;this.m_limitState==e.e_equalLimits?this.m_limitForce+=A:this.m_limitState==e.e_atLowerLimit?(i=this.m_limitForce,this.m_limitForce=gP.b2Max(this.m_limitForce+A,0),A=this.m_limitForce-i):this.m_limitState==e.e_atUpperLimit&&(i=this.m_limitForce,this.m_limitForce=gP.b2Min(this.m_limitForce+A,0),A=this.m_limitForce-i),h=t.dt*A,n.m_linearVelocity.x+=o*h*this.m_motorJacobian.linear1.x,n.m_linearVelocity.y+=o*h*this.m_motorJacobian.linear1.y,n.m_angularVelocity+=a*h*this.m_motorJacobian.angular1,r.m_linearVelocity.x+=s*h*this.m_motorJacobian.linear2.x,r.m_linearVelocity.y+=s*h*this.m_motorJacobian.linear2.y,r.m_angularVelocity+=l*h*this.m_motorJacobian.angular2}},e.prototype.SolvePositionConstraints=function(){var t,i,n,r,o=this.m_body1,s=this.m_body2,a=o.m_invMass,l=s.m_invMass,u=o.m_invI,c=s.m_invI;n=o.m_xf.R;var h=this.m_localAnchor1.x-o.m_sweep.localCenter.x,p=this.m_localAnchor1.y-o.m_sweep.localCenter.y;r=n.col1.x*h+n.col2.x*p,p=n.col1.y*h+n.col2.y*p,h=r,n=s.m_xf.R;var d=this.m_localAnchor2.x-s.m_sweep.localCenter.x,f=this.m_localAnchor2.y-s.m_sweep.localCenter.y;r=n.col1.x*d+n.col2.x*f,f=n.col1.y*d+n.col2.y*f,d=r;var _=o.m_sweep.c.x+h,m=o.m_sweep.c.y+p,g=s.m_sweep.c.x+d,y=s.m_sweep.c.y+f,A=g-_,v=y-m,b=((n=o.m_xf.R).col1.x*this.m_localYAxis1.x+n.col2.x*this.m_localYAxis1.y)*A+(n.col1.y*this.m_localYAxis1.x+n.col2.y*this.m_localYAxis1.y)*v;b=gP.b2Clamp(b,-yP.b2_maxLinearCorrection,yP.b2_maxLinearCorrection);var x=-this.m_linearMass*b;o.m_sweep.c.x+=a*x*this.m_linearJacobian.linear1.x,o.m_sweep.c.y+=a*x*this.m_linearJacobian.linear1.y,o.m_sweep.a+=u*x*this.m_linearJacobian.angular1,s.m_sweep.c.x+=l*x*this.m_linearJacobian.linear2.x,s.m_sweep.c.y+=l*x*this.m_linearJacobian.linear2.y,s.m_sweep.a+=c*x*this.m_linearJacobian.angular2;var C=gP.b2Abs(b),w=s.m_sweep.a-o.m_sweep.a-this.m_refAngle;w=gP.b2Clamp(w,-yP.b2_maxAngularCorrection,yP.b2_maxAngularCorrection);var I=-this.m_angularMass*w;o.m_sweep.a-=o.m_invI*I,s.m_sweep.a+=s.m_invI*I,o.SynchronizeTransform(),s.SynchronizeTransform();var E=gP.b2Abs(w);if(this.m_enableLimit&&this.m_limitState!=e.e_inactiveLimit){n=o.m_xf.R,h=this.m_localAnchor1.x-o.m_sweep.localCenter.x,p=this.m_localAnchor1.y-o.m_sweep.localCenter.y,r=n.col1.x*h+n.col2.x*p,p=n.col1.y*h+n.col2.y*p,h=r,n=s.m_xf.R,d=this.m_localAnchor2.x-s.m_sweep.localCenter.x,f=this.m_localAnchor2.y-s.m_sweep.localCenter.y,r=n.col1.x*d+n.col2.x*f,f=n.col1.y*d+n.col2.y*f,d=r,_=o.m_sweep.c.x+h,m=o.m_sweep.c.y+p,A=(g=s.m_sweep.c.x+d)-_,v=(y=s.m_sweep.c.y+f)-m;var S=((n=o.m_xf.R).col1.x*this.m_localXAxis1.x+n.col2.x*this.m_localXAxis1.y)*A+(n.col1.y*this.m_localXAxis1.x+n.col2.y*this.m_localXAxis1.y)*v,D=0;this.m_limitState==e.e_equalLimits?(t=gP.b2Clamp(S,-yP.b2_maxLinearCorrection,yP.b2_maxLinearCorrection),D=-this.m_motorMass*t,C=gP.b2Max(C,gP.b2Abs(w))):this.m_limitState==e.e_atLowerLimit?(t=S-this.m_lowerTranslation,C=gP.b2Max(C,-t),t=gP.b2Clamp(t+yP.b2_linearSlop,-yP.b2_maxLinearCorrection,0),D=-this.m_motorMass*t,i=this.m_limitPositionImpulse,this.m_limitPositionImpulse=gP.b2Max(this.m_limitPositionImpulse+D,0),D=this.m_limitPositionImpulse-i):this.m_limitState==e.e_atUpperLimit&&(t=S-this.m_upperTranslation,C=gP.b2Max(C,t),t=gP.b2Clamp(t-yP.b2_linearSlop,0,yP.b2_maxLinearCorrection),D=-this.m_motorMass*t,i=this.m_limitPositionImpulse,this.m_limitPositionImpulse=gP.b2Min(this.m_limitPositionImpulse+D,0),D=this.m_limitPositionImpulse-i),o.m_sweep.c.x+=a*D*this.m_motorJacobian.linear1.x,o.m_sweep.c.y+=a*D*this.m_motorJacobian.linear1.y,o.m_sweep.a+=u*D*this.m_motorJacobian.angular1,s.m_sweep.c.x+=l*D*this.m_motorJacobian.linear2.x,s.m_sweep.c.y+=l*D*this.m_motorJacobian.linear2.y,s.m_sweep.a+=c*D*this.m_motorJacobian.angular2,o.SynchronizeTransform(),s.SynchronizeTransform()}return C<=yP.b2_linearSlop&&E<=yP.b2_angularSlop},e}(aB),gB=function(t){function e(){var e=t.call(this)||this;return e.localAnchor1=new _P,e.localAnchor2=new _P,e.localAxis1=new _P,e.type=aB.e_prismaticJoint,e.localAxis1.Set(1,0),e.referenceAngle=0,e.enableLimit=!1,e.lowerTranslation=0,e.upperTranslation=0,e.enableMotor=!1,e.maxMotorForce=0,e.motorSpeed=0,e}return i(e,t),e.prototype.Initialize=function(t,e,i,n){this.body1=t,this.body2=e,this.localAnchor1=this.body1.GetLocalPoint(i),this.localAnchor2=this.body2.GetLocalPoint(i),this.localAxis1=this.body1.GetLocalVector(n),this.referenceAngle=this.body2.GetAngle()-this.body1.GetAngle()},e}(lB),yB=function(t){function e(i){var n=t.call(this,i)||this;return n.m_groundAnchor1=new _P,n.m_groundAnchor2=new _P,n.m_localAnchor1=new _P,n.m_localAnchor2=new _P,n.m_u1=new _P,n.m_u2=new _P,n.m_ground=n.m_body1.m_world.m_groundBody,n.m_groundAnchor1.x=i.groundAnchor1.x-n.m_ground.m_xf.position.x,n.m_groundAnchor1.y=i.groundAnchor1.y-n.m_ground.m_xf.position.y,n.m_groundAnchor2.x=i.groundAnchor2.x-n.m_ground.m_xf.position.x,n.m_groundAnchor2.y=i.groundAnchor2.y-n.m_ground.m_xf.position.y,n.m_localAnchor1.SetV(i.localAnchor1),n.m_localAnchor2.SetV(i.localAnchor2),n.m_ratio=i.ratio,n.m_constant=i.length1+n.m_ratio*i.length2,n.m_maxLength1=gP.b2Min(i.maxLength1,n.m_constant-n.m_ratio*e.b2_minPulleyLength),n.m_maxLength2=gP.b2Min(i.maxLength2,(n.m_constant-e.b2_minPulleyLength)/n.m_ratio),n.m_force=0,n.m_limitForce1=0,n.m_limitForce2=0,n}return i(e,t),e.prototype.GetAnchor1=function(){return this.m_body1.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchor2=function(){return this.m_body2.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(){var t=this.m_u2.Copy();return t.Multiply(this.m_force),t},e.prototype.GetReactionTorque=function(){return 0},e.prototype.GetGroundAnchor1=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor1),t},e.prototype.GetGroundAnchor2=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor2),t},e.prototype.GetLength1=function(){var t=this.m_body1.GetWorldPoint(this.m_localAnchor1),e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},e.prototype.GetLength2=function(){var t=this.m_body2.GetWorldPoint(this.m_localAnchor2),e=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},e.prototype.GetRatio=function(){return this.m_ratio},e.prototype.InitVelocityConstraints=function(t){var i,n=this.m_body1,r=this.m_body2;i=n.m_xf.R;var o=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y,a=i.col1.x*o+i.col2.x*s;s=i.col1.y*o+i.col2.y*s,o=a,i=r.m_xf.R;var l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,u=this.m_localAnchor2.y-r.m_sweep.localCenter.y;a=i.col1.x*l+i.col2.x*u,u=i.col1.y*l+i.col2.y*u,l=a;var c=n.m_sweep.c.x+o,h=n.m_sweep.c.y+s,p=r.m_sweep.c.x+l,d=r.m_sweep.c.y+u,f=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,_=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,m=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,g=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(c-f,h-_),this.m_u2.Set(p-m,d-g);var y=this.m_u1.Length(),A=this.m_u2.Length();y>yP.b2_linearSlop?this.m_u1.Multiply(1/y):this.m_u1.SetZero(),A>yP.b2_linearSlop?this.m_u2.Multiply(1/A):this.m_u2.SetZero(),this.m_constant-y-this.m_ratio*A>0?(this.m_state=e.e_inactiveLimit,this.m_force=0):(this.m_state=e.e_atUpperLimit,this.m_positionImpulse=0),y<this.m_maxLength1?(this.m_limitState1=e.e_inactiveLimit,this.m_limitForce1=0):(this.m_limitState1=e.e_atUpperLimit,this.m_limitPositionImpulse1=0),A<this.m_maxLength2?(this.m_limitState2=e.e_inactiveLimit,this.m_limitForce2=0):(this.m_limitState2=e.e_atUpperLimit,this.m_limitPositionImpulse2=0);var v=o*this.m_u1.y-s*this.m_u1.x,b=l*this.m_u2.y-u*this.m_u2.x;if(this.m_limitMass1=n.m_invMass+n.m_invI*v*v,this.m_limitMass2=r.m_invMass+r.m_invI*b*b,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,t.warmStarting){var x=t.dt*(-this.m_force-this.m_limitForce1)*this.m_u1.x,C=t.dt*(-this.m_force-this.m_limitForce1)*this.m_u1.y,w=t.dt*(-this.m_ratio*this.m_force-this.m_limitForce2)*this.m_u2.x,I=t.dt*(-this.m_ratio*this.m_force-this.m_limitForce2)*this.m_u2.y;n.m_linearVelocity.x+=n.m_invMass*x,n.m_linearVelocity.y+=n.m_invMass*C,n.m_angularVelocity+=n.m_invI*(o*C-s*x),r.m_linearVelocity.x+=r.m_invMass*w,r.m_linearVelocity.y+=r.m_invMass*I,r.m_angularVelocity+=r.m_invI*(l*I-u*w)}else this.m_force=0,this.m_limitForce1=0,this.m_limitForce2=0},e.prototype.SolveVelocityConstraints=function(t){var i,n=this.m_body1,r=this.m_body2;i=n.m_xf.R;var o=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y,a=i.col1.x*o+i.col2.x*s;s=i.col1.y*o+i.col2.y*s,o=a,i=r.m_xf.R;var l,u,c,h,p,d,f,_,m,g,y,A=this.m_localAnchor2.x-r.m_sweep.localCenter.x,v=this.m_localAnchor2.y-r.m_sweep.localCenter.y;a=i.col1.x*A+i.col2.x*v,v=i.col1.y*A+i.col2.y*v,A=a,this.m_state==e.e_atUpperLimit&&(l=n.m_linearVelocity.x+-n.m_angularVelocity*s,u=n.m_linearVelocity.y+n.m_angularVelocity*o,c=r.m_linearVelocity.x+-r.m_angularVelocity*v,h=r.m_linearVelocity.y+r.m_angularVelocity*A,m=-(this.m_u1.x*l+this.m_u1.y*u)-this.m_ratio*(this.m_u2.x*c+this.m_u2.y*h),g=-t.inv_dt*this.m_pulleyMass*m,y=this.m_force,this.m_force=gP.b2Max(0,this.m_force+g),g=this.m_force-y,p=-t.dt*g*this.m_u1.x,d=-t.dt*g*this.m_u1.y,f=-t.dt*this.m_ratio*g*this.m_u2.x,_=-t.dt*this.m_ratio*g*this.m_u2.y,n.m_linearVelocity.x+=n.m_invMass*p,n.m_linearVelocity.y+=n.m_invMass*d,n.m_angularVelocity+=n.m_invI*(o*d-s*p),r.m_linearVelocity.x+=r.m_invMass*f,r.m_linearVelocity.y+=r.m_invMass*_,r.m_angularVelocity+=r.m_invI*(A*_-v*f)),this.m_limitState1==e.e_atUpperLimit&&(l=n.m_linearVelocity.x+-n.m_angularVelocity*s,u=n.m_linearVelocity.y+n.m_angularVelocity*o,m=-(this.m_u1.x*l+this.m_u1.y*u),g=-t.inv_dt*this.m_limitMass1*m,y=this.m_limitForce1,this.m_limitForce1=gP.b2Max(0,this.m_limitForce1+g),g=this.m_limitForce1-y,p=-t.dt*g*this.m_u1.x,d=-t.dt*g*this.m_u1.y,n.m_linearVelocity.x+=n.m_invMass*p,n.m_linearVelocity.y+=n.m_invMass*d,n.m_angularVelocity+=n.m_invI*(o*d-s*p)),this.m_limitState2==e.e_atUpperLimit&&(c=r.m_linearVelocity.x+-r.m_angularVelocity*v,h=r.m_linearVelocity.y+r.m_angularVelocity*A,m=-(this.m_u2.x*c+this.m_u2.y*h),g=-t.inv_dt*this.m_limitMass2*m,y=this.m_limitForce2,this.m_limitForce2=gP.b2Max(0,this.m_limitForce2+g),g=this.m_limitForce2-y,f=-t.dt*g*this.m_u2.x,_=-t.dt*g*this.m_u2.y,r.m_linearVelocity.x+=r.m_invMass*f,r.m_linearVelocity.y+=r.m_invMass*_,r.m_angularVelocity+=r.m_invI*(A*_-v*f))},e.prototype.SolvePositionConstraints=function(){var t,i,n,r,o,s,a,l,u,c,h,p,d,f,_,m,g=this.m_body1,y=this.m_body2,A=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,v=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,b=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,x=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,C=0;return this.m_state==e.e_atUpperLimit&&(t=g.m_xf.R,i=this.m_localAnchor1.x-g.m_sweep.localCenter.x,n=this.m_localAnchor1.y-g.m_sweep.localCenter.y,m=t.col1.x*i+t.col2.x*n,n=t.col1.y*i+t.col2.y*n,i=m,t=y.m_xf.R,r=this.m_localAnchor2.x-y.m_sweep.localCenter.x,o=this.m_localAnchor2.y-y.m_sweep.localCenter.y,m=t.col1.x*r+t.col2.x*o,o=t.col1.y*r+t.col2.y*o,r=m,s=g.m_sweep.c.x+i,a=g.m_sweep.c.y+n,l=y.m_sweep.c.x+r,u=y.m_sweep.c.y+o,this.m_u1.Set(s-A,a-v),this.m_u2.Set(l-b,u-x),c=this.m_u1.Length(),h=this.m_u2.Length(),c>yP.b2_linearSlop?this.m_u1.Multiply(1/c):this.m_u1.SetZero(),h>yP.b2_linearSlop?this.m_u2.Multiply(1/h):this.m_u2.SetZero(),p=this.m_constant-c-this.m_ratio*h,C=gP.b2Max(C,-p),p=gP.b2Clamp(p+yP.b2_linearSlop,-yP.b2_maxLinearCorrection,0),d=-this.m_pulleyMass*p,f=this.m_positionImpulse,this.m_positionImpulse=gP.b2Max(0,this.m_positionImpulse+d),s=-(d=this.m_positionImpulse-f)*this.m_u1.x,a=-d*this.m_u1.y,l=-this.m_ratio*d*this.m_u2.x,u=-this.m_ratio*d*this.m_u2.y,g.m_sweep.c.x+=g.m_invMass*s,g.m_sweep.c.y+=g.m_invMass*a,g.m_sweep.a+=g.m_invI*(i*a-n*s),y.m_sweep.c.x+=y.m_invMass*l,y.m_sweep.c.y+=y.m_invMass*u,y.m_sweep.a+=y.m_invI*(r*u-o*l),g.SynchronizeTransform(),y.SynchronizeTransform()),this.m_limitState1==e.e_atUpperLimit&&(t=g.m_xf.R,i=this.m_localAnchor1.x-g.m_sweep.localCenter.x,n=this.m_localAnchor1.y-g.m_sweep.localCenter.y,m=t.col1.x*i+t.col2.x*n,n=t.col1.y*i+t.col2.y*n,i=m,s=g.m_sweep.c.x+i,a=g.m_sweep.c.y+n,this.m_u1.Set(s-A,a-v),(c=this.m_u1.Length())>yP.b2_linearSlop?(this.m_u1.x*=1/c,this.m_u1.y*=1/c):this.m_u1.SetZero(),p=this.m_maxLength1-c,C=gP.b2Max(C,-p),p=gP.b2Clamp(p+yP.b2_linearSlop,-yP.b2_maxLinearCorrection,0),d=-this.m_limitMass1*p,_=this.m_limitPositionImpulse1,this.m_limitPositionImpulse1=gP.b2Max(0,this.m_limitPositionImpulse1+d),s=-(d=this.m_limitPositionImpulse1-_)*this.m_u1.x,a=-d*this.m_u1.y,g.m_sweep.c.x+=g.m_invMass*s,g.m_sweep.c.y+=g.m_invMass*a,g.m_sweep.a+=g.m_invI*(i*a-n*s),g.SynchronizeTransform()),this.m_limitState2==e.e_atUpperLimit&&(t=y.m_xf.R,r=this.m_localAnchor2.x-y.m_sweep.localCenter.x,o=this.m_localAnchor2.y-y.m_sweep.localCenter.y,m=t.col1.x*r+t.col2.x*o,o=t.col1.y*r+t.col2.y*o,r=m,l=y.m_sweep.c.x+r,u=y.m_sweep.c.y+o,this.m_u2.Set(l-b,u-x),(h=this.m_u2.Length())>yP.b2_linearSlop?(this.m_u2.x*=1/h,this.m_u2.y*=1/h):this.m_u2.SetZero(),p=this.m_maxLength2-h,C=gP.b2Max(C,-p),p=gP.b2Clamp(p+yP.b2_linearSlop,-yP.b2_maxLinearCorrection,0),d=-this.m_limitMass2*p,_=this.m_limitPositionImpulse2,this.m_limitPositionImpulse2=gP.b2Max(0,this.m_limitPositionImpulse2+d),l=-(d=this.m_limitPositionImpulse2-_)*this.m_u2.x,u=-d*this.m_u2.y,y.m_sweep.c.x+=y.m_invMass*l,y.m_sweep.c.y+=y.m_invMass*u,y.m_sweep.a+=y.m_invI*(r*u-o*l),y.SynchronizeTransform()),C<yP.b2_linearSlop},e.b2_minPulleyLength=2,e}(aB),AB=function(t){function e(){var e=t.call(this)||this;return e.groundAnchor1=new _P,e.groundAnchor2=new _P,e.localAnchor1=new _P,e.localAnchor2=new _P,e.type=aB.e_pulleyJoint,e.groundAnchor1.Set(-1,1),e.groundAnchor2.Set(1,1),e.localAnchor1.Set(-1,0),e.localAnchor2.Set(1,0),e.length1=0,e.maxLength1=0,e.length2=0,e.maxLength2=0,e.ratio=1,e.collideConnected=!0,e}return i(e,t),e.prototype.Initialize=function(t,e,i,n,r,o,s){this.body1=t,this.body2=e,this.groundAnchor1.SetV(i),this.groundAnchor2.SetV(n),this.localAnchor1=this.body1.GetLocalPoint(r),this.localAnchor2=this.body2.GetLocalPoint(o);var a=r.x-i.x,l=r.y-i.y;this.length1=Math.sqrt(a*a+l*l);var u=o.x-n.x,c=o.y-n.y;this.length2=Math.sqrt(u*u+c*c),this.ratio=s;var h=this.length1+this.ratio*this.length2;this.maxLength1=h-this.ratio*yB.b2_minPulleyLength,this.maxLength2=(h-yB.b2_minPulleyLength)/this.ratio},e}(lB),vB=function(t){function e(e){var i=t.call(this,e)||this;return i.K=new dP,i.K1=new dP,i.K2=new dP,i.K3=new dP,i.m_localAnchor1=new _P,i.m_localAnchor2=new _P,i.m_pivotForce=new _P,i.m_pivotMass=new dP,i.m_localAnchor1.SetV(e.localAnchor1),i.m_localAnchor2.SetV(e.localAnchor2),i.m_referenceAngle=e.referenceAngle,i.m_pivotForce.Set(0,0),i.m_motorForce=0,i.m_limitForce=0,i.m_limitPositionImpulse=0,i.m_lowerAngle=e.lowerAngle,i.m_upperAngle=e.upperAngle,i.m_maxMotorTorque=e.maxMotorTorque,i.m_motorSpeed=e.motorSpeed,i.m_enableLimit=e.enableLimit,i.m_enableMotor=e.enableMotor,i}return i(e,t),e.prototype.GetAnchor1=function(){return this.m_body1.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchor2=function(){return this.m_body2.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(){return this.m_pivotForce},e.prototype.GetReactionTorque=function(){return this.m_limitForce},e.prototype.GetJointAngle=function(){return this.m_body2.m_sweep.a-this.m_body1.m_sweep.a-this.m_referenceAngle},e.prototype.GetJointSpeed=function(){return this.m_body2.m_angularVelocity-this.m_body1.m_angularVelocity},e.prototype.IsLimitEnabled=function(){return this.m_enableLimit},e.prototype.EnableLimit=function(t){this.m_enableLimit=t},e.prototype.GetLowerLimit=function(){return this.m_lowerAngle},e.prototype.GetUpperLimit=function(){return this.m_upperAngle},e.prototype.SetLimits=function(t,e){this.m_lowerAngle=t,this.m_upperAngle=e},e.prototype.IsMotorEnabled=function(){return this.m_enableMotor},e.prototype.EnableMotor=function(t){this.m_enableMotor=t},e.prototype.SetMotorSpeed=function(t){this.m_motorSpeed=t},e.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},e.prototype.SetMaxMotorTorque=function(t){this.m_maxMotorTorque=t},e.prototype.GetMotorTorque=function(){return this.m_motorForce},e.prototype.InitVelocityConstraints=function(t){var i,n,r=this.m_body1,o=this.m_body2;i=r.m_xf.R;var s=this.m_localAnchor1.x-r.m_sweep.localCenter.x,a=this.m_localAnchor1.y-r.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=o.m_xf.R;var l=this.m_localAnchor2.x-o.m_sweep.localCenter.x,u=this.m_localAnchor2.y-o.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*u,u=i.col1.y*l+i.col2.y*u,l=n;var c=r.m_invMass,h=o.m_invMass,p=r.m_invI,d=o.m_invI;if(this.K1.col1.x=c+h,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=c+h,this.K2.col1.x=p*a*a,this.K2.col2.x=-p*s*a,this.K2.col1.y=-p*s*a,this.K2.col2.y=p*s*s,this.K3.col1.x=d*u*u,this.K3.col2.x=-d*l*u,this.K3.col1.y=-d*l*u,this.K3.col2.y=d*l*l,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Invert(this.m_pivotMass),this.m_motorMass=1/(p+d),0==this.m_enableMotor&&(this.m_motorForce=0),this.m_enableLimit){var f=o.m_sweep.a-r.m_sweep.a-this.m_referenceAngle;gP.b2Abs(this.m_upperAngle-this.m_lowerAngle)<2*yP.b2_angularSlop?this.m_limitState=e.e_equalLimits:f<=this.m_lowerAngle?(this.m_limitState!=e.e_atLowerLimit&&(this.m_limitForce=0),this.m_limitState=e.e_atLowerLimit):f>=this.m_upperAngle?(this.m_limitState!=e.e_atUpperLimit&&(this.m_limitForce=0),this.m_limitState=e.e_atUpperLimit):(this.m_limitState=e.e_inactiveLimit,this.m_limitForce=0)}else this.m_limitForce=0;t.warmStarting?(r.m_linearVelocity.x-=t.dt*c*this.m_pivotForce.x,r.m_linearVelocity.y-=t.dt*c*this.m_pivotForce.y,r.m_angularVelocity-=t.dt*p*(s*this.m_pivotForce.y-a*this.m_pivotForce.x+this.m_motorForce+this.m_limitForce),o.m_linearVelocity.x+=t.dt*h*this.m_pivotForce.x,o.m_linearVelocity.y+=t.dt*h*this.m_pivotForce.y,o.m_angularVelocity+=t.dt*d*(l*this.m_pivotForce.y-u*this.m_pivotForce.x+this.m_motorForce+this.m_limitForce)):(this.m_pivotForce.SetZero(),this.m_motorForce=0,this.m_limitForce=0),this.m_limitPositionImpulse=0},e.prototype.SolveVelocityConstraints=function(t){var i,n,r=this.m_body1,o=this.m_body2;i=r.m_xf.R;var s=this.m_localAnchor1.x-r.m_sweep.localCenter.x,a=this.m_localAnchor1.y-r.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=o.m_xf.R;var l,u=this.m_localAnchor2.x-o.m_sweep.localCenter.x,c=this.m_localAnchor2.y-o.m_sweep.localCenter.y;n=i.col1.x*u+i.col2.x*c,c=i.col1.y*u+i.col2.y*c,u=n;var h=o.m_linearVelocity.x+-o.m_angularVelocity*c-r.m_linearVelocity.x- -r.m_angularVelocity*a,p=o.m_linearVelocity.y+o.m_angularVelocity*u-r.m_linearVelocity.y-r.m_angularVelocity*s,d=-t.inv_dt*(this.m_pivotMass.col1.x*h+this.m_pivotMass.col2.x*p),f=-t.inv_dt*(this.m_pivotMass.col1.y*h+this.m_pivotMass.col2.y*p);this.m_pivotForce.x+=d,this.m_pivotForce.y+=f;var _=t.dt*d,m=t.dt*f;if(r.m_linearVelocity.x-=r.m_invMass*_,r.m_linearVelocity.y-=r.m_invMass*m,r.m_angularVelocity-=r.m_invI*(s*m-a*_),o.m_linearVelocity.x+=o.m_invMass*_,o.m_linearVelocity.y+=o.m_invMass*m,o.m_angularVelocity+=o.m_invI*(u*m-c*_),this.m_enableMotor&&this.m_limitState!=e.e_equalLimits){var g=o.m_angularVelocity-r.m_angularVelocity-this.m_motorSpeed,y=-t.inv_dt*this.m_motorMass*g,A=this.m_motorForce;this.m_motorForce=gP.b2Clamp(this.m_motorForce+y,-this.m_maxMotorTorque,this.m_maxMotorTorque),y=this.m_motorForce-A,r.m_angularVelocity-=r.m_invI*t.dt*y,o.m_angularVelocity+=o.m_invI*t.dt*y}if(this.m_enableLimit&&this.m_limitState!=e.e_inactiveLimit){var v=o.m_angularVelocity-r.m_angularVelocity,b=-t.inv_dt*this.m_motorMass*v;this.m_limitState==e.e_equalLimits?this.m_limitForce+=b:this.m_limitState==e.e_atLowerLimit?(l=this.m_limitForce,this.m_limitForce=gP.b2Max(this.m_limitForce+b,0),b=this.m_limitForce-l):this.m_limitState==e.e_atUpperLimit&&(l=this.m_limitForce,this.m_limitForce=gP.b2Min(this.m_limitForce+b,0),b=this.m_limitForce-l),r.m_angularVelocity-=r.m_invI*t.dt*b,o.m_angularVelocity+=o.m_invI*t.dt*b}},e.prototype.SolvePositionConstraints=function(){var t,i,n,r,o=this.m_body1,s=this.m_body2;r=o.m_xf.R;var a=this.m_localAnchor1.x-o.m_sweep.localCenter.x,l=this.m_localAnchor1.y-o.m_sweep.localCenter.y,u=r.col1.x*a+r.col2.x*l;l=r.col1.y*a+r.col2.y*l,a=u,r=s.m_xf.R;var c=this.m_localAnchor2.x-s.m_sweep.localCenter.x,h=this.m_localAnchor2.y-s.m_sweep.localCenter.y;u=r.col1.x*c+r.col2.x*h,h=r.col1.y*c+r.col2.y*h,c=u;var p=o.m_sweep.c.x+a,d=o.m_sweep.c.y+l,f=s.m_sweep.c.x+c-p,_=s.m_sweep.c.y+h-d;n=Math.sqrt(f*f+_*_);var m=o.m_invMass,g=s.m_invMass,y=o.m_invI,A=s.m_invI;this.K1.col1.x=m+g,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=m+g,this.K2.col1.x=y*l*l,this.K2.col2.x=-y*a*l,this.K2.col1.y=-y*a*l,this.K2.col2.y=y*a*a,this.K3.col1.x=A*h*h,this.K3.col2.x=-A*c*h,this.K3.col1.y=-A*c*h,this.K3.col2.y=A*c*c,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(e.tImpulse,-f,-_);var v=e.tImpulse.x,b=e.tImpulse.y;o.m_sweep.c.x-=o.m_invMass*v,o.m_sweep.c.y-=o.m_invMass*b,o.m_sweep.a-=o.m_invI*(a*b-l*v),s.m_sweep.c.x+=s.m_invMass*v,s.m_sweep.c.y+=s.m_invMass*b,s.m_sweep.a+=s.m_invI*(c*b-h*v),o.SynchronizeTransform(),s.SynchronizeTransform();var x=0;if(this.m_enableLimit&&this.m_limitState!=e.e_inactiveLimit){var C=s.m_sweep.a-o.m_sweep.a-this.m_referenceAngle,w=0;this.m_limitState==e.e_equalLimits?(i=gP.b2Clamp(C,-yP.b2_maxAngularCorrection,yP.b2_maxAngularCorrection),w=-this.m_motorMass*i,x=gP.b2Abs(i)):this.m_limitState==e.e_atLowerLimit?(i=C-this.m_lowerAngle,x=gP.b2Max(0,-i),i=gP.b2Clamp(i+yP.b2_angularSlop,-yP.b2_maxAngularCorrection,0),w=-this.m_motorMass*i,t=this.m_limitPositionImpulse,this.m_limitPositionImpulse=gP.b2Max(this.m_limitPositionImpulse+w,0),w=this.m_limitPositionImpulse-t):this.m_limitState==e.e_atUpperLimit&&(i=C-this.m_upperAngle,x=gP.b2Max(0,i),i=gP.b2Clamp(i-yP.b2_angularSlop,0,yP.b2_maxAngularCorrection),w=-this.m_motorMass*i,t=this.m_limitPositionImpulse,this.m_limitPositionImpulse=gP.b2Min(this.m_limitPositionImpulse+w,0),w=this.m_limitPositionImpulse-t),o.m_sweep.a-=o.m_invI*w,s.m_sweep.a+=s.m_invI*w,o.SynchronizeTransform(),s.SynchronizeTransform()}return n<=yP.b2_linearSlop&&x<=yP.b2_angularSlop},e.tImpulse=new _P,e}(aB),bB=function(t){function e(){var e=t.call(this)||this;return e.localAnchor1=new _P,e.localAnchor2=new _P,e.type=aB.e_revoluteJoint,e.localAnchor1.Set(0,0),e.localAnchor2.Set(0,0),e.referenceAngle=0,e.lowerAngle=0,e.upperAngle=0,e.maxMotorTorque=0,e.motorSpeed=0,e.enableLimit=!1,e.enableMotor=!1,e}return i(e,t),e.prototype.Initialize=function(t,e,i){this.body1=t,this.body2=e,this.localAnchor1=this.body1.GetLocalPoint(i),this.localAnchor2=this.body2.GetLocalPoint(i),this.referenceAngle=this.body2.GetAngle()-this.body1.GetAngle()},e}(lB),xB=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchor1=new _P,i.m_localAnchor2=new _P,i.m_u=new _P,i.m_localAnchor1.SetV(e.localAnchor1),i.m_localAnchor2.SetV(e.localAnchor2),i.m_length=e.length,i.m_frequencyHz=e.frequencyHz,i.m_dampingRatio=e.dampingRatio,i.m_impulse=0,i.m_gamma=0,i.m_bias=0,i.m_inv_dt=0,i}return i(e,t),e.prototype.InitVelocityConstraints=function(t){var e,i;this.m_inv_dt=t.inv_dt;var n=this.m_body1,r=this.m_body2;e=n.m_xf.R;var o=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i,e=r.m_xf.R;var a=this.m_localAnchor2.x-r.m_sweep.localCenter.x,l=this.m_localAnchor2.y-r.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i,this.m_u.x=r.m_sweep.c.x+a-n.m_sweep.c.x-o,this.m_u.y=r.m_sweep.c.y+l-n.m_sweep.c.y-s;var u=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);u>yP.b2_linearSlop?this.m_u.Multiply(1/u):this.m_u.SetZero();var c=o*this.m_u.y-s*this.m_u.x,h=a*this.m_u.y-l*this.m_u.x,p=n.m_invMass+n.m_invI*c*c+r.m_invMass+r.m_invI*h*h;if(this.m_mass=1/p,this.m_frequencyHz>0){var d=u-this.m_length,f=2*Math.PI*this.m_frequencyHz,_=2*this.m_mass*this.m_dampingRatio*f,m=this.m_mass*f*f;this.m_gamma=1/(t.dt*(_+t.dt*m)),this.m_bias=d*t.dt*m*this.m_gamma,this.m_mass=1/(p+this.m_gamma)}if(t.warmStarting){this.m_impulse*=t.dtRatio;var g=this.m_impulse*this.m_u.x,y=this.m_impulse*this.m_u.y;n.m_linearVelocity.x-=n.m_invMass*g,n.m_linearVelocity.y-=n.m_invMass*y,n.m_angularVelocity-=n.m_invI*(o*y-s*g),r.m_linearVelocity.x+=r.m_invMass*g,r.m_linearVelocity.y+=r.m_invMass*y,r.m_angularVelocity+=r.m_invI*(a*y-l*g)}else this.m_impulse=0},e.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_body1,n=this.m_body2;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,o=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*r+e.col2.x*o;o=e.col1.y*r+e.col2.y*o,r=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var u=i.m_linearVelocity.x+-i.m_angularVelocity*o,c=i.m_linearVelocity.y+i.m_angularVelocity*r,h=n.m_linearVelocity.x+-n.m_angularVelocity*l,p=n.m_linearVelocity.y+n.m_angularVelocity*a,d=this.m_u.x*(h-u)+this.m_u.y*(p-c),f=-this.m_mass*(d+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;var _=f*this.m_u.x,m=f*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*_,i.m_linearVelocity.y-=i.m_invMass*m,i.m_angularVelocity-=i.m_invI*(r*m-o*_),n.m_linearVelocity.x+=n.m_invMass*_,n.m_linearVelocity.y+=n.m_invMass*m,n.m_angularVelocity+=n.m_invI*(a*m-l*_)},e.prototype.SolvePositionConstraints=function(){var t;if(this.m_frequencyHz>0)return!0;var e=this.m_body1,i=this.m_body2;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=o;var l=i.m_sweep.c.x+s-e.m_sweep.c.x-n,u=i.m_sweep.c.y+a-e.m_sweep.c.y-r,c=Math.sqrt(l*l+u*u);l/=c,u/=c;var h=c-this.m_length;h=gP.b2Clamp(h,-yP.b2_maxLinearCorrection,yP.b2_maxLinearCorrection);var p=-this.m_mass*h;this.m_u.Set(l,u);var d=p*this.m_u.x,f=p*this.m_u.y;return e.m_sweep.c.x-=e.m_invMass*d,e.m_sweep.c.y-=e.m_invMass*f,e.m_sweep.a-=e.m_invI*(n*f-r*d),i.m_sweep.c.x+=i.m_invMass*d,i.m_sweep.c.y+=i.m_invMass*f,i.m_sweep.a+=i.m_invI*(s*f-a*d),e.SynchronizeTransform(),i.SynchronizeTransform(),gP.b2Abs(h)<yP.b2_linearSlop},e.prototype.GetAnchor1=function(){return this.m_body1.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchor2=function(){return this.m_body2.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(){var t=new _P;return t.SetV(this.m_u),t.Multiply(this.m_inv_dt*this.m_impulse),t},e.prototype.GetReactionTorque=function(){return 0},e}(aB),CB=function(){function t(e,i){this.__fast__=!0,this.m_xf=new mP,this.m_sweep=new fP,this.m_linearVelocity=new _P,this.m_force=new _P,this.m_flags=0,e.isBullet&&(this.m_flags|=t.e_bulletFlag),e.fixedRotation&&(this.m_flags|=t.e_fixedRotationFlag),e.allowSleep&&(this.m_flags|=t.e_allowSleepFlag),e.isSleeping&&(this.m_flags|=t.e_sleepFlag),this.m_world=i,this.m_xf.position.SetV(e.position),this.m_xf.R.Set(e.angle),this.m_sweep.localCenter.SetV(e.massData.center),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=e.angle;var n=this.m_xf.R,r=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*r.x+n.col2.x*r.y,this.m_sweep.c.y=n.col1.y*r.x+n.col2.y*r.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_contactList=null,this.m_prev=null,this.m_next=null,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sleepTime=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.massData.mass,this.m_mass>0&&(this.m_invMass=1/this.m_mass),0==(this.m_flags&t.e_fixedRotationFlag)&&(this.m_I=e.massData.I),this.m_I>0&&(this.m_invI=1/this.m_I),0==this.m_invMass&&0==this.m_invI?this.m_type=t.e_staticType:this.m_type=t.e_dynamicType,this.m_userData=e.userData,this.m_shapeList=null,this.m_shapeCount=0}return t.prototype.CreateShape=function(t){if(1==this.m_world.m_lock)return null;var e;switch(t.type){case bP.e_circleShape:e=new IP(t);break;case bP.e_polygonShape:e=new TP(t)}return e.m_next=this.m_shapeList,this.m_shapeList=e,++this.m_shapeCount,e.m_body=this,e.CreateProxy(this.m_world.m_broadPhase,this.m_xf),e.UpdateSweepRadius(this.m_sweep.localCenter),e},t.prototype.DestroyShape=function(t){if(1!=this.m_world.m_lock){t.DestroyProxy(this.m_world.m_broadPhase);for(var e=this.m_shapeList,i=null;null!=e;){if(e==t){i?i.m_next=t.m_next:this.m_shapeList=t.m_next;break}i=e,e=e.m_next}t.m_body=null,t.m_next=null,--this.m_shapeCount,bP.Destroy(t,this.m_world.m_blockAllocator)}},t.prototype.SetMass=function(e){var i;if(1!=this.m_world.m_lock){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass>0&&(this.m_invMass=1/this.m_mass),0==(this.m_flags&t.e_fixedRotationFlag)&&(this.m_I=e.I),this.m_I>0&&(this.m_invI=1/this.m_I),this.m_sweep.localCenter.SetV(e.center);var n=this.m_xf.R,r=this.m_sweep.localCenter;for(this.m_sweep.c.x=n.col1.x*r.x+n.col2.x*r.y,this.m_sweep.c.y=n.col1.y*r.x+n.col2.y*r.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),i=this.m_shapeList;i;i=i.m_next)i.UpdateSweepRadius(this.m_sweep.localCenter);var o=this.m_type;if(0==this.m_invMass&&0==this.m_invI?this.m_type=t.e_staticType:this.m_type=t.e_dynamicType,o!=this.m_type)for(i=this.m_shapeList;i;i=i.m_next)i.RefilterProxy(this.m_world.m_broadPhase,this.m_xf)}},t.prototype.SetMassFromShapes=function(){var e;if(1!=this.m_world.m_lock){this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0;var i=0,n=0,r=t.s_massData;for(e=this.m_shapeList;e;e=e.m_next)e.ComputeMass(r),this.m_mass+=r.mass,i+=r.mass*r.center.x,n+=r.mass*r.center.y,this.m_I+=r.I;this.m_mass>0&&(this.m_invMass=1/this.m_mass,i*=this.m_invMass,n*=this.m_invMass),this.m_I>0&&0==(this.m_flags&t.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(i*i+n*n),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0),this.m_sweep.localCenter.Set(i,n);var o=this.m_xf.R,s=this.m_sweep.localCenter;for(this.m_sweep.c.x=o.col1.x*s.x+o.col2.x*s.y,this.m_sweep.c.y=o.col1.y*s.x+o.col2.y*s.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),e=this.m_shapeList;e;e=e.m_next)e.UpdateSweepRadius(this.m_sweep.localCenter);var a=this.m_type;if(0==this.m_invMass&&0==this.m_invI?this.m_type=t.e_staticType:this.m_type=t.e_dynamicType,a!=this.m_type)for(e=this.m_shapeList;e;e=e.m_next)e.RefilterProxy(this.m_world.m_broadPhase,this.m_xf)}},t.prototype.SetXForm=function(e,i){var n;if(1==this.m_world.m_lock)return!0;if(this.IsFrozen())return!1;this.m_xf.R.Set(i),this.m_xf.position.SetV(e);var r=this.m_xf.R,o=this.m_sweep.localCenter;this.m_sweep.c.x=r.col1.x*o.x+r.col2.x*o.y,this.m_sweep.c.y=r.col1.y*o.x+r.col2.y*o.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=i;var s=!1;for(n=this.m_shapeList;n;n=n.m_next){if(0==n.Synchronize(this.m_world.m_broadPhase,this.m_xf,this.m_xf)){s=!0;break}}if(1==s){for(this.m_flags|=t.e_frozenFlag,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,n=this.m_shapeList;n;n=n.m_next)n.DestroyProxy(this.m_world.m_broadPhase);return!1}return this.m_world.m_broadPhase.Commit(),!0},t.prototype.GetXForm=function(){return this.m_xf},t.prototype.GetPosition=function(){return this.m_xf.position},t.prototype.GetAngle=function(){return this.m_sweep.a},t.prototype.GetWorldCenter=function(){return this.m_sweep.c},t.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},t.prototype.SetLinearVelocity=function(t){this.m_linearVelocity.SetV(t)},t.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},t.prototype.SetAngularVelocity=function(t){this.m_angularVelocity=t},t.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},t.prototype.ApplyForce=function(t,e){this.IsSleeping()&&this.WakeUp(),this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x},t.prototype.ApplyTorque=function(t){this.IsSleeping()&&this.WakeUp(),this.m_torque+=t},t.prototype.ApplyImpulse=function(t,e){this.IsSleeping()&&this.WakeUp(),this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)},t.prototype.GetMass=function(){return this.m_mass},t.prototype.GetInertia=function(){return this.m_I},t.prototype.GetWorldPoint=function(t){var e=this.m_xf.R,i=new _P(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i},t.prototype.GetWorldVector=function(t){return gP.b2MulMV(this.m_xf.R,t)},t.prototype.GetLocalPoint=function(t){return gP.b2MulXT(this.m_xf,t)},t.prototype.GetLocalVector=function(t){return gP.b2MulTMV(this.m_xf.R,t)},t.prototype.GetLinearVelocityFromWorldPoint=function(t){return new _P(this.m_linearVelocity.x+this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.x-this.m_angularVelocity*(t.x-this.m_sweep.c.x))},t.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R,i=new _P(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new _P(this.m_linearVelocity.x+this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.x-this.m_angularVelocity*(i.x-this.m_sweep.c.x))},t.prototype.IsBullet=function(){return(this.m_flags&t.e_bulletFlag)==t.e_bulletFlag},t.prototype.SetBullet=function(e){e?this.m_flags|=t.e_bulletFlag:this.m_flags&=~t.e_bulletFlag},t.prototype.IsStatic=function(){return this.m_type==t.e_staticType},t.prototype.IsDynamic=function(){return this.m_type==t.e_dynamicType},t.prototype.IsFrozen=function(){return(this.m_flags&t.e_frozenFlag)==t.e_frozenFlag},t.prototype.IsSleeping=function(){return(this.m_flags&t.e_sleepFlag)==t.e_sleepFlag},t.prototype.AllowSleeping=function(e){e?this.m_flags|=t.e_allowSleepFlag:(this.m_flags&=~t.e_allowSleepFlag,this.WakeUp())},t.prototype.WakeUp=function(){this.m_flags&=~t.e_sleepFlag,this.m_sleepTime=0},t.prototype.PutToSleep=function(){this.m_flags|=t.e_sleepFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0},t.prototype.GetShapeList=function(){return this.m_shapeList},t.prototype.GetJointList=function(){return this.m_jointList},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.prototype.GetWorld=function(){return this.m_world},t.prototype.SynchronizeShapes=function(){var e=t.s_xf1;e.R.Set(this.m_sweep.a0);var i,n=e.R,r=this.m_sweep.localCenter;e.position.x=this.m_sweep.c0.x-(n.col1.x*r.x+n.col2.x*r.y),e.position.y=this.m_sweep.c0.y-(n.col1.y*r.x+n.col2.y*r.y);var o=!0;for(i=this.m_shapeList;i&&0!=(o=i.Synchronize(this.m_world.m_broadPhase,e,this.m_xf));i=i.m_next);if(0==o){for(this.m_flags|=t.e_frozenFlag,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,i=this.m_shapeList;i;i=i.m_next)i.DestroyProxy(this.m_world.m_broadPhase);return!1}return!0},t.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)},t.prototype.IsConnected=function(t){for(var e=this.m_jointList;e;e=e.next)if(e.other==t)return 0==e.joint.m_collideConnected;return!1},t.prototype.Advance=function(t){this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},t.s_massData=new EP,t.s_xf1=new mP,t.e_frozenFlag=2,t.e_islandFlag=4,t.e_sleepFlag=8,t.e_allowSleepFlag=16,t.e_bulletFlag=32,t.e_fixedRotationFlag=64,t.e_staticType=1,t.e_dynamicType=2,t.e_maxTypes=3,t}(),wB=function(){this.__fast__=!0,this.massData=new EP,this.position=new _P,this.massData.center.SetZero(),this.massData.mass=0,this.massData.I=0,this.userData=null,this.position.Set(0,0),this.angle=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.isSleeping=!1,this.fixedRotation=!1,this.isBullet=!1},IB=function(){function t(){}return t.prototype.Violation=function(t){},t}(),EB=function(){function t(){}return t.prototype.ShouldCollide=function(t,e){var i=t.GetFilterData(),n=e.GetFilterData();return i.groupIndex==n.groupIndex&&0!=i.groupIndex?i.groupIndex>0:0!=(i.maskBits&n.categoryBits)&&0!=(i.categoryBits&n.maskBits)},t.b2_defaultFilter=new t,t}(),SB=function(){function t(){this.__fast__=!0}return t.prototype.Add=function(t){},t.prototype.Persist=function(t){},t.prototype.Remove=function(t){},t.prototype.Result=function(t){},t}(),DB=function(t){function e(){var e=t.call(this)||this;return e.m_nullContact=new rB,e.m_world=null,e.m_destroyImmediate=!1,e}return i(e,t),e.prototype.PairAdded=function(t,i){var n,r=t,o=i,s=r.m_body,a=o.m_body;if(s.IsStatic()&&a.IsStatic())return this.m_nullContact;if(r.m_body==o.m_body)return this.m_nullContact;if(a.IsConnected(s))return this.m_nullContact;if(null!=this.m_world.m_contactFilter&&0==this.m_world.m_contactFilter.ShouldCollide(r,o))return this.m_nullContact;0==WP.s_initialized&&(e.InitializeRegisters(),WP.s_initialized=!0);var l=r.m_type,u=o.m_type,c=WP.s_registers[l][u],h=c.createFcn;if(null!=h)if(c.primary)n=h(r,o,this.m_world.m_blockAllocator);else{n=h(o,r,this.m_world.m_blockAllocator);for(var p=0;p<n.m_manifoldCount;++p){var d=n.GetManifolds()[p];d.normal=d.normal.Negative()}}return null==n&&(n=this.m_nullContact),r=n.m_shape1,o=n.m_shape2,s=r.m_body,a=o.m_body,n.m_prev=null,n.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=n),this.m_world.m_contactList=n,n.m_node1.contact=n,n.m_node1.other=a,n.m_node1.prev=null,n.m_node1.next=s.m_contactList,null!=s.m_contactList&&(s.m_contactList.prev=n.m_node1),s.m_contactList=n.m_node1,n.m_node2.contact=n,n.m_node2.other=s,n.m_node2.prev=null,n.m_node2.next=a.m_contactList,null!=a.m_contactList&&(a.m_contactList.prev=n.m_node2),a.m_contactList=n.m_node2,++this.m_world.m_contactCount,n},e.prototype.PairRemoved=function(t,e,i){if(null!=i){var n=i;n!=this.m_nullContact&&this.Destroy(n)}},e.prototype.Destroy=function(t){var i=t.m_shape1,n=t.m_shape2,r=t.m_manifoldCount;if(r>0&&this.m_world.m_contactListener){var o=i.m_body,s=n.m_body,a=t.GetManifolds(),l=e.s_evalCP;l.shape1=t.m_shape1,l.shape2=t.m_shape1,l.friction=t.m_friction,l.restitution=t.m_restitution;for(var u=0;u<r;++u){var c=a[u];l.normal.SetV(c.normal);for(var h=0;h<c.pointCount;++h){var p=c.points[h];l.position=o.GetWorldPoint(p.localPoint1);var d=o.GetLinearVelocityFromLocalPoint(p.localPoint1),f=s.GetLinearVelocityFromLocalPoint(p.localPoint2);l.velocity.Set(f.x-d.x,f.y-d.y),l.separation=p.separation,l.id.key=p.id._key,this.m_world.m_contactListener.Remove(l)}}}t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next);var _=i.m_body,m=n.m_body;t.m_node1.prev&&(t.m_node1.prev.next=t.m_node1.next),t.m_node1.next&&(t.m_node1.next.prev=t.m_node1.prev),t.m_node1==_.m_contactList&&(_.m_contactList=t.m_node1.next),t.m_node2.prev&&(t.m_node2.prev.next=t.m_node2.next),t.m_node2.next&&(t.m_node2.next.prev=t.m_node2.prev),t.m_node2==m.m_contactList&&(m.m_contactList=t.m_node2.next),t.m_manifoldCount>0&&(t.m_shape1.m_body.WakeUp(),t.m_shape2.m_body.WakeUp());var g=t.m_shape1.m_type,y=t.m_shape2.m_type;(0,WP.s_registers[g][y].destroyFcn)(t,this.m_world.m_blockAllocator),--this.m_world.m_contactCount},e.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;t=t.m_next){var e=t.m_shape1.m_body,i=t.m_shape2.m_body;e.IsSleeping()&&i.IsSleeping()||t.Update(this.m_world.m_contactListener)}},e.InitializeRegisters=function(){WP.s_registers=new Array(bP.e_shapeTypeCount);for(var t=0;t<bP.e_shapeTypeCount;t++){WP.s_registers[t]=new Array(bP.e_shapeTypeCount);for(var e=0;e<bP.e_shapeTypeCount;e++)WP.s_registers[t][e]=new tB}WP.AddType(JP.Create,JP.Destroy,bP.e_circleShape,bP.e_circleShape),WP.AddType(oB.Create,oB.Destroy,bP.e_polygonShape,bP.e_circleShape),WP.AddType(sB.Create,sB.Destroy,bP.e_polygonShape,bP.e_polygonShape)},e.s_evalCP=new UP,e}(HP),TB=function(){function t(){this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1,this.m_drawFlags=0}return t.prototype.SetFlags=function(t){this.m_drawFlags=t},t.prototype.GetFlags=function(){return this.m_drawFlags},t.prototype.AppendFlags=function(t){this.m_drawFlags|=t},t.prototype.ClearFlags=function(t){this.m_drawFlags&=~t},t.prototype.DrawPolygon=function(t,e,i){this.m_sprite.graphics.lineStyle(this.m_lineThickness,i.color,this.m_alpha),this.m_sprite.graphics.moveTo(t[0].x*this.m_drawScale,t[0].y*this.m_drawScale);for(var n=1;n<e;n++)this.m_sprite.graphics.lineTo(t[n].x*this.m_drawScale,t[n].y*this.m_drawScale);this.m_sprite.graphics.lineTo(t[0].x*this.m_drawScale,t[0].y*this.m_drawScale)},t.prototype.DrawSolidPolygon=function(t,e,i){this.m_sprite.graphics.lineStyle(this.m_lineThickness,i.color,this.m_alpha),this.m_sprite.graphics.moveTo(t[0].x*this.m_drawScale,t[0].y*this.m_drawScale),this.m_sprite.graphics.beginFill(i.color,this.m_fillAlpha);for(var n=1;n<e;n++)this.m_sprite.graphics.lineTo(t[n].x*this.m_drawScale,t[n].y*this.m_drawScale);this.m_sprite.graphics.lineTo(t[0].x*this.m_drawScale,t[0].y*this.m_drawScale),this.m_sprite.graphics.endFill()},t.prototype.DrawCircle=function(t,e,i){this.m_sprite.graphics.lineStyle(this.m_lineThickness,i.color,this.m_alpha),this.m_sprite.graphics.drawCircle(t.x*this.m_drawScale,t.y*this.m_drawScale,e*this.m_drawScale)},t.prototype.DrawSolidCircle=function(t,e,i,n){this.m_sprite.graphics.lineStyle(this.m_lineThickness,n.color,this.m_alpha),this.m_sprite.graphics.moveTo(0,0),this.m_sprite.graphics.beginFill(n.color,this.m_fillAlpha),this.m_sprite.graphics.drawCircle(t.x*this.m_drawScale,t.y*this.m_drawScale,e*this.m_drawScale),this.m_sprite.graphics.endFill(),this.m_sprite.graphics.moveTo(t.x*this.m_drawScale,t.y*this.m_drawScale),this.m_sprite.graphics.lineTo((t.x+i.x*e)*this.m_drawScale,(t.y+i.y*e)*this.m_drawScale)},t.prototype.DrawSegment=function(t,e,i){this.m_sprite.graphics.lineStyle(this.m_lineThickness,i.color,this.m_alpha),this.m_sprite.graphics.moveTo(t.x*this.m_drawScale,t.y*this.m_drawScale),this.m_sprite.graphics.lineTo(e.x*this.m_drawScale,e.y*this.m_drawScale)},t.prototype.DrawXForm=function(t){this.m_sprite.graphics.lineStyle(this.m_lineThickness,16711680,this.m_alpha),this.m_sprite.graphics.moveTo(t.position.x*this.m_drawScale,t.position.y*this.m_drawScale),this.m_sprite.graphics.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*this.m_drawScale,(t.position.y+this.m_xformScale*t.R.col1.y)*this.m_drawScale),this.m_sprite.graphics.lineStyle(this.m_lineThickness,65280,this.m_alpha),this.m_sprite.graphics.moveTo(t.position.x*this.m_drawScale,t.position.y*this.m_drawScale),this.m_sprite.graphics.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*this.m_drawScale,(t.position.y+this.m_xformScale*t.R.col2.y)*this.m_drawScale)},t.e_shapeBit=1,t.e_jointBit=2,t.e_coreShapeBit=4,t.e_aabbBit=8,t.e_obbBit=16,t.e_pairBit=32,t.e_centerOfMassBit=64,t}(),PB=function(){function t(){}return t.prototype.SayGoodbyeJoint=function(t){},t.prototype.SayGoodbyeShape=function(t){},t}(),BB=function(){function t(t,e,i,n,r){var o;for(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=r,this.m_bodies=new Array(t),o=0;o<t;o++)this.m_bodies[o]=null;for(this.m_contacts=new Array(e),o=0;o<e;o++)this.m_contacts[o]=null;for(this.m_joints=new Array(i),o=0;o<i;o++)this.m_joints[o]=null;this.m_positionIterationCount=0}return t.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},t.prototype.Solve=function(t,e,i,n){var r,o;for(r=0;r<this.m_bodyCount;++r)(o=this.m_bodies[r]).IsStatic()||(o.m_linearVelocity.x+=t.dt*(e.x+o.m_invMass*o.m_force.x),o.m_linearVelocity.y+=t.dt*(e.y+o.m_invMass*o.m_force.y),o.m_angularVelocity+=t.dt*o.m_invI*o.m_torque,o.m_force.SetZero(),o.m_torque=0,o.m_linearVelocity.Multiply(gP.b2Clamp(1-t.dt*o.m_linearDamping,0,1)),o.m_angularVelocity*=gP.b2Clamp(1-t.dt*o.m_angularDamping,0,1),o.m_linearVelocity.LengthSquared()>yP.b2_maxLinearVelocitySquared&&(o.m_linearVelocity.Normalize(),o.m_linearVelocity.x*=yP.b2_maxLinearVelocity,o.m_linearVelocity.y*=yP.b2_maxLinearVelocity),o.m_angularVelocity*o.m_angularVelocity>yP.b2_maxAngularVelocitySquared&&(o.m_angularVelocity<0?o.m_angularVelocity=-yP.b2_maxAngularVelocity:o.m_angularVelocity=yP.b2_maxAngularVelocity));var s=new nB(t,this.m_contacts,this.m_contactCount,this.m_allocator);for(s.InitVelocityConstraints(t),r=0;r<this.m_jointCount;++r)this.m_joints[r].InitVelocityConstraints(t);for(r=0;r<t.maxIterations;++r){s.SolveVelocityConstraints();for(var a=0;a<this.m_jointCount;++a)this.m_joints[a].SolveVelocityConstraints(t)}for(s.FinalizeVelocityConstraints(),r=0;r<this.m_bodyCount;++r)(o=this.m_bodies[r]).IsStatic()||(o.m_sweep.c0.SetV(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_sweep.c.x+=t.dt*o.m_linearVelocity.x,o.m_sweep.c.y+=t.dt*o.m_linearVelocity.y,o.m_sweep.a+=t.dt*o.m_angularVelocity,o.SynchronizeTransform());if(i){for(r=0;r<this.m_jointCount;++r)this.m_joints[r].InitPositionConstraints();for(this.m_positionIterationCount=0;this.m_positionIterationCount<t.maxIterations;++this.m_positionIterationCount){var l=s.SolvePositionConstraints(yP.b2_contactBaumgarte),u=!0;for(r=0;r<this.m_jointCount;++r){var c=this.m_joints[r].SolvePositionConstraints();u=u&&c}if(l&&u)break}}if(this.Report(s.m_constraints),n){var h=Number.MAX_VALUE,p=yP.b2_linearSleepTolerance*yP.b2_linearSleepTolerance,d=yP.b2_angularSleepTolerance*yP.b2_angularSleepTolerance;for(r=0;r<this.m_bodyCount;++r)0!=(o=this.m_bodies[r]).m_invMass&&(0==(o.m_flags&CB.e_allowSleepFlag)&&(o.m_sleepTime=0,h=0),0==(o.m_flags&CB.e_allowSleepFlag)||o.m_angularVelocity*o.m_angularVelocity>d||gP.b2Dot(o.m_linearVelocity,o.m_linearVelocity)>p?(o.m_sleepTime=0,h=0):(o.m_sleepTime+=t.dt,h=gP.b2Min(h,o.m_sleepTime)));if(h>=yP.b2_timeToSleep)for(r=0;r<this.m_bodyCount;++r)(o=this.m_bodies[r]).m_flags|=CB.e_sleepFlag,o.m_linearVelocity.SetZero(),o.m_angularVelocity=0}},t.prototype.SolveTOI=function(t){var e,i=new nB(t,this.m_contacts,this.m_contactCount,this.m_allocator);for(e=0;e<t.maxIterations;++e)i.SolveVelocityConstraints();for(e=0;e<this.m_bodyCount;++e){var n=this.m_bodies[e];n.IsStatic()||(n.m_sweep.c0.SetV(n.m_sweep.c),n.m_sweep.a0=n.m_sweep.a,n.m_sweep.c.x+=t.dt*n.m_linearVelocity.x,n.m_sweep.c.y+=t.dt*n.m_linearVelocity.y,n.m_sweep.a+=t.dt*n.m_angularVelocity,n.SynchronizeTransform())}for(e=0;e<t.maxIterations;++e){if(i.SolvePositionConstraints(.75))break}this.Report(i.m_constraints)},t.prototype.Report=function(e){if(null!=this.m_listener)for(var i=0;i<this.m_contactCount;++i){var n=this.m_contacts[i],r=e[i],o=t.s_reportCR;o.shape1=n.m_shape1,o.shape2=n.m_shape2;for(var s=o.shape1.m_body,a=n.m_manifoldCount,l=n.GetManifolds(),u=0;u<a;++u){var c=l[u];o.normal.SetV(c.normal);for(var h=0;h<c.pointCount;++h){var p=c.points[h],d=r.points[h];o.position=s.GetWorldPoint(p.localPoint1),o.normalImpulse=d.normalImpulse,o.tangentImpulse=d.tangentImpulse,o.id.key=p.id.key,this.m_listener.Result(o)}}}},t.prototype.AddBody=function(t){this.m_bodies[this.m_bodyCount++]=t},t.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},t.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},t.s_reportCR=new eB,t}(),MB=function(){function t(e,i,n){this.__fast__=!0,this.m_contactManager=new DB,this.m_destructionListener=null,this.m_boundaryListener=null,this.m_contactFilter=EB.b2_defaultFilter,this.m_contactListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,t.m_positionCorrection=!0,t.m_warmStarting=!0,t.m_continuousPhysics=!0,this.m_allowSleep=n,this.m_gravity=i,this.m_lock=!1,this.m_inv_dt0=0,this.m_contactManager.m_world=this,this.m_broadPhase=new RP(e,this.m_contactManager);var r=new wB;this.m_groundBody=this.CreateBody(r)}return t.prototype.SetDestructionListener=function(t){this.m_destructionListener=t},t.prototype.SetBoundaryListener=function(t){this.m_boundaryListener=t},t.prototype.SetContactFilter=function(t){this.m_contactFilter=t},t.prototype.SetContactListener=function(t){if(t){var e=t;if(void 0!==t.traits&&this.__fast__)for(var i=0,n=Object.getOwnPropertyNames(SB.prototype);i<n.length;i++){var r=n[i];!e[r]&&e["$Bg"+r]&&(e[r]=e["$Bg"+r])}this.m_contactListener=e}else this.m_contactListener=null},t.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},t.prototype.Validate=function(){this.m_broadPhase.Validate()},t.prototype.GetProxyCount=function(){return this.m_broadPhase.m_proxyCount},t.prototype.GetPairCount=function(){return this.m_broadPhase.m_pairManager.m_pairCount},t.prototype.CreateBody=function(t){if(1==this.m_lock)return null;var e=new CB(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e},t.prototype.DestroyBody=function(t){if(1!=this.m_lock){for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint)}for(var n=t.m_shapeList;n;){var r=n;n=n.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeShape(r),r.DestroyProxy(this.m_broadPhase),bP.Destroy(r,this.m_blockAllocator)}t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}},t.prototype.CreateJoint=function(t){var e=aB.Create(t,this.m_blockAllocator);if(e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_node1.joint=e,e.m_node1.other=e.m_body2,e.m_node1.prev=null,e.m_node1.next=e.m_body1.m_jointList,e.m_body1.m_jointList&&(e.m_body1.m_jointList.prev=e.m_node1),e.m_body1.m_jointList=e.m_node1,e.m_node2.joint=e,e.m_node2.other=e.m_body1,e.m_node2.prev=null,e.m_node2.next=e.m_body2.m_jointList,e.m_body2.m_jointList&&(e.m_body2.m_jointList.prev=e.m_node2),e.m_body2.m_jointList=e.m_node2,0==t.collideConnected)for(var i=t.body1.m_shapeCount<t.body2.m_shapeCount?t.body1:t.body2,n=i.m_shapeList;n;n=n.m_next)n.RefilterProxy(this.m_broadPhase,i.m_xf);return e},t.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var i=t.m_body1,n=t.m_body2;if(i.WakeUp(),n.WakeUp(),t.m_node1.prev&&(t.m_node1.prev.next=t.m_node1.next),t.m_node1.next&&(t.m_node1.next.prev=t.m_node1.prev),t.m_node1==i.m_jointList&&(i.m_jointList=t.m_node1.next),t.m_node1.prev=null,t.m_node1.next=null,t.m_node2.prev&&(t.m_node2.prev.next=t.m_node2.next),t.m_node2.next&&(t.m_node2.next.prev=t.m_node2.prev),t.m_node2==n.m_jointList&&(n.m_jointList=t.m_node2.next),t.m_node2.prev=null,t.m_node2.next=null,aB.Destroy(t,this.m_blockAllocator),--this.m_jointCount,0==e)for(var r=i.m_shapeCount<n.m_shapeCount?i:n,o=r.m_shapeList;o;o=o.m_next)o.RefilterProxy(this.m_broadPhase,r.m_xf)},t.prototype.Refilter=function(t){t.RefilterProxy(this.m_broadPhase,t.m_body.m_xf)},t.prototype.SetWarmStarting=function(e){t.m_warmStarting=e},t.prototype.SetPositionCorrection=function(e){t.m_positionCorrection=e},t.prototype.SetContinuousPhysics=function(e){t.m_continuousPhysics=e},t.prototype.GetBodyCount=function(){return this.m_bodyCount},t.prototype.GetJointCount=function(){return this.m_jointCount},t.prototype.GetContactCount=function(){return this.m_contactCount},t.prototype.SetGravity=function(t){this.m_gravity=t},t.prototype.GetGroundBody=function(){return this.m_groundBody},t.prototype.Step=function(e,i){this.m_lock=!0;var n=new iB;n.dt=e,n.maxIterations=i,n.inv_dt=e>0?1/e:0,n.dtRatio=this.m_inv_dt0*e,n.positionCorrection=t.m_positionCorrection,n.warmStarting=t.m_warmStarting,this.m_contactManager.Collide(),n.dt>0&&this.Solve(n),t.m_continuousPhysics&&n.dt>0&&this.SolveTOI(n),this.DrawDebugData(),this.m_inv_dt0=n.inv_dt,this.m_lock=!1},t.prototype.Query=function(t,e,i){var n=new Array(i),r=this.m_broadPhase.QueryAABB(t,n,i),o=e;void 0!==o.traits&&(o=o.value);for(var s=0;s<r;++s)o[s]=n[s];return r},t.prototype.GetBodyList=function(){return this.m_bodyList},t.prototype.GetJointList=function(){return this.m_jointList},t.prototype.Solve=function(e){var i;this.m_positionIterationCount=0;var n=new BB(this.m_bodyCount,this.m_contactCount,this.m_jointCount,this.m_stackAllocator,this.m_contactListener);for(i=this.m_bodyList;i;i=i.m_next)i.m_flags&=~CB.e_islandFlag;for(var r=this.m_contactList;r;r=r.m_next)r.m_flags&=~WP.e_islandFlag;for(var o=this.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(var s=this.m_bodyCount,a=new Array(s),l=this.m_bodyList;l;l=l.m_next)if(!(l.m_flags&(CB.e_islandFlag|CB.e_sleepFlag|CB.e_frozenFlag)||l.IsStatic())){n.Clear();var u=0;for(a[u++]=l,l.m_flags|=CB.e_islandFlag;u>0;)if(i=a[--u],n.AddBody(i),i.m_flags&=~CB.e_sleepFlag,!i.IsStatic()){for(var c,h=i.m_contactList;h;h=h.next)h.contact.m_flags&(WP.e_islandFlag|WP.e_nonSolidFlag)||0!=h.contact.m_manifoldCount&&(n.AddContact(h.contact),h.contact.m_flags|=WP.e_islandFlag,(c=h.other).m_flags&CB.e_islandFlag||(a[u++]=c,c.m_flags|=CB.e_islandFlag));for(var p=i.m_jointList;p;p=p.next)1!=p.joint.m_islandFlag&&(n.AddJoint(p.joint),p.joint.m_islandFlag=!0,(c=p.other).m_flags&CB.e_islandFlag||(a[u++]=c,c.m_flags|=CB.e_islandFlag))}n.Solve(e,this.m_gravity,t.m_positionCorrection,this.m_allowSleep),n.m_positionIterationCount>this.m_positionIterationCount&&(this.m_positionIterationCount=n.m_positionIterationCount);for(var d=0;d<n.m_bodyCount;++d)(i=n.m_bodies[d]).IsStatic()&&(i.m_flags&=~CB.e_islandFlag)}for(i=this.m_bodyList;i;i=i.m_next){if(!(i.m_flags&(CB.e_sleepFlag|CB.e_frozenFlag)))if(!i.IsStatic())0==i.SynchronizeShapes()&&null!=this.m_boundaryListener&&this.m_boundaryListener.Violation(i)}this.m_broadPhase.Commit()},t.prototype.SolveTOI=function(t){var e,i,n,r,o,s,a,l=new BB(this.m_bodyCount,yP.b2_maxTOIContactsPerIsland,0,this.m_stackAllocator,this.m_contactListener),u=this.m_bodyCount,c=new Array(u);for(e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~CB.e_islandFlag,e.m_sweep.t0=0;for(a=this.m_contactList;a;a=a.m_next)a.m_flags&=~(WP.e_toiFlag|WP.e_islandFlag);for(;;){var h=null,p=1;for(a=this.m_contactList;a;a=a.m_next)if(!(a.m_flags&(WP.e_slowFlag|WP.e_nonSolidFlag))){var d=1;if(a.m_flags&WP.e_toiFlag)d=a.m_toi;else{if(i=a.m_shape1,n=a.m_shape2,r=i.m_body,o=n.m_body,(r.IsStatic()||r.IsSleeping())&&(o.IsStatic()||o.IsSleeping()))continue;var f=r.m_sweep.t0;r.m_sweep.t0<o.m_sweep.t0?(f=o.m_sweep.t0,r.m_sweep.Advance(f)):o.m_sweep.t0<r.m_sweep.t0&&(f=r.m_sweep.t0,o.m_sweep.Advance(f)),(d=qP.TimeOfImpact(a.m_shape1,r.m_sweep,a.m_shape2,o.m_sweep))>0&&d<1&&(d=(1-d)*f+d)>1&&(d=1),a.m_toi=d,a.m_flags|=WP.e_toiFlag}Number.MIN_VALUE<d&&d<p&&(h=a,p=d)}if(null==h||1-100*Number.MIN_VALUE<p)break;if(i=h.m_shape1,n=h.m_shape2,r=i.m_body,o=n.m_body,r.Advance(p),o.Advance(p),h.Update(this.m_contactListener),h.m_flags&=~WP.e_toiFlag,0!=h.m_manifoldCount){var _=r;_.IsStatic()&&(_=o),l.Clear();var m=0;for(c[m++]=_,_.m_flags|=CB.e_islandFlag;m>0;)if(e=c[--m],l.AddBody(e),e.m_flags&=~CB.e_sleepFlag,!e.IsStatic())for(s=e.m_contactList;s;s=s.next)if(l.m_contactCount!=l.m_contactCapacity&&!(s.contact.m_flags&(WP.e_islandFlag|WP.e_slowFlag|WP.e_nonSolidFlag))&&0!=s.contact.m_manifoldCount){l.AddContact(s.contact),s.contact.m_flags|=WP.e_islandFlag;var g=s.other;g.m_flags&CB.e_islandFlag||(0==g.IsStatic()&&(g.Advance(p),g.WakeUp()),c[m++]=g,g.m_flags|=CB.e_islandFlag)}var y,A=new iB;for(A.dt=(1-p)*t.dt,A.inv_dt=1/A.dt,A.maxIterations=t.maxIterations,l.SolveTOI(A),y=0;y<l.m_bodyCount;++y){if((e=l.m_bodies[y]).m_flags&=~CB.e_islandFlag,!(e.m_flags&(CB.e_sleepFlag|CB.e_frozenFlag)))if(!e.IsStatic())for(0==e.SynchronizeShapes()&&null!=this.m_boundaryListener&&this.m_boundaryListener.Violation(e),s=e.m_contactList;s;s=s.next)s.contact.m_flags&=~WP.e_toiFlag}for(y=0;y<l.m_contactCount;++y)(a=l.m_contacts[y]).m_flags&=~(WP.e_toiFlag|WP.e_islandFlag);this.m_broadPhase.Commit()}}},t.prototype.DrawJoint=function(e){var i=e.m_body1,n=e.m_body2,r=i.m_xf,o=n.m_xf,s=r.position,a=o.position,l=e.GetAnchor1(),u=e.GetAnchor2(),c=t.s_jointColor;switch(e.m_type){case aB.e_distanceJoint:this.m_debugDraw.DrawSegment(l,u,c);break;case aB.e_pulleyJoint:var h=e,p=h.GetGroundAnchor1(),d=h.GetGroundAnchor2();this.m_debugDraw.DrawSegment(p,l,c),this.m_debugDraw.DrawSegment(d,u,c),this.m_debugDraw.DrawSegment(p,d,c);break;case aB.e_mouseJoint:this.m_debugDraw.DrawSegment(l,u,c);break;default:i!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,l,c),this.m_debugDraw.DrawSegment(l,u,c),n!=this.m_groundBody&&this.m_debugDraw.DrawSegment(a,u,c)}},t.prototype.DrawShape=function(e,i,n,r){var o=t.s_coreColor;switch(e.m_type){case bP.e_circleShape:var s=e,a=gP.b2MulX(i,s.m_localPosition),l=s.m_radius,u=i.R.col1;this.m_debugDraw.DrawSolidCircle(a,l,u,n),r&&this.m_debugDraw.DrawCircle(a,l-yP.b2_toiSlop,o);break;case bP.e_polygonShape:var c=void 0,h=e,p=h.GetVertexCount(),d=h.GetVertices(),f=new Array(yP.b2_maxPolygonVertices);for(c=0;c<p;++c)f[c]=gP.b2MulX(i,d[c]);if(this.m_debugDraw.DrawSolidPolygon(f,p,n),r){var _=h.GetCoreVertices();for(c=0;c<p;++c)f[c]=gP.b2MulX(i,_[c]);this.m_debugDraw.DrawPolygon(f,p,o)}}},t.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var e,i,n,r,o,s,a=this.m_debugDraw.GetFlags(),l=new _P,u=new _P,c=new _P,h=new YP(0,0,0),p=new vP,d=new vP,f=[new _P,new _P,new _P,new _P];if(a&TB.e_shapeBit){var _=(a&TB.e_coreShapeBit)==TB.e_coreShapeBit;for(i=this.m_bodyList;i;i=i.m_next)for(s=i.m_xf,n=i.GetShapeList();n;n=n.m_next)i.IsStatic()?this.DrawShape(n,s,new YP(.5,.9,.5),_):i.IsSleeping()?this.DrawShape(n,s,new YP(.5,.5,.9),_):this.DrawShape(n,s,new YP(.9,.9,.9),_)}if(a&TB.e_jointBit)for(r=this.m_jointList;r;r=r.m_next)this.DrawJoint(r);if(a&TB.e_pairBit)for(o=this.m_broadPhase,l.Set(1/o.m_quantizationFactor.x,1/o.m_quantizationFactor.y),h.Set(.9,.9,.3),e=0;e<AP.b2_tableCapacity;++e)for(var m=o.m_pairManager.m_hashTable[e];m!=AP.b2_nullPair;){var g=o.m_pairManager.m_pairs[m],y=o.m_proxyPool[g.proxyId1],A=o.m_proxyPool[g.proxyId2];p.lowerBound.x=o.m_worldAABB.lowerBound.x+l.x*o.m_bounds[0][y.lowerBounds[0]].value,p.lowerBound.y=o.m_worldAABB.lowerBound.y+l.y*o.m_bounds[1][y.lowerBounds[1]].value,p.upperBound.x=o.m_worldAABB.lowerBound.x+l.x*o.m_bounds[0][y.upperBounds[0]].value,p.upperBound.y=o.m_worldAABB.lowerBound.y+l.y*o.m_bounds[1][y.upperBounds[1]].value,d.lowerBound.x=o.m_worldAABB.lowerBound.x+l.x*o.m_bounds[0][A.lowerBounds[0]].value,d.lowerBound.y=o.m_worldAABB.lowerBound.y+l.y*o.m_bounds[1][A.lowerBounds[1]].value,d.upperBound.x=o.m_worldAABB.lowerBound.x+l.x*o.m_bounds[0][A.upperBounds[0]].value,d.upperBound.y=o.m_worldAABB.lowerBound.y+l.y*o.m_bounds[1][A.upperBounds[1]].value,u.x=.5*(p.lowerBound.x+p.upperBound.x),u.y=.5*(p.lowerBound.y+p.upperBound.y),c.x=.5*(d.lowerBound.x+d.upperBound.x),c.y=.5*(d.lowerBound.y+d.upperBound.y),this.m_debugDraw.DrawSegment(u,c,h),m=g.next}if(a&TB.e_aabbBit){var v=(o=this.m_broadPhase).m_worldAABB.lowerBound,b=o.m_worldAABB.upperBound;for(l.Set(1/o.m_quantizationFactor.x,1/o.m_quantizationFactor.y),h.Set(.9,.3,.9),e=0;e<yP.b2_maxProxies;++e){var x=o.m_proxyPool[e];0!=x.IsValid()&&(p.lowerBound.x=v.x+l.x*o.m_bounds[0][x.lowerBounds[0]].value,p.lowerBound.y=v.y+l.y*o.m_bounds[1][x.lowerBounds[1]].value,p.upperBound.x=v.x+l.x*o.m_bounds[0][x.upperBounds[0]].value,p.upperBound.y=v.y+l.y*o.m_bounds[1][x.upperBounds[1]].value,f[0].Set(p.lowerBound.x,p.lowerBound.y),f[1].Set(p.upperBound.x,p.lowerBound.y),f[2].Set(p.upperBound.x,p.upperBound.y),f[3].Set(p.lowerBound.x,p.upperBound.y),this.m_debugDraw.DrawPolygon(f,4,h))}f[0].Set(v.x,v.y),f[1].Set(b.x,v.y),f[2].Set(b.x,b.y),f[3].Set(v.x,b.y),this.m_debugDraw.DrawPolygon(f,4,new YP(.3,.9,.9))}if(a&TB.e_obbBit)for(h.Set(.5,.3,.5),i=this.m_bodyList;i;i=i.m_next)for(s=i.m_xf,n=i.GetShapeList();n;n=n.m_next)if(n.m_type==bP.e_polygonShape){var C=n.GetOBB(),w=C.extents;for(f[0].Set(-w.x,-w.y),f[1].Set(w.x,-w.y),f[2].Set(w.x,w.y),f[3].Set(-w.x,w.y),e=0;e<4;++e){var I,E=C.R,S=f[e];I=C.center.x+(E.col1.x*S.x+E.col2.x*S.y),f[e].y=C.center.y+(E.col1.y*S.x+E.col2.y*S.y),f[e].x=I,E=s.R,I=s.position.x+(E.col1.x*S.x+E.col2.x*S.y),f[e].y=s.position.y+(E.col1.y*S.x+E.col2.y*S.y),f[e].x=I}this.m_debugDraw.DrawPolygon(f,4,h)}if(a&TB.e_centerOfMassBit)for(i=this.m_bodyList;i;i=i.m_next)(s=t.s_xf).R=i.m_xf.R,s.position=i.GetWorldCenter(),this.m_debugDraw.DrawXForm(s)}},t.s_jointColor=new YP(.5,.8,.8),t.s_coreColor=new YP(.9,.6,.6),t.s_xf=new mP,t}(),OB={b2CircleDef:wP,b2CircleShape:IP,b2FilterData:xP,b2MassData:EP,b2PolygonDef:SP,b2PolygonShape:TP,b2Shape:bP,b2ShapeDef:CP,b2AABB:vP,b2Bound:PP,b2BoundValues:BP,b2BroadPhase:RP,b2BufferedPair:OP,b2Collision:VP,b2ContactID:FP,b2ContactPoint:UP,b2Distance:GP,b2Manifold:zP,b2ManifoldPoint:QP,b2OBB:DP,b2Pair:AP,b2PairCallback:HP,b2Point:jP,b2Proxy:MP,b2Segment:XP,b2TimeOfImpact:qP,ClipVertex:kP,Features:NP,b2Mat22:dP,b2Math:gP,b2Sweep:fP,b2Vec2:_P,b2XForm:mP,b2Color:YP,b2Settings:yP,b2CircleContact:JP,b2Contact:WP,b2ContactConstraint:$P,b2ContactConstraintPoint:ZP,b2ContactEdge:KP,b2ContactRegister:tB,b2ContactResult:eB,b2ContactSolver:nB,b2NullContact:rB,b2PolyAndCircleContact:oB,b2PolygonContact:sB,b2DistanceJoint:xB,b2DistanceJointDef:uB,b2GearJoint:hB,b2GearJointDef:pB,b2Jacobian:cB,b2Joint:aB,b2JointDef:lB,b2JointEdge:dB,b2MouseJoint:fB,b2MouseJointDef:_B,b2PrismaticJoint:mB,b2PrismaticJointDef:gB,b2PulleyJoint:yB,b2PulleyJointDef:AB,b2RevoluteJoint:vB,b2RevoluteJointDef:bB,b2Body:CB,b2BodyDef:wB,b2BoundaryListener:IB,b2ContactFilter:EB,b2ContactListener:SB,b2ContactManager:DB,b2DebugDraw:TB,b2DestructionListener:PB,b2Island:BB,b2TimeStep:iB,b2World:MB},LB=function(){this.__fast__=!0},RB=function(){function t(){}return t.b2MixFriction=function(t,e){return Math.sqrt(t*e)},t.b2MixRestitution=function(t,e){return t>e?t:e},t.b2Assert=function(t){if(!t)throw"Assertion Failed"},t.VERSION="2.1alpha",t.USHRT_MAX=65535,t.b2_pi=Math.PI,t.b2_maxManifoldPoints=2,t.b2_aabbExtension=.1,t.b2_aabbMultiplier=2,t.b2_linearSlop=.005,t.b2_polygonRadius=2*t.b2_linearSlop,t.b2_angularSlop=2/180*t.b2_pi,t.b2_toiSlop=8*t.b2_linearSlop,t.b2_maxTOIContactsPerIsland=32,t.b2_maxTOIJointsPerIsland=32,t.b2_velocityThreshold=1,t.b2_maxLinearCorrection=.2,t.b2_maxAngularCorrection=8/180*t.b2_pi,t.b2_maxTranslation=2,t.b2_maxTranslationSquared=t.b2_maxTranslation*t.b2_maxTranslation,t.b2_maxRotation=.5*t.b2_pi,t.b2_maxRotationSquared=t.b2_maxRotation*t.b2_maxRotation,t.b2_contactBaumgarte=.2,t.b2_timeToSleep=.5,t.b2_linearSleepTolerance=.01,t.b2_angularSleepTolerance=2/180*t.b2_pi,t}(),NB=function(){function t(){this.__fast__=!0}return t.prototype.Set=function(t){switch(t.GetType()){case KB.e_circleShape:var e=t;this.m_vertices=new Array(1),this.m_vertices[0]=e.m_p,this.m_count=1,this.m_radius=e.m_radius;break;case KB.e_polygonShape:var i=t;this.m_vertices=i.m_vertices,this.m_count=i.m_vertexCount,this.m_radius=i.m_radius;break;default:RB.b2Assert(!1)}},t.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return e},t.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return this.m_vertices[e]},t.prototype.GetVertexCount=function(){return this.m_count},t.prototype.GetVertex=function(t){return RB.b2Assert(0<=t&&t<this.m_count),this.m_vertices[t]},t}(),FB=function(){this.__fast__=!0,this.indexA=new Array(3),this.indexB=new Array(3)},kB=function(){function t(){this.__fast__=!0,this.col1=new GB,this.col2=new GB,this.col1.x=this.col2.y=1}return t.FromAngle=function(e){var i=new t;return i.Set(e),i},t.FromVV=function(e,i){var n=new t;return n.SetVV(e,i),n},t.prototype.Set=function(t){var e=Math.cos(t),i=Math.sin(t);this.col1.x=e,this.col2.x=-i,this.col1.y=i,this.col2.y=e},t.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},t.prototype.Copy=function(){var e=new t;return e.SetM(this),e},t.prototype.SetM=function(t){this.col1.SetV(t.col1||t.$Bgcol1),this.col2.SetV(t.col2||t.$Bgcol2)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},t.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},t.prototype.GetInverse=function(t){var e=this.col1.x,i=this.col2.x,n=this.col1.y,r=this.col2.y,o=e*r-i*n;return 0!=o&&(o=1/o),t.col1.x=o*r,t.col2.x=-o*i,t.col1.y=-o*n,t.col2.y=o*e,t},t.prototype.Solve=function(t,e,i){var n=this.col1.x,r=this.col2.x,o=this.col1.y,s=this.col2.y,a=n*s-r*o;return 0!=a&&(a=1/a),t.x=a*(s*e-r*i),t.y=a*(n*i-o*e),t},t.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},t}(),VB=function(){function t(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),this.col1=new QB,this.col2=new QB,this.col3=new QB,t||e||i?(this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())}return t.prototype.SetVVV=function(t,e,i){this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)},t.prototype.Copy=function(){return new t(this.col1,this.col2,this.col3)},t.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2),this.col3.SetV(t.col3)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col1.z+=t.col1.z,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y,this.col2.z+=t.col2.z,this.col3.x+=t.col3.x,this.col3.y+=t.col3.y,this.col3.z+=t.col3.z},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},t.prototype.Solve22=function(t,e,i){var n=this.col1.x,r=this.col2.x,o=this.col1.y,s=this.col2.y,a=n*s-r*o;return 0!=a&&(a=1/a),t.x=a*(s*e-r*i),t.y=a*(n*i-o*e),t},t.prototype.Solve33=function(t,e,i,n){var r=this.col1.x,o=this.col1.y,s=this.col1.z,a=this.col2.x,l=this.col2.y,u=this.col2.z,c=this.col3.x,h=this.col3.y,p=this.col3.z,d=r*(l*p-u*h)+o*(u*c-a*p)+s*(a*h-l*c);return 0!=d&&(d=1/d),t.x=d*(e*(l*p-u*h)+i*(u*c-a*p)+n*(a*h-l*c)),t.y=d*(r*(i*p-n*h)+o*(n*c-e*p)+s*(e*h-i*c)),t.z=d*(r*(l*n-u*i)+o*(u*e-a*n)+s*(a*i-l*e)),t},t}(),UB=function(){function t(){this.localCenter=new GB,this.c0=new GB,this.c=new GB}return t.prototype.Set=function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0},t.prototype.Copy=function(){var e=new t;return e.localCenter.SetV(this.localCenter),e.c0.SetV(this.c0),e.c.SetV(this.c),e.a0=this.a0,e.a=this.a,e.t0=this.t0,e},t.prototype.GetTransform=function(t,e){t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var n=t.R;t.position.x-=n.col1.x*this.localCenter.x+n.col2.x*this.localCenter.y,t.position.y-=n.col1.y*this.localCenter.x+n.col2.y*this.localCenter.y},t.prototype.Advance=function(t){if(this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}},t}(),jB=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.__fast__=!0,this.position=new GB,this.R=new kB,t&&(this.position.SetV(t),this.R.SetM(e))}return t.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},t.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},t.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},t.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},t}(),GB=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.__fast__=!0,this.x=t,this.y=e}return t.prototype.SetZero=function(){this.x=0,this.y=0},t.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},t.prototype.SetV=function(t){this.x=t.x,this.y=t.y},t.prototype.GetNegative=function(){return new t(-this.x,-this.y)},t.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},t.Make=function(e,i){return new t(e,i)},t.prototype.Copy=function(){return new t(this.x,this.y)},t.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},t.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},t.prototype.Multiply=function(t){this.x*=t,this.y*=t},t.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y,this.y=t.col1.y*e+t.col2.y*this.y},t.prototype.MulTM=function(t){var e=zB.Dot(this,t.col1);this.y=zB.Dot(this,t.col2),this.x=e},t.prototype.CrossVF=function(t){var e=this.x;this.x=t*this.y,this.y=-t*e},t.prototype.CrossFV=function(t){var e=this.x;this.x=-t*this.y,this.y=t*e},t.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},t.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},t.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},t.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},t.prototype.IsValid=function(){return zB.IsValid(this.x)&&zB.IsValid(this.y)},t}(),QB=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.__fast__=!0,this.x=t,this.y=e,this.z=i}return t.prototype.SetZero=function(){this.x=this.y=this.z=0},t.prototype.Set=function(t,e,i){this.x=t,this.y=e,this.z=i},t.prototype.SetV=function(t){this.x=t.x,this.y=t.y,this.z=t.z},t.prototype.GetNegative=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},t.prototype.Copy=function(){return new t(this.x,this.y,this.z)},t.prototype.Add=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},t.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},t.prototype.Multiply=function(t){this.x*=t,this.y*=t,this.z*=t},t}(),zB=function(){function t(){}return t.IsValid=function(t){return isFinite(t)},t.Dot=function(t,e){return t.x*e.x+t.y*e.y},t.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},t.CrossVF=function(t,e){return new GB(e*t.y,-e*t.x)},t.CrossFV=function(t,e){return new GB(-t*e.y,t*e.x)},t.MulMV=function(t,e){return new GB(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y)},t.MulTMV=function(t,e){return new GB(this.Dot(e,t.col1),this.Dot(e,t.col2))},t.MulX=function(t,e){var i=this.MulMV(t.R,e);return i.x+=t.position.x,i.y+=t.position.y,i},t.MulXT=function(t,e){var i=this.SubtractVV(e,t.position),n=i.x*t.R.col1.x+i.y*t.R.col1.y;return i.y=i.x*t.R.col2.x+i.y*t.R.col2.y,i.x=n,i},t.AddVV=function(t,e){return new GB(t.x+e.x,t.y+e.y)},t.SubtractVV=function(t,e){return new GB(t.x-e.x,t.y-e.y)},t.Distance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},t.DistanceSquared=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},t.MulFV=function(t,e){return new GB(t*e.x,t*e.y)},t.AddMM=function(t,e){return kB.FromVV(this.AddVV(t.col1,e.col1),this.AddVV(t.col2,e.col2))},t.MulMM=function(t,e){return kB.FromVV(this.MulMV(t,e.col1),this.MulMV(t,e.col2))},t.MulTMM=function(t,e){var i=new GB(this.Dot(t.col1,e.col1),this.Dot(t.col2,e.col1)),n=new GB(this.Dot(t.col1,e.col2),this.Dot(t.col2,e.col2));return kB.FromVV(i,n)},t.Abs=function(t){return t>0?t:-t},t.AbsV=function(t){return new GB(this.Abs(t.x),this.Abs(t.y))},t.AbsM=function(t){return kB.FromVV(this.AbsV(t.col1),this.AbsV(t.col2))},t.Min=function(t,e){return t<e?t:e},t.MinV=function(t,e){return new GB(this.Min(t.x,e.x),this.Min(t.y,e.y))},t.Max=function(t,e){return t>e?t:e},t.MaxV=function(t,e){return new GB(this.Max(t.x,e.x),this.Max(t.y,e.y))},t.Clamp=function(t,e,i){return t<e?e:t>i?i:t},t.ClampV=function(t,e,i){return this.MaxV(e,this.MinV(t,i))},t.Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},t.Random=function(){return 2*Math.random()-1},t.RandomRange=function(t,e){var i=Math.random();return i=(e-t)*i+t},t.NextPowerOfTwo=function(t){return t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,(t|=t>>16&65535)+1},t.IsPowerOfTwo=function(t){return t>0&&0==(t&t-1)},t.b2Vec2_zero=new GB(0,0),t.b2Mat22_identity=kB.FromVV(new GB(1,0),new GB(0,1)),t.b2Transform_identity=new jB(t.b2Vec2_zero,t.b2Mat22_identity),t}(),HB=function(){this.__fast__=!0,this.pointA=new GB,this.pointB=new GB},XB=function(){function t(){this.__fast__=!0}return t.prototype.Set=function(t){this.wA.SetV(t.wA),this.wB.SetV(t.wB),this.w.SetV(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB},t}(),qB=function(){function t(){this.__fast__=!0,this.m_v1=new XB,this.m_v2=new XB,this.m_v3=new XB,this.m_vertices=new Array(3),this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3}return t.prototype.ReadCache=function(t,e,i,n,r){var o,s;RB.b2Assert(0<=t.count&&t.count<=3),this.m_count=t.count;for(var a=this.m_vertices,l=0;l<this.m_count;l++){var u=a[l];u.indexA=t.indexA[l],u.indexB=t.indexB[l],o=e.GetVertex(u.indexA),s=n.GetVertex(u.indexB),u.wA=zB.MulX(i,o),u.wB=zB.MulX(r,s),u.w=zB.SubtractVV(u.wB,u.wA),u.a=0}if(this.m_count>1){var c=t.metric,h=this.GetMetric();(h<.5*c||2*c<h||h<Number.MIN_VALUE)&&(this.m_count=0)}0==this.m_count&&((u=a[0]).indexA=0,u.indexB=0,o=e.GetVertex(0),s=n.GetVertex(0),u.wA=zB.MulX(i,o),u.wB=zB.MulX(r,s),u.w=zB.SubtractVV(u.wB,u.wA),this.m_count=1)},t.prototype.WriteCache=function(t){t.metric=this.GetMetric(),t.count=this.m_count>>>0;for(var e=this.m_vertices,i=0;i<this.m_count;i++)t.indexA[i]=e[i].indexA,t.indexB[i]=e[i].indexB},t.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=zB.SubtractVV(this.m_v2.w,this.m_v1.w);return zB.CrossVV(t,this.m_v1.w.GetNegative())>0?zB.CrossFV(1,t):zB.CrossVF(t,1);default:return RB.b2Assert(!1),new GB}},t.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return RB.b2Assert(!1),new GB;case 1:return this.m_v1.w;case 2:return new GB(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return RB.b2Assert(!1),new GB}},t.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:RB.b2Assert(!1);break;case 1:t.SetV(this.m_v1.wA),e.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:RB.b2Assert(!1)}},t.prototype.GetMetric=function(){switch(this.m_count){case 0:return RB.b2Assert(!1),0;case 1:return 0;case 2:return zB.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return zB.CrossVV(zB.SubtractVV(this.m_v2.w,this.m_v1.w),zB.SubtractVV(this.m_v3.w,this.m_v1.w));default:return RB.b2Assert(!1),0}},t.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=zB.SubtractVV(e,t),n=-(t.x*i.x+t.y*i.y);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);var r=e.x*i.x+e.y*i.y;if(r<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var o=1/(r+n);this.m_v1.a=r*o,this.m_v2.a=n*o,this.m_count=2},t.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,n=zB.SubtractVV(e,t),r=zB.Dot(t,n),o=zB.Dot(e,n),s=-r,a=zB.SubtractVV(i,t),l=zB.Dot(t,a),u=zB.Dot(i,a),c=-l,h=zB.SubtractVV(i,e),p=zB.Dot(e,h),d=zB.Dot(i,h),f=-p,_=zB.CrossVV(n,a),m=_*zB.CrossVV(e,i),g=_*zB.CrossVV(i,t),y=_*zB.CrossVV(t,e);if(s<=0&&c<=0)return this.m_v1.a=1,void(this.m_count=1);if(o>0&&s>0&&y<=0){var A=1/(o+s);return this.m_v1.a=o*A,this.m_v2.a=s*A,void(this.m_count=2)}if(u>0&&c>0&&g<=0){var v=1/(u+c);return this.m_v1.a=u*v,this.m_v3.a=c*v,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(o<=0&&f<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(u<=0&&d<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(d>0&&f>0&&m<=0){var b=1/(d+f);return this.m_v2.a=d*b,this.m_v3.a=f*b,this.m_count=2,void this.m_v1.Set(this.m_v3)}var x=1/(m+g+y);this.m_v1.a=m*x,this.m_v2.a=g*x,this.m_v3.a=y*x,this.m_count=3},t}(),YB=function(){function t(){this.__fast__=!0}return t.Distance=function(t,e,i){++this.b2_gjkCalls;var n=i.proxyA,r=i.proxyB,o=i.transformA,s=i.transformB,a=this.s_simplex;a.ReadCache(e,n,o,r,s);for(var l,u,c=a.m_vertices,h=this.s_saveA,p=this.s_saveB,d=0,f=(a.GetClosestPoint().LengthSquared(),0);f<20;){for(d=a.m_count,l=0;l<d;l++)h[l]=c[l].indexA,p[l]=c[l].indexB;switch(a.m_count){case 1:break;case 2:a.Solve2();break;case 3:a.Solve3();break;default:RB.b2Assert(!1)}if(3==a.m_count)break;(u=a.GetClosestPoint()).LengthSquared();var _=a.GetSearchDirection();if(_.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var m=c[a.m_count];m.indexA=n.GetSupport(zB.MulTMV(o.R,_.GetNegative())),m.wA=zB.MulX(o,n.GetVertex(m.indexA)),m.indexB=r.GetSupport(zB.MulTMV(s.R,_)),m.wB=zB.MulX(s,r.GetVertex(m.indexB)),m.w=zB.SubtractVV(m.wB,m.wA),++f,++this.b2_gjkIters;var g=!1;for(l=0;l<d;l++)if(m.indexA==h[l]&&m.indexB==p[l]){g=!0;break}if(g)break;++a.m_count}if(this.b2_gjkMaxIters=zB.Max(this.b2_gjkMaxIters,f),a.GetWitnessPoints(t.pointA,t.pointB),t.distance=zB.SubtractVV(t.pointA,t.pointB).Length(),t.iterations=f,a.WriteCache(e),i.useRadii){var y=n.m_radius,A=r.m_radius;if(t.distance>y+A&&t.distance>Number.MIN_VALUE){t.distance-=y+A;var v=zB.SubtractVV(t.pointB,t.pointA);v.Normalize(),t.pointA.x+=y*v.x,t.pointA.y+=y*v.y,t.pointB.x-=A*v.x,t.pointB.y-=A*v.y}else(u=new GB).x=.5*(t.pointA.x+t.pointB.x),u.y=.5*(t.pointA.y+t.pointB.y),t.pointA.x=t.pointB.x=u.x,t.pointA.y=t.pointB.y=u.y,t.distance=0}},t.s_simplex=new qB,t.s_saveA=new Array(3),t.s_saveB=new Array(3),t}(),KB=function(){function t(){this.__fast__=!0,this.m_type=t.e_unknownShape,this.m_radius=RB.b2_linearSlop}return t.prototype.Copy=function(){return null},t.prototype.Set=function(t){this.m_radius=t.m_radius},t.prototype.GetType=function(){return this.m_type},t.prototype.TestPoint=function(t,e){return!1},t.prototype.RayCast=function(t,e,i){return!1},t.prototype.ComputeAABB=function(t,e){},t.prototype.ComputeMass=function(t,e){},t.prototype.ComputeSubmergedArea=function(t,e,i,n){return 0},t.TestOverlap=function(t,e,i,n){var r=new LB;r.proxyA=new NB,r.proxyA.Set(t),r.proxyB=new NB,r.proxyB.Set(i),r.transformA=e,r.transformB=n,r.useRadii=!0;var o=new FB;o.count=0;var s=new HB;return YB.Distance(s,o,r),s.distance<10*Number.MIN_VALUE},t.e_unknownShape=-1,t.e_circleShape=0,t.e_polygonShape=1,t.e_edgeShape=2,t.e_shapeTypeCount=3,t.e_hitCollide=1,t.e_missCollide=0,t.e_startsInsideCollide=-1,t}(),WB=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this)||this;return i.__fast__=!0,i.m_p=new GB,i.m_type=KB.e_circleShape,i.m_radius=e,i}return i(e,t),e.prototype.Copy=function(){var t=new e;return t.Set(this),t},e.prototype.Set=function(i){if(t.prototype.Set.call(this,i),i instanceof e){var n=i;this.m_p.SetV(n.m_p)}},e.prototype.TestPoint=function(t,e){var i=t.R,n=t.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),r=t.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);return(n=e.x-n)*n+(r=e.y-r)*r<=this.m_radius*this.m_radius},e.prototype.RayCast=function(t,e,i){var n=i.R,r=i.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),o=i.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),s=e.p1.x-r,a=e.p1.y-o,l=s*s+a*a-this.m_radius*this.m_radius,u=e.p2.x-e.p1.x,c=e.p2.y-e.p1.y,h=s*u+a*c,p=u*u+c*c,d=h*h-p*l;if(d<0||p<Number.MIN_VALUE)return!1;var f=-(h+Math.sqrt(d));return 0<=f&&f<=e.maxFraction*p&&(f/=p,t.fraction=f,t.normal.x=s+f*u,t.normal.y=a+f*c,t.normal.Normalize(),!0)},e.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),r=e.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,r-this.m_radius),t.upperBound.Set(n+this.m_radius,r+this.m_radius)},e.prototype.ComputeMass=function(t,e){t.mass=e*RB.b2_pi*this.m_radius*this.m_radius,t.center.SetV(this.m_p),t.I=t.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},e.prototype.ComputeSubmergedArea=function(t,e,i,n){var r=zB.MulX(i,this.m_p),o=-(zB.Dot(t,r)-e);if(o<-this.m_radius+Number.MIN_VALUE)return 0;if(o>this.m_radius)return n.SetV(r),Math.PI*this.m_radius*this.m_radius;var s=this.m_radius*this.m_radius,a=o*o,l=s*(Math.asin(o/this.m_radius)+Math.PI/2)+o*Math.sqrt(s-a),u=-2/3*Math.pow(s-a,1.5)/l;return n.x=r.x+t.x*u,n.y=r.y+t.y*u,l},e.prototype.GetLocalPosition=function(){return this.m_p},e.prototype.SetLocalPosition=function(t){this.m_p.SetV(t)},e.prototype.GetRadius=function(){return this.m_radius},e.prototype.SetRadius=function(t){this.m_radius=t},e}(KB),JB=function(t){function e(e,i){var n=t.call(this)||this;return n.__fast__=!0,n.s_supportVec=new GB,n.m_v1=new GB,n.m_v2=new GB,n.m_coreV1=new GB,n.m_coreV2=new GB,n.m_normal=new GB,n.m_direction=new GB,n.m_cornerDir1=new GB,n.m_cornerDir2=new GB,n.m_type=KB.e_edgeShape,n.m_prevEdge=null,n.m_nextEdge=null,n.m_v1=e,n.m_v2=i,n.m_direction.Set(n.m_v2.x-n.m_v1.x,n.m_v2.y-n.m_v1.y),n.m_length=n.m_direction.Normalize(),n.m_normal.Set(n.m_direction.y,-n.m_direction.x),n.m_coreV1.Set(-RB.b2_toiSlop*(n.m_normal.x-n.m_direction.x)+n.m_v1.x,-RB.b2_toiSlop*(n.m_normal.y-n.m_direction.y)+n.m_v1.y),n.m_coreV2.Set(-RB.b2_toiSlop*(n.m_normal.x+n.m_direction.x)+n.m_v2.x,-RB.b2_toiSlop*(n.m_normal.y+n.m_direction.y)+n.m_v2.y),n.m_cornerDir1=n.m_normal,n.m_cornerDir2.Set(-n.m_normal.x,-n.m_normal.y),n}return i(e,t),e.prototype.TestPoint=function(t,e){return!1},e.prototype.RayCast=function(t,e,i){var n,r=e.p2.x-e.p1.x,o=e.p2.y-e.p1.y;n=i.R;var s=i.position.x+(n.col1.x*this.m_v1.x+n.col2.x*this.m_v1.y),a=i.position.y+(n.col1.y*this.m_v1.x+n.col2.y*this.m_v1.y),l=i.position.y+(n.col1.y*this.m_v2.x+n.col2.y*this.m_v2.y)-a,u=-(i.position.x+(n.col1.x*this.m_v2.x+n.col2.x*this.m_v2.y)-s),c=100*Number.MIN_VALUE,h=-(r*l+o*u);if(h>c){var p=e.p1.x-s,d=e.p1.y-a,f=p*l+d*u;if(0<=f&&f<=e.maxFraction*h){var _=-r*d+o*p;if(-c*h<=_&&_<=h*(1+c)){f/=h,t.fraction=f;var m=Math.sqrt(l*l+u*u);return t.normal.x=l/m,t.normal.y=u/m,!0}}}return!1},e.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_v1.x+i.col2.x*this.m_v1.y),r=e.position.y+(i.col1.y*this.m_v1.x+i.col2.y*this.m_v1.y),o=e.position.x+(i.col1.x*this.m_v2.x+i.col2.x*this.m_v2.y),s=e.position.y+(i.col1.y*this.m_v2.x+i.col2.y*this.m_v2.y);n<o?(t.lowerBound.x=n,t.upperBound.x=o):(t.lowerBound.x=o,t.upperBound.x=n),r<s?(t.lowerBound.y=r,t.upperBound.y=s):(t.lowerBound.y=s,t.upperBound.y=r)},e.prototype.ComputeMass=function(t,e){t.mass=0,t.center.SetV(this.m_v1),t.I=0},e.prototype.ComputeSubmergedArea=function(t,e,i,n){var r=new GB(t.x*e,t.y*e),o=zB.MulX(i,this.m_v1),s=zB.MulX(i,this.m_v2),a=zB.Dot(t,o)-e,l=zB.Dot(t,s)-e;if(a>0){if(l>0)return 0;o.x=-l/(a-l)*o.x+a/(a-l)*s.x,o.y=-l/(a-l)*o.y+a/(a-l)*s.y}else l>0&&(s.x=-l/(a-l)*o.x+a/(a-l)*s.x,s.y=-l/(a-l)*o.y+a/(a-l)*s.y);return n.x=(r.x+o.x+s.x)/3,n.y=(r.y+o.y+s.y)/3,.5*((o.x-r.x)*(s.y-r.y)-(o.y-r.y)*(s.x-r.x))},e.prototype.GetLength=function(){return this.m_length},e.prototype.GetVertex1=function(){return this.m_v1},e.prototype.GetVertex2=function(){return this.m_v2},e.prototype.GetCoreVertex1=function(){return this.m_coreV1},e.prototype.GetCoreVertex2=function(){return this.m_coreV2},e.prototype.GetNormalVector=function(){return this.m_normal},e.prototype.GetDirectionVector=function(){return this.m_direction},e.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},e.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},e.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},e.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},e.prototype.GetFirstVertex=function(t){var e=t.R;return new GB(t.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),t.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y))},e.prototype.GetNextEdge=function(){return this.m_nextEdge},e.prototype.GetPrevEdge=function(){return this.m_prevEdge},e.prototype.Support=function(t,e,i){var n=t.R,r=t.position.x+(n.col1.x*this.m_coreV1.x+n.col2.x*this.m_coreV1.y),o=t.position.y+(n.col1.y*this.m_coreV1.x+n.col2.y*this.m_coreV1.y),s=t.position.x+(n.col1.x*this.m_coreV2.x+n.col2.x*this.m_coreV2.y),a=t.position.y+(n.col1.y*this.m_coreV2.x+n.col2.y*this.m_coreV2.y);return r*e+o*i>s*e+a*i?(this.s_supportVec.x=r,this.s_supportVec.y=o):(this.s_supportVec.x=s,this.s_supportVec.y=a),this.s_supportVec},e.prototype.SetPrevEdge=function(t,e,i,n){this.m_prevEdge=t,this.m_coreV1=e,this.m_cornerDir1=i,this.m_cornerConvex1=n},e.prototype.SetNextEdge=function(t,e,i,n){this.m_nextEdge=t,this.m_coreV2=e,this.m_cornerDir2=i,this.m_cornerConvex2=n},e}(KB),ZB=function(){this.mass=0,this.center=new GB(0,0),this.I=0},$B=function(t){function e(){var e=t.call(this)||this;return e.__fast__=!0,e.m_type=KB.e_polygonShape,e.m_centroid=new GB,e.m_vertices=new Array,e.m_normals=new Array,e}return i(e,t),e.prototype.Copy=function(){var t=new e;return t.Set(this),t},e.prototype.Set=function(i){if(t.prototype.Set.call(this,i),i instanceof e){var n=i;this.m_centroid.SetV(n.m_centroid),this.m_vertexCount=n.m_vertexCount,this.Reserve(this.m_vertexCount);for(var r=0;r<this.m_vertexCount;r++)this.m_vertices[r].SetV(n.m_vertices[r]),this.m_normals[r].SetV(n.m_normals[r])}},e.prototype.SetAsArray=function(t,e){void 0===e&&(e=0);var i=t;"function"==typeof i.axInitializer&&(i=t.value);var n=i.slice();this.SetAsVector(n,e)},e.AsArray=function(t,i){var n=new e;return n.SetAsArray(t,i),n},e.prototype.SetAsVector=function(t,i){var n;for(void 0===i&&(i=0),0==i&&(i=t.length),RB.b2Assert(2<=i),this.m_vertexCount=i,this.Reserve(i),n=0;n<this.m_vertexCount;n++)this.m_vertices[n].SetV(t[n]);for(n=0;n<this.m_vertexCount;++n){var r=n,o=n+1<this.m_vertexCount?n+1:0,s=zB.SubtractVV(this.m_vertices[o],this.m_vertices[r]);RB.b2Assert(s.LengthSquared()>Number.MIN_VALUE),this.m_normals[n].SetV(zB.CrossVF(s,1)),this.m_normals[n].Normalize()}this.m_centroid=e.ComputeCentroid(this.m_vertices,this.m_vertexCount)},e.AsVector=function(t,i){var n=new e;return n.SetAsVector(t,i),n},e.prototype.SetAsBox=function(t,e){this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},e.AsBox=function(t,i){var n=new e;return n.SetAsBox(t,i),n},e.prototype.SetAsOrientedBox=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=i;var r=new jB;r.position=i,r.R.Set(n);for(var o=0;o<this.m_vertexCount;++o)this.m_vertices[o]=zB.MulX(r,this.m_vertices[o]),this.m_normals[o]=zB.MulMV(r.R,this.m_normals[o])},e.AsOrientedBox=function(t,i,n,r){void 0===n&&(n=null),void 0===r&&(r=0);var o=new e;return o.SetAsOrientedBox(t,i,n,r),o},e.prototype.SetAsEdge=function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=zB.CrossVF(zB.SubtractVV(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},e.AsEdge=function(t,i){var n=new e;return n.SetAsEdge(t,i),n},e.prototype.TestPoint=function(t,e){for(var i,n=t.R,r=e.x-t.position.x,o=e.y-t.position.y,s=r*n.col1.x+o*n.col1.y,a=r*n.col2.x+o*n.col2.y,l=0;l<this.m_vertexCount;++l){if(r=s-(i=this.m_vertices[l]).x,o=a-i.y,(i=this.m_normals[l]).x*r+i.y*o>0)return!1}return!0},e.prototype.RayCast=function(t,e,i){var n,r,o,s,a=0,l=e.maxFraction;n=e.p1.x-i.position.x,r=e.p1.y-i.position.y;var u=n*(o=i.R).col1.x+r*o.col1.y,c=n*o.col2.x+r*o.col2.y;n=e.p2.x-i.position.x,r=e.p2.y-i.position.y;for(var h=n*(o=i.R).col1.x+r*o.col1.y-u,p=n*o.col2.x+r*o.col2.y-c,d=-1,f=0;f<this.m_vertexCount;++f){n=(s=this.m_vertices[f]).x-u,r=s.y-c;var _=(s=this.m_normals[f]).x*n+s.y*r,m=s.x*h+s.y*p;if(0==m){if(_<0)return!1}else m<0&&_<a*m?(a=_/m,d=f):m>0&&_<l*m&&(l=_/m);if(l<a-Number.MIN_VALUE)return!1}return d>=0&&(t.fraction=a,o=i.R,s=this.m_normals[d],t.normal.x=o.col1.x*s.x+o.col2.x*s.y,t.normal.y=o.col1.y*s.x+o.col2.y*s.y,!0)},e.prototype.ComputeAABB=function(t,e){for(var i=e.R,n=this.m_vertices[0],r=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),o=e.position.y+(i.col1.y*n.x+i.col2.y*n.y),s=r,a=o,l=1;l<this.m_vertexCount;++l){n=this.m_vertices[l];var u=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),c=e.position.y+(i.col1.y*n.x+i.col2.y*n.y);r=r<u?r:u,o=o<c?o:c,s=s>u?s:u,a=a>c?a:c}t.lowerBound.x=r-this.m_radius,t.lowerBound.y=o-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius},e.prototype.ComputeMass=function(t,e){if(2==this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var i=0,n=0,r=0,o=0,s=0;s<this.m_vertexCount;++s){var a=this.m_vertices[s],l=s+1<this.m_vertexCount?this.m_vertices[s+1]:this.m_vertices[0],u=a.x-0,c=a.y-0,h=l.x-0,p=l.y-0,d=u*p-c*h,f=.5*d;r+=f,i+=f*(1/3)*(0+a.x+l.x),n+=f*(1/3)*(0+a.y+l.y);o+=d*(1/3*(.25*(u*u+h*u+h*h)+(0*u+0*h))+0+(1/3*(.25*(c*c+p*c+p*p)+(0*c+0*p))+0))}t.mass=e*r,i*=1/r,n*=1/r,t.center.Set(i,n),t.I=e*o},e.prototype.ComputeSubmergedArea=function(t,e,i,n){var r,o=zB.MulTMV(i.R,t),s=e-zB.Dot(t,i.position),a=new Array,l=0,u=-1,c=-1,h=!1;for(r=0;r<this.m_vertexCount;++r){a[r]=zB.Dot(o,this.m_vertices[r])-s;var p=a[r]<-Number.MIN_VALUE;r>0&&(p?h||(u=r-1,l++):h&&(c=r-1,l++)),h=p}switch(l){case 0:if(h){var d=new ZB;return this.ComputeMass(d,1),n.SetV(zB.MulX(i,d.center)),d.mass}return 0;case 1:-1==u?u=this.m_vertexCount-1:c=this.m_vertexCount-1}var f,_=(u+1)%this.m_vertexCount,m=(c+1)%this.m_vertexCount,g=(0-a[u])/(a[_]-a[u]),y=(0-a[c])/(a[m]-a[c]),A=new GB(this.m_vertices[u].x*(1-g)+this.m_vertices[_].x*g,this.m_vertices[u].y*(1-g)+this.m_vertices[_].y*g),v=new GB(this.m_vertices[c].x*(1-y)+this.m_vertices[m].x*y,this.m_vertices[c].y*(1-y)+this.m_vertices[m].y*y),b=0,x=new GB,C=this.m_vertices[_];for(r=_;r!=m;){f=(r=(r+1)%this.m_vertexCount)==m?v:this.m_vertices[r];var w=.5*((C.x-A.x)*(f.y-A.y)-(C.y-A.y)*(f.x-A.x));b+=w,x.x+=w*(A.x+C.x+f.x)/3,x.y+=w*(A.y+C.y+f.y)/3,C=f}return x.Multiply(1/b),n.SetV(zB.MulX(i,x)),b},e.prototype.GetVertexCount=function(){return this.m_vertexCount},e.prototype.GetVertices=function(){return this.m_vertices},e.prototype.GetNormals=function(){return this.m_normals},e.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return e},e.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return this.m_vertices[e]},e.prototype.Validate=function(){return!1},e.prototype.Reserve=function(t){for(var e=this.m_vertices.length;e<t;e++)this.m_vertices[e]=new GB,this.m_normals[e]=new GB},e.ComputeCentroid=function(t,e){for(var i=new GB,n=0,r=0;r<e;++r){var o=t[r],s=r+1<e?t[r+1]:t[0],a=o.x-0,l=o.y-0,u=s.x-0,c=.5*(a*(s.y-0)-l*u);n+=c,i.x+=c*(1/3)*(0+o.x+s.x),i.y+=c*(1/3)*(0+o.y+s.y)}return i.x*=1/n,i.y*=1/n,i},e.ComputeOBB=function(t,e,i){var n,r=new Array(i+1);for(n=0;n<i;++n)r[n]=e[n];r[i]=r[0];var o=Number.MAX_VALUE;for(n=1;n<=i;++n){for(var s=r[n-1],a=r[n].x-s.x,l=r[n].y-s.y,u=Math.sqrt(a*a+l*l),c=-(l/=u),h=a/=u,p=Number.MAX_VALUE,d=Number.MAX_VALUE,f=-Number.MAX_VALUE,_=-Number.MAX_VALUE,m=0;m<i;++m){var g=r[m].x-s.x,y=r[m].y-s.y,A=a*g+l*y,v=c*g+h*y;A<p&&(p=A),v<d&&(d=v),A>f&&(f=A),v>_&&(_=v)}var b=(f-p)*(_-d);if(b<.95*o){o=b,t.R.col1.x=a,t.R.col1.y=l,t.R.col2.x=c,t.R.col2.y=h;var x=.5*(p+f),C=.5*(d+_),w=t.R;t.center.x=s.x+(w.col1.x*x+w.col2.x*C),t.center.y=s.y+(w.col1.y*x+w.col2.y*C),t.extents.x=.5*(f-p),t.extents.y=.5*(_-d)}}},e.s_mat=new kB,e}(KB),tM=function(){function t(){this.__fast__=!0,this.lowerBound=new GB,this.upperBound=new GB}return t.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,i=t>=0&&e>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},t.prototype.GetCenter=function(){return new GB((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},t.prototype.GetExtents=function(){return new GB((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},t.prototype.Contains=function(t){var e=!0;return e=(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},t.prototype.RayCast=function(t,e){var i,n,r,o,s,a=-Number.MAX_VALUE,l=Number.MAX_VALUE,u=e.p1.x,c=e.p1.y,h=e.p2.x-e.p1.x,p=e.p2.y-e.p1.y,d=Math.abs(h),f=Math.abs(p),_=t.normal;if(d<Number.MIN_VALUE){if(u<this.lowerBound.x||this.upperBound.x<u)return!1}else if(i=1/h,s=-1,(n=(this.lowerBound.x-u)*i)>(r=(this.upperBound.x-u)*i)&&(o=n,n=r,r=o,s=1),n>a&&(_.x=s,_.y=0,a=n),a>(l=Math.min(l,r)))return!1;if(f<Number.MIN_VALUE){if(c<this.lowerBound.y||this.upperBound.y<c)return!1}else if(i=1/p,s=-1,(n=(this.lowerBound.y-c)*i)>(r=(this.upperBound.y-c)*i)&&(o=n,n=r,r=o,s=1),n>a&&(_.y=s,_.x=0,a=n),a>(l=Math.min(l,r)))return!1;return t.fraction=a,!0},t.prototype.TestOverlap=function(t){var e=t.lowerBound.x-this.upperBound.x,i=t.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-t.upperBound.x,r=this.lowerBound.y-t.upperBound.y;return!(e>0||i>0)&&!(n>0||r>0)},t.Combine=function(e,i){var n=new t;return n.Combine(e,i),n},t.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)},t}(),eM=function(){function t(){this.__fast__=!0}return Object.defineProperty(t.prototype,"referenceEdge",{get:function(){return this._referenceEdge},set:function(t){this._referenceEdge=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"incidentEdge",{get:function(){return this._incidentEdge},set:function(t){this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"incidentVertex",{get:function(){return this._incidentVertex},set:function(t){this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"flip",{get:function(){return this._flip},set:function(t){this._flip=t,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080},enumerable:!0,configurable:!0}),t}(),iM=function(){function t(){this.__fast__=!0,this.features=new eM,this.features._m_id=this}return t.prototype.Set=function(t){this.key=t._key},t.prototype.Copy=function(){var e=new t;return e.key=this.key,e},Object.defineProperty(t.prototype,"key",{get:function(){return this._key},set:function(t){this._key=t,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255},enumerable:!0,configurable:!0}),t}(),nM=function(){function t(){this.v=new GB,this.id=new iM}return t.prototype.Set=function(t){this.v.SetV(t.v),this.id.Set(t.id)},t}(),rM=function(){function t(){this.__fast__=!0,this.m_localPoint=new GB,this.m_id=new iM,this.Reset()}return t.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},t.prototype.Set=function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)},t}(),oM=function(){function t(){this.__fast__=!0,this.m_pointCount=0,this.m_points=new Array(RB.b2_maxManifoldPoints);for(var t=0;t<RB.b2_maxManifoldPoints;t++)this.m_points[t]=new rM;this.m_localPlaneNormal=new GB,this.m_localPoint=new GB}return t.prototype.Reset=function(){for(var t=0;t<RB.b2_maxManifoldPoints;t++)this.m_points[t].Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},t.prototype.Set=function(t){this.m_pointCount=t.m_pointCount;for(var e=0;e<RB.b2_maxManifoldPoints;e++)this.m_points[e].Set(t.m_points[e]);this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),this.m_localPoint.SetV(t.m_localPoint),this.m_type=t.m_type},t.prototype.Copy=function(){var e=new t;return e.Set(this),e},t.e_circles=1,t.e_faceA=2,t.e_faceB=4,t}(),sM=function(){function t(){}return t.ClipSegmentToLine=function(t,e,i,n){var r,o=0,s=(r=e[0]).v,a=(r=e[1]).v,l=i.x*s.x+i.y*s.y-n,u=i.x*a.x+i.y*a.y-n;if(l<=0&&t[o++].Set(e[0]),u<=0&&t[o++].Set(e[1]),l*u<0){var c=l/(l-u),h=(r=t[o]).v;h.x=s.x+c*(a.x-s.x),h.y=s.y+c*(a.y-s.y),r=t[o];var p=void 0;l>0?(p=e[0],r.id=p.id):(p=e[1],r.id=p.id),++o}return o},t.EdgeSeparation=function(t,e,i,n,r){t.m_vertexCount;var o,s,a=t.m_vertices,l=t.m_normals,u=n.m_vertexCount,c=n.m_vertices;o=e.R,s=l[i];for(var h=o.col1.x*s.x+o.col2.x*s.y,p=o.col1.y*s.x+o.col2.y*s.y,d=(o=r.R).col1.x*h+o.col1.y*p,f=o.col2.x*h+o.col2.y*p,_=0,m=Number.MAX_VALUE,g=0;g<u;++g){var y=(s=c[g]).x*d+s.y*f;y<m&&(m=y,_=g)}s=a[i],o=e.R;var A=e.position.x+(o.col1.x*s.x+o.col2.x*s.y),v=e.position.y+(o.col1.y*s.x+o.col2.y*s.y);s=c[_],o=r.R;var b=r.position.x+(o.col1.x*s.x+o.col2.x*s.y),x=r.position.y+(o.col1.y*s.x+o.col2.y*s.y);return(b-=A)*h+(x-=v)*p},t.FindMaxSeparation=function(t,e,i,n,r){var o,s,a=e.m_vertexCount,l=e.m_normals;s=r.R,o=n.m_centroid;var u=r.position.x+(s.col1.x*o.x+s.col2.x*o.y),c=r.position.y+(s.col1.y*o.x+s.col2.y*o.y);s=i.R,o=e.m_centroid,u-=i.position.x+(s.col1.x*o.x+s.col2.x*o.y),c-=i.position.y+(s.col1.y*o.x+s.col2.y*o.y);for(var h=u*i.R.col1.x+c*i.R.col1.y,p=u*i.R.col2.x+c*i.R.col2.y,d=0,f=-Number.MAX_VALUE,_=0;_<a;++_){var m=(o=l[_]).x*h+o.y*p;m>f&&(f=m,d=_)}var g,y,A,v=this.EdgeSeparation(e,i,d,n,r),b=d-1>=0?d-1:a-1,x=this.EdgeSeparation(e,i,b,n,r),C=d+1<a?d+1:0,w=this.EdgeSeparation(e,i,C,n,r);if(x>v&&x>w)A=-1,g=b,y=x;else{if(!(w>v))return t[0]=d,v;A=1,g=C,y=w}for(;d=-1==A?g-1>=0?g-1:a-1:g+1<a?g+1:0,(v=this.EdgeSeparation(e,i,d,n,r))>y;)g=d,y=v;return t[0]=g,y},t.FindIncidentEdge=function(t,e,i,n,r,o){e.m_vertexCount;var s,a,l=e.m_normals,u=r.m_vertexCount,c=r.m_vertices,h=r.m_normals;s=i.R,a=l[n];var p=s.col1.x*a.x+s.col2.x*a.y,d=s.col1.y*a.x+s.col2.y*a.y,f=(s=o.R).col1.x*p+s.col1.y*d;d=s.col2.x*p+s.col2.y*d,p=f;for(var _,m=0,g=Number.MAX_VALUE,y=0;y<u;++y){var A=p*(a=h[y]).x+d*a.y;A<g&&(g=A,m=y)}var v=m,b=v+1<u?v+1:0;_=t[0],a=c[v],s=o.R,_.v.x=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),_.v.y=o.position.y+(s.col1.y*a.x+s.col2.y*a.y),_.id.features.referenceEdge=n,_.id.features.incidentEdge=v,_.id.features.incidentVertex=0,_=t[1],a=c[b],s=o.R,_.v.x=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),_.v.y=o.position.y+(s.col1.y*a.x+s.col2.y*a.y),_.id.features.referenceEdge=n,_.id.features.incidentEdge=b,_.id.features.incidentVertex=1},t.MakeClipPointVector=function(){var t=new Array(2);return t[0]=new nM,t[1]=new nM,t},t.CollidePolygons=function(e,i,n,r,o){var s;e.m_pointCount=0;var a=i.m_radius+r.m_radius,l=0;t.s_edgeAO[0]=l;var u=this.FindMaxSeparation(t.s_edgeAO,i,n,r,o);if(l=t.s_edgeAO[0],!(u>a)){var c=0;t.s_edgeBO[0]=c;var h=this.FindMaxSeparation(t.s_edgeBO,r,o,i,n);if(c=t.s_edgeBO[0],!(h>a)){var p,d,f,_,m,g,y;h>.98*u+.001?(p=r,d=i,f=o,_=n,m=c,e.m_type=oM.e_faceB,g=1):(p=i,d=r,f=n,_=o,m=l,e.m_type=oM.e_faceA,g=0);var A=t.s_incidentEdge;this.FindIncidentEdge(A,p,f,m,d,_);var v,b=p.m_vertexCount,x=p.m_vertices,C=x[m];v=m+1<b?x[m+1]:x[0];var w=t.s_localTangent;w.Set(v.x-C.x,v.y-C.y),w.Normalize();var I=t.s_localNormal;I.x=w.y,I.y=-w.x;var E=t.s_planePoint;E.Set(.5*(C.x+v.x),.5*(C.y+v.y));var S=t.s_tangent;y=f.R,S.x=y.col1.x*w.x+y.col2.x*w.y,S.y=y.col1.y*w.x+y.col2.y*w.y;var D=t.s_tangent2;D.x=-S.x,D.y=-S.y;var T=t.s_normal;T.x=S.y,T.y=-S.x;var P=t.s_v11,B=t.s_v12;P.x=f.position.x+(y.col1.x*C.x+y.col2.x*C.y),P.y=f.position.y+(y.col1.y*C.x+y.col2.y*C.y),B.x=f.position.x+(y.col1.x*v.x+y.col2.x*v.y),B.y=f.position.y+(y.col1.y*v.x+y.col2.y*v.y);var M=T.x*P.x+T.y*P.y,O=-S.x*P.x-S.y*P.y+a,L=S.x*B.x+S.y*B.y+a,R=t.s_clipPoints1,N=t.s_clipPoints2;if(!(this.ClipSegmentToLine(R,A,D,O)<2||this.ClipSegmentToLine(N,R,S,L)<2)){e.m_localPlaneNormal.SetV(I),e.m_localPoint.SetV(E);for(var F=0,k=0;k<RB.b2_maxManifoldPoints;++k){if(s=N[k],T.x*s.v.x+T.y*s.v.y-M<=a){var V=e.m_points[F];y=_.R;var U=s.v.x-_.position.x,j=s.v.y-_.position.y;V.m_localPoint.x=U*y.col1.x+j*y.col1.y,V.m_localPoint.y=U*y.col2.x+j*y.col2.y,V.m_id.Set(s.id),V.m_id.features.flip=g,++F}}e.m_pointCount=F}}}},t.CollideCircles=function(t,e,i,n,r){var o,s;t.m_pointCount=0,o=i.R,s=e.m_p;var a=i.position.x+(o.col1.x*s.x+o.col2.x*s.y),l=i.position.y+(o.col1.y*s.x+o.col2.y*s.y);o=r.R,s=n.m_p;var u=r.position.x+(o.col1.x*s.x+o.col2.x*s.y)-a,c=r.position.y+(o.col1.y*s.x+o.col2.y*s.y)-l,h=u*u+c*c,p=e.m_radius+n.m_radius;h>p*p||(t.m_type=oM.e_circles,t.m_localPoint.SetV(e.m_p),t.m_localPlaneNormal.SetZero(),t.m_pointCount=1,t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0)},t.CollidePolygonAndCircle=function(t,e,i,n,r){var o,s,a,l;t.m_pointCount=0,l=r.R,a=n.m_p;var u=r.position.x+(l.col1.x*a.x+l.col2.x*a.y),c=r.position.y+(l.col1.y*a.x+l.col2.y*a.y);o=u-i.position.x,s=c-i.position.y;for(var h=o*(l=i.R).col1.x+s*l.col1.y,p=o*l.col2.x+s*l.col2.y,d=0,f=-Number.MAX_VALUE,_=e.m_radius+n.m_radius,m=e.m_vertexCount,g=e.m_vertices,y=e.m_normals,A=0;A<m;++A){o=h-(a=g[A]).x,s=p-a.y;var v=(a=y[A]).x*o+a.y*s;if(v>_)return;v>f&&(f=v,d=A)}var b=d,x=b+1<m?b+1:0,C=g[b],w=g[x];if(f<Number.MIN_VALUE)return t.m_pointCount=1,t.m_type=oM.e_faceA,t.m_localPlaneNormal.SetV(y[d]),t.m_localPoint.x=.5*(C.x+w.x),t.m_localPoint.y=.5*(C.y+w.y),t.m_points[0].m_localPoint.SetV(n.m_p),void(t.m_points[0].m_id.key=0);var I=(h-C.x)*(w.x-C.x)+(p-C.y)*(w.y-C.y),E=(h-w.x)*(C.x-w.x)+(p-w.y)*(C.y-w.y);if(I<=0){if((h-C.x)*(h-C.x)+(p-C.y)*(p-C.y)>_*_)return;t.m_pointCount=1,t.m_type=oM.e_faceA,t.m_localPlaneNormal.x=h-C.x,t.m_localPlaneNormal.y=p-C.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(C),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else if(E<=0){if((h-w.x)*(h-w.x)+(p-w.y)*(p-w.y)>_*_)return;t.m_pointCount=1,t.m_type=oM.e_faceA,t.m_localPlaneNormal.x=h-w.x,t.m_localPlaneNormal.y=p-w.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(w),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else{var S=.5*(C.x+w.x),D=.5*(C.y+w.y);if((f=(h-S)*y[b].x+(p-D)*y[b].y)>_)return;t.m_pointCount=1,t.m_type=oM.e_faceA,t.m_localPlaneNormal.x=y[b].x,t.m_localPlaneNormal.y=y[b].y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.Set(S,D),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}},t.TestOverlap=function(t,e){var i=e.lowerBound,n=t.upperBound,r=i.x-n.x,o=i.y-n.y;i=t.lowerBound,n=e.upperBound;var s=i.x-n.x,a=i.y-n.y;return!(r>0||o>0)&&!(s>0||a>0)},t.b2_nullFeature=255,t.s_incidentEdge=t.MakeClipPointVector(),t.s_clipPoints1=t.MakeClipPointVector(),t.s_clipPoints2=t.MakeClipPointVector(),t.s_edgeAO=new Array(1),t.s_edgeBO=new Array(1),t.s_localTangent=new GB,t.s_localNormal=new GB,t.s_planePoint=new GB,t.s_normal=new GB,t.s_tangent=new GB,t.s_tangent2=new GB,t.s_v11=new GB,t.s_v12=new GB,t.b2CollidePolyTempVec=new GB,t}(),aM=function(){this.__fast__=!0,this.position=new GB,this.velocity=new GB,this.normal=new GB,this.id=new iM},lM=function(){function t(){this.aabb=new tM}return t.prototype.IsLeaf=function(){return null==this.child1},t}(),uM=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=1),this.__fast__=!0,this.p1=new GB,this.p2=new GB,t&&this.p1.SetV(t),e&&this.p2.SetV(e),this.maxFraction=i},cM=function(){function t(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0}return t.prototype.CreateProxy=function(t,e){var i=this.AllocateNode(),n=RB.b2_aabbExtension,r=RB.b2_aabbExtension;return i.aabb.lowerBound.x=t.lowerBound.x-n,i.aabb.lowerBound.y=t.lowerBound.y-r,i.aabb.upperBound.x=t.upperBound.x+n,i.aabb.upperBound.y=t.upperBound.y+r,i.userData=e,this.InsertLeaf(i),i},t.prototype.DestroyProxy=function(t){this.RemoveLeaf(t),this.FreeNode(t)},t.prototype.MoveProxy=function(t,e,i){if(RB.b2Assert(t.IsLeaf()),t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var n=RB.b2_aabbExtension+RB.b2_aabbMultiplier*(i.x>0?i.x:-i.x),r=RB.b2_aabbExtension+RB.b2_aabbMultiplier*(i.y>0?i.y:-i.y);return t.aabb.lowerBound.x=e.lowerBound.x-n,t.aabb.lowerBound.y=e.lowerBound.y-r,t.aabb.upperBound.x=e.upperBound.x+n,t.aabb.upperBound.y=e.upperBound.y+r,this.InsertLeaf(t),!0},t.prototype.Rebalance=function(t){if(null!=this.m_root)for(var e=0;e<t;e++){for(var i=this.m_root,n=0;0==i.IsLeaf();)i=this.m_path>>n&1?i.child2:i.child1,n=n+1&31;++this.m_path,this.RemoveLeaf(i),this.InsertLeaf(i)}},t.prototype.GetFatAABB=function(t){return t.aabb},t.prototype.GetUserData=function(t){return t.userData},t.prototype.Query=function(t,e){if(null!=this.m_root){var i=new Array,n=0;for(i[n++]=this.m_root;n>0;){var r=i[--n];if(r.aabb.TestOverlap(e))if(r.IsLeaf()){if(!t(r))return}else i[n++]=r.child1,i[n++]=r.child2}}},t.prototype.RayCast=function(t,e){if(null!=this.m_root){var i=e.p1,n=e.p2,r=zB.SubtractVV(i,n);r.Normalize();var o,s,a=zB.CrossFV(1,r),l=zB.AbsV(a),u=e.maxFraction,c=new tM;o=i.x+u*(n.x-i.x),s=i.y+u*(n.y-i.y),c.lowerBound.x=Math.min(i.x,o),c.lowerBound.y=Math.min(i.y,s),c.upperBound.x=Math.max(i.x,o),c.upperBound.y=Math.max(i.y,s);var h=new Array,p=0;for(h[p++]=this.m_root;p>0;){var d=h[--p];if(0!=d.aabb.TestOverlap(c)){var f=d.aabb.GetCenter(),_=d.aabb.GetExtents();if(!(Math.abs(a.x*(i.x-f.x)+a.y*(i.y-f.y))-l.x*_.x-l.y*_.y>0))if(d.IsLeaf()){var m=new uM;if(m.p1=e.p1,m.p2=e.p2,m.maxFraction=e.maxFraction,0==(u=t(m,d)))return;o=i.x+u*(n.x-i.x),s=i.y+u*(n.y-i.y),c.lowerBound.x=Math.min(i.x,o),c.lowerBound.y=Math.min(i.y,s),c.upperBound.x=Math.max(i.x,o),c.upperBound.y=Math.max(i.y,s)}else h[p++]=d.child1,h[p++]=d.child2}}}},t.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t}return new lM},t.prototype.FreeNode=function(t){t.parent=this.m_freeList,this.m_freeList=t},t.prototype.InsertLeaf=function(t){if(++this.m_insertionCount,null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);var e=t.aabb.GetCenter(),i=this.m_root;if(0==i.IsLeaf())do{var n=i.child1,r=i.child2;i=Math.abs((n.aabb.lowerBound.x+n.aabb.upperBound.x)/2-e.x)+Math.abs((n.aabb.lowerBound.y+n.aabb.upperBound.y)/2-e.y)<Math.abs((r.aabb.lowerBound.x+r.aabb.upperBound.x)/2-e.x)+Math.abs((r.aabb.lowerBound.y+r.aabb.upperBound.y)/2-e.y)?n:r}while(0==i.IsLeaf());var o=i.parent,s=this.AllocateNode();if(s.parent=o,s.userData=null,s.aabb.Combine(t.aabb,i.aabb),o){i.parent.child1==i?o.child1=s:o.child2=s,s.child1=i,s.child2=t,i.parent=s,t.parent=s;do{if(o.aabb.Contains(s.aabb))break;o.aabb.Combine(o.child1.aabb,o.child2.aabb),s=o,o=o.parent}while(o)}else s.child1=i,s.child2=t,i.parent=s,t.parent=s,this.m_root=s},t.prototype.RemoveLeaf=function(t){if(t!=this.m_root){var e,i=t.parent,n=i.parent;if(e=i.child1==t?i.child2:i.child1,n)for(n.child1==i?n.child1=e:n.child2=e,e.parent=n,this.FreeNode(i);n;){var r=n.aabb;if(n.aabb=tM.Combine(n.child1.aabb,n.child2.aabb),r.Contains(n.aabb))break;n=n.parent}else this.m_root=e,e.parent=null,this.FreeNode(i)}else this.m_root=null},t}(),hM=function(){},pM=function(){function t(){this.m_tree=new cM,this.m_moveBuffer=new Array,this.m_pairBuffer=new Array,this.m_pairCount=0}return t.prototype.CreateProxy=function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},t.prototype.DestroyProxy=function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},t.prototype.MoveProxy=function(t,e,i){this.m_tree.MoveProxy(t,e,i)&&this.BufferMove(t)},t.prototype.TestOverlap=function(t,e){var i=this.m_tree.GetFatAABB(t),n=this.m_tree.GetFatAABB(e);return i.TestOverlap(n)},t.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)},t.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)},t.prototype.GetProxyCount=function(){return this.m_proxyCount},t.prototype.UpdatePairs=function(t){var e=this;this.m_pairCount=0;for(var i=0,n=this.m_moveBuffer;i<n.length;i++){var r=n[i],o=this.m_tree.GetFatAABB(r);this.m_tree.Query((function(t){if(t==r)return!0;e.m_pairCount==e.m_pairBuffer.length&&(e.m_pairBuffer[e.m_pairCount]=new hM);var i=e.m_pairBuffer[e.m_pairCount];return i.proxyA=t<r?t:r,i.proxyB=t>=r?t:r,++e.m_pairCount,!0}),o)}this.m_moveBuffer.length=0;for(var s=0;s<this.m_pairCount;){var a=this.m_pairBuffer[s];for(t(this.m_tree.GetUserData(a.proxyA),this.m_tree.GetUserData(a.proxyB)),++s;s<this.m_pairCount;){var l=this.m_pairBuffer[s];if(l.proxyA!=a.proxyA||l.proxyB!=a.proxyB)break;++s}}},t.prototype.Query=function(t,e){this.m_tree.Query(t,e)},t.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)},t.prototype.Validate=function(){},t.prototype.Rebalance=function(t){this.m_tree.Rebalance(t)},t.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveBuffer.length]=t},t.prototype.UnBufferMove=function(t){var e=this.m_moveBuffer.indexOf(t);this.m_moveBuffer.splice(e,1)},t.prototype.ComparePairs=function(t,e){return 0},t}(),dM=function(){this.__fast__=!0,this.R=new kB,this.center=new GB,this.extents=new GB},fM=function(){this.__fast__=!0,this.normal=new GB},_M=function(){function t(){this.m_localPoint=new GB,this.m_axis=new GB}return t.prototype.Initialize=function(e,i,n,r,o){this.m_proxyA=i,this.m_proxyB=r;var s,a,l,u,c,h,p,d,f,_,m,g,y,A,v,b=e.count;if(RB.b2Assert(0<b&&b<3),1==b)this.m_type=t.e_points,s=this.m_proxyA.GetVertex(e.indexA[0]),u=this.m_proxyB.GetVertex(e.indexB[0]),A=s,y=n.R,p=n.position.x+(y.col1.x*A.x+y.col2.x*A.y),d=n.position.y+(y.col1.y*A.x+y.col2.y*A.y),A=u,y=o.R,f=o.position.x+(y.col1.x*A.x+y.col2.x*A.y),_=o.position.y+(y.col1.y*A.x+y.col2.y*A.y),this.m_axis.x=f-p,this.m_axis.y=_-d,this.m_axis.Normalize();else if(e.indexB[0]==e.indexB[1])this.m_type=t.e_faceA,a=this.m_proxyA.GetVertex(e.indexA[0]),l=this.m_proxyA.GetVertex(e.indexA[1]),u=this.m_proxyB.GetVertex(e.indexB[0]),this.m_localPoint.x=.5*(a.x+l.x),this.m_localPoint.y=.5*(a.y+l.y),this.m_axis=zB.CrossVF(zB.SubtractVV(l,a),1),this.m_axis.Normalize(),A=this.m_axis,m=(y=n.R).col1.x*A.x+y.col2.x*A.y,g=y.col1.y*A.x+y.col2.y*A.y,A=this.m_localPoint,y=n.R,p=n.position.x+(y.col1.x*A.x+y.col2.x*A.y),d=n.position.y+(y.col1.y*A.x+y.col2.y*A.y),A=u,y=o.R,(v=((f=o.position.x+(y.col1.x*A.x+y.col2.x*A.y))-p)*m+((_=o.position.y+(y.col1.y*A.x+y.col2.y*A.y))-d)*g)<0&&this.m_axis.NegativeSelf();else if(e.indexA[0]==e.indexA[0])this.m_type=t.e_faceB,c=this.m_proxyB.GetVertex(e.indexB[0]),h=this.m_proxyB.GetVertex(e.indexB[1]),s=this.m_proxyA.GetVertex(e.indexA[0]),this.m_localPoint.x=.5*(c.x+h.x),this.m_localPoint.y=.5*(c.y+h.y),this.m_axis=zB.CrossVF(zB.SubtractVV(h,c),1),this.m_axis.Normalize(),A=this.m_axis,m=(y=o.R).col1.x*A.x+y.col2.x*A.y,g=y.col1.y*A.x+y.col2.y*A.y,A=this.m_localPoint,y=o.R,f=o.position.x+(y.col1.x*A.x+y.col2.x*A.y),_=o.position.y+(y.col1.y*A.x+y.col2.y*A.y),A=s,y=n.R,(v=((p=n.position.x+(y.col1.x*A.x+y.col2.x*A.y))-f)*m+((d=n.position.y+(y.col1.y*A.x+y.col2.y*A.y))-_)*g)<0&&this.m_axis.NegativeSelf();else{a=this.m_proxyA.GetVertex(e.indexA[0]),l=this.m_proxyA.GetVertex(e.indexA[1]),c=this.m_proxyB.GetVertex(e.indexB[0]),h=this.m_proxyB.GetVertex(e.indexB[1]);zB.MulX(n,s);var x=zB.MulMV(n.R,zB.SubtractVV(l,a)),C=(zB.MulX(o,u),zB.MulMV(o.R,zB.SubtractVV(h,c))),w=x.x*x.x+x.y*x.y,I=C.x*C.x+C.y*C.y,E=zB.SubtractVV(C,x),S=x.x*E.x+x.y*E.y,D=C.x*E.x+C.y*E.y,T=x.x*C.x+x.y*C.y,P=w*I-T*T;v=0,0!=P&&(v=zB.Clamp((T*D-S*I)/P,0,1));var B=(T*v+D)/I;B<0&&(B=0,v=zB.Clamp((T-S)/w,0,1)),(s=new GB).x=a.x+v*(l.x-a.x),s.y=a.y+v*(l.y-a.y),(u=new GB).x=c.x+v*(h.x-c.x),u.y=c.y+v*(h.y-c.y),0==v||1==v?(this.m_type=t.e_faceB,this.m_axis=zB.CrossVF(zB.SubtractVV(h,c),1),this.m_axis.Normalize(),this.m_localPoint=u,A=this.m_axis,m=(y=o.R).col1.x*A.x+y.col2.x*A.y,g=y.col1.y*A.x+y.col2.y*A.y,A=this.m_localPoint,y=o.R,f=o.position.x+(y.col1.x*A.x+y.col2.x*A.y),_=o.position.y+(y.col1.y*A.x+y.col2.y*A.y),A=s,y=n.R,p=n.position.x+(y.col1.x*A.x+y.col2.x*A.y),d=n.position.y+(y.col1.y*A.x+y.col2.y*A.y),v<0&&this.m_axis.NegativeSelf()):(this.m_type=t.e_faceA,this.m_axis=zB.CrossVF(zB.SubtractVV(l,a),1),this.m_localPoint=s,A=this.m_axis,m=(y=n.R).col1.x*A.x+y.col2.x*A.y,g=y.col1.y*A.x+y.col2.y*A.y,A=this.m_localPoint,y=n.R,p=n.position.x+(y.col1.x*A.x+y.col2.x*A.y),d=n.position.y+(y.col1.y*A.x+y.col2.y*A.y),A=u,y=o.R,f=o.position.x+(y.col1.x*A.x+y.col2.x*A.y),_=o.position.y+(y.col1.y*A.x+y.col2.y*A.y),v<0&&this.m_axis.NegativeSelf())}},t.prototype.Evaluate=function(e,i){var n,r,o,s,a,l,u;switch(this.m_type){case t.e_points:return n=zB.MulTMV(e.R,this.m_axis),r=zB.MulTMV(i.R,this.m_axis.GetNegative()),o=this.m_proxyA.GetSupportVertex(n),s=this.m_proxyB.GetSupportVertex(r),a=zB.MulX(e,o),((l=zB.MulX(i,s)).x-a.x)*this.m_axis.x+(l.y-a.y)*this.m_axis.y;case t.e_faceA:return u=zB.MulMV(e.R,this.m_axis),a=zB.MulX(e,this.m_localPoint),r=zB.MulTMV(i.R,u.GetNegative()),s=this.m_proxyB.GetSupportVertex(r),((l=zB.MulX(i,s)).x-a.x)*u.x+(l.y-a.y)*u.y;case t.e_faceB:return u=zB.MulMV(i.R,this.m_axis),l=zB.MulX(i,this.m_localPoint),n=zB.MulTMV(e.R,u.GetNegative()),o=this.m_proxyA.GetSupportVertex(n),((a=zB.MulX(e,o)).x-l.x)*u.x+(a.y-l.y)*u.y;default:return RB.b2Assert(!1),0}},t.e_points=1,t.e_faceA=2,t.e_faceB=4,t}(),mM=function(){function t(){}return t.TimeOfImpact=function(t){++this.b2_toiCalls;var e=t.proxyA,i=t.proxyB,n=t.sweepA,r=t.sweepB;RB.b2Assert(n.t0==r.t0),RB.b2Assert(1-n.t0>Number.MIN_VALUE);var o=e.m_radius+i.m_radius,s=t.tolerance,a=0,l=0,u=0;for(this.s_cache.count=0,this.s_distanceInput.useRadii=!1;;){if(n.GetTransform(this.s_xfA,a),r.GetTransform(this.s_xfB,a),this.s_distanceInput.proxyA=e,this.s_distanceInput.proxyB=i,this.s_distanceInput.transformA=this.s_xfA,this.s_distanceInput.transformB=this.s_xfB,YB.Distance(this.s_distanceOutput,this.s_cache,this.s_distanceInput),this.s_distanceOutput.distance<=0){a=1;break}this.s_fcn.Initialize(this.s_cache,e,this.s_xfA,i,this.s_xfB);var c=this.s_fcn.Evaluate(this.s_xfA,this.s_xfB);if(c<=0){a=1;break}if(0==l&&(u=c>o?zB.Max(o-s,.75*o):zB.Max(c-s,.02*o)),c-u<.5*s){if(0==l){a=1;break}break}var h=a,p=a,d=1,f=c;n.GetTransform(this.s_xfA,d),r.GetTransform(this.s_xfB,d);var _=this.s_fcn.Evaluate(this.s_xfA,this.s_xfB);if(_>=u){a=1;break}for(var m=0;;){var g;g=1&m?p+(u-f)*(d-p)/(_-f):.5*(p+d),n.GetTransform(this.s_xfA,g),r.GetTransform(this.s_xfB,g);var y=this.s_fcn.Evaluate(this.s_xfA,this.s_xfB);if(zB.Abs(y-u)<.025*s){h=g;break}if(y>u?(p=g,f=y):(d=g,_=y),++m,++this.b2_toiRootIters,50==m)break}if(this.b2_toiMaxRootIters=zB.Max(this.b2_toiMaxRootIters,m),h<(1+100*Number.MIN_VALUE)*a)break;if(a=h,l++,++this.b2_toiIters,1e3==l)break}return this.b2_toiMaxIters=zB.Max(this.b2_toiMaxIters,l),a},t.b2_toiCalls=0,t.b2_toiIters=0,t.b2_toiMaxIters=0,t.b2_toiRootIters=0,t.b2_toiMaxRootIters=0,t.s_cache=new FB,t.s_distanceInput=new LB,t.s_xfA=new jB,t.s_xfB=new jB,t.s_fcn=new _M,t.s_distanceOutput=new HB,t}(),gM=function(){this.proxyA=new NB,this.proxyB=new NB,this.sweepA=new UB,this.sweepB=new UB},yM=function(){function t(){this.m_normal=new GB,this.m_points=new Array(RB.b2_maxManifoldPoints);for(var t=0;t<RB.b2_maxManifoldPoints;t++)this.m_points[t]=new GB}return t.prototype.Initialize=function(t,e,i,n,r){var o,s,a,l,u,c,h,p,d;if(0!=t.m_pointCount)switch(t.m_type){case oM.e_circles:a=e.R,s=t.m_localPoint;var f=e.position.x+a.col1.x*s.x+a.col2.x*s.y,_=e.position.y+a.col1.y*s.x+a.col2.y*s.y;a=n.R,s=t.m_points[0].m_localPoint;var m=n.position.x+a.col1.x*s.x+a.col2.x*s.y,g=n.position.y+a.col1.y*s.x+a.col2.y*s.y,y=m-f,A=g-_,v=y*y+A*A;if(v>Number.MIN_VALUE*Number.MIN_VALUE){var b=Math.sqrt(v);this.m_normal.x=y/b,this.m_normal.y=A/b}else this.m_normal.x=1,this.m_normal.y=0;var x=f+i*this.m_normal.x,C=_+i*this.m_normal.y,w=m-r*this.m_normal.x,I=g-r*this.m_normal.y;this.m_points[0].x=.5*(x+w),this.m_points[0].y=.5*(C+I);break;case oM.e_faceA:for(a=e.R,s=t.m_localPlaneNormal,l=a.col1.x*s.x+a.col2.x*s.y,u=a.col1.y*s.x+a.col2.y*s.y,a=e.R,s=t.m_localPoint,c=e.position.x+a.col1.x*s.x+a.col2.x*s.y,h=e.position.y+a.col1.y*s.x+a.col2.y*s.y,this.m_normal.x=l,this.m_normal.y=u,o=0;o<t.m_pointCount;o++)a=n.R,s=t.m_points[o].m_localPoint,p=n.position.x+a.col1.x*s.x+a.col2.x*s.y,d=n.position.y+a.col1.y*s.x+a.col2.y*s.y,this.m_points[o].x=p+.5*(i-(p-c)*l-(d-h)*u-r)*l,this.m_points[o].y=d+.5*(i-(p-c)*l-(d-h)*u-r)*u;break;case oM.e_faceB:for(a=n.R,s=t.m_localPlaneNormal,l=a.col1.x*s.x+a.col2.x*s.y,u=a.col1.y*s.x+a.col2.y*s.y,a=n.R,s=t.m_localPoint,c=n.position.x+a.col1.x*s.x+a.col2.x*s.y,h=n.position.y+a.col1.y*s.x+a.col2.y*s.y,this.m_normal.x=-l,this.m_normal.y=-u,o=0;o<t.m_pointCount;o++)a=e.R,s=t.m_points[o].m_localPoint,p=e.position.x+a.col1.x*s.x+a.col2.x*s.y,d=e.position.y+a.col1.y*s.x+a.col2.y*s.y,this.m_points[o].x=p+.5*(r-(p-c)*l-(d-h)*u-i)*l,this.m_points[o].y=d+.5*(r-(p-c)*l-(d-h)*u-i)*u}},t}(),AM=function(){function t(t,e,i){this._r=0,this._g=0,this._b=0,this._r=255*zB.Clamp(t,0,1)>>>0,this._g=255*zB.Clamp(e,0,1)>>>0,this._b=255*zB.Clamp(i,0,1)>>>0}return t.prototype.Set=function(t,e,i){this._r=255*zB.Clamp(t,0,1)>>>0,this._g=255*zB.Clamp(e,0,1)>>>0,this._b=255*zB.Clamp(i,0,1)>>>0},Object.defineProperty(t.prototype,"r",{set:function(t){this._r=255*zB.Clamp(t,0,1)>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"g",{set:function(t){this._g=255*zB.Clamp(t,0,1)>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{set:function(t){this._b=255*zB.Clamp(t,0,1)>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._r<<16|this._g<<8|this._b},enumerable:!0,configurable:!0}),t}(),vM=function(){function t(){this.m_normal=new GB,this.m_separations=new Array(RB.b2_maxManifoldPoints),this.m_points=new Array(RB.b2_maxManifoldPoints);for(var t=0;t<RB.b2_maxManifoldPoints;t++)this.m_points[t]=new GB}return t.prototype.Initialize=function(t){var e,i,n,r,o,s,a;switch(RB.b2Assert(t.pointCount>0),t.type){case oM.e_circles:r=t.bodyA.m_xf.R,o=t.localPoint;var l=t.bodyA.m_xf.position.x+(r.col1.x*o.x+r.col2.x*o.y),u=t.bodyA.m_xf.position.y+(r.col1.y*o.x+r.col2.y*o.y);r=t.bodyB.m_xf.R,o=t.points[0].localPoint;var c=t.bodyB.m_xf.position.x+(r.col1.x*o.x+r.col2.x*o.y),h=t.bodyB.m_xf.position.y+(r.col1.y*o.x+r.col2.y*o.y),p=c-l,d=h-u,f=p*p+d*d;if(f>Number.MIN_VALUE*Number.MIN_VALUE){var _=Math.sqrt(f);this.m_normal.x=p/_,this.m_normal.y=d/_}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(l+c),this.m_points[0].y=.5*(u+h),this.m_separations[0]=p*this.m_normal.x+d*this.m_normal.y-t.radius;break;case oM.e_faceA:for(r=t.bodyA.m_xf.R,o=t.localPlaneNormal,this.m_normal.x=r.col1.x*o.x+r.col2.x*o.y,this.m_normal.y=r.col1.y*o.x+r.col2.y*o.y,r=t.bodyA.m_xf.R,o=t.localPoint,s=t.bodyA.m_xf.position.x+(r.col1.x*o.x+r.col2.x*o.y),a=t.bodyA.m_xf.position.y+(r.col1.y*o.x+r.col2.y*o.y),r=t.bodyB.m_xf.R,e=0;e<t.pointCount;++e)o=t.points[e].localPoint,i=t.bodyB.m_xf.position.x+(r.col1.x*o.x+r.col2.x*o.y),n=t.bodyB.m_xf.position.y+(r.col1.y*o.x+r.col2.y*o.y),this.m_separations[e]=(i-s)*this.m_normal.x+(n-a)*this.m_normal.y-t.radius,this.m_points[e].x=i,this.m_points[e].y=n;break;case oM.e_faceB:for(r=t.bodyB.m_xf.R,o=t.localPlaneNormal,this.m_normal.x=r.col1.x*o.x+r.col2.x*o.y,this.m_normal.y=r.col1.y*o.x+r.col2.y*o.y,r=t.bodyB.m_xf.R,o=t.localPoint,s=t.bodyB.m_xf.position.x+(r.col1.x*o.x+r.col2.x*o.y),a=t.bodyB.m_xf.position.y+(r.col1.y*o.x+r.col2.y*o.y),r=t.bodyA.m_xf.R,e=0;e<t.pointCount;++e)o=t.points[e].localPoint,i=t.bodyA.m_xf.position.x+(r.col1.x*o.x+r.col2.x*o.y),n=t.bodyA.m_xf.position.y+(r.col1.y*o.x+r.col2.y*o.y),this.m_separations[e]=(i-s)*this.m_normal.x+(n-a)*this.m_normal.y-t.radius,this.m_points[e].Set(i,n);this.m_normal.x*=-1,this.m_normal.y*=-1}},t.circlePointA=new GB,t.circlePointB=new GB,t}(),bM=function(){this.__fast__=!0,this.position=new GB,this.linearVelocity=new GB,this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=rO.b2_staticBody,this.active=!0,this.inertiaScale=1},xM=function(){function t(){this.__fast__=!0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return t.prototype.Copy=function(){var e=new t;return e.categoryBits=this.categoryBits,e.maskBits=this.maskBits,e.groupIndex=this.groupIndex,e},t}(),CM=function(){function t(){this.__fast__=!0,this.m_filter=new xM,this.m_aabb=new tM,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0}return t.prototype.GetType=function(){return this.m_shape.GetType()},t.prototype.GetShape=function(){return this.m_shape},t.prototype.SetSensor=function(t){if(this.m_isSensor!=t&&(this.m_isSensor=t,null!=this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),r=i.GetFixtureB();n!=this&&r!=this||i.SetSensor(n.IsSensor()||r.IsSensor()),e=e.next}},t.prototype.IsSensor=function(){return this.m_isSensor},t.prototype.SetFilterData=function(t){if(this.m_filter=t.Copy(),!this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),r=i.GetFixtureB();n!=this&&r!=this||i.FlagForFiltering(),e=e.next}},t.prototype.GetFilterData=function(){return this.m_filter.Copy()},t.prototype.GetBody=function(){return this.m_body},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)},t.prototype.RayCast=function(t,e){return this.m_shape.RayCast(t,e,this.m_body.GetTransform())},t.prototype.GetMassData=function(t){return void 0===t&&(t=null),null==t&&(t=new ZB),this.m_shape.ComputeMass(t,this.m_density),t},t.prototype.SetDensity=function(t){this.m_density=t},t.prototype.GetDensity=function(){return this.m_density},t.prototype.GetFriction=function(){return this.m_friction},t.prototype.SetFriction=function(t){this.m_friction=t},t.prototype.GetRestitution=function(){return this.m_restitution},t.prototype.SetRestitution=function(t){this.m_restitution=t},t.prototype.GetAABB=function(){return this.m_aabb},t.prototype.Create=function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=null,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density},t.prototype.Destroy=function(){this.m_shape=null},t.prototype.CreateProxy=function(t,e){this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)},t.prototype.DestroyProxy=function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=null)},t.prototype.Synchronize=function(t,e,i){if(this.m_proxy){var n=new tM,r=new tM;this.m_shape.ComputeAABB(n,e),this.m_shape.ComputeAABB(r,i),this.m_aabb.Combine(n,r);var o=zB.SubtractVV(i.position,e.position);t.MoveProxy(this.m_proxy,this.m_aabb,o)}},t}(),wM=function(){this.__fast__=!0,this.filter=new xM,this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},IM=function(){this.__fast__=!0,this.normalImpulses=new Array(RB.b2_maxManifoldPoints),this.tangentImpulses=new Array(RB.b2_maxManifoldPoints)},EM=function(){function t(){this.__fast__=!0,this.m_bodies=Array(),this.m_contacts=Array(),this.m_joints=Array()}return t.prototype.Initialize=function(t,e,i,n,r,o){var s;for(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=r,this.m_contactSolver=o,s=this.m_bodies.length;s<t;s++)this.m_bodies[s]=null;for(s=this.m_contacts.length;s<e;s++)this.m_contacts[s]=null;for(s=this.m_joints.length;s<i;s++)this.m_joints[s]=null},t.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},t.prototype.Solve=function(t,e,i){var n,r,o;for(n=0;n<this.m_bodyCount;++n)(o=this.m_bodies[n]).GetType()==rO.b2_dynamicBody&&(o.m_linearVelocity.x+=t.dt*(e.x+o.m_invMass*o.m_force.x),o.m_linearVelocity.y+=t.dt*(e.y+o.m_invMass*o.m_force.y),o.m_angularVelocity+=t.dt*o.m_invI*o.m_torque,o.m_linearVelocity.Multiply(zB.Clamp(1-t.dt*o.m_linearDamping,0,1)),o.m_angularVelocity*=zB.Clamp(1-t.dt*o.m_angularDamping,0,1));this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var s=this.m_contactSolver;for(s.InitVelocityConstraints(t),n=0;n<this.m_jointCount;++n)this.m_joints[n].InitVelocityConstraints(t);for(n=0;n<t.velocityIterations;++n){for(r=0;r<this.m_jointCount;++r)this.m_joints[r].SolveVelocityConstraints(t);s.SolveVelocityConstraints()}for(n=0;n<this.m_jointCount;++n)this.m_joints[n].FinalizeVelocityConstraints();for(s.FinalizeVelocityConstraints(),n=0;n<this.m_bodyCount;++n)if((o=this.m_bodies[n]).GetType()!=rO.b2_staticBody){var a=t.dt*o.m_linearVelocity.x,l=t.dt*o.m_linearVelocity.y;a*a+l*l>RB.b2_maxTranslationSquared&&(o.m_linearVelocity.Normalize(),o.m_linearVelocity.x*=RB.b2_maxTranslation*t.inv_dt,o.m_linearVelocity.y*=RB.b2_maxTranslation*t.inv_dt);var u=t.dt*o.m_angularVelocity;u*u>RB.b2_maxRotationSquared&&(o.m_angularVelocity<0?o.m_angularVelocity=-RB.b2_maxRotation*t.inv_dt:o.m_angularVelocity=RB.b2_maxRotation*t.inv_dt),o.m_sweep.c0.SetV(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_sweep.c.x+=t.dt*o.m_linearVelocity.x,o.m_sweep.c.y+=t.dt*o.m_linearVelocity.y,o.m_sweep.a+=t.dt*o.m_angularVelocity,o.SynchronizeTransform()}for(n=0;n<t.positionIterations;++n){var c=s.SolvePositionConstraints(RB.b2_contactBaumgarte),h=!0;for(r=0;r<this.m_jointCount;++r){var p=this.m_joints[r].SolvePositionConstraints(RB.b2_contactBaumgarte);h=h&&p}if(c&&h)break}if(this.Report(s.m_constraints),i){var d=Number.MAX_VALUE,f=RB.b2_linearSleepTolerance*RB.b2_linearSleepTolerance,_=RB.b2_angularSleepTolerance*RB.b2_angularSleepTolerance;for(n=0;n<this.m_bodyCount;++n)(o=this.m_bodies[n]).GetType()!=rO.b2_staticBody&&(0==(o.m_flags&rO.e_allowSleepFlag)&&(o.m_sleepTime=0,d=0),0==(o.m_flags&rO.e_allowSleepFlag)||o.m_angularVelocity*o.m_angularVelocity>_||zB.Dot(o.m_linearVelocity,o.m_linearVelocity)>f?(o.m_sleepTime=0,d=0):(o.m_sleepTime+=t.dt,d=zB.Min(d,o.m_sleepTime)));if(d>=RB.b2_timeToSleep)for(n=0;n<this.m_bodyCount;++n)(o=this.m_bodies[n]).SetAwake(!1)}},t.prototype.SolveTOI=function(t){var e,i;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var n=this.m_contactSolver;for(e=0;e<this.m_jointCount;++e)this.m_joints[e].InitVelocityConstraints(t);for(e=0;e<t.velocityIterations;++e)for(n.SolveVelocityConstraints(),i=0;i<this.m_jointCount;++i)this.m_joints[i].SolveVelocityConstraints(t);for(e=0;e<this.m_bodyCount;++e){var r=this.m_bodies[e];if(r.GetType()!=rO.b2_staticBody){var o=t.dt*r.m_linearVelocity.x,s=t.dt*r.m_linearVelocity.y;o*o+s*s>RB.b2_maxTranslationSquared&&(r.m_linearVelocity.Normalize(),r.m_linearVelocity.x*=RB.b2_maxTranslation*t.inv_dt,r.m_linearVelocity.y*=RB.b2_maxTranslation*t.inv_dt);var a=t.dt*r.m_angularVelocity;a*a>RB.b2_maxRotationSquared&&(r.m_angularVelocity<0?r.m_angularVelocity=-RB.b2_maxRotation*t.inv_dt:r.m_angularVelocity=RB.b2_maxRotation*t.inv_dt),r.m_sweep.c0.SetV(r.m_sweep.c),r.m_sweep.a0=r.m_sweep.a,r.m_sweep.c.x+=t.dt*r.m_linearVelocity.x,r.m_sweep.c.y+=t.dt*r.m_linearVelocity.y,r.m_sweep.a+=t.dt*r.m_angularVelocity,r.SynchronizeTransform()}}for(e=0;e<t.positionIterations;++e){var l=n.SolvePositionConstraints(.75),u=!0;for(i=0;i<this.m_jointCount;++i){var c=this.m_joints[i].SolvePositionConstraints(RB.b2_contactBaumgarte);u=u&&c}if(l&&u)break}this.Report(n.m_constraints)},t.prototype.Report=function(e){if(null!=this.m_listener)for(var i=0;i<this.m_contactCount;++i){for(var n=this.m_contacts[i],r=e[i],o=0;o<r.pointCount;++o)t.s_impulse.normalImpulses[o]=r.points[o].normalImpulse,t.s_impulse.tangentImpulses[o]=r.points[o].tangentImpulse;this.m_listener.PostSolve(n,t.s_impulse)}},t.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t},t.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},t.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},t.s_impulse=new IM,t}(),SM=function(){function t(t){this.m_edgeA=new NM,this.m_edgeB=new NM,this.m_localCenterA=new GB,this.m_localCenterB=new GB,RB.b2Assert(t.bodyA!=t.bodyB),this.m_type=t.type,this.m_prev=null,this.m_next=null,this.m_bodyA=t.bodyA,this.m_bodyB=t.bodyB,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData}return t.prototype.GetType=function(){return this.m_type},t.prototype.GetAnchorA=function(){return null},t.prototype.GetAnchorB=function(){return null},t.prototype.GetReactionForce=function(t){return null},t.prototype.GetReactionTorque=function(t){return 0},t.prototype.GetBodyA=function(){return this.m_bodyA},t.prototype.GetBodyB=function(){return this.m_bodyB},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},t.Create=function(e,i){var n=null;switch(e.type){case t.e_distanceJoint:n=new TM(e);break;case t.e_mouseJoint:n=new VM(e);break;case t.e_prismaticJoint:n=new jM(e);break;case t.e_revoluteJoint:n=new HM(e);break;case t.e_pulleyJoint:n=new QM(e);break;case t.e_gearJoint:n=new OM(e);break;case t.e_lineJoint:n=new FM(e);break;case t.e_weldJoint:n=new qM(e);break;case t.e_frictionJoint:n=new BM(e)}return n},t.Destroy=function(t,e){},t.prototype.InitVelocityConstraints=function(t){},t.prototype.SolveVelocityConstraints=function(t){},t.prototype.FinalizeVelocityConstraints=function(){},t.prototype.SolvePositionConstraints=function(t){return!1},t.e_unknownJoint=0,t.e_revoluteJoint=1,t.e_prismaticJoint=2,t.e_distanceJoint=3,t.e_pulleyJoint=4,t.e_mouseJoint=5,t.e_gearJoint=6,t.e_lineJoint=7,t.e_weldJoint=8,t.e_frictionJoint=9,t.e_inactiveLimit=0,t.e_atLowerLimit=1,t.e_atUpperLimit=2,t.e_equalLimits=3,t}(),DM=function(){this.type=SM.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},TM=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchor1=new GB,i.m_localAnchor2=new GB,i.m_u=new GB,i.m_localAnchor1.SetV(e.localAnchorA),i.m_localAnchor2.SetV(e.localAnchorB),i.m_length=e.length,i.m_frequencyHz=e.frequencyHz,i.m_dampingRatio=e.dampingRatio,i.m_impulse=0,i.m_gamma=0,i.m_bias=0,i}return i(e,t),e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(t){return new GB(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)},e.prototype.GetReactionTorque=function(t){return 0},e.prototype.GetLength=function(){return this.m_length},e.prototype.SetLength=function(t){this.m_length=t},e.prototype.GetFrequency=function(){return this.m_frequencyHz},e.prototype.SetFrequency=function(t){this.m_frequencyHz=t},e.prototype.GetDampingRatio=function(){return this.m_dampingRatio},e.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB;e=n.m_xf.R;var o=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i,e=r.m_xf.R;var a=this.m_localAnchor2.x-r.m_sweep.localCenter.x,l=this.m_localAnchor2.y-r.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i,this.m_u.x=r.m_sweep.c.x+a-n.m_sweep.c.x-o,this.m_u.y=r.m_sweep.c.y+l-n.m_sweep.c.y-s;var u=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);u>RB.b2_linearSlop?this.m_u.Multiply(1/u):this.m_u.SetZero();var c=o*this.m_u.y-s*this.m_u.x,h=a*this.m_u.y-l*this.m_u.x,p=n.m_invMass+n.m_invI*c*c+r.m_invMass+r.m_invI*h*h;if(this.m_mass=0!=p?1/p:0,this.m_frequencyHz>0){var d=u-this.m_length,f=2*Math.PI*this.m_frequencyHz,_=2*this.m_mass*this.m_dampingRatio*f,m=this.m_mass*f*f;this.m_gamma=t.dt*(_+t.dt*m),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=d*t.dt*m*this.m_gamma,this.m_mass=p+this.m_gamma,this.m_mass=0!=this.m_mass?1/this.m_mass:0}if(t.warmStarting){this.m_impulse*=t.dtRatio;var g=this.m_impulse*this.m_u.x,y=this.m_impulse*this.m_u.y;n.m_linearVelocity.x-=n.m_invMass*g,n.m_linearVelocity.y-=n.m_invMass*y,n.m_angularVelocity-=n.m_invI*(o*y-s*g),r.m_linearVelocity.x+=r.m_invMass*g,r.m_linearVelocity.y+=r.m_invMass*y,r.m_angularVelocity+=r.m_invI*(a*y-l*g)}else this.m_impulse=0},e.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,o=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*r+e.col2.x*o;o=e.col1.y*r+e.col2.y*o,r=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var u=i.m_linearVelocity.x+-i.m_angularVelocity*o,c=i.m_linearVelocity.y+i.m_angularVelocity*r,h=n.m_linearVelocity.x+-n.m_angularVelocity*l,p=n.m_linearVelocity.y+n.m_angularVelocity*a,d=this.m_u.x*(h-u)+this.m_u.y*(p-c),f=-this.m_mass*(d+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;var _=f*this.m_u.x,m=f*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*_,i.m_linearVelocity.y-=i.m_invMass*m,i.m_angularVelocity-=i.m_invI*(r*m-o*_),n.m_linearVelocity.x+=n.m_invMass*_,n.m_linearVelocity.y+=n.m_invMass*m,n.m_angularVelocity+=n.m_invI*(a*m-l*_)},e.prototype.SolvePositionConstraints=function(t){var e;if(this.m_frequencyHz>0)return!0;var i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,o=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*r+e.col2.x*o;o=e.col1.y*r+e.col2.y*o,r=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var u=n.m_sweep.c.x+a-i.m_sweep.c.x-r,c=n.m_sweep.c.y+l-i.m_sweep.c.y-o,h=Math.sqrt(u*u+c*c);u/=h,c/=h;var p=h-this.m_length;p=zB.Clamp(p,-RB.b2_maxLinearCorrection,RB.b2_maxLinearCorrection);var d=-this.m_mass*p;this.m_u.Set(u,c);var f=d*this.m_u.x,_=d*this.m_u.y;return i.m_sweep.c.x-=i.m_invMass*f,i.m_sweep.c.y-=i.m_invMass*_,i.m_sweep.a-=i.m_invI*(r*_-o*f),n.m_sweep.c.x+=n.m_invMass*f,n.m_sweep.c.y+=n.m_invMass*_,n.m_sweep.a+=n.m_invI*(a*_-l*f),i.SynchronizeTransform(),n.SynchronizeTransform(),zB.Abs(p)<RB.b2_linearSlop},e}(SM),PM=function(t){function e(){var e=t.call(this)||this;return e.localAnchorA=new GB,e.localAnchorB=new GB,e.type=SM.e_distanceJoint,e.length=1,e.frequencyHz=0,e.dampingRatio=0,e}return i(e,t),e.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n));var r=n.x-i.x,o=n.y-i.y;length=Math.sqrt(r*r+o*o),this.frequencyHz=0,this.dampingRatio=0},e}(DM),BM=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchorA=new GB,i.m_localAnchorB=new GB,i.m_linearMass=new kB,i.m_linearImpulse=new GB,i.m_localAnchorA.SetV(e.localAnchorA),i.m_localAnchorB.SetV(e.localAnchorB),i.m_linearMass.SetZero(),i.m_angularMass=0,i.m_linearImpulse.SetZero(),i.m_angularImpulse=0,i.m_maxForce=e.maxForce,i.m_maxTorque=e.maxTorque,i}return i(e,t),e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},e.prototype.GetReactionForce=function(t){return new GB(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)},e.prototype.GetReactionTorque=function(t){return t*this.m_angularImpulse},e.prototype.SetMaxForce=function(t){this.m_maxForce=t},e.prototype.GetMaxForce=function(){return this.m_maxForce},e.prototype.SetMaxTorque=function(t){this.m_maxTorque=t},e.prototype.GetMaxTorque=function(){return this.m_maxTorque},e.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB;e=n.m_xf.R;var o=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i,e=r.m_xf.R;var a=this.m_localAnchorB.x-r.m_sweep.localCenter.x,l=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var u=n.m_invMass,c=r.m_invMass,h=n.m_invI,p=r.m_invI,d=new kB;if(d.col1.x=u+c,d.col2.x=0,d.col1.y=0,d.col2.y=u+c,d.col1.x+=h*s*s,d.col2.x+=-h*o*s,d.col1.y+=-h*o*s,d.col2.y+=h*o*o,d.col1.x+=p*l*l,d.col2.x+=-p*a*l,d.col1.y+=-p*a*l,d.col2.y+=p*a*a,d.GetInverse(this.m_linearMass),this.m_angularMass=h+p,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.x*=t.dtRatio,this.m_linearImpulse.y*=t.dtRatio,this.m_angularImpulse*=t.dtRatio;var f=this.m_linearImpulse;n.m_linearVelocity.x-=u*f.x,n.m_linearVelocity.y-=u*f.y,n.m_angularVelocity-=h*(o*f.y-s*f.x+this.m_angularImpulse),r.m_linearVelocity.x+=c*f.x,r.m_linearVelocity.y+=c*f.y,r.m_angularVelocity+=p*(a*f.y-l*f.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},e.prototype.SolveVelocityConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB,o=n.m_linearVelocity,s=n.m_angularVelocity,a=r.m_linearVelocity,l=r.m_angularVelocity,u=n.m_invMass,c=r.m_invMass,h=n.m_invI,p=r.m_invI;e=n.m_xf.R;var d=this.m_localAnchorA.x-n.m_sweep.localCenter.x,f=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*d+e.col2.x*f,f=e.col1.y*d+e.col2.y*f,d=i,e=r.m_xf.R;var _,m=this.m_localAnchorB.x-r.m_sweep.localCenter.x,g=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*m+e.col2.x*g,g=e.col1.y*m+e.col2.y*g,m=i;var y=l-s,A=-this.m_angularMass*y,v=this.m_angularImpulse;_=t.dt*this.m_maxTorque,this.m_angularImpulse=zB.Clamp(this.m_angularImpulse+A,-_,_),s-=h*(A=this.m_angularImpulse-v),l+=p*A;var b=a.x-l*g-o.x+s*f,x=a.y+l*m-o.y-s*d,C=zB.MulMV(this.m_linearMass,new GB(-b,-x)),w=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(C),_=t.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>_*_&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(_)),C=zB.SubtractVV(this.m_linearImpulse,w),o.x-=u*C.x,o.y-=u*C.y,s-=h*(d*C.y-f*C.x),a.x+=c*C.x,a.y+=c*C.y,l+=p*(m*C.y-g*C.x),n.m_angularVelocity=s,r.m_angularVelocity=l},e.prototype.SolvePositionConstraints=function(t){return!0},e}(SM),MM=function(t){function e(){var e=t.call(this)||this;return e.localAnchorA=new GB,e.localAnchorB=new GB,e.type=SM.e_frictionJoint,e.maxForce=0,e.maxTorque=0,e}return i(e,t),e.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i))},e}(DM),OM=function(t){function e(e){var i=t.call(this,e)||this;i.m_groundAnchor1=new GB,i.m_groundAnchor2=new GB,i.m_localAnchor1=new GB,i.m_localAnchor2=new GB,i.m_J=new RM;var n,r,o=e.joint1.m_type,s=e.joint2.m_type;return i.m_revolute1=null,i.m_prismatic1=null,i.m_revolute2=null,i.m_prismatic2=null,i.m_ground1=e.joint1.GetBodyA(),i.m_bodyA=e.joint1.GetBodyB(),o==SM.e_revoluteJoint?(i.m_revolute1=e.joint1,i.m_groundAnchor1.SetV(i.m_revolute1.m_localAnchor1),i.m_localAnchor1.SetV(i.m_revolute1.m_localAnchor2),n=i.m_revolute1.GetJointAngle()):(i.m_prismatic1=e.joint1,i.m_groundAnchor1.SetV(i.m_prismatic1.m_localAnchor1),i.m_localAnchor1.SetV(i.m_prismatic1.m_localAnchor2),n=i.m_prismatic1.GetJointTranslation()),i.m_ground2=e.joint2.GetBodyA(),i.m_bodyB=e.joint2.GetBodyB(),s==SM.e_revoluteJoint?(i.m_revolute2=e.joint2,i.m_groundAnchor2.SetV(i.m_revolute2.m_localAnchor1),i.m_localAnchor2.SetV(i.m_revolute2.m_localAnchor2),r=i.m_revolute2.GetJointAngle()):(i.m_prismatic2=e.joint2,i.m_groundAnchor2.SetV(i.m_prismatic2.m_localAnchor1),i.m_localAnchor2.SetV(i.m_prismatic2.m_localAnchor2),r=i.m_prismatic2.GetJointTranslation()),i.m_ratio=e.ratio,i.m_constant=n+i.m_ratio*r,i.m_impulse=0,i}return i(e,t),e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(t){return new GB(t*this.m_impulse*this.m_J.linearB.x,t*this.m_impulse*this.m_J.linearB.y)},e.prototype.GetReactionTorque=function(t){var e=this.m_bodyB.m_xf.R,i=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,n=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,r=e.col1.x*i+e.col2.x*n;n=e.col1.y*i+e.col2.y*n,i=r;var o=this.m_impulse*this.m_J.linearB.x,s=this.m_impulse*this.m_J.linearB.y;return t*(this.m_impulse*this.m_J.angularB-i*s+n*o)},e.prototype.GetRatio=function(){return this.m_ratio},e.prototype.SetRatio=function(t){this.m_ratio=t},e.prototype.InitVelocityConstraints=function(t){var e,i,n,r,o,s,a,l,u=this.m_ground1,c=this.m_ground2,h=this.m_bodyA,p=this.m_bodyB,d=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,d+=h.m_invI):(o=u.m_xf.R,s=this.m_prismatic1.m_localXAxis1,e=o.col1.x*s.x+o.col2.x*s.y,i=o.col1.y*s.x+o.col2.y*s.y,o=h.m_xf.R,n=this.m_localAnchor1.x-h.m_sweep.localCenter.x,r=this.m_localAnchor1.y-h.m_sweep.localCenter.y,l=o.col1.x*n+o.col2.x*r,r=o.col1.y*n+o.col2.y*r,a=(n=l)*i-r*e,this.m_J.linearA.Set(-e,-i),this.m_J.angularA=-a,d+=h.m_invMass+h.m_invI*a*a),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,d+=this.m_ratio*this.m_ratio*p.m_invI):(o=c.m_xf.R,s=this.m_prismatic2.m_localXAxis1,e=o.col1.x*s.x+o.col2.x*s.y,i=o.col1.y*s.x+o.col2.y*s.y,o=p.m_xf.R,n=this.m_localAnchor2.x-p.m_sweep.localCenter.x,r=this.m_localAnchor2.y-p.m_sweep.localCenter.y,l=o.col1.x*n+o.col2.x*r,r=o.col1.y*n+o.col2.y*r,a=(n=l)*i-r*e,this.m_J.linearB.Set(-this.m_ratio*e,-this.m_ratio*i),this.m_J.angularB=-this.m_ratio*a,d+=this.m_ratio*this.m_ratio*(p.m_invMass+p.m_invI*a*a)),this.m_mass=d>0?1/d:0,t.warmStarting?(h.m_linearVelocity.x+=h.m_invMass*this.m_impulse*this.m_J.linearA.x,h.m_linearVelocity.y+=h.m_invMass*this.m_impulse*this.m_J.linearA.y,h.m_angularVelocity+=h.m_invI*this.m_impulse*this.m_J.angularA,p.m_linearVelocity.x+=p.m_invMass*this.m_impulse*this.m_J.linearB.x,p.m_linearVelocity.y+=p.m_invMass*this.m_impulse*this.m_J.linearB.y,p.m_angularVelocity+=p.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},e.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=this.m_J.Compute(e.m_linearVelocity,e.m_angularVelocity,i.m_linearVelocity,i.m_angularVelocity),r=-this.m_mass*n;this.m_impulse+=r,e.m_linearVelocity.x+=e.m_invMass*r*this.m_J.linearA.x,e.m_linearVelocity.y+=e.m_invMass*r*this.m_J.linearA.y,e.m_angularVelocity+=e.m_invI*r*this.m_J.angularA,i.m_linearVelocity.x+=i.m_invMass*r*this.m_J.linearB.x,i.m_linearVelocity.y+=i.m_invMass*r*this.m_J.linearB.y,i.m_angularVelocity+=i.m_invI*r*this.m_J.angularB},e.prototype.SolvePositionConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB;e=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),i=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var o=this.m_constant-(e+this.m_ratio*i),s=-this.m_mass*o;return n.m_sweep.c.x+=n.m_invMass*s*this.m_J.linearA.x,n.m_sweep.c.y+=n.m_invMass*s*this.m_J.linearA.y,n.m_sweep.a+=n.m_invI*s*this.m_J.angularA,r.m_sweep.c.x+=r.m_invMass*s*this.m_J.linearB.x,r.m_sweep.c.y+=r.m_invMass*s*this.m_J.linearB.y,r.m_sweep.a+=r.m_invI*s*this.m_J.angularB,n.SynchronizeTransform(),r.SynchronizeTransform(),0<RB.b2_linearSlop},e}(SM),LM=function(t){function e(){var e=t.call(this)||this;return e.type=SM.e_gearJoint,e.joint1=null,e.joint2=null,e.ratio=1,e}return i(e,t),e}(DM),RM=function(){function t(){this.linearA=new GB,this.linearB=new GB}return t.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},t.prototype.Set=function(t,e,i,n){this.linearA.SetV(t),this.angularA=e,this.linearB.SetV(i),this.angularB=n},t.prototype.Compute=function(t,e,i,n){return this.linearA.x*t.x+this.linearA.y*t.y+this.angularA*e+(this.linearB.x*i.x+this.linearB.y*i.y)+this.angularB*n},t}(),NM=function(){},FM=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchor1=new GB,i.m_localAnchor2=new GB,i.m_localXAxis1=new GB,i.m_localYAxis1=new GB,i.m_axis=new GB,i.m_perp=new GB,i.m_K=new kB,i.m_impulse=new GB,i.m_localAnchor1.SetV(e.localAnchorA),i.m_localAnchor2.SetV(e.localAnchorB),i.m_localXAxis1.SetV(e.localAxisA),i.m_localYAxis1.x=-i.m_localXAxis1.y,i.m_localYAxis1.y=i.m_localXAxis1.x,i.m_impulse.SetZero(),i.m_motorMass=0,i.m_motorImpulse=0,i.m_lowerTranslation=e.lowerTranslation,i.m_upperTranslation=e.upperTranslation,i.m_maxMotorForce=e.maxMotorForce,i.m_motorSpeed=e.motorSpeed,i.m_enableLimit=e.enableLimit,i.m_enableMotor=e.enableMotor,i.m_limitState=SM.e_inactiveLimit,i.m_axis.SetZero(),i.m_perp.SetZero(),i}return i(e,t),e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(t){return new GB(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},e.prototype.GetReactionTorque=function(t){return t*this.m_impulse.y},e.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),r=n.x-i.x,o=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*r+s.y*o},e.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=o;var l=e.m_sweep.c.x+n,u=e.m_sweep.c.y+r,c=i.m_sweep.c.x+s-l,h=i.m_sweep.c.y+a-u,p=e.GetWorldVector(this.m_localXAxis1),d=e.m_linearVelocity,f=i.m_linearVelocity,_=e.m_angularVelocity,m=i.m_angularVelocity;return c*(-_*p.y)+h*(_*p.x)+(p.x*(f.x+-m*a-d.x- -_*r)+p.y*(f.y+m*s-d.y-_*n))},e.prototype.IsLimitEnabled=function(){return this.m_enableLimit},e.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},e.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},e.prototype.GetUpperLimit=function(){return this.m_upperTranslation},e.prototype.SetLimits=function(t,e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},e.prototype.IsMotorEnabled=function(){return this.m_enableMotor},e.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},e.prototype.SetMotorSpeed=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},e.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},e.prototype.SetMaxMotorForce=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},e.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},e.prototype.GetMotorForce=function(){return this.m_motorImpulse},e.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB;this.m_localCenterA.SetV(n.GetLocalCenter()),this.m_localCenterB.SetV(r.GetLocalCenter());var o=n.GetTransform();r.GetTransform();e=n.m_xf.R;var s=this.m_localAnchor1.x-this.m_localCenterA.x,a=this.m_localAnchor1.y-this.m_localCenterA.y;i=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=i,e=r.m_xf.R;var l=this.m_localAnchor2.x-this.m_localCenterB.x,u=this.m_localAnchor2.y-this.m_localCenterB.y;i=e.col1.x*l+e.col2.x*u,u=e.col1.y*l+e.col2.y*u,l=i;var c=r.m_sweep.c.x+l-n.m_sweep.c.x-s,h=r.m_sweep.c.y+u-n.m_sweep.c.y-a;this.m_invMassA=n.m_invMass,this.m_invMassB=r.m_invMass,this.m_invIA=n.m_invI,this.m_invIB=r.m_invI,this.m_axis.SetV(zB.MulMV(o.R,this.m_localXAxis1)),this.m_a1=(c+s)*this.m_axis.y-(h+a)*this.m_axis.x,this.m_a2=l*this.m_axis.y-u*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(zB.MulMV(o.R,this.m_localYAxis1)),this.m_s1=(c+s)*this.m_perp.y-(h+a)*this.m_perp.x,this.m_s2=l*this.m_perp.y-u*this.m_perp.x;var p=this.m_invMassA,d=this.m_invMassB,f=this.m_invIA,_=this.m_invIB;if(this.m_K.col1.x=p+d+f*this.m_s1*this.m_s1+_*this.m_s2*this.m_s2,this.m_K.col1.y=f*this.m_s1*this.m_a1+_*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=p+d+f*this.m_a1*this.m_a1+_*this.m_a2*this.m_a2,this.m_enableLimit){var m=this.m_axis.x*c+this.m_axis.y*h;zB.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*RB.b2_linearSlop?this.m_limitState=SM.e_equalLimits:m<=this.m_lowerTranslation?this.m_limitState!=SM.e_atLowerLimit&&(this.m_limitState=SM.e_atLowerLimit,this.m_impulse.y=0):m>=this.m_upperTranslation?this.m_limitState!=SM.e_atUpperLimit&&(this.m_limitState=SM.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=SM.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=SM.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var g=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,y=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,A=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,v=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;n.m_linearVelocity.x-=this.m_invMassA*g,n.m_linearVelocity.y-=this.m_invMassA*y,n.m_angularVelocity-=this.m_invIA*A,r.m_linearVelocity.x+=this.m_invMassB*g,r.m_linearVelocity.y+=this.m_invMassB*y,r.m_angularVelocity+=this.m_invIB*v}else this.m_impulse.SetZero(),this.m_motorImpulse=0},e.prototype.SolveVelocityConstraints=function(t){var e,i,n,r,o=this.m_bodyA,s=this.m_bodyB,a=o.m_linearVelocity,l=o.m_angularVelocity,u=s.m_linearVelocity,c=s.m_angularVelocity;if(this.m_enableMotor&&this.m_limitState!=SM.e_equalLimits){var h=this.m_axis.x*(u.x-a.x)+this.m_axis.y*(u.y-a.y)+this.m_a2*c-this.m_a1*l,p=this.m_motorMass*(this.m_motorSpeed-h),d=this.m_motorImpulse,f=t.dt*this.m_maxMotorForce;this.m_motorImpulse=zB.Clamp(this.m_motorImpulse+p,-f,f),e=(p=this.m_motorImpulse-d)*this.m_axis.x,i=p*this.m_axis.y,n=p*this.m_a1,r=p*this.m_a2,a.x-=this.m_invMassA*e,a.y-=this.m_invMassA*i,l-=this.m_invIA*n,u.x+=this.m_invMassB*e,u.y+=this.m_invMassB*i,c+=this.m_invIB*r}var _=this.m_perp.x*(u.x-a.x)+this.m_perp.y*(u.y-a.y)+this.m_s2*c-this.m_s1*l;if(this.m_enableLimit&&this.m_limitState!=SM.e_inactiveLimit){var m=this.m_axis.x*(u.x-a.x)+this.m_axis.y*(u.y-a.y)+this.m_a2*c-this.m_a1*l,g=this.m_impulse.Copy(),y=this.m_K.Solve(new GB,-_,-m);this.m_impulse.Add(y),this.m_limitState==SM.e_atLowerLimit?this.m_impulse.y=zB.Max(this.m_impulse.y,0):this.m_limitState==SM.e_atUpperLimit&&(this.m_impulse.y=zB.Min(this.m_impulse.y,0));var A=-_-(this.m_impulse.y-g.y)*this.m_K.col2.x,v=void 0;v=0!=this.m_K.col1.x?A/this.m_K.col1.x+g.x:g.x,this.m_impulse.x=v,y.x=this.m_impulse.x-g.x,y.y=this.m_impulse.y-g.y,e=y.x*this.m_perp.x+y.y*this.m_axis.x,i=y.x*this.m_perp.y+y.y*this.m_axis.y,n=y.x*this.m_s1+y.y*this.m_a1,r=y.x*this.m_s2+y.y*this.m_a2,a.x-=this.m_invMassA*e,a.y-=this.m_invMassA*i,l-=this.m_invIA*n,u.x+=this.m_invMassB*e,u.y+=this.m_invMassB*i,c+=this.m_invIB*r}else{var b=void 0;b=0!=this.m_K.col1.x?-_/this.m_K.col1.x:0,this.m_impulse.x+=b,e=b*this.m_perp.x,i=b*this.m_perp.y,n=b*this.m_s1,r=b*this.m_s2,a.x-=this.m_invMassA*e,a.y-=this.m_invMassA*i,l-=this.m_invIA*n,u.x+=this.m_invMassB*e,u.y+=this.m_invMassB*i,c+=this.m_invIB*r}o.m_linearVelocity.SetV(a),o.m_angularVelocity=l,s.m_linearVelocity.SetV(u),s.m_angularVelocity=c},e.prototype.SolvePositionConstraints=function(t){var e,i,n,r,o,s,a=this.m_bodyA,l=this.m_bodyB,u=a.m_sweep.c,c=a.m_sweep.a,h=l.m_sweep.c,p=l.m_sweep.a,d=0,f=!1,_=0,m=kB.FromAngle(c),g=kB.FromAngle(p);e=m;var y=this.m_localAnchor1.x-this.m_localCenterA.x,A=this.m_localAnchor1.y-this.m_localCenterA.y;i=e.col1.x*y+e.col2.x*A,A=e.col1.y*y+e.col2.y*A,y=i,e=g;var v=this.m_localAnchor2.x-this.m_localCenterB.x,b=this.m_localAnchor2.y-this.m_localCenterB.y;i=e.col1.x*v+e.col2.x*b,b=e.col1.y*v+e.col2.y*b,v=i;var x=h.x+v-u.x-y,C=h.y+b-u.y-A;if(this.m_enableLimit){this.m_axis=zB.MulMV(m,this.m_localXAxis1),this.m_a1=(x+y)*this.m_axis.y-(C+A)*this.m_axis.x,this.m_a2=v*this.m_axis.y-b*this.m_axis.x;var w=this.m_axis.x*x+this.m_axis.y*C;zB.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*RB.b2_linearSlop?(_=zB.Clamp(w,-RB.b2_maxLinearCorrection,RB.b2_maxLinearCorrection),d=zB.Abs(w),f=!0):w<=this.m_lowerTranslation?(_=zB.Clamp(w-this.m_lowerTranslation+RB.b2_linearSlop,-RB.b2_maxLinearCorrection,0),d=this.m_lowerTranslation-w,f=!0):w>=this.m_upperTranslation&&(_=zB.Clamp(w-this.m_upperTranslation+RB.b2_linearSlop,0,RB.b2_maxLinearCorrection),d=w-this.m_upperTranslation,f=!0)}this.m_perp=zB.MulMV(m,this.m_localYAxis1),this.m_s1=(x+y)*this.m_perp.y-(C+A)*this.m_perp.x,this.m_s2=v*this.m_perp.y-b*this.m_perp.x;var I=new GB,E=this.m_perp.x*x+this.m_perp.y*C;if(d=zB.Max(d,zB.Abs(E)),0,f)n=this.m_invMassA,r=this.m_invMassB,o=this.m_invIA,s=this.m_invIB,this.m_K.col1.x=n+r+o*this.m_s1*this.m_s1+s*this.m_s2*this.m_s2,this.m_K.col1.y=o*this.m_s1*this.m_a1+s*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=n+r+o*this.m_a1*this.m_a1+s*this.m_a2*this.m_a2,this.m_K.Solve(I,-E,-_);else{n=this.m_invMassA,r=this.m_invMassB,o=this.m_invIA,s=this.m_invIB;var S=n+r+o*this.m_s1*this.m_s1+s*this.m_s2*this.m_s2,D=void 0;D=0!=S?-E/S:0,I.x=D,I.y=0}var T=I.x*this.m_perp.x+I.y*this.m_axis.x,P=I.x*this.m_perp.y+I.y*this.m_axis.y,B=I.x*this.m_s1+I.y*this.m_a1,M=I.x*this.m_s2+I.y*this.m_a2;return u.x-=this.m_invMassA*T,u.y-=this.m_invMassA*P,c-=this.m_invIA*B,h.x+=this.m_invMassB*T,h.y+=this.m_invMassB*P,p+=this.m_invIB*M,a.m_sweep.a=c,l.m_sweep.a=p,a.SynchronizeTransform(),l.SynchronizeTransform(),d<=RB.b2_linearSlop&&0<=RB.b2_angularSlop},e}(SM),kM=function(t){function e(){var e=t.call(this)||this;return e.localAnchorA=new GB,e.localAnchorB=new GB,e.localAxisA=new GB,e.type=SM.e_lineJoint,e.localAxisA.Set(1,0),e.enableLimit=!1,e.lowerTranslation=0,e.upperTranslation=0,e.enableMotor=!1,e.maxMotorForce=0,e.motorSpeed=0,e}return i(e,t),e.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n)},e}(DM),VM=function(t){function e(e){var i=t.call(this,e)||this;i.K=new kB,i.K1=new kB,i.K2=new kB,i.m_localAnchor=new GB,i.m_target=new GB,i.m_impulse=new GB,i.m_mass=new kB,i.m_C=new GB,i.m_target.SetV(e.target);var n=i.m_target.x-i.m_bodyB.m_xf.position.x,r=i.m_target.y-i.m_bodyB.m_xf.position.y,o=i.m_bodyB.m_xf.R;return i.m_localAnchor.x=n*o.col1.x+r*o.col1.y,i.m_localAnchor.y=n*o.col2.x+r*o.col2.y,i.m_maxForce=e.maxForce,i.m_impulse.SetZero(),i.m_frequencyHz=e.frequencyHz,i.m_dampingRatio=e.dampingRatio,i.m_beta=0,i.m_gamma=0,i}return i(e,t),e.prototype.GetAnchorA=function(){return this.m_target},e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},e.prototype.GetReactionForce=function(t){return new GB(t*this.m_impulse.x,t*this.m_impulse.y)},e.prototype.GetReactionTorque=function(t){return 0},e.prototype.GetTarget=function(){return this.m_target},e.prototype.SetTarget=function(t){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t},e.prototype.GetMaxForce=function(){return this.m_maxForce},e.prototype.SetMaxForce=function(t){this.m_maxForce=t},e.prototype.GetFrequency=function(){return this.m_frequencyHz},e.prototype.SetFrequency=function(t){this.m_frequencyHz=t},e.prototype.GetDampingRatio=function(){return this.m_dampingRatio},e.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.InitVelocityConstraints=function(t){var e,i=this.m_bodyB,n=i.GetMass(),r=2*Math.PI*this.m_frequencyHz,o=2*n*this.m_dampingRatio*r,s=n*r*r;this.m_gamma=t.dt*(o+t.dt*s),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*s*this.m_gamma,e=i.m_xf.R;var a=this.m_localAnchor.x-i.m_sweep.localCenter.x,l=this.m_localAnchor.y-i.m_sweep.localCenter.y,u=e.col1.x*a+e.col2.x*l;l=e.col1.y*a+e.col2.y*l,a=u;var c=i.m_invMass,h=i.m_invI;this.K1.col1.x=c,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=c,this.K2.col1.x=h*l*l,this.K2.col2.x=-h*a*l,this.K2.col1.y=-h*a*l,this.K2.col2.y=h*a*a,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=i.m_sweep.c.x+a-this.m_target.x,this.m_C.y=i.m_sweep.c.y+l-this.m_target.y,i.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,i.m_linearVelocity.x+=c*this.m_impulse.x,i.m_linearVelocity.y+=c*this.m_impulse.y,i.m_angularVelocity+=h*(a*this.m_impulse.y-l*this.m_impulse.x)},e.prototype.SolveVelocityConstraints=function(t){var e,i,n,r=this.m_bodyB;e=r.m_xf.R;var o=this.m_localAnchor.x-r.m_sweep.localCenter.x,s=this.m_localAnchor.y-r.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i;var a=r.m_linearVelocity.x+-r.m_angularVelocity*s,l=r.m_linearVelocity.y+r.m_angularVelocity*o;e=this.m_mass,i=a+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,n=l+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var u=-(e.col1.x*i+e.col2.x*n),c=-(e.col1.y*i+e.col2.y*n),h=this.m_impulse.x,p=this.m_impulse.y;this.m_impulse.x+=u,this.m_impulse.y+=c;var d=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>d*d&&this.m_impulse.Multiply(d/this.m_impulse.Length()),u=this.m_impulse.x-h,c=this.m_impulse.y-p,r.m_linearVelocity.x+=r.m_invMass*u,r.m_linearVelocity.y+=r.m_invMass*c,r.m_angularVelocity+=r.m_invI*(o*c-s*u)},e.prototype.SolvePositionConstraints=function(t){return!0},e}(SM),UM=function(t){function e(){var e=t.call(this)||this;return e.target=new GB,e.type=SM.e_mouseJoint,e.maxForce=0,e.frequencyHz=5,e.dampingRatio=.7,e}return i(e,t),e}(DM),jM=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchor1=new GB,i.m_localAnchor2=new GB,i.m_localXAxis1=new GB,i.m_localYAxis1=new GB,i.m_axis=new GB,i.m_perp=new GB,i.m_K=new VB,i.m_impulse=new QB,i.m_localAnchor1.SetV(e.localAnchorA),i.m_localAnchor2.SetV(e.localAnchorB),i.m_localXAxis1.SetV(e.localAxisA),i.m_localYAxis1.x=-i.m_localXAxis1.y,i.m_localYAxis1.y=i.m_localXAxis1.x,i.m_refAngle=e.referenceAngle,i.m_impulse.SetZero(),i.m_motorMass=0,i.m_motorImpulse=0,i.m_lowerTranslation=e.lowerTranslation,i.m_upperTranslation=e.upperTranslation,i.m_maxMotorForce=e.maxMotorForce,i.m_motorSpeed=e.motorSpeed,i.m_enableLimit=e.enableLimit,i.m_enableMotor=e.enableMotor,i.m_limitState=SM.e_inactiveLimit,i.m_axis.SetZero(),i.m_perp.SetZero(),i}return i(e,t),e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(t){return new GB(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},e.prototype.GetReactionTorque=function(t){return t*this.m_impulse.y},e.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),r=n.x-i.x,o=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*r+s.y*o},e.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=o;var l=e.m_sweep.c.x+n,u=e.m_sweep.c.y+r,c=i.m_sweep.c.x+s-l,h=i.m_sweep.c.y+a-u,p=e.GetWorldVector(this.m_localXAxis1),d=e.m_linearVelocity,f=i.m_linearVelocity,_=e.m_angularVelocity,m=i.m_angularVelocity;return c*(-_*p.y)+h*(_*p.x)+(p.x*(f.x+-m*a-d.x- -_*r)+p.y*(f.y+m*s-d.y-_*n))},e.prototype.IsLimitEnabled=function(){return this.m_enableLimit},e.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},e.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},e.prototype.GetUpperLimit=function(){return this.m_upperTranslation},e.prototype.SetLimits=function(t,e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},e.prototype.IsMotorEnabled=function(){return this.m_enableMotor},e.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},e.prototype.SetMotorSpeed=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},e.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},e.prototype.SetMaxMotorForce=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},e.prototype.GetMotorForce=function(){return this.m_motorImpulse},e.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB;this.m_localCenterA.SetV(n.GetLocalCenter()),this.m_localCenterB.SetV(r.GetLocalCenter());var o=n.GetTransform();r.GetTransform();e=n.m_xf.R;var s=this.m_localAnchor1.x-this.m_localCenterA.x,a=this.m_localAnchor1.y-this.m_localCenterA.y;i=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=i,e=r.m_xf.R;var l=this.m_localAnchor2.x-this.m_localCenterB.x,u=this.m_localAnchor2.y-this.m_localCenterB.y;i=e.col1.x*l+e.col2.x*u,u=e.col1.y*l+e.col2.y*u,l=i;var c=r.m_sweep.c.x+l-n.m_sweep.c.x-s,h=r.m_sweep.c.y+u-n.m_sweep.c.y-a;this.m_invMassA=n.m_invMass,this.m_invMassB=r.m_invMass,this.m_invIA=n.m_invI,this.m_invIB=r.m_invI,this.m_axis.SetV(zB.MulMV(o.R,this.m_localXAxis1)),this.m_a1=(c+s)*this.m_axis.y-(h+a)*this.m_axis.x,this.m_a2=l*this.m_axis.y-u*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(zB.MulMV(o.R,this.m_localYAxis1)),this.m_s1=(c+s)*this.m_perp.y-(h+a)*this.m_perp.x,this.m_s2=l*this.m_perp.y-u*this.m_perp.x;var p=this.m_invMassA,d=this.m_invMassB,f=this.m_invIA,_=this.m_invIB;if(this.m_K.col1.x=p+d+f*this.m_s1*this.m_s1+_*this.m_s2*this.m_s2,this.m_K.col1.y=f*this.m_s1+_*this.m_s2,this.m_K.col1.z=f*this.m_s1*this.m_a1+_*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=f+_,this.m_K.col2.z=f*this.m_a1+_*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=p+d+f*this.m_a1*this.m_a1+_*this.m_a2*this.m_a2,this.m_enableLimit){var m=this.m_axis.x*c+this.m_axis.y*h;zB.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*RB.b2_linearSlop?this.m_limitState=SM.e_equalLimits:m<=this.m_lowerTranslation?this.m_limitState!=SM.e_atLowerLimit&&(this.m_limitState=SM.e_atLowerLimit,this.m_impulse.z=0):m>=this.m_upperTranslation?this.m_limitState!=SM.e_atUpperLimit&&(this.m_limitState=SM.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=SM.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=SM.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var g=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,y=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,A=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,v=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;n.m_linearVelocity.x-=this.m_invMassA*g,n.m_linearVelocity.y-=this.m_invMassA*y,n.m_angularVelocity-=this.m_invIA*A,r.m_linearVelocity.x+=this.m_invMassB*g,r.m_linearVelocity.y+=this.m_invMassB*y,r.m_angularVelocity+=this.m_invIB*v}else this.m_impulse.SetZero(),this.m_motorImpulse=0},e.prototype.SolveVelocityConstraints=function(t){var e,i,n,r,o=this.m_bodyA,s=this.m_bodyB,a=o.m_linearVelocity,l=o.m_angularVelocity,u=s.m_linearVelocity,c=s.m_angularVelocity;if(this.m_enableMotor&&this.m_limitState!=SM.e_equalLimits){var h=this.m_axis.x*(u.x-a.x)+this.m_axis.y*(u.y-a.y)+this.m_a2*c-this.m_a1*l,p=this.m_motorMass*(this.m_motorSpeed-h),d=this.m_motorImpulse,f=t.dt*this.m_maxMotorForce;this.m_motorImpulse=zB.Clamp(this.m_motorImpulse+p,-f,f),e=(p=this.m_motorImpulse-d)*this.m_axis.x,i=p*this.m_axis.y,n=p*this.m_a1,r=p*this.m_a2,a.x-=this.m_invMassA*e,a.y-=this.m_invMassA*i,l-=this.m_invIA*n,u.x+=this.m_invMassB*e,u.y+=this.m_invMassB*i,c+=this.m_invIB*r}var _=this.m_perp.x*(u.x-a.x)+this.m_perp.y*(u.y-a.y)+this.m_s2*c-this.m_s1*l,m=c-l;if(this.m_enableLimit&&this.m_limitState!=SM.e_inactiveLimit){var g=this.m_axis.x*(u.x-a.x)+this.m_axis.y*(u.y-a.y)+this.m_a2*c-this.m_a1*l,y=this.m_impulse.Copy(),A=this.m_K.Solve33(new QB,-_,-m,-g);this.m_impulse.Add(A),this.m_limitState==SM.e_atLowerLimit?this.m_impulse.z=zB.Max(this.m_impulse.z,0):this.m_limitState==SM.e_atUpperLimit&&(this.m_impulse.z=zB.Min(this.m_impulse.z,0));var v=-_-(this.m_impulse.z-y.z)*this.m_K.col3.x,b=-m-(this.m_impulse.z-y.z)*this.m_K.col3.y,x=this.m_K.Solve22(new GB,v,b);x.x+=y.x,x.y+=y.y,this.m_impulse.x=x.x,this.m_impulse.y=x.y,A.x=this.m_impulse.x-y.x,A.y=this.m_impulse.y-y.y,A.z=this.m_impulse.z-y.z,e=A.x*this.m_perp.x+A.z*this.m_axis.x,i=A.x*this.m_perp.y+A.z*this.m_axis.y,n=A.x*this.m_s1+A.y+A.z*this.m_a1,r=A.x*this.m_s2+A.y+A.z*this.m_a2,a.x-=this.m_invMassA*e,a.y-=this.m_invMassA*i,l-=this.m_invIA*n,u.x+=this.m_invMassB*e,u.y+=this.m_invMassB*i,c+=this.m_invIB*r}else{var C=this.m_K.Solve22(new GB,-_,-m);this.m_impulse.x+=C.x,this.m_impulse.y+=C.y,e=C.x*this.m_perp.x,i=C.x*this.m_perp.y,n=C.x*this.m_s1+C.y,r=C.x*this.m_s2+C.y,a.x-=this.m_invMassA*e,a.y-=this.m_invMassA*i,l-=this.m_invIA*n,u.x+=this.m_invMassB*e,u.y+=this.m_invMassB*i,c+=this.m_invIB*r}o.m_linearVelocity.SetV(a),o.m_angularVelocity=l,s.m_linearVelocity.SetV(u),s.m_angularVelocity=c},e.prototype.SolvePositionConstraints=function(t){var e,i,n,r,o,s,a,l=this.m_bodyA,u=this.m_bodyB,c=l.m_sweep.c,h=l.m_sweep.a,p=u.m_sweep.c,d=u.m_sweep.a,f=0,_=!1,m=0,g=kB.FromAngle(h),y=kB.FromAngle(d);e=g;var A=this.m_localAnchor1.x-this.m_localCenterA.x,v=this.m_localAnchor1.y-this.m_localCenterA.y;i=e.col1.x*A+e.col2.x*v,v=e.col1.y*A+e.col2.y*v,A=i,e=y;var b=this.m_localAnchor2.x-this.m_localCenterB.x,x=this.m_localAnchor2.y-this.m_localCenterB.y;i=e.col1.x*b+e.col2.x*x,x=e.col1.y*b+e.col2.y*x,b=i;var C=p.x+b-c.x-A,w=p.y+x-c.y-v;if(this.m_enableLimit){this.m_axis=zB.MulMV(g,this.m_localXAxis1),this.m_a1=(C+A)*this.m_axis.y-(w+v)*this.m_axis.x,this.m_a2=b*this.m_axis.y-x*this.m_axis.x;var I=this.m_axis.x*C+this.m_axis.y*w;zB.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*RB.b2_linearSlop?(m=zB.Clamp(I,-RB.b2_maxLinearCorrection,RB.b2_maxLinearCorrection),f=zB.Abs(I),_=!0):I<=this.m_lowerTranslation?(m=zB.Clamp(I-this.m_lowerTranslation+RB.b2_linearSlop,-RB.b2_maxLinearCorrection,0),f=this.m_lowerTranslation-I,_=!0):I>=this.m_upperTranslation&&(m=zB.Clamp(I-this.m_upperTranslation+RB.b2_linearSlop,0,RB.b2_maxLinearCorrection),f=I-this.m_upperTranslation,_=!0)}this.m_perp=zB.MulMV(g,this.m_localYAxis1),this.m_s1=(C+A)*this.m_perp.y-(w+v)*this.m_perp.x,this.m_s2=b*this.m_perp.y-x*this.m_perp.x;var E=new QB,S=this.m_perp.x*C+this.m_perp.y*w,D=d-h-this.m_refAngle;if(f=zB.Max(f,zB.Abs(S)),a=zB.Abs(D),_)n=this.m_invMassA,r=this.m_invMassB,o=this.m_invIA,s=this.m_invIB,this.m_K.col1.x=n+r+o*this.m_s1*this.m_s1+s*this.m_s2*this.m_s2,this.m_K.col1.y=o*this.m_s1+s*this.m_s2,this.m_K.col1.z=o*this.m_s1*this.m_a1+s*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=o+s,this.m_K.col2.z=o*this.m_a1+s*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=n+r+o*this.m_a1*this.m_a1+s*this.m_a2*this.m_a2,this.m_K.Solve33(E,-S,-D,-m);else{n=this.m_invMassA,r=this.m_invMassB,o=this.m_invIA,s=this.m_invIB;var T=n+r+o*this.m_s1*this.m_s1+s*this.m_s2*this.m_s2,P=o*this.m_s1+s*this.m_s2,B=o+s;this.m_K.col1.Set(T,P,0),this.m_K.col2.Set(P,B,0);var M=this.m_K.Solve22(new GB,-S,-D);E.x=M.x,E.y=M.y,E.z=0}var O=E.x*this.m_perp.x+E.z*this.m_axis.x,L=E.x*this.m_perp.y+E.z*this.m_axis.y,R=E.x*this.m_s1+E.y+E.z*this.m_a1,N=E.x*this.m_s2+E.y+E.z*this.m_a2;return c.x-=this.m_invMassA*O,c.y-=this.m_invMassA*L,h-=this.m_invIA*R,p.x+=this.m_invMassB*O,p.y+=this.m_invMassB*L,d+=this.m_invIB*N,l.m_sweep.a=h,u.m_sweep.a=d,l.SynchronizeTransform(),u.SynchronizeTransform(),f<=RB.b2_linearSlop&&a<=RB.b2_angularSlop},e}(SM),GM=function(t){function e(){var e=t.call(this)||this;return e.localAnchorA=new GB,e.localAnchorB=new GB,e.localAxisA=new GB,e.type=SM.e_prismaticJoint,e.localAxisA.Set(1,0),e.referenceAngle=0,e.enableLimit=!1,e.lowerTranslation=0,e.upperTranslation=0,e.enableMotor=!1,e.maxMotorForce=0,e.motorSpeed=0,e}return i(e,t),e.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},e}(DM),QM=function(t){function e(i){var n=t.call(this,i)||this;return n.m_groundAnchor1=new GB,n.m_groundAnchor2=new GB,n.m_localAnchor1=new GB,n.m_localAnchor2=new GB,n.m_u1=new GB,n.m_u2=new GB,n.m_ground=n.m_bodyA.m_world.m_groundBody,n.m_groundAnchor1.x=i.groundAnchorA.x-n.m_ground.m_xf.position.x,n.m_groundAnchor1.y=i.groundAnchorA.y-n.m_ground.m_xf.position.y,n.m_groundAnchor2.x=i.groundAnchorB.x-n.m_ground.m_xf.position.x,n.m_groundAnchor2.y=i.groundAnchorB.y-n.m_ground.m_xf.position.y,n.m_localAnchor1.SetV(i.localAnchorA),n.m_localAnchor2.SetV(i.localAnchorB),n.m_ratio=i.ratio,n.m_constant=i.lengthA+n.m_ratio*i.lengthB,n.m_maxLength1=zB.Min(i.maxLengthA,n.m_constant-n.m_ratio*e.b2_minPulleyLength),n.m_maxLength2=zB.Min(i.maxLengthB,(n.m_constant-e.b2_minPulleyLength)/n.m_ratio),n.m_impulse=0,n.m_limitImpulse1=0,n.m_limitImpulse2=0,n}return i(e,t),e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(t){return new GB(t*this.m_impulse*this.m_u2.x,t*this.m_impulse*this.m_u2.y)},e.prototype.GetReactionTorque=function(t){return 0},e.prototype.GetGroundAnchorA=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor1),t},e.prototype.GetGroundAnchorB=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor2),t},e.prototype.GetLength1=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},e.prototype.GetLength2=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),e=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},e.prototype.GetRatio=function(){return this.m_ratio},e.prototype.InitVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,o=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*r+e.col2.x*o;o=e.col1.y*r+e.col2.y*o,r=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var u=i.m_sweep.c.x+r,c=i.m_sweep.c.y+o,h=n.m_sweep.c.x+a,p=n.m_sweep.c.y+l,d=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,f=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,_=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,m=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(u-d,c-f),this.m_u2.Set(h-_,p-m);var g=this.m_u1.Length(),y=this.m_u2.Length();g>RB.b2_linearSlop?this.m_u1.Multiply(1/g):this.m_u1.SetZero(),y>RB.b2_linearSlop?this.m_u2.Multiply(1/y):this.m_u2.SetZero(),this.m_constant-g-this.m_ratio*y>0?(this.m_state=SM.e_inactiveLimit,this.m_impulse=0):this.m_state=SM.e_atUpperLimit,g<this.m_maxLength1?(this.m_limitState1=SM.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=SM.e_atUpperLimit,y<this.m_maxLength2?(this.m_limitState2=SM.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=SM.e_atUpperLimit;var A=r*this.m_u1.y-o*this.m_u1.x,v=a*this.m_u2.y-l*this.m_u2.x;if(this.m_limitMass1=i.m_invMass+i.m_invI*A*A,this.m_limitMass2=n.m_invMass+n.m_invI*v*v,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,t.warmStarting){this.m_impulse*=t.dtRatio,this.m_limitImpulse1*=t.dtRatio,this.m_limitImpulse2*=t.dtRatio;var b=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,x=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,C=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,w=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;i.m_linearVelocity.x+=i.m_invMass*b,i.m_linearVelocity.y+=i.m_invMass*x,i.m_angularVelocity+=i.m_invI*(r*x-o*b),n.m_linearVelocity.x+=n.m_invMass*C,n.m_linearVelocity.y+=n.m_invMass*w,n.m_angularVelocity+=n.m_invI*(a*w-l*C)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},e.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,o=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*r+e.col2.x*o;o=e.col1.y*r+e.col2.y*o,r=s,e=n.m_xf.R;var a,l,u,c,h,p,d,f,_,m,g,y=this.m_localAnchor2.x-n.m_sweep.localCenter.x,A=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*y+e.col2.x*A,A=e.col1.y*y+e.col2.y*A,y=s,this.m_state==SM.e_atUpperLimit&&(a=i.m_linearVelocity.x+-i.m_angularVelocity*o,l=i.m_linearVelocity.y+i.m_angularVelocity*r,u=n.m_linearVelocity.x+-n.m_angularVelocity*A,c=n.m_linearVelocity.y+n.m_angularVelocity*y,_=-(this.m_u1.x*a+this.m_u1.y*l)-this.m_ratio*(this.m_u2.x*u+this.m_u2.y*c),m=this.m_pulleyMass*-_,g=this.m_impulse,this.m_impulse=zB.Max(0,this.m_impulse+m),h=-(m=this.m_impulse-g)*this.m_u1.x,p=-m*this.m_u1.y,d=-this.m_ratio*m*this.m_u2.x,f=-this.m_ratio*m*this.m_u2.y,i.m_linearVelocity.x+=i.m_invMass*h,i.m_linearVelocity.y+=i.m_invMass*p,i.m_angularVelocity+=i.m_invI*(r*p-o*h),n.m_linearVelocity.x+=n.m_invMass*d,n.m_linearVelocity.y+=n.m_invMass*f,n.m_angularVelocity+=n.m_invI*(y*f-A*d)),this.m_limitState1==SM.e_atUpperLimit&&(a=i.m_linearVelocity.x+-i.m_angularVelocity*o,l=i.m_linearVelocity.y+i.m_angularVelocity*r,_=-(this.m_u1.x*a+this.m_u1.y*l),m=-this.m_limitMass1*_,g=this.m_limitImpulse1,this.m_limitImpulse1=zB.Max(0,this.m_limitImpulse1+m),h=-(m=this.m_limitImpulse1-g)*this.m_u1.x,p=-m*this.m_u1.y,i.m_linearVelocity.x+=i.m_invMass*h,i.m_linearVelocity.y+=i.m_invMass*p,i.m_angularVelocity+=i.m_invI*(r*p-o*h)),this.m_limitState2==SM.e_atUpperLimit&&(u=n.m_linearVelocity.x+-n.m_angularVelocity*A,c=n.m_linearVelocity.y+n.m_angularVelocity*y,_=-(this.m_u2.x*u+this.m_u2.y*c),m=-this.m_limitMass2*_,g=this.m_limitImpulse2,this.m_limitImpulse2=zB.Max(0,this.m_limitImpulse2+m),d=-(m=this.m_limitImpulse2-g)*this.m_u2.x,f=-m*this.m_u2.y,n.m_linearVelocity.x+=n.m_invMass*d,n.m_linearVelocity.y+=n.m_invMass*f,n.m_angularVelocity+=n.m_invI*(y*f-A*d))},e.prototype.SolvePositionConstraints=function(t){var e,i,n,r,o,s,a,l,u,c,h,p,d,f,_=this.m_bodyA,m=this.m_bodyB,g=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,y=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,A=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,v=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,b=0;return this.m_state==SM.e_atUpperLimit&&(e=_.m_xf.R,i=this.m_localAnchor1.x-_.m_sweep.localCenter.x,n=this.m_localAnchor1.y-_.m_sweep.localCenter.y,f=e.col1.x*i+e.col2.x*n,n=e.col1.y*i+e.col2.y*n,i=f,e=m.m_xf.R,r=this.m_localAnchor2.x-m.m_sweep.localCenter.x,o=this.m_localAnchor2.y-m.m_sweep.localCenter.y,f=e.col1.x*r+e.col2.x*o,o=e.col1.y*r+e.col2.y*o,r=f,s=_.m_sweep.c.x+i,a=_.m_sweep.c.y+n,l=m.m_sweep.c.x+r,u=m.m_sweep.c.y+o,this.m_u1.Set(s-g,a-y),this.m_u2.Set(l-A,u-v),c=this.m_u1.Length(),h=this.m_u2.Length(),c>RB.b2_linearSlop?this.m_u1.Multiply(1/c):this.m_u1.SetZero(),h>RB.b2_linearSlop?this.m_u2.Multiply(1/h):this.m_u2.SetZero(),p=this.m_constant-c-this.m_ratio*h,b=zB.Max(b,-p),p=zB.Clamp(p+RB.b2_linearSlop,-RB.b2_maxLinearCorrection,0),s=-(d=-this.m_pulleyMass*p)*this.m_u1.x,a=-d*this.m_u1.y,l=-this.m_ratio*d*this.m_u2.x,u=-this.m_ratio*d*this.m_u2.y,_.m_sweep.c.x+=_.m_invMass*s,_.m_sweep.c.y+=_.m_invMass*a,_.m_sweep.a+=_.m_invI*(i*a-n*s),m.m_sweep.c.x+=m.m_invMass*l,m.m_sweep.c.y+=m.m_invMass*u,m.m_sweep.a+=m.m_invI*(r*u-o*l),_.SynchronizeTransform(),m.SynchronizeTransform()),this.m_limitState1==SM.e_atUpperLimit&&(e=_.m_xf.R,i=this.m_localAnchor1.x-_.m_sweep.localCenter.x,n=this.m_localAnchor1.y-_.m_sweep.localCenter.y,f=e.col1.x*i+e.col2.x*n,n=e.col1.y*i+e.col2.y*n,i=f,s=_.m_sweep.c.x+i,a=_.m_sweep.c.y+n,this.m_u1.Set(s-g,a-y),(c=this.m_u1.Length())>RB.b2_linearSlop?(this.m_u1.x*=1/c,this.m_u1.y*=1/c):this.m_u1.SetZero(),p=this.m_maxLength1-c,b=zB.Max(b,-p),p=zB.Clamp(p+RB.b2_linearSlop,-RB.b2_maxLinearCorrection,0),s=-(d=-this.m_limitMass1*p)*this.m_u1.x,a=-d*this.m_u1.y,_.m_sweep.c.x+=_.m_invMass*s,_.m_sweep.c.y+=_.m_invMass*a,_.m_sweep.a+=_.m_invI*(i*a-n*s),_.SynchronizeTransform()),this.m_limitState2==SM.e_atUpperLimit&&(e=m.m_xf.R,r=this.m_localAnchor2.x-m.m_sweep.localCenter.x,o=this.m_localAnchor2.y-m.m_sweep.localCenter.y,f=e.col1.x*r+e.col2.x*o,o=e.col1.y*r+e.col2.y*o,r=f,l=m.m_sweep.c.x+r,u=m.m_sweep.c.y+o,this.m_u2.Set(l-A,u-v),(h=this.m_u2.Length())>RB.b2_linearSlop?(this.m_u2.x*=1/h,this.m_u2.y*=1/h):this.m_u2.SetZero(),p=this.m_maxLength2-h,b=zB.Max(b,-p),p=zB.Clamp(p+RB.b2_linearSlop,-RB.b2_maxLinearCorrection,0),l=-(d=-this.m_limitMass2*p)*this.m_u2.x,u=-d*this.m_u2.y,m.m_sweep.c.x+=m.m_invMass*l,m.m_sweep.c.y+=m.m_invMass*u,m.m_sweep.a+=m.m_invI*(r*u-o*l),m.SynchronizeTransform()),b<RB.b2_linearSlop},e.b2_minPulleyLength=2,e}(SM),zM=function(t){function e(){var e=t.call(this)||this;return e.groundAnchorA=new GB,e.groundAnchorB=new GB,e.localAnchorA=new GB,e.localAnchorB=new GB,e.type=SM.e_pulleyJoint,e.groundAnchorA.Set(-1,1),e.groundAnchorB.Set(1,1),e.localAnchorA.Set(-1,0),e.localAnchorB.Set(1,0),e.lengthA=0,e.maxLengthA=0,e.lengthB=0,e.maxLengthB=0,e.ratio=1,e.collideConnected=!0,e}return i(e,t),e.prototype.Initialize=function(t,e,i,n,r,o,s){this.bodyA=t,this.bodyB=e,this.groundAnchorA.SetV(i),this.groundAnchorB.SetV(n),this.localAnchorA=this.bodyA.GetLocalPoint(r),this.localAnchorB=this.bodyB.GetLocalPoint(o);var a=r.x-i.x,l=r.y-i.y;this.lengthA=Math.sqrt(a*a+l*l);var u=o.x-n.x,c=o.y-n.y;this.lengthB=Math.sqrt(u*u+c*c),this.ratio=s;var h=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=h-this.ratio*QM.b2_minPulleyLength,this.maxLengthB=(h-QM.b2_minPulleyLength)/this.ratio},e}(DM),HM=function(t){function e(e){var i=t.call(this,e)||this;return i.K=new kB,i.K1=new kB,i.K2=new kB,i.K3=new kB,i.impulse3=new QB,i.impulse2=new GB,i.reduced=new GB,i.m_localAnchor1=new GB,i.m_localAnchor2=new GB,i.m_impulse=new QB,i.m_mass=new VB,i.m_localAnchor1.SetV(e.localAnchorA),i.m_localAnchor2.SetV(e.localAnchorB),i.m_referenceAngle=e.referenceAngle,i.m_impulse.SetZero(),i.m_motorImpulse=0,i.m_lowerAngle=e.lowerAngle,i.m_upperAngle=e.upperAngle,i.m_maxMotorTorque=e.maxMotorTorque,i.m_motorSpeed=e.motorSpeed,i.m_enableLimit=e.enableLimit,i.m_enableMotor=e.enableMotor,i.m_limitState=SM.e_inactiveLimit,i}return i(e,t),e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},e.prototype.GetReactionForce=function(t){return new GB(t*this.m_impulse.x,t*this.m_impulse.y)},e.prototype.GetReactionTorque=function(t){return t*this.m_impulse.z},e.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},e.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},e.prototype.IsLimitEnabled=function(){return this.m_enableLimit},e.prototype.EnableLimit=function(t){this.m_enableLimit=t},e.prototype.GetLowerLimit=function(){return this.m_lowerAngle},e.prototype.GetUpperLimit=function(){return this.m_upperAngle},e.prototype.SetLimits=function(t,e){this.m_lowerAngle=t,this.m_upperAngle=e},e.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},e.prototype.EnableMotor=function(t){this.m_enableMotor=t},e.prototype.SetMotorSpeed=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},e.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},e.prototype.SetMaxMotorTorque=function(t){this.m_maxMotorTorque=t},e.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},e.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB;this.m_enableMotor||this.m_enableLimit,e=n.m_xf.R;var o=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i,e=r.m_xf.R;var a=this.m_localAnchor2.x-r.m_sweep.localCenter.x,l=this.m_localAnchor2.y-r.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var u=n.m_invMass,c=r.m_invMass,h=n.m_invI,p=r.m_invI;if(this.m_mass.col1.x=u+c+s*s*h+l*l*p,this.m_mass.col2.x=-s*o*h-l*a*p,this.m_mass.col3.x=-s*h-l*p,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=u+c+o*o*h+a*a*p,this.m_mass.col3.y=o*h+a*p,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=h+p,this.m_motorMass=1/(h+p),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var d=r.m_sweep.a-n.m_sweep.a-this.m_referenceAngle;zB.Abs(this.m_upperAngle-this.m_lowerAngle)<2*RB.b2_angularSlop?this.m_limitState=SM.e_equalLimits:d<=this.m_lowerAngle?(this.m_limitState!=SM.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=SM.e_atLowerLimit):d>=this.m_upperAngle?(this.m_limitState!=SM.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=SM.e_atUpperLimit):(this.m_limitState=SM.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=SM.e_inactiveLimit;if(t.warmStarting){this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var f=this.m_impulse.x,_=this.m_impulse.y;n.m_linearVelocity.x-=u*f,n.m_linearVelocity.y-=u*_,n.m_angularVelocity-=h*(o*_-s*f+this.m_motorImpulse+this.m_impulse.z),r.m_linearVelocity.x+=c*f,r.m_linearVelocity.y+=c*_,r.m_angularVelocity+=p*(a*_-l*f+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},e.prototype.SolveVelocityConstraints=function(t){var e,i,n,r,o,s,a=this.m_bodyA,l=this.m_bodyB,u=a.m_linearVelocity,c=a.m_angularVelocity,h=l.m_linearVelocity,p=l.m_angularVelocity,d=a.m_invMass,f=l.m_invMass,_=a.m_invI,m=l.m_invI;if(this.m_enableMotor&&this.m_limitState!=SM.e_equalLimits){var g=p-c-this.m_motorSpeed,y=this.m_motorMass*-g,A=this.m_motorImpulse,v=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=zB.Clamp(this.m_motorImpulse+y,-v,v),c-=_*(y=this.m_motorImpulse-A),p+=m*y}if(this.m_enableLimit&&this.m_limitState!=SM.e_inactiveLimit){e=a.m_xf.R,n=this.m_localAnchor1.x-a.m_sweep.localCenter.x,r=this.m_localAnchor1.y-a.m_sweep.localCenter.y,i=e.col1.x*n+e.col2.x*r,r=e.col1.y*n+e.col2.y*r,n=i,e=l.m_xf.R,o=this.m_localAnchor2.x-l.m_sweep.localCenter.x,s=this.m_localAnchor2.y-l.m_sweep.localCenter.y,i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i;var b=h.x+-p*s-u.x- -c*r,x=h.y+p*o-u.y-c*n,C=p-c;this.m_mass.Solve33(this.impulse3,-b,-x,-C),this.m_limitState==SM.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==SM.e_atLowerLimit?this.m_impulse.z+this.impulse3.z<0&&(this.m_mass.Solve22(this.reduced,-b,-x),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0):this.m_limitState==SM.e_atUpperLimit&&this.m_impulse.z+this.impulse3.z>0&&(this.m_mass.Solve22(this.reduced,-b,-x),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0),u.x-=d*this.impulse3.x,u.y-=d*this.impulse3.y,c-=_*(n*this.impulse3.y-r*this.impulse3.x+this.impulse3.z),h.x+=f*this.impulse3.x,h.y+=f*this.impulse3.y,p+=m*(o*this.impulse3.y-s*this.impulse3.x+this.impulse3.z)}else{e=a.m_xf.R,n=this.m_localAnchor1.x-a.m_sweep.localCenter.x,r=this.m_localAnchor1.y-a.m_sweep.localCenter.y,i=e.col1.x*n+e.col2.x*r,r=e.col1.y*n+e.col2.y*r,n=i,e=l.m_xf.R,o=this.m_localAnchor2.x-l.m_sweep.localCenter.x,s=this.m_localAnchor2.y-l.m_sweep.localCenter.y,i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i;var w=h.x+-p*s-u.x- -c*r,I=h.y+p*o-u.y-c*n;this.m_mass.Solve22(this.impulse2,-w,-I),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,u.x-=d*this.impulse2.x,u.y-=d*this.impulse2.y,c-=_*(n*this.impulse2.y-r*this.impulse2.x),h.x+=f*this.impulse2.x,h.y+=f*this.impulse2.y,p+=m*(o*this.impulse2.y-s*this.impulse2.x)}a.m_linearVelocity.SetV(u),a.m_angularVelocity=c,l.m_linearVelocity.SetV(h),l.m_angularVelocity=p},e.prototype.SolvePositionConstraints=function(t){var i,n,r,o,s,a,l=this.m_bodyA,u=this.m_bodyB,c=0;if(this.m_enableLimit&&this.m_limitState!=SM.e_inactiveLimit){var h=u.m_sweep.a-l.m_sweep.a-this.m_referenceAngle,p=0;this.m_limitState==SM.e_equalLimits?(i=zB.Clamp(h-this.m_lowerAngle,-RB.b2_maxAngularCorrection,RB.b2_maxAngularCorrection),p=-this.m_motorMass*i,c=zB.Abs(i)):this.m_limitState==SM.e_atLowerLimit?(c=-(i=h-this.m_lowerAngle),i=zB.Clamp(i+RB.b2_angularSlop,-RB.b2_maxAngularCorrection,0),p=-this.m_motorMass*i):this.m_limitState==SM.e_atUpperLimit&&(c=i=h-this.m_upperAngle,i=zB.Clamp(i-RB.b2_angularSlop,0,RB.b2_maxAngularCorrection),p=-this.m_motorMass*i),l.m_sweep.a-=l.m_invI*p,u.m_sweep.a+=u.m_invI*p,l.SynchronizeTransform(),u.SynchronizeTransform()}n=l.m_xf.R;var d=this.m_localAnchor1.x-l.m_sweep.localCenter.x,f=this.m_localAnchor1.y-l.m_sweep.localCenter.y;o=n.col1.x*d+n.col2.x*f,f=n.col1.y*d+n.col2.y*f,d=o,n=u.m_xf.R;var _=this.m_localAnchor2.x-u.m_sweep.localCenter.x,m=this.m_localAnchor2.y-u.m_sweep.localCenter.y;o=n.col1.x*_+n.col2.x*m,m=n.col1.y*_+n.col2.y*m,_=o;var g=u.m_sweep.c.x+_-l.m_sweep.c.x-d,y=u.m_sweep.c.y+m-l.m_sweep.c.y-f,A=g*g+y*y;r=Math.sqrt(A);var v=l.m_invMass,b=u.m_invMass,x=l.m_invI,C=u.m_invI,w=10*RB.b2_linearSlop;if(A>w*w){var I=1/(v+b);s=I*-g,a=I*-y;l.m_sweep.c.x-=.5*v*s,l.m_sweep.c.y-=.5*v*a,u.m_sweep.c.x+=.5*b*s,u.m_sweep.c.y+=.5*b*a,g=u.m_sweep.c.x+_-l.m_sweep.c.x-d,y=u.m_sweep.c.y+m-l.m_sweep.c.y-f}return this.K1.col1.x=v+b,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=v+b,this.K2.col1.x=x*f*f,this.K2.col2.x=-x*d*f,this.K2.col1.y=-x*d*f,this.K2.col2.y=x*d*d,this.K3.col1.x=C*m*m,this.K3.col2.x=-C*_*m,this.K3.col1.y=-C*_*m,this.K3.col2.y=C*_*_,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(e.tImpulse,-g,-y),s=e.tImpulse.x,a=e.tImpulse.y,l.m_sweep.c.x-=l.m_invMass*s,l.m_sweep.c.y-=l.m_invMass*a,l.m_sweep.a-=l.m_invI*(d*a-f*s),u.m_sweep.c.x+=u.m_invMass*s,u.m_sweep.c.y+=u.m_invMass*a,u.m_sweep.a+=u.m_invI*(_*a-m*s),l.SynchronizeTransform(),u.SynchronizeTransform(),r<=RB.b2_linearSlop&&c<=RB.b2_angularSlop},e.tImpulse=new GB,e}(SM),XM=function(t){function e(){var e=t.call(this)||this;return e.localAnchorA=new GB,e.localAnchorB=new GB,e.type=SM.e_revoluteJoint,e.localAnchorA.Set(0,0),e.localAnchorB.Set(0,0),e.referenceAngle=0,e.lowerAngle=0,e.upperAngle=0,e.maxMotorTorque=0,e.motorSpeed=0,e.enableLimit=!1,e.enableMotor=!1,e}return i(e,t),e.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},e}(DM),qM=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchorA=new GB,i.m_localAnchorB=new GB,i.m_impulse=new QB,i.m_mass=new VB,i.m_localAnchorA.SetV(e.localAnchorA),i.m_localAnchorB.SetV(e.localAnchorB),i.m_referenceAngle=e.referenceAngle,i.m_impulse.SetZero(),i.m_mass=new VB,i}return i(e,t),e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},e.prototype.GetReactionForce=function(t){return new GB(t*this.m_impulse.x,t*this.m_impulse.y)},e.prototype.GetReactionTorque=function(t){return t*this.m_impulse.z},e.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB;e=n.m_xf.R;var o=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i,e=r.m_xf.R;var a=this.m_localAnchorB.x-r.m_sweep.localCenter.x,l=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var u=n.m_invMass,c=r.m_invMass,h=n.m_invI,p=r.m_invI;this.m_mass.col1.x=u+c+s*s*h+l*l*p,this.m_mass.col2.x=-s*o*h-l*a*p,this.m_mass.col3.x=-s*h-l*p,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=u+c+o*o*h+a*a*p,this.m_mass.col3.y=o*h+a*p,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=h+p,t.warmStarting?(this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_impulse.z*=t.dtRatio,n.m_linearVelocity.x-=u*this.m_impulse.x,n.m_linearVelocity.y-=u*this.m_impulse.y,n.m_angularVelocity-=h*(o*this.m_impulse.y-s*this.m_impulse.x+this.m_impulse.z),r.m_linearVelocity.x+=c*this.m_impulse.x,r.m_linearVelocity.y+=c*this.m_impulse.y,r.m_angularVelocity+=p*(a*this.m_impulse.y-l*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},e.prototype.SolveVelocityConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB,o=n.m_linearVelocity,s=n.m_angularVelocity,a=r.m_linearVelocity,l=r.m_angularVelocity,u=n.m_invMass,c=r.m_invMass,h=n.m_invI,p=r.m_invI;e=n.m_xf.R;var d=this.m_localAnchorA.x-n.m_sweep.localCenter.x,f=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*d+e.col2.x*f,f=e.col1.y*d+e.col2.y*f,d=i,e=r.m_xf.R;var _=this.m_localAnchorB.x-r.m_sweep.localCenter.x,m=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*_+e.col2.x*m,m=e.col1.y*_+e.col2.y*m,_=i;var g=a.x-l*m-o.x+s*f,y=a.y+l*_-o.y-s*d,A=l-s,v=new QB;this.m_mass.Solve33(v,-g,-y,-A),this.m_impulse.Add(v),o.x-=u*v.x,o.y-=u*v.y,s-=h*(d*v.y-f*v.x+v.z),a.x+=c*v.x,a.y+=c*v.y,l+=p*(_*v.y-m*v.x+v.z),n.m_angularVelocity=s,r.m_angularVelocity=l},e.prototype.SolvePositionConstraints=function(t){var e,i,n=this.m_bodyA,r=this.m_bodyB;e=n.m_xf.R;var o=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i,e=r.m_xf.R;var a=this.m_localAnchorB.x-r.m_sweep.localCenter.x,l=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var u=n.m_invMass,c=r.m_invMass,h=n.m_invI,p=r.m_invI,d=r.m_sweep.c.x+a-n.m_sweep.c.x-o,f=r.m_sweep.c.y+l-n.m_sweep.c.y-s,_=r.m_sweep.a-n.m_sweep.a-this.m_referenceAngle,m=10*RB.b2_linearSlop,g=Math.sqrt(d*d+f*f),y=zB.Abs(_);g>m&&(h*=1,p*=1),this.m_mass.col1.x=u+c+s*s*h+l*l*p,this.m_mass.col2.x=-s*o*h-l*a*p,this.m_mass.col3.x=-s*h-l*p,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=u+c+o*o*h+a*a*p,this.m_mass.col3.y=o*h+a*p,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=h+p;var A=new QB;return this.m_mass.Solve33(A,-d,-f,-_),n.m_sweep.c.x-=u*A.x,n.m_sweep.c.y-=u*A.y,n.m_sweep.a-=h*(o*A.y-s*A.x+A.z),r.m_sweep.c.x+=c*A.x,r.m_sweep.c.y+=c*A.y,r.m_sweep.a+=p*(a*A.y-l*A.x+A.z),n.SynchronizeTransform(),r.SynchronizeTransform(),g<=RB.b2_linearSlop&&y<=RB.b2_angularSlop},e}(SM),YM=function(t){function e(){var e=t.call(this)||this;return e.localAnchorA=new GB,e.localAnchorB=new GB,e.type=SM.e_weldJoint,e.referenceAngle=0,e}return i(e,t),e.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},e}(DM),KM=function(){function t(){this.__fast__=!0}return t.prototype.Set=function(t){this.dt=t.dt,this.inv_dt=t.inv_dt,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.warmStarting=t.warmStarting},t}(),WM=function(){function t(){this.__fast__=!0,this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1,this.m_drawFlags=0}return t.prototype.SetFlags=function(t){this.m_drawFlags=t},t.prototype.GetFlags=function(){return this.m_drawFlags},t.prototype.AppendFlags=function(t){this.m_drawFlags|=t},t.prototype.ClearFlags=function(t){this.m_drawFlags&=~t},t.prototype.SetSprite=function(t){this.m_sprite=t},t.prototype.GetSprite=function(){return this.m_sprite},t.prototype.SetDrawScale=function(t){this.m_drawScale=t},t.prototype.GetDrawScale=function(){return this.m_drawScale},t.prototype.SetLineThickness=function(t){this.m_lineThickness=t},t.prototype.GetLineThickness=function(){return this.m_lineThickness},t.prototype.SetAlpha=function(t){this.m_alpha=t},t.prototype.GetAlpha=function(){return this.m_alpha},t.prototype.SetFillAlpha=function(t){this.m_fillAlpha=t},t.prototype.GetFillAlpha=function(){return this.m_fillAlpha},t.prototype.SetXFormScale=function(t){this.m_xformScale=t},t.prototype.GetXFormScale=function(){return this.m_xformScale},t.prototype.DrawPolygon=function(t,e,i){this.m_sprite.graphics.lineStyle(this.m_lineThickness,i.color,this.m_alpha),this.m_sprite.graphics.moveTo(t[0].x*this.m_drawScale,t[0].y*this.m_drawScale);for(var n=1;n<e;n++)this.m_sprite.graphics.lineTo(t[n].x*this.m_drawScale,t[n].y*this.m_drawScale);this.m_sprite.graphics.lineTo(t[0].x*this.m_drawScale,t[0].y*this.m_drawScale)},t.prototype.DrawSolidPolygon=function(t,e,i){this.m_sprite.graphics.lineStyle(this.m_lineThickness,i.color,this.m_alpha),this.m_sprite.graphics.moveTo(t[0].x*this.m_drawScale,t[0].y*this.m_drawScale),this.m_sprite.graphics.beginFill(i.color,this.m_fillAlpha);for(var n=1;n<e;n++)this.m_sprite.graphics.lineTo(t[n].x*this.m_drawScale,t[n].y*this.m_drawScale);this.m_sprite.graphics.lineTo(t[0].x*this.m_drawScale,t[0].y*this.m_drawScale),this.m_sprite.graphics.endFill()},t.prototype.DrawCircle=function(t,e,i){this.m_sprite.graphics.lineStyle(this.m_lineThickness,i.color,this.m_alpha),this.m_sprite.graphics.drawCircle(t.x*this.m_drawScale,t.y*this.m_drawScale,e*this.m_drawScale)},t.prototype.DrawSolidCircle=function(t,e,i,n){this.m_sprite.graphics.lineStyle(this.m_lineThickness,n.color,this.m_alpha),this.m_sprite.graphics.moveTo(0,0),this.m_sprite.graphics.beginFill(n.color,this.m_fillAlpha),this.m_sprite.graphics.drawCircle(t.x*this.m_drawScale,t.y*this.m_drawScale,e*this.m_drawScale),this.m_sprite.graphics.endFill(),this.m_sprite.graphics.moveTo(t.x*this.m_drawScale,t.y*this.m_drawScale),this.m_sprite.graphics.lineTo((t.x+i.x*e)*this.m_drawScale,(t.y+i.y*e)*this.m_drawScale)},t.prototype.DrawSegment=function(t,e,i){this.m_sprite.graphics.lineStyle(this.m_lineThickness,i.color,this.m_alpha),this.m_sprite.graphics.moveTo(t.x*this.m_drawScale,t.y*this.m_drawScale),this.m_sprite.graphics.lineTo(e.x*this.m_drawScale,e.y*this.m_drawScale)},t.prototype.DrawTransform=function(t){this.m_sprite.graphics.lineStyle(this.m_lineThickness,16711680,this.m_alpha),this.m_sprite.graphics.moveTo(t.position.x*this.m_drawScale,t.position.y*this.m_drawScale),this.m_sprite.graphics.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*this.m_drawScale,(t.position.y+this.m_xformScale*t.R.col1.y)*this.m_drawScale),this.m_sprite.graphics.lineStyle(this.m_lineThickness,65280,this.m_alpha),this.m_sprite.graphics.moveTo(t.position.x*this.m_drawScale,t.position.y*this.m_drawScale),this.m_sprite.graphics.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*this.m_drawScale,(t.position.y+this.m_xformScale*t.R.col2.y)*this.m_drawScale)},t.e_shapeBit=1,t.e_jointBit=2,t.e_aabbBit=4,t.e_pairBit=8,t.e_centerOfMassBit=16,t.e_controllerBit=32,t}(),JM=function(){function t(){this.__fast__=!0}return t.prototype.SayGoodbyeJoint=function(t){},t.prototype.SayGoodbyeFixture=function(t){},t}(),ZM=function(){function t(){this.__fast__=!0}return t.prototype.BeginContact=function(t){},t.prototype.EndContact=function(t){},t.prototype.PreSolve=function(t,e){},t.prototype.PostSolve=function(t,e){},t.b2_defaultListener=new t,t}(),$M=function(){function t(){this.__fast__=!0}return t.prototype.ShouldCollide=function(t,e){var i=t.GetFilterData(),n=e.GetFilterData();return i.groupIndex==n.groupIndex&&0!=i.groupIndex?i.groupIndex>0:0!=(i.maskBits&n.categoryBits)&&0!=(i.categoryBits&n.maskBits)},t.prototype.RayCollide=function(t,e){return!t||this.ShouldCollide(t,e)},t.b2_defaultFilter=new t,t}(),tO=function(){function t(){var t=this;this.__fast__=!0,this.m_world=null,this.m_contactCount=0,this.m_contactFilter=$M.b2_defaultFilter,this.m_contactListener=ZM.b2_defaultListener,this.m_contactFactory=new uO(this.m_allocator),this.m_broadPhase=new pM,this.AddPairDelegate=function(e,i){return t.AddPair(e,i)}}return t.prototype.AddPair=function(t,e){var i=t,n=e,r=i.GetBody(),o=n.GetBody();if(r!=o){for(var s=o.GetContactList();s;){if(s.other==r){var a=s.contact.GetFixtureA(),l=s.contact.GetFixtureB();if(a==i&&l==n)return;if(a==n&&l==i)return}s=s.next}if(0!=o.ShouldCollide(r)&&0!=this.m_contactFilter.ShouldCollide(i,n)){var u=this.m_contactFactory.Create(i,n);i=u.GetFixtureA(),n=u.GetFixtureB(),r=i.m_body,o=n.m_body,u.m_prev=null,u.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=u),this.m_world.m_contactList=u,u.m_nodeA.contact=u,u.m_nodeA.other=o,u.m_nodeA.prev=null,u.m_nodeA.next=r.m_contactList,null!=r.m_contactList&&(r.m_contactList.prev=u.m_nodeA),r.m_contactList=u.m_nodeA,u.m_nodeB.contact=u,u.m_nodeB.other=r,u.m_nodeB.prev=null,u.m_nodeB.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=u.m_nodeB),o.m_contactList=u.m_nodeB,++this.m_world.m_contactCount}}},t.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(this.AddPairDelegate)},t.prototype.Destroy=function(t){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==r.m_contactList&&(r.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount},t.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();if(0!=n.IsAwake()||0!=r.IsAwake()){if(t.m_flags&sO.e_filterFlag){if(0==r.ShouldCollide(n)){var o=t;t=o.GetNext(),this.Destroy(o);continue}if(0==this.m_contactFilter.ShouldCollide(e,i)){t=(o=t).GetNext(),this.Destroy(o);continue}t.m_flags&=~sO.e_filterFlag}var s=e.m_proxy,a=i.m_proxy;0!=this.m_broadPhase.TestOverlap(s,a)?(t.Update(this.m_contactListener),t=t.GetNext()):(t=(o=t).GetNext(),this.Destroy(o))}else t=t.GetNext()}},t.s_evalCP=new aM,t}();function eO(t,e){if(!t||void 0===t.traits)return t;for(var i=0,n=Object.getOwnPropertyNames(e);i<n.length;i++){var r=n[i];!t[r]&&t["$Bg"+r]&&(t[r]=t["$Bg"+r])}return t}var iO,nO=function(){function t(e,i){this.__fast__=!0,this.s_stack=new Array,this.m_contactManager=new tO,this.m_contactSolver=new hO,this.m_island=new EM,this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,t.m_warmStarting=!0,t.m_continuousPhysics=!0,this.m_allowSleep=i,this.m_gravity=e,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var n=new bM;this.m_groundBody=this.CreateBody(n)}return t.prototype.SetDestructionListener=function(t){this.m_destructionListener=eO(t,JM.prototype)},t.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=eO(t,$M.prototype)},t.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=eO(t,ZM.prototype)},t.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},t.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var i=this.m_bodyList;i;i=i.m_next)for(var n=i.m_fixtureList;n;n=n.m_next)n.m_proxy=t.CreateProxy(e.GetFatAABB(n.m_proxy),n)},t.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},t.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},t.prototype.CreateBody=function(t){if(1==this.IsLocked())return null;var e=new rO(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e},t.prototype.DestroyBody=function(t){if(1!=this.IsLocked()){for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint)}for(var n=t.m_controllerList;n;){var r=n;n=n.nextController,r.controller.RemoveBody(t)}for(var o=t.m_contactList;o;){var s=o;o=o.next,this.m_contactManager.Destroy(s.contact)}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var l=a;a=a.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l),l.DestroyProxy(this.m_contactManager.m_broadPhase),l.Destroy()}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}},t.prototype.CreateJoint=function(t){var e=SM.Create(t,null);e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=null,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=null,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var i=t.bodyA,n=t.bodyB;if(0==t.collideConnected)for(var r=n.GetContactList();r;)r.other==i&&r.contact.FlagForFiltering(),r=r.next;return e},t.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var i=t.m_bodyA,n=t.m_bodyB;if(i.SetAwake(!0),n.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==i.m_jointList&&(i.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==n.m_jointList&&(n.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,SM.Destroy(t,null),--this.m_jointCount,0==e)for(var r=n.GetContactList();r;)r.other==i&&r.contact.FlagForFiltering(),r=r.next},t.prototype.AddController=function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t},t.prototype.RemoveController=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList==t&&(this.m_controllerList=t.m_next),this.m_controllerCount--},t.prototype.CreateController=function(t){if(t.m_world!=this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t},t.prototype.DestroyController=function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t==this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount},t.prototype.SetWarmStarting=function(e){t.m_warmStarting=e},t.prototype.SetContinuousPhysics=function(e){t.m_continuousPhysics=e},t.prototype.GetBodyCount=function(){return this.m_bodyCount},t.prototype.GetJointCount=function(){return this.m_jointCount},t.prototype.GetContactCount=function(){return this.m_contactCount},t.prototype.SetGravity=function(t){this.m_gravity=t},t.prototype.GetGravity=function(){return this.m_gravity},t.prototype.GetGroundBody=function(){return this.m_groundBody},t.prototype.Step=function(e,i,n){this.m_flags&t.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~t.e_newFixture),this.m_flags|=t.e_locked;var r=t.s_timestep2;r.dt=e,r.velocityIterations=i,r.positionIterations=n,r.inv_dt=e>0?1/e:0,r.dtRatio=this.m_inv_dt0*e,r.warmStarting=t.m_warmStarting,this.m_contactManager.Collide(),r.dt>0&&this.Solve(r),t.m_continuousPhysics&&r.dt>0&&this.SolveTOI(r),r.dt>0&&(this.m_inv_dt0=r.inv_dt),this.m_flags&=~t.e_locked},t.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0},t.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var e,i,n,r,o,s,a=this.m_debugDraw.GetFlags(),l=(new GB,new GB,new GB,new tM,new tM,[new GB,new GB,new GB,new GB]),u=new AM(0,0,0);if(a&WM.e_shapeBit)for(e=this.m_bodyList;e;e=e.m_next)for(s=e.m_xf,i=e.GetFixtureList();i;i=i.m_next)n=i.GetShape(),0==e.IsActive()?(u.Set(.5,.5,.3),this.DrawShape(n,s,u)):e.GetType()==rO.b2_staticBody?(u.Set(.5,.9,.5),this.DrawShape(n,s,u)):e.GetType()==rO.b2_kinematicBody?(u.Set(.5,.5,.9),this.DrawShape(n,s,u)):0==e.IsAwake()?(u.Set(.6,.6,.6),this.DrawShape(n,s,u)):(u.Set(.9,.7,.7),this.DrawShape(n,s,u));if(a&WM.e_jointBit)for(r=this.m_jointList;r;r=r.m_next)this.DrawJoint(r);if(a&WM.e_controllerBit)for(var c=this.m_controllerList;c;c=c.m_next)c.Draw(this.m_debugDraw);if(a&WM.e_pairBit){u.Set(.3,.9,.9);for(var h=this.m_contactManager.m_contactList;h;h=h.GetNext()){var p=h.GetFixtureA(),d=h.GetFixtureB(),f=p.GetAABB().GetCenter(),_=d.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(f,_,u)}}if(a&WM.e_aabbBit)for(o=this.m_contactManager.m_broadPhase,l=[new GB,new GB,new GB,new GB],e=this.m_bodyList;e;e=e.GetNext())if(0!=e.IsActive())for(i=e.GetFixtureList();i;i=i.GetNext()){var m=o.GetFatAABB(i.m_proxy);l[0].Set(m.lowerBound.x,m.lowerBound.y),l[1].Set(m.upperBound.x,m.lowerBound.y),l[2].Set(m.upperBound.x,m.upperBound.y),l[3].Set(m.lowerBound.x,m.upperBound.y),this.m_debugDraw.DrawPolygon(l,4,u)}if(a&WM.e_centerOfMassBit)for(e=this.m_bodyList;e;e=e.m_next)(s=t.s_xf).R=e.m_xf.R,s.position=e.GetWorldCenter(),this.m_debugDraw.DrawTransform(s)}},t.prototype.QueryAABB=function(t,e){var i=this.m_contactManager.m_broadPhase;i.Query((function(e){return"function"==typeof t?t(i.GetUserData(e)):t.axApply(null,[i.GetUserData(e)])}),e)},t.prototype.QueryShape=function(t,e,i){void 0===i&&(i=null),null==i&&(i=new jB).SetIdentity();var n=this.m_contactManager.m_broadPhase;var r=new tM;e.ComputeAABB(r,i),n.Query((function(r){var o=n.GetUserData(r);return!KB.TestOverlap(e,i,o.GetShape(),o.GetBody().GetTransform())||t(o)}),r)},t.prototype.QueryPoint=function(t,e){var i=this.m_contactManager.m_broadPhase;var n=new tM;n.lowerBound.Set(e.x-RB.b2_linearSlop,e.y-RB.b2_linearSlop),n.upperBound.Set(e.x+RB.b2_linearSlop,e.y+RB.b2_linearSlop),i.Query((function(n){var r=i.GetUserData(n);return!r.TestPoint(e)||t(r)}),n)},t.prototype.RayCast=function(t,e,i){var n=this.m_contactManager.m_broadPhase,r=new fM;var o=new uM(e,i);n.RayCast((function(o,s){var a=n.GetUserData(s);if(a.RayCast(r,o)){var l=r.fraction,u=new GB((1-l)*e.x+l*i.x,(1-l)*e.y+l*i.y);return t(a,u,r.normal,l)}return o.maxFraction}),o)},t.prototype.RayCastOne=function(t,e){var i;return this.RayCast((function(t,e,n,r){return i=t,r}),t,e),i},t.prototype.RayCastAll=function(t,e){var i=new Array;return this.RayCast((function(t,e,n,r){return i[i.length]=t,1}),t,e),i},t.prototype.GetBodyList=function(){return this.m_bodyList},t.prototype.GetJointList=function(){return this.m_jointList},t.prototype.GetContactList=function(){return this.m_contactList},t.prototype.IsLocked=function(){return(this.m_flags&t.e_locked)>0},t.prototype.Solve=function(t){for(var e,i=this.m_controllerList;i;i=i.m_next)i.Step(t);var n=this.m_island;for(n.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~rO.e_islandFlag;for(var r=this.m_contactList;r;r=r.m_next)r.m_flags&=~sO.e_islandFlag;for(var o=this.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;this.m_bodyCount;for(var s=this.s_stack,a=this.m_bodyList;a;a=a.m_next)if(!(a.m_flags&rO.e_islandFlag)&&0!=a.IsAwake()&&0!=a.IsActive()&&a.GetType()!=rO.b2_staticBody){n.Clear();var l=0;for(s[l++]=a,a.m_flags|=rO.e_islandFlag;l>0;)if(e=s[--l],n.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()!=rO.b2_staticBody){for(var u,c=e.m_contactList;c;c=c.next)c.contact.m_flags&sO.e_islandFlag||1!=c.contact.IsSensor()&&0!=c.contact.IsEnabled()&&0!=c.contact.IsTouching()&&(n.AddContact(c.contact),c.contact.m_flags|=sO.e_islandFlag,(u=c.other).m_flags&rO.e_islandFlag||(s[l++]=u,u.m_flags|=rO.e_islandFlag));for(var h=e.m_jointList;h;h=h.next)1!=h.joint.m_islandFlag&&0!=(u=h.other).IsActive()&&(n.AddJoint(h.joint),h.joint.m_islandFlag=!0,u.m_flags&rO.e_islandFlag||(s[l++]=u,u.m_flags|=rO.e_islandFlag))}n.Solve(t,this.m_gravity,this.m_allowSleep);for(var p=0;p<n.m_bodyCount;++p)(e=n.m_bodies[p]).GetType()==rO.b2_staticBody&&(e.m_flags&=~rO.e_islandFlag)}for(p=0;p<s.length&&s[p];++p)s[p]=null;for(e=this.m_bodyList;e;e=e.m_next)0!=e.IsAwake()&&0!=e.IsActive()&&e.GetType()!=rO.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},t.prototype.SolveTOI=function(e){var i,n,r,o,s,a,l,u=this.m_island;u.Initialize(this.m_bodyCount,RB.b2_maxTOIContactsPerIsland,RB.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var c,h=t.s_queue;for(i=this.m_bodyList;i;i=i.m_next)i.m_flags&=~rO.e_islandFlag,i.m_sweep.t0=0;for(c=this.m_contactList;c;c=c.m_next)c.m_flags&=~(sO.e_toiFlag|sO.e_islandFlag);for(l=this.m_jointList;l;l=l.m_next)l.m_islandFlag=!1;for(;;){var p=null,d=1;for(c=this.m_contactList;c;c=c.m_next)if(1!=c.IsSensor()&&0!=c.IsEnabled()&&0!=c.IsContinuous()){var f=1;if(c.m_flags&sO.e_toiFlag)f=c.m_toi;else{if(n=c.m_fixtureA,r=c.m_fixtureB,o=n.m_body,s=r.m_body,!(o.GetType()==rO.b2_dynamicBody&&0!=o.IsAwake()||s.GetType()==rO.b2_dynamicBody&&0!=s.IsAwake()))continue;var _=o.m_sweep.t0;o.m_sweep.t0<s.m_sweep.t0?(_=s.m_sweep.t0,o.m_sweep.Advance(_)):s.m_sweep.t0<o.m_sweep.t0&&(_=o.m_sweep.t0,s.m_sweep.Advance(_)),f=c.ComputeTOI(o.m_sweep,s.m_sweep),RB.b2Assert(0<=f&&f<=1),f>0&&f<1&&(f=(1-f)*_+f)>1&&(f=1),c.m_toi=f,c.m_flags|=sO.e_toiFlag}Number.MIN_VALUE<f&&f<d&&(p=c,d=f)}if(null==p||1-100*Number.MIN_VALUE<d)break;if(n=p.m_fixtureA,r=p.m_fixtureB,o=n.m_body,s=r.m_body,t.s_backupA.Set(o.m_sweep),t.s_backupB.Set(s.m_sweep),o.Advance(d),s.Advance(d),p.Update(this.m_contactManager.m_contactListener),p.m_flags&=~sO.e_toiFlag,1!=p.IsSensor()&&0!=p.IsEnabled()){if(0!=p.IsTouching()){var m=o;m.GetType()!=rO.b2_dynamicBody&&(m=s),u.Clear();var g=0,y=0;for(h[g+y++]=m,m.m_flags|=rO.e_islandFlag;y>0;)if(i=h[g++],--y,u.AddBody(i),0==i.IsAwake()&&i.SetAwake(!0),i.GetType()==rO.b2_dynamicBody){for(a=i.m_contactList;a&&u.m_contactCount!=u.m_contactCapacity;a=a.next)if(!(a.contact.m_flags&sO.e_islandFlag)&&1!=a.contact.IsSensor()&&0!=a.contact.IsEnabled()&&0!=a.contact.IsTouching()){u.AddContact(a.contact),a.contact.m_flags|=sO.e_islandFlag;var A=a.other;A.m_flags&rO.e_islandFlag||(A.GetType()!=rO.b2_staticBody&&(A.Advance(d),A.SetAwake(!0)),h[g+y]=A,++y,A.m_flags|=rO.e_islandFlag)}for(var v=i.m_jointList;v;v=v.next)u.m_jointCount!=u.m_jointCapacity&&1!=v.joint.m_islandFlag&&0!=(A=v.other).IsActive()&&(u.AddJoint(v.joint),v.joint.m_islandFlag=!0,A.m_flags&rO.e_islandFlag||(A.GetType()!=rO.b2_staticBody&&(A.Advance(d),A.SetAwake(!0)),h[g+y]=A,++y,A.m_flags|=rO.e_islandFlag))}var b,x=t.s_timestep;for(x.warmStarting=!1,x.dt=(1-d)*e.dt,x.inv_dt=1/x.dt,x.dtRatio=0,x.velocityIterations=e.velocityIterations,x.positionIterations=e.positionIterations,u.SolveTOI(x),b=0;b<u.m_bodyCount;++b)if((i=u.m_bodies[b]).m_flags&=~rO.e_islandFlag,0!=i.IsAwake()&&i.GetType()==rO.b2_dynamicBody)for(i.SynchronizeFixtures(),a=i.m_contactList;a;a=a.next)a.contact.m_flags&=~sO.e_toiFlag;for(b=0;b<u.m_contactCount;++b)(c=u.m_contacts[b]).m_flags&=~(sO.e_toiFlag|sO.e_islandFlag);for(b=0;b<u.m_jointCount;++b)(l=u.m_joints[b]).m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else o.m_sweep.Set(t.s_backupA),s.m_sweep.Set(t.s_backupB),o.SynchronizeTransform(),s.SynchronizeTransform()}},t.prototype.DrawJoint=function(e){var i=e.GetBodyA(),n=e.GetBodyB(),r=i.m_xf,o=n.m_xf,s=r.position,a=o.position,l=e.GetAnchorA(),u=e.GetAnchorB(),c=t.s_jointColor;switch(e.m_type){case SM.e_distanceJoint:this.m_debugDraw.DrawSegment(l,u,c);break;case SM.e_pulleyJoint:var h=e,p=h.GetGroundAnchorA(),d=h.GetGroundAnchorB();this.m_debugDraw.DrawSegment(p,l,c),this.m_debugDraw.DrawSegment(d,u,c),this.m_debugDraw.DrawSegment(p,d,c);break;case SM.e_mouseJoint:this.m_debugDraw.DrawSegment(l,u,c);break;default:i!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,l,c),this.m_debugDraw.DrawSegment(l,u,c),n!=this.m_groundBody&&this.m_debugDraw.DrawSegment(a,u,c)}},t.prototype.DrawShape=function(t,e,i){switch(t.m_type){case KB.e_circleShape:var n=t,r=zB.MulX(e,n.m_p),o=n.m_radius,s=e.R.col1;this.m_debugDraw.DrawSolidCircle(r,o,s,i);break;case KB.e_polygonShape:var a=void 0,l=t,u=l.GetVertexCount(),c=l.GetVertices(),h=new Array(u);for(a=0;a<u;++a)h[a]=zB.MulX(e,c[a]);this.m_debugDraw.DrawSolidPolygon(h,u,i);break;case KB.e_edgeShape:var p=t;this.m_debugDraw.DrawSegment(zB.MulX(e,p.GetVertex1()),zB.MulX(e,p.GetVertex2()),i)}},t.s_timestep2=new KM,t.s_xf=new jB,t.s_backupA=new UB,t.s_backupB=new UB,t.s_timestep=new KM,t.s_queue=new Array,t.s_jointColor=new AM(.5,.8,.8),t.e_newFixture=1,t.e_locked=2,t}(),rO=function(){function t(e,i){this.__fast__=!0,this.m_xf=new jB,this.m_sweep=new UB,this.m_linearVelocity=new GB,this.m_force=new GB,this.m_flags=0,e.bullet&&(this.m_flags|=t.e_bulletFlag),e.fixedRotation&&(this.m_flags|=t.e_fixedRotationFlag),e.allowSleep&&(this.m_flags|=t.e_allowSleepFlag),e.awake&&(this.m_flags|=t.e_awakeFlag),e.active&&(this.m_flags|=t.e_activeFlag),this.m_world=i,this.m_xf.position.SetV(e.position),this.m_xf.R.Set(e.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=e.angle;var n=this.m_xf.R,r=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*r.x+n.col2.x*r.y,this.m_sweep.c.y=n.col1.y*r.x+n.col2.y*r.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=e.type,this.m_type==t.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=e.inertiaScale,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0}return t.prototype.connectEdges=function(t,e,i){var n=Math.atan2(e.GetDirectionVector().y,e.GetDirectionVector().x),r=Math.tan(.5*(n-i)),o=zB.MulFV(r,e.GetDirectionVector());o=zB.SubtractVV(o,e.GetNormalVector()),o=zB.MulFV(RB.b2_toiSlop,o),o=zB.AddVV(o,e.GetVertex1());var s=zB.AddVV(t.GetDirectionVector(),e.GetDirectionVector());s.Normalize();var a=zB.Dot(t.GetDirectionVector(),e.GetNormalVector())>0;return t.SetNextEdge(e,o,s,a),e.SetPrevEdge(t,o,s,a),n},t.prototype.CreateFixture=function(e){if(1==this.m_world.IsLocked())return null;var i=new CM;if(i.Create(this,this.m_xf,e),this.m_flags&t.e_activeFlag){var n=this.m_world.m_contactManager.m_broadPhase;i.CreateProxy(n,this.m_xf)}return i.m_next=this.m_fixtureList,this.m_fixtureList=i,++this.m_fixtureCount,i.m_body=this,i.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=nO.e_newFixture,i},t.prototype.CreateFixture2=function(t,e){void 0===e&&(e=0);var i=new wM;return i.shape=t,i.density=e,this.CreateFixture(i)},t.prototype.DestroyFixture=function(e){if(1!=this.m_world.IsLocked()){for(var i=this.m_fixtureList,n=null;null!=i;){if(i==e){n?n.m_next=e.m_next:this.m_fixtureList=e.m_next;break}n=i,i=i.m_next}for(var r=this.m_contactList;r;){var o=r.contact;r=r.next;var s=o.GetFixtureA(),a=o.GetFixtureB();e!=s&&e!=a||this.m_world.m_contactManager.Destroy(o)}if(this.m_flags&t.e_activeFlag){var l=this.m_world.m_contactManager.m_broadPhase;e.DestroyProxy(l)}e.Destroy(),e.m_body=null,e.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},t.prototype.SetPositionAndAngle=function(t,e){var i;if(1!=this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var n=this.m_xf.R,r=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*r.x+n.col2.x*r.y,this.m_sweep.c.y=n.col1.y*r.x+n.col2.y*r.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;var o=this.m_world.m_contactManager.m_broadPhase;for(i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(o,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},t.prototype.SetTransform=function(t){this.SetPositionAndAngle(t.position,t.GetAngle())},t.prototype.GetTransform=function(){return this.m_xf},t.prototype.GetPosition=function(){return this.m_xf.position},t.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())},t.prototype.GetAngle=function(){return this.m_sweep.a},t.prototype.SetAngle=function(t){this.SetPositionAndAngle(this.GetPosition(),t)},t.prototype.GetWorldCenter=function(){return this.m_sweep.c},t.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},t.prototype.SetLinearVelocity=function(e){this.m_type!=t.b2_staticBody&&this.m_linearVelocity.SetV(e)},t.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},t.prototype.SetAngularVelocity=function(e){this.m_type!=t.b2_staticBody&&(this.m_angularVelocity=e)},t.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},t.prototype.GetDefinition=function(){var e=new bM;return e.type=this.GetType(),e.allowSleep=(this.m_flags&t.e_allowSleepFlag)==t.e_allowSleepFlag,e.angle=this.GetAngle(),e.angularDamping=this.m_angularDamping,e.angularVelocity=this.m_angularVelocity,e.fixedRotation=(this.m_flags&t.e_fixedRotationFlag)==t.e_fixedRotationFlag,e.bullet=(this.m_flags&t.e_bulletFlag)==t.e_bulletFlag,e.awake=(this.m_flags&t.e_awakeFlag)==t.e_awakeFlag,e.linearDamping=this.m_linearDamping,e.linearVelocity.SetV(this.GetLinearVelocity()),e.position=this.GetPosition(),e.userData=this.GetUserData(),e},t.prototype.ApplyForce=function(e,i){this.m_type==t.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=e.x,this.m_force.y+=e.y,this.m_torque+=(i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x)},t.prototype.ApplyTorque=function(e){this.m_type==t.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=e)},t.prototype.ApplyImpulse=function(e,i){this.m_type==t.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y,this.m_angularVelocity+=this.m_invI*((i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x))},t.prototype.Split=function(t){for(var e,i=this.GetLinearVelocity().Copy(),n=this.GetAngularVelocity(),r=this.GetWorldCenter(),o=this.m_world.CreateBody(this.GetDefinition()),s=this.m_fixtureList;s;)if(t(s)){var a=s.m_next;e?e.m_next=a:this.m_fixtureList=a,this.m_fixtureCount--,s.m_next=o.m_fixtureList,o.m_fixtureList=s,o.m_fixtureCount++,s.m_body=o,s=a}else e=s,s=s.m_next;this.ResetMassData(),o.ResetMassData();var l=this.GetWorldCenter(),u=o.GetWorldCenter(),c=zB.AddVV(i,zB.CrossFV(n,zB.SubtractVV(l,r))),h=zB.AddVV(i,zB.CrossFV(n,zB.SubtractVV(u,r)));return this.SetLinearVelocity(c),o.SetLinearVelocity(h),this.SetAngularVelocity(n),o.SetAngularVelocity(n),this.SynchronizeFixtures(),o.SynchronizeFixtures(),o},t.prototype.Merge=function(t){var e;for(e=t.m_fixtureList;e;){var i=e.m_next;t.m_fixtureCount--,e.m_next=this.m_fixtureList,this.m_fixtureList=e,this.m_fixtureCount++,e.m_body=r,e=i}n.m_fixtureCount=0;var n=this,r=t;n.GetWorldCenter(),r.GetWorldCenter(),n.GetLinearVelocity().Copy(),r.GetLinearVelocity().Copy(),n.GetAngularVelocity(),r.GetAngularVelocity();n.ResetMassData(),this.SynchronizeFixtures()},t.prototype.GetMass=function(){return this.m_mass},t.prototype.GetInertia=function(){return this.m_I},t.prototype.GetMassData=function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)},t.prototype.SetMassData=function(e){if(RB.b2Assert(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==t.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&t.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(zB.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}},t.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!=t.b2_staticBody&&this.m_type!=t.b2_kinematicBody){for(var e=GB.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!=i.m_density){var n=i.GetMassData();this.m_mass+=n.mass,e.x+=n.center.x*n.mass,e.y+=n.center.y*n.mass,this.m_I+=n.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&t.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,RB.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var r=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(zB.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-r.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-r.x)}},t.prototype.GetWorldPoint=function(t){var e=this.m_xf.R,i=new GB(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i},t.prototype.GetWorldVector=function(t){return zB.MulMV(this.m_xf.R,t)},t.prototype.GetLocalPoint=function(t){return zB.MulXT(this.m_xf,t)},t.prototype.GetLocalVector=function(t){return zB.MulTMV(this.m_xf.R,t)},t.prototype.GetLinearVelocityFromWorldPoint=function(t){return new GB(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))},t.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R,i=new GB(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new GB(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))},t.prototype.GetLinearDamping=function(){return this.m_linearDamping},t.prototype.SetLinearDamping=function(t){this.m_linearDamping=t},t.prototype.GetAngularDamping=function(){return this.m_angularDamping},t.prototype.SetAngularDamping=function(t){this.m_angularDamping=t},t.prototype.SetType=function(e){if(this.m_type!=e){this.m_type=e,this.ResetMassData(),this.m_type==t.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var i=this.m_contactList;i;i=i.next)i.contact.FlagForFiltering()}},t.prototype.GetType=function(){return this.m_type},t.prototype.SetBullet=function(e){e?this.m_flags|=t.e_bulletFlag:this.m_flags&=~t.e_bulletFlag},t.prototype.IsBullet=function(){return(this.m_flags&t.e_bulletFlag)==t.e_bulletFlag},t.prototype.SetSleepingAllowed=function(e){e?this.m_flags|=t.e_allowSleepFlag:(this.m_flags&=~t.e_allowSleepFlag,this.SetAwake(!0))},t.prototype.SetAwake=function(e){e?(this.m_flags|=t.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~t.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},t.prototype.IsAwake=function(){return(this.m_flags&t.e_awakeFlag)==t.e_awakeFlag},t.prototype.SetFixedRotation=function(e){e?this.m_flags|=t.e_fixedRotationFlag:this.m_flags&=~t.e_fixedRotationFlag,this.ResetMassData()},t.prototype.IsFixedRotation=function(){return(this.m_flags&t.e_fixedRotationFlag)==t.e_fixedRotationFlag},t.prototype.SetActive=function(e){var i,n;if(e!=this.IsActive())if(e)for(this.m_flags|=t.e_activeFlag,i=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.CreateProxy(i,this.m_xf);else{for(this.m_flags&=~t.e_activeFlag,i=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.DestroyProxy(i);for(var r=this.m_contactList;r;){var o=r;r=r.next,this.m_world.m_contactManager.Destroy(o.contact)}this.m_contactList=null}},t.prototype.IsActive=function(){return(this.m_flags&t.e_activeFlag)==t.e_activeFlag},t.prototype.IsSleepingAllowed=function(){return(this.m_flags&t.e_allowSleepFlag)==t.e_allowSleepFlag},t.prototype.GetFixtureList=function(){return this.m_fixtureList},t.prototype.GetJointList=function(){return this.m_jointList},t.prototype.GetControllerList=function(){return this.m_controllerList},t.prototype.GetContactList=function(){return this.m_contactList},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.prototype.GetWorld=function(){return this.m_world},t.prototype.SynchronizeFixtures=function(){var e=t.s_xf1;e.R.Set(this.m_sweep.a0);var i,n=e.R,r=this.m_sweep.localCenter;e.position.x=this.m_sweep.c0.x-(n.col1.x*r.x+n.col2.x*r.y),e.position.y=this.m_sweep.c0.y-(n.col1.y*r.x+n.col2.y*r.y);var o=this.m_world.m_contactManager.m_broadPhase;for(i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(o,e,this.m_xf)},t.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)},t.prototype.ShouldCollide=function(e){if(this.m_type!=t.b2_dynamicBody&&e.m_type!=t.b2_dynamicBody)return!1;for(var i=this.m_jointList;i;i=i.next)if(i.other==e&&0==i.joint.m_collideConnected)return!1;return!0},t.prototype.Advance=function(t){this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},t.s_xf1=new jB,t.e_islandFlag=1,t.e_awakeFlag=2,t.e_allowSleepFlag=4,t.e_bulletFlag=8,t.e_fixedRotationFlag=16,t.e_activeFlag=32,t.b2_staticBody=0,t.b2_kinematicBody=1,t.b2_dynamicBody=2,t}(),oO=function(){},sO=function(){function t(){this.__fast__=!0,this.m_nodeA=new oO,this.m_nodeB=new oO,this.m_manifold=new oM,this.m_oldManifold=new oM}return t.prototype.GetManifold=function(){return this.m_manifold},t.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),r=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),n.m_radius,i.GetTransform(),r.m_radius)},t.prototype.IsTouching=function(){return(this.m_flags&t.e_touchingFlag)==t.e_touchingFlag},t.prototype.IsContinuous=function(){return(this.m_flags&t.e_continuousFlag)==t.e_continuousFlag},t.prototype.SetSensor=function(e){e?this.m_flags|=t.e_sensorFlag:this.m_flags&=~t.e_sensorFlag},t.prototype.IsSensor=function(){return(this.m_flags&t.e_sensorFlag)==t.e_sensorFlag},t.prototype.SetEnabled=function(e){e?this.m_flags|=t.e_enabledFlag:this.m_flags&=~t.e_enabledFlag},t.prototype.IsEnabled=function(){return(this.m_flags&t.e_enabledFlag)==t.e_enabledFlag},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetFixtureA=function(){return this.m_fixtureA},t.prototype.GetFixtureB=function(){return this.m_fixtureB},t.prototype.FlagForFiltering=function(){this.m_flags|=t.e_filterFlag},t.prototype.Reset=function(e,i){if(this.m_flags=t.e_enabledFlag,!e||!i)return this.m_fixtureA=null,void(this.m_fixtureB=null);(e.IsSensor()||i.IsSensor())&&(this.m_flags|=t.e_sensorFlag);var n=e.GetBody(),r=i.GetBody();(n.GetType()!=rO.b2_dynamicBody||n.IsBullet()||r.GetType()!=rO.b2_dynamicBody||r.IsBullet())&&(this.m_flags|=t.e_continuousFlag),this.m_fixtureA=e,this.m_fixtureB=i,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},t.prototype.Update=function(e){var i=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=i,this.m_flags|=t.e_enabledFlag;var n=!1,r=(this.m_flags&t.e_touchingFlag)==t.e_touchingFlag,o=this.m_fixtureA.m_body,s=this.m_fixtureB.m_body,a=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&t.e_sensorFlag){if(a){var l=this.m_fixtureA.GetShape(),u=this.m_fixtureB.GetShape(),c=o.GetTransform(),h=s.GetTransform();n=KB.TestOverlap(l,c,u,h)}this.m_manifold.m_pointCount=0}else{if(o.GetType()!=rO.b2_dynamicBody||o.IsBullet()||s.GetType()!=rO.b2_dynamicBody||s.IsBullet()?this.m_flags|=t.e_continuousFlag:this.m_flags&=~t.e_continuousFlag,a){this.Evaluate(),n=this.m_manifold.m_pointCount>0;for(var p=0;p<this.m_manifold.m_pointCount;++p){var d=this.m_manifold.m_points[p];d.m_normalImpulse=0,d.m_tangentImpulse=0;for(var f=d.m_id,_=0;_<this.m_oldManifold.m_pointCount;++_){var m=this.m_oldManifold.m_points[_];if(m.m_id.key==f.key){d.m_normalImpulse=m.m_normalImpulse,d.m_tangentImpulse=m.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;n!=r&&(o.SetAwake(!0),s.SetAwake(!0))}n?this.m_flags|=t.e_touchingFlag:this.m_flags&=~t.e_touchingFlag,0==r&&1==n&&e.BeginContact(this),1==r&&0==n&&e.EndContact(this),0==(this.m_flags&t.e_sensorFlag)&&e.PreSolve(this,this.m_oldManifold)},t.prototype.Evaluate=function(){},t.prototype.ComputeTOI=function(e,i){return t.s_input.proxyA.Set(this.m_fixtureA.GetShape()),t.s_input.proxyB.Set(this.m_fixtureB.GetShape()),t.s_input.sweepA=e,t.s_input.sweepB=i,t.s_input.tolerance=RB.b2_linearSlop,mM.TimeOfImpact(t.s_input)},t.e_sensorFlag=1,t.e_continuousFlag=2,t.e_islandFlag=4,t.e_toiFlag=8,t.e_touchingFlag=16,t.e_enabledFlag=32,t.e_filterFlag=64,t.s_input=new gM,t}(),aO=function(){this.localPlaneNormal=new GB,this.localPoint=new GB,this.normal=new GB,this.normalMass=new kB,this.K=new kB,this.points=new Array(RB.b2_maxManifoldPoints);for(var t=0;t<RB.b2_maxManifoldPoints;t++)this.points[t]=new lO},lO=function(){this.localPoint=new GB,this.rA=new GB,this.rB=new GB},uO=function(){function t(t){this.m_allocator=t,this.InitializeRegisters()}return t.prototype.AddType=function(t,e,i,n){this.m_registers[i][n].createFcn=t,this.m_registers[i][n].destroyFcn=e,this.m_registers[i][n].primary=!0,i!=n&&(this.m_registers[n][i].createFcn=t,this.m_registers[n][i].destroyFcn=e,this.m_registers[n][i].primary=!1)},t.prototype.InitializeRegisters=function(){this.m_registers=new Array(KB.e_shapeTypeCount);for(var t=0;t<KB.e_shapeTypeCount;t++){this.m_registers[t]=new Array(KB.e_shapeTypeCount);for(var e=0;e<KB.e_shapeTypeCount;e++)this.m_registers[t][e]=new cO}this.AddType(mO.Create,mO.Destroy,KB.e_circleShape,KB.e_circleShape),this.AddType(dO.Create,dO.Destroy,KB.e_polygonShape,KB.e_circleShape),this.AddType(_O.Create,_O.Destroy,KB.e_polygonShape,KB.e_polygonShape),this.AddType(pO.Create,pO.Destroy,KB.e_edgeShape,KB.e_circleShape),this.AddType(fO.Create,fO.Destroy,KB.e_polygonShape,KB.e_edgeShape)},t.prototype.Create=function(t,e){var i,n=t.GetType(),r=e.GetType(),o=this.m_registers[n][r];if(o.pool)return i=o.pool,o.pool=i.m_next,o.poolCount--,i.Reset(t,e),i;var s=o.createFcn;return null!=s?o.primary?((i=s(this.m_allocator)).Reset(t,e),i):((i=s(this.m_allocator)).Reset(e,t),i):null},t.prototype.Destroy=function(t){t.m_manifold.m_pointCount>0&&(t.m_fixtureA.m_body.SetAwake(!0),t.m_fixtureB.m_body.SetAwake(!0));var e=t.m_fixtureA.GetType(),i=t.m_fixtureB.GetType(),n=this.m_registers[e][i];n.poolCount++,t.m_next=n.pool,n.pool=t,(0,n.destroyFcn)(t,this.m_allocator)},t}(),cO=function(){},hO=function(){function t(){this.m_step=new KM,this.m_constraints=new Array}return t.prototype.Initialize=function(e,i,n,r){var o,s;for(this.m_step.Set(e),this.m_allocator=r,this.m_constraintCount=n;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new aO;for(s=0;s<n;++s){var a=(o=i[s]).m_fixtureA,l=o.m_fixtureB,u=a.m_shape,c=l.m_shape,h=u.m_radius,p=c.m_radius,d=a.m_body,f=l.m_body,_=o.GetManifold(),m=RB.b2MixFriction(a.GetFriction(),l.GetFriction()),g=RB.b2MixRestitution(a.GetRestitution(),l.GetRestitution()),y=d.m_linearVelocity.x,A=d.m_linearVelocity.y,v=f.m_linearVelocity.x,b=f.m_linearVelocity.y,x=d.m_angularVelocity,C=f.m_angularVelocity;RB.b2Assert(_.m_pointCount>0),t.s_worldManifold.Initialize(_,d.m_xf,h,f.m_xf,p);var w=t.s_worldManifold.m_normal.x,I=t.s_worldManifold.m_normal.y,E=this.m_constraints[s];E.bodyA=d,E.bodyB=f,E.manifold=_,E.normal.x=w,E.normal.y=I,E.pointCount=_.m_pointCount,E.friction=m,E.restitution=g,E.localPlaneNormal.x=_.m_localPlaneNormal.x,E.localPlaneNormal.y=_.m_localPlaneNormal.y,E.localPoint.x=_.m_localPoint.x,E.localPoint.y=_.m_localPoint.y,E.radius=h+p,E.type=_.m_type;for(var S=0;S<E.pointCount;++S){var D=_.m_points[S],T=E.points[S];T.normalImpulse=D.m_normalImpulse,T.tangentImpulse=D.m_tangentImpulse,T.localPoint.SetV(D.m_localPoint);var P=T.rA.x=t.s_worldManifold.m_points[S].x-d.m_sweep.c.x,B=T.rA.y=t.s_worldManifold.m_points[S].y-d.m_sweep.c.y,M=T.rB.x=t.s_worldManifold.m_points[S].x-f.m_sweep.c.x,O=T.rB.y=t.s_worldManifold.m_points[S].y-f.m_sweep.c.y,L=P*I-B*w,R=M*I-O*w;L*=L,R*=R;var N=d.m_invMass+f.m_invMass+d.m_invI*L+f.m_invI*R;T.normalMass=1/N;var F=d.m_mass*d.m_invMass+f.m_mass*f.m_invMass;F+=d.m_mass*d.m_invI*L+f.m_mass*f.m_invI*R,T.equalizedMass=1/F;var k=-w,V=P*k-B*I,U=M*k-O*I;V*=V,U*=U;var j=d.m_invMass+f.m_invMass+d.m_invI*V+f.m_invI*U;T.tangentMass=1/j,T.velocityBias=0;var G=v+-C*O-y- -x*B,Q=b+C*M-A-x*P,z=E.normal.x*G+E.normal.y*Q;z<-RB.b2_velocityThreshold&&(T.velocityBias+=-E.restitution*z)}if(2==E.pointCount){var H=E.points[0],X=E.points[1],q=d.m_invMass,Y=d.m_invI,K=f.m_invMass,W=f.m_invI,J=H.rA.x*I-H.rA.y*w,Z=H.rB.x*I-H.rB.y*w,$=X.rA.x*I-X.rA.y*w,tt=X.rB.x*I-X.rB.y*w,et=q+K+Y*J*J+W*Z*Z,it=q+K+Y*$*$+W*tt*tt,nt=q+K+Y*J*$+W*Z*tt;et*et<100*(et*it-nt*nt)?(E.K.col1.Set(et,nt),E.K.col2.Set(nt,it),E.K.GetInverse(E.normalMass)):E.pointCount=1}}},t.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_constraintCount;++e){var i,n,r=this.m_constraints[e],o=r.bodyA,s=r.bodyB,a=o.m_invMass,l=o.m_invI,u=s.m_invMass,c=s.m_invI,h=r.normal.x,p=r.normal.y,d=p,f=-h;if(t.warmStarting)for(n=r.pointCount,i=0;i<n;++i){var _=r.points[i];_.normalImpulse*=t.dtRatio,_.tangentImpulse*=t.dtRatio;var m=_.normalImpulse*h+_.tangentImpulse*d,g=_.normalImpulse*p+_.tangentImpulse*f;o.m_angularVelocity-=l*(_.rA.x*g-_.rA.y*m),o.m_linearVelocity.x-=a*m,o.m_linearVelocity.y-=a*g,s.m_angularVelocity+=c*(_.rB.x*g-_.rB.y*m),s.m_linearVelocity.x+=u*m,s.m_linearVelocity.y+=u*g}else for(n=r.pointCount,i=0;i<n;++i){var y=r.points[i];y.normalImpulse=0,y.tangentImpulse=0}}},t.prototype.SolveVelocityConstraints=function(){for(var t,e,i,n,r,o,s,a,l,u,c,h,p,d,f,_,m=0;m<this.m_constraintCount;++m){var g=this.m_constraints[m],y=g.bodyA,A=g.bodyB,v=y.m_angularVelocity,b=A.m_angularVelocity,x=y.m_linearVelocity,C=A.m_linearVelocity,w=y.m_invMass,I=y.m_invI,E=A.m_invMass,S=A.m_invI,D=g.normal.x,T=g.normal.y,P=T,B=-D,M=g.friction;for(t=0;t<g.pointCount;t++)e=g.points[t],n=(C.x-b*e.rB.y-x.x+v*e.rA.y)*P+(C.y+b*e.rB.x-x.y-v*e.rA.x)*B,r=e.tangentMass*-n,o=M*e.normalImpulse,a=(r=(s=zB.Clamp(e.tangentImpulse+r,-o,o))-e.tangentImpulse)*P,l=r*B,x.x-=w*a,x.y-=w*l,v-=I*(e.rA.x*l-e.rA.y*a),C.x+=E*a,C.y+=E*l,b+=S*(e.rB.x*l-e.rB.y*a),e.tangentImpulse=s;g.pointCount;if(1==g.pointCount)e=g.points[0],i=(C.x+-b*e.rB.y-x.x- -v*e.rA.y)*D+(C.y+b*e.rB.x-x.y-v*e.rA.x)*T,r=-e.normalMass*(i-e.velocityBias),a=(r=(s=(s=e.normalImpulse+r)>0?s:0)-e.normalImpulse)*D,l=r*T,x.x-=w*a,x.y-=w*l,v-=I*(e.rA.x*l-e.rA.y*a),C.x+=E*a,C.y+=E*l,b+=S*(e.rB.x*l-e.rB.y*a),e.normalImpulse=s;else{var O=g.points[0],L=g.points[1],R=O.normalImpulse,N=L.normalImpulse,F=(C.x-b*O.rB.y-x.x+v*O.rA.y)*D+(C.y+b*O.rB.x-x.y-v*O.rA.x)*T,k=(C.x-b*L.rB.y-x.x+v*L.rA.y)*D+(C.y+b*L.rB.x-x.y-v*L.rA.x)*T,V=F-O.velocityBias,U=k-L.velocityBias;for(V-=(_=g.K).col1.x*R+_.col2.x*N,U-=_.col1.y*R+_.col2.y*N;;){var j=-((_=g.normalMass).col1.x*V+_.col2.x*U),G=-(_.col1.y*V+_.col2.y*U);if(j>=0&&G>=0){h=(u=j-R)*D,p=u*T,d=(c=G-N)*D,f=c*T,x.x-=w*(h+d),x.y-=w*(p+f),v-=I*(O.rA.x*p-O.rA.y*h+L.rA.x*f-L.rA.y*d),C.x+=E*(h+d),C.y+=E*(p+f),b+=S*(O.rB.x*p-O.rB.y*h+L.rB.x*f-L.rB.y*d),O.normalImpulse=j,L.normalImpulse=G;break}if(j=-O.normalMass*V,G=0,F=0,k=g.K.col1.y*j+U,j>=0&&k>=0){h=(u=j-R)*D,p=u*T,d=(c=G-N)*D,f=c*T,x.x-=w*(h+d),x.y-=w*(p+f),v-=I*(O.rA.x*p-O.rA.y*h+L.rA.x*f-L.rA.y*d),C.x+=E*(h+d),C.y+=E*(p+f),b+=S*(O.rB.x*p-O.rB.y*h+L.rB.x*f-L.rB.y*d),O.normalImpulse=j,L.normalImpulse=G;break}if(j=0,G=-L.normalMass*U,F=g.K.col2.x*G+V,k=0,G>=0&&F>=0){h=(u=j-R)*D,p=u*T,d=(c=G-N)*D,f=c*T,x.x-=w*(h+d),x.y-=w*(p+f),v-=I*(O.rA.x*p-O.rA.y*h+L.rA.x*f-L.rA.y*d),C.x+=E*(h+d),C.y+=E*(p+f),b+=S*(O.rB.x*p-O.rB.y*h+L.rB.x*f-L.rB.y*d),O.normalImpulse=j,L.normalImpulse=G;break}if(j=0,G=0,k=U,(F=V)>=0&&k>=0){h=(u=j-R)*D,p=u*T,d=(c=G-N)*D,f=c*T,x.x-=w*(h+d),x.y-=w*(p+f),v-=I*(O.rA.x*p-O.rA.y*h+L.rA.x*f-L.rA.y*d),C.x+=E*(h+d),C.y+=E*(p+f),b+=S*(O.rB.x*p-O.rB.y*h+L.rB.x*f-L.rB.y*d),O.normalImpulse=j,L.normalImpulse=G;break}break}}y.m_angularVelocity=v,A.m_angularVelocity=b}},t.prototype.FinalizeVelocityConstraints=function(){for(var t=0;t<this.m_constraintCount;++t)for(var e=this.m_constraints[t],i=e.manifold,n=0;n<e.pointCount;++n){var r=i.m_points[n],o=e.points[n];r.m_normalImpulse=o.normalImpulse,r.m_tangentImpulse=o.tangentImpulse}},t.prototype.SolvePositionConstraints=function(e){for(var i=0,n=0;n<this.m_constraintCount;n++){var r=this.m_constraints[n],o=r.bodyA,s=r.bodyB,a=o.m_mass*o.m_invMass,l=o.m_mass*o.m_invI,u=s.m_mass*s.m_invMass,c=s.m_mass*s.m_invI;t.s_psm.Initialize(r);for(var h=t.s_psm.m_normal,p=0;p<r.pointCount;p++){var d=r.points[p],f=t.s_psm.m_points[p],_=t.s_psm.m_separations[p],m=f.x-o.m_sweep.c.x,g=f.y-o.m_sweep.c.y,y=f.x-s.m_sweep.c.x,A=f.y-s.m_sweep.c.y;i=i<_?i:_;var v=zB.Clamp(e*(_+RB.b2_linearSlop),-RB.b2_maxLinearCorrection,0),b=-d.equalizedMass*v,x=b*h.x,C=b*h.y;o.m_sweep.c.x-=a*x,o.m_sweep.c.y-=a*C,o.m_sweep.a-=l*(m*C-g*x),o.SynchronizeTransform(),s.m_sweep.c.x+=u*x,s.m_sweep.c.y+=u*C,s.m_sweep.a+=c*(y*C-A*x),s.SynchronizeTransform()}}return i>-1.5*RB.b2_linearSlop},t.s_worldManifold=new yM,t.s_psm=new vM,t}(),pO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.Create=function(t){return new e},e.Destroy=function(t,e){},e.prototype.Reset=function(e,i){t.prototype.Reset.call(this,e,i)},e.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape(),t.m_xf,this.m_fixtureB.GetShape(),e.m_xf)},e.prototype.b2CollideEdgeAndCircle=function(t,e,i,n,r){},e}(sO),dO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.Create=function(t){return new e},e.Destroy=function(t,e){},e.prototype.Reset=function(e,i){t.prototype.Reset.call(this,e,i),RB.b2Assert(e.GetType()==KB.e_polygonShape),RB.b2Assert(i.GetType()==KB.e_circleShape)},e.prototype.Evaluate=function(){var t=this.m_fixtureA.m_body,e=this.m_fixtureB.m_body;sM.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape(),t.m_xf,this.m_fixtureB.GetShape(),e.m_xf)},e}(sO),fO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.Create=function(t){return new e},e.Destroy=function(t,e){},e.prototype.Reset=function(e,i){t.prototype.Reset.call(this,e,i),RB.b2Assert(e.GetType()==KB.e_polygonShape),RB.b2Assert(i.GetType()==KB.e_edgeShape)},e.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape(),t.m_xf,this.m_fixtureB.GetShape(),e.m_xf)},e.prototype.b2CollidePolyAndEdge=function(t,e,i,n,r){},e}(sO),_O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.Create=function(t){return new e},e.Destroy=function(t,e){},e.prototype.Reset=function(e,i){t.prototype.Reset.call(this,e,i)},e.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();sM.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape(),t.m_xf,this.m_fixtureB.GetShape(),e.m_xf)},e}(sO),mO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.Create=function(t){return new e},e.Destroy=function(t,e){},e.prototype.Reset=function(e,i){t.prototype.Reset.call(this,e,i)},e.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();sM.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape(),t.m_xf,this.m_fixtureB.GetShape(),e.m_xf)},e}(sO),gO=function(){},yO=function(){function t(){}return t.prototype.Step=function(t){},t.prototype.Draw=function(t){},t.prototype.AddBody=function(t){var e=new gO;e.controller=this,e.body=t,e.nextBody=this.m_bodyList,e.prevBody=null,this.m_bodyList=e,e.nextBody&&(e.nextBody.prevBody=e),this.m_bodyCount++,e.nextController=t.m_controllerList,e.prevController=null,t.m_controllerList=e,e.nextController&&(e.nextController.prevController=e),t.m_controllerCount++},t.prototype.RemoveBody=function(t){for(var e=t.m_controllerList;e&&e.controller!=this;)e=e.nextController;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),this.m_bodyList==e&&(this.m_bodyList=e.nextBody),t.m_controllerList==e&&(t.m_controllerList=e.nextController),t.m_controllerCount--,this.m_bodyCount--},t.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetWorld=function(){return this.m_world},t.prototype.GetBodyList=function(){return this.m_bodyList},t}(),AO=!0,vO=((iO={}).new={b2CircleShape:WB,b2EdgeShape:JB,b2MassData:ZB,b2PolygonShape:$B,b2Shape:KB,b2AABB:tM,b2Collision:sM,b2ContactID:iM,b2ContactPoint:aM,b2Distance:YB,b2DistanceInput:LB,b2DistanceOutput:HB,b2DistanceProxy:NB,b2DynamicTree:cM,b2DynamicTreeBroadPhase:pM,b2DynamicTreeNode:lM,b2DynamicTreePair:hM,b2Manifold:oM,b2ManifoldPoint:rM,b2OBB:dM,b2RayCastInput:uM,b2RayCastOutput:fM,b2SeparationFunction:_M,b2Simplex:qB,b2SimplexCache:FB,b2SimplexVertex:XB,b2TimeOfImpact:mM,b2TOIInput:gM,b2WorldManifold:yM,ClipVertex:nM,Features:eM,b2Mat22:kB,b2Mat33:VB,b2Math:zB,b2Sweep:UB,b2Transform:jB,b2Vec2:GB,b2Vec3:QB,b2Color:AM,b2Settings:RB,b2CircleContact:mO,b2Contact:sO,b2ContactConstraint:aO,b2ContactConstraintPoint:lO,b2ContactEdge:oO,b2ContactFactory:uO,b2ContactRegister:cO,b2ContactSolver:hO,b2EdgeAndCircleContact:pO,b2PolyAndCircleContact:dO,b2PolyAndEdgeContact:fO,b2PolygonContact:_O,b2PositionSolverManifold:vM,b2Controller:yO,b2ControllerEdge:gO,b2DistanceJoint:TM,b2DistanceJointDef:PM,b2FrictionJoint:BM,b2FrictionJointDef:MM,b2GearJoint:OM,b2GearJointDef:LM,b2Jacobian:RM,b2Joint:SM,b2JointDef:DM,b2JointEdge:NM,b2LineJoint:FM,b2LineJointDef:kM,b2MouseJoint:VM,b2MouseJointDef:UM,b2PrismaticJoint:jM,b2PrismaticJointDef:GM,b2PulleyJoint:QM,b2PulleyJointDef:zM,b2RevoluteJoint:HM,b2RevoluteJointDef:XM,b2WeldJoint:qM,b2WeldJointDef:YM,b2Body:rO,b2BodyDef:bM,b2ContactFilter:$M,b2ContactImpulse:IM,b2ContactListener:ZM,b2ContactManager:tO,b2DebugDraw:WM,b2DestructionListener:JM,b2FilterData:xM,b2Fixture:CM,b2FixtureDef:wM,b2Island:EM,b2TimeStep:KM,b2World:nO},iO.legacy=OB,iO.none=null,iO),bO={version:"none",custom:void 0,get prefer(){if(AO&&(console.debug("B2D Version - ",this.version),AO=!1),"custom"===this.version){if(!this.custom)throw new Error("Custom Box2D should be assigned to `custom` field");return this.custom}return vO[this.version]?vO[this.version]:vO.none}},xO=Symbol("External class marker"),CO=/nape./,wO=void 0;function IO(t,e){void 0===e&&(e=void 0);var i=wO||(wO=bO.prefer);if(!i||!t)return null;if(!e||void 0!==i[t])return i[t];if(!e)return null;for(var n=i,r=0,o=e.split(".");r<o.length;r++){if(!(n=n[o[r]]))return null}return n[t]}function EO(t,e){var i;if(wO||(wO=bO.prefer),!wO)return null;var n=null===(i=t.namespace)||void 0===i?void 0:i.uri,r=IO(t.name,n&&CO.test(n)?n:void 0);if("function"!=typeof r)return null;Object.defineProperty(r.prototype,xO,{value:!0});var o=Object.create(r.prototype);return r.apply(o,e),o.__fast__=!0,o}function SO(t){return bO.prefer?"("+t+" != undefined && "+t+"[AX_CLASS_SYMBOL])":"true"}function DO(){return!!bO.prefer}function TO(t,e){return void 0===e&&(e=!1),bO.prefer?"(_a = typeof "+t+", ((_a !== 'object' && _a !== 'function' ) "+(e?"":"|| "+t+" == null")+" || "+t+"[AX_CLASS_SYMBOL]))":"true"}var PO=function(){function t(){this.imports=[]}return t.prototype.test=function(t){return!1},t.prototype._genEntry=function(t){return"//"+t.name},t.prototype._genAlias=function(t,e){return t.namespace.uri.replace(/\./g,"_")+"__"+t.name},t.prototype.findAliases=function(t,e){return this.imports.filter((function(i){return i.name===t&&(!e||e===i.options.findProp)}))},t.prototype.getLexAlias=function(t,e){return this.getPropStrictAlias(t,Object.assign({findProp:!0},e||{}))},t.prototype.getPropStrictAlias=function(t,e){var i;if(void 0===e&&(e={findProp:!1}),!this.test(t))throw"Can't generate static alias for "+t.name+" of "+(null===(i=t.namespace)||void 0===i?void 0:i.uri);var n=this.imports.find((function(i){return i.name===t&&e.findProp===i.options.findProp}));if(n)return n.alias;var r=this._genAlias(t,e);return this.imports.find((function(t){return t.alias===r}))||this.imports.push({name:t,alias:r,options:e}),r},t.prototype.genHeader=function(t){if(void 0===t&&(t=""),!this.imports.length)return"";for(var e=["\n"+t+" /* "+this.constructor.name+" */"],i=0,n=this.imports;i<n.length;i++){var r=n[i];e.push(t+" "+this._genEntry(r))}return e.push("\n"),e.join("\n")},t.prototype.genBody=function(t){return""},t.prototype.reset=function(){this.imports.length=0},t}(),BO=function(){function t(t){if(this.generators=t,this.allowColissions=!1,!t)throw"Generators array can't be null"}return t.prototype.getGenerator=function(t){for(var e=0,i=this.generators;e<i.length;e++){var n=i[e];if(n.test(t))return n}return null},t.prototype.test=function(t){return!!this.generators.length&&!!this.getGenerator(t)},t.prototype.findAliases=function(t,e){for(var i=[],n=0,r=this.generators;n<r.length;n++){var o=r[n];i=i.concat(o.findAliases(t,e))}return i},t.prototype.getLexAlias=function(t,e){var i,n=this.getGenerator(t);if(!n)throw"Can't generate static alias for "+t.name+" of "+(null===(i=t.namespace)||void 0===i?void 0:i.uri);return n.getLexAlias(t,e)},t.prototype.getPropStrictAlias=function(t,e){var i,n=this.getGenerator(t);if(!n)throw"Can't generate static alias for "+t.name+" of "+(null===(i=t.namespace)||void 0===i?void 0:i.uri);return n.getPropStrictAlias(t,e)},t.prototype.genHeader=function(t){for(var e="",i=0,n=this.generators;i<n.length;i++){e+=n[i].genHeader(t)}return e},t.prototype.genBody=function(t){for(var e="",i=0,n=this.generators;i<n.length;i++){e+=n[i].genHeader(t)}return e},t.prototype.reset=function(){this.generators.forEach((function(t){return t.reset()}))},t}(),MO=function(t){function e(e){var i=t.call(this)||this;return i.allows=e,i.allows=Object.assign({box2D:!0,nape:!0},e),i}return i(e,t),e.prototype._genEntry=function(t){var e=t.name.namespace.uri,i=t.name.name;return"const "+t.alias+" = context.getStaticImportExt('"+e+"', '"+i+"');"},e.prototype._genAlias=function(t,e){return t.namespace.uri.replace(/\./g,"_")+"__"+t.name},e.prototype.test=function(t){var e,i=null===(e=t.namespace)||void 0===e?void 0:e.uri;return!!i&&(i.startsWith("Box2D")&&this.allows.box2D?!!IO(t.name):!(!i.startsWith("nape.")||!this.allows.nape)&&!t.name.includes("Debug"))},e}(PO),OO=["flash.geom","flash.utils","Math","trace"],LO=["getDefinitionByName","SetIntervalTimer","setTimeout",":trace"],RO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.test=function(t){var e,i=(null===(e=t.namespace)||void 0===e?void 0:e.uri)||"",n=t.name;return void 0!==i&&(LO.indexOf(n)>-1||LO.indexOf(i)>-1?null:OO.indexOf(n)>-1&&!i||OO.indexOf(i)>-1)},e.prototype._genEntry=function(t){var e=t.name.namespace.uri,i=t.name.name,n=t.options||{},r=n.nameAlias,o=n.findProp;if(!r)throw"Name alias required for generatin Toplevel exports!";var s=Number(r.replace("name","")),a="['"+Kv.getPublicMangledName(i)+"']";return"const "+t.alias+" = context.getTopLevel("+s+")"+(o?a:"")+"; // "+e+":"+i},e.prototype._genAlias=function(t,e){var i=t.namespace.uri.split(/\./g);if(!e.nameAlias)throw"Name alias required for generatin Toplevel exports!";return i.join("_")+"__"+t.name+(e.findProp?"":"_def")},e}(PO),NO={},FO=JT;function kO(t){return JSON.stringify(t)}var VO=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/;function UO(t){return VO.test(t)}var jO={},GO=0;function QO(t,e){var i,n,r,o;void 0===e&&(e={});var s=e.optimise,a=void 0===s?31:s,l=e.scope,u=new BO([new MO({box2D:!1}),new RO]),c=new cP,h=new uP;pP.begin("");var p=new hP(u,l),d=function(t){return 16&a&&!!t};if(d(h)&&"function"==typeof(W=h.getBody(t)))return pP.drop(),{names:[],compiled:W};var f=(""+GO++).padLeft("0",4),_=t.getName().replace(/([^a-z0-9]+)/gi,"_"),m="__root__/"+f+"_"+(_||"unknown"),g=m,y=_,A=!0,v="Public",b=void 0;t.trait&&(t.trait.holder instanceof eP?(g=t.trait.holder.instanceInfo.getClassName().replace(/\./g,"/"),A=!1):t.trait.holder instanceof tP&&(g=t.trait.holder.getClassName().replace(/\./g,"/"),b=null===(i=t.trait.holder.getSuperName())||void 0===i?void 0:i.toFQNString(!1).replace(/\./g,"/")),t.trait instanceof nP&&(y=t.trait.name.name,v=Qv[t.trait.name.namespace.type]),t.trait&&2===t.trait.kind&&(y="get_"+y),t.trait&&3===t.trait.kind&&(y="set_"+y),y=t.isConstructor?"constructor":A?"m_"+y:y,void 0!==jO[m=g+"/"+y]?m+="$"+(jO[m]=jO[m]+1):jO[m]=0);t.instanceInfo&&(g=t.instanceInfo.getClassName().replace(/\./g,"/"),y=t.isConstructor?"constructor":_,b=null===(n=t.instanceInfo.getSuperName())||void 0===n?void 0:n.toFQNString(!1).replace(/\./g,"/"),m=g+"/"+y);var x=UO(y),C=UO(g.replace("/","_"));if(!x&&!C)return{error:{message:"Invalid method ("+y+") and path ("+g+") name, falling to interpret",reason:"mangled_classname"}};var w=g+(A?"::":".")+y,I="/*\n\tIndex: "+t.index()+"\n\tPath:  "+w+"\n\tType:  "+v+"\n\tSuper: "+(b||"-")+"\n\tReturn: "+((null===(r=t.getTypeName())||void 0===r?void 0:r.toString())||"*")+"\n*/\n\n",E=lP(t),S=E.error,D=E.jumps,T=E.catchStart,P=E.catchEnd,B=E.set;if(S&&(pP.drop(),"underrun"!==S.reason||!(32&a)))return{error:S};for(var M=t.abc,O=t.getBody(),L=O.maxStack,R=O.localCount-1,N=O.maxScopeDepth-O.initScopeDepth,F=[],k=[],V="",U=0,j=function(t){return(U+=4*t)<0&&(U=0),V=" ".repeat(U?U-1:0)},G=[],Q=function(t){var e;k.push(V+" catch(e){"),j(1),k.push(V+" // in case this is a error coming from stack0.__fast when stack0 is undefined,"),k.push(V+" // we convert it to a ASError, so that avm2 can still catch it"),k.push(V+" if (e instanceof TypeError) {"),k.push(V+'     var _e = context.sec.createError("TypeError", {code:1065, message:e.message})'),k.push(V+"     _e.source = e; e = _e;"),k.push(V+" }"),k.push(V+" stack0 = e;");for(var i=0;i<t.length;i++){var n=t[i].getType();if(n){var r=dt.indexOf(n);r<0&&(r=dt.length,dt.push(n),F.push("    let name"+r+" = context.names["+r+"];")),k.push(V+" const errorClass$"+i+" = context.sec.application.getClass(name"+r+");"),k.push(V+" if(errorClass$"+i+" && errorClass$"+i+".axIsType(e))"),k.push(V+"     { p = "+t[i].target+"; continue; };")}else e=V+" { p = "+t[i].target+"; continue; };"}e&&k.push(e),k.push(V+" throw e;"),j(-1),k.push(V+" }")},z=function(){for(var t=0;t<G.length;t++)j(-1),k.push(V+" }"),Q(G[t])},H=function(){for(var t=0;t<G.length;t++)k.push(V+" try {"),j(1)},X=!1,q=!1,Y=0,K=B;Y<K.length;Y++){var W;(W=K[Y].name)!=JT.NEWOBJECT&&W!=JT.SWAP&&W!=JT.HASNEXT2||(X=!0),q=q||W>=JT.LI8&&W<=JT.SF64}var J=t.parameters,Z="[stack underrun]",$=0;if(j(1),1&a){for(var tt=[],et=0;et<J.length;et++){var it={name:"local"+(et+1),value:null,type:""};if((ct=J[et]).hasOptionalValue())switch(ct.optionalValueKind){case 1:it.value=""+kO(M.getString(ct.optionalValueIndex));break;default:it.value=""+ct.getOptionalValue()}var nt=ct.getType();nt&&(it.type=nt.name),tt[et]=it}t.needsRest()&&tt.push({name:"...args"});var rt=tt.map((function(t){return t.value?t.name+" /* "+(t.type||"*")+" */ = "+t.value:t.name+" /* "+(t.type||"*")+" */"})).join(", "),ot=y.replace(/([^a-z0-9]+)/gi,"_");F.push(V+" return function compiled_"+ot+"("+rt+") {"),j(1),F.push(V+" let local0 = this === context.jsGlobal ? context.savedScope.global.object : this;");for(var st=0,at=tt;st<at.length;st++){var lt=at[st];if("String"===lt.type){var ut=lt.name;F.push(V+" /* Force string coerce */"),F.push(V+" "+ut+" = ("+ut+" && typeof "+ut+" !=='string') ? "+ut+".toString() : "+ut+";")}}t.needsRest()&&(F.push(V+" let local"+(J.length+1)+" = context.sec.createArrayUnsafe(args);"),$+=1),t.needsArguments()&&(F.push(V+" let local"+(J.length+1)+" = context.sec.createArrayUnsafe(Array.from(arguments));"),$+=1)}else{F.push(V+" return function compiled_"+y.replace(/([^a-z0-9]+)/gi,"_")+"() {");for(et=0;et<J.length;et++)if(J[et].hasOptionalValue()){F.push(V+" let argnum = arguments.length;");break}F.push(V+" let local0 = this === context.jsGlobal ? context.savedScope.global.object : this;");for(et=0;et<J.length;et++){var ct=J[et];if(F.push(V+" let local"+(et+1)+" = arguments["+et+"];"),J[et].hasOptionalValue())switch(ct.optionalValueKind){case 1:F.push(V+" if (argnum <= "+et+") local"+(et+1)+" = context.abc.getString("+ct.optionalValueIndex+");");break;default:F.push(V+" if (argnum <= "+et+") local"+(et+1)+" = "+ct.getOptionalValue()+";")}}}var ht=F.length;F.push("__PLACE__FOR__OPTIONAL__LOCALS__");var pt=[];for(et=J.length+1+$;et<=R;et++)pt[et]={index:et,isArgumentList:et===J.length+1,read:0,write:0,die:!1};for(et=0;et<L;et++)F.push(V+" let stack"+et+" = undefined;");for(et=0;et<N;et++)F.push(V+" let scope"+et+" = undefined;");X&&F.push(V+" let temp = undefined;"),q&&F.push(V+" let domainMemory; // domainMemory"),F.push(V+" let tr = undefined;");var dt=[],ft=V,_t=function(t){var e=M.getMultiname(t),i=dt.indexOf(e);return i<0&&(i=dt.length,dt.push(e),F.push(ft+" let name"+i+" = context.names["+i+"];")),"name"+i};F.push(V+" let sec = context.sec;");var mt=D.length>1||T;NO&&NO[w+"__begin"]&&(k.push(V+" /* ATTACH METHOD HOOK */"),k.push(V+" context.executeHook(local0, '"+w+"__begin')")),k.push(V+" ");var gt,yt,At;T&&Object.keys(T).length;mt&&(k.push(V+" let p = 0;"),k.push(V+" while (true) {"),j(1),k.push(V+" switch (p) {")),mt&&j(2);for(et=0;et<B.length;et++){At&&(yt=At),At=B[et],d(p)&&p.killFar(et),D.indexOf(At.position)>=0&&(G&&z(),d(c)&&c.drop(),mt&&(j(-1),k.push(V+" case "+At.position+":"),j(1)),G&&H()),(gt=T?T[At.position]:null)&&(G.push(gt),k.push(V+" try {"),j(1));var vt,bt=function(t){return At.stack-1-t>=0?"stack"+(At.stack-1-t):"/*"+Z+" "+(At.stack-1-t)+"*/ stack0"},xt=bt(0),Ct=bt(1),wt=bt(2),It=bt(3),Et=bt(-1),St=At.scope>0?"scope"+(At.scope-1):"context.savedScope",Dt="scope"+At.scope,Tt=function(t){return"local"+t},Pt=function(t){return At.params[t]};if(At.stack<0)k.push(V+" // unreachable");else{var Bt=0;switch(At.name){case JT.LABEL:break;case JT.DXNSLATE:k.push(V+" "+St+".defaultNamespace = context.internNamespace(0, "+xt+");");break;case JT.DEBUGFILE:case JT.DEBUGLINE:case JT.DEBUG:break;case JT.THROW:k.push(V+" throw "+xt+";");break;case JT.GETLOCAL:pt[Bt=Pt(0)]&&pt[Bt].read++,k.push(V+" "+Et+" = "+Tt(Bt)+";");break;case JT.SETLOCAL:pt[Bt=Pt(0)]&&(pt[Bt].write++,pt[Bt].read||(pt[Bt].die=!0)),k.push(V+" "+Tt(Bt)+" = "+xt+";");break;case JT.GETSLOT:k.push(V+" "+xt+" = "+xt+".axGetSlot("+Pt(0)+");");break;case JT.SETSLOT:k.push(V+" "+Ct+".axSetSlot("+Pt(0)+", "+xt+");");break;case JT.GETGLOBALSCOPE:k.push(V+" "+Et+" = context.savedScope.global.object;");break;case JT.PUSHSCOPE:k.push(V+" "+Dt+" = "+St+".extend("+xt+");");break;case JT.PUSHWITH:k.push(V+" "+Dt+" = context.pushwith("+St+", "+xt+");");break;case JT.POPSCOPE:k.push(V+" "+St+" = undefined;");break;case JT.GETSCOPEOBJECT:k.push(V+" "+Et+" = scope"+Pt(0)+".object;");break;case JT.NEXTNAME:k.push(V+" "+Ct+" = sec.box("+Ct+").axNextName("+xt+");");break;case JT.NEXTVALUE:k.push(V+" "+Ct+" = sec.box("+Ct+").axNextValue("+xt+");");break;case JT.HASNEXT:k.push(V+" "+Ct+" = sec.box("+Ct+").axNextNameIndex("+xt+");");break;case JT.HASNEXT2:k.push(V+" temp = context.hasnext2("+Tt(Pt(0))+", "+Tt(Pt(1))+");"),k.push(V+" "+Tt(Pt(0))+" = temp[0];"),k.push(V+" "+Tt(Pt(1))+" = temp[1];"),k.push(V+" "+Et+" = "+Tt(Pt(1))+" > 0;");break;case JT.IN:k.push(V+" "+Ct+" = ("+Ct+" && "+Ct+".axClass === sec.AXQName) ? obj.axHasProperty("+Ct+".name) : "+xt+".axHasPublicProperty("+Ct+");");break;case JT.DUP:k.push(V+" "+Et+" = "+xt+";");break;case JT.POP:break;case JT.SWAP:k.push(V+" temp = "+xt+";"),k.push(V+" "+xt+" = "+Ct+";"),k.push(V+" "+Ct+" = temp;"),k.push(V+" temp = undefined;");break;case JT.PUSHTRUE:k.push(V+" "+Et+" = true;");break;case JT.PUSHFALSE:k.push(V+" "+Et+" = false;");break;case JT.PUSHBYTE:case JT.PUSHSHORT:k.push(V+" "+Et+" = "+Pt(0)+";");break;case JT.PUSHINT:k.push(V+" "+Et+" = "+M.ints[Pt(0)]+";");break;case JT.PUSHUINT:k.push(V+" "+Et+" = "+M.uints[Pt(0)]+";");break;case JT.PUSHDOUBLE:k.push(V+" "+Et+" = "+M.doubles[Pt(0)]+";");break;case JT.PUSHSTRING:k.push(V+" "+Et+" = "+kO(M.getString(Pt(0)))+";");break;case JT.PUSHNAN:k.push(V+" "+Et+" = NaN;");break;case JT.PUSHNULL:k.push(V+" "+Et+" = null;");break;case JT.PUSHUNDEFINED:k.push(V+" "+Et+" = undefined;");break;case JT.IFEQ:k.push(V+" if ("+xt+" == "+Ct+") { p = "+Pt(0)+"; continue; };");break;case JT.IFNE:k.push(V+" if ("+xt+" != "+Ct+") { p = "+Pt(0)+"; continue; };");break;case JT.IFSTRICTEQ:k.push(V+" if ("+xt+" === "+Ct+") { p = "+Pt(0)+"; continue; };");break;case JT.IFSTRICTNE:k.push(V+" if ("+xt+" !== "+Ct+") { p = "+Pt(0)+"; continue; };");break;case JT.IFGT:k.push(V+" if ("+xt+" < "+Ct+") { p = "+Pt(0)+"; continue; };");break;case JT.IFGE:k.push(V+" if ("+xt+" <= "+Ct+") { p = "+Pt(0)+"; continue; };");break;case JT.IFLT:k.push(V+" if ("+xt+" > "+Ct+") { p = "+Pt(0)+"; continue; };");break;case JT.IFLE:k.push(V+" if ("+xt+" >= "+Ct+") { p = "+Pt(0)+"; continue; };");break;case JT.IFFALSE:k.push(V+" if (!"+xt+") { p = "+Pt(0)+"; continue; };");break;case JT.IFTRUE:k.push(V+" if ("+xt+") { p = "+Pt(0)+"; continue; };");break;case JT.LOOKUPSWITCH:var Mt=At.params.concat(),Ot=Mt.shift();k.push(V+" if ("+xt+" >= 0 && "+xt+" < "+Mt.length+") { p = ["+Mt.join(", ")+"]["+xt+"]; continue; } else { p = "+Ot+"; continue; };");break;case JT.JUMP:k.push(V+" { p = "+Pt(0)+"; continue; };");break;case JT.INCREMENT:k.push(V+" "+xt+"++;");break;case JT.DECREMENT:k.push(V+" "+xt+"--;");break;case JT.INCLOCAL:k.push(V+" "+Tt(Pt(0))+"++;");break;case JT.DECLOCAL:k.push(V+" "+Tt(Pt(0))+"--;");break;case JT.INCREMENT_I:k.push(V+" "+xt+" |= 0;"),k.push(V+" "+xt+"++;");break;case JT.DECREMENT_I:k.push(V+" "+xt+" |= 0;"),k.push(V+" "+xt+"--;");break;case JT.INCLOCAL_I:k.push(V+" "+Tt(Pt(0))+" |= 0;"),k.push(V+" "+Tt(Pt(0))+"++;");break;case JT.DECLOCAL_I:k.push(V+" "+Tt(Pt(0))+" |= 0;"),k.push(V+" "+Tt(Pt(0))+"--;");break;case JT.NEGATE_I:k.push(V+" "+xt+" = -("+xt+" | 0);");break;case JT.ADD_I:k.push(V+" "+Ct+" = ("+Ct+" | 0) + ("+xt+" | 0);");break;case JT.SUBTRACT_I:k.push(V+" "+Ct+" = ("+Ct+" | 0) - ("+xt+" | 0);");break;case JT.MULTIPLY_I:k.push(V+" "+Ct+" = ("+Ct+" | 0) * ("+xt+" | 0);");break;case JT.ADD:k.push(V+" "+Ct+" += "+xt+";");break;case JT.SUBTRACT:k.push(V+" "+Ct+" -= "+xt+";");break;case JT.MULTIPLY:k.push(V+" "+Ct+" *= "+xt+";");break;case JT.DIVIDE:k.push(V+" "+Ct+" /= "+xt+";");break;case JT.MODULO:k.push(V+" "+Ct+" %= "+xt+";");break;case JT.LSHIFT:k.push(V+" "+Ct+" <<= "+xt+";");break;case JT.RSHIFT:k.push(V+" "+Ct+" >>= "+xt+";");break;case JT.URSHIFT:k.push(V+" "+Ct+" >>>= "+xt+";");break;case JT.BITAND:k.push(V+" "+Ct+" &= "+xt+";");break;case JT.BITOR:k.push(V+" "+Ct+" |= "+xt+";");break;case JT.BITXOR:k.push(V+" "+Ct+" ^= "+xt+";");break;case JT.EQUALS:k.push(V+" "+Ct+" = "+Ct+" == "+xt+";");break;case JT.STRICTEQUALS:k.push(V+" "+Ct+" = "+Ct+" === "+xt+";");break;case JT.GREATERTHAN:k.push(V+" "+Ct+" = "+Ct+" > "+xt+";");break;case JT.GREATEREQUALS:k.push(V+" "+Ct+" = "+Ct+" >= "+xt+";");break;case JT.LESSTHAN:k.push(V+" "+Ct+" = "+Ct+" < "+xt+";");break;case JT.LESSEQUALS:k.push(V+" "+Ct+" = "+Ct+" <= "+xt+";");break;case JT.NOT:k.push(V+" "+xt+" = !"+xt+";");break;case JT.BITNOT:k.push(V+" "+xt+" = ~"+xt+";");break;case JT.NEGATE:k.push(V+" "+xt+" = -"+xt+";");break;case JT.TYPEOF:k.push(V+" "+xt+" = typeof "+xt+" === 'undefined' ? 'undefined' : context.typeof("+xt+");");break;case JT.INSTANCEOF:k.push(V+" "+Ct+" = "+xt+".axIsInstanceOf("+Ct+");");break;case JT.ISTYPE:k.push(V+" "+xt+" = "+St+".getScopeProperty("+_t(Pt(0))+", true, false).axIsType("+xt+");");break;case JT.ISTYPELATE:k.push(V+" "+Ct+" = "+xt+".axIsType("+Ct+");");break;case JT.ASTYPE:k.push(V+" "+xt+" = "+St+".getScopeProperty("+_t(Pt(0))+", true, false).axAsType("+xt+");");break;case JT.ASTYPELATE:k.push(V+" "+Ct+" = "+TO(Ct)+" ? "+xt+".axAsType("+Ct+") : "+Ct+";");break;case JT.CALL:for(var Lt=[],Rt=bt(Pt(0)+1),Nt=1;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));d(c)&&c.safe(Rt)&&k.push(V+" /* This call maybe a safe, "+c.constructor.name+" */"),k.push(V+" "+Rt+" = context.call("+bt(Pt(0)+1)+", "+bt(Pt(0))+", ["+Lt.join(", ")+"]);");break;case JT.CONSTRUCT:for(Lt=[],Nt=1;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));k.push(V+" "+bt(Pt(0))+" = context.construct("+bt(Pt(0))+", ["+Lt.join(", ")+"]);");break;case JT.CALLPROPERTY:var Ft=M.getMultiname(Pt(1));for(Lt=[],Nt=0;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));Rt=Lt.shift();if("getDefinitionByName"==M.getMultiname(Pt(1)).name)k.push(V+" "+bt(Pt(0))+" = context.getdefinitionbyname("+St+", "+Rt+", ["+Lt.join(", ")+"]);");else{var kt=void 0;if(d(p)&&(kt=p.sureThatFast(""+Rt,Ft.getMangledName()))){var Vt=kt.isMangled?Kv.getPublicMangledName(Ft.name):Ft.name;p.kill(""+Rt),k.push(V+" /* We sure that this safe call */ "),kt.isFunc?k.push(V+" "+bt(Pt(0))+" = "+Rt+"['"+Vt+"']("+Lt.join(", ")+");"):k.push(V+" "+bt(Pt(0))+" = /*fast*/"+Rt+".axCallProperty("+_t(Pt(1))+", ["+Lt.join(", ")+"], false);");break}DO()&&(k.push(V+" if (!"+TO(Rt)+") {"),k.push(V+"    "+bt(Pt(0))+" = "+Rt+"['"+Ft.name+"']("+Lt.join(", ")+");"),k.push(V+" } else {"),j(1)),k.push(V+" // "+Ft),k.push(V+" {"),j(1),k.push(V+" let t = "+Rt+";"),k.push(V+" const m = "+Rt+"['$Bg"+Ft.name+"'] || (t = sec.box("+Rt+"), t['$Bg"+Ft.name+"']);"),k.push(V+" if( typeof m === 'function' ) { "),k.push(V+"     "+bt(Pt(0))+" = m.call(t"+(Lt.length?", ":"")+Lt.join(", ")+");"),k.push(V+" } else {  "),k.push(V+"     "+bt(Pt(0))+" = "+Rt+".axCallProperty("+_t(Pt(1))+", ["+Lt.join(", ")+"], false);"),k.push(V+" }"),j(-1),k.push(V+" }"),DO()&&(j(-1),k.push(V+" }"))}break;case JT.CALLPROPLEX:for(Ft=M.getMultiname(Pt(1)),Lt=[],Nt=0;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));k.push(V+" temp = sec.box("+Lt.shift()+");"),k.push(V+" "+bt(Pt(0))+" = (typeof temp['$Bg"+Ft.name+"'] === 'function')? temp['$Bg"+Ft.name+"']("+Lt.join(", ")+") : temp.axCallProperty("+_t(Pt(1))+", ["+Lt.join(", ")+"], true);");break;case JT.CALLPROPVOID:for(Ft=M.getMultiname(Pt(1)),Lt=[],Nt=0;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));Rt=Lt.shift();if(d(p)&&p.sureThatFast(Rt)){Vt=p.sureThatFast(Rt).isMangled?Kv.getPublicMangledName(Ft.name):Ft.name;k.push(V+" /* We sure that this safe call */ "),k.push(V+" "+Rt+"['"+Vt+"']("+Lt.join(", ")+");"),p.kill(""+Rt);break}DO()&&(k.push(V+" if (!"+TO(Rt)+") {"),k.push(V+"     "+Rt+"['"+Ft.name+"']("+Lt.join(", ")+");"),k.push(V+" } else {"),j(1)),k.push(V+" // "+Ft),k.push(V+" {"),j(1),k.push(V+" let t = "+Rt+";"),k.push(V+" const m = "+Rt+"['$Bg"+Ft.name+"'] || (t = sec.box("+Rt+"), t['$Bg"+Ft.name+"']);"),k.push(V+" if( typeof m === 'function' ) { "),k.push(V+"     m.call(t"+(Lt.length?", ":"")+Lt.join(", ")+");"),k.push(V+" } else {  "),k.push(V+"    "+Rt+".axCallProperty("+_t(Pt(1))+", ["+Lt.join(", ")+"], false);"),k.push(V+" }"),j(-1),k.push(V+" }"),DO()&&(j(-1),k.push(V+" }"));break;case JT.APPLYTYPE:for(Lt=[],Nt=1;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));k.push(V+" "+bt(Pt(0))+" = sec.applyType("+bt(Pt(0))+", ["+Lt.join(", ")+"]);");break;case JT.FINDPROPSTRICT:Ft=M.getMultiname(Pt(0));if(k.push(V+" // "+Ft),d(u)&&u.test(Ft)){if(k.push(V+" /* GenerateLexImports */"),k.push(V+" "+Et+" = "+u.getPropStrictAlias(Ft,{nameAlias:_t(Pt(0))})+";"),d(p)){var Ut=u.getGenerator(Ft)instanceof RO;p.mark(Et,et,Ut,Ft)}break}k.push(V+" "+Et+" = "+St+".findScopeProperty("+_t(Pt(0))+", true, false);");break;case JT.FINDPROPERTY:k.push(V+" // "+M.getMultiname(Pt(0))),k.push(V+" "+Et+" = "+St+".findScopeProperty("+_t(Pt(0))+", false, false);");break;case JT.NEWFUNCTION:k.push(V+" // "+M.getMethodInfo(Pt(0))),k.push(V+" "+Et+" = sec.createFunction(context.abc.getMethodInfo("+Pt(0)+"), "+St+", true);");break;case JT.NEWCLASS:k.push(V+" // "+M.classes[Pt(0)]),k.push(V+" "+xt+" = sec.createClass(context.abc.classes["+Pt(0)+"], "+xt+", "+St+");");break;case JT.GETDESCENDANTS:Ft=M.getMultiname(Pt(0));if(k.push(V+" // "+Ft),Ft.isRuntimeName()){var jt=(Qt=Ft.isRuntimeName()&&Ft.isRuntimeNamespace())?wt:Ct;k.push(V+" {"),j(1),Qt?k.push(V+" const rn = context.runtimename("+_t(Pt(0))+", "+xt+", "+Ct+");"):k.push(V+" const rn = context.runtimename("+_t(Pt(0))+", "+xt+");"),k.push(V+" "+jt+" = "+jt+".descendants(rn);"),j(-1),k.push(V+"}");break}k.push(V+" "+xt+" = "+xt+".descendants("+_t(Pt(0))+");");break;case JT.NEWARRAY:for(Lt=[],Nt=1;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));k.push(V+" "+bt(Pt(0)-1)+" = sec.AXArray.axBox(["+Lt.join(", ")+"]);");break;case JT.NEWOBJECT:k.push(V+" temp = Object.create(sec.AXObject.tPrototype);");for(Nt=1;Nt<=Pt(0);Nt++)k.push(V+" temp.axSetPublicProperty("+bt(2*Pt(0)-2*Nt+1)+", "+bt(2*Pt(0)-2*Nt)+");");k.push(V+" "+bt(2*Pt(0)-1)+" = temp;"),k.push(V+" temp = undefined;");break;case JT.NEWACTIVATION:k.push(V+" "+Et+" = sec.createActivation(context.mi, "+St+");");break;case JT.NEWCATCH:k.push(V+" "+Et+" = sec.createCatch(context.mi.getBody().catchBlocks["+Pt(0)+"], "+St+");");break;case JT.CONSTRUCTSUPER:for(Lt=[],Nt=1;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));k.push(V+" context.savedScope.superConstructor.call("+bt(Pt(0))+", "+Lt.join(", ")+");");break;case JT.CALLSUPER:for(Lt=[],Nt=1;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));k.push(V+" "+bt(Pt(0))+" = sec.box("+bt(Pt(0))+").axCallSuper("+_t(Pt(1))+", context.savedScope, ["+Lt.join(", ")+"]);");break;case JT.CALLSUPER_DYN:for(Lt=[],Nt=1;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));(Ft=M.getMultiname(Pt(1))).isRuntimeName()&&Ft.isRuntimeNamespace()?k.push(V+" "+bt(Pt(0)+2)+" = sec.box("+bt(Pt(0)+2)+").axGetSuper(context.runtimename("+_t(Pt(1))+", "+bt(Pt(0))+", "+bt(Pt(0)+1)+"), context.savedScope, ["+Lt.join(", ")+"]);"):k.push(V+" "+bt(Pt(0)+1)+" = sec.box("+bt(Pt(0)+1)+").axGetSuper(context.runtimename("+_t(Pt(1))+", "+bt(Pt(0))+"), context.savedScope, ["+Lt.join(", ")+"]);");break;case JT.CALLSUPERVOID:for(Lt=[],Nt=1;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));k.push(V+" sec.box("+bt(Pt(0))+").axCallSuper("+_t(Pt(1))+", context.savedScope, ["+Lt.join(", ")+"]);");break;case JT.CONSTRUCTPROP:for(Lt=[],Nt=1;Nt<=Pt(0);Nt++)Lt.push(bt(Pt(0)-Nt));k.push(V+" "+bt(Pt(0))+" = context.constructprop("+_t(Pt(1))+", "+bt(Pt(0))+", ["+Lt.join(", ")+"]);"),d(p)&&p.kill(bt(Pt(0)));break;case JT.GETPROPERTY:Ft=M.getMultiname(Pt(0));var Gt=!1;d(c)&&c.needSafe(xt)&&(Gt=!0,k.push(V+" "+c.beginSafeBlock(xt)),j(1));kt=void 0;if(d(p)&&(kt=p.sureThatFast(xt,Ft.name))){Vt=kt.isMangled?Kv.getPublicMangledName(Ft.name):Ft.name;p.kill(xt),k.push(V+" /* We sure that this safe call */ "),k.push(V+" "+xt+" = "+xt+"['"+Vt+"'];");break}k.push(V+" // "+Ft),DO()&&(k.push(V+" if (!"+SO(xt)+") {"),k.push(V+"     "+xt+" = "+xt+"['"+Ft.name+"'];"),k.push(V+" } else {"),j(1)),k.push(V+" temp = "+xt+"[AX_CLASS_SYMBOL] ? "+xt+" : sec.box("+xt+");"),k.push(V+" "+xt+" = temp['$Bg"+Ft.name+"'];"),k.push(V+" if ("+xt+" === undefined || typeof "+xt+" === 'function') {"),k.push(V+"     "+xt+" = temp.axGetProperty("+_t(Pt(0))+");"),k.push(V+" }"),DO()&&(j(-1),k.push(V+" }")),Gt&&(j(-1),k.push(V+" "+c.endSafeBlock("undefined")));break;case JT.GETPROPERTY_DYN:Ft=M.getMultiname(Pt(0));d(c)&&c.markToSafe(Ft)&&k.push(V+" /* Mark lookup to safe call, "+c.constructor.name+" */");var Qt;jt=(Qt=Ft.isRuntimeName()&&Ft.isRuntimeNamespace())?wt:Ct;k.push(V+" // "+Ft),k.push(V+" {"),j(1),Qt?k.push(V+" const rm = context.runtimename("+_t(Pt(0))+", "+xt+", "+Ct+");"):k.push(V+" const rm = context.runtimename("+_t(Pt(0))+", "+xt+");"),k.push(V+" const b_obj = "+jt+"[AX_CLASS_SYMBOL] ? "+jt+" : sec.box("+jt+");\n"),k.push(V+" if (typeof rm === 'number') {"),k.push(V+"     "+jt+" = b_obj.axGetNumericProperty(rm);"),k.push(V+" } else {"),j(1),k.push(V+" "+jt+" = b_obj['$Bg' + rm.name];"),k.push(V+" if ("+jt+" === undefined || typeof "+jt+" === 'function') {"),k.push(V+"     "+jt+" = b_obj.axGetProperty(rm);"),k.push(V+" }"),j(-1),k.push(V+" }"),j(-1),k.push(V+" }");break;case JT.SETPROPERTY:Ft=M.getMultiname(Pt(0));k.push(V+" // "+Ft),DO()&&(k.push(V+" if (!"+SO(Ct)+"){"),k.push(V+"     "+Ct+"['"+Ft.name+"'] = "+xt+";"),k.push(V+" } else {"),j(1)),k.push(V+" context.setproperty("+_t(Pt(0))+", "+xt+", "+Ct+");"),DO()&&(j(-1),k.push(V+" }"));break;case JT.SETPROPERTY_DYN:(Ft=M.getMultiname(Pt(0))).isRuntimeName()&&Ft.isRuntimeNamespace()?k.push(V+" context.setproperty(context.runtimename("+_t(Pt(0))+", "+Ct+", "+wt+"), "+xt+", "+It+");"):k.push(V+" context.setproperty(context.runtimename("+_t(Pt(0))+", "+Ct+"), "+xt+", "+wt+");");break;case JT.DELETEPROPERTY:k.push(V+" // "+M.getMultiname(Pt(0))),k.push(V+" "+xt+" = context.deleteproperty("+_t(Pt(0))+", "+xt+");");break;case JT.DELETEPROPERTY_DYN:(Ft=M.getMultiname(Pt(0))).isRuntimeName()&&Ft.isRuntimeNamespace()?k.push(V+" "+wt+" = context.deleteproperty(context.runtimename("+_t(Pt(0))+", "+xt+", "+Ct+"), "+wt+");"):k.push(V+" "+Ct+" = context.deleteproperty(context.runtimename("+_t(Pt(0))+", "+xt+"), "+Ct+");");break;case JT.GETSUPER:k.push(V+" "+xt+" = sec.box("+xt+").axGetSuper("+_t(Pt(0))+", context.savedScope);");break;case JT.GETSUPER_DYN:(Ft=M.getMultiname(Pt(0))).isRuntimeName()&&Ft.isRuntimeNamespace()?k.push(V+" "+wt+" = sec.box("+wt+").axGetSuper(context.runtimename("+_t(Pt(0))+", "+xt+", "+Ct+"), context.savedScope);"):k.push(V+" "+Ct+" = sec.box("+Ct+").axGetSuper(context.runtimename("+_t(Pt(0))+", "+xt+"), context.savedScope);");break;case JT.SETSUPER:k.push(V+" sec.box("+Ct+").axSetSuper("+_t(Pt(0))+", context.savedScope, "+xt+");");break;case JT.SETSUPER_DYN:(Ft=M.getMultiname(Pt(0))).isRuntimeName()&&Ft.isRuntimeNamespace()?k.push(V+" sec.box("+It+").axSetSuper(context.runtimename("+_t(Pt(0))+", "+Ct+", "+wt+"), context.savedScope, "+xt+");"):k.push(V+" sec.box("+wt+").axSetSuper(context.runtimename("+_t(Pt(0))+", "+Ct+"), context.savedScope, "+xt+");");break;case JT.GETLEX:Ft=M.getMultiname(Pt(0));if(d(u)&&u.test(Ft)){if(k.push(V+" // "+Ft),k.push(V+" /* GenerateLexImports */"),k.push(V+" "+Et+" = "+u.getLexAlias(Ft,{nameAlias:_t(Pt(0))})+";"),p){Ut=u.getGenerator(Ft)instanceof RO;p.mark(Et,et,Ut,Ft,!0)}}else k.push(V+" // "+Ft),k.push(V+" temp = "+St+".findScopeProperty("+_t(Pt(0))+", true, false);"),k.push(V+" "+Et+" = temp['$Bg"+Ft.name+"'];"),k.push(V+" if ("+Et+" === undefined || typeof "+Et+" === 'function') {"),k.push(V+"     "+Et+" = temp.axGetProperty("+_t(Pt(0))+");"),k.push(V+" }");break;case JT.RETURNVALUE:if(NO&&NO[w+"__return"]&&(k.push(V+" /* ATTACH METHOD HOOK */"),k.push(V+" context.executeHook(local0, '"+w+"__return')")),"Boolean"===(null===(o=t.getTypeName())||void 0===o?void 0:o.name)){k.push(V+" return !!"+xt+";");break}k.push(V+" return "+xt+";");break;case JT.RETURNVOID:NO&&NO[w+"__return"]&&(k.push(V+" /* ATTACH METHOD HOOK */"),k.push(V+" context.executeHook(local0, '"+w+"__return')")),k.push(V+" return;");break;case JT.COERCE:if(4&a&&(yt.name===JT.PUSHNULL||yt.name===JT.PUSHUNDEFINED)){k.push(V+" // SKIP_NULL_COERCE");break}if(yt.name===JT.ASTYPELATE){k.push(V+" // SKIP DOUBLED COERCE AFTER ASTYPELATE");break}Ft=M.getMultiname(Pt(0));k.push(V+" if ("+SO(xt)+") {"),k.push(j(1)+" var _e = "+St+".getScopeProperty("+_t(Pt(0))+", true, false);"),k.push(V+" _e || console.warn('["+y+"] Coerce Type not found:', "+JSON.stringify(Ft.name)+")"),k.push(V+" "+xt+" = _e ? _e.axCoerce("+xt+") : "+xt+";"),k.push(j(-1)+" }");break;case JT.COERCE_A:k.push(V+" ;");break;case JT.COERCE_S:if(4&a&&(yt.name===JT.PUSHNULL||yt.name===JT.PUSHUNDEFINED)){k.push(V+" // SKIP_NULL_COERCE");break}k.push(V+" "+xt+" = context.axCoerceString("+xt+");");break;case JT.ESC_XELEM:k.push(V+" "+xt+" = context.escXElem("+xt+");");break;case JT.ESC_XATTR:k.push(V+" "+xt+" = context.escXAttr("+xt+");");break;case JT.CONVERT_I:k.push(V+" "+xt+" |= 0;");break;case JT.CONVERT_D:k.push(V+" "+xt+" = +"+xt+";");break;case JT.CONVERT_B:k.push(V+" "+xt+" = !!"+xt+";");break;case JT.CONVERT_U:k.push(V+" "+xt+" >>>= 0;");break;case JT.CONVERT_S:k.push(V+" if (typeof "+xt+" !== 'string') "+xt+" = "+xt+" + '';");break;case JT.CONVERT_O:k.push(V+" ;");break;case JT.CHECKFILTER:k.push(V+" "+xt+" = context.axCheckFilter(sec, "+xt+");");break;case JT.KILL:k.push(V+" "+Tt(Pt(0))+" = undefined;");break;default:if(!(8&a))switch(At.name){case JT.SI8:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" domainMemory.setInt8("+xt+", "+Ct+")");break;case JT.SI16:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" domainMemory.setInt16("+xt+", "+Ct+", true);");break;case JT.SI32:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" domainMemory.setInt32("+xt+", "+Ct+", true);");break;case JT.SF32:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" domainMemory.setFloat32("+xt+", "+Ct+", true);");break;case JT.SF64:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" domainMemory.setFloat64("+xt+", "+Ct+", true);");break;case JT.LI8:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" "+xt+" = domainMemory.getInt8("+xt+")");break;case JT.LI16:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" "+xt+" = getInt16("+xt+", true);");break;case JT.LI32:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" "+xt+" = domainMemory.getInt32("+xt+", true);");break;case JT.LF32:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" "+xt+" = domainMemory.getFloat32("+xt+", true);");break;case JT.LF64:k.push(V+" domainMemory = domainMemory || context.domainMemory;"),k.push(V+" "+xt+" = domainMemory.getFloat64("+xt+", true);")}if(At.name<=JT.LI8&&At.name>=JT.SF64)return k.push(V+" //unknown instruction "+FO[B[et].name]),{error:{message:"unhandled instruction "+At,reason:"unhandled_instruction"}}}}if(gt=P?P[At.position]:null)(vt=G.pop())&&(j(-1),k.push(V+"}"),Q(vt))}G.length>0&&((vt=G.pop())&&(j(-1),k.push(V+"}"),Q(vt)));mt&&(k.push(j(-1)+" }"),k.push(j(-1)+" }")),k.push(j(-1)+" }"),j(-1);for(var zt=[],Ht=0,Xt=pt;Ht<Xt.length;Ht++){var qt=Xt[Ht];qt&&(qt.die&&zt.push("        // local"+qt.index+" is assigned before read, skip init"),zt.push("        let local"+qt.index+" = undefined"),1&a||qt.index!=J.length+1||qt.die||(zt.push("    if(arguments && arguments.length) { local"+qt.index+" = context.sec.createArrayUnsafe(Array.from(arguments).slice("+J.length+")); }"),zt.push("    else { local"+qt.index+" = context.emptyArray; }")))}F[ht]=zt.join("\n");var Yt=["const AX_CLASS_SYMBOL = context.AX_CLASS_SYMBOL;"];d(u)&&Yt.push(u.genHeader(V));var Kt=I+Yt.join("\n")+F.join("\n")+"\n"+k.join("\n"),Wt=Kt.indexOf(Z)>-1,Jt=function(t,e){t+="\n//# sourceURL=http://jit/"+e+".js";try{return new Function("context",t)}catch(e){throw new Error("Compiler error:\n\n"+t)}}(Kt,m),Zt=-1;Wt&&(Zt=Kt.split("\n").findIndex((function(t){return t.indexOf(Z)>=0}))+3),d(u)&&u.reset(),d(c)&&c.reset(),pP.end();var $t=null;return Wt&&($t={message:"STACK UNDERRUN at http://jit/"+g+".js:"+Zt,reason:"underrun"}),{names:dt,compiled:Jt,error:$t}}var zO=function(){function t(t,e,i){this.jsGlobal=vh,this.axCoerceString=Yv,this.axCheckFilter=GT,this.internNamespace=Xv,this.AX_CLASS_SYMBOL=eb,this.mi=t,this.savedScope=e,this.rn=new Kv(t.abc,0,null,null,null,null,!0),this.abc=t.abc,this.sec=t.abc.applicationDomain.sec,this.names=i,this.emptyArray=Object.create(this.sec.AXArray.tPrototype),this.emptyArray.value=[]}return Object.defineProperty(t.prototype,"domainMemory",{get:function(){return this.domain||(this.domain=this.sec.flash.system.ApplicationDomain.axClass.currentDomain,this.domain)?this.domain.internal_memoryView:(console.warn("[JIT] Try access to domainMemory on unresolved ApplicationDomain!"),null)},enumerable:!0,configurable:!0}),t.prototype.escXElem=function(t){return JD(this.sec,t)},t.prototype.escXAttr=function(t){return ZD(t)},t.prototype.executeHook=function(t,e){var i=NO[e];i&&i.hook(t)},t.prototype.getTopLevel=function(t,e){var i=this.savedScope.findScopeProperty(this.names[t],!0,!1);return e?i[e]:i},t.prototype.getStaticImportExt=function(t,e){return void 0===e&&(e=void 0),IO(e,t)},t.prototype.typeof=function(t){var e=typeof t,i=this.sec;switch(e){case"boolean":return"Boolean";case"object":if(null===t)return"object";if(i.AXXMLList.dPrototype.isPrototypeOf(t)||i.AXXML.dPrototype.isPrototypeOf(t))return"xml";if(i.AXNumber.dPrototype.isPrototypeOf(t))return"number";if(i.AXBoolean.dPrototype.isPrototypeOf(t))return"Boolean";if(i.AXString.dPrototype.isPrototypeOf(t))return"string"}return e},t.prototype.call=function(t,e,i){return Ab(this.sec,t,i.length),t.axApply(e,i)},t.prototype.getdefinitionbyname=function(t,e,i){return t.global.object.scriptInfo.abc.env.app.getClass(Kv.FromSimpleName(i[0]))},t.prototype.getpropertydyn=function(t,e){var i=this.sec.box(e);if("number"==typeof t)return i.axGetNumericProperty(t);var n=i["$Bg"+t.name];return null!=n&&"function"!=typeof n?n:i.axGetProperty(t)},t.prototype.setproperty=function(t,e,i){var n,r;if(null==i)throw new Error("[AVM2] Unexpected property assignment: "+typeof i+"["+JSON.stringify(null===(n=t)||void 0===n?void 0:n.name)+"] = "+(null===(r=e)||void 0===r?void 0:r.toString()));if(i[eb])return"number"==typeof t?i.axSetNumericProperty(t,e):i[xO]?(bb.prototype.axSetProperty.call(i,t,e,JT.INITPROPERTY),void Object.defineProperty(i,t.name,{value:e,configurable:!0,writable:!0})):void i.axSetProperty(t,e,JT.INITPROPERTY);i[t.name]=e},t.prototype.deleteproperty=function(t,e){var i=this.sec.box(e);return"number"==typeof t||"string"==typeof t?delete i[t]:i.axDeleteProperty(t)},t.prototype.construct=function(t,e){var i=EO(t.classInfo.instanceInfo.getName().name,e);return null!=i?i:(vb(this.sec,t,e.length),t.axConstruct(e))},t.prototype.constructprop=function(t,e,i){var n=EO(t,i);if(null!=n)return n;var r=this.sec.box(e),o=r.axResolveMultiname(t),s=r[o];return vb(r.sec,s,i.length),s.axConstruct(i)},t.prototype.pushwith=function(t,e){var i=this.sec.box(e);return t.object===i&&1==t.isWith?t:new NT(t,i,!0)},t.prototype.hasnext2=function(e,i){var n=t.HAS_NEXT_INFO;return null==e?[null,0]:(n.next(e[eb]?e:this.sec.box(e),i),[n.object,n.index])},t.prototype.runtimename=function(t,e,i){if(this.rn.resolved={},this.rn.script=null,this.rn.numeric=!1,this.rn.id=t.id,this.rn.kind=t.kind,t.isRuntimeName()){var n=e;if(n&&n.axClass&&n.axClass===n.sec.AXQName)return n=n.name,this.rn.kind=t.isAttribute()?18:17,this.rn.id=n.id,this.rn.name=n.name,this.rn.namespaces=n.namespaces,this.rn;if("number"==typeof n)this.rn.numeric=!0,this.rn.numericValue=n;else{var r=hb(n);zh(r)&&(this.rn.numeric=!0,this.rn.numericValue=+r)}this.rn.name=n,this.rn.id=-1}else this.rn.name=t.name,i=e;if(t.isRuntimeNamespace()){var o=i;o._ns&&(o=o._ns),this.rn.namespaces=[o],this.rn.id=-1}else this.rn.namespaces=t.namespaces;return this.rn},t.HAS_NEXT_INFO=new kT(null,0),t}(),HO=0,XO=function(){function t(t){this.parent=t,this.stack=[],this.isWith=[]}return t.prototype.push=function(t,e){this.stack.push(t),this.isWith.push(!!e)},t.prototype.get=function(t){return this.stack[t]},t.prototype.clear=function(){this.stack.length=0,this.isWith.length=0},t.prototype.pop=function(){this.isWith.pop(),this.stack.pop(),this.scopes&&this.scopes.length>this.stack.length&&this.scopes.length--},t.prototype.topScope=function(){if(!this.scopes){if(0===this.stack.length)return this.parent;this.scopes=[]}for(var t=this.parent,e=0;e<this.stack.length;e++){var i=this.stack[e],n=this.isWith[e],r=this.scopes[e];r&&r.parent===t&&r.object===i&&r.isWith===n||(r=this.scopes[e]=new NT(t,i,n)),t=r}return t},t}();function qO(t,e,i){if(i.resolved={},i.script=null,i.numeric=!1,i.id=e.id,i.kind=e.kind,e.isRuntimeName()){var n=t.pop();if(n&&n.axClass&&n.axClass===n.sec.AXQName)return n=n.name,i.kind=e.isAttribute()?18:17,i.id=n.id,i.name=n.name,void(i.namespaces=n.namespaces);("number"==typeof n||zh(hb(n)))&&(i.numeric=!0,i.numericValue=+hb(n)),i.name=n,i.id=-1}else i.name=e.name;if(e.isRuntimeNamespace()){var r=t.pop();r._ns&&(r=r._ns),i.namespaces=[r],i.id=-1}else i.namespaces=e.namespaces}function YO(t,e,i){if(of.forceINT)try{return WO(t,e,i)}catch(t){throw t}if(null==t.getBody())return function(){};if("pending"===t.state){var n=QO(t,{scope:e});n.error?t.error=n.error:(t.compiled=n.compiled,t.names=n.names)}return"compiled"===t.state?(t.useCount++,t.compiled(new zO(t,e,t.names))):(t.useCount++,WO(t,e,i))}var KO=function(){function t(t,e,i,n,r){this.pc=0,this.stack=[],this.hasNext2Infos=null;var o=this.body=e.getBody();this.code=o.code,this.scopes=new XO(i);for(var s,a=this.locals=[t],l=this.app=e.abc.applicationDomain,u=this.sec=l.sec,c=n.length,h=0,p=e.parameters.length;h<p;h++){var d=e.parameters[h];s=h<c?n[h]:d.hasOptionalValue()?d.getOptionalValue():void 0;var f=d.getType();if(f&&!f.isAnyName()){var _=i.getScopeProperty(f,!0,!1);if(!_){if(!("axClass"in t)||!t.axClass.name.matches(f))continue;_=t.axClass}s=_.axCoerce(s)}a.push(s)}if(e.needsRest())a.push(u.createArrayUnsafe(Yb(n,e.parameters.length)));else if(e.needsArguments()){var m=Yb(n,0),g=Object.create(u.argumentsPrototype);g.value=m,g.callee=r,g.receiver=t,g.methodInfo=e,a.push(g)}}return t.prototype.bc=function(){return this.code[this.pc++]},t.prototype.u30=function(){var t=this.code,e=this.pc,i=t[e++];return 128&i&&16384&(i=127&i|t[e++]<<7)&&2097152&(i=16383&i|t[e++]<<14)&&268435456&(i=2097151&i|t[e++]<<21)&&(i=268435455&i|t[e++]<<28,i&=4294967295),this.pc=e,i>>>0},t.prototype.s24=function(){var t=this.code,e=this.pc,i=t[e]|t[e+1]<<8|t[e+2]<<16;return this.pc=e+3,i<<8>>8},t.prototype.getHasNext2Info=function(){var t=this.pc,e=this.hasNext2Infos;return e||(e=this.hasNext2Infos=[]),e[t]||(e[t]=new kT(null,0)),e[t]},t}();function WO(t,e,i){return t.error&&t.useCount<=1&&(++HO<100?console.error("[INTERPRET] Compilation failed",t.error.reason,t.error.message):console.debug("[INTERPRET] To many compiler failings:",HO)),function(){var n,r,o,s,a,l,u,c,h=new KO(this,t,e,arguments,i),p=h.stack,d=h.locals,f=h.scopes,_=h.sec,m=t.abc,g=new Kv(m,0,null,null,null,null,!0),y=[],A=0,v=Cb.length;Cb.push(h.scopes);t:for(;;)try{var b=h.bc();switch(b){case 9:continue;case 3:throw p.pop();case 8:d[h.u30()]=void 0;break;case 12:case 24:l=h.s24(),p.pop()<=p.pop()&&(h.pc+=l);continue;case 13:case 23:l=h.s24(),p.pop()<p.pop()&&(h.pc+=l);continue;case 14:case 22:l=h.s24(),p.pop()>=p.pop()&&(h.pc+=l);continue;case 15:case 21:l=h.s24(),p.pop()>p.pop()&&(h.pc+=l);continue;case 16:h.pc=h.s24()+h.pc;continue;case 17:l=h.s24(),p.pop()&&(h.pc+=l);continue;case 18:l=h.s24(),p.pop()||(h.pc+=l);continue;case 19:l=h.s24(),VT(p.pop(),p.pop(),_)&&(h.pc+=l);continue;case 20:l=h.s24(),VT(p.pop(),p.pop(),_)||(h.pc+=l);continue;case 25:l=h.s24(),p.pop()==p.pop()&&(h.pc+=l);continue;case 26:l=h.s24(),p.pop()!=p.pop()&&(h.pc+=l);continue;case 27:var x=h.pc-1;l=h.s24();var C=h.u30();(u=p.pop())<=C&&(h.pc+=3*u,l=h.s24()),h.pc=x+l;continue;case 29:f.pop();break;case 30:p[p.length-2]=_.box(p[p.length-2]).axNextName(p.pop());break;case 35:p[p.length-2]=_.box(p[p.length-2]).axNextValue(p.pop());break;case 50:var w=h.getHasNext2Info(),I=h.u30(),E=h.u30();w.next(_.box(d[I]),d[E]),d[I]=w.object,d[E]=w.index,p.push(!!w.index);break;case 32:p.push(null);break;case 33:p.push(void 0);break;case 36:p.push(h.code[h.pc++]<<24>>24);break;case 37:p.push(h.u30()<<16>>16);break;case 44:p.push(m.getString(h.u30()));break;case 45:p.push(m.ints[h.u30()]);break;case 46:p.push(m.uints[h.u30()]);break;case 47:p.push(m.doubles[h.u30()]);break;case 38:p.push(!0);break;case 39:p.push(!1);break;case 40:p.push(NaN);break;case 41:p.pop();break;case 42:p.push(p[p.length-1]);break;case 43:n=p[p.length-1],p[p.length-1]=p[p.length-2],p[p.length-2]=n;break;case 48:f.push(_.box(p.pop()),!1);break;case 28:f.push(_.box(p.pop()),!0);break;case 49:p.push(_.AXNamespace.FromNamespace(m.getNamespace(h.u30())));break;case 64:p.push(_.createFunction(m.getMethodInfo(h.u30()),f.topScope(),!0));break;case 65:yf(p,h.u30(),y),r=p.pop(),Ab(_,n=p[p.length-1],y.length),p[p.length-1]=n.axApply(r,y);break;case 66:yf(p,h.u30(),y),o=_.box(p[p.length-1]),vb(_,o,y.length),p[p.length-1]=o.axConstruct(y);break;case 71:return void Cb.length--;case 72:return n=p.pop(),t.returnTypeNameIndex&&(o=t.getType())&&(n=o.axCoerce(n)),Cb.length--,n;case 73:yf(p,h.u30(),y),e.object.superClass.tPrototype.axInitializer.apply(p.pop(),y);break;case 74:u=h.u30(),yf(p,h.u30(),y),qO(p,m.getMultiname(u),g),p[p.length-1]=_.box(p[p.length-1]).axConstructProperty(g,y);break;case 76:case 70:case 79:u=h.u30(),yf(p,h.u30(),y),qO(p,m.getMultiname(u),g),c=_.box(p[p.length-1]).axCallProperty(g,y,76===b),79===b?p.length--:p[p.length-1]=c;break;case 69:case 78:u=h.u30(),yf(p,h.u30(),y),qO(p,m.getMultiname(u),g),c=_.box(p[p.length-1]).axCallSuper(g,e,y),78===b?p.length--:p[p.length-1]=c;break;case 83:yf(p,h.u30(),y),p[p.length-1]=_.applyType(p[p.length-1],y);break;case 85:r=Object.create(_.AXObject.tPrototype),A=h.u30();for(var S=p.length-2*A;S<p.length;S+=2)n=p[S+1],r.axSetPublicProperty(p[S],n);p.length-=2*A,p.push(r);break;case 86:r=[],A=h.u30();for(S=p.length-A;S<p.length;S++)r.push(p[S]);p.length-=A,p.push(_.AXArray.axBox(r));break;case 87:p.push(_.createActivation(t,f.topScope()));break;case 88:n=p[p.length-1],p[p.length-1]=_.createClass(m.classes[h.u30()],n,f.topScope());break;case 89:qO(p,m.getMultiname(h.u30()),g),void 0===g.name&&(g.name="*"),p[p.length-1]=jT(p[p.length-1],g,_);break;case 90:p.push(_.createCatch(h.body.catchBlocks[h.u30()],f.topScope()));break;case 94:case 93:qO(p,m.getMultiname(h.u30()),g),p.push(f.topScope().findScopeProperty(g,93===b,!1));break;case 96:qO(p,m.getMultiname(h.u30()),g),p.push(f.topScope().findScopeProperty(g,!0,!1).axGetProperty(g));break;case 104:case 97:n=p.pop(),qO(p,m.getMultiname(h.u30()),g),_.box(p.pop()).axSetProperty(g,n,104,t);break;case 102:qO(p,m.getMultiname(h.u30()),g),p[p.length-1]=_.box(p[p.length-1]).axGetProperty(g);break;case 106:qO(p,m.getMultiname(h.u30()),g),p[p.length-1]=_.box(p[p.length-1]).axDeleteProperty(g);break;case 4:qO(p,m.getMultiname(h.u30()),g),p[p.length-1]=_.box(p[p.length-1]).axGetSuper(g,e);break;case 5:n=p.pop(),qO(p,m.getMultiname(h.u30()),g),_.box(p.pop()).axSetSuper(g,e,n);break;case 98:p.push(d[h.u30()]);break;case 99:d[h.u30()]=p.pop();break;case 100:p.push(e.global.object);break;case 101:p.push(f.get(h.code[h.pc++]));break;case 108:p[p.length-1]=_.box(p[p.length-1]).axGetSlot(h.u30());break;case 109:n=p.pop(),_.box(p.pop()).axSetSlot(h.u30(),n);break;case 110:p[p.length-1]=e.global.object.axGetSlot(h.u30());break;case 111:n=p.pop(),e.global.object.axSetSlot(h.u30(),n);break;case 114:p[p.length-1]=ZD(p[p.length-1]);break;case 113:p[p.length-1]=JD(_,p[p.length-1]);break;case 131:case 115:p[p.length-1]|=0;break;case 136:case 116:p[p.length-1]>>>=0;break;case 132:case 117:p[p.length-1]=+p[p.length-1];break;case 129:case 118:p[p.length-1]=!!p[p.length-1];break;case 133:p[p.length-1]=Yv(p[p.length-1]);break;case 112:p[p.length-1]=QT(p[p.length-1]);break;case 120:p[p.length-1]=GT(_,p[p.length-1]);break;case 128:qO(p,m.getMultiname(h.u30()),g),p[p.length-1]=f.topScope().getScopeProperty(g,!0,!1).axCoerce(p[p.length-1]);break;case 130:break;case 134:qO(p,m.getMultiname(h.u30()),g),p[p.length-1]=f.topScope().getScopeProperty(g,!0,!1).axAsType(p[p.length-1]);break;case 135:p[p.length-2]=p.pop().axAsType(p[p.length-1]);break;case 137:r=p[p.length-1],p[p.length-1]=null==r?null:r;break;case 144:p[p.length-1]=-p[p.length-1];break;case 145:++p[p.length-1];break;case 146:++d[h.u30()];break;case 147:--p[p.length-1];break;case 148:--d[h.u30()];break;case 149:p[p.length-1]=HT(p[p.length-1],_);break;case 150:p[p.length-1]=!p[p.length-1];break;case 151:p[p.length-1]=~p[p.length-1];break;case 160:a=p.pop(),s=p[p.length-1],p[p.length-1]="number"==typeof s&&"number"==typeof a?s+a:zT(s,a,_);break;case 161:p[p.length-2]-=p.pop();break;case 162:p[p.length-2]*=p.pop();break;case 163:p[p.length-2]/=p.pop();break;case 164:p[p.length-2]%=p.pop();break;case 165:p[p.length-2]<<=p.pop();break;case 166:p[p.length-2]>>=p.pop();break;case 167:p[p.length-2]>>>=p.pop();break;case 168:p[p.length-2]&=p.pop();break;case 169:p[p.length-2]|=p.pop();break;case 170:p[p.length-2]^=p.pop();break;case 171:p[p.length-2]=VT(p[p.length-2],p.pop(),_);break;case 172:p[p.length-2]=p[p.length-2]===p.pop();break;case 173:p[p.length-2]=p[p.length-2]<p.pop();break;case 174:p[p.length-2]=p[p.length-2]<=p.pop();break;case 175:p[p.length-2]=p[p.length-2]>p.pop();break;case 176:p[p.length-2]=p[p.length-2]>=p.pop();break;case 177:p[p.length-2]=p.pop().axIsInstanceOf(p[p.length-1]);break;case 178:qO(p,m.getMultiname(h.u30()),g),p[p.length-1]=f.topScope().findScopeProperty(g,!0,!1).axIsType(p[p.length-1]);break;case 179:p[p.length-2]=p.pop().axIsType(p[p.length-1]);break;case 180:o=_.box(p.pop());var D=p[p.length-1];p[p.length-1]=D&&D.axClass===_.AXQName?o.axHasProperty(D.name):o.axHasPublicProperty(D);break;case 192:p[p.length-1]=1+(0|p[p.length-1]);break;case 193:p[p.length-1]=(0|p[p.length-1])-1;break;case 194:d[u=h.u30()]=1+(0|d[u]);break;case 195:d[u=h.u30()]=(0|d[u])-1;break;case 196:p[p.length-1]=-(0|p[p.length-1]);break;case 197:p[p.length-2]=(0|p[p.length-2])+(0|p.pop())|0;break;case 198:p[p.length-2]=(0|p[p.length-2])-(0|p.pop())|0;break;case 199:p[p.length-2]=(0|p[p.length-2])*(0|p.pop())|0;break;case 208:p.push(d[0]);break;case 209:p.push(d[1]);break;case 210:p.push(d[2]);break;case 211:p.push(d[3]);break;case 212:d[0]=p.pop();break;case 213:d[1]=p.pop();break;case 214:d[2]=p.pop();break;case 215:d[3]=p.pop();break;case 6:f.topScope().defaultNamespace=Xv(0,m.getString(h.u30()));break;case 7:f.topScope().defaultNamespace=Xv(0,p.pop());break;case 239:h.pc++,h.u30(),h.pc++,h.u30();break;case 240:case 241:h.u30();break;case 2:case 1:break;default:XT(b)}}catch(t){ab(t)||(t=JO(_,t,b,n,o,s,a,g,v+1));var T=h.body.catchBlocks;for(S=0;S<T.length;S++){var P=T[S];if(h.pc>=P.start&&h.pc<=P.end){var B=P.getType();if(!B||h.app.getClass(B).axIsType(t)){p.length=0,p.push(t),f.clear(),h.pc=P.target;continue t}}}throw Cb.length--,t}}}function JO(t,e,i,n,r,o,s,a,l){var u,c=e instanceof Error&&"string"==typeof e.name&&"string"==typeof e.message;if(c)if(e instanceof RangeError||"InternalError"===e.name){var h=Object.create(t.AXError.tPrototype);if(h._errorID=1023,"allocation size overflow"===e.message)return h.$Bgmessage="allocation size overflow",h;if(e.message.indexOf("recursion")>-1||e.message.indexOf("call stack size exceeded")>-1)return h.$Bgmessage="Stack overflow occurred",Cb.length=l,h}else if(e instanceof TypeError){if(e.message.indexOf("convert")>-1&&(e.message.indexOf("to primitive")>-1||e.message.indexOf("to string")>-1))return t.createError("TypeError",db.ConvertToPrimitiveError,"value");if("Conversion to Array failed"===e.message)return t.createError("TypeError",db.CheckTypeFailedError,"value","Array")}var p=!1;switch(i){case 65:if(!n||!n.axApply)return t.createError("TypeError",db.CallOfNonFunctionError,"value");break;case 66:if(!r||!r.axConstruct)return t.createError("TypeError",db.ConstructOfNonFunctionError);break;case 88:if(!n||!t.AXClass.axIsType(n))return t.createError("VerifyError",db.InvalidBaseClassError);break;case 78:case 73:p=!0;case 70:case 79:case 76:case 74:case 69:if(null===r)return t.createError("TypeError",db.ConvertNullToObjectError);if(void 0===r)return t.createError("TypeError",db.ConvertUndefinedToObjectError);if(!(r.axResolveMultiname(a)in r)){var d=p?r.axClass.superClass:r.axClass;return d.classInfo.instanceInfo.isSealed()?t.createError("ReferenceError",db.ReadSealedError,a.name,d.name.toFQNString(!1)):t.createError("TypeError",p?db.ConstructOfNonFunctionError:db.CallOfNonFunctionError,a.name)}if(c&&"RangeError"===e.name&&(e.message.indexOf("arguments array passed")>-1||e.message.indexOf("call stack size")>-1))return t.createError("RangeError",db.StackOverflowError);break;case 4:p=!0;case 102:if(null===r)return t.createError("TypeError",db.ConvertNullToObjectError);if(void 0===r)return t.createError("TypeError",db.ConvertUndefinedToObjectError);break;case 104:case 97:if(null===r)return t.createError("TypeError",db.ConvertNullToObjectError);if(void 0===r)return t.createError("TypeError",db.ConvertUndefinedToObjectError);var f=r.axResolveMultiname(a);if(f in r&&!1===pf(r,f).writable)return t.createError("ReferenceError",db.ConstWriteError,f,r.axClass.name.name);break;case 177:if(!r||!r.axIsInstanceOf)return t.createError("TypeError",db.CantUseInstanceofOnNonObjectError);break;case 134:case 135:if(r&&!r.axAsType)return t.createError("TypeError",db.ConvertNullToObjectError);case 178:case 179:if(null===r)return t.createError("TypeError",db.ConvertNullToObjectError);if(void 0===r)return t.createError("TypeError",db.ConvertUndefinedToObjectError);if(!r.axIsType)return t.createError("TypeError",db.IsTypeMustBeClassError);break;case 128:if(!r)return t.createError("ReferenceError",db.ClassNotFoundError,a.toFQNString(!1));break;case 180:if(null===r)return t.createError("TypeError",db.ConvertNullToObjectError);if(void 0===r)return t.createError("TypeError",db.ConvertUndefinedToObjectError);break;case 19:case 20:case 171:if(typeof o!=typeof s&&("object"==typeof o&&o&&"object"!=typeof s||"object"==typeof s&&s&&"object"!=typeof o))return t.createError("TypeError",db.ConvertToPrimitiveError,"Object");break;default:if(!e||"string"!=typeof e.message||"string"!=typeof e.stack||"string"!=typeof e.name)break;u=e.message;var _,m=0===(_=e.stack.split("\n"))[0].indexOf("at ")?_[0].substr(3):_[0];switch(e.name){case"TypeError":if(0===m.indexOf("AXBasePrototype_valueOf")||0===m.indexOf("AXBasePrototype_toString"))return t.createError("TypeError",db.CallOfNonFunctionError,"value")}}u="Uncaught VM-internal exception during op "+XT(i)+": ";try{u+=e.toString(),_=e.stack}catch(t){u+="[Failed to stringify exception]"}t.player;return console.error(u,"\n",_),t.createError("Error",db.InternalErrorIV)}var ZO=function(){function t(t,e){this.sec=t,this.parent=e,this.system=e?e.system:this,this._abcs=[],this._binarySymbols={}}return t.prototype.addBinarySymbol=function(t){this._binarySymbols[t.className]=t},t.prototype.getBinarySymbol=function(t){return this._binarySymbols[t]},t.prototype.loadABC=function(t){co(this._abcs.indexOf(t)<0),this._abcs.push(t)},t.prototype.loadAndExecuteABC=function(t){this.loadABC(t),this.executeABC(t)},t.prototype.executeABC=function(t){var e=t.scripts[t.scripts.length-1];this.executeScript(e)},t.prototype.findClassInfo=function(t){for(var e=0;e<this._abcs.length;e++)for(var i=this._abcs[e],n=0;n<i.instances.length;n++){var r=i.classes[n];if(r.instanceInfo.getName().name===t)return r}return null},t.prototype.executeScript=function(t){co(0===t.state);var e=this.sec.createAXGlobal(this,t);t.global=e,t.state=1,YO(t.getInitializer(),e.scope,null).apply(e,[]),t.state=2},t.prototype.findProperty=function(t,e,i){var n=this.findDefiningScript(t,i);return n?n.global:null},t.prototype.getClass=function(t){var e=this.getProperty(t,!0,!0);return e&&!e.axApplicationDomain&&(e.axApplicationDomain=this),e},t.prototype.getProperty=function(t,e,i){var n=this.findProperty(t,e,i);if(n)return n.axGetProperty(t);"void"!=t.name&&this.sec.throwError("ReferenceError",db.DefinitionNotFoundError,t.name)},t.prototype.findDefiningScript=function(t,e){if(t.script)return t.script;var i;if(this.parent&&(i=this.parent.findDefiningScript(t,e)))return i;for(var n=0;n<this._abcs.length;n++){var r=this._abcs[n];if(i=this._findDefiningScriptInABC(r,t,e))return t.mutable||(t.script=i),i}var o=this.system.sec.findDefiningABC(t);return o?(this.loadABC(o),i=this._findDefiningScriptInABC(o,t,e),t.mutable||(t.script=i),i):null},t.prototype._findDefiningScriptInABC=function(t,e,i){for(var n=t.scripts,r=0;r<n.length;r++){var o=n[r],s=o.traits;if(s.resolve(),s.getTrait(e))return i&&0===o.state&&this.executeScript(o),o}return null},t}();function $O(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(n.indexOf(e)>=0){var r="!"===n[n.length-1];if(r&&(n=n.slice(0,n.length-1)),e!==n)continue;return r}}return!1}function tL(t,e,i){for(var n=0;n<e.traits.length;n++){var r=e.traits[n];if($O(t,r.getName().name)){if(r.isConst())return;var o=r.getName().name,s=r.getName().getMangledName();r.isSlot()?Object.defineProperty(i,o,{get:new Function("","return this."+s+"//# sourceURL=get-"+s+".as"),set:new Function("v","this."+s+" = v;//# sourceURL=set-"+s+".as")}):r.isGetter()?Object.defineProperty(i,o,{get:new Function("","return this."+s+"//# sourceURL=get-"+s+".as")}):r.toString()}}}function eL(t){return 0!==t.indexOf("native_")}var iL=["axResolveMultiname","axHasProperty","axDeleteProperty","axCallProperty","axCallSuper","axConstructProperty","axHasPropertyInternal","axHasOwnProperty","axSetProperty","axGetProperty","axGetSuper","axSetSuper","axNextNameIndex","axNextName","axNextValue","axGetEnumerableKeys","axHasPublicProperty","axSetPublicProperty","axGetPublicProperty","axCallPublicProperty","axDeletePublicProperty","axSetNumericProperty","axGetNumericProperty","axGetSlot","axSetSlot"];function nL(t){var e=t.classInfo.instanceInfo.getClassName(),i=HD[e]||XD[e];i&&function(t,e){if(t.asClass=e,e.classSymbols&&tL(e.classSymbols,t.classInfo.traits,t),e.instanceSymbols&&tL(e.instanceSymbols,t.classInfo.instanceInfo.traits,t.tPrototype),e.classNatives)for(var i=0;i<e.classNatives.length;i++)ff(t,e.classNatives[i],eL);if(ff(t,e,eL,!0,!0),t.superClass,e.instanceNatives)for(i=0;i<e.instanceNatives.length;i++)ff(t.dPrototype,e.instanceNatives[i],eL);ff(t.dPrototype,e.prototype,eL),_f(t.dPrototype,e.prototype,iL),e.classInitializer&&e.classInitializer.call(t,e)}(t,i)}var rL=function(t,e){for(var i=0,n=t.length;i<n;i++)e[t[i]]||(e[t[i]]=Object.create(null)),e=e[t[i]];return e};function oL(t,e,i,n,r){var o=n.split("."),s=o.pop();!function(t,e,i,n){Object.defineProperty(e,n,{get:function(){var r=t.getClass(i),o=function(){return r.axConstruct(arguments)};return o.axIsType=function(t){return r.axIsType(t)},o.axClass=r,Object.defineProperty(e,n,{value:o,writable:!1}),o},configurable:!0})}(t,e=rL(o,e),Kv.FromFQNString(i,r),s)}function sL(){this.sec.throwError("VerifierError",db.NotImplementedError,this.name.name)}function aL(t){return!1}function lL(t){return!(!t||"object"!=typeof t)&&t.axImplementsInterface(this)}function uL(t,e){df(t,"traits",e);for(var i=e.getTraitsList(),n=0;n<i.length;n++){var r=i[n],o=r;o.value instanceof Hv&&(o={value:yT.FromNamespace.call(t.sec.AXNamespace,o.value)}),Object.defineProperty(t,r.name.getMangledName(),o)}}function cL(t){return Xh(t)?null:(!t[eb]||t.__fast__||Array.isArray(t)&&(t.length&&t[0].__fast__||!t.length)||this.axIsType(t)||this.sec.throwError("TypeError",db.CheckTypeFailedError,t,this.classInfo.instanceInfo.getClassName()),t)}function hL(t){return this.dPrototype.isPrototypeOf(this.sec.box(t))}var pL=function(){},dL=function(){function t(){}return t.addOrphan=function(e){-1===t.orphans.indexOf(e)&&t.orphans.push(e)},t.removeOrphan=function(e){var i=t.orphans.indexOf(e);-1!==i&&t.orphans.splice(i,1)},t.updateOrphans=function(){for(var e,i=0;i<t.orphans.length;i++)(e=t.orphans[i]).isAsset(il)&&(e.advanceFrame(),el.execute_as3_constructors_recursiv(e))},t.orphans=[],t}(),fL=function(t,e){if(e){if(e.slots)for(var i=0;i<e.slots.length;i++)e.slots[i]&&(t[e.slots[i].name.getMangledName()]=e.slots[i].value);return e.superTraits&&fL(t,e.superTraits),t}};function _L(t){var e,i,n,r,o,s,a,l,u,c,h=Object.create(this.tPrototype);fL(h,this.tPrototype.traits);for(var p=null,d=null,f=this;f&&!d;)(p=f._symbol)&&p.timeline&&(d=p.timeline),f=f.superClass;if(d){var _=new il(d);h.adaptee=_;var m=!1;if(this._symbol){for(var g=this._symbol.symbolClass;g&&!m;)"UIComponent"==(null===(e=g.name)||void 0===e?void 0:e.name)?m=!0:"MovieClip"==(null===(i=g.name)||void 0===i?void 0:i.name)?g=null:"Sprite"==(null===(n=g.name)||void 0===n?void 0:n.name)?m=!0:g=g.superClass?g.superClass:null;var y=this._symbol.className;if(m||y&&y.includes("Font")){var A=_.timeline,v=A;v.frame_command_indices=[A.frame_command_indices[0]],v.frame_recipe=[A.frame_recipe[0]],v.keyframe_constructframes=[A.keyframe_constructframes[0]],v.keyframe_durations=[A.keyframe_durations[0]],v.keyframe_firstframes=[A.keyframe_firstframes[0]],v.keyframe_indices=[A.keyframe_indices[0]]}}_.reset(),el.execute_as3_constructors_recursiv(_)}var b,x=null===(a=null===(s=null===(o=null===(r=this.superClass)||void 0===r?void 0:r.classInfo)||void 0===o?void 0:o.instanceInfo)||void 0===s?void 0:s.name)||void 0===a?void 0:a.name;this.axApplicationDomain&&this.axApplicationDomain.awayApplicationDomain?b=this.axApplicationDomain.awayApplicationDomain:pL.loaderContext&&(b=pL.loaderContext.applicationDomain);var C=this.classInfo.instanceInfo.name,w=C.name,I=C.uri?C.uri+"."+w:w;if(!d&&b&&b.hasSymbolForClass(I)){var E=b.getSymbolAdaptee(I);E||console.warn("error: could not get asset "+x+" for class "+w+", no ActiveLoaderContext.loaderContext"),E&&(E instanceof il?h.adaptee.graphics=E.graphics:h.adaptee=E)}return"SimpleButton"==(null===(c=null===(u=null===(l=this.classInfo)||void 0===l?void 0:l.instanceInfo)||void 0===u?void 0:u.name)||void 0===c?void 0:c.name)&&(h.adaptee=new il),h[eb]=!0,h.axInitializer.apply(h,t),h.constructorHasRun=!0,h.adaptee instanceof il&&dL.addOrphan(h.adaptee),h.isAVMFont&&(h.fontName=w),h}function mL(t,e){return this.axCoerce(e?e[0]:void 0)}function gL(){}function yL(){var t=this.callee;if(t)return t;if(null===this.methodInfo.trait)return console.error("arguments.callee used on trait-less methodInfo function. Probably a constructor"),null;var e=this.methodInfo.trait.name;return this.receiver.axGetProperty(e)}function AL(t){return!!t}function vL(t){return"boolean"==typeof t}function bL(t){return"number"==typeof t}function xL(t){return 0|t}function CL(){return!1}function wL(t){return"number"==typeof t&&(0|t)===t}function IL(t){return t>>>0}function EL(t){return"number"==typeof t&&t>>>0===t}function SL(t){return t[0]}function DL(t){return this.dPrototype.isPrototypeOf(this.sec.box(t))||t===this.dPrototype}function TL(t){return t&&t.__fast__||this.axIsType(t)?t:null}function PL(t){var e=Object.create(this.tPrototype);return e.value=t,e}function BL(t,e){var i=e[0];return null==i?Object.create(this.tPrototype):i}function ML(t){var e=t[0];return null==e?Object.create(this.tPrototype):e}function OL(t){return null==t?null:t}var LL=function(){function t(){lb(),this.system=new ZO(this,null),this.application=new ZO(this,this.system),this.classAliases=new ED,this.nativeClasses=Object.create(null),this.vectorClasses=new Map,this._catalogs=[]}return Object.defineProperty(t.prototype,"xmlParser",{get:function(){return this._xmlParser||(this._xmlParser=new gT(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AXFunctionUndefinedPrototype",{get:function(){return this._AXFunctionUndefinedPrototype||(this._AXFunctionUndefinedPrototype=this.createObject())},enumerable:!0,configurable:!0}),t.prototype.addCatalog=function(t){this._catalogs.push(t)},t.prototype.findDefiningABC=function(t){for(var e=null,i=0;i<this._catalogs.length;i++){if(e=this._catalogs[i].getABCByMultiname(t))return e}return null},t.prototype.throwError=function(t,e,i,n,r,o){throw this.createError.apply(this,arguments)},t.prototype.createError=function(t,e,i,n,r,o){var s=yb.apply(null,Yb(arguments,1)),a=Kv.FromFQNString(t,0),l=this.system.getProperty(a,!0,!0);return l.axConstruct([s,e.code])},t.prototype.applyType=function(t,e){this.ObjectVector.axClass.superClass.dPrototype.isPrototypeOf(t.dPrototype)||this.throwError("TypeError",db.TypeAppOfNonParamType),1!==e.length&&this.throwError("TypeError",db.WrongTypeArgCountError,"__AS3__.vec::Vector",1,e.length);var i=e[0]||this.AXObject;return this.getVectorClass(i)},t.prototype.getVectorClass=function(t){var e=this.vectorClasses.get(t);if(e)return e;switch(t&&t.classInfo?t.classInfo.instanceInfo.getName().getMangledName():"$BgObject"){case"$BgNumber":case"$Bgdouble":e=this.Float64Vector.axClass;break;case"$Bgint":e=this.Int32Vector.axClass;break;case"$Bguint":e=this.Uint32Vector.axClass;break;default:e=this.createVectorClass(t)}return this.vectorClasses.set(t,e),e},t.prototype.createVectorClass=function(t){var e=this.ObjectVector.axClass,i=Object.create(e);return i.tPrototype=Object.create(e.tPrototype),i.tPrototype.axClass=i,i.tPrototype.axClassName=i.classInfo.instanceInfo.getClassName(),i.dPrototype=e.dPrototype,i.superClass=e,i.type=t,i},t.prototype.createObject=function(){return Object.create(this.AXObject.tPrototype)},t.prototype.createObjectFromJS=function(t,e){void 0===e&&(e=!1);for(var i=Object.keys(t),n=this.createObject(),r=0;r<i.length;r++){var o=t[i[r]];e&&(o=pD(this,o,!0)),n.axSetPublicProperty(i[r],o)}return n},t.prototype.createArrayUnsafe=function(t){var e=Object.create(this.AXArray.tPrototype);return e.value=t,e},t.prototype.createArray=function(t){var e=this.createArrayUnsafe([]);for(var i in t)e.axSetPublicProperty(i,t[i]);return e.length=t.length,e},t.prototype.boxFunction=function(t){var e=Object.create(this.AXFunction.tPrototype);return e.value=t,e},t.prototype.createClass=function(t,e,i){var n=t.instanceInfo,r=n.getName().toFQNString(!1),o=this.nativeClasses[r]||Object.create(this.AXClass.tPrototype),s=new NT(i,o);this.nativeClasses[r]?o.tPrototype.axInitializer=this.createInitializerFunction(t,s):n.isInterface()?(o.dPrototype=Object.create(this.objectPrototype),o.tPrototype=Object.create(o.dPrototype),o.tPrototype.axInitializer=sL,o.axIsInstanceOf=aL,o.axIsType=lL):(e===this.AXObject?o.dPrototype=Object.create(this.objectPrototype):e.dPrototype?o.dPrototype=Object.create(e.dPrototype):(o.dPrototype=Object.create(e.prototype),Object.defineProperty(o.dPrototype,xO,{value:!0})),o.tPrototype=Object.create(o.dPrototype),o.tPrototype.axInitializer=this.createInitializerFunction(t,s)),o.classInfo=o.dPrototype.classInfo=t,o.dPrototype.axClass=o,o.dPrototype.axClassName=t.instanceInfo.getClassName(),o.superClass=e,o.scope=i;var a=!!XD[r]&&XD[r].forceNativeMethods;"Object"!==r&&"Class"!==r&&this.initializeRuntimeTraits(o,e,s,a),mf(o.dPrototype,"$Bgconstructor",o),nL(o);var l=t.getInitializer(),u=l.getBody().code;return 208===u[0]&&48===u[1]&&71===u[2]||YO(l,s,null).apply(o,[o]),o},t.prototype.initializeRuntimeTraits=function(t,e,i,n){void 0===n&&(n=!1);var r,o=t.classInfo,s=o.instanceInfo;if(t===this.AXClass)r=s.traits.resolveRuntimeTraits(null,null,i,n);else{var a=this.AXClass.classInfo.instanceInfo.runtimeTraits;r=o.traits.resolveRuntimeTraits(a,null,i.parent,n)}o.runtimeTraits=r,uL(t,r);var l=e&&e[eb]?e.classInfo.instanceInfo.runtimeTraits:null,u=o.abc.getNamespace(s.protectedNs),c=s.traits.resolveRuntimeTraits(l,u,i,n);s.runtimeTraits=c,uL(t.tPrototype,c)},t.prototype.createFunction=function(t,e,i){var n=this.boxFunction(YO(t,e,n));return n.receiver={scope:e},n},t.prototype.createInitializerFunction=function(t,e){var i=t.instanceInfo.getInitializer(),n=function(t){var e,i=t.instanceInfo.getInitializer(),n=t.instanceInfo.getClassName(),r=HD[n]||XD[n];return i.isNative()||(null===(e=r)||void 0===e?void 0:e.forceNativeConstructor)?r:null}(t);if(!n){var r=this.application.getBinarySymbol(t.instanceInfo.getClassName());r?(r.buffer=r.data,n=function(){return jD.symbolForConstructor=r,YO(i,e,null).apply(this,arguments)}):n=YO(i,e,null),n.methodInfo=i}return n},t.prototype.createActivation=function(t,e){var i=t.getBody();return i.activationPrototype||(i.traits.resolve(),i.activationPrototype=Object.create(this.AXActivationPrototype),df(i.activationPrototype,"traits",i.traits.resolveRuntimeTraits(null,null,e))),Object.create(i.activationPrototype)},t.prototype.createCatch=function(t,e){if(!t.catchPrototype){var i=t.getTraits();t.catchPrototype=Object.create(this.AXCatchPrototype),df(t.catchPrototype,"traits",i.resolveRuntimeTraits(null,null,e))}return Object.create(t.catchPrototype)},t.prototype.box=function(t){if(null==t)return t;if(t.constructor===Array)return this.AXArray.axBox(t);switch(typeof t){case"number":return this.AXNumber.axBox(t);case"boolean":return this.AXBoolean.axBox(t);case"string":return this.AXString.axBox(t)}return t},t.prototype.isPrimitive=function(t){return tb(t)||this.AXPrimitiveBox.dPrototype.isPrototypeOf(t)},t.prototype.createAXGlobal=function(t,e){var i=Object.create(this.AXGlobalPrototype);i.applicationDomain=t,i.scriptInfo=e;var n=i.scope=new NT(null,i,!1),r=this.AXObject.classInfo.instanceInfo.runtimeTraits;return uL(i,e.traits.resolveRuntimeTraits(r,null,n)),i[eb]=!0,i},t.prototype.prepareRootClassPrototype=function(){var t=Object.create(this.objectPrototype),e=Object.create(t);e.$BgtoString=function(){return"[class "+this.classInfo.instanceInfo.getName().name+"]"};var i=mf;i(e,"axBox",SL),i(e,"axCoerce",cL),i(e,"axIsType",DL),i(e,"axAsType",TL),i(e,"axIsInstanceOf",hL),i(e,"axConstruct",_L),i(e,"axApply",mL),Object.defineProperty(e,"name",{get:function(){return this.classInfo.instanceInfo.name}}),e[eb]=!0,this.rootClassPrototype=e},t.prototype.initializeCoreNatives=function(){this.prepareRootClassPrototype();var t=this.prepareNativeClass("AXClass","Class",!1);t.classInfo=this.system.findClassInfo("Class"),t.defaultValue=null,(e=this.prepareNativeClass("AXObject","Object",!1)).classInfo=this.system.findClassInfo("Object");var e=this.AXObject;mf(this.prepareNativeClass("AXFunction","Function",!1),"axBox",PL);var i=new NT(null,t,!1),n=this.AXObject.classInfo,r=n.instanceInfo,o=r.runtimeTraits=r.traits.resolveRuntimeTraits(null,null,i);uL(this.AXObject.tPrototype,o);var s=this.AXClass.classInfo,a=s.instanceInfo;return a.runtimeTraits=a.traits.resolveRuntimeTraits(o,null,i),uL(this.AXClass.tPrototype,a.runtimeTraits),s.runtimeTraits=s.traits.resolveRuntimeTraits(o,null,i),uL(this.AXClass,s.runtimeTraits),n.runtimeTraits=n.traits.resolveRuntimeTraits(a.runtimeTraits,null,i),uL(this.AXObject,n.runtimeTraits),e[eb]=!0,e},t.prototype.prepareNativeClass=function(t,e,i){var n=Object.create(this.rootClassPrototype);if("Object"===e)n.dPrototype=Object.getPrototypeOf(this.objectPrototype),n.tPrototype=this.objectPrototype;else if("Class"===e)n.dPrototype=Object.getPrototypeOf(this.rootClassPrototype),n.tPrototype=this.rootClassPrototype;else{var r=i?this.AXPrimitiveBox.dPrototype:"AXMethodClosure"===t?this.AXFunction.dPrototype:this.objectPrototype;n.dPrototype=Object.create(r),n.tPrototype=Object.create(n.dPrototype)}return this[t]=this.nativeClasses[e]=n,n[eb]=!0,n},t.prototype.preparePrimitiveClass=function(t,e,i,n,r,o,s){var a=this.prepareNativeClass(t,e,!0),l=mf;return l(a,"axBox",PL),l(a,"axApply",(function(t,e){return i(e&&e.length?e[0]:n)})),l(a,"axConstruct",(function(t){return i(t&&t.length?t[0]:n)})),l(a,"axCoerce",r),l(a,"axIsType",o),l(a,"axIsInstanceOf",s),l(a.dPrototype,"value",n),a[eb]=!0,a},t.prototype.initialize=function(){var t=mf,e=Object.create(sb);e.sec=this,Object.defineProperty(this,"objectPrototype",{value:Object.create(e)}),this.initializeCoreNatives(),this.AXGlobalPrototype=Object.create(this.objectPrototype),this.AXGlobalPrototype.$BgtoString=function(){return"[object global]"},this.AXActivationPrototype=Object.create(this.objectPrototype),this.AXActivationPrototype.$BgtoString=function(){return"[Activation]"},this.AXCatchPrototype=Object.create(this.objectPrototype),this.AXCatchPrototype.$BgtoString=function(){return"[Catch]"};var i=this.AXObject,n=this.AXFunction;t(i,"axApply",BL),t(i,"axConstruct",ML),t(i.tPrototype,"axInitializer",gL),t(i,"axCoerce",OL),this.prepareNativeClass("AXMethodClosure","builtin.as$0.MethodClosure",!1),this.prepareNativeClass("AXError","Error",!1),this.prepareNativeClass("AXMath","Math",!1),this.prepareNativeClass("AXDate","Date",!1),this.prepareNativeClass("AXXML","XML",!1),this.prepareNativeClass("AXXMLList","XMLList",!1),this.prepareNativeClass("AXQName","QName",!1),this.prepareNativeClass("AXNamespace","Namespace",!1);var r=this.prepareNativeClass("AXArray","Array",!1);t(r,"axBox",PL),r.tPrototype.$BgtoString=n.axBox((function(){return this.value.toString()})),r.dPrototype.value=[],this.argumentsPrototype=Object.create(this.AXArray.tPrototype),Object.defineProperty(this.argumentsPrototype,"$Bgcallee",{get:yL}),this.prepareNativeClass("AXRegExp","RegExp",!1).dPrototype.value=/(?:)/,t(this.prepareNativeClass("AXPrimitiveBox","PrimitiveBox",!1).dPrototype,"$BgtoString",n.axBox((function(){return this.value.toString()})));this.preparePrimitiveClass("AXBoolean","Boolean",AL,!1,AL,vL,vL),this.preparePrimitiveClass("AXString","String",QT,"",Yv,LT,LT),this.preparePrimitiveClass("AXNumber","Number",ox,0,ox,bL,bL),this.preparePrimitiveClass("AXInt","int",xL,0,xL,wL,CL),this.preparePrimitiveClass("AXUint","uint",IL,0,IL,EL,CL);!function(t,e){for(var i=0;i<qD.length;i++){oL(t,e,qD[i].name,qD[i].alias,qD[i].nsType)}}(this.application,this),function(t){for(var e in yD){var i=e.split("."),n=i.pop();rL(i,t)[n]=t.boxFunction(yD[e])}}(this)},t}();var RL=function(){function t(t,e,i,n){this.abc=t,this.name=e,this.keys=i,this.values=n}return t.prototype.getName=function(){return"number"==typeof this.name&&(this.name=this.abc.getString(this.name)),this.name},t.prototype.getKeyAt=function(t){return this.abc.getString(this.keys[t])},t.prototype.getValueAt=function(t){return this.abc.getString(this.values[t])},t.prototype.getValue=function(t){for(var e=0;e<this.keys.length;e++)if(this.abc.getString(this.keys[e])===t)return this.abc.getString(this.values[e]);return null},t}(),NL=function(){function t(t,e,i,n,r,o,s){this.abc=t,this._index=e,this.name=i,this.returnTypeNameIndex=n,this.parameters=r,this.optionalCount=o,this.flags=s,this.trait=null,this.scriptInfo=null,this.classInfo=null,this.instanceInfo=null,this.isConstructor=!1,this.compiled=null,this.error=null,this.useCount=0,this._body=null,this.minArgs=r.length-o}return Object.defineProperty(t.prototype,"state",{get:function(){return this.error||null==this.getBody()?"failed":this.compiled?"compiled":"pending"},enumerable:!0,configurable:!0}),t.prototype.getNativeMetadata=function(){if(!this.trait)return null;var t=this.trait.getMetadata();if(!t)return null;for(var e=0;e<t.length;e++)if("native"===t[e].getName())return t[e];return null},t.prototype.getBody=function(){return this._body||(this._body=this.abc.getMethodBodyInfo(this._index))},t.prototype.index=function(){return this._index},t.prototype.getTypeName=function(){return void 0!==this._retunTypeName||(0===this.returnTypeNameIndex?this._retunTypeName=null:this._retunTypeName=this.abc.getMultiname(this.returnTypeNameIndex)),this._retunTypeName},t.prototype.getType=function(){if(void 0!==this._returnType)return this._returnType;if(0===this.returnTypeNameIndex)this._returnType=null;else{var t=this.abc.getMultiname(this.returnTypeNameIndex);this._returnType=this.abc.applicationDomain.getClass(t)}return this._returnType},t.prototype.getName=function(){return"number"==typeof this.name?this.abc.getString(this.name)||"anonymous":this.trait?this.trait.getName().name:"anonymous"},t.prototype.toString=function(){var t="anonymous";return this.name&&(t=this.abc.getString(this.name)),t+=" ("+this.parameters.join(", ")+")",this.returnTypeNameIndex&&(t+=": "+this.abc.getMultiname(this.returnTypeNameIndex).name),t},t.prototype.toFlashlogString=function(){var t,e,i=this.trait,n=2===i.kind?"get ":3===i.kind?"set ":"",r=i.toFlashlogString(),o=i.holder;return o&&o instanceof tP&&(n=(t=o.toFlashlogString())+"/"+n),o&&o instanceof eP&&o.trait&&(n=(t=o.trait.toFlashlogString())+"$/"+n),t&&(e=r.indexOf("::"))>0&&0===t.indexOf(r.substring(0,e+2))&&(r=r.substring(e+2)),"MTHD "+n+r+" ()"},t.prototype.isNative=function(){return!!(32&this.flags)},t.prototype.needsRest=function(){return!!(4&this.flags)},t.prototype.needsArguments=function(){return!!(1&this.flags)},t}(),FL=function(t){function e(e,i,n,r,o,s,a){var l=t.call(this)||this;return l.maxStack=e,l.localCount=i,l.initScopeDepth=n,l.maxScopeDepth=r,l.code=o,l.catchBlocks=s,l.traits=a,l.activationPrototype=null,l}return i(e,t),e.prototype.trace=function(t){t.writeLn("Code: "+this.code.length);for(var e=new ZT(this.code);255!==e.currentBytecode();)t.writeLn(e.currentBCI+": "+XT(e.currentBytecode())),e.next()},e}($T),kL=function(t){function e(e,i,n){var r=t.call(this)||this;return r.abc=e,r.initializer=i,r.traits=n,r.global=null,r.state=0,r}return i(e,t),e.prototype.getInitializer=function(){return this.initialiser||(this.initialiser=this.abc.getMethodInfo(this.initializer),this.initialiser.scriptInfo=this),this.initialiser},e.prototype.trace=function(t){t.enter("ScriptInfo"),this.traits.trace(t),t.outdent()},e}($T),VL=function(){function t(t,e,i,n,r){this.abc=t,this.type=e,this.name=i,this.optionalValueKind=n,this.optionalValueIndex=r}return t.prototype.getName=function(){return"number"==typeof this.name&&(this.name=this.abc.getString(this.name)),this.name},t.prototype.getType=function(){return"number"==typeof this.type&&(this.type=this.abc.getMultiname(this.type)),this.type},t.prototype.hasOptionalValue=function(){return this.optionalValueKind>=0},t.prototype.getOptionalValue=function(){return this.abc.getConstant(this.optionalValueKind,this.optionalValueIndex)},t.prototype.toString=function(){var t="";return this.name?t+=this.getName():t+="?",this.type&&(t+=": "+this.getType().name),this.optionalValueKind>=0&&(t+=" = "+this.abc.getConstant(this.optionalValueKind,this.optionalValueIndex)),t},t}(),UL=function(){function t(t,e,i){this.name=t,this.kind=e,this.abc=i,this.configurable=!0,this._type=void 0,this.typeName=null}return t.prototype.getType=function(){if(void 0!==this._type)return this._type;if(null===this.typeName)return this._type=null;var t=this.abc.applicationDomain.getClass(this.typeName);return this._type=t&&t.axCoerce?t:null},t}();function jL(t,e,i){var n=(0|e)===e,r=Xh(e);if(512&i&&(r||n))return null;if(r)return function(t,e){return{__proto__:t.objectPrototype,$Bgname:void 0===e?"void":"null",$BgisDynamic:!1,$BgisFinal:!0,$BgisStatic:!1,$Bgtraits:{__proto__:t.objectPrototype,$Bgvariables:null,$Bgaccessors:null,$Bgmetadata:t.createArray([]),$Bgconstructor:null,$Bginterfaces:t.createArray([]),$Bgmethods:null,$Bgbases:t.createArray([])}}}(t,e);if(e.sec&&(t=e.sec),e=t.box(e),t.AXFunction.axIsType(e))if(t.AXMethodClosure.axIsType(e)){if(512&i)return null}else if("receiver"in e)return null;var o=e.hasOwnProperty("classInfo")?e:e.axClass,s=o===e&&!(512&i),a=o.classInfo,l=t.createObject();return l.$Bgname=n?"int":a.instanceInfo.getName().toFQNString(!0),l.$BgisDynamic=s||!(1&a.instanceInfo.flags),l.$BgisFinal=s||!!(2&a.instanceInfo.flags),l.$BgisStatic=s,256&i&&(l.$Bgtraits=function(t,e,i,n){var r=t.sec,o=2&n,s=32&n&&!i,a=r.createObject(),l=a.$Bgvariables=8&n?r.createArray([]):null,u=a.$Bgaccessors=16&n?r.createArray([]):null,c=null;if(64&n&&!i){var h=e.trait.getMetadata();h&&(c=YL(r,h))}if(a.$Bgmetadata=c||r.createArray([]),a.$Bgconstructor=null,4&n){if(a.$Bginterfaces=r.createArray([]),!i){var p=a.$Bginterfaces.value;t.classInfo.instanceInfo.getInterfaces(t).forEach((function(t){return p.push(t.name.toFQNString(!0))}))}}else a.$Bginterfaces=null;var d=a.$Bgmethods=s?r.createArray([]):null,f=a.$Bgbases=o?r.createArray([]):null,_=Object.create(null),m=Object.create(null),g=Object.create(null),y=!1,A=e.instanceInfo.isInterface();for(;t;){var v=t.classInfo.instanceInfo.getName().toFQNString(!0);if(o&&y&&!i?f.push(v):y=!0,1024&n&&t===r.AXObject)break;x(r,i?t.classInfo.traits.traits:t.classInfo.instanceInfo.traits.traits,A),t=t.superClass}if(i){if(16&n){var b=r.createObject();b.$Bgname="prototype",b.$Bgtype="*",b.$Bgaccess="readonly",b.$Bgmetadata=null,b.$Bguri=null,b.$BgdeclaredBy="Class",u.push(b)}o&&(f.pop(),f.push("Class","Object"),t=r.AXClass)}function x(t,e,r){for(var o=0;o<e.length;o++){var a=e[o],c=a.getName(),h=c.namespace;if(r||!(!h.isPublic()&&!h.uri||1&n&&h.uri)){var p=r?c.name:c.toFQNString(!0);if(m[p]===g[p]){if(!_[p]){var f=t.createObject();_[p]=f;var y=a.getMetadata();switch(a.kind){case 6:case 0:if(!(8&n))continue;f.$Bgname=p,f.$Bguri=h.reflectedURI;var A=a.getTypeName();f.$Bgtype=A?A.toFQNString(!0):"*",f.$Bgaccess="readwrite",f.$Bgmetadata=64&n?YL(t,y):null,l.push(f);break;case 1:if(!s)continue;var b=a.getMethodInfo().getType();f.$BgreturnType=b?b.name.toFQNString(!0):"*",f.$Bgmetadata=64&n?YL(t,y):null,f.$Bgname=p,f.$Bguri=h.reflectedURI;for(var x=f.$Bgparameters=t.createArray([]),C=a.getMethodInfo().parameters,w=0;w<C.length;w++){var I=C[w],E=t.createObject();E.$Bgtype=I.type?I.getType().toFQNString(!0):"*",E.$Bgoptional="value"in I,x.push(E)}f.$BgdeclaredBy=v,d.push(f);break;case 2:case 3:if(!(16&n)||i)continue;if(f.$Bgname=p,2===a.kind){b=a.getMethodInfo().getType();f.$Bgtype=b?b.name.toFQNString(!0):"*",m[p]=f}else{var S=a.getMethodInfo().parameters[0].getType();f.$Bgtype=S?S.toFQNString(!0):"*",g[p]=f}f.$Bgaccess=2===a.kind?"readonly":"writeonly",f.$Bgmetadata=64&n?YL(t,y):null,f.$Bguri=h.reflectedURI,f.$BgdeclaredBy=v,u.push(f)}}}else if((f=_[p]).$Bgaccess="readwrite",2===a.kind){var D=a.getMethodInfo().getType();f.$Bgtype=D?D.name.toFQNString(!0):"*"}}}}d&&0!==d.value.length||(a.$Bgmethods=null);l&&0!==l.value.length||(a.$Bgvariables=null);return a}(o,a,s,i)),l}var GL=new Kv(null,0,7,[Hv.PUBLIC],null,null,!0),QL=new Kv(null,0,13,[Hv.PUBLIC],null,null,!0);function zL(t,e){for(var i=0,n=e.$Bgbases&&e.$Bgbases.value,r=0;n&&r<n.length;r++){var o=n[r],s=t.sec.AXXML.Create('<extendsClass type="'+ZD(o)+'"/>');t.appendChild(s),i++}var a=e.$Bginterfaces&&e.$Bginterfaces.value;for(r=0;a&&r<a.length;r++){var s=t.sec.AXXML.Create('<implementsInterface type="'+ZD(a[r])+'"/>');t.appendChild(s),i++}null!==e.$Bgconstructor&&(XL(s=t.sec.AXXML.Create("<constructor/>"),e.$Bgconstructor),t.appendChild(s),i++);var l=e.$Bgvariables&&e.$Bgvariables.value;for(r=0;l&&r<l.length;r++){var u=l[r],c="readonly"===u.$Bgaccess?"constant":"variable";HL(u,s=t.sec.AXXML.Create("<"+c+' name="'+ZD(u.$Bgname)+'" type="'+u.$Bgtype+'"/>'),t),i++}var h=e.$Bgaccessors&&e.$Bgaccessors.value;for(r=0;h&&r<h.length;r++){var p=h[r];HL(p,s=t.sec.AXXML.Create('<accessor name="'+ZD(p.$Bgname)+'" access="'+p.$Bgaccess+'" type="'+ZD(p.$Bgtype)+'" declaredBy="'+ZD(p.$BgdeclaredBy)+'"/>'),t),i++}var d=e.$Bgmethods&&e.$Bgmethods.value;for(r=0;d&&r<d.length;r++){var f=d[r];XL(s=t.sec.AXXML.Create('<method name="'+ZD(f.$Bgname)+'" declaredBy="'+ZD(f.$BgdeclaredBy)+'" returnType="'+ZD(f.$BgreturnType)+'"/>'),f.$Bgparameters.value),HL(f,s,t),i++}return qL(t,e.$Bgmetadata),i>0}function HL(t,e,i){null!==t.$Bguri&&(QL.name="uri",e.setProperty(QL,t.$Bguri)),null!==t.$Bgmetadata&&qL(e,t.$Bgmetadata),i.appendChild(e)}function XL(t,e){if(e)for(var i=0;i<e.length;i++){var n=e[i],r=t.sec.AXXML.Create('<parameter index="'+(i+1)+'" type="'+ZD(n.$Bgtype)+'" optional="'+n.$Bgoptional+'"/>');t.appendChild(r)}}function qL(t,e){if(e)for(var i=e.value,n=0;n<i.length;n++){for(var r=i[n],o=t.sec.AXXML.Create('<metadata name="'+ZD(r.$Bgname)+'"/>'),s=r.$Bgvalue.value,a=0;a<s.length;a++){var l=s[a],u=t.sec.AXXML.Create('<arg key="'+ZD(l.$Bgkey)+'" value="'+ZD(l.$Bgvalue)+'"/>');o.appendChild(u)}t.appendChild(o)}}function YL(t,e){if(!e)return null;for(var i=t.createArray([]),n=0;n<e.length;n++){var r=e[n];"native"!==r.getName()&&i.push(KL(t,r))}return i}function KL(t,e){var i=t.createObject();i.$Bgname=e.name;var n=[];i.$Bgvalue=t.createArray(n);for(var r=0;r<e.keys.length;r++){var o=t.createObject();o.$Bgvalue=e.getValueAt(r),o.$Bgkey=e.getKeyAt(r),n.push(o)}return i}var WL=function(t,e){switch(typeof e){case"undefined":return"void";case"object":return null===e?"null":e.classInfo.instanceInfo.name.toFQNString(!1);case"number":return(0|e)===e?"int":"Number";case"string":return"String";case"boolean":return"Boolean"}},JL={print:function(t,e,i,n,r,o){var s,a=[];if(2==arguments.length)s=arguments[1]?arguments[1].toString():arguments[1],-1===["string","boolean","number","null","undefined"].indexOf(typeof arguments[1])&&a.push(arguments[1]);else{s="";for(var l=1;l<arguments.length;l++)s+=arguments[l]?arguments[l].toString():arguments[l],-1===["string","boolean","number","null","undefined"].indexOf(typeof arguments[l])&&a.push(arguments[l]),l!=arguments.length-1&&(s+=" ")}console.log("%c Trace from SWF:","color: DodgerBlue",s,0==a.length?"":a)},debugBreak:function(t){},bugzilla:function(t,e){switch(e){case 574600:return!0}return!1},decodeURI:function(t,e){try{return vh.decodeURI(e)}catch(e){t.throwError("URIError",db.InvalidURIError,"decodeURI")}},decodeURIComponent:function(t,e){try{return vh.decodeURIComponent(e)}catch(e){t.throwError("URIError",db.InvalidURIError,"decodeURIComponent")}},encodeURI:function(t,e){try{return vh.encodeURI(e)}catch(e){t.throwError("URIError",db.InvalidURIError,"encodeURI")}},encodeURIComponent:function(t,e){try{return vh.encodeURIComponent(e)}catch(e){t.throwError("URIError",db.InvalidURIError,"encodeURIComponent")}},isNaN:gD(vh.isNaN),isFinite:gD(vh.isFinite),parseInt:gD(vh.parseInt),parseFloat:gD(vh.parseFloat),escape:gD(vh.escape),unescape:gD(vh.unescape),isXMLName:function(){return!1},notImplemented:gD(tp),getQualifiedClassName:function(t,e){return WL(0,e)},getQualifiedSuperclassName:function(t,e){if(mo(e))return"null";var i=(e=t.box(e)).sec.AXClass.axIsType(e)?e.superClass:e.axClass.superClass;return WL(0,i)},getDefinitionByName:function(t,e){e=Yv(e).replace("::",".");var i=Kv.FromFQNString(e,0);return _D().env.app.getClass(i)},describeType:function(t,e,i){return console.log("describeType not implemented"),function(t,e,i){GL.name="XML";var n=t.system.getClass(Kv.FromSimpleName("XML")),r=jL(t,e,i),o=n.Create("<type/>");QL.name="name",o.setProperty(QL,r.$Bgname);var s=r.$Bgtraits.$Bgbases.value;s.length&&(QL.name="base",o.setProperty(QL,s[0])),QL.name="isDynamic",o.setProperty(QL,r.$BgisDynamic.toString()),QL.name="isFinal",o.setProperty(QL,r.$BgisFinal.toString()),QL.name="isStatic",o.setProperty(QL,r.$BgisStatic.toString()),zL(o,r.$Bgtraits);var a=jL(t,e,512|i);if(a){var l=t.AXXML.Create("<factory/>");QL.name="type",l.setProperty(QL,a.$Bgname),zL(l,a.$Bgtraits)&&o.appendChild(l)}return o}(t,e,i)},describeTypeJSON:function(t,e,i){return console.log("describeTypeJSON not implemented"),null},getArgv:function(){return null}};function ZL(t){for(var e=t.split("."),i=JL,n=0,r=e.length;n<r;n++)i=i&&i[e[n]];return i||(i=yD[t]),i}function $L(t,e){void 0===e&&(e=!0);for(var i=function(t,e){var i,n=null;if(t.holder instanceof tP){if(n=t.holder.getClassName(),!(r=HD[n]||XD[n])&&!e)return[];co(r,"Class native is not defined: "+n),i=[r.prototype],r.instanceNatives&&Af(i,r.instanceNatives)}else if(t.holder instanceof eP){var r;if(n=t.holder.instanceInfo.getClassName(),!(r=HD[n]||XD[n])&&!e)return[];co(r,"Class native is not defined: "+n),i=[r],r.classNatives&&Af(i,r.classNatives)}return i}(t,e),n=t.getName().name,r=0;r<i.length;r++){var o=i[r],s=n;if(!hf(o,n)&&hf(o,"native_"+n)&&(s="native_"+n),hf(o,s)){var a;if(t.isAccessor()){var l=Object.getOwnPropertyDescriptor(o,s);a=t.isGetter()?l.get:l.set}else a=o[s];return a}}return t.holder,null}function tR(t,e,i){if(void 0===i&&(i=!1),t.method)return t.method;var n,r,o,s=t.getMethodInfo();if(32&s.flags){var a=s.getNativeMetadata();if(a||t.holder instanceof kL){if(a)n=ZL(a.getValueAt(0));else{var l=t.getName();n=ZL(l.uri+"."+l.name)}r=n,o=e.object.sec,n=function(){switch(arguments.length){case 0:return r(o);case 1:return r(o,arguments[0]);case 2:return r(o,arguments[0],arguments[1]);case 3:return r(o,arguments[0],arguments[1],arguments[2]);default:for(var t=[o],e=0;e<arguments.length;e++)t.push(arguments[e]);return r.apply(this,t)}}}else n=$L(t);0}else i&&(n=$L(t,!1)),n||(n=YO(s,e,null));return co(n,"Not found method:"+t.toString()),t.method=n,n.methodInfo=s,n.methodInfo=s,n}var eR=function(){function t(t){this.traits=t,this._resolved=!1,this.multinames={}}return t.prototype.resolve=function(){if(!this._resolved){for(var t=0;t<this.traits.length;t++)this.traits[t].resolve();this._resolved=!0}},t.prototype.attachHolder=function(t){for(var e=0;e<this.traits.length;e++)this.traits[e].holder=t},t.prototype.trace=function(t){void 0===t&&(t=new Yh),this.resolve(),this.traits.forEach((function(e){return t.writeLn(e.toString())}))},t.prototype.indexOf=function(t){for(var e=t.name,i=t.namespaces,n=this.traits,r=0;r<n.length;r++){var o=n[r].name;if(o.name===e)for(var s=o.namespaces[0],a=0;a<i.length;a++)if(s===i[a])return r}return-1},t.prototype.getTrait=function(t){var e=this.multinames[t.id];if(void 0===e){var i=this.indexOf(t);e=i>=0?this.traits[i]:this,this.multinames[t.id]=e}return e===this?null:e},t.prototype.resolveRuntimeTraits=function(t,e,i,n){void 0===n&&(n=!1),this.resolve();for(var r=Object.create(t?t.protectedNsMappings:null),o=new Zv(t,e,r),s=0;s<this.traits.length;s++){var a=this.traits[s],l=a.name,u=new UL(l,a.kind,a.abc);1===l.namespaces[0].type&&(o.protectedNsMappings[l.name]&&(u.name=o.protectedNsMappings[l.name].name),o.protectedNsMappings[l.name]=u);var c=o.addTrait(u);switch(a.kind){case 1:var h=tR(a,i,n);u.value=h;break;case 2:u.get=tR(a,i,n),c&&c.set&&(u.set=c.set,u.kind=7);break;case 3:u.set=tR(a,i,n),c&&c.get&&(u.get=c.get,u.kind=7);break;case 0:case 6:case 4:u.writable=!0;var p=a;u.slot=p.slot,u.value=p.getDefaultValue(),u.typeName=p.typeName,o.addSlotTrait(u)}}return o},t}(),iR={__proto__:null,$BgNumber:NaN,$Bgint:0,$Bguint:0,$BgBoolean:!1},nR=function(t){function e(e,i,n,r,o,s,a){var l=t.call(this,e,i,n)||this;return l.slot=r,l.typeName=o,l.defaultValueKind=s,l.defaultValueIndex=a,l}return i(e,t),e.prototype.resolve=function(){t.prototype.resolve.call(this),"number"==typeof this.typeName&&(this.typeName=this.abc.getMultiname(this.typeName))},e.prototype.getTypeName=function(){return this.resolve(),this.typeName},e.prototype.getDefaultValue=function(){if(-1===this.defaultValueKind){if(null===this.typeName)return;var t=iR[this.typeName.getMangledName()];return void 0===t?null:t}return this.abc.getConstant(this.defaultValueKind,this.defaultValueIndex)},e}(iP),rR=function(t){function e(e,i,n,r,o){var s=t.call(this,e,i,n,r,0,0,-1)||this;return s.classInfo=o,s}return i(e,t),e}(nR),oR=function(){function t(t,e,i,n,r,o){this.abc=t,this.start=e,this.end=i,this.target=n,this.type=r,this.varName=o,this.catchPrototype=null,this._traits=null}return t.prototype.getType=function(){return"number"==typeof this.type&&(this.type=this.abc.getMultiname(this.type)),this.type},t.prototype.getTraits=function(){if(!this._traits){var t=[];this.varName&&t.push(new nR(this.abc,0,this.varName,1,this.type,0,0)),this._traits=new eR(t),this._traits.resolve()}return this._traits},t}(),sR=null;"undefined"!=typeof TextDecoder&&(sR=new TextDecoder);var aR=function(){function t(t){this._bytes=t,this._view=new DataView(t.buffer,t.byteOffset),this._position=0}return t._getResultBuffer=function(e){return(!t._resultBuffer||t._resultBuffer.length<e)&&(t._resultBuffer=new Uint32Array(2*e)),t._resultBuffer},Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!0,configurable:!0}),t.prototype.remaining=function(){return this._bytes.length-this._position},t.prototype.seek=function(t){this._position=t},t.prototype.advance=function(t){this._position+=t},t.prototype.readU8=function(){return this._bytes[this._position++]},t.prototype.readU8s=function(t){var e=new Uint8Array(t);return e.set(this._bytes.subarray(this._position,this._position+t),0),this._position+=t,e},t.prototype.viewU8s=function(t){var e=this._bytes.subarray(this._position,this._position+t);return this._position+=t,e},t.prototype.readS8=function(){return this._bytes[this._position++]<<24>>24},t.prototype.readU32=function(){return this.readS32()>>>0},t.prototype.readU30=function(){var t=this.readU32();return t},t.prototype.readU30Unsafe=function(){return this.readU32()},t.prototype.readS16=function(){return this.readU30Unsafe()<<16>>16},t.prototype.readS32=function(){var t=this.readU8();return 128&t&&16384&(t=127&t|this.readU8()<<7)&&2097152&(t=16383&t|this.readU8()<<14)&&268435456&(t=2097151&t|this.readU8()<<21)&&(t=268435455&t|this.readU8()<<28,t&=4294967295),t},t.prototype.readWord=function(){var t=this._view.getUint32(this._position,!0);return this._position+=4,t},t.prototype.readS24=function(){return(this.readU8()|this.readU8()<<8|this.readU8()<<16)<<8>>8},t.prototype.readDouble=function(){var t=this._view.getFloat64(this._position,!0);return this._position+=8,t},t.prototype.readUTFString=function(e){if(sR){var i=this._position;return this._position+=e,sR.decode(this._bytes.subarray(i,i+e))}for(var n=this._position,r=n+e,o=this._bytes,s=0,a=t._getResultBuffer(2*e);n<r;){var l=o[n++];if(l<=127)a[s++]=l;else if(l>=192){var u=0;l<224?u=(31&l)<<6|63&o[n++]:l<240?u=(15&l)<<12|(63&o[n++])<<6|63&o[n++]:(u=((7&l)<<18|(63&o[n++])<<12|(63&o[n++])<<6|63&o[n++])-65536,a[s++]=55296+((1047552&u)>>>10),u=56320+(1023&u)),a[s++]=u}}return this._position=n,Mh.fromCharCodeArray(a.subarray(0,s))},t._resultBuffer=new Uint32Array(256),t}(),lR=function(){function t(t,e){this._buffer=e,this.env=t,this._stream=new aR(e),this._checkMagic(),this._parseConstantPool(),this._parseNamespaces(),this._parseNamespaceSets(),this._parseMultinames(),this._parseMethodInfos(),this._parseMetaData(),this._parseInstanceAndClassInfos(),this._parseScriptInfos(),this._parseMethodBodyInfos()}return Object.defineProperty(t.prototype,"applicationDomain",{get:function(){return this.env.app},enumerable:!0,configurable:!0}),t.prototype._parseConstantPool=function(){this._parseNumericConstants(),this._parseStringConstants()},t.prototype._parseNumericConstants=function(){var t=0,e=this._stream;t=e.readU30();var i=new Int32Array(t);i[0]=0;for(var n=1;n<t;n++)i[n]=e.readS32();this.ints=i,t=e.readU30();var r=new Uint32Array(t);r[0]=0;for(n=1;n<t;n++)r[n]=e.readS32();this.uints=r,t=e.readU30();var o=new Float64Array(t);o[0]=NaN;for(n=1;n<t;n++)o[n]=e.readDouble();this.doubles=o},t.prototype._parseStringConstants=function(){var t,e=this._stream;t=e.readU30(),this._strings=new Array(t),this._strings[0]=null;var i=this._stringOffsets=new Uint32Array(t);i[0]=-1;for(var n=1;n<t;n++)i[n]=e.position,e.advance(e.readU30())},t.prototype._parseNamespaces=function(){var t=this._stream,e=t.readU30();this._namespaces=new Array(e);var i=this._namespaceOffsets=new Uint32Array(e);i[0]=-1;for(var n=1;n<e;n++)i[n]=t.position,t.readU8(),t.readU30()},t.prototype._parseNamespaceSets=function(){var t=this._stream,e=t.readU30();this._namespaceSets=new Array(e);var i=this._namespaceSetOffsets=new Uint32Array(e);i[0]=-1;for(var n=1;n<e;n++){i[n]=t.position;for(var r=t.readU30(),o=0;o<r;o++)t.readU30()}},t.prototype._consumeMultiname=function(){var t=this._stream,e=t.readU8();switch(e){case 7:case 13:t.readU30(),t.readU30();break;case 15:case 16:t.readU30();break;case 17:case 18:break;case 9:case 14:t.readU30(),t.readU30();break;case 27:case 28:t.readU30();break;case 29:t.readU32();t.readU32();t.readU32();break;default:hp(e)}},t.prototype._parseMultinames=function(){var t=this._stream,e=t.readU30();this._multinames=new Array(e);var i=this._multinameOffsets=new Uint32Array(e);i[0]=-1;for(var n=1;n<e;n++)i[n]=t.position,this._consumeMultiname()},t.prototype._parseMultiname=function(t){var e,i=this._stream,n=!1,r=!0,o=0,s=i.readU8();switch(s){case 7:case 13:e=i.readU30(),r=!1,o=i.readU30();break;case 15:case 16:n=!0,o=i.readU30();break;case 17:case 18:n=!0;break;case 9:case 14:o=i.readU30(),e=i.readU30();break;case 27:case 28:e=i.readU30();break;case 29:var a=i.readU32(),l=(i.readU32(),this.getMultiname(i.readU32())),u=this.getMultiname(a);return new Kv(this,t,s,u.namespaces,u.name,l);default:hp()}var c,h=0===o?null:this.getString(o);return c=n?null:r?this.getNamespaceSet(e):[this.getNamespace(e)],new Kv(this,t,s,c,h)},t.prototype._checkMagic=function(){var t=this._stream.readWord();t<3014671&&this.env.app.sec.throwError("VerifierError",db.InvalidMagicError,t>>16,65535&t)},t.prototype._checkForDuplicateStrings=function(){for(var t=[],e=0;e<this._strings.length;e++)t.push(this.getString(e));t.sort();for(e=0;e<t.length-1;e++)if(t[e]===t[e+1])return!0;return!1},t.prototype.getString=function(t){var e=this._strings[t];if(void 0===e){var i=this._stream;i.seek(this._stringOffsets[t]);var n=i.readU30();e=this._strings[t]=i.readUTFString(n)}return e},t.prototype.getMultiname=function(t){if((t<0||t>=this._multinameOffsets.length)&&this.applicationDomain.sec.throwError("VerifierError",db.CpoolIndexRangeError,t,this._multinameOffsets.length),0===t)return null;var e=this._multinames[t];void 0===e&&(this._stream.seek(this._multinameOffsets[t]),e=this._multinames[t]=this._parseMultiname(t));return e},t.prototype.getNamespace=function(t){if((t<0||t>=this._namespaceOffsets.length)&&this.applicationDomain.sec.throwError("VerifierError",db.CpoolIndexRangeError,t,this._namespaceOffsets.length),0===t)return Hv.PUBLIC;var e=this._namespaces[t];if(void 0!==e)return e;var i=this._stream;i.seek(this._namespaceOffsets[t]);var n,r=i.readU8(),o=i.readU30(),s=o?this.getString(o):void 0;switch(r){case 8:case 22:n=0;break;case 23:n=2;break;case 24:n=1;break;case 25:n=4;break;case 26:n=5;break;case 5:n=3;break;default:this.applicationDomain.sec.throwError("VerifierError",db.CpoolEntryWrongTypeError,t)}return s&&3!==n||void 0===s&&(s=""),e=this._namespaces[t]=Xv(n,s)},t.prototype.getNamespaceSet=function(t){if((t<0||t>=this._namespaceSets.length)&&this.applicationDomain.sec.throwError("VerifierError",db.CpoolIndexRangeError,t,this._namespaceSets.length),0===t)return null;var e=this._namespaceSets[t];if(void 0===e){var i=this._stream,n=this._namespaceSetOffsets[t];i.seek(n);var r=i.readU30();e=this._namespaceSets[t]=new Array(r),n=i.position;for(var o=0;o<r;o++){i.seek(n);var s=i.readU30();n=i.position,e[o]=this.getNamespace(s)}}return e},t.prototype._parseMethodInfos=function(){var t=this._stream,e=t.readU30();this._methods=new Array(e),this._methodInfoOffsets=new Uint32Array(e);for(var i=0;i<e;++i)this._methodInfoOffsets[i]=t.position,this._consumeMethodInfo()},t.prototype._consumeMethodInfo=function(){var t=this._stream,e=t.readU30();t.readU30();t.position;for(var i=0;i<e;i++)t.readU30();t.readU30();var n=t.readU8();if(8&n)for(i=e-t.readU30();i<e;i++)t.readU30(),t.readU8();if(128&n)for(i=0;i<e;i++)t.readU30()},t.prototype._parseMethodInfo=function(t){for(var e=this._stream,i=e.readU30(),n=e.readU30(),r=(e.position,new Array(i)),o=0;o<i;o++)r[o]=new VL(this,e.readU30(),0,-1,-1);var s=e.readU30(),a=e.readU8(),l=0;if(8&a)for(o=i-(l=e.readU30());o<i;o++)r[o].optionalValueIndex=e.readU30(),r[o].optionalValueKind=e.readU8();if(128&a)for(o=0;o<i;o++)r[o].name=e.readU30();return new NL(this,t,s,n,r,l,a)},t.prototype.getMethodInfo=function(t){var e=this._methods[t];void 0===e&&(this._stream.seek(this._methodInfoOffsets[t]),e=this._methods[t]=this._parseMethodInfo(t));return e},t.prototype.getMethodBodyInfo=function(t){return this._methodBodies[t]},t.prototype._parseMetaData=function(){var t=this._stream,e=t.readU30();this._metadata=new Array(e);for(var i=this._metadataInfoOffsets=new Uint32Array(e),n=0;n<e;n++){i[n]=t.position,t.readU30();for(var r=t.readU30(),o=0;o<r;o++)t.readU30(),t.readU30()}},t.prototype.getMetadataInfo=function(t){var e=this._metadata[t];if(void 0===e){var i=this._stream;i.seek(this._metadataInfoOffsets[t]);for(var n=i.readU30(),r=i.readU30(),o=new Uint32Array(r),s=0;s<r;s++)o[s]=i.readU30();var a=new Uint32Array(r);for(s=0;s<r;s++)a[s]=i.readU30();e=this._metadata[t]=new RL(this,n,o,a)}return e},t.prototype._parseInstanceAndClassInfos=function(){for(var t=this._stream,e=t.readU30(),i=this.instances=new Array(e),n=0;n<e;n++)i[n]=this._parseInstanceInfo();this._parseClassInfos(e);var r=t.position;for(n=0;n<e;n++)i[n].classInfo=this.classes[n];t.seek(r)},t.prototype._parseInstanceInfo=function(){var t=this._stream,e=t.readU30(),i=t.readU30(),n=t.readU8(),r=0;8&n&&(r=t.readU30());for(var o=t.readU30(),s=[],a=0;a<o;a++)s[a]=t.readU30();var l=t.readU30(),u=this._parseTraits(),c=new tP(this,e,i,n,r,s,l,u);return u.attachHolder(c),c},t.prototype._parseTraits=function(){for(var t=this._stream.readU30(),e=[],i=0;i<t;i++)e.push(this._parseTrait());return new eR(e)},t.prototype._parseTrait=function(){var t,e=this._stream,i=e.readU30(),n=e.readU8(),r=15&n,o=n>>4&15;switch(r){case 0:case 6:var s=e.readU30(),a=e.readU30(),l=e.readU30(),u=-1;0!==l&&(u=e.readU8()),t=new nR(this,r,i,s,a,u,l);break;case 1:case 2:case 3:e.readU30();var c=e.readU30(),h=e.position,p=this.getMethodInfo(c);t=p.trait=new nP(this,r,i,p),e.seek(h);break;case 4:s=e.readU30();var d=this.classes[e.readU30()];t=d.trait=new rR(this,r,i,s,d);break;default:this.applicationDomain.sec.throwError("VerifierError",db.UnsupportedTraitsKindError,r)}if(4&o){for(var f=e.readU30(),_=new Uint32Array(f),m=0;m<f;m++)_[m]=e.readU30();t.metadata=_}return t},t.prototype._parseClassInfos=function(t){this._stream;for(var e=this.classes=new Array(t),i=0;i<t;i++)e[i]=this._parseClassInfo(i)},t.prototype._parseClassInfo=function(t){var e=this._stream.readU30(),i=this._parseTraits(),n=new eP(this,this.instances[t],e,i);return i.attachHolder(n),n},t.prototype._parseScriptInfos=function(){for(var t=this._stream.readU30(),e=this.scripts=new Array(t),i=0;i<t;i++)e[i]=this._parseScriptInfo()},t.prototype._parseScriptInfo=function(){var t=this._stream.readU30(),e=this._parseTraits(),i=new kL(this,t,e);return e.attachHolder(i),i},t.prototype._parseMethodBodyInfos=function(){for(var t=this._stream,e=this._methodBodies=new Array(this._methods.length),i=t.readU30(),n=(t.position,0);n<i;n++){for(var r=t.readU30(),o=t.readU30(),s=t.readU30(),a=t.readU30(),l=t.readU30(),u=t.viewU8s(t.readU30()),c=t.readU30(),h=new Array(c),p=0;p<c;++p)h[p]=this._parseException();var d=this._parseTraits();e[r]=new FL(o,s,a,l,u,h,d),d.attachHolder(e[r])}},t.prototype._parseException=function(){var t=this._stream,e=t.readU30(),i=t.readU30(),n=t.readU30(),r=t.readU30(),o=t.readU30();return new oR(this,e,i,n,r,o)},t.prototype.getConstant=function(t,e){switch(t){case 3:return this.ints[e];case 4:return this.uints[e];case 6:return this.doubles[e];case 1:return this.getString(e);case 11:return!0;case 10:return!1;case 12:return null;case 0:return;case 8:case 23:return this.getNamespace(e);case 7:case 14:case 15:case 16:case 17:case 18:case 19:case 20:return this.getMultiname(e)}},t.prototype.stress=function(){for(var t=0;t<this._multinames.length;t++)this.getMultiname(t);for(t=0;t<this._namespaceSets.length;t++)this.getNamespaceSet(t);for(t=0;t<this._namespaces.length;t++)this.getNamespace(t);for(t=0;t<this._strings.length;t++)this.getString(t)},t.prototype.trace=function(t){t.writeLn("Multinames: "+this._multinames.length),t.indent();for(var e=0;e<this._multinames.length;e++)t.writeLn(e+" "+this.getMultiname(e));t.outdent(),t.writeLn("Namespace Sets: "+this._namespaceSets.length),t.indent();for(e=0;e<this._namespaceSets.length;e++)t.writeLn(e+" "+this.getNamespaceSet(e));t.outdent(),t.writeLn("Namespaces: "+this._namespaces.length),t.indent();for(e=0;e<this._namespaces.length;e++)t.writeLn(e+" "+this.getNamespace(e));t.outdent(),t.writeLn("Strings: "+this._strings.length),t.indent();for(e=0;e<this._strings.length;e++)t.writeLn(e+" "+this.getString(e));t.outdent(),t.writeLn("MethodInfos: "+this._methods.length),t.indent();for(e=0;e<this._methods.length;e++)t.writeLn(e+" "+this.getMethodInfo(e)),this._methodBodies[e]&&this._methodBodies[e].trace(t);t.outdent(),t.writeLn("InstanceInfos: "+this.instances.length),t.indent();for(e=0;e<this.instances.length;e++)t.writeLn(e+" "+this.instances[e]),this.instances[e].trace(t);t.outdent(),t.writeLn("ClassInfos: "+this.classes.length),t.indent();for(e=0;e<this.classes.length;e++)this.classes[e].trace(t);t.outdent(),t.writeLn("ScriptInfos: "+this.scripts.length),t.indent();for(e=0;e<this.scripts.length;e++)this.scripts[e].trace(t);t.outdent()},t}();var uR,cR=function(){function t(t,e,i){this.app=t,this.map=gf.createMap(),this.abcs=e,this.scripts=gf.createMap();for(var n=0;n<i.length;n++){var r=i[n];this.scripts[r.name]=r;for(var o=0;o<r.defs.length;o++){var s=r.defs[o].split(":"),a=this.map[s[1]];a||(a=this.map[s[1]]=Object.create(null)),a[s[0]]=r.name}}}return t.prototype.getABCByScriptName=function(t){var e=this.scripts[t];if(!e)return null;var i={url:t,app:this.app};return new lR(i,this.abcs.subarray(e.offset,e.offset+e.length))},t.prototype.getABCByMultiname=function(t){var e=this.map[t.name];if(!e)return null;for(var i=t.namespaces,n=0;n<i.length;n++){var r=e[i[n].uri];if(r)return this.getABCByScriptName(r)}return null},t}();!function(t){t[t.Builtin=1]="Builtin",t[t.Playerglobal=2]="Playerglobal",t[t.Shell=4]="Shell"}(uR||(uR={}));var hR=function(){function t(t){if(this.avmVersion="AVM2",!t)throw"AVM2Handler must be init with a valid PlayerGlobal-class";this._playerglobal=t}return t.prototype.init=function(t,e,i){var n=this;this._avmStage&&i(!1),this._avmStage=t,zD(),lb(),Hv.PUBLIC=Xv(0,""),Function.prototype.axApply=Function.prototype.apply,Function.prototype.axCall=Function.prototype.call,this._playerglobal.createSecurityDomain(t,e,uR.Builtin|uR.Playerglobal).then((function(t){n._factory=t,n._avmStage.config.externalInterfaceID&&(If.interfaceID=n._avmStage.config.externalInterfaceID),i(!0)}))},t.prototype.enterFrame=function(t){this._playerglobal.enterFrame()},t.prototype.resizeStage=function(){this._playerglobal.resizeStage()},Object.defineProperty(t.prototype,"factory",{get:function(){if(!this._factory)throw"AVM2Handler - no Factory get factory";return this._factory},enumerable:!0,configurable:!0}),t.prototype.addAsset=function(t,e){this._playerglobal.addAsset(t,e)},t}();console.debug("AwayFL - 0.2.146");var pR=function(t){function e(e,i,n){void 0===i&&(i=!0),void 0===n&&(n=!0);var r=t.call(this)||this;return r._iAllowedToPropagate=!0,r._iAllowedToImmediatlyPropagate=!0,r._type=So(e),r._bubbles=!!i,r._cancelable=!!n,r._target=null,r._currentTarget=null,r._eventPhase=null,r._stopPropagation=!1,r._stopImmediatePropagation=!1,r._isDefaultPrevented=!1,r}return i(e,t),e.getInstance=function(t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var r=this._instances[t];return r||(r=new e(t,i,n),this._instances[t]=r),r._bubbles=i,r._cancelable=n,r},e.getBroadcastInstance=function(t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var r=this._instances[t];return r||(r=new e(t,i,n),this._instances[t]=r),r._isBroadcastEvent=!0,r._bubbles=i,r._cancelable=n,r},e.isBroadcastEventType=function(t){switch(t){case e.ENTER_FRAME:case e.EXIT_FRAME:case e.FRAME_CONSTRUCTED:case e.RENDER:case e.ACTIVATE:case e.DEACTIVATE:return!0}return!1},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbles",{get:function(){return this._bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this._cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this._currentTarget},set:function(t){this._currentTarget=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this._eventPhase},enumerable:!0,configurable:!0}),e.prototype.stopPropagation=function(){this._stopPropagation=!0,this.adaptee&&this.adaptee.stopPropagation()},e.prototype.stopImmediatePropagation=function(){this._stopImmediatePropagation=this._stopPropagation=!0,this.adaptee&&this.adaptee.stopImmediatePropagation()},e.prototype.preventDefault=function(){this._cancelable&&(this._isDefaultPrevented=!0)},e.prototype.isDefaultPrevented=function(){return this._isDefaultPrevented},e.prototype.isBroadcastEvent=function(){return!!this._isBroadcastEvent},e.prototype.clone=function(){return new e(this._type,this._bubbles,this._cancelable)},e.prototype.toString=function(){return this.formatToString("Event","type","bubbles","cancelable","eventPhase")},e.prototype.formatToString=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n="["+t,r=0;r<e.length;r++){var o=e[r],s=this.axGetPublicProperty(o);"string"==typeof s&&(s='"'+s+'"'),n+=" "+o+"="+s}return n+"]"},e.classInitializer=function(){this._instances=gf.createMap()},e.ACTIVATE="activate",e.ADDED="added",e.ADDED_TO_STAGE="addedToStage",e.CANCEL="cancel",e.CHANGE="change",e.CLEAR="clear",e.CLOSE="close",e.COMPLETE="complete",e.CONNECT="connect",e.COPY="copy",e.CUT="cut",e.DEACTIVATE="deactivate",e.ENTER_FRAME="enterFrame",e.FRAME_CONSTRUCTED="frameConstructed",e.EXIT_FRAME="exitFrame",e.FRAME_LABEL="frameLabel",e.ID3="id3",e.INIT="init",e.MOUSE_LEAVE="mouseLeave",e.OPEN="open",e.PASTE="paste",e.REMOVED="removed",e.REMOVED_FROM_STAGE="removedFromStage",e.RENDER="render",e.RESIZE="resize",e.SCROLL="scroll",e.TEXT_INTERACTION_MODE_CHANGE="textInteractionModeChange",e.SELECT="select",e.SELECT_ALL="selectAll",e.SOUND_COMPLETE="soundComplete",e.TAB_CHILDREN_CHANGE="tabChildrenChange",e.TAB_ENABLED_CHANGE="tabEnabledChange",e.TAB_INDEX_CHANGE="tabIndexChange",e.UNLOAD="unload",e.FULLSCREEN="fullScreen",e.CONTEXT3D_CREATE="context3DCreate",e.TEXTURE_READY="textureReady",e.VIDEO_FRAME="videoFrame",e.SUSPEND="suspend",e.AVM1_INIT="initialize",e.AVM1_CONSTRUCT="construct",e.AVM1_LOAD="load",e}(bb),dR=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._listenerObjects=new Array,i._t=e||i,i}return i(e,t),e.prototype.toString=function(){return""},e.prototype.addEventListener=function(t,e,i,n,r){if(void 0===n&&(n=0),this._listenerObjects){var o=this._listenerObjects[t];void 0===o&&(o=this._listenerObjects[t]=new _R),o.addEventListener(e,n)}},e.prototype.removeEventListener=function(t,e){if(this._listenerObjects){var i=this._listenerObjects[t];i&&(i.removeEventListener(e),0==i.numListeners&&delete this._listenerObjects[t])}},e.prototype.dispatchEvent=function(t){if(this._listenerObjects){var e=this._listenerObjects[t.type];return e&&(t.target||(t.target=this._t),e.dispatchEvent(t)),!0}},e.prototype.hasEventListener=function(t,e){return void 0!==this._listenerObjects[t]&&(null!=e?-1!==this._listenerObjects[t].getEventListenerIndex(e):this._listenerObjects[t].numListeners>0)},e}(bb);function fR(t,e){return t.priority<e.priority?-1:1}var _R=function(){function t(){this._index=0,this._singlePriority=0,this._listeners=new Array,this.numListeners=0}return t.prototype.addEventListener=function(t,e){if(void 0===e&&(e=0),!this._listenersByPriority)return-1!==this._listeners.indexOf(t)?void 0:0==this._listeners.length||e==this._singlePriority?(this._listeners.push(t),void this.numListeners++):(this._singlePriority<e?this._listenersByPriority=[{priority:this._singlePriority,listeners:this._listeners.concat()},{priority:e,listeners:[t]}]:this._listenersByPriority=[{priority:e,listeners:[t]},{priority:this._singlePriority,listeners:this._listeners.concat()}],void this.numListeners++);for(var i=0;i<this._listenersByPriority.length;i++)if(-1!==this._listenersByPriority[i].listeners.indexOf(t))return;var n=null;for(i=0;i<this._listenersByPriority.length;i++)if(this._listenersByPriority[i].priority==e){n=this._listenersByPriority[i];break}n||(n={priority:e,listeners:[]},this._listenersByPriority.push(n),this._listenersByPriority.length>1&&this._listenersByPriority.sort(fR)),n.listeners.push(t),this.numListeners++},t.prototype.removeEventListener=function(t){var e=-1;if(!this._listenersByPriority){if(-1===(e=this._listeners.indexOf(t)))return;return this._listeners.splice(e,1),void this.numListeners--}for(var i=0;i<this._listenersByPriority.length;i++)if(-1!==(e=this._listenersByPriority[i].listeners.indexOf(t)))return this.numListeners--,void this._listenersByPriority[i].listeners.splice(e,1)},t.prototype.dispatchEvent=function(t){if(this._listenersByPriority){for(var e=this._listenersByPriority.length;e>0;){e--;n=(i=this._listenersByPriority[e].listeners.length>1?this._listenersByPriority[e].listeners.concat():this._listenersByPriority[e].listeners).length,r=0;for(r=0;r<n;r++)i[r]&&i[r].call(i[r],t)}1==this._listenersByPriority.length&&(this._listeners=this._listenersByPriority[0].listeners.concat(),this._singlePriority=this._listenersByPriority[0].priority,this._listenersByPriority=null)}else{var i,n=(i=this._listeners.length>1?this._listeners.concat():this._listeners).length,r=0;for(r=0;r<n;r++)i[r]&&i[r].call(i[r],t)}},t.prototype.getEventListenerIndex=function(t){if(!this._listenersByPriority)return this._listeners.indexOf(t);for(var e=0;e<this._listenersByPriority.length;e++)for(var i=0;i<this._listenersByPriority[e].listeners.length;i++)if(this._listenersByPriority[e].listeners[i]==t)return e;return-1},t}(),mR=function(t){function e(e,i,n,r,o,s,a,l,u,c,h){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===r&&(r=void 0),void 0===o&&(o=void 0),void 0===s&&(s=null),void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===u&&(u=!1),void 0===c&&(c=!1),void 0===h&&(h=0);var p=t.call(this,e,i,n)||this;return p._localX=r,p._localY=o,p._relatedObject=s,p._ctrlKey=a,p._altKey=l,p._shiftKey=u,p._buttonDown=c,p._delta=h,p}return i(e,t),e.typeFromDOMType=function(t){switch(t){case"click":return e.CLICK;case"dblclick":return e.DOUBLE_CLICK;case"mousedown":return e.MOUSE_DOWN;case"mouseout":case"mouseover":case"mousemove":return e.MOUSE_MOVE;case"mouseup":return e.MOUSE_UP}},e.prototype.fillFromAway=function(t){this.adaptee=t,this.target=t.target,this.delta=t.delta,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey},Object.defineProperty(e.prototype,"localX",{get:function(){return this._localX/20|0},set:function(t){this._localX=20*t|0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localY",{get:function(){return this._localY/20|0},set:function(t){this._localY=20*t|0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageX",{get:function(){return isNaN(this.localX+this.localY)?Number.NaN:this.target.stage.mouseX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageY",{get:function(){return isNaN(this.localX+this.localY)?Number.NaN:this.target.stage.mouseY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this._movementX||0},set:function(t){this._movementX=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this._movementY||0},set:function(t){this._movementY=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return this._delta},set:function(t){this._delta=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ctrlKey",{get:function(){return this._ctrlKey},set:function(t){this._ctrlKey=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"altKey",{get:function(){return this._altKey},set:function(t){this._altKey=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shiftKey",{get:function(){return this._shiftKey},set:function(t){this._shiftKey=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonDown",{get:function(){return this._buttonDown},set:function(t){this._buttonDown=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relatedObject",{get:function(){return this._relatedObject},set:function(t){this._relatedObject=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRelatedObjectInaccessible",{get:function(){return this._isRelatedObjectInaccessible},set:function(t){this._isRelatedObjectInaccessible=t},enumerable:!0,configurable:!0}),e.prototype.updateAfterEvent=function(){this.sec.player.requestRender()},e.prototype.clone=function(){return new e(this.type,this.bubbles,this.cancelable,this.localX,this.localY,this.relatedObject,this.ctrlKey,this.altKey,this.shiftKey,this.buttonDown,this.delta)},e.prototype.toString=function(){return this.formatToString("MouseEvent","type","bubbles","cancelable","eventPhase","localX","localY","relatedObject","ctrlKey","altKey","shiftKey","buttonDown","delta")},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.CLICK="click",e.DOUBLE_CLICK="doubleClick",e.MOUSE_DOWN="mouseDown",e.MOUSE_MOVE="mouseMove",e.MOUSE_OUT="mouseOut",e.MOUSE_OVER="mouseOver",e.MOUSE_UP="mouseUp",e.RELEASE_OUTSIDE="releaseOutside",e.MOUSE_WHEEL="mouseWheel",e.ROLL_OUT="rollOut",e.ROLL_OVER="rollOver",e.MIDDLE_CLICK="middleClick",e.MIDDLE_MOUSE_DOWN="middleMouseDown",e.MIDDLE_MOUSE_UP="middleMouseUp",e.RIGHT_CLICK="rightClick",e.RIGHT_MOUSE_DOWN="rightMouseDown",e.RIGHT_MOUSE_UP="rightMouseUp",e.CONTEXT_MENU="contextMenu",e}(pR),gR=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.eventMapping={},i.eventMappingDummys={},i.eventMappingExtern={},i.eventMappingInvert={},i._activateCallbackDelegate=function(t){return i.activateCallback(t)},i.eventMapping[pR.ACTIVATE]={adaptedType:"",addListener:i.initActivateListener,removeListener:i.removeActivateListener,callback:i._activateCallbackDelegate},i._deactivateCallbackDelegate=function(t){return i.deactivateCallback(t)},i.eventMapping[pR.DEACTIVATE]={adaptedType:"",addListener:i.initDeactivateListener,removeListener:i.removeDeactivateListener,callback:i._deactivateCallbackDelegate},i}return i(e,t),e.prototype.toString=function(){return""},e.prototype.hasEventListener=function(e,i){return t.prototype.hasEventListener.call(this,e,i)},e.prototype.willTrigger=function(){},e.prototype.dispatchEvent=function(i,n){void 0===n&&(n=!1),i.currentTarget=this,"enterFrame"==i.type&&(i.target=this);var r=t.prototype.dispatchEvent.call(this,i);return n||-1!=e.eventsThatBubbleInAwayJS.indexOf(i.type)||this.adaptee&&this.adaptee.parent&&this.adaptee.parent.adapter.dispatchEvent(i),r},e.prototype.initActivateListener=function(t,e){window.onfocus=e},e.prototype.removeActivateListener=function(t,e){window.onfocus=null},e.prototype.activateCallback=function(t){this.dispatchEvent(new this.sec.flash.events.Event(pR.ACTIVATE))},e.prototype.initDeactivateListener=function(t,e){window.onblur=e},e.prototype.removeDeactivateListener=function(t,e){window.onblur=null},e.prototype.deactivateCallback=function(t){this.dispatchEvent(new this.sec.flash.events.Event(pR.DEACTIVATE))},e.prototype.addEventListener=function(e,i,n,r,o){if(void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=!1),!n&&pR.isBroadcastEventType(e)&&yR.getInstance().add(e,this),this.eventMappingDummys)return this.eventMappingDummys.hasOwnProperty(e)?void 0:this.eventMapping.hasOwnProperty(e)?(t.prototype.addEventListener.call(this,e,i,n,r,o),void this.eventMapping[e].addListener.call(this,this.eventMapping[e].adaptedType,this.eventMapping[e].callback,i)):void t.prototype.addEventListener.call(this,e,i,n,r,o)},e.prototype.removeEventListener=function(e,i){this.eventMappingDummys?(t.prototype.removeEventListener.call(this,e,i),this.eventMapping.hasOwnProperty(e)&&(this.eventMapping[e].removeListener.call(this,this.eventMapping[e].adaptedType,this.eventMapping[e].callback,i),this.hasEventListener(e)||pR.isBroadcastEventType(e)&&yR.getInstance().remove(e,this))):console.log("todo: remove queued addEventListener")},e.eventsThatBubbleInAwayJS=[mR.MOUSE_WHEEL,mR.MOUSE_UP,mR.MOUSE_OVER,mR.MOUSE_OUT,mR.ROLL_OVER,mR.ROLL_OUT,mR.MOUSE_MOVE,mR.MOUSE_DOWN,mR.DOUBLE_CLICK,mR.CLICK,pR.ENTER_FRAME,pR.EXIT_FRAME,pR.FRAME_CONSTRUCTED,pR.ADDED_TO_STAGE,pR.RESIZE,pR.REMOVED_FROM_STAGE],e}(dR),yR=function(){function t(){this.reset()}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.reset=function(){this._queues={}},t.prototype.add=function(t,e){var i=this._queues[t]||(this._queues[t]=[]);i.indexOf(e)>=0||i.push(e)},t.prototype.remove=function(t,e){var i=this._queues[t],n=i.indexOf(e);i[n]=null},t.prototype.dispatchEvent=function(t){var e=this._queues[t._type];if(e){for(var i=0,n=0;n<e.length;n++){var r=e[n];null===r?i++:r.dispatchEvent(t)}if(i>16&&i>e.length>>1){var o=[];for(n=0;n<e.length;n++)e[n]&&o.push(e[n]);this._queues[t.type]=o}}},t.prototype.getQueueLength=function(t){return this._queues[t]?this._queues[t].length:0},t}(),AR=function(){function t(){}return t.events={},t}(),vR=function(t){function e(){var e=t.call(this)||this;return e._filters=e._filters||[],e._blockedByScript=!1,e._ctBlockedByScript=!1,e._visibilityByScript=!1,e.adaptee=e.adaptee||e.createAdaptee(),e.adaptee.mouseEnabled=!0,e._stage=e.activeStage,e.eventMappingExtern[pR.ENTER_FRAME]="",e.eventMappingExtern[pR.FRAME_CONSTRUCTED]="",e.eventMappingExtern[pR.EXIT_FRAME]="",e.eventMappingExtern[pR.RENDER]="",e.eventMappingExtern[pR.REMOVED_FROM_STAGE]="",e.eventMappingExtern[pR.REMOVED]="",e.eventMappingExtern[pR.ADDED_TO_STAGE]="",e.eventMappingExtern[pR.ADDED]="",e._transform=new e.sec.flash.geom.Transform(e.adaptee.transform),e}return i(e,t),e.prototype.toString=function(){return"[object "+this.classInfo.instanceInfo.name.name+"]"},e.prototype.applySymbol=function(){},e.prototype.dispatchStaticEvent=function(t,e){void 0===e&&(e=null),AR.events[t]||(AR.events[t]=new this.sec.flash.events.Event(t)),AR.events[t].target=e,this.dispatchEvent(AR.events[t])},e.prototype.dispatch_ADDED_TO_STAGE=function(t){void 0===t&&(t=!1),t&&(AR.events[pR.ADDED_TO_STAGE]||(AR.events[pR.ADDED_TO_STAGE]=new this.sec.flash.events.Event(pR.ADDED_TO_STAGE)),AR.events[pR.ADDED_TO_STAGE].target=this,this.dispatchEvent(AR.events[pR.ADDED_TO_STAGE]))},e.prototype.dispatch_REMOVED_FROM_STAGE=function(t){void 0===t&&(t=!1),t&&(AR.events[pR.REMOVED_FROM_STAGE]||(AR.events[pR.REMOVED_FROM_STAGE]=new this.sec.flash.events.Event(pR.REMOVED_FROM_STAGE)),AR.events[pR.REMOVED_FROM_STAGE].target=this,this.dispatchEvent(AR.events[pR.REMOVED_FROM_STAGE]))},e.prototype.dispatchStaticBroadCastEvent=function(t){AR.events[t]||(AR.events[t]=new this.sec.flash.events.Event(t)),yR.getInstance().dispatchEvent(AR.events[t])},e.prototype.updateFilters=function(t){if(t&&0!=t.length){var e,i=[];i.length=t.length;for(var n=function(n){switch((e=t[n]).type){case Up.DROPSHADOW:i[n]=new r.sec.flash.filters.DropShadowFilter(e.distance,e.angle,e.color,1,e.blurX,e.blurY,e.strength,e.quality,e.inner,e.knockout,e.compositeSource);break;case Up.GLOW:i[n]=new r.sec.flash.filters.GlowFilter(e.color,1,e.blurX,e.blurY,e.strength,e.quality,e.inner,e.knockout);break;case Up.BEVEL:i[n]=new r.sec.flash.filters.BevelFiler(e.distance,e.angle,e.colors[0],1,e.colors[1],1,e.blurX,e.blurY,e.strength,e.quality,"",e.knockout);break;case Up.GRADIENTGLOW:var o=[];e.colors.forEach((function(t){return o.push(1)})),i[n]=new r.sec.flash.filters.GradientGlowFilter(e.distance,e.angle,r.sec.createArrayUnsafe(e.colors),r.sec.createArrayUnsafe(o),r.sec.createArrayUnsafe(e.ratios),e.blurX,e.blurY,e.strength,e.quality,"",e.knockout);break;case Up.GRADIENTBEVEL:i[n]=new r.sec.flash.filters.GradientBevelFilter(e.distance,e.angle,r.sec.createArrayUnsafe(e.colors),r.sec.createArrayUnsafe([]),r.sec.createArrayUnsafe(e.ratios),e.blurX,e.blurY,e.strength,e.quality,"",e.knockout);break;case Up.BLUR:i[n]=new r.sec.flash.filters.BlurFilter(e.blurX,e.blurY,e.quality);break;case Up.CONVOLUTION:i[n]=new r.sec.flash.filters.ConvolutionFilter(e.matrixX,e.matrixY,r.sec.createArrayUnsafe(e.matrix),e.divisor,e.bias,e.preserveAlpha,e.clamp,e.color,1);break;case Up.COLORMATRIX:i[n]=new r.sec.flash.filters.ColorMatrixFilter(r.sec.createArrayUnsafe(e.matrix))}},r=this,o=0;o<t.length;o++)n(o);this.filters=i}else this.filters=this.sec.createArrayUnsafe([])},e.prototype.createAdaptee=function(){return new Na},e.prototype.mapAdaptee=function(t){return t&&(t.partition||(t.partition=new uh(t)),t.adapter=this),t},Object.defineProperty(e.prototype,"activeStage",{get:function(){return this.sec.flash.display.DisplayObject.axClass._activeStage},enumerable:!0,configurable:!0}),e.prototype.dispatchEventRecursive=function(t){this.dispatchEvent(t)},Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},set:function(t){this._adaptee!=t&&(this._adaptee&&(this._adaptee.adapter=null),this._adaptee=this.mapAdaptee(t))},enumerable:!0,configurable:!0}),e.prototype.initAdapter=function(){},e.prototype.isBlockedByScript=function(){return this._blockedByScript},e.prototype.isVisibilityByScript=function(){return this._visibilityByScript},e.prototype.isColorTransformByScript=function(){return this._ctBlockedByScript},e.prototype.freeFromScript=function(){this._blockedByScript=!1,this._ctBlockedByScript=!1,this._visibilityByScript=!1},e.prototype.clone=function(){if(!this._symbol)throw"_symbol not defined when cloning movieclip";var t=RT(this._symbol,this._symbol.symbolClass);return t.axInitializer(),t.loaderInfo=this.loaderInfo,this.adaptee.copyTo(t.adaptee),t},e.prototype.dispose=function(){throw new s},e.prototype.disposeValues=function(){this.adaptee=null},Object.defineProperty(e.prototype,"accessibilityProperties",{get:function(){return console.log("accessibilityProperties not implemented yet in flash/DisplayObject"),null},set:function(t){console.log("accessibilityProperties not implemented yet in flash/DisplayObject")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.adaptee.alpha},set:function(t){this._ctBlockedByScript=!0,this.adaptee.alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return""},set:function(t){this._adaptee.blendMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendShader",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheAsBitmap",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return this._filters},set:function(t){this._filters!=t&&(this._filters=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){if(this.adaptee.isAsset(sh))return this.adaptee.height;if(!this._adaptee.partition)return console.warn("Trying to get Display.height on orphan child!"),100;var t=this.getBoundsInternal(this.parent||this._stage);return null==t?0:t.height},set:function(t){isNaN(t)||(this._blockedByScript=!0,this.adaptee.isAsset(sh)?this.adaptee.height=t:this._adaptee.partition?ce.getInstance(this._stage.view).getBoundsPicker(this.adaptee.partition).height=t:console.warn("Trying to set Display.height on orphan child!"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loaderInfo",{get:function(){return this._loaderInfo},set:function(t){this._loaderInfo=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return null==this.adaptee.masks||0==this.adaptee.masks.length?null:this.adaptee.masks[0].adapter},set:function(t){if(null==t)return null!=this.adaptee.masks&&(this.adaptee.masks[0].maskMode=!1),void(this.adaptee.masks=null);t.adaptee.maskMode=!0,this.adaptee.masks=[t.adaptee]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metaData",{get:function(){return console.log("mask not implemented yet in flash/DisplayObject"),null},set:function(t){console.log("mask not implemented yet in flash/DisplayObject")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseX",{get:function(){return Math.floor(this.adaptee.transform.globalToLocal(new D(this._stage.mouseX,this._stage.mouseY)).x)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseY",{get:function(){return Math.floor(this.adaptee.transform.globalToLocal(new D(this._stage.mouseX,this._stage.mouseY)).y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.adaptee.name},set:function(t){this.adaptee.name=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opaqueBackground",{get:function(){return console.log("opaqueBackground not implemented yet in flash/DisplayObject"),null},set:function(t){console.log("opaqueBackground not implemented yet in flash/DisplayObject")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return null==this.adaptee.parent||null==this.adaptee.parent.adapter||this.adaptee.parent.adapter==this.adaptee.parent?null:this.adaptee.parent.adapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){var t=this._stage.getChildAt(0);return t||(console.log("DisplayObject: could not get root"),null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.adaptee.rotationZ},set:function(t){this._blockedByScript=!0,this.adaptee.rotationZ=isNaN(t)?0:isFinite(t)?t:-8},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationX",{get:function(){return this.adaptee.rotationX},set:function(t){this._blockedByScript=!0,this.adaptee.rotationX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationY",{get:function(){return this.adaptee.rotationY},set:function(t){this._blockedByScript=!0,this.adaptee.rotationY=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationZ",{get:function(){return this.adaptee.rotationZ},set:function(t){this._blockedByScript=!0,this.adaptee.rotationZ=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale9Grid",{get:function(){return new this.sec.flash.geom.Rectangle(this.adaptee.scale9Grid)},set:function(t){this.adaptee.scale9Grid=t.adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this.adaptee.scaleX},set:function(t){this._blockedByScript=!0,this.adaptee.scaleX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this.adaptee.scaleY},set:function(t){this._blockedByScript=!0,this.adaptee.scaleY=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleZ",{get:function(){return this.adaptee.scaleZ},set:function(t){this._blockedByScript=!0,this.adaptee.scaleZ=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollRect",{get:function(){return new this.sec.flash.geom.Rectangle(this.adaptee.scrollRect)},set:function(t){this.adaptee.scrollRect=t.adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stage",{get:function(){return this._isAVMStage?this:this.adaptee.parent?this.adaptee.parent.adapter.stage:null},set:function(t){this._stage=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transform",{get:function(){return this._ctBlockedByScript=!0,this._transform=new this.sec.flash.geom.Transform(this.adaptee.transform)},set:function(t){console.log("DisplayObject:setter for transform not yet implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._adaptee._explicitVisibility},set:function(t){this._visibilityByScript=!0,this._adaptee.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){if(this.adaptee.isAsset(sh))return this.adaptee.width;if(!this.adaptee.partition)return console.warn("Trying to get Display.width on orphan child!"),100;var t=this.getBoundsInternal(this.parent||this._stage);return null==t?0:t.width},set:function(t){this.adaptee.partition?(this._blockedByScript=!0,isNaN(t)||(this.adaptee.isAsset(sh)?this.adaptee.width=t:ce.getInstance(this._stage.view).getBoundsPicker(this.adaptee.partition).width=t)):console.warn("Trying to set Display.width on orphan child!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._adaptee._transform._matrix3D._rawData[12]},set:function(t){this._blockedByScript=!0,this._adaptee.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._adaptee._transform._matrix3D._rawData[13]},set:function(t){this._blockedByScript=!0,this._adaptee.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._adaptee._transform._matrix3D._rawData[14]},set:function(t){this._blockedByScript=!0,this._adaptee.z=t},enumerable:!0,configurable:!0}),e.prototype.getBounds=function(t){var e=this.getBoundsInternal(t,!0),i=this.sec.flash.geom.Rectangle;return e?new i(e.x,e.y,e.width,e.height):new i(6710886.4,6710886.4,0,0)},e.prototype.getBoundsInternal=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),t||(t=this),this._boundsPicker=ce.getInstance(this._stage.view).getBoundsPicker(this.adaptee.partition),this._boundsPicker.getBoxBounds(t.adaptee,e,!0)},e.prototype.getRect=function(t){var e=this.getBoundsInternal(t),i=this.sec.flash.geom.Rectangle;return e?new i(e.x,e.y,e.width,e.height):new i},e.prototype.globalToLocal=function(t){return new this.sec.flash.geom.Point(this.adaptee.transform.globalToLocal(t.adaptee))},e.prototype.globalToLocal3D=function(t){return console.log("DisplayObject:globalToLocal3D not yet implemented"),new this.sec.flash.geom.Vector3D},e.prototype.hitTestObject=function(t){return ce.getInstance(this._stage.view).getBoundsPicker(this.adaptee.partition).hitTestObject(ce.getInstance(this._stage.view).getBoundsPicker(t.adaptee.partition))},e.prototype.hitTestPoint=function(t,e,i){return void 0===i&&(i=!1),ce.getInstance(this._stage.view).getBoundsPicker(this.adaptee.partition).hitTestPoint(t,e,i)},e.prototype._getObjectsUnderPointInternal=function(t,e){},e.prototype.local3DToGlobal=function(t){return console.log("DisplayObject:local3DToGlobal not yet implemented"),new this.sec.flash.geom.Point},e.prototype.localToGlobal=function(t){return new this.sec.flash.geom.Point(this.adaptee.transform.localToGlobal(t.adaptee))},e._activeStage=null,e}(gR),bR=function(t){function e(e,i,n,r,o,s,a,l,u){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===u&&(u=!1);var c=t.call(this,e,i,n)||this;return c._charCode=r>>>0,c._keyCode=o>>>0,c._keyLocation=s>>>0,c._ctrlKey=!!a,c._altKey=!!l,c._shiftKey=!!u,c}return i(e,t),Object.defineProperty(e.prototype,"charCode",{get:function(){return this._charCode},set:function(t){this._charCode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keyCode",{get:function(){return this._keyCode},set:function(t){this._keyCode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keyLocation",{get:function(){return this._keyLocation},set:function(t){this._keyLocation=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ctrlKey",{get:function(){return this._ctrlKey},set:function(t){this._ctrlKey=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"altKey",{get:function(){return this._altKey},set:function(t){this._altKey=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shiftKey",{get:function(){return this._shiftKey},set:function(t){this._shiftKey=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this.bubbles,this.cancelable,this.charCode,this.keyCode,this.keyLocation,this.ctrlKey,this.altKey,this.shiftKey)},e.prototype.toString=function(){return this.formatToString("KeyboardEvent","type","bubbles","cancelable","eventPhase","charCode","keyCode","keyLocation","ctrlKey","altKey","shiftKey")},e.prototype.updateAfterEvent=function(){this.sec.player.requestRender()},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.KEY_DOWN="keyDown",e.KEY_UP="keyUp",e}(pR),xR=function(t){function e(){var e=t.call(this)||this;return e._mouseListnersCallbacksByType={},e.eventMappingDummys[mR.RIGHT_MOUSE_UP]="InteractiveObject:MouseEvent.RIGHT_MOUSE_UP",e.eventMappingDummys[mR.RIGHT_MOUSE_DOWN]="InteractiveObject:MouseEvent.RIGHT_MOUSE_DOWN",e.eventMappingDummys[mR.RIGHT_MOUSE_DOWN]="InteractiveObject:MouseEvent.RIGHT_MOUSE_DOWN",e.eventMappingDummys[mR.RIGHT_CLICK]="InteractiveObject:MouseEvent.RIGHT_CLICK",e.eventMappingDummys[mR.MIDDLE_MOUSE_UP]="InteractiveObject:MouseEvent.MIDDLE_MOUSE_UP",e.eventMappingDummys[mR.MIDDLE_MOUSE_DOWN]="InteractiveObject:MouseEvent.MIDDLE_MOUSE_DOWN",e.eventMappingDummys[mR.MIDDLE_CLICK]="InteractiveObject:MouseEvent.MIDDLE_CLICK",e._keyUpCallbackDelegate=function(t){return e.keyUpCallback(t)},e.eventMapping[bR.KEY_UP]={adaptedType:"",addListener:e.initKeyUpListener,removeListener:e.removeKeyUpListener,callback:e._keyUpCallbackDelegate},e._keyDownCallbackDelegate=function(t){return e.keyDownCallback(t)},e.eventMapping[bR.KEY_DOWN]={adaptedType:"",addListener:e.initKeyDownListener,removeListener:e.removeKeyDownListener,callback:e._keyDownCallbackDelegate},e._mouseCallbackDelegate=function(t){return e.mouseCallback(t)},e.eventMappingInvert[tl.MOUSE_WHEEL]=mR.MOUSE_WHEEL,e.eventMapping[mR.MOUSE_WHEEL]={adaptedType:tl.MOUSE_WHEEL,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e.eventMappingInvert[tl.MOUSE_UP]=mR.MOUSE_UP,e.eventMapping[mR.MOUSE_UP]={adaptedType:tl.MOUSE_UP,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e.eventMappingInvert[tl.MOUSE_OVER]=mR.MOUSE_OVER,e.eventMapping[mR.MOUSE_OVER]={adaptedType:tl.MOUSE_OVER,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e.eventMappingInvert[tl.MOUSE_OUT]=mR.MOUSE_OUT,e.eventMapping[mR.MOUSE_OUT]={adaptedType:tl.MOUSE_OUT,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e.eventMappingInvert[tl.MOUSE_MOVE]=mR.MOUSE_MOVE,e.eventMapping[mR.MOUSE_MOVE]={adaptedType:tl.MOUSE_MOVE,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e.eventMappingInvert[tl.MOUSE_DOWN]=mR.MOUSE_DOWN,e.eventMapping[mR.MOUSE_DOWN]={adaptedType:tl.MOUSE_DOWN,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e.eventMappingInvert[tl.DOUBLE_CLICK]=mR.DOUBLE_CLICK,e.eventMapping[mR.DOUBLE_CLICK]={adaptedType:tl.DOUBLE_CLICK,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e.eventMappingInvert[tl.CLICK]=mR.CLICK,e.eventMapping[mR.CLICK]={adaptedType:tl.CLICK,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e.eventMappingInvert[tl.ROLL_OUT]=mR.ROLL_OUT,e.eventMapping[mR.ROLL_OUT]={adaptedType:tl.ROLL_OUT,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e.eventMappingInvert[tl.ROLL_OVER]=mR.ROLL_OVER,e.eventMapping[mR.ROLL_OVER]={adaptedType:tl.ROLL_OVER,addListener:e.initMouseListener,removeListener:e.removeMouseListener,callback:e._mouseCallbackDelegate},e}return i(e,t),e.prototype.initKeyUpListener=function(t,e,i){if(!this._keyUpListeners)return this._keyUpListeners=[i],document.addEventListener("keyup",e),void document.addEventListener("keypress",e);this._keyUpListeners.push(i)},e.prototype.removeKeyUpListener=function(t,e,i){if(this._keyUpListeners){var n=this._keyUpListeners.indexOf(i);if(-1!=n){if(1==this._keyUpListeners.length)return this._keyUpListeners=null,void document.removeEventListener("keyup",e);this._keyUpListeners.splice(n,1)}}},e.prototype.keyUpCallback=function(t){if(void 0===t&&(t=null),!of.instance().isPaused){window.event&&(window.event.returnValue=!1),t.preventDefault?t.preventDefault():t.returnValue=!1;var e=new this.sec.flash.events.KeyboardEvent(bR.KEY_UP,!0,!1,t.charCode,t.keyCode,t.location,t.ctrlKey,t.altKey,t.shiftKey);return this.dispatchEvent(e),!1}},e.prototype.initKeyDownListener=function(t,e,i){if(!this._keyDownListeners)return this._keyDownListeners=[i],document.addEventListener("keydown",e),void document.addEventListener("keypress",e);this._keyDownListeners.push(i)},e.prototype.removeKeyDownListener=function(t,e,i){if(this._keyDownListeners){var n=this._keyDownListeners.indexOf(i);if(-1!=n){if(1==this._keyDownListeners.length)return this._keyDownListeners=null,document.removeEventListener("keydown",e),void document.removeEventListener("keypress",e);this._keyDownListeners.splice(n,1)}}},e.prototype.keyDownCallback=function(t){if(void 0===t&&(t=null),!of.instance().isPaused){window.event&&(window.event.returnValue=!1),t.preventDefault?t.preventDefault():t.returnValue=!1;var e=new this.sec.flash.events.KeyboardEvent(bR.KEY_DOWN);return e.axInitializer(bR.KEY_DOWN),e.keyCode=t.keyCode,e.charCode=t.charCode,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.altKey=t.altKey,this.dispatchEvent(e),!1}},e.prototype.initMouseListener=function(t,e,i){if(!this._mouseListnersCallbacksByType[t])return this.adaptee.addEventListener(t,e),void(this._mouseListnersCallbacksByType[t]=[i]);this._mouseListnersCallbacksByType[t].push(i)},e.prototype.removeMouseListener=function(t,e,i){if(this._mouseListnersCallbacksByType[t]){var n=this._mouseListnersCallbacksByType[t].indexOf(i);if(-1!=n){if(1==this._mouseListnersCallbacksByType[t].length)return delete this._mouseListnersCallbacksByType[t],void this.adaptee.removeEventListener(t,e);this._mouseListnersCallbacksByType[t].splice(n,1)}}},e.prototype.mouseCallback=function(t){var e=new this.sec.flash.events.MouseEvent(this.eventMappingInvert[t.type]);e.fillFromAway(t),e.target=this,this.dispatchEvent(e,!0)},Object.defineProperty(e.prototype,"accessibilityImplementation",{get:function(){return console.log("accessibilityImplementation not implemented yet in flash/InteractiveObject"),null},set:function(t){console.log("accessibilityImplementation not implemented yet in flash/InteractiveObject")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextMenu",{get:function(){return console.log("contextMenu not implemented yet in flash/InteractiveObject"),null},set:function(t){console.log("contextMenu not implemented yet in flash/InteractiveObject")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"doubleClickEnabled",{get:function(){return console.log("doubleClickEnabled not implemented yet in flash/InteractiveObject"),!1},set:function(t){console.log("doubleClickEnabled not implemented yet in flash/InteractiveObject")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focusRect",{get:function(){return console.log("focusRect not implemented yet in flash/InteractiveObject"),null},set:function(t){console.log("focusRect not implemented yet in flash/InteractiveObject")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseEnabled",{get:function(){return this.adaptee.mouseEnabled},set:function(t){this.adaptee.mouseEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"needsSoftKeyboard",{get:function(){return console.log("needsSoftKeyboard not implemented yet in flash/InteractiveObject"),!1},set:function(t){console.log("needsSoftKeyboard not implemented yet in flash/InteractiveObject")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"softKeyboardInputAreaOfInterest",{get:function(){return console.log("softKeyboardInputAreaOfInterest not implemented yet in flash/InteractiveObject"),null},set:function(t){console.log("softKeyboardInputAreaOfInterest not implemented yet in flash/InteractiveObject")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabEnabled",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabIndex",{get:function(){return console.log("tabIndex not implemented yet in flash/InteractiveObject"),0},set:function(t){console.log("tabIndex not implemented yet in flash/InteractiveObject")},enumerable:!0,configurable:!0}),e.prototype.requestSoftKeyboard=function(){return console.log("requestSoftKeyboard not implemented yet in flash/InteractiveObject"),!1},e}(vR),CR=function(t){function e(){var e=t.call(this)||this;if(e._tempSessionID=0,e._tempAS3Depth=0,e.adaptee&&e.adaptee._children)for(var i=e.adaptee._children,n=0;n<i.length;n++){var r=i[n],o=r.adapter,s=o.executeConstructor;s&&(o.executeConstructor=null,s()),r.just_added_to_timeline&&-1!=r._sessionID&&o&&o.dispatchStaticEvent&&(o.dispatchStaticEvent("added",o),r.just_added_to_timeline=!1,r.hasDispatchedAddedToStage=r.isOnDisplayList(),r.hasDispatchedAddedToStage&&o.dispatchStaticEvent("addedToStage",o))}return e}return i(e,t),e.prototype.addTimelineObjectAtDepth=function(t,e){},e.prototype.getTimelineObjectAtDepth=function(t){return null},e.prototype.createAdaptee=function(){return new Fa},e.prototype.clone=function(){if(!this._symbol)throw"_symbol not defined when cloning movieclip";var t=RT(this._symbol,this._symbol.symbolClass);return t.axInitializer(),this.adaptee.copyTo(t.adaptee),t},e.prototype.debugDisplayGraph=function(t){t.object=this,t.rectangle="x:"+this.x+", y:"+this.y+", width:"+this.width+", height:"+this.height,t.children={};var e=0;for(e=0;e<this._adaptee.numChildren;e++){var i=this._adaptee.getChildAt(e),n="child_"+e+" "+i.adapter.constructor.name;if(i.isAsset(ka)||i.isAsset(Fa))i.adapter&&(t.children[n]={},i.adapter.debugDisplayGraph(t.children[n]));else if(i.isAsset(za))t.children[n]={},t.children[n].object=i.adapter,t.children[n].name=i.name,t.children[n].rectangle="x:"+i.x+", y:"+i.y;else if(i.isAsset(il))t.children[n]={},t.children[n].object=i.adapter,t.children[n].name=i.name,t.children[n].rectangle="x:"+i.x+", y:"+i.y;else if(i.isAsset(sh)){t.children[n]={},t.children[n].object=i.adapter,t.children[n].text=i.text,t.children[n].rectangle="x:"+i.x+", y:"+i.y;var r=ce.getInstance(this._stage.view).getBoundsPicker(i.partition).getBoxBounds(i);t.children[n].width=null==r?0:r.width,t.children[n].height=null==r?0:r.height}}},e.prototype.dispatch_ADDED_TO_STAGE=function(t){if(void 0===t&&(t=!1),t&&(AR.events[pR.ADDED_TO_STAGE]||(AR.events[pR.ADDED_TO_STAGE]=new this.sec.flash.events.Event(pR.ADDED_TO_STAGE)),AR.events[pR.ADDED_TO_STAGE].target=this,this.dispatchEvent(AR.events[pR.ADDED_TO_STAGE])),this._adaptee)for(var e=this._adaptee._children,i=e.length,n=0;n<i;n++){var r=e[n];r.adapter&&r.adapter.dispatchEventRecursive&&!r.hasDispatchedAddedToStage&&(r.hasDispatchedAddedToStage=!0,r.adapter.dispatch_ADDED_TO_STAGE(!0))}},e.prototype.dispatch_REMOVED_FROM_STAGE=function(t){if(void 0===t&&(t=!1),t&&(AR.events[pR.REMOVED_FROM_STAGE]||(AR.events[pR.REMOVED_FROM_STAGE]=new this.sec.flash.events.Event(pR.REMOVED_FROM_STAGE)),AR.events[pR.REMOVED_FROM_STAGE].target=this,this.dispatchEvent(AR.events[pR.REMOVED_FROM_STAGE])),this._adaptee)for(var e=this._adaptee._children,i=e.length,n=0;n<i;n++){var r=e[n];r.adapter&&r.adapter.dispatchEventRecursive&&r.hasDispatchedAddedToStage&&(r.hasDispatchedAddedToStage=!1,r.adapter.dispatch_REMOVED_FROM_STAGE(!0))}},e.prototype.getChildForDraw=function(t){return this._tempSessionID=t._sessionID,this._tempAS3Depth=t._avmDepthID,t._setParent(null),t},e.prototype.returnChildAfterDraw=function(t){t._sessionID=this._tempSessionID,t._avmDepthID=this._tempAS3Depth,t._setParent(this.adaptee)},Object.defineProperty(e.prototype,"mouseChildren",{get:function(){return this._adaptee.mouseChildren},set:function(t){this._adaptee.mouseChildren=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numChildren",{get:function(){return this._adaptee.numChildren},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabChildren",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textSnapshot",{get:function(){throw"textSnapshot not implemented yet in flash/DisplayObjectContainer"},enumerable:!0,configurable:!0}),e.prototype.addChild=function(t){var e=!(t.adaptee.parent==this.adaptee);return this._adaptee.addChild(t.adaptee),e&&(t.dispatchStaticEvent(pR.ADDED,t),this.adaptee.isOnDisplayList()&&t.dispatch_ADDED_TO_STAGE(!0)),dL.removeOrphan(t.adaptee),t},e.prototype.addChildAt=function(t,e){var i=!(t.adaptee.parent==this.adaptee);return this.adaptee.addChildAt(t.adaptee,e),i&&(t.dispatchStaticEvent(pR.ADDED),this.adaptee.isOnDisplayList()&&t.dispatch_ADDED_TO_STAGE(!0)),t},e.prototype.areInaccessibleObjectsUnderPoint=function(t){throw"areInaccessibleObjectsUnderPoint not implemented yet in flash/DisplayObjectContainer"},e.prototype.contains=function(t){return this._adaptee.contains(t.adaptee)},e.prototype.getChildAt=function(t){var e=this._adaptee.getChildAt(t);e.adapter&&e.adapter!=e||((e.adapter=new this.sec.flash.display.Sprite).adaptee=e);return e.adapter},e.prototype.getChildByName=function(t){return this._adaptee.getChildByName(t)?this._adaptee.getChildByName(t).adapter:null},e.prototype.getChildIndex=function(t){return this._adaptee.getChildIndex(t.adaptee)},e.prototype.getObjectsUnderPoint=function(t){for(var e=ce.getInstance(this._stage.view).getRaycastPicker(this.adaptee.partition).getObjectsUnderPoint(new P(0,0,-1e3),new P(t.x,t.y,1e3)),i=[],n=e.length;n>0;){var r=e[--n];r instanceof Lc?r=r.parent:r.isAsset(ka)&&r.adapter==r&&(r.adapter=new this.sec.flash.display.Sprite,r.adapter.adaptee=r),i.push(r.adapter)}return i},e.prototype._getObjectsUnderPointInternal=function(t,e){for(var i,n=this._adaptee.numChildren,r=0;r<n;r++)if((i=this._adaptee._children[r]).visible){ce.getInstance(this._stage.view).getBoundsPicker(i.adaptee.partition).hitTestPoint(t.x,t.y,!0)&&e.push(i.adapter);var o=i.adapter;"function"!=typeof o._getObjectsUnderPointInternal||o._getObjectsUnderPointInternal(t,e)}},e.prototype.removeChild=function(t){try{this._adaptee.removeChild(t.adaptee)}catch(t){throw this.sec.createError("ArgumentError",db.NotAChildError)}return t},e.prototype.removeChildAt=function(t){return this._adaptee.removeChildAt(t).adapter},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=2147483647),e>=this._adaptee.numChildren&&(e=this._adaptee.numChildren-1),this._adaptee.removeChildren(t,e+1)},e.prototype.setChildIndex=function(t,e){var i=this.adaptee._children.indexOf(t.adaptee);if(i<0)throw"[DisplayObjectContainer.setChildindex] \t\t\t\t- todo: throw as3 error when child is not child of this obj";if(i!=e){if(e>this.adaptee._children.length)throw"[DisplayObjectContainer.setChildindex] - todo: throw as3 error when index is out of bounds";this.adaptee.setChildIndex(t.adaptee,e)}},e.prototype.stopAllMovieClips=function(){throw"stopAllMovieClips not implemented yet in flash/DisplayObjectContainer"},e.prototype.swapChildren=function(t,e){this._adaptee.swapChildren(t.adaptee,e.adaptee)},e.prototype.swapChildrenAt=function(t,e){this._adaptee.swapChildrenAt(t,e)},e}(xR),wR=function(t){function e(){var e=t.call(this)||this;return e.isDragging=!1,e.startDragPoint=new D,e.startDragMCPosition=new D,e.dragListenerDelegate=function(t){return e.dragListener(t)},e.stopDragDelegate=function(t){return e.stopDrag(t)},e._graphics=new e.sec.flash.display.Graphics(e._adaptee.graphics),e}return i(e,t),e.getNewSprite=function(t){if(e._sprites.length){var i=e._sprites.pop();return i.adaptee=t,i}return new e},e.prototype.initAdapter=function(){},e.prototype.createAdaptee=function(){var t=ka.getNewSprite();return t.reset(),t},e.prototype.addTimelineChildAtDepth=function(t,e){t.reset();for(var i=this.adaptee._children,n=i.length-1,r=n+1,o=0,s=n;s>=0;s--){var a=i[s];if(-1==a._avmDepthID&&o++,a._avmDepthID>-1){if(a._avmDepthID<e){r=s+1+o;break}o=0,r=s}}return t._avmDepthID=e,t.just_added_to_timeline=!0,this.adaptee._sessionID_childs[t._sessionID]=t,this.adaptee.addChildAt(t,r)},e.prototype.removeTimelineChildAt=function(t){var e=this.adaptee._sessionID_childs[t];e&&(delete this.adaptee._sessionID_childs[t],this.adaptee.removeChild(e))},e.prototype.queueFrameScripts=function(t,e,i){i?el.add_script_to_queue(this.adaptee,e):el.add_script_to_queue_pass2(this.adaptee,e)},e.prototype.constructFrame=function(t,e,i,n,r,o,s){for(var a,l,u=this.adaptee,c=u._children.length,h=[],p={},d=0;d<c;d++){var f=u._children[d];(n||-1==f._sessionID)&&(h[h.length]={sessionID:f._sessionID,as3DepthID:f._avmDepthID,addedOnTargetFrame:!1,child:f}),-1!=f._sessionID&&(p[f._sessionID]=f)}this.$Bg__setPropDict&&this.clearPropsDic(),t._update_indices.length=0,t._update_frames.length=0;var _,m,g=0;for(l=e;l<=i;l++){var y=t.frame_command_indices[l],A=t.frame_recipe[l];if(2&A){m=(_=t.command_index_stream[y])+t.command_length_stream[y++];var v={};for(a=_;a<m;a++)v[t.remove_child_stream[a]]=!0;var b=[];c=h.length;for(var x=0;x<c;x++)v[h[x].sessionID]||(b[b.length]=h[x]);h=b}if(4&A)for(m=(_=t.command_index_stream[y])+t.command_length_stream[y++],a=_;a<m;a++){for(var C=h.length-1,w=t.add_child_stream[3*a+1],I=C+1,E=0,S=C;S>=0;S--){var D=h[S];if(-1==D.as3DepthID&&E++,D.as3DepthID>-1){if(D.as3DepthID==w&&D.sessionID==t.add_child_stream[3*S]){I=-1;break}if(D.as3DepthID<w){I=S+1+E;break}E=0,I=S}}I>=h.length?h[h.length]={sessionID:t.add_child_stream[3*a],addedOnTargetFrame:l==i,symbolID:t.add_child_stream[3*a+2],as3DepthID:t.add_child_stream[3*a+1]}:I>-1&&h.splice(I,0,{sessionID:t.add_child_stream[3*a],addedOnTargetFrame:l==i,symbolID:t.add_child_stream[3*a+2],as3DepthID:t.add_child_stream[3*a+1]})}8&A&&(t._update_frames[g]=t.keyframe_firstframes[l],t._update_indices[g++]=y++),16&A&&l==i&&t.start_sounds(u,y)}var T,P=[],B=[],M=[];u._sessionID_childs={},c=P.length=h.length;for(var O=0;O<c;O++)if(-1==(T=h[O]).sessionID&&T.child)P[O]=T.child.adaptee;else if(p[T.sessionID]){var L=p[T.sessionID];u._sessionID_childs[T.sessionID]=L,P[O]=L,n||(P[O]._adapter?(P[O].adapter.isColorTransformByScript()||P[O].transform.clearColorTransform(),P[O].adapter.isBlockedByScript()||P[O].noTimelineUpdate||(P[O].transform.clearMatrix3D(),P[O].masks=null,P[O].maskMode=!1),P[O].adapter.isVisibilityByScript()||(P[O].visible=!0)):(P[O].transform.clearColorTransform(),P[O].transform.clearMatrix3D(),P[O].visible=!0,P[O].masks=null,P[O].maskMode=!1))}else{var R=t.getChildInstance(T.symbolID,T.sessionID);this.adaptee.isSlice9ScaledMC&&"[asset Sprite]"==R.assetType&&(R.isSlice9ScaledSprite=!0),R._sessionID=T.sessionID,R._avmDepthID=T.as3DepthID,u._sessionID_childs[T.sessionID]=R,P[O]=R,T.addedOnTargetFrame?M[M.length]=R:B[B.length]=R}c=u._children.length;for(var N=0;N<c;N++)P.indexOf(u._children[N])<0&&u._children[N]._setParent(null);u._children=P,u.preventScript=!0,this.finalizeChildren(B),s&&this.queueFrameScripts(t,r,!o),u.preventScript=!0,this.finalizeChildren(M)},e.prototype.finalizeChildren=function(t){for(var e=t.length,i=0;i<e;i++){var n=t[i];n.adapter!=n&&n.adapter.deleteOwnProperties&&n.adapter.deleteOwnProperties(),n.just_added_to_timeline=!0,n._setParent(this.adaptee),n.reset()}},e.prototype.registerScriptObject=function(t){t.adapter!=t&&t.name&&(this[t.name]=t._adapter?t.adapter:t,this.axSetPublicProperty(t.name,t.adapter))},e.prototype.unregisterScriptObject=function(t){delete this[t.name],t.isAsset(il)&&t.removeButtonListeners()},e.prototype.clearPropsDic=function(){},e.prototype.clone=function(){var t=this;if(!this._symbol)throw"_symbol not defined when cloning movieclip";var e=RT(this._symbol,this._symbol.symbolClass),i=new ka;this.adaptee.copyTo(i),e.adaptee=i,e._stage=this.activeStage,e.executeConstructor=function(){e.axInitializer(),t.constructorHasRun=!0},e.adaptee.graphics=this.graphics;var n=i.timeline,r=n;return r.frame_command_indices=[n.frame_command_indices[0]],r.frame_recipe=[n.frame_recipe[0]],r.keyframe_constructframes=[n.keyframe_constructframes[0]],r.keyframe_durations=[n.keyframe_durations[0]],r.keyframe_firstframes=[n.keyframe_firstframes[0]],r.keyframe_indices=[n.keyframe_indices[0]],e},e.prototype.dispose=function(){this.disposeValues()},Object.defineProperty(e.prototype,"buttonMode",{get:function(){return this.adaptee.buttonMode},set:function(t){this.adaptee.buttonMode=t},enumerable:!0,configurable:!0}),e.prototype.setDropTarget=function(t){this._dropTarget=t?t.adapter:null},Object.defineProperty(e.prototype,"dropTarget",{get:function(){return this._dropTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphics",{get:function(){return this._graphics},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitArea",{get:function(){return this.adaptee.pickObject.adapter},set:function(t){this.adaptee.pickObject=t.adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"soundTransform",{get:function(){return console.log("soundTransform not implemented yet in flash/Sprite"),null},set:function(t){console.log("soundTransform not implemented yet in flash/Sprite")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useHandCursor",{get:function(){return this.adaptee._useHandCursor},set:function(t){this.adaptee._useHandCursor=t},enumerable:!0,configurable:!0}),e.prototype.startDrag=function(t,i){if(void 0===t&&(t=!1),void 0===i&&(i=null),e.currentDraggedMC&&e.currentDraggedMC!=this&&e.currentDraggedMC.stopDrag(),e.currentDraggedMC=this,this._dragBounds=i,!this.isDragging){this.isDragging=!0,this.startDragPoint=this.adaptee.parent.transform.globalToLocal(new D(this.stage.mouseX,this.stage.mouseY)),t&&(this.adaptee.x=this.startDragPoint.x,this.adaptee.y=this.startDragPoint.y),this._dragBounds&&this.checkBounds(),this.startDragMCPosition.x=this.adaptee.x,this.startDragMCPosition.y=this.adaptee.y;var n=of.instance();n.mousePicker.dragEntity=this.adaptee,n.mouseManager.startDragObject(this.adaptee.getAbstraction(n.mousePicker.pickGroup).pickingCollision),n.view.stage.addEventListener(tl.MOUSE_MOVE,this.dragListenerDelegate)}},e.prototype.checkBounds=function(){this.adaptee.x<this._dragBounds.left&&(this.adaptee.x=this._dragBounds.left),this.adaptee.x>this._dragBounds.right&&(this.adaptee.x=this._dragBounds.right),this.adaptee.y<this._dragBounds.top&&(this.adaptee.y=this._dragBounds.top),this.adaptee.y>this._dragBounds.bottom&&(this.adaptee.y=this._dragBounds.bottom)},e.prototype.dragListener=function(t){if(this.adaptee.parent){var e=this.adaptee.parent.transform.globalToLocal(new D(this.stage.mouseX,this.stage.mouseY));this.adaptee.x=this.startDragMCPosition.x+(e.x-this.startDragPoint.x),this.adaptee.y=this.startDragMCPosition.y+(e.y-this.startDragPoint.y),this._dragBounds&&this.checkBounds()}},e.prototype.startTouchDrag=function(t,e,i){console.log("startTouchDrag not implemented yet in flash/Sprite")},e.prototype.stopDrag=function(t){e.currentDraggedMC&&e.currentDraggedMC!=this&&e.currentDraggedMC.stopDrag(),this.isDragging=!1,e.currentDraggedMC=null;var i=of.instance();i.mousePicker.dragEntity=null,i.mouseManager.stopDragObject(),i.view.stage.removeEventListener(tl.MOUSE_MOVE,this.dragListenerDelegate)},e.prototype.stopTouchDrag=function(t){console.log("startTouchDrag not implemented yet in flash/Sprite")},e._sprites=new Array,e.currentDraggedMC=null,e}(CR),IR=function(t){function e(){var e=t.call(this)||this;return e.queuedNavigationAction=null,e}return i(e,t),e.prototype.applySymbol=function(){},e.getNewMovieClip=function(t){if(e._movieClips.length){var i=e._movieClips.pop();return i.adaptee=t,i}return new e},e.prototype._getAbsFrameNumber=function(t,e){return 0},e.prototype.callFrame=function(t){},e.prototype._callFrame=function(t){},e.prototype.addScript=function(t){return t},e.prototype.executeScript=function(t){if((this.allowScript||!(this.sec.swfVersion>9))&&(t=this.adaptee.timeline.get_script_for_frame(this.adaptee,this.adaptee.currentFrameIndex,!1))){this.allowScript=!1;var i=e.current_script_scope;e.current_script_scope=this;for(var n=0;n<t.length;n++)t[n].setReceiver(this),t[n].axCall(this);if(e.current_script_scope=i,this.queuedNavigationAction){var r=this.queuedNavigationAction;this.queuedNavigationAction=null,r()}}},e.prototype.initAdapter=function(){},e.prototype.createAdaptee=function(){var t=il.getNewMovieClip();return t.reset(),t},e.prototype.clearPropsDic=function(){},e.prototype.evalScript=function(t){var e=document.createElement("script");e.text="var __framescript__ = function() {\n"+t+"\n}";var i=document.scripts[0];i.parentNode.insertBefore(e,i).parentNode.removeChild(e);var n=__framescript__;return window.__framescript__=null,n},e.prototype.freeFromScript=function(){t.prototype.freeFromScript.call(this)},e.prototype.clone=function(){var t,e,i;if(!this._symbol)throw"_symbol not defined when cloning movieclip";var n=RT(this._symbol,this._symbol.symbolClass),r=new il(this.adaptee.timeline);if(this.adaptee.copyTo(r),n.adaptee=r,n._stage=this.activeStage,n.executeConstructor=function(){n.axInitializer(),n.constructorHasRun=!0},r.timeline){for(var o=!1,s=this._symbol.symbolClass;s&&!o;)"UIComponent"==(null===(t=s.name)||void 0===t?void 0:t.name)?o=!0:"MovieClip"==(null===(e=s.name)||void 0===e?void 0:e.name)?s=null:"Sprite"==(null===(i=s.name)||void 0===i?void 0:i.name)?o=!0:s=s.superClass?s.superClass:null;var a=this._symbol.className;if(o||a&&a.includes("Font")){var l=r.timeline,u=l;u.frame_command_indices=[l.frame_command_indices[0]],u.frame_recipe=[l.frame_recipe[0]],u.keyframe_constructframes=[l.keyframe_constructframes[0]],u.keyframe_durations=[l.keyframe_durations[0]],u.keyframe_firstframes=[l.keyframe_firstframes[0]],u.keyframe_indices=[l.keyframe_indices[0]]}}return n},e.prototype.dispose=function(){this.disposeValues()},Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this._adaptee.currentFrameIndex+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrameLabel",{get:function(){return this.adaptee.timeline.getCurrentFrameLabel(this.adaptee)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentLabel",{get:function(){return this.adaptee.timeline.getCurrentLabel(this.adaptee)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentLabels",{get:function(){if(this._currentLabels)return this._currentLabels;var t=this.adaptee.timeline._labels,e=this.adaptee.timeline.keyframe_firstframes;for(var i in this._currentLabels=[],t)this._currentLabels.push(new this.sec.flash.display.FrameLabel(t[i].name,e[t[i].keyFrameIndex]+1));return this._currentLabels},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentScene",{get:function(){return console.log("currentScene not implemented yet in flash/MovieClip"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this.adaptee.buttonEnabled},set:function(t){this.adaptee.buttonEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"framesLoaded",{get:function(){return console.log("framesLoaded not implemented yet in flash/MovieClip"),this.totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this.adaptee.isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scenes",{get:function(){return console.log("scenes not implemented yet in flash/MovieClip"),[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._adaptee.numFrames},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trackAsMenu",{get:function(){return console.log("trackAsMenu not implemented yet in flash/MovieClip"),!1},set:function(t){console.log("trackAsMenu not implemented yet in flash/MovieClip")},enumerable:!0,configurable:!0}),e.prototype.addFrameScript=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=arguments.length;1&i&&this.sec.throwError("ArgumentError TooFewArgumentsError",i,i+1);for(var n=0;n<i;n+=2){var r=0|t[n],o=t[n+1];this.adaptee.timeline.add_framescript(o,r,this.adaptee)}this.constructorHasRun=!0},e.prototype.gotoAndPlay=function(t,i,n){var r=this;if(void 0===i&&(i=null),void 0===n&&(n=!1),n||e.current_script_scope!=this){if(null!=t)return"string"==typeof t&&null==this.adaptee.timeline._labels[t]?(t=parseInt(t),void(isNaN(t)||(this.adaptee.currentFrameIndex=t-1,this.adaptee.play()))):void("number"==typeof t&&t<=0||(this.play(),this._gotoFrame(t)))}else this.queuedNavigationAction=function(){return r.gotoAndPlay(t,i,!0)}},e.prototype.gotoAndStop=function(t,i,n){var r=this;if(void 0===i&&(i=null),void 0===n&&(n=!1),n||e.current_script_scope!=this){if(null!=t)return"string"==typeof t&&null==this.adaptee.timeline._labels[t]?(t=parseInt(t),isNaN(t)||(this.adaptee.currentFrameIndex=t-1,this.adaptee.stop()),this.sec.swfVersion>10&&(this.adaptee.currentFrameIndex=0),void this.stop()):void("number"==typeof t&&t<=0?this.stop():(this.stop(),this._gotoFrame(t)));this.stop()}else this.queuedNavigationAction=function(){return r.gotoAndStop(t,i,!0)}},e.prototype._gotoFrame=function(t){var e=this.currentFrame;"string"==typeof t?this._adaptee.jumpToLabel(t):"number"==typeof t&&t<=0?console.warn("[playerglobal/MovieClip] - gotoFrame called with invalid frame-index"):this._adaptee.currentFrameIndex=t-1,this.currentFrame!=e&&(el.execute_as3_constructors_recursiv(this.adaptee),el.execute_as3_constructors_finish_scene(this.root.adaptee),this.sec.swfVersion>9&&(this.dispatchStaticBroadCastEvent(pR.FRAME_CONSTRUCTED),el.execute_queue(),this.dispatchStaticBroadCastEvent(pR.EXIT_FRAME)))},e.prototype.nextFrame=function(t){var i=this;void 0===t&&(t=!1),t||e.current_script_scope!=this?(this._adaptee.stop(),++this._adaptee.currentFrameIndex,el.execute_as3_constructors_recursiv(this.adaptee),el.execute_as3_constructors_finish_scene(this.root.adaptee),this.sec.swfVersion>9&&(this.dispatchStaticBroadCastEvent(pR.FRAME_CONSTRUCTED),el.execute_queue(),this.dispatchStaticBroadCastEvent(pR.EXIT_FRAME))):this.queuedNavigationAction=function(){return i.nextFrame(!0)}},e.prototype.nextScene=function(t){var i=this;void 0===t&&(t=!1),t||e.current_script_scope!=this?console.log("nextScene not implemented yet in flash/MovieClip"):this.queuedNavigationAction=function(){return i.nextScene(!0)}},e.prototype.play=function(){return this._adaptee.play()},e.prototype.prevFrame=function(t){var i=this;void 0===t&&(t=!1),t||e.current_script_scope!=this?(this._adaptee.currentFrameIndex>0&&(this._adaptee.currentFrameIndex=this._adaptee.currentFrameIndex-1),el.execute_as3_constructors_recursiv(this.adaptee),el.execute_as3_constructors_finish_scene(this.root.adaptee),this.sec.swfVersion>9&&(this.dispatchStaticBroadCastEvent(pR.FRAME_CONSTRUCTED),el.execute_queue(),this.dispatchStaticBroadCastEvent(pR.EXIT_FRAME))):this.queuedNavigationAction=function(){return i.prevFrame(!0)}},e.prototype.prevScene=function(t){var i=this;void 0===t&&(t=!1),t||e.current_script_scope!=this?console.log("prevScene not implemented yet in flash/MovieClip"):this.queuedNavigationAction=function(){return i.prevScene(!0)}},e.prototype.stop=function(){return this._adaptee.stop()},e._movieClips=new Array,e.current_script_scope=null,e}(wR),ER=function(t){function e(i,n,r){void 0===i&&(i=null),void 0===n&&(n="auto"),void 0===r&&(r=!1);var o=this,s=new ac(i?i.adaptee:0);return s.alphaBlending=!0,s.useColorTransform=!0,e.argBitmapMaterial=s,e.argPixelSnapping=n,e.argSmoothing=r,o=t.call(this)||this,i&&!o._bitmapMappedFromAsset&&(o._bitmapData=i,o._bitmapData&&o._bitmapData._addOwner(o)),o}return i(e,t),e.getNewBitmap=function(t,i,n){if(void 0===t&&(t=null),void 0===i&&(i="auto"),void 0===n&&(n=!1),e._bitmaps.length){var r=new ac(t?t.adaptee:0);r.alphaBlending=!0,r.useColorTransform=!0;var o=e._bitmaps.pop();return o.adaptee=za.getNewBillboard(r,i,n),o}return new e(t,i,n)},e.prototype.mapAdaptee=function(e){var i=e;if(e instanceof hn||e instanceof mh){this._adaptee=i=za.getNewBillboard(new ac(e),"auto",!1);var n=new this.sec.flash.display.BitmapData(e);this.bitmapData=n,this._bitmapMappedFromAsset=!0}return t.prototype.mapAdaptee.call(this,i)},e.prototype.createAdaptee=function(){var t=za.getNewBillboard(e.argBitmapMaterial,e.argPixelSnapping,e.argSmoothing);return e.argBitmapMaterial=null,e.argPixelSnapping=null,e.argSmoothing=null,t},e.prototype.clone=function(){var t=e.getNewBitmap(this._bitmapData);return this._adaptee.copyTo(t.adaptee),t},e.prototype.dispose=function(){this.disposeValues(),e._bitmaps.push(this)},e.prototype.disposeValues=function(){this.bitmapData=null,t.prototype.disposeValues.call(this)},Object.defineProperty(e.prototype,"bitmapData",{get:function(){return this._bitmapData},set:function(t){if(this._bitmapData!=t){this._bitmapData&&this._bitmapData._removeOwner(this),this._bitmapData=t,this._bitmapData&&this._bitmapData._addOwner(this);var e=this._adaptee.material;this._bitmapData?(e.ambientMethod.texture||(e.ambientMethod.texture=new hl),e.style.image=this._bitmapData.adaptee):(e.ambientMethod.texture&&(e.ambientMethod.texture=null),e.style.image=null,e.style.color=0),e.invalidateTextures()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixelSnapping",{get:function(){return""},set:function(t){console.log("pixelSnapping not implemented yet in flash/Bitmap")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smoothing",{get:function(){return!!this.adaptee.sampler&&this.adaptee.sampler.smooth},set:function(t){this.adaptee.sampler&&(this.adaptee.sampler.smooth=t)},enumerable:!0,configurable:!0}),e._bitmaps=new Array,e}(vR),SR=function(t){function e(e,i,n,r){void 0===n&&(n=!0),void 0===r&&(r=4294967295);var o=t.call(this)||this;return o._owners=new Array,"number"==typeof e?o._adaptee||(o._adaptee=mh.getImage(e,i,n,r,!1,xn.getInstance().getStageAt(0)),o._adaptee.useWeakRef()):o._adaptee=e,o._adaptee.adapter=o,o}return i(e,t),e.prototype.compare=function(t){return!0},Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},set:function(t){this._adaptee=t},enumerable:!0,configurable:!0}),e.loadBitmap=function(t){return console.log("loadBitmap not implemented yet in flash/BitmapData"),null},e.prototype.setPixels=function(t,e){console.log("todo: BitmapData.setPixels")},e.prototype.getPixels=function(t){var e=this.adaptee.getPixels(t.adaptee),i=new this.sec.flash.utils.ByteArray;return i.setArrayBuffer(e.buffer),i},e.prototype.copyPixelsToByteArray=function(t,e){console.log("copyPixelsToByteArray not implemented yet in flash/BitmapData")},e.prototype.getVector=function(t){var e=this.adaptee.getPixels(t.adaptee),i=new this.sec.Uint32Vector(0,!0);return i._buffer=new Uint32Array(e.buffer),i._length=e.length/4,i},e.prototype.setVector=function(t,e){},e.prototype.histogram=function(t){},e.prototype.encode=function(t,e,i){},e.prototype.drawWithQuality=function(t,e,i,n,r,o,s){},Object.defineProperty(e.prototype,"transparent",{get:function(){return this._adaptee.transparent},set:function(t){this._adaptee.transparent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._adaptee.width},set:function(t){this._adaptee.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._adaptee.height},set:function(t){this._adaptee.height=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new this.sec.flash.display.BitmapData(this._adaptee.width,this._adaptee.height,this._adaptee.transparent,null);return this._adaptee.copyTo?this._adaptee.copyTo(t._adaptee):t.copyPixels(this,this.rect,new this.sec.flash.geom.Point),t},Object.defineProperty(e.prototype,"rect",{get:function(){return new this.sec.flash.geom.Rectangle(this._adaptee.rect.clone())},enumerable:!0,configurable:!0}),e.prototype.getPixel=function(t,e){return this._adaptee.getPixel(t,e)},e.prototype.getPixel32=function(t,e){return this._adaptee.getPixel32(t,e)},e.prototype.setPixel=function(t,e,i){this._adaptee.setPixel(t,e,i)},e.prototype.setPixel32=function(t,e,i){this._adaptee.setPixel32(t,e,i)},e.prototype.applyFilter=function(t,e,i,n){return console.log("applyFilter not implemented yet in flash/BitmapData"),0},e.prototype.colorTransform=function(t,e){this._adaptee.colorTransform(t.adaptee,e.adaptee)},e.prototype.copyChannel=function(t,e,i,n,r){this._adaptee.copyChannel(t.adaptee,e.adaptee,i.adaptee,n,r)},e.prototype.copyPixels=function(t,e,i,n,r,o){void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=!1),this._adaptee.copyPixels(t.adaptee,e.adaptee,i.adaptee,n?n.adaptee:null,r?r.adaptee:null,o)},e.prototype.dispose=function(){this._adaptee&&(this._adaptee.dispose(),this._adaptee=null)},e.prototype.draw=function(t,e,i,n,r,o){void 0===i&&(i=null),void 0===n&&(n=""),void 0===r&&(r=null),void 0===o&&(o=!1),this._adaptee.draw(t.adaptee,e?e.adaptee:null,i?i.adaptee:null,n,r?r.adaptee:null,o)},e.prototype.fillRect=function(t,e){this._adaptee.fillRect(t.adaptee,e)},e.prototype.floodFill=function(t,e,i){console.warn("Unsage implementation `floodFill`"),this._adaptee.floodFill(t,e,i)},e.prototype.generateFilterRect=function(t,e){return console.log("generateFilterRect not implemented yet in flash/BitmapData"),null},e.prototype.getColorBoundsRect=function(t,e,i){return console.warn("Unsage implementation `getColorBoundsRect`!"),new this.sec.flash.geom.Rectangle(this._adaptee.getColorBoundsRect(t,e,i))},e.prototype.hitTest=function(t,e,i,n,r){return void 0===n&&(n=new this.sec.flash.geom.Point(0,0)),console.log("hitTest not implemented yet in flash/BitmapData"),!1},e.prototype.lock=function(){this._adaptee.lock()},e.prototype.merge=function(t,e,i,n,r,o,s){this._adaptee.merge(t.adaptee,t.rect.adaptee,i.adaptee,n,r,o,s)},e.prototype.noise=function(t,e,i,n,r){console.log("noise not implemented yet in flash/BitmapData")},e.prototype.paletteMap=function(t,e,i,n,r,o,s){console.log("paletteMap not implemented yet in flash/BitmapData")},e.prototype.perlinNoise=function(t,e,i,n,r,o,s,a,l){console.log("perlinNoise not implemented yet in flash/BitmapData")},e.prototype.pixelDissolve=function(t,e,i,n,r,o){return console.log("pixelDissolve not implemented yet in flash/BitmapData"),0},e.prototype.scroll=function(t,e){e|=0,((t|=0)||e)&&this._adaptee.copyPixels(this._adaptee,this._adaptee.rect,new D(t,e),null,null,!1)},e.prototype.threshold=function(t,e,i,n,r,o,s,a){return this._adaptee.threshold(t.adaptee,e.adaptee,i.adaptee,n,r,o,s,a),0},e.prototype.unlock=function(){this._adaptee.unlock()},e.prototype._addOwner=function(t){-1==this._owners.indexOf(t)&&this._owners.push(t)},e.prototype._removeOwner=function(t){var e=this._owners.indexOf(t);-1!=e&&this._owners.splice(e,1),!this._owners.length&&this._adaptee&&this._adaptee.clear()},e}(bb),DR=function(t){function e(e,i){var n=t.call(this)||this;return n.imageStore={},n._sec=e,n._loaderInfo=i,n}return i(e,t),Object.defineProperty(e.prototype,"appDomain",{get:function(){return this._loaderInfo?this._loaderInfo.applicationDomain.axApplicationDomain:this._sec.application},enumerable:!0,configurable:!0}),e.prototype.executeABCBytes=function(t){for(var e=0;e<t.length;e++){var i=t[e],n=new lR({app:this.appDomain,url:""},i.data);i.flags?this.appDomain.loadABC(n):this.appDomain.loadAndExecuteABC(n)}return null},e.prototype.createSprite=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),!i||!this._sec)throw"no symbol provided";var n=null;n=i.className?this.appDomain.getClass(Kv.FromFQNString(i.className,0)):this._sec.flash.display.Sprite.axClass,i.symbolClass=n;var r=RT(i,n);return r.adaptee=new ka(e),r.adaptee},e.prototype.createDisplayObjectContainer=function(t){return(new this._sec.flash.display.DisplayObjectContainer).adaptee},e.prototype.createBinarySymbol=function(t){void 0===t&&(t=null),this.appDomain.addBinarySymbol(t)},e.prototype.createMovieClip=function(t,e){if(void 0===e&&(e=null),!e||!this._sec)throw"no symbol provided";var i=null;e.className?(i=this.appDomain.getClass(Kv.FromFQNString(e.className,0)))._symbol=e:i=this._sec.flash.display.MovieClip.axClass,e.symbolClass=i;var n=RT(e,this._sec.flash.display.MovieClip.axClass);return n.adaptee=new il,e.timeline=n.adaptee.timeline,n.adaptee},e.prototype.createTextField=function(t){void 0===t&&(t=null);var e=null;e=t.className?this.appDomain.getClass(Kv.FromFQNString(t.className,0)):this._sec.flash.text.TextField.axClass,t.symbolClass=e;var i=RT(t,e);return i.axInitializer(),i.adaptee},e.prototype.createBillboard=function(t,e){return new ER(t.style.image.adapter).adaptee},e.prototype.createImage2D=function(t,e,i,n,r,o){void 0===i&&(i=!0),void 0===n&&(n=null);var s=new SR(t,e,i,n).adaptee;return s.unuseWeakRef(),s},e.prototype.createFrameScripts=function(t,e,i,n){return console.warn("[FlashSceneGraphFactory] - createFrameScripts - should never be called"),null},e}(ah),TR=function(t){function e(){return t.call(this)||this}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(gR),PR=function(t){function e(e,i){var n=t.call(this)||this;return n.loopsToPlay=0,n}return i(e,t),Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},set:function(t){this._adaptee=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesLoaded",{get:function(){return console.log("bytesLoaded not implemented yet in flash/Sound"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesTotal",{get:function(){return console.log("bytesTotal not implemented yet in flash/Sound"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id3",{get:function(){return console.log("id3 not implemented yet in flash/Sound"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBuffering",{get:function(){return console.log("isBuffering not implemented yet in flash/Sound"),!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isURLInaccessible",{get:function(){return console.log("isURLInaccessible not implemented yet in flash/Sound"),!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._adaptee.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return console.log("url not implemented yet in flash/Sound"),""},enumerable:!0,configurable:!0}),e.prototype.close=function(){console.log("close not implemented yet in flash/Sound")},e.prototype.extract=function(t,e,i){return console.log("extract not implemented yet in flash/Sound"),0},e.prototype.load=function(t,e){console.log("load not implemented yet in flash/Sound")},e.prototype.loadCompressedDataFromByteArray=function(t,e){console.log("loadCompressedDataFromByteArray not implemented yet in flash/Sound")},e.prototype.loadPCMFromByteArray=function(t,e,i,n,r){console.log("loadPCMFromByteArray not implemented yet in flash/Sound")},e.prototype.soundCompleteInternal=function(){this.loopsToPlay--,this.loopsToPlay>0?(this.stop(),this.adaptee.play(0,!1)):this._onCompleteCallback&&this._onCompleteCallback()},e.prototype.play=function(t,e,i){var n=this;if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),!this.adaptee)return console.warn("[Sound#play]: no adaptee exists!"),new this.sec.flash.media.SoundChannel;i&&(this.adaptee.volume=i.volume,this.adaptee.pan=i.pan),e=isNaN(e)||e<1?1:Math.floor(e),this.loopsToPlay=e,this._adaptee.onSoundComplete=function(){return n.soundCompleteInternal()},this._adaptee.play(t,!1);var r=new this.sec.flash.media.SoundChannel;return r._sound=this,i||(i=new this.sec.flash.media.SoundTransform),r.soundTransform=i,r},e.prototype.stop=function(){this._adaptee.stop()},e}(gR),BR=function(t){function e(i,n){void 0===i&&(i=null),void 0===n&&(n=!1);var r=t.call(this)||this;return n||null!=i||null==e._currentDomain||(i=e.getSystemDomain()),e._currentDomain||(e._currentDomain=r),r._parentDomain=i,r._definitions={},r._font_definitions={},r._audio_definitions={},r.axApplicationDomain=n?r.sec.system:i?new ZO(r.sec,r.parentDomain.axApplicationDomain):r.sec.application,r.axApplicationDomain.awayApplicationDomain=r,r}return i(e,t),e.getSystemDomain=function(){return null==e._systemDomain&&(e._systemDomain=new e(null,!0)),e._systemDomain},Object.defineProperty(e,"currentDomain",{get:function(){return e._currentDomain},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"domainMemory",{get:function(){return console.log("[UNSAFE IMPLEMENTATION!] domainMemory:flash/ApplicationDomain"),this._memory},set:function(t){console.log("[UNSAFE IMPLEMENTATION!] domainMemory:flash/ApplicationDomain"),(t||this._memory.buffer!==t.buffer)&&(this._memoryView=new DataView(t.buffer)),this._memory=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"internal_memoryView",{get:function(){return this._memoryView},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MIN_DOMAIN_MEMORY_LENGTH",{get:function(){return console.log("MIN_DOMAIN_MEMORY_LENGTH not implemented yet in flash/ApplicationDomain"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentDomain",{get:function(){return this._parentDomain},enumerable:!0,configurable:!0}),e.prototype.addDefinition=function(t,e){this._definitions[t]=e},e.prototype.addAudioDefinition=function(t,e){this._audio_definitions[t]=e},e.prototype.addFontDefinition=function(t,e){this._font_definitions[t]=e},e.prototype.hasSymbolForClass=function(t){return this._definitions[t]||this._font_definitions[t]||this._audio_definitions[t]},e.prototype.getSymbolAdaptee=function(t){var e=this._definitions[t];if(e){if(e.isAsset&&e.isAsset(mh)||!e.adapter)return e;var i=e.adapter.clone();return i.adaptee.isAsset(il)&&(i.adaptee.currentFrameIndex=0),i.adaptee}return this._font_definitions[t]?this._font_definitions[t]:this._audio_definitions[t]?this._audio_definitions[t]:null},e.prototype.getSymbolDefinition=function(t){var e=this._definitions[t];if(e){if(e.isAsset&&e.isAsset(mh))return e;var i=e.adapter.clone();return i.adaptee.isAsset(il)&&(i.adaptee.currentFrameIndex=0),i}if(this._font_definitions[t])return this._font_definitions[t];if(this._audio_definitions[t]){var n=new PR;return n.adaptee=this._audio_definitions[t],n}},e.prototype.getDefinition=function(t){return this.axApplicationDomain.getClass(Kv.FromSimpleName(t))},e.prototype.getFontDefinition=function(t){return this._font_definitions[t]},e.prototype.getAwayJSAudio=function(t){return this._audio_definitions[t]},e.prototype.getAudioDefinition=function(t){var e=new PR;return e.adaptee=this._audio_definitions[t],e},e.prototype.getQualifiedDefinitionNames=function(){var t=[];for(var e in this._definitions)this._definitions.hasOwnProperty(e)&&(t[t.length]=e);return t},e.prototype.hasDefinition=function(t){try{return!!this.getDefinition(t)}catch(t){return!1}},e.prototype.hasFontDefinition=function(t){return this._font_definitions.hasOwnProperty(t)},e.prototype.hasAudioDefinition=function(t){return this._audio_definitions.hasOwnProperty(t)},e}(bb),MR=function(t){function e(e,i,n){void 0===e&&(e=!1),void 0===i&&(i=null),void 0===n&&(n=null);var r=t.call(this)||this,o=r.sec;return r.checkPolicyFile=e,r.applicationDomain=i||new o.flash.system.ApplicationDomain(BR.currentDomain),r.securityDomain=n,r}return i(e,t),e}(bb),OR=function(t){function e(){var e=t.call(this)||this;return e._contentLoaderInfo=new e.sec.flash.display.LoaderInfo(e,e.adaptee),e._factory=new DR(e.sec,e._contentLoaderInfo),e}return i(e,t),e.executeQueue=function(){if(e.loaderQueue.length){var t=e.loaderQueue.concat();e.loaderQueue.length=0;for(var i=0,n=t;i<n.length;i++){(0,n[i])()}}},Object.defineProperty(e.prototype,"contentLoaderInfo",{get:function(){return this._contentLoaderInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uncaughtErrorEvents",{get:function(){return this._uncaughtErrorEvents||(this._uncaughtErrorEvents=new TR),this._uncaughtErrorEvents},enumerable:!0,configurable:!0}),e.prototype.createAdaptee=function(){var t=this;this._onAssetCompleteDelegate=function(e){return t._onAssetComplete(e)};var e=new $a;return e.addEventListener(l.ASSET_COMPLETE,this._onAssetCompleteDelegate),e},e.prototype._onAssetComplete=function(e){var i=e.asset;i.adapter.loaderInfo=this._contentLoaderInfo,i.isAsset(sh)?this._contentLoaderInfo.applicationDomain.addDefinition(i.name,i):i.isAsset(mh)||i.isAsset(hn)?(this._contentLoaderInfo.applicationDomain.addDefinition(i.name,i),this._isImage&&(this._content=new ER(i.adapter),this._adaptee.addChild(this._content.adaptee))):i.isAsset(x)?this._contentLoaderInfo.applicationDomain.addAudioDefinition(i.name,i):i.isAsset(Cc)?this._contentLoaderInfo.applicationDomain.addFontDefinition(i.name,i):i.isAsset(ka)?this._contentLoaderInfo.applicationDomain.addDefinition(i.name,i):i.isAsset(il)?(this._contentLoaderInfo.applicationDomain.addDefinition(i.name,i),("Scene 1"==i.name||i.isAVMScene)&&(this._content=i.adapter.clone(),this._content.loaderInfo=this._contentLoaderInfo,this._content.adaptee.reset(),el.invalidAS3Constructors=!0,t.prototype.addChild.call(this,this._content))):i.isAsset(Sa)||console.log("loaded unhandled asset-type")},e.prototype.addChild=function(t){return this.sec.throwError("IllegalOperationError",db.InvalidLoaderMethodError),null},e.prototype.addChildAt=function(t,e){return this.sec.throwError("IllegalOperationError",db.InvalidLoaderMethodError),null},e.prototype.removeChild=function(t){return this.sec.throwError("IllegalOperationError",db.InvalidLoaderMethodError),null},e.prototype.removeChildAt=function(t){return this.sec.throwError("IllegalOperationError",db.InvalidLoaderMethodError),null},e.prototype.setChildIndex=function(t,e){this.sec.throwError("IllegalOperationError",db.InvalidLoaderMethodError)},e.prototype.close=function(){this.adaptee.close()},e.prototype.load=function(t,i){var n=this;void 0===i&&(i=null),e.loaderQueue.push((function(){n._delayedLoad(t,i)}))},e.prototype._delayedLoad=function(t,i){var n=this;void 0===i&&(i=null);var r=t.url||"",o=r.replace(/\?.*$/,""),s=af(r,e.redirectRules);if(s){if(s.supressLoad)return void console.log("[LOADER] Load surpressed ",s.url);console.log("[LOADER] Override loading url:",s.url),t.adaptee.url=s.url}else console.log("[LOADER] start loading the url:",o);var a=o.substr(-3).toLowerCase();this._isImage="jpg"==a||"png"==a,"gif"!==a?(this._loaderContext=i||new MR(!1,BR.currentDomain),this._contentLoaderInfo._setApplicationDomain(this._loaderContext.applicationDomain),this._adaptee.load(t.adaptee,null,null,this._isImage?new In(this._factory):new nf(this._factory)),s&&s.supressErrors&&this.adaptee.addEventListener(Q.LOAD_ERROR,(function(t){console.log("[LOADER] Error supressed by redirect rule as empty complete events!",t),n._contentLoaderInfo._onLoaderCompleteDelegate(new V(V.LOADER_COMPLETE,t.urlLoader.url,null))}))):console.warn("[Loader] Unsupported file type:",a,o)},e.prototype.loadBytes=function(t,i){var n=this;void 0===i&&(i=null),t?e.loaderQueue.push((function(){n._loaderContext=i||new MR(!1,BR.currentDomain),n._contentLoaderInfo._setApplicationDomain(n._loaderContext.applicationDomain),n._adaptee.loadData(t.bytes,null,null,new nf(n._factory))})):console.warn("[Loader] Bytes byffer is `undefined`")},e.prototype.unload=function(){this._unload(!1,!1)},e.prototype.unloadAndStop=function(t){this._unload(!0,!!t)},e.prototype._unload=function(t,e){console.log("80pro todo: loader._unload")},e.redirectRules=[],e.loaderQueue=[],e}(CR),LR=function(t){function e(e,i,n,r){var o=t.call(this,e,i,n)||this;return o._text=r,o}return i(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this.bubbles,this.cancelable,this.text)},e.prototype.toString=function(){return this.formatToString("TextEvent","type","bubbles","cancelable","text")},e.prototype.copyNativeData=function(t){},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.LINK="link",e.TEXT_INPUT="textInput",e}(pR),RR=function(t){function e(e,i,n,r,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===r&&(r=""),void 0===o&&(o=0);var s=t.call(this,e,i,n,r)||this;return s.setID(o),s}return i(e,t),e.prototype.setID=function(t){this._id=t},Object.defineProperty(e.prototype,"errorID",{get:function(){return this._id},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this.bubbles,this.cancelable,this.text,this.errorID)},e.prototype.toString=function(){return this.formatToString("ErrorEvent","type","bubbles","cancelable","text","errorID")},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.ERROR="error",e}(LR),NR=function(t){function e(e,i,n,r,o){return void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===r&&(r=""),void 0===o&&(o=0),t.call(this,e,i,n,r,o)||this}return i(e,t),e.prototype.clone=function(){return new e(this.type,this.bubbles,this.cancelable,this.text,this.errorID)},e.prototype.toString=function(){return this.formatToString("IOErrorEvent","type","bubbles","cancelable","text","errorID")},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.IO_ERROR="ioError",e.NETWORK_ERROR="networkError",e.DISK_ERROR="diskError",e.VERIFY_ERROR="verifyError",e}(RR),FR=function(t){function e(e,i,n,r,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=0);var s=t.call(this,e,i,n)||this;return s._bytesLoaded=r,s._bytesTotal=o,s}return i(e,t),Object.defineProperty(e.prototype,"bytesLoaded",{get:function(){return this._bytesLoaded},set:function(t){this._bytesLoaded=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesTotal",{get:function(){return this._bytesTotal},set:function(t){this._bytesTotal=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._type,this._bubbles,this._cancelable,this._bytesLoaded,this._bytesTotal)},e.prototype.toString=function(){return this.formatToString("ProgressEvent","bubbles","cancelable","eventPhase","bytesLoaded","bytesTotal")},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.PROGRESS="progress",e.SOCKET_DATA="socketData",e}(pR),kR=function(t){function e(e,i){var n=t.call(this)||this;return n._bytesLoaded=0,n._bytesTotal=0,n.eventMappingExtern[pR.COMPLETE]="LoaderInfo:Event.COMPLETE",n.eventMappingExtern[FR.PROGRESS]="LoaderInfo:ProgressEvent.PROGRESS",n.eventMappingExtern[NR.IO_ERROR]="LoaderInfo:IOErrorEvent.IO_ERROR",n.eventMappingDummys[pR.UNLOAD]="LoaderInfo:Event.UNLOAD",n.eventMappingDummys[pR.OPEN]="LoaderInfo:Event.OPEN",n.eventMappingDummys[pR.INIT]="LoaderInfo:Event.INIT",n._onLoaderStartDelegate=function(t){return n._onLoaderStart(t)},n._onLoadProgressDelegate=function(t){return n._onLoadProgress(t)},n._onLoaderCompleteDelegate=function(t){return n._onLoaderComplete(t)},n._onLoaderErrorDelegate=n._onLoadeError.bind(n),n._loader=e,n._container=i,n._container.addEventListener(V.LOADER_START,n._onLoaderStartDelegate),n._container.addEventListener(Q.LOAD_PROGRESS,n._onLoadProgressDelegate),n._container.addEventListener(V.LOADER_COMPLETE,n._onLoaderCompleteDelegate),n._container.addEventListener(Q.LOAD_ERROR,n._onLoaderErrorDelegate),n}return i(e,t),Object.defineProperty(e.prototype,"actionScriptVersion",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.getSymbolById=function(t){},e.prototype._onLoadeError=function(t){var e=new this.sec.flash.events.IOErrorEvent(NR.IO_ERROR);e.currentTarget=this,this.dispatchEvent(e)},e.prototype._onLoaderStart=function(t){this._bytesLoaded=0,this._bytesTotal=0,this._url=t.url},e.prototype._onLoadProgress=function(t){this._bytesLoaded=t.urlLoader.bytesLoaded,this._bytesTotal=t.urlLoader.bytesTotal;var e=new this.sec.flash.events.ProgressEvent(FR.PROGRESS,null,null,t.urlLoader.bytesLoaded,t.urlLoader.bytesTotal);e.currentTarget=this,this.dispatchEvent(e)},e.prototype._onLoaderComplete=function(t){t.assets&&t.assets.length?(this._bytesLoaded=t.assets.length,this._bytesTotal=t.assets.length):this._bytesTotal=this._bytesLoaded=this._bytesTotal||1,this._url=t.url;var e=new this.sec.flash.events.Event(pR.COMPLETE);e.currentTarget=this,this.dispatchEvent(e)},Object.defineProperty(e.prototype,"applicationDomain",{get:function(){return this._applicationDomain},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytes",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesLoaded",{get:function(){return this._bytesLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesTotal",{get:function(){return this._bytesTotal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childAllowsParent",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childSandboxBridge",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._loader.content},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentType",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{get:function(){return of.instance().frameRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){var t=ce.getInstance(this._loader.stage.view).getBoundsPicker(this._container.partition).getBoxBounds(this._container);return null==t?0:t.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isURLInaccessible",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loader",{get:function(){return this._loader instanceof OR?this._loader:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loaderURL",{get:function(){return e.DefaultLocation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parameters",{get:function(){return this.sec.createArrayUnsafe([])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentAllowsChild",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentSandboxBridge",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sameDomain",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedEvents",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"swfVersion",{get:function(){return this._swfVersion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uncaughtErrorEvents",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return null!=e.DefaultLocation&&void 0!==e.DefaultLocation?e.DefaultLocation:this._url},set:function(t){this._url=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){var t=ce.getInstance(this._loader.stage.view).getBoundsPicker(this._container.partition).getBoxBounds(this._container);return null==t?0:t.width},enumerable:!0,configurable:!0}),e.getLoaderInfoByDefinition=function(t){return null},e.prototype._setApplicationDomain=function(t){this._applicationDomain=t||new this.sec.flash.system.ApplicationDomain(BR.currentDomain)},e.DefaultLocation=null,e}(gR),VR=function(t){function e(){var e=t.call(this)||this;return e._isAVMStage=!0,e._stage3Ds=[],e._resizeCallbackDelegate=function(t){return e.resizeCallback(t)},window.addEventListener("resize",e._resizeCallbackDelegate),e.eventMapping[pR.RESIZE]={adaptedType:"",addListener:e.initResizeListener,removeListener:e.removeResizeListener,callback:e._resizeCallbackDelegate},e._mouseLeaveCallbackDelegate=function(t){return e.mouseLeaveCallback(t)},e.eventMapping[pR.MOUSE_LEAVE]={adaptedType:"",addListener:e.initMouseLeaveListener,removeListener:e.removeMouseLeaveListener,callback:e._mouseLeaveCallbackDelegate},e.sec.flash.display.DisplayObject.axClass._activeStage=e,e._stage=e,e._resizeCallbackDelegate(null),e}return i(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return of.instance().view},enumerable:!0,configurable:!0}),e.prototype.initResizeListener=function(t,e){},e.prototype.removeResizeListener=function(t,e){},e.prototype.resizeCallback=function(t){this.dispatchEvent(new this.sec.flash.events.Event(pR.RESIZE))},e.prototype.show=function(){},e.prototype.initMouseLeaveListener=function(t,e){window.addEventListener("mouseleave",e)},e.prototype.removeMouseLeaveListener=function(t,e){window.removeEventListener("mouseleave",e)},e.prototype.initMouseListener=function(t,e,i){if(!this._mouseListnersCallbacksByType[t])return this.adaptee.addEventListener(t,e),of.instance().view.stage.addEventListener(t,e),void(this._mouseListnersCallbacksByType[t]=[i]);this._mouseListnersCallbacksByType[t].push(i)},e.prototype.removeMouseListener=function(t,e,i){if(this._mouseListnersCallbacksByType[t]){var n=this._mouseListnersCallbacksByType[t].indexOf(i);if(-1!=n){if(1==this._mouseListnersCallbacksByType[t].length)return delete this._mouseListnersCallbacksByType[t],this.adaptee.removeEventListener(t,e),void of.instance().view.stage.removeEventListener(t,e);this._mouseListnersCallbacksByType[t].splice(n,1)}}},e.prototype.mouseLeaveCallback=function(t){this.dispatchEvent(new pR(pR.MOUSE_LEAVE))},e.prototype.enterFrame=function(){OR.executeQueue(),0!=this._stage.adaptee.numChildren&&(this._stage.adaptee._children[0].firstFrameOnSWFStart?this._stage.adaptee._children[0].firstFrameOnSWFStart=!1:(this._stage.dispatchStaticBroadCastEvent(pR.ENTER_FRAME),el.execute_as3_constructors_enterFrame(this._stage.adaptee),el.execute_queue()),this._stage.adaptee.advanceFrame(),dL.updateOrphans(),el.execute_as3_constructors_enterFrame(this._stage.adaptee),this._stage.dispatchStaticBroadCastEvent(pR.FRAME_CONSTRUCTED),el.execute_queue(),this._stage.dispatchStaticBroadCastEvent(pR.EXIT_FRAME),el.execute_queue(),this._sendEventRender&&(this._stage.dispatchStaticBroadCastEvent(pR.RENDER),el.execute_queue(),this._sendEventRender=!1))},Object.defineProperty(e.prototype,"mouseX",{get:function(){return 0|of.instance().getLocalMouseX(this.adaptee)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseY",{get:function(){return 0|of.instance().getLocalMouseY(this.adaptee)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accessibilityImplementation",{set:function(t){console.log("textSnapshot not implemented yet in flash/Stage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this.adaptee.align},set:function(t){this.adaptee.align=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowsFullScreen",{get:function(){return console.log("allowsFullScreen not implemented yet in flash/Stage"),!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowsFullScreenInteractive",{get:function(){return console.log("allowsFullScreen not implemented yet in flash/Stage"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"browserZoomFactor",{get:function(){return console.log("browserZoomFactor not implemented yet in flash/Stage"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this.adaptee.color},set:function(t){this.adaptee.color=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorCorrection",{get:function(){return console.log("colorCorrection not implemented yet in flash/Stage"),""},set:function(t){console.log("colorCorrection not implemented yet in flash/Stage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorCorrectionSupport",{get:function(){return console.log("colorCorrectionSupport not implemented yet in flash/Stage"),""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentsScaleFactor",{get:function(){return console.log("contentsScaleFactor not implemented yet in flash/Stage"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayContextInfo",{get:function(){return console.log("displayContextInfo not implemented yet in flash/Stage"),""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayState",{get:function(){return console.log("displayState not implemented yet in flash/Stage"),""},set:function(t){console.log("displayState not implemented yet in flash/Stage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focus",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{get:function(){return this.adaptee.frameRate},set:function(t){this.adaptee.frameRate=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullScreenHeight",{get:function(){return console.log("fullScreenHeight not implemented yet in flash/Stage"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullScreenSourceRect",{get:function(){return console.log("fullScreenSourceRect not implemented yet in flash/Stage"),null},set:function(t){console.log("fullScreenSourceRect not implemented yet in flash/Stage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullScreenWidth",{get:function(){return console.log("fullScreenWidth not implemented yet in flash/Stage"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseLock",{get:function(){return console.log("mouseLock not implemented yet in flash/Stage"),!1},set:function(t){console.log("mouseLock not implemented yet in flash/Stage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return""},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return of.instance().scaleMode},set:function(t){of.instance().scaleMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDefaultContextMenu",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"softKeyboardRect",{get:function(){return console.log("softKeyboardRect not implemented yet in flash/Stage"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stage3Ds",{get:function(){return console.log("stage3Ds not implemented yet in flash/Stage"),this._stage3Ds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stage",{get:function(){return this},set:function(t){this._stage=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageFocusRect",{get:function(){return console.log("stageFocusRect not implemented yet in flash/Stage"),!1},set:function(t){console.log("stageFocusRect not implemented yet in flash/Stage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageHeight",{get:function(){return of.instance().stageHeight},set:function(t){of.instance().stageHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageVideos",{get:function(){return console.log("stageVideos not implemented yet in flash/Stage"),[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageWidth",{get:function(){return of.instance().stageWidth},set:function(t){of.instance().stageWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabChildren",{get:function(){return console.log("tabChildren not implemented yet in flash/Stage"),!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textSnapshot",{get:function(){return console.log("textSnapshot not implemented yet in flash/Stage"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wmodeGPU",{get:function(){return console.log("wmodeGPU not implemented yet in flash/Stage"),!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accessibilityProperties",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheAsBitmap",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextMenu",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focusRect",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseChildren",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseEnabled",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numChildren",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opaqueBackground",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationX",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationY",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationZ",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale9Grid",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleZ",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollRect",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabEnabled",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabIndex",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transform",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.adaptee.x},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.adaptee.y},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{set:function(t){},enumerable:!0,configurable:!0}),e.prototype.addChild=function(e){e.dispatch_ADDED_TO_STAGE();var i=t.prototype.addChild.call(this,e);return e.adaptee.hasDispatchedAddedToStage=!0,e.dispatchStaticEvent(pR.ADDED_TO_STAGE,e),i},e.prototype.addChildAt=function(e,i){e.dispatch_ADDED_TO_STAGE();var n=t.prototype.addChildAt.call(this,e,i);return e.adaptee.hasDispatchedAddedToStage=!0,e.dispatchStaticEvent(pR.ADDED_TO_STAGE,e),n},e.prototype.removeChildAt=function(e){return t.prototype.removeChildAt.call(this,e)},e.prototype.swapChildrenAt=function(e,i){return t.prototype.swapChildrenAt.call(this,e,i)},e.prototype.setChildIndex=function(t,e){return null},e.prototype.addEventListener=function(e,i,n,r,o){void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=!1),t.prototype.addEventListener.call(this,e,i,n=!1,r,o)},e.prototype.hasEventListener=function(e){return t.prototype.hasEventListener.call(this,e)},e.prototype.willTrigger=function(){return t.prototype.willTrigger.call(this)},e.prototype.dispatchEvent=function(e){return t.prototype.dispatchEvent.call(this,e)},Object.defineProperty(e.prototype,"loaderInfo",{get:function(){return this.getChildAt(0).loaderInfo},enumerable:!0,configurable:!0}),e.prototype.invalidate=function(){this._sendEventRender=!0},e.prototype.isFocusInaccessible=function(){return console.log("isFocusInaccessible not implemented yet in flash/Stage"),!1},e}(CR),UR=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._ignoreDecodingErrors=!1,e&&i.decode(e),i}return i(e,t),e.prototype.decode=function(t){for(var e=(t=Yv(t)).split("&"),i=0;i<e.length;i++){var n=e[i],r=n.indexOf("=");r<0&&(this._ignoreDecodingErrors?r=n.length:this.sec.throwError("Error",db.DecodeParamError));var o=unescape(n.substring(0,r).split("+").join(" ")),s=unescape(n.substring(r+1).split("+").join(" ")),a=this.axGetPublicProperty(o);void 0===a?this.axSetPublicProperty(o,s):Array.isArray(a)?a.push(s):this.axSetPublicProperty(o,[a,s])}},e.prototype.toString=function(){for(var t=[],e=this.axGetEnumerableKeys(),i=0;i<e.length;i++){var n=e[i].split(" ").join("+"),r=this.axGetPublicProperty(n);if(n=escape(n).split(" ").join("+"),Array.isArray(r))for(var o=0;o<r.length;o++)t.push(n+"="+escape(r[o]));else t.push(n+"="+escape(r))}return t.join("&")},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),jR=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._adaptee=new pt(e),i}return i(e,t),Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},set:function(t){this._adaptee=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._adaptee.url},set:function(t){t=Yv(t),this._adaptee.url=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){var t=this._adaptee.data,e=this._adaptee.data;if(t instanceof ot)for(var i in e=new UR,this._adaptee.data.variables)e["$Bg"+i]=this._adaptee.data.variables[i];else"object"==typeof t&&(e=pD(this.sec,t,!0));return e},set:function(t){var e;if(this.sec.flash.net.URLVariables.axIsType(t))for(var i in e=new ot,t)0==i.indexOf("$Bg")&&"function"!=typeof t[i]&&(e.variables[i.replace("$Bg","")]=t[i]);else e=dD(this.sec,t,!0);this._adaptee.data=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return this._adaptee.method},set:function(t){this._adaptee.method=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentType",{get:function(){return console.log("TODO: URLRequest.contentType"),""},set:function(t){console.log("TODO: URLRequest.contentType")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestHeaders",{get:function(){return console.log("TODO: URLRequest.requestHeaders"),null},set:function(t){console.log("TODO: URLRequest.requestHeaders")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"digest",{get:function(){return console.log("TODO: URLRequest.digest"),null},set:function(t){console.log("TODO: URLRequest.digest")},enumerable:!0,configurable:!0}),e}(bb),GR=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e.prototype,"formats",{get:function(){return console.log("formats not implemented yet in flash/Clipboard"),[]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"generalClipboard",{get:function(){return console.log("generalClipboard not implemented yet in flash/Clipboard"),null},enumerable:!0,configurable:!0}),e.prototype.clear=function(){console.log("clear not implemented yet in flash/Clipboard")},e.prototype.clearData=function(t){console.log("clearData not implemented yet in flash/Clipboard")},e.prototype.getData=function(t,e){return console.log("getData not implemented yet in flash/Clipboard"),null},e.prototype.hasFormat=function(t){return console.log("hasFormat not implemented yet in flash/Clipboard"),!1},e.prototype.setData=function(t,e,i){return console.log("setData not implemented yet in flash/Clipboard"),!1},e.prototype.setDataHandler=function(t,e,i){return console.log("setDataHandler not implemented yet in flash/Clipboard"),!1},e}(bb),QR=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.BITMAP_FORMAT="air:bitmap",e.FILE_LIST_FORMAT="air:file list",e.FILE_PROMISE_LIST_FORMAT="air:file promise list",e.HTML_FORMAT="air:html",e.RICH_TEXT_FORMAT="air:rtf",e.TEXT_FORMAT="air:text",e.URL_FORMAT="air:url",e}(bb),zR=function(t){function e(e,i){var n=t.call(this)||this;return n._name=So(e),n._frame=0|i,n}return i(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._name,this._frame)},e.classInitializer=null,e}(gR),HR=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._adaptee=e||new Sa,i._adaptee.adapter=i,i}return i(e,t),e.prototype.dispose=function(){},Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},enumerable:!0,configurable:!0}),e.FromData=function(t,e){return new this.sec.flash.display.Graphics},e.prototype.clear=function(){this.adaptee.clear()},e.prototype.beginFill=function(t,e){void 0===e&&(e=1),this.adaptee.beginFill(t,e)},e.prototype.beginGradientFill=function(t,e,i,n,r,o,s,a){void 0===r&&(r=null),void 0===o&&(o="pad"),void 0===s&&(s="rgb"),void 0===a&&(a=0),this.adaptee.beginGradientFill(t,e.value,i.value,n.value,null==r?void 0:r.adaptee,o,s,a)},e.prototype.beginBitmapFill=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=!0),void 0===n&&(n=!1),this.adaptee.beginBitmapFill(t.adaptee,null==e?void 0:e.adaptee,i,n)},e.prototype.endFill=function(){this.adaptee.endFill()},e.prototype.lineStyle=function(t,e,i,n,r,o,s,a){void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===r&&(r="normal"),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=3),this.adaptee.lineStyle(t,e,i,n,r,o,s,a)},e.prototype.lineGradientStyle=function(t,e,i,n,r,o,s,a){void 0===r&&(r=null),void 0===o&&(o="pad"),void 0===s&&(s="rgb"),void 0===a&&(a=0),this.adaptee.lineGradientStyle(t,e.value,i.value,n.value,null==r?void 0:r.adaptee,o,s,a)},e.prototype.lineBitmapStyle=function(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=!0),void 0===n&&(n=!1),this.adaptee.lineBitmapStyle(t.adaptee,null==e?void 0:e.adaptee,i,n)},e.prototype.drawRect=function(t,e,i,n){this.adaptee.drawRect(t,e,i,n)},e.prototype.drawRoundRect=function(t,e,i,n,r,o){this.adaptee.drawRoundRect(t,e,i,n,r,o)},e.prototype.drawRoundRectComplex=function(t,e,i,n,r,o,s,a){this.adaptee.drawRoundRectComplex(t,e,i,n,r,o,s,a)},e.prototype.drawCircle=function(t,e,i){this.adaptee.drawCircle(t,e,i)},e.prototype.drawEllipse=function(t,e,i,n){this.adaptee.drawEllipse(t,e,i,n)},e.prototype.moveTo=function(t,e){this.adaptee.moveTo(t,e)},e.prototype.lineTo=function(t,e){this.adaptee.lineTo(t,e)},e.prototype.curveTo=function(t,e,i,n){this.adaptee.curveTo(t,e,i,n)},e.prototype.cubicCurveTo=function(t,e,i,n,r,o){this.adaptee.cubicCurveTo(t,e,i,n,r,o)},e.prototype.copyFrom=function(t){this.adaptee.copyFrom(t.adaptee)},e.prototype.drawPath=function(t,e,i){},e.prototype.drawTriangles=function(t,e,i,n){console.warn("Graphics.drawTriangles")},e.prototype.drawGraphicsData=function(t){console.warn("Graphics.drawGraphicsData")},e.prototype.readGraphicsData=function(t){return console.warn("Graphics.readGraphicsData"),[]},e.classInitializer=null,e}(bb),XR=function(t){function e(){var e=t.call(this)||this;return e._enabled=!0,e}return i(e,t),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){t=!!t,this._enabled=t},enumerable:!0,configurable:!0}),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(gR),qR=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o._name=Yv(e),o._labels=i,o.offset=n,o._numFrames=0|r,o}return i(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labels",{get:function(){return this._labels},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFrames",{get:function(){return this._numFrames},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=this._labels.value.map((function(t){return t.clone()}));return new e(this._name,this.sec.createArrayUnsafe(t),this.offset,this._numFrames)},e.prototype.getLabelByName=function(t,e){e&&(t=t.toLowerCase());for(var i=this._labels.value,n=0;n<i.length;n++){var r=i[n];if(e?r.name.toLowerCase()===t:r.name===t)return r}return null},e.prototype.getLabelByFrame=function(t){for(var e=this._labels.value,i=0;i<e.length;i++){var n=e[i];if(n.frame===t)return n}return null},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),YR=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o._adaptee.addButtonListeners(),o}return i(e,t),e.prototype.addTimelineChildAtDepth=function(t,e){t.reset();for(var i=this.adaptee._children,n=i.length-1,r=n+1,o=0,s=n;s>=0;s--){var a=i[s];if(-1==a._avmDepthID&&o++,a._avmDepthID>-1){if(a._avmDepthID<e){r=s+1+o;break}o=0,r=s}}return t._avmDepthID=e,t.just_added_to_timeline=!0,this.adaptee._sessionID_childs[t._sessionID]=t,this.adaptee.addChildAt(t,r)},e.prototype.removeTimelineChildAt=function(t){var e=this.adaptee._sessionID_childs[t];e&&(delete this.adaptee._sessionID_childs[t],this.adaptee.removeChild(e))},e.prototype.queueFrameScripts=function(t,e,i){i?el.add_script_to_queue(this.adaptee,e):el.add_script_to_queue_pass2(this.adaptee,e)},e.prototype.constructFrame=function(t,e,i,n,r,o,s){for(var a,l,u=this.adaptee,c=u._children.length,h=[],p={},d=0;d<c;d++){var f=u._children[d];(n||-1==f._sessionID)&&(h[h.length]={sessionID:f._sessionID,as3DepthID:f._avmDepthID,addedOnTargetFrame:!1,child:f}),-1!=f._sessionID&&(p[f._sessionID]=f)}this.$Bg__setPropDict&&this.clearPropsDic(),t._update_indices.length=0,t._update_frames.length=0;var _,m,g=0;for(l=e;l<=i;l++){var y=t.frame_command_indices[l],A=t.frame_recipe[l];if(2&A){m=(_=t.command_index_stream[y])+t.command_length_stream[y++];var v={};for(a=_;a<m;a++)v[t.remove_child_stream[a]]=!0;var b=[];c=h.length;for(var x=0;x<c;x++)v[h[x].sessionID]||(b[b.length]=h[x]);h=b}if(4&A)for(m=(_=t.command_index_stream[y])+t.command_length_stream[y++],a=_;a<m;a++){for(var C=h.length-1,w=t.add_child_stream[3*a+1],I=C+1,E=0,S=C;S>=0;S--){var D=h[S];if(-1==D.as3DepthID&&E++,D.as3DepthID>-1){if(D.as3DepthID==w&&D.sessionID==t.add_child_stream[3*S]){I=-1;break}if(D.as3DepthID<w){I=S+1+E;break}E=0,I=S}}I>=h.length?h[h.length]={sessionID:t.add_child_stream[3*a],addedOnTargetFrame:l==i,symbolID:t.add_child_stream[3*a+2],as3DepthID:t.add_child_stream[3*a+1]}:I>-1&&h.splice(I,0,{sessionID:t.add_child_stream[3*a],addedOnTargetFrame:l==i,symbolID:t.add_child_stream[3*a+2],as3DepthID:t.add_child_stream[3*a+1]})}8&A&&(t._update_frames[g]=t.keyframe_firstframes[l],t._update_indices[g++]=y++),16&A&&l==i&&t.start_sounds(u,y)}var T,P=[],B=[],M=[];u._sessionID_childs={},c=P.length=h.length;for(var O=0;O<c;O++)if(-1==(T=h[O]).sessionID&&T.child)P[O]=T.child.adaptee;else if(p[T.sessionID]){var L=p[T.sessionID];u._sessionID_childs[T.sessionID]=L,P[O]=L,n||(P[O]._adapter?(P[O].adapter.isColorTransformByScript()||P[O].transform.clearColorTransform(),P[O].adapter.isBlockedByScript()||P[O].noTimelineUpdate||(P[O].transform.clearMatrix3D(),P[O].masks=null,P[O].maskMode=!1),P[O].adapter.isVisibilityByScript()||(P[O].visible=!0)):(P[O].transform.clearColorTransform(),P[O].transform.clearMatrix3D(),P[O].visible=!0,P[O].masks=null,P[O].maskMode=!1))}else{var R=t.getChildInstance(T.symbolID,T.sessionID);this.adaptee.isSlice9ScaledMC&&"[asset Sprite]"==R.assetType&&(R.isSlice9ScaledSprite=!0),R._sessionID=T.sessionID,R._avmDepthID=T.as3DepthID,u._sessionID_childs[T.sessionID]=R,P[O]=R,T.addedOnTargetFrame?M[M.length]=R:B[B.length]=R}c=u._children.length;for(var N=0;N<c;N++)P.indexOf(u._children[N])<0&&u._children[N]._setParent(null);u._children=P,u.preventScript=!0,this.finalizeChildren(B),u.preventScript=!1,s&&this.queueFrameScripts(t,r,!o),this.finalizeChildren(M)},e.prototype.finalizeChildren=function(t){for(var e=t.length,i=0;i<e;i++){var n=t[i];n.adapter!=n&&n.adapter.deleteOwnProperties&&n.adapter.deleteOwnProperties(),n.just_added_to_timeline=!0,n._setParent(this.adaptee),n.reset()}},e.prototype.initAdapter=function(){},e.prototype.registerScriptObject=function(t){},e.prototype.unregisterScriptObject=function(t){},Object.defineProperty(e.prototype,"downState",{get:function(){return console.log("downState not implemented yet in flash/SimpleButton"),null},set:function(t){console.log("downState not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return console.log("enabled not implemented yet in flash/SimpleButton"),!1},set:function(t){console.log("enabled not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitTestState",{get:function(){return this.adaptee.pickObject.adapter},set:function(t){this.adaptee.pickObject=t.adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overState",{get:function(){return console.log("overState not implemented yet in flash/SimpleButton"),null},set:function(t){console.log("overState not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"soundTransform",{get:function(){return console.log("soundTransform not implemented yet in flash/SimpleButton"),null},set:function(t){console.log("soundTransform not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trackAsMenu",{get:function(){return console.log("trackAsMenu not implemented yet in flash/SimpleButton"),!1},set:function(t){console.log("trackAsMenu not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"upState",{get:function(){return console.log("upState not implemented yet in flash/SimpleButton"),null},set:function(t){console.log("upState not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useHandCursor",{get:function(){return console.log("useHandCursor not implemented yet in flash/SimpleButton"),!1},set:function(t){console.log("useHandCursor not implemented yet in flash/SimpleButton")},enumerable:!0,configurable:!0}),e}(IR),KR=function(t){function e(e,i,n,r,o,s,a,l){void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===l&&(l=0);var u=t.call(this)||this;if(e instanceof I)u._adaptee=e;else{var c=+e,h=+i,p=+n,d=+r;u._adaptee=new I(c==c?c:1,h==h?h:1,p==p?p:1,d==d?d:1,+o||0,+s||0,+a||0,+l||0)}return u}return i(e,t),e.classInitializer=function(){this.FROZEN_IDENTITY_COLOR_TRANSFORM=Object.freeze(this.axConstruct([])),this.TEMP_COLOR_TRANSFORM=this.axConstruct([])},Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphaMultiplier",{get:function(){return this._adaptee._rawData[3]},set:function(t){this._adaptee._rawData[3]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphaOffset",{get:function(){return this._adaptee._rawData[7]},set:function(t){this._adaptee._rawData[7]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blueMultiplier",{get:function(){return this._adaptee._rawData[2]},set:function(t){this._adaptee._rawData[2]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blueOffset",{get:function(){return this._adaptee._rawData[6]},set:function(t){this._adaptee._rawData[6]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"greenMultiplier",{get:function(){return this._adaptee._rawData[1]},set:function(t){this._adaptee._rawData[1]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"greenOffset",{get:function(){return this._adaptee._rawData[5]},set:function(t){this._adaptee._rawData[5]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redMultiplier",{get:function(){return this._adaptee._rawData[0]},set:function(t){this._adaptee._rawData[0]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redOffset",{get:function(){return this._adaptee._rawData[4]},set:function(t){this._adaptee._rawData[4]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._adaptee.color},set:function(t){this._adaptee.color=+t},enumerable:!0,configurable:!0}),e.prototype.concat=function(t){this._adaptee.concat(t.adaptee)},e.prototype.preMultiply=function(t){this._adaptee._rawData[4]+=t.adaptee._rawData[4]*this._adaptee._rawData[0],this._adaptee._rawData[5]+=t.adaptee._rawData[5]*this._adaptee._rawData[1],this._adaptee._rawData[6]+=t.adaptee._rawData[6]*this._adaptee._rawData[2],this._adaptee._rawData[7]+=t.adaptee._rawData[7]*this._adaptee._rawData[3],this._adaptee._rawData[0]*=t.adaptee._rawData[0],this._adaptee._rawData[1]*=t.adaptee._rawData[1],this._adaptee._rawData[2]*=t.adaptee._rawData[2],this._adaptee._rawData[3]*=t.adaptee._rawData[3]},e.prototype.copyFrom=function(t){this._adaptee.copyFrom(t.adaptee)},e.prototype.setTo=function(t,e,i,n,r,o,s,a){var l=+t,u=+e,c=+i,h=+n;this._adaptee._rawData[0]=l==l?l:1,this._adaptee._rawData[1]=u==u?u:1,this._adaptee._rawData[2]=c==c?c:1,this._adaptee._rawData[3]=h==h?h:1,this._adaptee._rawData[4]=+r||0,this._adaptee._rawData[5]=+o||0,this._adaptee._rawData[6]=+s||0,this._adaptee._rawData[7]=+a||0},e.prototype.clone=function(){return new this.sec.flash.geom.ColorTransform(this._adaptee._rawData[0],this._adaptee._rawData[1],this._adaptee._rawData[2],this._adaptee._rawData[3],this._adaptee._rawData[4],this._adaptee._rawData[5],this._adaptee._rawData[6],this._adaptee._rawData[7])},e.prototype.convertToFixedPoint=function(){return this._adaptee._rawData[0]=Lh(this._adaptee._rawData[0]),this._adaptee._rawData[1]=Lh(this._adaptee._rawData[1]),this._adaptee._rawData[2]=Lh(this._adaptee._rawData[2]),this._adaptee._rawData[3]=Lh(this._adaptee._rawData[3]),this._adaptee._rawData[4]=Rh(this._adaptee._rawData[4]),this._adaptee._rawData[5]=Rh(this._adaptee._rawData[5]),this._adaptee._rawData[6]=Rh(this._adaptee._rawData[6]),this._adaptee._rawData[7]=Rh(this._adaptee._rawData[7]),this},e.prototype.dispose=function(){throw new s},e.prototype.equals=function(t){return this===t||this._adaptee._rawData[0]===t._adaptee._rawData[0]&&this._adaptee._rawData[1]===t._adaptee._rawData[1]&&this._adaptee._rawData[2]===t._adaptee._rawData[2]&&this._adaptee._rawData[3]===t._adaptee._rawData[3]&&this._adaptee._rawData[4]===t._adaptee._rawData[4]&&this._adaptee._rawData[5]===t._adaptee._rawData[5]&&this._adaptee._rawData[6]===t._adaptee._rawData[6]&&this._adaptee._rawData[7]===t._adaptee._rawData[7]},e.prototype.toString=function(){return"(redMultiplier="+this._adaptee._rawData[0]+", greenMultiplier="+this._adaptee._rawData[1]+", blueMultiplier="+this._adaptee._rawData[2]+", alphaMultiplier="+this._adaptee._rawData[3]+", redOffset="+this._adaptee._rawData[4]+", greenOffset="+this._adaptee._rawData[5]+", blueOffset="+this._adaptee._rawData[6]+", alphaOffset="+this._adaptee._rawData[7]+")"},e.classSymbols=null,e.instanceSymbols=null,e}(bb),WR=function(t){function e(e,i,n,r,o,s){void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===o&&(o=0),void 0===s&&(s=0);var a=t.call(this)||this;return a._adaptee=e instanceof T?e:new T(+e,+i,+n,+r,+o,+s),a}return i(e,t),e.classInitializer=function(){this.FROZEN_IDENTITY_MATRIX=Object.freeze(this.axConstruct([])),this.TEMP_MATRIX=this.axConstruct([])},Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this._adaptee.rawData[0]},set:function(t){this._adaptee.rawData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this._adaptee.rawData[2]},set:function(t){this._adaptee.rawData[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"c",{get:function(){return this._adaptee.rawData[1]},set:function(t){this._adaptee.rawData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"d",{get:function(){return this._adaptee.rawData[3]},set:function(t){this._adaptee.rawData[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tx",{get:function(){return this._adaptee.rawData[4]},set:function(t){this._adaptee.rawData[4]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ty",{get:function(){return this._adaptee.rawData[5]},set:function(t){this._adaptee.rawData[5]=t},enumerable:!0,configurable:!0}),e.FromUntyped=function(t){return new this.sec.flash.geom.Matrix(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.FromDataBuffer=function(t){return new this.sec.flash.geom.Matrix(t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat())},e.prototype.concat=function(t){this._adaptee.concat(t.adaptee)},e.prototype.invert=function(){this._adaptee.invert()},e.prototype.identity=function(){this._adaptee.identity()},e.prototype.createBox=function(t,e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this._adaptee.createBox(t,e,i,n,r)},e.prototype.createGradientBox=function(t,e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this._adaptee.createGradientBox(t,e,i,n,r)},e.prototype.rotate=function(t){this._adaptee.rotate(t)},e.prototype.translate=function(t,e){this._adaptee.translate(t,e)},e.prototype.scale=function(t,e){this._adaptee.scale(t,e)},e.prototype.deltaTransformPoint=function(t){return new this.sec.flash.geom.Point(this._adaptee.deltaTransformPoint(t.adaptee))},e.prototype.transformPoint=function(t){return new this.sec.flash.geom.Point(this._adaptee.transformPoint(t.adaptee))},e.prototype.copyFrom=function(t){this._adaptee.copyFrom(t.adaptee)},e.prototype.setTo=function(t,e,i,n,r,o){this._adaptee.setTo(t,e,i,n,r,o)},e.prototype.copyRowTo=function(t,e){this._adaptee.copyRowTo(t,e.adaptee)},e.prototype.copyColumnTo=function(t,e){this._adaptee.copyColumnTo(t,e.adaptee)},e.prototype.copyRowFrom=function(t,e){this._adaptee.copyRowFrom(t,e.adaptee)},e.prototype.copyColumnFrom=function(t,e){this._adaptee.copyColumnFrom(t,e.adaptee)},e.prototype.clone=function(){return new this.sec.flash.geom.Matrix(this._adaptee.clone())},e.prototype.toString=function(){var t=this._adaptee.rawData;return"(a="+t[0]+", b="+t[1]+", c="+t[2]+", d="+t[3]+", tx="+t[4]+", ty="+t[5]+")"},e.prototype.writeExternal=function(t){var e=this._adaptee.rawData;t.writeFloat(e[0]),t.writeFloat(e[1]),t.writeFloat(e[2]),t.writeFloat(e[3]),t.writeFloat(e[4]),t.writeFloat(e[5])},e.classSymbols=null,e.instanceSymbols=null,e}(bb),JR=new Uint32Array([0,4,8,12,1,5,9,13,2,6,10,14,3,7,11,15]),ZR=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return e instanceof R?i._adaptee=e:(i._adaptee=new R,e&&e.length>=16?i.copyRawDataFrom(e,0,!1):i.identity()),i}return i(e,t),Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},enumerable:!0,configurable:!0}),e.interpolate=function(t,e,i){},Object.defineProperty(e.prototype,"rawData",{get:function(){var t=new this.sec.Float64Vector;return this.copyRawDataTo(t,0,!1),t},set:function(t){this.copyRawDataFrom(t,0,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return new this.sec.flash.geom.Vector3D(this._adaptee.position)},set:function(t){this.copyColumnFrom(3,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"determinant",{get:function(){return this._adaptee.determinant},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new this.sec.flash.geom.Matrix3D(this._adaptee.clone())},e.prototype.copyToMatrix3D=function(t){this._adaptee.copyTo(t.adaptee)},e.prototype.append=function(t){this._adaptee.append(t.adaptee)},e.prototype.prepend=function(t){this._adaptee.prepend(t.adaptee)},e.prototype.invert=function(){return this._adaptee.invert()},e.prototype.identity=function(){this._adaptee.identity()},e.prototype.decompose=function(t){void 0===t&&(t="eulerAngles"),this._adaptee.decompose(t),t=So(t)},e.prototype.recompose=function(t,e){},e.prototype.appendTranslation=function(t,e,i){this._adaptee.appendTranslation(+t,+e,+i)},e.prototype.appendRotation=function(t,e,i){this._adaptee.appendRotation(+t,e.adaptee)},e.prototype.appendScale=function(t,e,i){this._adaptee.appendScale(+t,+e,+i)},e.prototype.prependTranslation=function(t,e,i){this._adaptee.prependTranslation(+t,+e,+i)},e.prototype.prependRotation=function(t,e,i){this._adaptee.prependRotation(+t,e.adaptee)},e.prototype.prependScale=function(t,e,i){this._adaptee.prependScale(+t,+e,+i)},e.prototype.transformVector=function(t){return new this.sec.flash.geom.Vector3D(this._adaptee.transformVector(t.adaptee))},e.prototype.deltaTransformVector=function(t){return new this.sec.flash.geom.Vector3D(this._adaptee.deltaTransformVector(t.adaptee))},e.prototype.transformVectors=function(t,e){for(var i=this._adaptee._rawData,n=i[0],r=i[4],o=i[8],s=i[12],a=i[1],l=i[5],u=i[9],c=i[13],h=i[2],p=i[6],d=i[10],f=i[14],_=0;_<t.length-2;_+=3){var m=t.axGetNumericProperty(_),g=t.axGetNumericProperty(_+1),y=t.axGetNumericProperty(_+2);e.push(n*m+r*g+o*y+s),e.push(a*m+l*g+u*y+c),e.push(h*m+p*g+d*y+f)}},e.prototype.transpose=function(){this._adaptee.transpose()},e.prototype.pointAt=function(t,e,i){},e.prototype.interpolateTo=function(t,e){},e.prototype.copyFrom=function(t){this._adaptee.copyFrom(t.adaptee)},e.prototype.copyRawDataTo=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),t=t,e>>>=0,i=!!i;var n=this._adaptee._rawData;if(i)for(var r=0,o=0|e;r<16;r++,o++)t.axSetNumericProperty(o,n[JR[r]]);else for(r=0,o=0|e;r<16;r++,o++)t.axSetNumericProperty(o,n[r])},e.prototype.copyRawDataFrom=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),t=t,e>>>=0,i=!!i;var n=this._adaptee._rawData;if(i)for(var r=0,o=0|e;r<16;r++,o++)n[JR[r]]=t.axGetNumericProperty(o)||0;else for(r=0,o=0|e;r<16;r++,o++)n[r]=t.axGetNumericProperty(o)||0},e.prototype.copyRowTo=function(t,e){this._adaptee.copyRowTo(t>>>0,e.adaptee)},e.prototype.copyColumnTo=function(t,e){this._adaptee.copyColumnTo(t>>>0,e.adaptee)},e.prototype.copyRowFrom=function(t,e){this._adaptee.copyRowFrom(t>>>0,e.adaptee)},e.prototype.copyColumnFrom=function(t,e){this._adaptee.copyColumnFrom(t>>>0,e.adaptee)},e.classInitializer=null,e}(bb),$R=function(t){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.call(this)||this;return n._adaptee=e instanceof D?e:new D(+e,+i),n}return i(e,t),Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._adaptee._rawData[0]},set:function(t){this._adaptee._rawData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._adaptee._rawData[1]},set:function(t){this._adaptee._rawData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._adaptee.length},enumerable:!0,configurable:!0}),e.interpolate=function(t,e,i){return new this.sec.flash.geom.Point(D.interpolate(t.adaptee,e.adaptee,i))},e.distance=function(t,e){return D.distance(t.adaptee,e.adaptee)},e.polar=function(t,e){return new this.sec.flash.geom.Point(D.polar(+t,+e))},e.prototype.clone=function(){return new this.sec.flash.geom.Point(this._adaptee.clone())},e.prototype.offset=function(t,e){this._adaptee.offset(t,e)},e.prototype.equals=function(t){return this._adaptee.equals(t.adaptee)},e.prototype.subtract=function(t){return new this.sec.flash.geom.Point(this._adaptee.subtract(t.adaptee))},e.prototype.add=function(t){return new this.sec.flash.geom.Point(this._adaptee.add(t.adaptee))},e.prototype.normalize=function(t){void 0===t&&(t=1),this._adaptee.normalize(+t)},e.prototype.copyFrom=function(t){this._adaptee.copyFrom(t.adaptee)},e.prototype.setTo=function(t,e){this._adaptee.setTo(t,e)},e.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),tN=function(t){function e(e,i,n,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0);var o=t.call(this)||this;return o._adaptee=e instanceof Y?e:new Y(+e,+i,+n,+r),o}return i(e,t),Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._adaptee._rawData[3]},set:function(t){this._adaptee._rawData[3]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._adaptee._rawData[2]},set:function(t){this._adaptee._rawData[2]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._adaptee._rawData[0]},set:function(t){this._adaptee._rawData[0]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._adaptee._rawData[1]},set:function(t){this._adaptee._rawData[1]=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._adaptee.bottom},set:function(t){this._adaptee.bottom=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new this.sec.flash.geom.Point(this._adaptee.bottomRight)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this._adaptee.left},set:function(t){this._adaptee.left=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this._adaptee.right},set:function(t){this._adaptee.right=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return new this.sec.flash.geom.Point(this._adaptee.size)},set:function(t){this.width=t.x,this.height=t.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._adaptee.top},set:function(t){this._adaptee.top=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new this.sec.flash.geom.Point(this._adaptee.topLeft)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),e.FromBounds=function(t){var e=t.xMin,i=t.yMin;return new this.sec.flash.geom.Rectangle(e/20,i/20,(t.xMax-e)/20,(t.yMax-i)/20)},e.prototype.clone=function(){return new this.sec.flash.geom.Rectangle(this._adaptee.clone())},e.prototype.isEmpty=function(){return this._adaptee.isEmpty()},e.prototype.setEmpty=function(){return this._adaptee.setEmpty()},e.prototype.inflate=function(t,e){this._adaptee.inflate(+t,+e)},e.prototype.inflatePoint=function(t){this._adaptee.inflatePoint(t.adaptee)},e.prototype.offset=function(t,e){this._adaptee.offset(+t,+e)},e.prototype.offsetPoint=function(t){this._adaptee.offsetPoint(t.adaptee)},e.prototype.contains=function(t,e){return this._adaptee.contains(+t,+e)},e.prototype.containsPoint=function(t){return this._adaptee.containsPoint(t.adaptee)},e.prototype.containsRect=function(t){return this._adaptee.containsRect(t.adaptee)},e.prototype.intersection=function(t){return new this.sec.flash.geom.Rectangle(this._adaptee.intersection(t.adaptee))},e.prototype.intersects=function(t){return this._adaptee.intersects(t.adaptee)},e.prototype.union=function(t){return new this.sec.flash.geom.Rectangle(this._adaptee.union(t.adaptee))},e.prototype.equals=function(t){return this._adaptee.equals(t.adaptee)},e.prototype.copyFrom=function(t){this._adaptee.copyFrom(t.adaptee)},e.prototype.setTo=function(t,e,i,n){this._adaptee.setTo(+t,+e,+i,+n)},e.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", w="+this.width+", h="+this.height+")"},e.prototype.hashCode=function(){var t=0;return t+=20*this.x|0,t*=37,t+=20*this.y|0,t*=37,t+=20*this.width|0,t*=37,t+=20*this.height|0},e.prototype.writeExternal=function(t){t.writeFloat(this.x),t.writeFloat(this.y),t.writeFloat(this.width),t.writeFloat(this.height)},e.prototype.readExternal=function(t){this.x=t.readFloat(),this.y=t.readFloat(),this.width=t.readFloat(),this.height=t.readFloat()},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),eN=function(t){function e(e){var i=t.call(this)||this;return e||i.sec.throwError("ArgumentError",db.NullPointerError,"displayObject"),i._adaptee=e instanceof N?e:new N,i}return i(e,t),Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrix",{get:function(){return new this.sec.flash.geom.Matrix(this._adaptee.matrix)},set:function(t){this._adaptee.matrix=t.adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorTransform",{get:function(){return new this.sec.flash.geom.ColorTransform(this._adaptee.colorTransform)},set:function(t){this._adaptee.colorTransform=t.adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"concatenatedMatrix",{get:function(){return new this.sec.flash.geom.Matrix(this._adaptee.matrix)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"concatenatedColorTransform",{get:function(){return new this.sec.flash.geom.ColorTransform(this._adaptee.colorTransform)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixelBounds",{get:function(){return new this.sec.flash.geom.Rectangle(this._adaptee.pixelBounds)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrix3D",{get:function(){return new this.sec.flash.geom.Matrix3D(this._adaptee.matrix3D)},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.getRelativeMatrix3D=function(t){return function(t,e,i){null==t&&i.throwError("TypeError",db.NullPointerError,e)}(t,"relativeTo",this.sec),new this.sec.flash.geom.Matrix3D(this._adaptee.matrix3D)},Object.defineProperty(e.prototype,"perspectiveProjection",{get:function(){return new vt},set:function(t){},enumerable:!0,configurable:!0}),e.classInitializer=null,e}(bb),iN=function(t){function e(e,i,n,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0);var o=t.call(this)||this;return o._adaptee=e instanceof P?e:new P(+e,+i,+n,+r),o}return i(e,t),e.classInitializer=function(){this.X_AXIS=Object.freeze(this.Create(1,0,0,0)),this.Y_AXIS=Object.freeze(this.Create(1,0,0,0)),this.Z_AXIS=Object.freeze(this.Create(1,0,0,0))},e.Create=function(t,e,i,n){var r=Object.create(this.tPrototype);return r._adaptee=new P(t,e,i,n),r},Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._adaptee._rawData[0]},set:function(t){this._adaptee._rawData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._adaptee._rawData[1]},set:function(t){this._adaptee._rawData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._adaptee._rawData[2]},set:function(t){this._adaptee._rawData[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this._adaptee._rawData[3]},set:function(t){this._adaptee._rawData[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._adaptee.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lengthSquared",{get:function(){return this._adaptee.lengthSquared},enumerable:!0,configurable:!0}),e.angleBetween=function(t,e){return P.angleBetween(t.adaptee,e.adaptee)},e.distance=function(t,e){return P.distance(t.adaptee,e.adaptee)},e.prototype.dotProduct=function(t){return this._adaptee.dotProduct(t.adaptee)},e.prototype.crossProduct=function(t){return new this.sec.flash.geom.Vector3D(this._adaptee.crossProduct(t.adaptee))},e.prototype.normalize=function(){return this._adaptee.normalize()},e.prototype.scaleBy=function(t){this._adaptee.scaleBy(+t)},e.prototype.incrementBy=function(t){this._adaptee.incrementBy(t.adaptee)},e.prototype.decrementBy=function(t){this._adaptee.decrementBy(t.adaptee)},e.prototype.add=function(t){return new this.sec.flash.geom.Vector3D(this._adaptee.add(t.adaptee))},e.prototype.subtract=function(t){return new this.sec.flash.geom.Vector3D(this._adaptee.subtract(t.adaptee))},e.prototype.negate=function(){this._adaptee.negate()},e.prototype.equals=function(t,e){return this._adaptee.equals(t.adaptee,e)},e.prototype.nearEquals=function(t,e,i){return this._adaptee.nearEquals(t.adaptee,e,i)},e.prototype.project=function(){this._adaptee.project()},e.prototype.copyFrom=function(t){this._adaptee.copyFrom(t.adaptee)},e.prototype.setTo=function(t,e,i){this._adaptee.setTo(t,e,i)},e.prototype.clone=function(){return new this.sec.flash.geom.Vector3D(this._adaptee.clone())},e.prototype.toString=function(){return"Vector3D("+this.x+", "+this.y+", "+this.z+")"},e}(bb),nN=function(){function t(){}return t.BUFFER_OVERFLOW_ERROR="bufferOverflowError",t.ERROR_CODE_UNKNOWN="errorCodeUnknown",t.ILLEGAL_ARGUMENT_ERROR="illegalArgumentError",t.INDEX_OUT_OF_BOUNDS_ERROR="indexOutOfBoundsError",t.INVALID_ATTR_VALUE="invalidAttrValue",t.INVALID_CHAR_FOUND="invalidCharFound",t.MEMORY_ALLOCATION_ERROR="memoryAllocationError",t.NO_ERROR="noError",t.NUMBER_OVERFLOW_ERROR="numberOverflowError",t.PARSE_ERROR="parseError",t.PATTERN_SYNTAX_ERROR="patternSyntaxError",t.PLATFORM_API_FAILED="platformAPIFailed",t.TRUNCATED_CHAR_FOUND="truncatedCharFound",t.UNEXPECTED_TOKEN="unexpectedToken",t.UNSUPPORTED_ERROR="unsupportedError",t.USING_DEFAULT_WARNING="usingDefaultWarning",t.USING_FALLBACK_WARNING="usingFallbackWarning",t}(),rN=function(t){function e(e){var i=t.call(this)||this;return i._name=e,i.DEFAULT="i-default",i._lastOperationStatus=nN.USING_DEFAULT_WARNING,i}return i(e,t),Object.defineProperty(e.prototype,"lastOperationStatus",{get:function(){return this._lastOperationStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ctor",{get:function(){return e},enumerable:!0,configurable:!0}),e.determinePreferredLocales=function(t,e,i){return console.warn("[LocaleID] `determinePreferredLocales` not implemented"),new lx},e.prototype.getLanguage=function(){return console.warn("[LocaleID] `getLanguage` not implemented, use default: en"),this._lastOperationStatus=nN.NO_ERROR,"en"},e.prototype.getRegion=function(){return console.warn("[LocaleID] `getRegion` not implemented, use default: UK"),this._lastOperationStatus=nN.NO_ERROR,"UK"},e.prototype.getScript=function(){return console.warn("[LocaleID] `getScript` not implemented, use default: ''"),this._lastOperationStatus=nN.USING_DEFAULT_WARNING,""},e.prototype.getVariant=function(){return console.warn("[LocaleID] `getVariant` not implemented, use default: ''"),this._lastOperationStatus=nN.USING_DEFAULT_WARNING,""},e.prototype.isRightToLeft=function(){return console.warn("[LocaleID] `isRightToLeft` not implemented, use default: true"),!0},e.prototype.getKeysAndValues=function(){return console.warn("[LocaleID] `isRightToLeft` not implemented, use default: null"),this._lastOperationStatus=nN.USING_DEFAULT_WARNING,null},e}(bb),oN=function(t){function e(e,i,n){return t.call(this,e,i,n)||this}return i(e,t),e.prototype.clone=function(){return new this.sec.flash.events.TimerEvent(this.type,this.bubbles,this.cancelable)},e.prototype.toString=function(){return this.formatToString("TimerEvent","type","bubbles","cancelable","eventPhase")},e.prototype.updateAfterEvent=function(){this.sec.player.requestRender()},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.TIMER="timer",e.TIMER_COMPLETE="timerComplete",e}(pR),sN=function(t){function e(e,i,n,r,o,s,a,l,u,c,h,p,d,f){return void 0===i&&(i=!0),void 0===n&&(n=!1),t.call(this,e,i,n)||this}return i(e,t),Object.defineProperty(e.prototype,"altKey",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ctrlKey",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPrimaryTouchPoint",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRelatedObjectInaccessible",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localX",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localY",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pressure",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relatedObject",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shiftKey",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sizeX",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sizeY",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageX",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageY",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"touchPointID",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return null},e.prototype.toString=function(){return""},e.prototype.updateAfterEvent=function(){},e.TOUCH_BEGIN="touchBegin",e.TOUCH_END="touchEnd",e.TOUCH_MOVE="touchMove",e.TOUCH_OUT="touchOut",e.TOUCH_OVER="touchOver",e.TOUCH_ROLL_OUT="touchRollOut",e.TOUCH_ROLL_OVER="touchRollOver",e.TOUCH_TAP="touchTap",e}(pR),aN=function(t){function e(e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===r&&(r=null);var o=t.call(this,e,i,n)||this;return o.device=r,o}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.DEVICE_ADDED="deviceAdded",e.DEVICE_REMOVED="deviceRemoved",e}(pR),lN=function(t){function e(e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===r&&(r=null);var o=t.call(this,e,i,n)||this;return o._info=r,o}return i(e,t),Object.defineProperty(e.prototype,"info",{get:function(){return this._info},set:function(t){this._info=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this.bubbles,this.cancelable,this.info)},e.prototype.toString=function(){return this.formatToString("NetStatusEvent","type","bubbles","cancelable","eventPhase","info")},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.NET_STATUS="netStatus",e}(pR),uN=function(t){function e(e,i,n,r,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=!1);var s=t.call(this,e,i,n)||this;return s._status=r,s._redirected=o,s._responseURL="",s._responseHeaders=null,s}return i(e,t),e.prototype._setStatus=function(t){this._status=t},Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirected",{get:function(){return this._redirected},set:function(t){this._redirected=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"responseURL",{get:function(){return this._responseURL},set:function(t){this._responseURL=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"responseHeaders",{get:function(){return this._responseHeaders},set:function(t){this._responseHeaders=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.type,this.bubbles,this.cancelable,this._status,this._redirected)},e.prototype.toString=function(){return this.formatToString("IOErrorEvent","type","bubbles","cancelable","text","errorID")},e.classInitializer=null,e.HTTP_RESPONSE_STATUS="httpResponseStatus",e.HTTP_STATUS="httpStatus",e}(pR),cN=function(t){function e(){return t.call(this)||this}return i(e,t),e.ensureInitialized=function(){this.available||this.sec.throwError("Error",db.ExternalInterfaceNotAvailableError),this.initialized||(this.initialized=!0,If.initJS(this._callIn))},e.call=function(t){this.ensureInitialized();var e="";if(arguments.length>1){for(var i=[],n=1;n<arguments.length;n++)i.push(this.convertToJSString(arguments[n]));e=i.join(",")}var r=this.$BgmarshallExceptions?'"<exception>" + e + "</exception>";':'"<undefined/>";',o="try {"+If.interfaceID+".__flash__toXML("+t+"("+e+"));} catch (e) {"+r+"}",s=this._evalJS(o);return null==s?null:this.convertFromXML(this.convertToXML(s))},e.addCallback=function(t,e){var i=this;if(this.ensureInitialized(),e){var n=this;this._addCallback(t,(function(t,r){var o,s=!0;if(void 0!==r)if(Array.isArray(r)){for(var a=[],l=0;l<r.length;l++){var u=r[l];"object"==typeof u&&u?Array.isArray(u)?a.push(n.sec.createArray(u)):a.push(n.sec.createObjectFromJS(u,!0)):a.push(u)}r=a}else r=[r];else{var c=i.convertToXML(t),h=c.attribute("returntype");if(s=h&&"javascript"==h._value,r=[],c._children)for(l=0;l<c._children.length;l++){var p=c._children[l];r.push(i.convertFromXML(p))}}try{o=e.axApply(null,r)}catch(t){if(!i.$BgmarshallExceptions)throw t;o=t}return s?n.convertToJSString(o):n.convertToXMLString(o)}))}else this._removeCallback(t)},Object.defineProperty(e,"available",{get:function(){return If.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(e,"objectID",{get:function(){return If.getId()},enumerable:!0,configurable:!0}),e._addCallback=function(t,i){If.registerCallback(t),e.registeredCallbacks[t]=i},e._removeCallback=function(t){If.unregisterCallback(t),delete e.registeredCallbacks[t]},e._evalJS=function(t){return t=Yv(t),If.eval(t)},e._callIn=function(t,i){var n=e.registeredCallbacks[t];if(n)return n(t,i)},e._callOut=function(t){return t=Yv(t),If.call(t)},e.convertToXML=function(t){var e=this.sec.system.getClass(Kv.FromSimpleName("XML")),i=e.ignoreWhitespace;e.ignoreWhitespace=!1;var n=e.Create(t);return e.ignoreWhitespace=i,n},e.convertToXMLString=function(t){switch(typeof t){case"boolean":return t?"<true/>":"<false/>";case"number":return"<number>"+t+"</number>";case"string":return"<string>"+t.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")+"</string>";case"object":if(null===t)return"<null/>";if(this.sec.AXDate.axIsInstanceOf(t))return"<date>"+t.time+"</date>";if(this.sec.AXError.axIsInstanceOf(t))return this.$BgmarshallExceptions?"<exception>"+t+"</exception>":"<null/>";var e=[];if(t.hasOwnProperty("$Bglength")){for(var i=t.$Bglength,n=0;n<i;n++){var r=this.convertToXMLString(t.axGetNumericProperty(n));e.push('<property id="'+n+'">'+r+"</property>")}return"<array>"+e.join("")+"</array>"}var o=t.axGetEnumerableKeys();for(n=0;n<o.length;n++){var s=o[n];r=this.convertToXMLString(t.axGetPublicProperty(s));e.push('<property id="'+s+'">'+r+"</property>")}return"<object>"+e.join("")+"</object>";default:return"<undefined/>"}},e.convertFromXML=function(t){switch(t._name.name){case"true":return!0;case"false":return!1;case"number":return Number(String(t.children()));case"string":return String(t.children());case"null":return null;case"date":return this.sec.AXDate.axConstruct([Number(String(t.children()))]);case"exception":if(this.$BgmarshallExceptions)throw this.sec.AXError.axConstruct([String(t.children())]);return;case"array":case"object":for(var e="object"===t._name.name?this.sec.createObject():this.sec.createArrayUnsafe([]),i=0;i<t._children.length;i++){var n=t._children[i];e.axSetPublicProperty(hN(n),this.convertFromXML(n._children[0]))}return e;case"class":var r=Kv.FromFQNString(String(t.children()),0);return this.sec.application.getClass(r);default:return}},e.convertToJSString=function(t){if("string"==typeof t)return'"'+t.split("\r").join("\\r").split("\n").join("\\n").split('"').join('\\"')+'"';if(this.sec.AXArray.axIsInstanceOf(t)){for(var e=[],i=t.value,n=0;n<i.length;n++)e.push(this.convertToJSString(i[n]));return"["+e.join(",")+"]"}if(this.sec.AXDate.axIsInstanceOf(t))return"new Date("+t.value+")";if(this.$BgmarshallExceptions&&this.sec.AXError.axIsInstanceOf(t))return'throw "'+t+'"';if("object"==typeof t&&null!==t){e=[];var r=t.axGetEnumerableKeys();for(n=0;n<r.length;n++){var o=r[n];e.push(o+":"+this.convertToJSString(t.axGetPublicProperty(o)))}return"({"+e.join(",")+"})"}return String(t)},e.classInitializer=null,e.initialized=!1,e.registeredCallbacks=Object.create(null),e}(bb);function hN(t){for(var e=0;e<t._attributes.length;e++){var i=t._attributes[e];if("id"===i._name.name)return i._value}}var pN,dN=function(t){function e(){return t.call(this)||this}return i(e,t),e._updateBlurBounds=function(t,i,n,r,o){void 0===o&&(o=!1);var s=e.blurFilterStepWidths[r-1];if(o){var a=s/4;i-=a,n-=a}var l=Math.ceil((i<1?1:i)*s),u=Math.ceil((n<1?1:n)*s);t.inflate(l,u)},e.prototype._updateFilterBounds=function(t){},e.prototype._serialize=function(t){t.writeInt(-1)},e.prototype.clone=function(){return null},e.classInitializer=null,e.EPS=1e-9,e.blurFilterStepWidths=[.5,1.05,1.35,1.55,1.75,1.9,2,2.1,2.2,2.3,2.5,3,3,3.5,3.5],e}(bb),fN=function(){function t(){}return t.sanitize=function(t,e,i){if(Xh(t)||0===t.length)this.colors=[],this.alphas=[],this.ratios=[];else{var n=void 0;Xh(i)?(this.colors=this.sanitizeColors(t),n=this.colors.length,this.ratios=this.initArray(n),Xh(e)?this.alphas=this.initArray(n):this.alphas=this.sanitizeAlphas(e,n,n,1)):0===i.length?(this.colors=[],this.alphas=[],this.ratios=[]):(n=Math.min(t.length,i.length,16),this.colors=this.sanitizeColors(t,n),this.ratios=this.sanitizeRatios(i,n),Xh(e)?this.alphas=this.initArray(n):this.alphas=this.sanitizeAlphas(e,n,n,1))}},t.sanitizeColors=function(t,e){void 0===e&&(e=16);for(var i=[],n=0,r=Math.min(t.length,e);n<r;n++)i[n]=t[n]>>>0&16777215;return i},t.sanitizeAlphas=function(t,e,i,n){void 0===e&&(e=16),void 0===i&&(i=0),void 0===n&&(n=0);for(var r=[],o=0,s=Math.min(t.length,e);o<s;o++)r[o]=bh.clamp(+t[o],0,1);for(;o<i;)r[o++]=n;return r},t.sanitizeRatios=function(t,e,i,n){void 0===e&&(e=16),void 0===i&&(i=0),void 0===n&&(n=0);for(var r=[],o=0,s=Math.min(t.length,e);o<s;o++)r[o]=bh.clamp(+t[o],0,255);for(;o<i;)r[o++]=n;return r},t.initArray=function(t,e){void 0===e&&(e=0);for(var i=Array(t),n=0;n<t;n++)i[n]=e;return i},t}(),_N=function(t){function e(){return t.call(this)||this}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.INNER="inner",e.OUTER="outer",e.FULL="full",e}(bb),mN=function(t){function e(e,i,n,r,o,s,a,l,u,c,h,p){void 0===e&&(e=4),void 0===i&&(i=45),void 0===n&&(n=16777215),void 0===r&&(r=1),void 0===o&&(o=0),void 0===s&&(s=1),void 0===a&&(a=4),void 0===l&&(l=4),void 0===u&&(u=1),void 0===c&&(c=1),void 0===h&&(h="inner"),void 0===p&&(p=!1);var d=t.call(this)||this;return d.distance=e,d.angle=i,d.highlightColor=n,d.highlightAlpha=r,d.shadowColor=o,d.shadowAlpha=s,d.blurX=a,d.blurY=l,d.strength=u,d.quality=c,d.type=h,d.knockout=p,d}return i(e,t),e.FromUntyped=function(t){var i=t.colors[0]>>>8,n=(255&t.colors[0])/255,r=t.colors[1]>>>8,o=(255&t.colors[1])/255,s=_N.OUTER;t.onTop?s=_N.FULL:t.inner&&(s=_N.INNER);var a=180*t.angle/Math.PI;return new e(t.distance,a,i,n,r,o,t.blurX,t.blurY,t.strength,t.quality,s,t.knockout)},e.prototype._updateFilterBounds=function(t){if(this.type!==_N.INNER&&(dN._updateBlurBounds(t,this._blurX,this._blurY,this._quality),0!==this._distance)){var e=this._angle*Math.PI/180;t.x+=Math.floor(Math.cos(e)*this._distance),t.y+=Math.floor(Math.sin(e)*this._distance),t.left>0&&(t.left=0),t.top>0&&(t.top=0)}},Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=+t%360},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this._highlightColor},set:function(t){this._highlightColor=t>>>0&16777215},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightAlpha",{get:function(){return this._highlightAlpha},set:function(t){this._highlightAlpha=bh.clamp(+t,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{get:function(){return this._shadowColor},set:function(t){this._shadowColor=t>>>0&16777215},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowAlpha",{get:function(){return this._shadowAlpha},set:function(t){this._shadowAlpha=bh.clamp(+t,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this._blurX},set:function(t){this._blurX=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this._blurY},set:function(t){this._blurY=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this._knockout},set:function(t){this._knockout=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=bh.clamp(0|t,0,15)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){null===(t=Yv(t))?this.sec.throwError("TypeError",db.NullPointerError,"type"):t===_N.INNER||t===_N.OUTER?this._type=t:this._type=_N.FULL},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._distance,this._angle,this._highlightColor,this._highlightAlpha,this._shadowColor,this._shadowAlpha,this._blurX,this._blurY,this._strength,this._quality,this._type,this._knockout)},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(dN),gN=function(t){function e(e,i,n){void 0===e&&(e=4),void 0===i&&(i=4),void 0===n&&(n=1);var r=t.call(this)||this;return r.blurX=e,r.blurY=i,r.quality=n,r}return i(e,t),e.FromUntyped=function(t){return new e(t.blurX,t.blurY,t.quality)},e.prototype._updateFilterBounds=function(t){dN._updateBlurBounds(t,this._blurX,this._blurY,this._quality,!0)},e.prototype._serialize=function(t){t.ensureAdditionalCapacity(16),t.writeIntUnsafe(1),t.writeFloatUnsafe(this._blurX),t.writeFloatUnsafe(this._blurY),t.writeIntUnsafe(this._quality)},Object.defineProperty(e.prototype,"blurX",{get:function(){return this._blurX},set:function(t){this._blurX=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this._blurY},set:function(t){this._blurY=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=bh.clamp(0|t,0,15)},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._blurX,this._blurY,this._quality)},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(dN),yN=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return e?i.matrix=e:i._matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],i}return i(e,t),e.FromUntyped=function(t){var i=Object.create(e.axClass.tPrototype);return i._matrix=t.matrix,i},e.prototype._serialize=function(t){var e=this._matrix;t.ensureAdditionalCapacity(4*(e.length+1)),t.writeIntUnsafe(6);for(var i=0;i<e.length;i++)t.writeFloatUnsafe(e[i])},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.sec.createArrayUnsafe(this._matrix.concat())},set:function(t){Xh(t)&&this.sec.throwError("TypeError",db.NullPointerError,"matrix");for(var e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=t.value,n=0,r=Math.min(i.length,20);n<r;n++)e[n]=Qh(i[n]);this._matrix=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.matrix)},e.classInitializer=null,e}(dN),AN=function(t){function e(e,i,n,r,o,s,a,l,u){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=null),void 0===r&&(r=1),void 0===o&&(o=0),void 0===s&&(s=!0),void 0===a&&(a=!0),void 0===l&&(l=0),void 0===u&&(u=0);var c=t.call(this)||this;return c.matrixX=e,c.matrixY=i,n?c.matrix=n:c._matrix=c._expandArray([],c._matrixX*c._matrixY),c.divisor=r,c.bias=o,c.preserveAlpha=s,c.clamp=a,c.color=l,c.alpha=u,c}return i(e,t),e.FromUntyped=function(t){return new e(t.matrixX,t.matrixY,t.matrix,t.divisor,t.bias,t.preserveAlpha,t.clamp,t.color>>>8,(255&t.color)/255)},e.prototype._expandArray=function(t,e,i){if(t)for(var n=t.length;n<e;)t[n++]=0;return t},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.sec.createArrayUnsafe(this._matrix.slice(0,this._matrixX*this._matrixY))},set:function(t){Xh(t)&&this.sec.throwError("TypeError",db.NullPointerError,"matrix");for(var e=t.value,i=this._matrixX*this._matrixY,n=Math.min(e.length,i),r=Array(n),o=0;o<n;o++)r[o]=Qh(e[o]);this._expandArray(r,i),this._matrix=r},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrixX",{get:function(){return this._matrixX},set:function(t){var e=0|bh.clamp(+t,0,15);this._matrixX!==e&&(this._matrixX=e,this._expandArray(this._matrix,e*this._matrixY))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrixY",{get:function(){return this._matrixY},set:function(t){var e=0|bh.clamp(+t,0,15);this._matrixY!==e&&(this._matrixY=e,this._expandArray(this._matrix,e*this._matrixX))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"divisor",{get:function(){return this._divisor},set:function(t){this._divisor=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bias",{get:function(){return this._bias},set:function(t){this._bias=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preserveAlpha",{get:function(){return this._preserveAlpha},set:function(t){this._preserveAlpha=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clamp",{get:function(){return this._clamp},set:function(t){this._clamp=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=bh.clamp(+t,0,1)},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._matrixX,this._matrixY,this.matrix,this._divisor,this._bias,this._preserveAlpha,this._clamp,this._color,this._alpha)},e.classInitializer=null,e}(dN),vN=function(t){function e(e,i,n,r,o,s,a,l,u){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a="wrap"),void 0===l&&(l=0),void 0===u&&(u=0);var c=t.call(this)||this;return c.mapBitmap=e,c.mapPoint=i,c.componentX=n,c.componentY=r,c.scaleX=o,c.scaleY=s,c.mode=a,c.color=l,c.alpha=u,c}return i(e,t),e.FromUntyped=function(t){return new e(t.mapBitmap,t.mapPoint,t.componentX,t.componentY,t.scaleX,t.scaleY,t.mode,t.color,t.alpha)},Object.defineProperty(e.prototype,"mapBitmap",{get:function(){return this._mapBitmap},set:function(t){this._mapBitmap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapPoint",{get:function(){return this._mapPoint},set:function(t){this._mapPoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentX",{get:function(){return this._componentX},set:function(t){this._componentX=t>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentY",{get:function(){return this._componentY},set:function(t){this._componentY=t>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},set:function(t){this._scaleX=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},set:function(t){this._scaleY=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t>>>0&16777215},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=+t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._mapBitmap,this._mapPoint,this._componentX,this._componentY,this._scaleX,this._scaleY,this._mode,this._color,this._alpha)},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(dN),bN=function(t){function e(e,i,n,r,o,s,a,l,u,c,h){void 0===e&&(e=4),void 0===i&&(i=45),void 0===n&&(n=0),void 0===r&&(r=1),void 0===o&&(o=4),void 0===s&&(s=4),void 0===a&&(a=1),void 0===l&&(l=1),void 0===u&&(u=!1),void 0===c&&(c=!1),void 0===h&&(h=!1);var p=t.call(this)||this;return p.distance=e,p.angle=i,p.color=n,p.alpha=r,p.blurX=o,p.blurY=s,p.strength=a,p.quality=l,p.inner=u,p.knockout=c,p.hideObject=h,p}return i(e,t),e.FromUntyped=function(t){var i=t.colors[0]>>>8,n=(255&t.colors[0])/255,r=180*t.angle/Math.PI,o=!t.compositeSource;return new e(t.distance,r,i,n,t.blurX,t.blurY,t.strength,t.quality,t.inner,t.knockout,o)},e.prototype._updateFilterBounds=function(t){if(!this.inner&&(dN._updateBlurBounds(t,this._blurX,this._blurY,this._quality),0!==this._distance)){var e=this._angle*Math.PI/180;t.x+=Math.floor(Math.cos(e)*this._distance),t.y+=Math.floor(Math.sin(e)*this._distance),t.left>0&&(t.left=0),t.top>0&&(t.top=0)}},Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=+t%360},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t>>>0&16777215},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=bh.clamp(+t,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this._blurX},set:function(t){this._blurX=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this._blurY},set:function(t){this._blurY=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideObject",{get:function(){return this._hideObject},set:function(t){this._hideObject=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this._inner},set:function(t){this._inner=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this._knockout},set:function(t){this._knockout=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=bh.clamp(0|t,0,15)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._distance,this._angle,this._color,this._alpha,this._blurX,this._blurY,this._strength,this._quality,this._inner,this._knockout,this._hideObject)},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(dN),xN=function(t){function e(e,i,n,r,o,s,a,l){void 0===e&&(e=16711680),void 0===i&&(i=1),void 0===n&&(n=6),void 0===r&&(r=6),void 0===o&&(o=2),void 0===s&&(s=1),void 0===a&&(a=!1),void 0===l&&(l=!1);var u=t.call(this)||this;return u.color=e,u.alpha=i,u.blurX=n,u.blurY=r,u.strength=o,u.quality=s,u.inner=a,u.knockout=l,u}return i(e,t),e.FromUntyped=function(t){return new e(t.colors[0]>>>8,(255&t.colors[0])/255,t.blurX,t.blurY,t.strength,t.quality,t.inner,t.knockout)},e.prototype._updateFilterBounds=function(t){dN._updateBlurBounds(t,this._blurX,this._blurY,this._quality)},Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t>>>0&16777215},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=bh.clamp(+t,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this._blurX},set:function(t){this._blurX=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this._blurY},set:function(t){this._blurY=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this._inner},set:function(t){this._inner=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this._knockout},set:function(t){this._knockout=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=bh.clamp(0|t,0,15)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._color,this._alpha,this._blurX,this._blurY,this._strength,this._quality,this._inner,this._knockout)},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(dN),CN=function(t){function e(e,i,n,r,o,s,a,l,u,c,h){void 0===e&&(e=4),void 0===i&&(i=45),void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=4),void 0===a&&(a=4),void 0===l&&(l=1),void 0===u&&(u=1),void 0===c&&(c="inner"),void 0===h&&(h=!1);var p=t.call(this)||this;return p.distance=e,p.angle=i,fN.sanitize(n?n.value:null,r?r.value:null,o?o.value:null),p._colors=fN.colors,p._alphas=fN.alphas,p._ratios=fN.ratios,p.blurX=s,p.blurY=a,p.strength=l,p.quality=u,p.type=c,p.knockout=h,p}return i(e,t),e.FromUntyped=function(t){for(var i=[],n=[],r=0;r<t.colors.length;r++){var o=t.colors[r];i.push(o>>>8),n.push(255&o)}var s=_N.OUTER;t.onTop?s=_N.FULL:t.inner&&(s=_N.INNER);var a=180*t.angle/Math.PI;return new e(t.distance,a,this.sec.createArrayUnsafe(i),this.sec.createArrayUnsafe(n),this.sec.createArrayUnsafe(t.ratios),t.blurX,t.blurY,t.strength,t.quality,s,t.knockout)},e.prototype._updateFilterBounds=function(t){if(this.type!==_N.INNER&&(dN._updateBlurBounds(t,this._blurX,this._blurY,this._quality),0!==this._distance)){var e=this._angle*Math.PI/180;t.x+=Math.floor(Math.cos(e)*this._distance),t.y+=Math.floor(Math.sin(e)*this._distance),t.left>0&&(t.left=0),t.top>0&&(t.top=0)}},Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=+t%360},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colors",{get:function(){return this.sec.createArrayUnsafe(this._colors.concat())},set:function(t){Xh(t)&&this.sec.throwError("TypeError",db.NullPointerError,"colors"),this._colors=fN.sanitizeColors(t.value);var e=this._colors.length;this._alphas=fN.sanitizeAlphas(this._alphas,e,e),this._ratios=fN.sanitizeRatios(this._ratios,e,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphas",{get:function(){return this.sec.createArrayUnsafe(this._alphas.concat())},set:function(t){Xh(t)&&this.sec.throwError("TypeError",db.NullPointerError,"alphas"),fN.sanitize(this._colors,t.value,this._ratios),this._colors=fN.colors,this._alphas=fN.alphas,this._ratios=fN.ratios},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ratios",{get:function(){return this.sec.createArrayUnsafe(this._ratios.concat())},set:function(t){Xh(t)&&this.sec.throwError("TypeError",db.NullPointerError,"ratios"),fN.sanitize(this._colors,this._alphas,t.value),this._colors=fN.colors,this._alphas=fN.alphas,this._ratios=fN.ratios},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this._blurX},set:function(t){this._blurX=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this._blurY},set:function(t){this._blurY=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this._knockout},set:function(t){this._knockout=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=bh.clamp(0|t,0,15)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){null===(t=Yv(t))?this.sec.throwError("TypeError",db.NullPointerError,"type"):t===_N.INNER||t===_N.OUTER?this._type=t:this._type=_N.FULL},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._distance,this._angle,this.colors,this.alphas,this.ratios,this._blurX,this._blurY,this._strength,this._quality,this._type,this._knockout)},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(dN),wN=function(t){function e(e,i,n,r,o,s,a,l,u,c,h){void 0===e&&(e=4),void 0===i&&(i=45),void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=4),void 0===a&&(a=4),void 0===l&&(l=1),void 0===u&&(u=1),void 0===c&&(c="inner"),void 0===h&&(h=!1);var p=t.call(this)||this;return p.distance=e,p.angle=i,fN.sanitize(n?n.value:null,r?r.value:null,o?o.value:null),p._colors=fN.colors,p._alphas=fN.alphas,p._ratios=fN.ratios,p.blurX=s,p.blurY=a,p.strength=l,p.quality=u,p.type=c,p.knockout=h,p}return i(e,t),e.FromUntyped=function(t){for(var i=[],n=[],r=0;r<t.colors.length;r++){var o=t.colors[r];i.push(o>>>8),n.push(255&o)}var s=_N.OUTER;t.onTop?s=_N.FULL:t.inner&&(s=_N.INNER);var a=180*t.angle/Math.PI;return new e(t.distance,a,this.sec.createArrayUnsafe(i),this.sec.createArrayUnsafe(n),this.sec.createArrayUnsafe(t.ratios),t.blurX,t.blurY,t.strength,t.quality,s,t.knockout)},e.prototype._updateFilterBounds=function(t){if(this.type!==_N.INNER&&(dN._updateBlurBounds(t,this._blurX,this._blurY,this._quality),0!==this._distance)){var e=this._angle*Math.PI/180;t.x+=Math.floor(Math.cos(e)*this._distance),t.y+=Math.floor(Math.sin(e)*this._distance),t.left>0&&(t.left=0),t.top>0&&(t.top=0)}},Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=+t%360},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colors",{get:function(){return this.sec.createArrayUnsafe(this._colors.concat())},set:function(t){Xh(t)&&this.sec.throwError("TypeError",db.NullPointerError,"colors"),this._colors=fN.sanitizeColors(t.value);var e=this._colors.length;this._alphas=fN.sanitizeAlphas(this._alphas,e,e),this._ratios=fN.sanitizeRatios(this._ratios,e,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphas",{get:function(){return this.sec.createArrayUnsafe(this._alphas.concat())},set:function(t){Xh(t)&&this.sec.throwError("TypeError",db.NullPointerError,"alphas"),fN.sanitize(this._colors,t.value,this._ratios),this._colors=fN.colors,this._alphas=fN.alphas,this._ratios=fN.ratios},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ratios",{get:function(){return this.sec.createArrayUnsafe(this._ratios.concat())},set:function(t){Xh(t)&&this.sec.throwError("TypeError",db.NullPointerError,"ratios"),fN.sanitize(this._colors,this._alphas,t.value),this._colors=fN.colors,this._alphas=fN.alphas,this._ratios=fN.ratios},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this._blurX},set:function(t){this._blurX=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this._blurY},set:function(t){this._blurY=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this._knockout},set:function(t){this._knockout=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=bh.clamp(0|t,0,15)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength=bh.clamp(+t,0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){null===(t=Yv(t))?this.sec.throwError("TypeError",db.NullPointerError,"type"):t===_N.INNER||t===_N.OUTER?this._type=t:this._type=_N.FULL},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._distance,this._angle,this.colors,this.alphas,this.ratios,this._blurX,this._blurY,this._strength,this._quality,this._type,this._knockout)},e.classInitializer=null,e}(dN),IN=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.axCallPublicProperty=function(t,e){return null},e.prototype.axGetPublicProperty=function(t){return null},e.prototype.axSetPublicProperty=function(t,e){return null},e.prototype.axHasPublicProperty=function(t){return null},e.prototype.axDeletePublicProperty=function(t){return null},e.prototype.axGetEnumerableKeys=function(){return[]},Object.defineProperty(e.prototype,"leftPeak",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightPeak",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"soundTransform",{get:function(){return this._soundTransform||(this._soundTransform=new this.sec.flash.media.SoundTransform),this._soundTransform},set:function(t){this._sound&&(this._sound.adaptee.volume=t.volume,this._sound.adaptee.pan=t.pan),this._soundTransform=t},enumerable:!0,configurable:!0}),e.prototype.stop=function(){this._sound&&this._sound.stop()},e}(gR),EN=function(t){function e(e,i){void 0===e&&(e=1),void 0===i&&(i=0);var n=t.call(this)||this;return n._vol=1,n._pan=0,n._vol=e,n._pan=i,n}return i(e,t),e.prototype.axCallPublicProperty=function(t,e){return console.log("axCallPublicProperty not implemented yet in flash/SoundTransform"),null},e.prototype.axGetPublicProperty=function(t){return console.log("axGetPublicProperty not implemented yet in flash/SoundTransform"),null},e.prototype.axSetPublicProperty=function(t,e){return console.log("axSetPublicProperty not implemented yet in flash/SoundTransform"),null},e.prototype.axHasPublicProperty=function(t){return console.log("axHasPublicProperty not implemented yet in flash/SoundTransform"),null},e.prototype.axDeletePublicProperty=function(t){return console.log("axDeletePublicProperty not implemented yet in flash/SoundTransform"),null},e.prototype.axGetEnumerableKeys=function(){return console.log("axGetEnumerableKeys not implemented yet in flash/SoundTransform"),[]},Object.defineProperty(e.prototype,"leftToLeft",{get:function(){return console.log("leftToLeft not implemented yet in flash/SoundTransform"),0},set:function(t){console.log("leftToLeft not implemented yet in flash/SoundTransform")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftToRight",{get:function(){return console.log("leftToRight not implemented yet in flash/SoundTransform"),0},set:function(t){console.log("leftToRight not implemented yet in flash/SoundTransform")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightToLeft",{get:function(){return console.log("rightToLeft not implemented yet in flash/SoundTransform"),0},set:function(t){console.log("rightToLeft not implemented yet in flash/SoundTransform")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightToRight",{get:function(){return console.log("rightToRight not implemented yet in flash/SoundTransform"),0},set:function(t){console.log("rightToRight not implemented yet in flash/SoundTransform")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._vol},set:function(t){this._vol=t>1?1:t<0?0:t},enumerable:!0,configurable:!0}),e}(bb),SN=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e,"bufferTime",{get:function(){return e._bufferTime},set:function(t){e._bufferTime=0|t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"soundTransform",{get:function(){return Xh(e._soundTransform)?new EN:new EN(e._soundTransform.volume,e._soundTransform.pan)},set:function(t){e._soundTransform=Xh(t)?new EN:t,e._updateAllSoundSources()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"audioPlaybackMode",{get:function(){},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"useSpeakerphoneForVoice",{get:function(){},set:function(t){},enumerable:!0,configurable:!0}),e.stopAll=function(){e._registeredSoundSources.forEach((function(t){t.stopSound()})),e._registeredSoundSources=[]},e.computeSpectrum=function(t,e,i){for(var n=new Float32Array(1024),r=0;r<1024;r++)n[r]=Math.random();t.writeRawBytes(n),t.position=0},e.areSoundsInaccessible=function(){},e._getMasterVolume=function(){return e._masterVolume},e._setMasterVolume=function(t){t=+t,e._masterVolume=t,e._updateAllSoundSources()},e._registerSoundSource=function(t){e._registeredSoundSources.push(t)},e._unregisterSoundSource=function(t){var i=e._registeredSoundSources.indexOf(t);i>=0&&e._registeredSoundSources.splice(i,1)},e._updateSoundSource=function(t){var i=t.soundTransform.volume;e._soundTransform&&(i*=e._soundTransform.volume),i*=e._getMasterVolume(),t.updateSoundLevels(i)},e._updateAllSoundSources=function(){e._registeredSoundSources.forEach(e._updateSoundSource)},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e._masterVolume=1,e._registeredSoundSources=[],e._bufferTime=0,e}(bb),DN=function(){function t(){this._values={},this._realStorage=null}return t.prototype.getItem=function(t){return this._realStorage&&(this._values[t]=this._realStorage.getItem(t)),this._values[t]},t.prototype.setItem=function(t,e){this._realStorage&&this._realStorage.setItem(t,e),this._values[t]=e},t.prototype.removeItem=function(t){this._realStorage&&this._realStorage.removeItem(t),delete this._values[t]},t}();function TN(){if(!pN&&(pN=new DN,"undefined"!=typeof Storage))try{pN._realStorage=window.localStorage}catch(t){console.warn("[Shared Storage] ",t)}return pN}var PN=function(){function t(){}return t.decodedData=function(){if(!BN)throw"Can't decode without security context";var t=TN(),e={},i={};for(var n in t._values){null!==t._values[n]?(e[n]=MN.tryDecodeData(t._values[n]),i[n]=dD(BN,e[n],!0)):e[n]=i[n]=null}return this._lastDecodedData=i,this._lastRawData=e,i},t.encodeAndApplyData=function(){if(!this._lastRawData)throw"Need call decode before encode for detecting model";var t={};for(var e in this._lastRawData)void 0!==typeof this._lastDecodedData[e]?t[e]=pD(BN,this._lastDecodedData[e],!0):t[e]=this._lastRawData[e];var i=TN();for(var e in t)null!==t[e]&&i.setItem(e,MN.tryEncodeData(t[e]));return t},t._lastRawData=null,t._lastDecodedData=null,t}();window._AWAY_DEBUG_STORAGE=PN,window.addEventListener("unload",(function(){MN.closeAll()})),window.addEventListener("blur",(function(){MN.closeAll()}));var BN=void 0,MN=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e,"defaultObjectEncoding",{get:function(){},set:function(t){},enumerable:!0,configurable:!0}),e.deleteAll=function(t){},e.getDiskUsage=function(t){return 0},e.tryDecodeData=function(t){var e=Mh.decodeRestrictedBase64ToBytes(t),i=new y(e.length);return i.sec=this.sec||BN,i.setArrayBuffer(e.buffer),VD.read(i)},e.tryEncodeData=function(t){var e=new y;e.sec=this.sec||BN,VD.write(e,t);var i=new Uint8Array(e.arraybytes);return Mh.base64EncodeBytes(i)},e.getLocal=function(t,i,n){BN=this.sec,t=Yv(t);var r=((i=Yv(i))||"")+"/"+t;if(e._sharedObjects[r])return e._sharedObjects[r];var o,s=TN().getItem(r),a=this._defaultObjectEncoding;if(s){try{o=e.tryDecodeData(s)}catch(t){}o&&"object"==typeof o||(o=this.sec.createObject())}else o=this.sec.createObject();var l=new this.sec.flash.net.SharedObject;return l._path=r,l._objectEncoding=a,l._data=o,e._sharedObjects[r]=l,l},e.getRemote=function(t,e,i,n){return new this.sec.flash.net.SharedObject},e.closeAll=function(){for(var t=0,i=e._sharedObjects;t<i.length;t++){var n=i[t];n&&n.close()}},e.prototype.flush=function(t){var i=!0;for(var n in this._data)if(this._data.hasOwnProperty(n)){i=!1;break}if(!i||TN().getItem(this._path)){BN=this.sec;var r=e.tryEncodeData(this._data);TN().setItem(this._path,r)}},Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"objectEncoding",{get:function(){},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"client",{get:function(){},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){},e.prototype.connect=function(t,e){},e.prototype.send=function(){},e.prototype.close=function(){this.flush(),delete e._sharedObjects[this._path]},e.prototype.clear=function(){this._data=this.sec.createObject(),TN().removeItem(this._path),delete e._sharedObjects[this._path]},Object.defineProperty(e.prototype,"size",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fps",{set:function(t){},enumerable:!0,configurable:!0}),e.prototype.setProperty=function(t,e){},e._sharedObjects={},e._defaultObjectEncoding=UD.DEFAULT,e}(bb),ON=function(t){function e(){var e=t.call(this)||this;return e._adaptee=new st,e._completeCallbackDelegate=function(t){return e.completeCallback(t)},e._progressCallbackDelegate=function(t){return e.progressCallback(t)},e._loadErrorDelegate=function(t){return e.loadErrorDelegate(t)},e.eventMapping[pR.COMPLETE]={adaptedType:Q.LOAD_COMPLETE,addListener:e.initListener,removeListener:e.removeListener,callback:e._completeCallbackDelegate},e.eventMapping[FR.PROGRESS]={adaptedType:Q.LOAD_PROGRESS,addListener:e.initListener,removeListener:e.removeListener,callback:e._progressCallbackDelegate},e.eventMapping[NR.IO_ERROR]={adaptedType:Q.LOAD_ERROR,addListener:e.initListener,removeListener:e.removeListener,callback:e._loadErrorDelegate},e}return i(e,t),e.prototype.close=function(){console.log("not mimplemented: URLoader.close")},Object.defineProperty(e.prototype,"data",{get:function(){return this._adaptee.data},enumerable:!0,configurable:!0}),e.prototype.initListener=function(t,e){this._adaptee.addEventListener(t,e)},e.prototype.removeListener=function(t,e){this._adaptee.removeEventListener(t,e)},e.prototype.addEventListener=function(e,i){t.prototype.addEventListener.call(this,e,i)},e.prototype.loadErrorDelegate=function(t){var e=new this.sec.flash.events.IOErrorEvent(NR.IO_ERROR);e.currentTarget=this,this.dispatchEvent(e)},e.prototype.progressCallback=function(t){void 0===t&&(t=null);var e=new this.sec.flash.events.ProgressEvent(FR.PROGRESS,null,null,t.urlLoader.bytesLoaded,t.urlLoader.bytesTotal);e.currentTarget=this,this.dispatchEvent(e)},e.prototype.completeCallback=function(t){var e=new this.sec.flash.events.Event(pR.COMPLETE);e.currentTarget=this,e.target=this,this.dispatchEvent(e)},e.prototype.load=function(t){var i=t.url||"",n=af(i,e.redirectRules);n?(console.log("[URL LOADER] Override loading url:",n.url),t.adaptee.url=n.url):console.log("[URL LOADER] start loading the url:",i),this._adaptee.load(t.adaptee)},e.redirectRules=[],e}(gR),LN=["send","connect","close","allowDomain","allowInsecureDomain","client","domain"];Object.freeze(LN);var RN=function(t,e){return console.warn("[NOT IMPLEMENTED] "+t.constructor.name+"#"+e+" yet!")},NN=function(t){function e(){var e=t.call(this)||this;e._client=e,e._connectionName=null,e._allowedInsecureDomains=[],e._allowedSecureDomains=[];var i=new URL("http://localhost");return e._domain=i.hostname,e._secure="https:"===i.protocol,e}return i(e,t),Object.defineProperty(e,"isSupported",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.close=function(){this._connectionName||this.sec.throwError("ArgumentError",db.CloseNotConnectedError),this._connectionName=null,this._allowedInsecureDomains=[],this._allowedSecureDomains=[],RN(this,"close")},e.prototype.connect=function(t){RN(this,"connect")},e.prototype.send=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];RN(this,"send")},Object.defineProperty(e.prototype,"client",{get:function(){return this._client},set:function(t){this.sec.AXObject.axIsType(t)||this.sec.throwError("ArgumentError",db.InvalidParamError),this._client=t},enumerable:!0,configurable:!0}),e.prototype.allowDomain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._allowDomains(t,!0)},e.prototype.allowInsecureDomain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._allowDomains(t,!0),this._allowDomains(t,!1)},e.prototype._allowDomains=function(t,e){RN(this,"_allowDomains")},e.prototype.handleMessage=function(t,e){var i,n=this._client;if(!n.axHasPublicProperty(t)||LN.indexOf(t)>-1)i=this.sec.createError("ReferenceError",db.ReadSealedError,t,n.axClass.name.name);else{var r=n.axGetPublicProperty(t);if(!rx(r))return;var o=new GD(e).readObject();if(this.sec.AXArray.axIsType(o))try{r.apply(n,o.value)}catch(t){i=t}else i=this.sec.createError("TypeError",db.CheckTypeFailedError,o,"Array")}if(i){var s=new RR("asyncError",!1,!1,"Error #2095: flash.net.LocalConnection was unable to invoke callback "+t+".",i.errorID);if(this.hasEventListener("asyncError"))try{this.dispatchEvent(s)}catch(t){console.warn("Exception encountered during asyncErrorEvent handling in LocalConnection sender.")}else console.warn("No handler for asyncError on LocalConnection sender, not sending event",s)}},Object.defineProperty(e.prototype,"domain",{get:function(){return this._domain},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPerUser",{get:function(){return!0},set:function(t){},enumerable:!0,configurable:!0}),e.classInitializer=null,e}(gR),FN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e,"currentDomain",{get:function(){return null},enumerable:!0,configurable:!0}),e}(bb),kN=function(t){function e(){return t.call(this)||this}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.FINGER="finger",e.STYLUS="stylus",e.NONE="none",e}(bb),VN="en",UN="PlugIn",jN=96,GN=!1,QN=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e,"isEmbeddedInAcrobat",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasEmbeddedVideo",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasAudio",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"avHardwareDisable",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasAccessibility",{get:function(){return e._hasAccessibility},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasAudioEncoder",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasMP3",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasPrinting",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasScreenBroadcast",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasScreenPlayback",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasStreamingAudio",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasStreamingVideo",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasVideoEncoder",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isDebugger",{get:function(){return GN},enumerable:!0,configurable:!0}),Object.defineProperty(e,"localFileReadDisable",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"language",{get:function(){return e._language||VN},enumerable:!0,configurable:!0}),Object.defineProperty(e,"manufacturer",{get:function(){return e._manufacturer},enumerable:!0,configurable:!0}),Object.defineProperty(e,"os",{get:function(){if(null===e._os){var t=void 0,i=window.navigator.userAgent;if(i.indexOf("Macintosh")>0)if(-1===i.indexOf("Mac OS X "))t="Mac OS 10.6";else{var n=i.split("Mac OS X ")[1];t=n.substr(0,n.indexOf(";"))}else t=i.indexOf("Windows")>0?"Windows XP":i.indexOf("Linux")>0?"Linux":/(iPad|iPhone|iPod|Android)/.test(i)?"iPhone3,1":"Generic OS";e._os=t}return e._os},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cpuArchitecture",{get:function(){return"x86"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"playerType",{get:function(){return e._playerType||UN},enumerable:!0,configurable:!0}),Object.defineProperty(e,"serverString",{get:function(){return cf({OS:e.os}).map((function(t){return t[0]+"="+encodeURIComponent(t[1])})).join("&")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"version",{get:function(){return e._version},enumerable:!0,configurable:!0}),Object.defineProperty(e,"screenColor",{get:function(){return"color"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pixelAspectRatio",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"screenDPI",{get:function(){return e._screenDPI||jN},enumerable:!0,configurable:!0}),Object.defineProperty(e,"screenResolutionX",{get:function(){return window.screen.width},enumerable:!0,configurable:!0}),Object.defineProperty(e,"screenResolutionY",{get:function(){return window.screen.height},enumerable:!0,configurable:!0}),Object.defineProperty(e,"touchscreenType",{get:function(){return kN.NONE},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasIME",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasTLS",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"maxLevelIDC",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"supports32BitProcesses",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"supports64BitProcesses",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"_internal",{get:function(){},enumerable:!0,configurable:!0}),e.hasMultiChannelAudio=function(t){return!1},e.classInitializer=null,e._hasAccessibility=!1,e._language=null,e._manufacturer="Mozilla Research",e._os=null,e._playerType=null,e._version="SHUMWAY 10,0,0,0",e._screenDPI=0,e}(bb);function zN(t,e,i){e=Yv(e),i=Yv(i),console.log("FSCommand: "+e+"; "+i),"debugger"!==(e=e.toLowerCase())&&t.player.executeFSCommand(e,i)}var HN=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e,"exactSettings",{get:function(){return e._exactSettings},set:function(t){t=!!t,e._exactSettings=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"disableAVM1Loading",{get:function(){},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sandboxType",{get:function(){return e._sandboxType},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pageDomain",{get:function(){var t=(void 0).resolveUrl("/").split("/");return t.pop(),t.pop()},enumerable:!0,configurable:!0}),e.allowDomain=function(){},e.allowInsecureDomain=function(){},e.loadPolicyFile=function(t){},e.showSettings=function(t){},e.duplicateSandboxBridgeInputArguments=function(t,e){},e.duplicateSandboxBridgeOutputArgument=function(t,e){},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.REMOTE="remote",e.LOCAL_WITH_FILE="localWithFile",e.LOCAL_WITH_NETWORK="localWithNetwork",e.LOCAL_TRUSTED="localTrusted",e.APPLICATION="application",e._exactSettings=!1,e._sandboxType="remote",e}(bb),XN=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e,"freeMemory",{get:function(){return console.log("freeMemory not implemented yet in flash/System"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ime",{get:function(){return console.log("ime not implemented yet in flash/System"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e,"privateMemory",{get:function(){return console.log("privateMemory not implemented yet in flash/System"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"processCPUUsage",{get:function(){return console.log("processCPUUsage not implemented yet in flash/System"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"totalMemory",{get:function(){return console.log("totalMemory not implemented yet in flash/System"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"totalMemoryNumber",{get:function(){return console.log("totalMemoryNumber not implemented yet in flash/System"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"useCodePage",{get:function(){return console.log("useCodePage not implemented yet in flash/System"),!1},set:function(t){console.log("useCodePage not implemented yet in flash/System")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"vmVersion",{get:function(){return console.log("vmVersion not implemented yet in flash/System"),""},enumerable:!0,configurable:!0}),e.disposeXML=function(t){console.log("disposeXML not implemented yet in flash/System")},e.exit=function(t){console.log("exit not implemented yet in flash/System")},e.gc=function(){console.log("gc not implemented yet in flash/System")},e.pause=function(){console.log("pause not implemented yet in flash/System")},e.pauseForGCIfCollectionImminent=function(t){console.log("pauseForGCIfCollectionImminent not implemented yet in flash/System")},e.resume=function(){console.log("resume not implemented yet in flash/System")},e.setClipboard=function(t){console.log("setClipboard not implemented yet in flash/System")},e}(bb),qN=function(t){function e(){var e=t.call(this)||this;return e.isAVMFont=!0,e.isAVMFont=!0,e}return i(e,t),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){this._fontName=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return console.warn("`Font#get:fontStyle` not implement yet"),"regular"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontType",{get:function(){return console.warn("`Font#get:fontType` not implement yet"),"embedded"},enumerable:!0,configurable:!0}),e.enumerateFonts=function(t){return console.warn("`Font.enumerateFonts` not implement yet"),[]},e.registerFont=function(t){console.warn("`Font.registerFont` not implement yet")},e.prototype.hasGlyphs=function(t){return console.warn("`Font#hasGlyphs` not implement yet"),!1},e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),YN=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e.prototype,"styleNames",{get:function(){return console.log("styleNames not implemented yet in flash/Stylesheet"),[]},enumerable:!0,configurable:!0}),e.prototype.clear=function(){console.log("clear not implemented yet in flash/Stylesheet")},e.prototype.getStyle=function(t){return console.log("getStyle not implemented yet in flash/Stylesheet"),null},e.prototype.parseCSS=function(t){console.log("parseCSS not implemented yet in flash/Stylesheet")},e.prototype.setStyle=function(t,e){console.log("setStyle not implemented yet in flash/Stylesheet")},e.prototype.transform=function(t){return console.log("transform not implemented yet in flash/Stylesheet"),null},e}(gR),KN=function(t){function e(){var e=t.call(this)||this;return e._textFieldChangeListener={},e.adaptee.autoSize=mc.NONE,e.eventMappingDummys[LR.TEXT_INPUT]="TextField:TextEvent.TEXT_INPUT",e.eventMappingDummys[LR.LINK]="TextField:TextEvent.LINK",e.eventMappingDummys[pR.SCROLL]="TextField:Event.SCROLL",e.eventMappingDummys[pR.TEXT_INTERACTION_MODE_CHANGE]="TextField:Event.TEXT_INTERACTION_MODE_CHANGE",e._textChangeCallbackDelegate=function(t){return e.textChangeCallback(t)},e.adaptee.type==gc.INPUT&&e.adaptee.addEventListener(Oc.CHANGED,e._textChangeCallbackDelegate),e}return i(e,t),e.getNewTextField=function(t){if(void 0===t&&(t=null),e._textFields.length){var i=e._textFields.pop();return i.adaptee=t||sh.getNewTextField(),i}return new e},e.prototype.textChangeCallback=function(t){var e=new this.sec.flash.events.Event(pR.CHANGE);e.target=this,this.dispatchEvent(e,!1)},e.prototype.createAdaptee=function(){var t=sh.getNewTextField();return t.reset(),t},e.prototype.initAdapter=function(){},e.prototype.dispatchKeyEvent=function(t,e,i,n){},e.prototype.selectTextField=function(){},e.prototype.clone=function(){var t=RT(this._symbol,this._symbol.symbolClass),e=new sh;return this.adaptee.copyTo(e),t.adaptee=e,t._stage=this.activeStage,t.executeConstructor=function(){t.axInitializer()},t},e.prototype.dispose=function(){this.disposeValues(),e._textFields.push(this)},Object.defineProperty(e.prototype,"alwaysShowSelection",{get:function(){return this._adaptee.alwaysShowSelection},set:function(t){this._adaptee.alwaysShowSelection=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antiAliasType",{get:function(){return""},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoSize",{get:function(){return this._adaptee.autoSize},set:function(t){this._adaptee.autoSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._adaptee.background},set:function(t){this._adaptee.background=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._adaptee.backgroundColor},set:function(t){this._adaptee.backgroundColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"border",{get:function(){return this._adaptee.border},set:function(t){this._adaptee.border=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderColor",{get:function(){return this._adaptee.borderColor},set:function(t){this._adaptee.borderColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomScrollV",{get:function(){throw"bottomScrollV not implemented yet in flash/TextField"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"caretIndex",{get:function(){throw"caretIndex not implemented yet in flash/TextField"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"condenseWhite",{get:function(){throw"condenseWhite not implemented yet in flash/TextField"},set:function(t){throw"condenseWhite not implemented yet in flash/TextField"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultTextFormat",{get:function(){var t=this._adaptee.textFormat;return(t.adapter||t.adapter===t.adaptee)&&(t.adapter=new this.sec.flash.text.TextFormat,t.adapter.adaptee=t),t.adapter},set:function(t){this._adaptee.textFormat=t.adaptee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayAsPassword",{get:function(){return this._adaptee.displayAsPassword},set:function(t){this._adaptee.displayAsPassword=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"embedFonts",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridFitType",{get:function(){return""},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"htmlText",{get:function(){return this.adaptee.htmlText},set:function(t){this.adaptee.htmlText=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._adaptee.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxChars",{get:function(){return this.adaptee.maxChars},set:function(t){this.adaptee.maxChars=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollH",{get:function(){return this.adaptee.maxScrollH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollV",{get:function(){return this.adaptee.maxScrollV+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mouseWheelEnabled",{get:function(){return this.adaptee.mouseWheelEnabled},set:function(t){this.adaptee.mouseWheelEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiline",{get:function(){return this._adaptee.multiline},set:function(t){this._adaptee.multiline=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numLines",{get:function(){return this._adaptee.numLines},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restrict",{get:function(){return this.adaptee.restrict},set:function(t){this.adaptee.restrict=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollH",{get:function(){return this.adaptee.scrollH},set:function(t){this.adaptee.scrollH=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollV",{get:function(){return this.adaptee.scrollV+1},set:function(t){this.adaptee.scrollV=t-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectable",{get:function(){return this.adaptee.selectable},set:function(t){this._adaptee.selectable=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedText",{get:function(){return console.log("selectedText not implemented yet in flash/TextField"),""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionBeginIndex",{get:function(){return this.adaptee.selectionBeginIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEndIndex",{get:function(){return this.adaptee.selectionEndIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharpness",{get:function(){return console.log("sharpness not implemented yet in flash/TextField"),0},set:function(t){console.log("sharpness not implemented yet in flash/TextField")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styleSheet",{get:function(){return console.log("styleSheet not implemented yet in flash/TextField"),null},set:function(t){console.log("styleSheet not implemented yet in flash/TextField")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._adaptee.text},set:function(t){this._adaptee.text=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textColor",{get:function(){return this._adaptee.textColor},set:function(t){this._adaptee.textColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this._adaptee.textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textInteractionMode",{get:function(){return console.log("textInteractionMode not implemented yet in flash/TextField"),""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this._adaptee.textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thickness",{get:function(){return console.log("thickness not implemented yet in flash/TextField"),0},set:function(t){console.log("thickness not implemented yet in flash/TextField")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._adaptee.type},set:function(t){(t==gc.INPUT&&this._adaptee.type!=gc.INPUT||t!=gc.INPUT&&this._adaptee.type==gc.INPUT)&&this.adaptee.addEventListener(Oc.CHANGED,this._textChangeCallbackDelegate),this._adaptee.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useRichTextClipboard",{get:function(){return console.log("useRichTextClipboard not implemented yet in flash/TextField"),!1},set:function(t){console.log("useRichTextClipboard not implemented yet in flash/TextField")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wordWrap",{get:function(){return this._adaptee.wordWrap},set:function(t){this._adaptee.wordWrap=t},enumerable:!0,configurable:!0}),e.prototype.appendText=function(t){this._adaptee.appendText(t)},e.prototype.copyRichText=function(){return console.log("copyRichText not implemented yet in flash/TextField"),""},e.prototype.getCharBoundaries=function(t){return console.log("getCharBoundaries not implemented yet in flash/TextField"),null},e.prototype.getCharIndexAtPoint=function(t,e){return this._adaptee.getCharIndexAtPoint(t,e)},e.prototype.getFirstCharInParagraph=function(t){return this._adaptee.getFirstCharInParagraph(t)},e.prototype.getImageReference=function(t){return console.log("getImageReference not implemented yet in flash/TextField"),null},e.prototype.getLineIndexAtPoint=function(t,e){return this._adaptee.getLineIndexAtPoint(t,e)},e.prototype.getLineIndexOfChar=function(t){return this._adaptee.getLineIndexOfChar(t)},e.prototype.getLineLength=function(t){return this._adaptee.getLineLength(t)},e.prototype.getLineMetrics=function(t){var e=this._adaptee.getLineMetrics(t),i=e.x,n=e.width,r=e.height,o=e.ascent,s=e.descent,a=e.leading;return new this.sec.flash.text.TextLineMetrics(i,n,r,o,s,a)},e.prototype.getLineOffset=function(t){return this._adaptee.getLineOffset(t)},e.prototype.getLineText=function(t){return this._adaptee.getLineText(t)},e.prototype.getParagraphLength=function(t){return this._adaptee.getParagraphLength(t)},e.prototype.getRawText=function(){return console.log("getRawText not implemented yet in flash/TextField"),""},e.prototype.getTextFormat=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=-1);var i=this._adaptee.getTextFormat(t,e);if(i){if(i.adaptee!==i.adapter)return i.adapter;var n=new this.sec.flash.text.TextFormat;return n.adaptee=i,i.adapter=n,n}console.warn("[playerglobal/Textfield] - getTextFormat - textformat should not be null")},e.prototype.getTextRuns=function(t,e){return console.warn("getTextRuns not implemented yet in flash/TextField"),[]},e.prototype.getXMLText=function(t,e){return console.log("getXMLText not implemented yet in flash/TextField"),""},e.prototype.insertXMLText=function(t,e,i,n){console.log("insertXMLText not implemented yet in flash/TextField")},e.isFontCompatible=function(t,e){return console.log("isFontCompatible not implemented yet in flash/TextField"),!1},e.prototype.pasteRichText=function(t){return console.log("pasteRichText not implemented yet in flash/TextField"),!1},e.prototype.replaceSelectedText=function(t){return this._adaptee.replaceSelectedText(t)},e.prototype.replaceText=function(t,e,i){return this._adaptee.replaceText(t,e,i)},e.prototype.setSelection=function(t,e){return this._adaptee.setSelection(t,e)},e.prototype.setTextFormat=function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=-1),this._adaptee.setTextFormat(t.adaptee,e,i)},e._textFields=new Array,e}(xR),WN=function(t){function e(e,i,n,r,o,s,a,l,u,c,h,p,d){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===c&&(c=null),void 0===h&&(h=null),void 0===p&&(p=null),void 0===d&&(d=null);var f=t.call(this)||this;return f.adaptee=new Pc(e,i,n,r,o,s,a,l,u,c,h,p,d),f}return i(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return console.log("not implemented: TextFormat target"),null},set:function(t){console.log("not implemented: TextFormat target")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabStops",{get:function(){return console.log("not implemented: TextFormat tabStops"),null},set:function(t){console.log("not implemented: TextFormat tabStops")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"display",{get:function(){return console.log("not implemented: TextFormat display"),null},set:function(t){console.log("not implemented: TextFormat display")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bullet",{get:function(){return console.log("not implemented: TextFormat bullet"),null},set:function(t){console.log("not implemented: TextFormat bullet")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return console.log("not implemented: TextFormat url"),null},set:function(t){console.log("not implemented: TextFormat url")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"link_target",{get:function(){return console.log("not implemented: TextFormat link_target"),null},set:function(t){console.log("not implemented: TextFormat link_target")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this.adaptee.align},set:function(t){this.adaptee.align=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blockIndent",{get:function(){return this.adaptee.blockIndent},set:function(t){this.adaptee.blockIndent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.adaptee.leftMargin},set:function(t){this.adaptee.leftMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.adaptee.rightMargin},set:function(t){this.adaptee.rightMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indent",{get:function(){return this.adaptee.indent},set:function(t){this.adaptee.indent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this.adaptee.color},set:function(t){this.adaptee.color=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kerning",{get:function(){return this.adaptee.kerning},set:function(t){this.adaptee.kerning=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leading",{get:function(){return this.adaptee.leading},set:function(t){this.adaptee.leading=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this.adaptee.letterSpacing},set:function(t){this.adaptee.letterSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.adaptee.size},set:function(t){this.adaptee.size=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return this.adaptee.bold},set:function(t){this.adaptee.bold=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.adaptee.italic},set:function(t){this.adaptee.italic=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.adaptee.underline},set:function(t){this.adaptee.underline=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font_name",{get:function(){return this.adaptee.font_name},set:function(t){this.adaptee.font_name=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style_name",{get:function(){return this.adaptee.style_name},set:function(t){this.adaptee.style_name=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return this.adaptee.font_name},set:function(t){this.adaptee.font=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new this.sec.flash.text.TextFormat;return t.adaptee=this.adaptee.clone(),t},e}(bb),JN=function(t){function e(e,i,n){var r=t.call(this)||this;return r._beginIndex=0|e,r._endIndex=0|i,r._textFormat=n,console.warn("[TextRun] not implemented"),r}return i(e,t),Object.defineProperty(e.prototype,"beginIndex",{get:function(){return this._beginIndex},set:function(t){this._beginIndex=0|t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endIndex",{get:function(){return this._endIndex},set:function(t){this._endIndex=0|t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textFormat",{get:function(){return this._textFormat},set:function(t){this._textFormat=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.beginIndex,this.endIndex,this.textFormat.clone())},e.prototype.containsIndex=function(t){return t>=this._beginIndex&&t<this._endIndex},e.prototype.intersects=function(t,e){return Math.max(this._beginIndex,t)<Math.min(this._endIndex,e)},e.classInitializer=null,e}(bb),ZN=function(t){function e(){var e=t.call(this)||this;return console.warn("[StaticText] not impolemented"),e}return i(e,t),e.prototype.applySymbol=function(){console.warn("[StaticText] - applySymbol not impolemented")},e.prototype._canHaveTextContent=function(){return!0},e.prototype._getTextContent=function(){return this._textContent},Object.defineProperty(e.prototype,"text",{get:function(){return this._textContent.plainText},enumerable:!0,configurable:!0}),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(vR),$N=function(t){function e(){var e=t.call(this)||this;return console.warn("[TextRenderer] not implemented"),e}return i(e,t),Object.defineProperty(e.prototype,"antiAliasType",{get:function(){return console.warn("[TextRenderer] - get antiAliasType not implemented"),null},set:function(t){console.warn("[TextRenderer] - set antiAliasType not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxLevel",{get:function(){return console.warn("[TextRenderer] - get maxLevel not implemented"),0},set:function(t){console.warn("[TextRenderer] - set maxLevel not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayMode",{get:function(){return console.warn("[TextRenderer] - get displayMode not implemented"),null},set:function(t){console.warn("[TextRenderer] - set displayMode not implemented")},enumerable:!0,configurable:!0}),e.setAdvancedAntiAliasingTable=function(t,e,i,n){},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),tF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TextFormatDisplay] not implemented"),e}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.INLINE="inline",e.BLOCK="block",e}(bb),eF=function(t){function e(e,i,n,r,o,s){var a=t.call(this)||this;return a.width=+e,a.height=+i,a.textFieldWidth=+n,a.textFieldHeight=+r,a.ascent=+o,a.descent=+s,console.warn("[TextExtent] not implemented"),a}return i(e,t),e}(bb),iF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TextDisplayMode] not implemented"),e}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.LCD="lcd",e.CRT="crt",e.DEFAULT="default",e}(bb),nF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TextColorType] not implemented"),e}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.DARK_COLOR="dark",e.LIGHT_COLOR="light",e}(bb),rF=function(t){function e(){var e=t.call(this)||this;return console.warn("[FontType] not implemented"),e}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.EMBEDDED="embedded",e.EMBEDDED_CFF="embeddedCFF",e.DEVICE="device",e}(bb),oF=function(t){function e(e,i,n){var r=t.call(this)||this;return r.fontSize=+e,r.insideCutoff=+i,r.outsideCutoff=+n,console.warn("[CSMSettings] not implemented"),r}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),sF=function(t){function e(e,i,n,r,o,s){return t.call(this)||this}return i(e,t),e}(bb),aF=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e.prototype,"charCount",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.findText=function(t,e,i){},e.prototype.getSelected=function(t,e){},e.prototype.getSelectedText=function(t){},e.prototype.getText=function(t,e,i){},e.prototype.getTextRunInfo=function(t,e){},e.prototype.hitTestTextNearPos=function(t,e,i){},e.prototype.setSelectColor=function(t){},e.prototype.setSelected=function(t,e,i){},e.classInitializer=null,e}(bb),lF=function(t){function e(e,i,n,r){return t.call(this)||this}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),uF=function(t){function e(){var e=t.call(this)||this;return console.warn("[BreakOpportunity] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.AUTO="auto",e.ANY="any",e.NONE="none",e.ALL="all",e}(bb),cF=function(t){function e(){var e=t.call(this)||this;return console.warn("[CFFHinting] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.NONE="none",e.HORIZONTAL_STEM="horizontalStem",e}(bb),hF=function(t){function e(e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n="rotate0");var r=t.call(this)||this;return r._elementFormat=e,r._eventMirror=i,r._textRotation=Yv(n),r}return i(e,t),Object.defineProperty(e.prototype,"textBlock",{get:function(){return this._textBlock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textBlockBeginIndex",{get:function(){return console.warn("[ContentElement] - get textBlockBeginIndex not implemented"),this._textBlockBeginIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementFormat",{get:function(){return this._elementFormat},set:function(t){this._elementFormat=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventMirror",{get:function(){return this._eventMirror},set:function(t){this._eventMirror=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupElement",{get:function(){return this._groupElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rawText",{get:function(){return this._rawText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textRotation",{get:function(){return this._textRotation},set:function(t){this._textRotation=Yv(t)},enumerable:!0,configurable:!0}),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.GRAPHIC_ELEMENT=65007,e}(bb),pF=function(t){function e(){var e=t.call(this)||this;return console.warn("[DigitCase] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.DEFAULT="default",e.LINING="lining",e.OLD_STYLE="oldStyle",e}(bb),dF=function(t){function e(){var e=t.call(this)||this;return console.warn("[DigitWidth] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.DEFAULT="default",e.PROPORTIONAL="proportional",e.TABULAR="tabular",e}(bb),fF=function(t){function e(e,i){var n=t.call(this)||this;return n._locale=Yv(e),n._lineJustification=Yv(i),n}return i(e,t),e.getJustifierForLocale=function(t){return console.warn("[TextJustifier] - getJustifierForLocale not implemented"),null},e.prototype.clone=function(){return console.warn("[TextJustifier] - clone not implemented"),null},Object.defineProperty(e.prototype,"locale",{get:function(){return this._locale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineJustification",{get:function(){return this._lineJustification},set:function(t){this._lineJustification=Yv(t)},enumerable:!0,configurable:!0}),e.prototype.setLocale=function(t){this._locale=Yv(t)},e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(bb),_F=function(t){function e(e,i,n){var r;return r=t.call(this,void 0,void 0)||this,console.warn("[EastAsianJustifier] not implemented"),r}return i(e,t),Object.defineProperty(e.prototype,"justificationStyle",{get:function(){return console.warn("[EastAsianJustifier] - get justificationStyle not implemented"),null},set:function(t){console.warn("[EastAsianJustifier] - set justificationStyle not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"composeTrailingIdeographicSpaces",{get:function(){return console.warn("[EastAsianJustifier] - get composeTrailingIdeographicSpaces not implemented"),null},set:function(t){console.warn("[EastAsianJustifier] - set composeTrailingIdeographicSpaces not implemented")},enumerable:!0,configurable:!0}),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(fF),mF=function(t){function e(e,i,n,r,o,s,a,l,u,c,h,p,d,f,_,m,g){void 0===e&&(e=null),void 0===i&&(i=12),void 0===n&&(n=0),void 0===r&&(r=1),void 0===o&&(o="auto"),void 0===s&&(s="roman"),void 0===a&&(a="useDominantBaseline"),void 0===l&&(l=0),void 0===u&&(u="on"),void 0===c&&(c=0),void 0===h&&(h=0),void 0===p&&(p="en"),void 0===d&&(d="auto"),void 0===f&&(f="default"),void 0===_&&(_="default"),void 0===m&&(m="common"),void 0===g&&(g="default");var y=t.call(this)||this;return console.log("create ElementFormat",i,null==e?void 0:e.fontName),y._fontDescription=e,y._fontSize=+i,y._color=n>>>0,y._alpha=+r,y._textRotation=Yv(o),y._dominantBaseline=Yv(s),y._alignmentBaseline=Yv(a),y._baselineShift=+l,y._kerning=Yv(u),y._trackingRight=+c,y._trackingLeft=+h,y._locale=Yv(p),y._breakOpportunity=Yv(d),y._digitCase=Yv(f),y._digitWidth=Yv(_),y._ligatureLevel=Yv(m),y._typographicCase=Yv(g),y}return i(e,t),Object.defineProperty(e.prototype,"alignmentBaseline",{get:function(){return this._alignmentBaseline},set:function(t){this._alignmentBaseline=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineShift",{get:function(){return this._baselineShift},set:function(t){this._baselineShift=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"breakOpportunity",{get:function(){return this._breakOpportunity},set:function(t){this._breakOpportunity=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dominantBaseline",{get:function(){return this._dominantBaseline},set:function(t){this._dominantBaseline=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontDescription",{get:function(){return this._fontDescription},set:function(t){this._fontDescription=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"digitCase",{get:function(){return this._digitCase},set:function(t){this._digitCase=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"digitWidth",{get:function(){return this._digitWidth},set:function(t){this._digitWidth=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ligatureLevel",{get:function(){return this._ligatureLevel},set:function(t){this._ligatureLevel=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kerning",{get:function(){return this._kerning},set:function(t){this._kerning=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"locale",{get:function(){return this._locale},set:function(t){this._locale=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textRotation",{get:function(){return this._textRotation},set:function(t){this._textRotation=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trackingRight",{get:function(){return this._trackingRight},set:function(t){this._trackingRight=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trackingLeft",{get:function(){return this._trackingLeft},set:function(t){this._trackingLeft=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typographicCase",{get:function(){return this._typographicCase},set:function(t){this._typographicCase=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"locked",{get:function(){return this._locked},set:function(t){this._locked=t},enumerable:!0,configurable:!0}),e.prototype.getFontMetrics=function(){return console.warn("[ElementFormat] - getFontMetrics not implemented"),null},e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(bb),gF=function(t){function e(e,i,n,r,o,s){void 0===e&&(e="_serif"),void 0===i&&(i="normal"),void 0===n&&(n="normal"),void 0===r&&(r="device"),void 0===o&&(o="cff"),void 0===s&&(s="horizontalStem");var a=t.call(this)||this;return a._fontName=Yv(e),a._fontWeight=Yv(i),a._fontPosture=Yv(n),a._fontLookup=Yv(r),a._renderingMode=Yv(o),a._cffHinting=Yv(s),a}return i(e,t),e.isFontCompatible=function(t,e,i){return console.warn("[FontDescription] - isFontCompatible not implemented"),null},e.isDeviceFontCompatible=function(t,e,i){return console.warn("[FontDescription] - isDeviceFontCompatible not implemented"),null},Object.defineProperty(e.prototype,"renderingMode",{get:function(){return this._renderingMode},set:function(t){this._renderingMode=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontLookup",{get:function(){return this._fontLookup},set:function(t){this._fontLookup=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){this._fontName=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontPosture",{get:function(){return this._fontPosture},set:function(t){this._fontPosture=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cffHinting",{get:function(){return this._cffHinting},set:function(t){this._cffHinting=Yv(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"locked",{get:function(){return console.log("get FontDescription locked",this._locked),this._locked},set:function(t){console.log("set FontDescription locked",t),this._locked=t},enumerable:!0,configurable:!0}),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(bb),yF=function(t){function e(){var e=t.call(this)||this;return console.warn("[FontLookup] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.DEVICE="device",e.EMBEDDED_CFF="embeddedCFF",e}(bb),AF=function(t){function e(e,i,n,r,o,s,a,l,u,c){void 0===c&&(c=0);var h=t.call(this)||this;return h.emBox=e,h.strikethroughOffset=+i,h.strikethroughThickness=+n,h.underlineOffset=+r,h.underlineThickness=+o,h.subscriptOffset=+s,h.subscriptScale=+a,h.superscriptOffset=+l,h.superscriptScale=+u,h.lineGap=+c,console.warn("[FontMetrics] not implemented"),h}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(bb),vF=function(t){function e(){var e=t.call(this)||this;return console.warn("[FontPosture] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.NORMAL="normal",e.ITALIC="italic",e}(bb),bF=function(t){function e(){var e=t.call(this)||this;return console.warn("[FontWeight] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.NORMAL="normal",e.BOLD="bold",e}(bb),xF=function(t){function e(e,i,n,r,o,s){void 0===e&&(e=null),void 0===i&&(i=15),void 0===n&&(n=15),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s="rotate0");var a=t.call(this,void 0,void 0,void 0)||this;return a.graphic=e,a.elementWidth=+i,a.elementHeight=+n,a.elementFormat=r,a.eventMirror=o,a.textRotation=Yv(s),console.warn("[GraphicElement] not implemented"),a}return i(e,t),Object.defineProperty(e.prototype,"graphic",{get:function(){return console.warn("[GraphicElement] - get graphic not implemented"),null},set:function(t){console.warn("[GraphicElement] - set graphic not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementHeight",{get:function(){return console.warn("[GraphicElement] - get elementHeight not implemented"),null},set:function(t){console.warn("[GraphicElement] - set elementHeight not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementWidth",{get:function(){return console.warn("[GraphicElement] - get elementWidth not implemented"),null},set:function(t){console.warn("[GraphicElement] - set elementWidth not implemented")},enumerable:!0,configurable:!0}),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(hF),CF=function(t){function e(){var e=t.call(this)||this;return console.warn("[JustificationStyle] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.PUSH_IN_KINSOKU="pushInKinsoku",e.PUSH_OUT_ONLY="pushOutOnly",e.PRIORITIZE_LEAST_ADJUSTMENT="prioritizeLeastAdjustment",e}(bb),wF=function(t){function e(){var e=t.call(this)||this;return console.warn("[Kerning] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.ON="on",e.OFF="off",e.AUTO="auto",e}(bb),IF=function(t){function e(){var e=t.call(this)||this;return console.warn("[LigatureLevel] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.NONE="none",e.MINIMUM="minimum",e.COMMON="common",e.UNCOMMON="uncommon",e.EXOTIC="exotic",e}(bb),EF=function(t){function e(){var e=t.call(this)||this;return console.warn("[LineJustification] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.UNJUSTIFIED="unjustified",e.ALL_BUT_LAST="allButLast",e.ALL_INCLUDING_LAST="allIncludingLast",e.ALL_BUT_MANDATORY_BREAK="allButMandatoryBreak",e}(bb),SF=function(t){function e(){var e=t.call(this)||this;return console.warn("[RenderingMode] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.NORMAL="normal",e.CFF="cff",e}(bb),DF=function(t){function e(e,i,n){void 0===e&&(e="en"),void 0===i&&(i="unjustified"),void 0===n&&(n=!1);var r=t.call(this,e,i)||this;return r._letterSpacing=!!n,r}return i(e,t),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minimumSpacing",{get:function(){return this._minimumSpacing},set:function(t){this._minimumSpacing=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimumSpacing",{get:function(){return this._optimumSpacing},set:function(t){this._optimumSpacing=+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maximumSpacing",{get:function(){return this._maximumSpacing},set:function(t){this._maximumSpacing=+t},enumerable:!0,configurable:!0}),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(fF),TF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TabAlignment] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.START="start",e.CENTER="center",e.END="end",e.DECIMAL="decimal",e}(bb),PF=function(t){function e(e,i,n){var r;return r=t.call(this)||this,console.warn("[TabStop] not implemented"),r}return i(e,t),Object.defineProperty(e.prototype,"alignment",{get:function(){console.warn("[TabStop] - get alignment not implemented")},set:function(t){console.warn("[TabStop] - set alignment not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){console.warn("[TabStop] - get position not implemented")},set:function(t){console.warn("[TabStop] - set position not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"decimalAlignmentToken",{get:function(){console.warn("[TabStop] - get decimalAlignmentToken not implemented")},set:function(t){console.warn("[TabStop] - set decimalAlignmentToken not implemented")},enumerable:!0,configurable:!0}),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(bb),BF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TextBaseline] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.ROMAN="roman",e.ASCENT="ascent",e.DESCENT="descent",e.IDEOGRAPHIC_TOP="ideographicTop",e.IDEOGRAPHIC_CENTER="ideographicCenter",e.IDEOGRAPHIC_BOTTOM="ideographicBottom",e.USE_DOMINANT_BASELINE="useDominantBaseline",e}(bb),MF=function(t){function e(e,i,n,r,o,s,a,l,u){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r="rotate0"),void 0===o&&(o="roman"),void 0===s&&(s=0),void 0===a&&(a=!0),void 0===l&&(l=null),void 0===u&&(u=12);var c=t.call(this)||this;return c._content=e,c._tabStops=i,c._textJustifier=n,c._lineRotation=r,c._baselineZero=o,c._bidiLevel=s,c._applyNonLinearFontScaling=a,c._baselineFontDescription=l,c._baselineFontSize=u,c._textLines=[],c}return i(e,t),e.prototype.createTextLine=function(t,e,i,n){var r=new this.sec.flash.text.engine.TextLine(t,e,i,n,this._content.text,this._content._elementFormat);return r.setTextBlock(this),this._textLines.push(r),r},e.prototype.recreateTextLine=function(t,e,i,n,r){return console.warn("[TextBlock] - recreateTextLine not implemented"),new this.sec.flash.text.engine.TextLine},Object.defineProperty(e.prototype,"applyNonLinearFontScaling",{get:function(){return this._applyNonLinearFontScaling},set:function(t){this._applyNonLinearFontScaling=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineFontDescription",{get:function(){return this._baselineFontDescription},set:function(t){this._baselineFontDescription=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineFontSize",{get:function(){return this._baselineFontSize},set:function(t){this._baselineFontSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineZero",{get:function(){return this._baselineZero},set:function(t){this._baselineZero=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},set:function(t){this._content=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidiLevel",{get:function(){return this._bidiLevel},set:function(t){this._bidiLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstInvalidLine",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLine",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastLine",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textLineCreationResult",{get:function(){return console.warn("[TextBlock] - get textLineCreationResult not implemented"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineRotation",{get:function(){return this._lineRotation},set:function(t){this._lineRotation=t},enumerable:!0,configurable:!0}),e.prototype.findNextAtomBoundary=function(t){return console.warn("[TextBlock] - findNextAtomBoundary not implemented"),null},e.prototype.findPreviousAtomBoundary=function(t){return console.warn("[TextBlock] - findPreviousAtomBoundary not implemented"),null},e.prototype.findNextWordBoundary=function(t){return console.warn("[TextBlock] - findNextWordBoundary not implemented"),null},e.prototype.findPreviousWordBoundary=function(t){return console.warn("[TextBlock] - findPreviousWordBoundary not implemented"),null},e.prototype.getTextLineAtCharIndex=function(t){return console.warn("[TextBlock] - getTextLineAtCharIndex not implemented"),null},e.prototype.releaseLineCreationData=function(){console.warn("[TextBlock] - releaseLineCreationData not implemented")},e.prototype.releaseLines=function(t,e){this._textLines.length=0},e.prototype.dump=function(){return console.warn("[TextBlock] - dump not implemented"),null},e.prototype.DoCreateTextLine=function(t,e,i,n,r){return console.warn("[TextBlock] - DoCreateTextLine not implemented"),null},e.prototype.getTabStops=function(){return this._tabStops},e.prototype.setTabStops=function(t){this._tabStops=t},e.prototype.getTextJustifier=function(){return this._textJustifier},e.prototype.setTextJustifier=function(t){this._textJustifier=t},Object.defineProperty(e.prototype,"userData",{get:function(){return this._userData},set:function(t){this._userData=t},enumerable:!0,configurable:!0}),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(bb),OF=function(t){function e(e,i,n,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r="rotate0");var o=t.call(this,i,n,r)||this;return o._text=e,console.warn("[TextElement]",i),o}return i(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t},enumerable:!0,configurable:!0}),e.prototype.replaceText=function(t,e,i){this._rawText=this._text.slice(0,t)+i+this._text.slice(e,this._text.length-1),this._text=this._rawText},e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(hF),LF=function(t){function e(e,i,n,r,o,s){var a=t.call(this)||this,l=new Fa;return a.adaptee=l,a._textfield=new sh,a._textfield.autoSize=mc.LEFT,l.addChild(a._textfield),a._textfield.text=o,a._previousLine=e,e&&e.setNextLine(a),console.log("elementFormat",s),a._text=o,a._textBlockBeginIndex=0,a._rawTextLength=o.length,a._specifiedWidth=i,a}return i(e,t),e.prototype.setNextLine=function(t){this._nextLine=t},e.prototype.setTextBlock=function(t){this._textBlock=t},e.prototype.getMirrorRegion=function(t){return console.warn("[TextLine] - get textBlock not implemented"),null},e.prototype.flushAtomData=function(){console.warn("[TextLine] - get flushAtomData not implemented")},Object.defineProperty(e.prototype,"textBlock",{get:function(){return this._textBlock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasGraphicElement",{get:function(){return console.warn("[TextLine] - get hasGraphicElement not implemented",this._text),!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasTabs",{get:function(){return console.warn("[TextLine] - get hasTabs not implemented"),this._hasTabs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLine",{get:function(){return this._nextLine},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousLine",{get:function(){return this._previousLine},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ascent",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descent",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this._textfield.textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return 100},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalAscent",{get:function(){return console.warn("[TextLine] - get totalAscent not implemented"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalDescent",{get:function(){return console.warn("[TextLine] - get totalDescent not implemented"),0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalHeight",{get:function(){return console.warn("[TextLine] - get totalHeight not implemented"),100},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textBlockBeginIndex",{get:function(){return this._textBlockBeginIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rawTextLength",{get:function(){return this._rawTextLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specifiedWidth",{get:function(){return this._specifiedWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unjustifiedTextWidth",{get:function(){return console.warn("[TextLine] - get unjustifiedTextWidth not implemented"),this._unjustifiedTextWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"validity",{get:function(){return this._validity},set:function(t){this._validity=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"atomCount",{get:function(){return console.warn("[TextLine] - get atomCount not implemented"),this._atomCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mirrorRegions",{get:function(){return console.warn("[TextLine] - get mirrorRegions not implemented"),this._mirrorRegions},enumerable:!0,configurable:!0}),e.prototype.getAtomIndexAtPoint=function(t,e){return console.warn("[TextLine] - getAtomIndexAtPoint not implemented"),null},e.prototype.getAtomIndexAtCharIndex=function(t){return console.warn("[TextLine] - getAtomIndexAtCharIndex not implemented"),null},e.prototype.getAtomBounds=function(t){return console.warn("[TextLine] - getAtomBounds not implemented"),null},e.prototype.getAtomBidiLevel=function(t){return console.warn("[TextLine] - getAtomBidiLevel not implemented"),null},e.prototype.getAtomTextRotation=function(t){return console.warn("[TextLine] - getAtomTextRotation not implemented"),null},e.prototype.getAtomTextBlockBeginIndex=function(t){return console.warn("[TextLine] - getAtomTextBlockBeginIndex not implemented"),null},e.prototype.getAtomTextBlockEndIndex=function(t){return console.warn("[TextLine] - getAtomTextBlockEndIndex not implemented"),null},e.prototype.getAtomCenter=function(t){return console.warn("[TextLine] - getAtomCenter not implemented"),null},e.prototype.getAtomWordBoundaryOnLeft=function(t){return console.warn("[TextLine] - getAtomWordBoundaryOnLeft not implemented"),null},e.prototype.getAtomGraphic=function(t){return console.warn("[TextLine] - getAtomGraphic not implemented"),null},e.prototype.getBaselinePosition=function(t){return 0},e.prototype.dump=function(){return console.warn("[TextLine] - dump not implemented"),null},e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.MAX_LINE_WIDTH=1e6,e}(CR),RF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TextLineCreationResult] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.SUCCESS="success",e.EMERGENCY="emergency",e.COMPLETE="complete",e.INSUFFICIENT_WIDTH="insufficientWidth",e}(bb),NF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TextLineMirrorRegion] not implemented"),e}return i(e,t),Object.defineProperty(e.prototype,"textLine",{get:function(){return console.warn("[TextLineMirrorRegion] - get textLine not implemented"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextRegion",{get:function(){return console.warn("[TextLineMirrorRegion] - get nextRegion not implemented"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousRegion",{get:function(){return console.warn("[TextLineMirrorRegion] - get previousRegion not implemented"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mirror",{get:function(){return console.warn("[TextLineMirrorRegion] - get mirror not implemented"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return console.warn("[TextLineMirrorRegion] - get element not implemented"),null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return console.warn("[TextLineMirrorRegion] - get bounds not implemented"),null},enumerable:!0,configurable:!0}),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(bb),FF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TextLineValidity] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.VALID="valid",e.POSSIBLY_INVALID="possiblyInvalid",e.INVALID="invalid",e.STATIC="static",e}(bb),kF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TextRotation] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.ROTATE_0="rotate0",e.ROTATE_90="rotate90",e.ROTATE_180="rotate180",e.ROTATE_270="rotate270",e.AUTO="auto",e}(bb),VF=function(t){function e(){var e=t.call(this)||this;return console.warn("[TypographicCase] not implemented"),e}return i(e,t),e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e.DEFAULT="default",e.TITLE="title",e.CAPS="caps",e.SMALL_CAPS="smallCaps",e.UPPERCASE="uppercase",e.LOWERCASE="lowercase",e.CAPS_AND_SMALL_CAPS="capsAndSmallCaps",e}(bb),UF=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e,"capsLock",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numLock",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasVirtualKeyboard",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e,"physicalKeyboardType",{get:function(){},enumerable:!0,configurable:!0}),e.isAccessible=function(){},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),jF=function(t){function e(){return t.call(this)||this}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(gR),GF=function(t){function e(){var e=t.call(this)||this;return e._builtInItems=new e.sec.flash.ui.ContextMenuBuiltInItems,e._customItems=[],e}return i(e,t),Object.defineProperty(e,"isSupported",{get:function(){return e.constructor.name,!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"builtInItems",{get:function(){return this._builtInItems},set:function(t){t=t,this._builtInItems=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"customItems",{get:function(){return this.sec.createArrayUnsafe(this._customItems)},set:function(t){t=t,this._customItems=t.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"link",{get:function(){return this._link},set:function(t){t=t,this._link=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clipboardMenu",{get:function(){return this._clipboardMenu},set:function(t){t=!!t,this._clipboardMenu=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clipboardItems",{get:function(){return this._clipboardItems},set:function(t){t=t,this._clipboardItems=t},enumerable:!0,configurable:!0}),e.prototype.hideBuiltInItems=function(){var t=this.builtInItems;t&&(t.save=!1,t.zoom=!1,t.quality=!1,t.play=!1,t.loop=!1,t.rewind=!1,t.forwardAndBack=!1,t.print=!1)},e.prototype.clone=function(){var t=new this.sec.flash.ui.ContextMenu;t._builtInItems=this._builtInItems.clone(),this.cloneLinkAndClipboardProperties(t);for(var e=this._customItems,i=0;i<e.length;i++)t._customItems.push(e[i].clone());return t},e.prototype.cloneLinkAndClipboardProperties=function(t){},e.classInitializer=null,e}(jF),QF=function(t){function e(e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!0),void 0===r&&(r=!0);var o=t.call(this)||this;return e=Yv(e),i=!!i,n=!!n,r=!!r,o._caption=e||"",o._separatorBefore=i,o._enabled=n,o._visible=r,o}return i(e,t),Object.defineProperty(e.prototype,"caption",{get:function(){return this._caption},set:function(t){t=Yv(t),this._caption=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"separatorBefore",{get:function(){return this._separatorBefore},set:function(t){t=!!t,this._separatorBefore=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(t){t=!!t,this._visible=t},enumerable:!0,configurable:!0}),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(XR),zF=function(t){function e(){var e=t.call(this)||this;return e._save=!0,e._zoom=!0,e._quality=!0,e._play=!0,e._loop=!0,e._rewind=!0,e._forwardAndBack=!0,e._print=!0,e}return i(e,t),Object.defineProperty(e.prototype,"save",{get:function(){return this._save},set:function(t){this._save=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},set:function(t){this._zoom=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"play",{get:function(){return this._play},set:function(t){this._play=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rewind",{get:function(){return this._rewind},set:function(t){this._rewind=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forwardAndBack",{get:function(){return this._forwardAndBack},set:function(t){this._forwardAndBack=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"print",{get:function(){return this._print},set:function(t){this._print=!!t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t._save=this._save,t._zoom=this._zoom,t._quality=this._quality,t._play=this._play,t._loop=this._loop,t._rewind=this._rewind,t._forwardAndBack=this._forwardAndBack,t._print=this._print,t},e.classInitializer=null,e}(bb),HF=function(t){function e(){var e=t.call(this)||this;return e._cut=!0,e._copy=!0,e._paste=!0,e._clear=!0,e._selectAll=!0,e}return i(e,t),Object.defineProperty(e.prototype,"cut",{get:function(){return this._cut},set:function(t){this._cut=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"copy",{get:function(){return this._copy},set:function(t){this._copy=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paste",{get:function(){return this._paste},set:function(t){this._paste=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clear",{get:function(){return this._clear},set:function(t){this._clear=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectAll",{get:function(){return this._selectAll},set:function(t){this._selectAll=!!t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t._cut=this._cut,t._copy=this._copy,t._paste=this._paste,t._clear=this._clear,t._selectAll=this._selectAll,t},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(bb),XF=function(t){function e(){return t.call(this,void 0)||this}return i(e,t),Object.defineProperty(e,"numDevices",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isSupported",{get:function(){return!1},enumerable:!0,configurable:!0}),e.getDeviceAt=function(t){return this.sec.throwError("RangeError",db.ParamRangeError,"index"),null},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(gR),qF=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e.prototype,"numValues",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relative",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hand",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"finger",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"device",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.getValueAt=function(t){},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e}(gR),YF=function(t){function e(){return t.call(this)||this}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.MOVEMENT="movement",e.ROTATION="rotation",e.DIRECTION="direction",e.ACCELERATION="acceleration",e.BUTTON="button",e.TRIGGER="trigger",e}(bb),KF=function(t){function e(){return t.call(this)||this}return i(e,t),Object.defineProperty(e.prototype,"numControls",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sampleInterval",{get:function(){},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.getControlAt=function(t){},e.prototype.startCachingSamples=function(t,e){},e.prototype.stopCachingSamples=function(){},e.prototype.getCachedSamples=function(t,e){},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.MAX_BUFFER_SIZE=4800,e}(gR),WF=function(t){function e(){return t.call(this)||this}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.THUMB="thumb",e.INDEX="index",e.MIDDLE="middle",e.UNKNOWN="unknown",e}(bb),JF=function(t){function e(){return t.call(this)||this}return i(e,t),e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.RIGHT="right",e.LEFT="left",e.UNKNOWN="unknown",e}(bb),ZF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e,"cursor",{get:function(){return e._cursor},set:function(t){e._cursor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"supportsCursor",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"supportsNativeCursor",{get:function(){return!0},enumerable:!0,configurable:!0}),e.hide=function(){},e.show=function(){},e.registerCursor=function(t,e){},e.unregisterCursor=function(t){},e}(bb),$F=function(){function t(){}return t.GESTURE="gesture",t.NONE="none",t.TOUCH_POINT="touchPoint",t}(),tk=function(){function t(){}return Object.defineProperty(t,"inputMode",{get:function(){return""},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t,"mapTouchToMouse",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t,"maxTouchPoints",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"supportedGestures",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"supportsGestureEvents",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"supportsTouchEvents",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(),ek=function(t){function e(e,i){var n=t.call(this)||this;return n._delay=+e,n._repeatCount=0|i,n._iteration=0,n}return i(e,t),Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},set:function(t){((t=+t)<0||!isFinite(t))&&this.sec.throwError("RangeError",db.DelayRangeError),this._delay=t,this._running&&(this.stop(),this.start())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(t){this._repeatCount=0|t,this._repeatCount&&this._running&&this._iteration>=this._repeatCount&&this.stop()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentCount",{get:function(){return this._iteration},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._running&&this.stop(),this._iteration=0},e.prototype.stop=function(){this._running=!1,window.clearInterval(this._interval)},e.prototype.start=function(){this._running||(this._running=!0,this._interval=window.setInterval(this._tick.bind(this),this._delay))},e.prototype._tick=function(){if(this._iteration++,this._running){if(e.dispatchingEnabled)try{this.dispatchEvent(new this.sec.flash.events.TimerEvent("timer",!0,!1))}catch(t){}if(0!==this._repeatCount&&this._iteration>=this._repeatCount){this.stop();try{this.dispatchEvent(new this.sec.flash.events.TimerEvent(oN.TIMER_COMPLETE,!1,!1))}catch(t){}}}},e.classInitializer=null,e.classSymbols=null,e.instanceSymbols=null,e.dispatchingEnabled=!0,e}(gR),ik=function(t){function e(e,i,n,r){var o=t.call(this,void 0,void 0,void 0)||this;return console.warn("[GroupElement] not implemented"),o}return i(e,t),Object.defineProperty(e.prototype,"elementCount",{get:function(){return console.warn("[GroupElement] - elementCount not implemented"),0},enumerable:!0,configurable:!0}),e.prototype.getElementAt=function(t){return console.warn("[GroupElement] - getElementAt not implemented"),null},e.prototype.setElements=function(t){console.warn("[GroupElement] - setElements not implemented")},e.prototype.groupElements=function(t,e){return console.warn("[GroupElement] - groupElements not implemented"),null},e.prototype.ungroupElements=function(t){console.warn("[GroupElement] - ungroupElements not implemented")},e.prototype.mergeTextElements=function(t,e){return console.warn("[GroupElement] - mergeTextElements not implemented"),null},e.prototype.splitTextElement=function(t,e){return console.warn("[GroupElement] - splitTextElement not implemented"),null},e.prototype.replaceElements=function(t,e,i){return console.warn("[GroupElement] - replaceElements not implemented"),null},e.prototype.getElementAtCharIndex=function(t){return console.warn("[GroupElement] - getElementAtCharIndex not implemented"),null},e.forceNativeConstructor=!0,e.forceNativeMethods=!0,e}(hF),nk=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.checkNamespace=function(t){var e=t.$Bgnamespace();if(this._textFlowNamespace){if(e.uri!=this._textFlowNamespace.uri)return!1}else{if(e.uri!=this.$Bgns.uri)return!1;this._textFlowNamespace=e}return!0},e.forceNativeConstructor=!1,e.forceNativeMethods=!0,e}(bb);!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}i(e,t),Object.defineProperty(e.prototype,"text",{set:function(t){console.log("set text native",t)},enumerable:!0,configurable:!0}),e.forceNativeConstructor=!1,e.forceNativeMethods=!0}(bb);function rk(t,e){MT(t,e)}var ok=function(){},sk=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.flash={display:{EventDispatcher:gR,DisplayObject:vR,DisplayObjectContainer:CR,Stage:VR,Loader:OR,LoaderInfo:kR,MovieClip:IR,Graphics:HR,Bitmap:ER,BitmapData:SR,SimpleButton:YR,Sprite:wR,Shape:wR,FrameLabel:zR},events:{EventDispatcher:gR,Event:pR,KeyboardEvent:bR,MouseEvent:mR,ProgressEvent:FR,IOErrorEvent:NR,TimerEvent:oN},external:{ExternalInterface:cN},filters:{BevelFiler:mN,BitmapFilter:dN,BlurFilter:gN,ColorMatrixFilter:yN,ConvolutionFilter:AN,DisplacementMapFilter:vN,DropShadowFilter:bN,GlowFilter:xN,GradientBevelFilter:CN,GradientGlowFilter:wN},text:{TextField:KN,TextFormat:WN,TextSnapshot:aF,TextLineMetrics:sF},geom:{Point:$R,Rectangle:tN,Matrix:WR,ColorTransform:KR,Transform:eN,Vector3D:iN,Matrix3D:ZR},net:{URLRequest:jR,URLLoader:ON,URLVariables:UR,SharedObject:MN},system:{ApplicationDomain:BR,Capabilities:QN,LoaderContext:MR,Security:HN,fscommand:zN},ui:{ContextMenu:GF,ContextMenuItem:QF,ContextMenuBuiltInItems:zF,Mouse:ok},utils:{ByteArray:GD},media:{Sound:PR,SoundChannel:IN,SoundTransform:EN,SoundMixer:SN},xml:{XMLDocument:XMLDocument,XMLNode:IT}},e}return i(e,t),e}(LL),ak=function(){function t(){}return Object.defineProperty(t.prototype,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0}),t.prototype.createSecurityDomain=function(t,e,i){var n=this;this._avmStage=t,this._avmStage.avmTestHandler&&(JL.print=function(e,i){var n,r,o="";if(2==arguments.length)o=null===(n=arguments[1])||void 0===n?void 0:n.toString();else for(var s=1;s<arguments.length;s++)o+=null===(r=arguments[s])||void 0===r?void 0:r.toString(),s!==arguments.length-1&&(o+=" ");var a=o.split("\n");for(s=0;s<a.length;s++)console.log("%c Test-Trace from SWF:","color: DodgerBlue",a[s]),t.avmTestHandler.addMessage(a[s])}),rk("flashx.textLayout.conversion.BaseTextLayoutImporter",nk),rk("flash.desktop.Clipboard",GR),rk("flash.desktop.ClipboardFormats",QR),rk("flash.display.Bitmap",ER),rk("flash.display.BitmapData",SR),rk("flash.display.BlendMode",fn),rk("flash.display.DisplayObject",vR),rk("flash.display.DisplayObjectContainer",CR),rk("flash.display.FrameLabel",zR),rk("flash.display.Graphics",HR),rk("flash.display.InteractiveObject",xR),rk("flash.display.Loader",OR),rk("flash.display.LoaderInfo",kR),rk("flash.display.MovieClip",IR),rk("flash.display.NativeMenuItem",XR),rk("flash.display.Scene",qR),rk("flash.display.Shape",wR),rk("flash.display.SimpleButton",YR),rk("flash.display.Sprite",wR),rk("flash.display.Stage",VR),rk("flash.events.ErrorEvent",RR),rk("flash.events.Event",pR),rk("flash.events.EventDispatcher",gR),rk("flash.events.GameInputEvent",aN),rk("flash.events.HTTPStatusEvent",uN),rk("flash.events.IOErrorEvent",NR),rk("flash.events.KeyboardEvent",bR),rk("flash.events.MouseEvent",mR),rk("flash.events.NetStatusEvent",lN),rk("flash.events.ProgressEvent",FR),rk("flash.events.TextEvent",LR),rk("flash.events.TimerEvent",oN),rk("flash.events.TouchEvent",sN),rk("flash.external.ExternalInterface",cN),rk("flash.filters.BevelFilter",mN),rk("flash.filters.BitmapFilter",dN),rk("flash.filters.BlurFilter",gN),rk("flash.filters.ColorMatrixFilter",yN),rk("flash.filters.ConvolutionFilter",AN),rk("flash.filters.DisplacementMapFilter",vN),rk("flash.filters.DropShadowFilter",bN),rk("flash.filters.GlowFilter",xN),rk("flash.filters.GradientBevelFilter",CN),rk("flash.filters.GradientGlowFilter",wN),rk("flash.geom.ColorTransform",KR),rk("flash.geom.Matrix",WR),rk("flash.geom.Matrix3D",ZR),rk("flash.geom.Point",$R),rk("flash.geom.Rectangle",tN),rk("flash.geom.Transform",eN),rk("flash.geom.Vector3D",iN),rk("flash.globalization.LocaleID",rN),rk("flash.media.Sound",PR),rk("flash.media.SoundChannel",IN),rk("flash.media.SoundMixer",SN),rk("flash.media.SoundTransform",EN),rk("flash.net.LocalConnection",NN),rk("flash.net.SharedObject",MN),rk("flash.net.URLLoader",ON),rk("flash.net.URLRequest",jR),rk("flash.net.URLVariables",UR),rk("flash.system.ApplicationDomain",BR),rk("flash.system.Capabilities",QN),rk("flash.system.LoaderContext",MR),rk("flash.system.Security",HN),rk("flash.system.SecurityDomain",FN),rk("flash.system.System",XN),rk("flash.text.CSMSettings",oF),rk("flash.text.Font",qN),rk("flash.text.FontType",rF),rk("flash.text.StaticText",ZN),rk("flash.text.StyleSheet",YN),rk("flash.text.TextColorType",nF),rk("flash.text.TextDisplayMode",iF),rk("flash.text.TextField",KN),rk("flash.text.TextFormat",WN),rk("flash.text.TextLineMetrics",sF),rk("flash.text.TextRenderer",$N),rk("flash.text.TextSnapshot",aF),rk("flash.text.TextFormatDisplay",tF),rk("flash.text.TextExtent",eF),rk("flash.text.TextRun",JN),rk("flash.text.engine.BreakOpportunity",uF),rk("flash.text.engine.CFFHinting",cF),rk("flash.text.engine.ContentElement",hF),rk("flash.text.engine.DigitCase",pF),rk("flash.text.engine.DigitWidth",dF),rk("flash.text.engine.EastAsianJustifier",_F),rk("flash.text.engine.ElementFormat",mF),rk("flash.text.engine.FontDescription",gF),rk("flash.text.engine.FontLookup",yF),rk("flash.text.engine.FontMetrics",AF),rk("flash.text.engine.FontMetrics",AF),rk("flash.text.engine.FontPosture",vF),rk("flash.text.engine.FontWeight",bF),rk("flash.text.engine.GraphicElement",xF),rk("flash.text.engine.GroupElement",ik),rk("flash.text.engine.JustificationStyle",CF),rk("flash.text.engine.Kerning",wF),rk("flash.text.engine.LigatureLevel",IF),rk("flash.text.engine.LineJustification",EF),rk("flash.text.engine.RenderingMode",SF),rk("flash.text.engine.SpaceJustifier",DF),rk("flash.text.engine.TabAlignment",TF),rk("flash.text.engine.TabStop",PF),rk("flash.text.engine.TextBaseline",BF),rk("flash.text.engine.TextBlock",MF),rk("flash.text.engine.TextElement",OF),rk("flash.text.engine.TextJustifier",fF),rk("flash.text.engine.TextLine",LF),rk("flash.text.engine.TextLineCreationResult",RF),rk("flash.text.engine.TextLineMirrorRegion",NF),rk("flash.text.engine.TextLineValidity",FF),rk("flash.text.engine.TextRotation",kF),rk("flash.text.engine.TypographicCase",VF),rk("flash.text.ime.CompositionAttributeRange",lF),rk("flash.ui.ContextMenu",GF),rk("flash.ui.ContextMenuBuiltInItems",zF),rk("flash.ui.ContextMenuClipboardItems",HF),rk("flash.ui.ContextMenuItem",QF),rk("flash.ui.GameInput",XF),rk("flash.ui.GameInputControl",qF),rk("flash.ui.GameInputControlType",YF),rk("flash.ui.GameInputDevice",KF),rk("flash.ui.GameInputFinger",WF),rk("flash.ui.GameInputHand",JF),rk("flash.ui.Keyboard",UF),rk("flash.ui.Mouse",ZF),rk("flash.ui.Multitouch",tk),rk("flash.ui.MultitouchInputMode",$F),rk("flash.utils.Timer",ek),rk("flash.xml.XMLDocument",ET),rk("flash.xml.XMLNode",IT),OT("flash.system.fscommand",zN),cN.ensureInitialized();var r=new Kh;return lk.getInstance().load("./assets/builtins/builtin.abc","arraybuffer").then((function(o){var s=new sk,a={url:"builtin.abc",app:s.system},l=new lR(a,new Uint8Array(o));if(s.swfVersion=e.swfVersion,s.system.loadABC(l),s.initialize(),s.system.executeABC(l),s.player=t,i&uR.Playerglobal)return Promise.all([lk.getInstance().load("./assets/builtins/playerglobal.abcs","arraybuffer"),lk.getInstance().load("./assets/builtins/playerglobal.json","json")]).then((function(t){var i=new cR(s.system,new Uint8Array(t[0]),t[1]);s.addCatalog(i),lk.getInstance().load("./assets/builtins/avmplus.abc","arraybuffer").then((function(t){var e={url:"avmplus.File",app:s.system},i=new lR(e,new Uint8Array(t));s.system.loadABC(i),s.system.executeABC(i)}),r.reject).then((function(){n._contentLoaderInfo=new s.flash.display.LoaderInfo(n,n._avmStage.root),n._contentLoaderInfo.url=e.url,n._applicationDomain=new s.flash.system.ApplicationDomain;var t=new s.flash.system.LoaderContext(!1,n._applicationDomain);pL.loaderContext=t,n._stage=new s.flash.display.Stage,s.flash.display.DisplayObject.axClass._activeStage=n._stage,n._avmStage.root.adapter=n._stage,n._stage.adaptee=n._avmStage.root,r.resolve(new DR(s))}),r.reject)}),r.reject);r.resolve(null)}),r.reject),r.promise},t.prototype.enterFrame=function(){this._stage&&this._stage.enterFrame()},t.prototype.resizeStage=function(){this._stage&&this._stage.resizeCallback()},t.prototype.addAsset=function(t,e){switch(t.adapter.loaderInfo=this._contentLoaderInfo,t.assetType){case sh.assetType:this._applicationDomain.addDefinition(t.name,t);break;case mh.assetType:case hn.assetType:this._applicationDomain.addDefinition(t.name,t);break;case x.assetType:this._applicationDomain.addAudioDefinition(t.name,t);break;case Cc.assetType:this._applicationDomain.addFontDefinition(t.name,t);break;case ka.assetType:this._applicationDomain.addDefinition(t.name,t);break;case il.assetType:this._applicationDomain.addDefinition(t.name,t),e&&t.isAVMScene&&(this._content=t.adapter.clone(),this._content.loaderInfo=this._contentLoaderInfo,this._content.adaptee.reset(),this._content.adaptee.firstFrameOnSWFStart=!0,el.invalidAS3Constructors=!0,this._stage.adaptee.addChild(this._content.adaptee),el.execute_as3_constructors_recursiv(this._content.adaptee),this._content.dispatchStaticEvent("added",this._content),this._content.dispatch_ADDED_TO_STAGE(!0));break;case"[asset Generic]":this._applicationDomain.addDefinition(t.name,t);break;case Sa.assetType:case Va.assetType:break;default:console.warn("Loaded unhandled asset-type",t.assetType)}},t}(),lk=function(){function t(){}return t.getInstance=function(){return t._instance?t._instance:t._instance=new t},t.prototype.load=function(t,e){return this._promiseFile(t,e)},t.prototype._promiseFile=function(t,e){return new Promise((function(i,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType=e,r.onload=function(){var o=r.response;o?("json"===e&&"json"!==r.responseType&&(o=JSON.parse(o)),i(o)):n("Unable to load "+t+": "+r.statusText)},r.onerror=function(){n("Unable to load: xhr error")},r.send()}))},t}();function uk(t){var e=Object.assign({},t);return Object.keys(e).forEach((function(t){"object"==typeof e[t]?e[t]=uk(e[t]):"function"==typeof e[t]&&(e[t]=e[t].toString())})),e}console.debug("AwayFL - PlayerGlobal - 0.2.161");var ck=["id","visible","index","assetType:type","name"],hk=function(){function t(t){this.player=t,dp(this._dirObjectByIds.bind(this),{name:"dirObjectByIds",description:"Export selected object to console",declaration:[{name:"ids",type:"object"}]}),dp(this._applyPropsByIds.bind(this),{name:"applyPropsByIds",description:"Apply propertyes by node ids",declaration:[{name:"ids",type:"object"},{name:"object",type:"object"}]}),dp(this._removeObjectByIds.bind(this),{name:"removeObjectByIds",description:"Remove object from sceen tree",declaration:[{name:"ids",type:"object"}]}),dp(this._getInfo.bind(this),{name:"getInfo",description:"Get file info for app",declaration:[{name:"return",type:"object"}]}),dp(this._getSceneTree.bind(this),{name:"getNodeTree",description:"Get sceen tree of app",declaration:[{name:"return",type:"object"},{name:"flat",type:"boolean"},{name:"from",type:"number"},{name:"rect",type:"object"}]}),dp(this._getStageCanvas.bind(this),{name:"getStageCanvas",description:"Get canvas attahed to stage",declaration:[]}),window._AWAY_DEBUG_PLAYER_=this}return t.prototype.onAvmInit=function(t){window._AWAY_DEBUG_STORAGE=1===t?k_:PN},t.prototype._selectNode=function(t){for(var e=this.player.root,i=function(t){if(!(e=e._children.find((function(e){return e.id===t}))))return"break"},n=0,r=t;n<r.length;n++){if("break"===i(r[n]))break}if(!e)throw new Error("Node not found");return e},t.prototype._getStageCanvas=function(){return this.player.view.stage.container},t.prototype._dirObjectByIds=function(t){console.dir(this._selectNode(t))},t.prototype._getNodeBounds=function(t){var e=this.player.view,i=(e.stage,ce.getInstance(e).getBoundsPicker(t.partition).getBoxBounds(this.player.root));if(!i)return null;var n=e.width/this.player.stageWidth,r=e.height/this.player.stageHeight;return{x:i.x*n,y:i.y*r,width:i.width*n,height:i.height*r}},t.prototype._traverse=function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=!1);for(var r={parentId:t.parent?t.parent.id:-1,children:null,rect:null},o=0,s=ck;o<s.length;o++){var a=s[o],l=a.split(":");l.length>1?r[l[1]]=t[l[0]]:r[a]=t[a]}if(r.globalVisible=t.parent?t.parent.visible&&t.visible:t.visible,i&&(r.rect=this._getNodeBounds(t)),e){r.children=[];for(var u=0,c=t._children;u<c.length;u++){var h=c[u];(n&&h.visible||!n)&&r.children.push(this._traverse(h,e,i,n))}}return r},t.prototype._removeObjectByIds=function(t){var e=this._selectNode(t);e.parent.removeChild(e)},t.prototype._applyPropsByIds=function(t,e){var i=this._selectNode(t);Object.assign(i,e)},t.prototype._getSceneTree=function(t,e,i){"object"!=typeof t&&(t={flat:t||!1,from:e||0,rect:i||!1,visibleOnly:!1});for(var n=t.flat,r=void 0!==n&&n,o=(t.from,t.rect),s=void 0!==o&&o,a=t.visibleOnly,l=void 0!==a&&a,u=[],c=this.player.root._children.slice();;){var h=c.pop();if(!h)break;u.push(this._traverse(h,!r,s,l)),r&&c.push.apply(c,h._children.reverse().filter((function(t){return t.visible&&l||!l})))}return u},t.prototype._getInfo=function(){var t,e=this.player,i=e._avmHandler.avmVersion,n=e._swfFile,r=n.swfVersion,o=n.fpVersion,s=n.frameCount,a=n.frameRate,l=n.compression,u=n.bytesTotal,c=null===(t=e._gameConfig.binary.filter((function(t){return"GAME"===t.resourceType}))[0])||void 0===t?void 0:t.path;return c&&c.indexOf("?")>-1&&(c=c.substring(0,c.indexOf("?"))),{file:{name:e._gameConfig.title,path:c,size:u},runtime:{swfVersion:r,fpVersion:o,frameCount:s,frameRate:a,compression:l,avm:i},config:uk(e._gameConfig)}},t}(),pk=function(t){function e(e){var i=t.call(this,e)||this;return i.registerAVMStageHandler(new Vv),i.registerAVMStageHandler(new hR(new ak)),i.addEventListener(Et.AVM_COMPLETE,(function(t){return i.onAVMAvailable(t)})),i._debug=new hk(i),i}return i(e,t),e.prototype.onAVMAvailable=function(t){this._debug&&this._debug.onAvmInit("AVM1"===t.avmVersion?1:2)},e}(of);(function(t){function e(e){var i=t.call(this,e)||this;return i.registerAVMStageHandler(new Vv),i}i(e,t)})(of),function(t){function e(e){var i=t.call(this,e)||this;return i.registerAVMStageHandler(new hR(new ak)),i}i(e,t)}(of);console.debug("AwayFL - AwayFL-Player - 0.2.20");var dk=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["$version#","_alpha#","getAwayJSID","attachAudio","attachBitmap","attachMovie","beginFill","beginBitmapFill","beginGradientFill","blendMode#","cacheAsBitmap#","_callFrame","clear","createEmptyMovieClip","createTextField","_currentframe#","curveTo","_droptarget#","duplicateMovieClip","enabled#","endFill","filters#","_framesloaded#","_focusrect#","forceSmoothing#","getBounds","getBytesLoaded","getBytesTotal","getDepth","getInstanceAtDepth","getNextHighestDepth","getRect","getSWFVersion","getTextSnapshot","getURL","globalToLocal","gotoAndPlay","gotoAndStop","_height#","_highquality#","hitArea#","hitTest","lineGradientStyle","lineStyle","lineTo","loadMovie","loadVariables","localToGlobal","_lockroot#","menu#","moveTo","_name#","nextFrame","opaqueBackground#","_parent#","play","prevFrame","_quality#","removeMovieClip","_root#","_rotation#","scale9Grid#","scrollRect#","setMask","_soundbuftime#","startDrag","stop","stopDrag","swapDepths","tabChildren#","tabEnabled#","tabIndex#","_target#","_totalframes#","trackAsMenu#","toString","unloadMovie","_url#","useHandCursor#","_visible#","_width#","_x#","_xmouse#","_xscale#","_y#","_ymouse#","_yscale#"])},e.prototype._mouseEventHandler=function(t){for(var i=this,n=this._actions,r=n.length,o=0;o<r;o++){var s=n[o];if(s.stateTransitionFlags===t){if(e.retryButtonIDS&&e.retryButtonAction&&e.retryButtonIDS[this.adaptee.symbolID])return b.setVolume(0),void e.retryButtonAction((function(){b.setVolume(1),i._runAction(s)}));e.buttonPokiSDKActions[this.adaptee.name]?(b.setVolume(0),e.buttonPokiSDKActions[this.adaptee.name]((function(){b.setVolume(1),i._runAction(s)}))):e.buttonPokiSDKActions.all?(b.setVolume(0),e.buttonPokiSDKActions.all((function(){b.setVolume(1),i._runAction(s)}))):this._runAction(s)}}},e}(E_),fk=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.createAVM1Class=function(t){return _g(t,!0,e,[],["$version#","_alpha#","getAwayJSID","attachAudio","attachBitmap","attachMovie","beginFill","beginBitmapFill","beginGradientFill","blendMode#","cacheAsBitmap#","_callFrame","clear","createEmptyMovieClip","createTextField","_currentframe#","curveTo","_droptarget#","duplicateMovieClip","enabled#","endFill","filters#","_framesloaded#","_focusrect#","forceSmoothing#","getBounds","getBytesLoaded","getBytesTotal","getDepth","getInstanceAtDepth","getNextHighestDepth","getRect","getSWFVersion","getTextSnapshot","getURL","globalToLocal","gotoAndPlay","gotoAndStop","_height#","_highquality#","hitArea#","hitTest","lineGradientStyle","lineStyle","lineTo","loadMovie","loadVariables","localToGlobal","_lockroot#","menu#","moveTo","_name#","nextFrame","opaqueBackground#","_parent#","play","prevFrame","_quality#","removeMovieClip","_root#","_rotation#","scale9Grid#","scrollRect#","setMask","_soundbuftime#","startDrag","stop","stopDrag","swapDepths","tabChildren#","tabEnabled#","tabIndex#","_target#","_totalframes#","trackAsMenu#","toString","unloadMovie","_url#","useHandCursor#","_visible#","_width#","_x#","_xmouse#","_xscale#","_y#","_ymouse#","_yscale#"])},e.prototype.findChildWithSymbolIDs=function(t){for(var i=t._children.length,n=0;n<i;n++){var r=t._children[n];if(r&&r.symbolID&&e.retryButtonIDS[r.symbolID])return!0;if(r&&r._children)if(this.findChildWithSymbolIDs(r))return!0}return!1},e.prototype.stop=function(){e.actionWhenRetryButtonEncountered&&e.retryButtonIDS&&(this.findChildWithSymbolIDs(this.adaptee)&&e.actionWhenRetryButtonEncountered());return e.pokiSDKonStopAction&&e.pokiSDKonStopAction.action&&e.pokiSDKonStopAction.childName&&this.adaptee.getChildByName(e.pokiSDKonStopAction.childName)||e.pokiSDKonStopAction&&e.pokiSDKonStopAction.action&&e.pokiSDKonStopAction.childName&&"all"==e.pokiSDKonStopAction.childName?e.pokiSDKonStopAction.action():e.pokiSDKonStopAction&&e.pokiSDKonStopAction.action&&e.pokiSDKonStopAction.mcName&&e.pokiSDKonStopAction.mcName==this.adaptee.name&&(e.pokiSDKonStopAction.ignoreFrames&&e.pokiSDKonStopAction.ignoreFrames.indexOf(this.adaptee.currentFrameIndex)>=0||e.pokiSDKonStopAction.action()),this.adaptee.stop()},e}(g_),_k={MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_RENDERBUFFER_SIZE:34024,MAX_ELEMENTS_INDICES:33001,MAX_DRAW_BUFFERS:34852,MAX_COLOR_ATTACHMENTS:36063},mk=window.onerror,gk={log:console.log,warn:console.warn,debug:console.debug,error:console.error,info:console.info},yk=function(){function t(){this.logs=[],this.glInfo={},this.lastCrash=null,this.roodtEl=null,this._attachReporters(),this._attachUI(),this._webGlInfo(),window.REPORTER=this}return t.init=function(){t.instance=new t},t.bind=function(e){t.instance&&t.instance.bind(e)},t.prototype.bind=function(t){this.player=t},t.prototype._attachUI=function(){var t=this,e=this.roodtEl=document.createElement("div");e.setAttribute("id","report__root"),e.innerHTML="\n<div id='report__snap' class = 'report__btn'>\n\t<span>SNAP</span>\n</div>\n<div id='report__poppup'>\n\t<h1>Report!</h1>\n\t<textarea readonly = \"true\" id=\"report__text\" rows='10'>error</textarea>\n\t<div id = 'report__save' class = 'report__btn'>\n\t\tSAVE REPORT\n\t</div>\n</div>\n\n",document.body.appendChild(e);var i=document.createElement("style");i.innerHTML="\n\t#report__root {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tposition: absolute;\n\t\tz-index: 1000;\n\t\tuser-select: none;\n\t\tpointer-events: none;\n\t}\n\t.report__btn {\n\t\tpadding: 4px;\n\t\theight: 1.5em;\n\t\tbackground: #222;\n\t\tcolor: #eee;\n\t\ttext-align: center;\n\t\tfont-size: 1.5em;\n\t\tline-height: 1.5em;\n\t\tborder-radius: 1.5em;\n\t\tpointer-events: all;\n\t\tbox-shadow: 1px 3px 5px 2px black;\n\t\ttransition: background-color 0.5s;\n\t}\n\t.report__btn:hover {\n\t\tcursor: pointer;\n\t\tbackground: #444;\n\t}\n\n\t#report__snap:hover {\n\t\tright: -15px;\n\t\tcolor: #ffc;\n\t}\n\n\t#report__snap {\n\t\tposition: absolute;\n\t\ttop: 0.5em;\n\t\tright: -30px;\n\t\twidth: 100px;\n\t\tpadding: 4px 16px 4px 4px;\n\t\ttransition: right 0.5s;\n\t\tdisplay: none;\n\t}\n\n\t#report__poppup {\n\t\tposition: absolute;\n\t\tleft: 50%;\n\t\ttop: 50%;\n\t\ttransform: translate(-50%, -50%);\n\t\twidth: max(60%, 300px);\n\t\tmin-height: 40%;\n\t\tmax-height: 80%;\n\t\theight: auto;\n\t\tdisplay: none;\n\t\tflex-direction: column;\n\t\tbackground: #fcc;\n\t\tbox-shadow: 1px 3px 5px 2px black;\n\t\tborder-radius: 4px;\n\t\tjustify-content: space-around;\n\t\talign-items: center;\n\t\tcolor: #222;\n\t\tpadding: 10px;\n\t}\n\n\t#report__poppup.show{\n\t\tdisplay: flex;\n\t}\n\n\t#report__text {\n\t\twidth: 100%;\n\t\tmin-height: 30%;\n\t\theight: auto;\n\t\tbackground: rgba(255,255,255, 0.5);\n\t\tpointer-events: all;\n\t}\n",document.head.appendChild(i),e.querySelector("#report__snap").addEventListener("click",(function(){return t._requsetSnap()}))},t.prototype._requsetSnap=function(){var t=this;console.log("[AVMCrashReporter] Generate report...");var e=this.roodtEl.querySelector("#report__poppup"),i=e.querySelector("#report__text"),n=e.querySelector("#report__save");if(!e)return null;i.textContent=this.logs.join("\n"),e.classList.toggle("show",!0),n.addEventListener("click",(function(){e.classList.toggle("show",!1);var i=t.generateReport(),n="report_"+t.player.config.title+"_"+(new Date).toISOString()+".json";t._saveFile(i,n)}),{once:!0})},t.prototype._saveFile=function(t,e){var i=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(i),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",e);var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(o)},t.prototype._attachReporters=function(){window.onerror=this._catchUnhandled.bind(this);var e=this;if(t.collectLogs){var i=function(t){console[t]=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];e._trackLogs.apply(e,n([t],i)),gk[t].apply(console,i)}};for(var r in gk)i(r)}},t.prototype._trackLogs=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.logs.push("["+t.toUpperCase()+"]: "+e.join(" "))},t.prototype._catchUnhandled=function(t,e,i,n,r){mk&&mk(t,e,i),this._trackLogs("exeption",r.stack||t),this.lastCrash={error:t,line:i,stack:r.stack,url:e,source:null},this._requsetSnap()},t.prototype.generateReport=function(){var t={date:new Date,game:this._gameInfo(),device:this._deviceInfo(),context:this.glInfo,config:this.player.config,logs:this.logs,crash:this.lastCrash,snap:null};return JSON.stringify(t)},t.prototype._gameInfo=function(){var t,e,i=this.player,n=i._avmHandler.avmVersion,r=i._swfFile,o=r.swfVersion,s=r.fpVersion,a=r.frameCount,l=r.frameRate,u=r.compression,c=r.bytesTotal,h=null===(t=i._gameConfig.binary.filter((function(t){return"GAME"===t.resourceType}))[0])||void 0===t?void 0:t.path;return h&&h.indexOf("?")>-1&&(h=h.substring(0,h.indexOf("?"))),{file:{name:null===(e=i._gameConfig)||void 0===e?void 0:e.title,path:h,size:c},runtime:{swfVersion:o,fpVersion:s,frameCount:a,frameRate:l,compression:u,avm:n}}},t.prototype._webGlInfo=function(){var t=document.createElement("canvas"),e=2,i=t.getContext("webgl2");i||(i=t.getContext("webgl"),e=1);var n=Object.create(null);for(var r in _k)n[r]=i.getParameter(_k[r]);var o=i.getExtension("WEBGL_debug_renderer_info");this.glInfo={version:e,params:n,vendor:i.getParameter(o.UNMASKED_VENDOR_WEBGL),renderer:i.getParameter(o.UNMASKED_RENDERER_WEBGL)}},t.prototype._deviceInfo=function(){var t=Object.create(null);try{for(var e=localStorage.length,i=0;i<e;i++){var n=localStorage.key(i);t[n]=localStorage.getItem(n)}}catch(t){}return{agent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight,dpi:window.devicePixelRatio},store:t}},t.collectLogs=!0,t.instance=null,t}();sf.push({test:/x.mochiads.com/,supressErrors:!0},{test:/AGI.swf/,resolve:"./assets/ads/AGI.swf"},{test:"http://cdn.nitrome.com/components/NitromeAPI.pkg",resolve:"./assets/NitromeAPI.pkg"}),yk.init();var Ak=function(t){function e(e){var i=t.call(this,e)||this;if(yk.bind(i),!e.files||!e.files.length)throw"AVMPlayerPoki: gameConfig.files must have positive length";return window.AVMPlayerPoki=i,i._gameConfig.showFPS&&(i.showFrameRate=!0),i._gameConfig.redirects&&sf.push.apply(sf,i._gameConfig.redirects),i._gameConfig.box2dVersion&&(bO.version=e.box2dVersion),!1===i._gameConfig.multisample&&(hi.PREF_MULTISAMPLE=!1),i._gameConfig.useWebGL1&&(hi.PREF_VERSION=1),i.addEventListener(V.LOADER_COMPLETE,(function(t){if(!i._gameConfig.start)return window.pokiGameParseComplete&&window.pokiGameParseComplete(),void i.play(e.skipFramesOfScene);window.pokiGameParseComplete&&window.pokiGameParseComplete((function(){return i.play(e.skipFramesOfScene)}))})),e.box2DCustom&&i.registerCustomBox2D(e.box2DCustom),e.preventLoad||i.load(),i}return i(e,t),e.prototype.registerCustomBox2D=function(t){bO.custom=t,bO.version="custom"},e.prototype.onAVMAvailable=function(e){"AVM2"==e.avmVersion?new jv(this._gameConfig.pokiSDK):"AVM1"==e.avmVersion&&(Uv.usePokiSDK=this._gameConfig.pokiSDK,lm.registerCustomClass("PokiSDK2",Uv.createAVM1Class(this._avmHandler.factory.avm1Context)),this._gameConfig.retryButtonIDS&&(this._gameConfig.retryButtonIDS=this._gameConfig.retryButtonIDS.reduce((function(t,e){return t[e]=!0,t}),{})),(this._gameConfig.buttonPokiSDKActions||this._gameConfig.retryButtonIDS||this._gameConfig.retryButtonAction)&&(lm.instance.Button=dk.createAVM1Class(lm.instance.context),this._gameConfig.buttonPokiSDKActions&&(dk.buttonPokiSDKActions=this._gameConfig.buttonPokiSDKActions),this._gameConfig.retryButtonIDS&&(dk.retryButtonIDS=this._gameConfig.retryButtonIDS),this._gameConfig.retryButtonAction&&(dk.retryButtonAction=this._gameConfig.retryButtonAction)),(this._gameConfig.actionOnStop||this._gameConfig.retryButtonIDS||this._gameConfig.actionWhenRetryButtonEncountered)&&(lm.instance.MovieClip=fk.createAVM1Class(lm.instance.context),this._gameConfig.actionOnStop&&(fk.pokiSDKonStopAction=this._gameConfig.actionOnStop),this._gameConfig.retryButtonIDS&&(fk.retryButtonIDS=this._gameConfig.retryButtonIDS),this._gameConfig.actionWhenRetryButtonEncountered&&(fk.actionWhenRetryButtonEncountered=this._gameConfig.actionWhenRetryButtonEncountered))),t.prototype.onAVMAvailable.call(this,e)},e}(pk);console.debug("Poki-Player - 0.0.11"),console.debug("FPAWorld - 0.0.9");var vk=["bG9jYWxob3N0","LnBva2kuY29t","LnNub2tpZG8uY29t","LnNub2tpZG8uZnI=","hostname","location","length","indexOf","aHR0cHM6Ly9wb2tpLmNvbS9zaXRlbG9jaw==","href","top"];!function(){for(var t=[vk[0],vk[1],vk[2],vk[3]],e=!1,i=window[vk[5]][vk[4]],n=0;n<t[vk[6]];n++){var r=atob(t[n]);if(-1!==i[vk[7]](r,i[vk[6]]-r[vk[6]])){e=!0;break}}if(!e){var o=atob(vk[8]);window[vk[5]][vk[9]]=o,window[vk[10]][vk[5]]!==window[vk[5]]&&(window[vk[10]][vk[5]]=window[vk[5]])}}();var bk=document.createElement("script");bk.innerHTML=atob("KGZ1bmN0aW9uIGEoKXt0cnl7KGZ1bmN0aW9uIGIoKXtkZWJ1Z2dlcjtiKCl9KSgpfWNhdGNoKGUpe3NldFRpbWVvdXQoYSw1ZTMpfX0pKCk"),document.head.appendChild(bk),window.startPokiGame=function(t){return new Ak(t)}}();
